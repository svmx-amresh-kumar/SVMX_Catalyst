!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=423)}([function(e,t,n){var i=n(5),a=n(244),r=n(12),o=n(127),s=n(126),l=n(372),c={api:i,core:a,datetimeutils:r,services:o,utils:s,spin:l};s.defineGlobal("com.servicemax.client.lib",c),e.exports=c},function(e,t,n){e.exports={default:n(631),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,a.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=n(648),r=i(a),o=n(240),s=i(o),l=n(18),c=i(l);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,c.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(3),s=i(o),l=n(4),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(10),p=n(126),m={name:"com.servicemax.client.lib.api"};m.SVMXObject=function(){function e(){(0,d.default)(this,e)}return(0,h.default)(e,[{key:"getClassName",value:function(){return this.constructor.__className||"unknown"}},{key:"toString",value:function(e){var t=this.getClassName().replace(/^com\.servicemax\.client\./,"client.");return e=e?" "+e:"",t+(e?" ("+e+")":"")}},{key:"doCleanup",value:function(){var e=this,t=this.__propertiesToBeCleanedUp||{};p.forEachProperty(t,function(n){var i=t[n],a=e[n];if(a)if(f.isArray(a)){for(var r=a.length-1;r>=0;r--){var o=a[r];o.doCleanup&&"function"==typeof o.doCleanup&&o.doCleanup()}a.length=0,void 0!==i.deleteAfterCleanup&&!0===i.deleteAfterCleanup&&delete e[n]}else a.doCleanup&&"function"==typeof a.doCleanup&&(a.doCleanup(),void 0!==i.deleteAfterCleanup&&!0===i.deleteAfterCleanup&&delete e[n])},this),p.forEachProperty(this,function(t){e[t]=null},this)}},{key:"setPropertyForCleanup",value:function(e,t){var n=void 0!==t&&t;this.__propertiesToBeCleanedUp=this.__propertiesToBeCleanedUp||{};for(var i=f.isArray(e)?e:[e],a=i.length-1;a>=0;a--){var r=i[a],o=this.__propertiesToBeCleanedUp[r]?this.__propertiesToBeCleanedUp[r]:{};o.deleteAfterCleanup=n,this.__propertiesToBeCleanedUp[r]=o}}}]),e}(),m.Event=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return a.type=e,a.target=n,a.data=i,a}return(0,c.default)(t,e),t}(m.SVMXObject),m.EventDispatcher=function(e){function t(){(0,d.default)(this,t);var e=(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.eventHandlers=[],e}return(0,c.default)(t,e),(0,h.default)(t,[{key:"bind",value:function(e,t,n){this.eventHandlers[this.eventHandlers.length]={type:e,handler:t,context:n}}},{key:"unbind",value:function(e,t,n){if(this.eventHandlers)for(var i=0;i<this.eventHandlers.length;i++)this.eventHandlers[i].handler===t&&this.eventHandlers[i].type===e&&this.eventHandlers[i].context===n&&this.eventHandlers.splice(i,1)}},{key:"unbindContext",value:function(e){this.eventHandlers=p.array.filter(this.eventHandlers,function(t){return t.context!=e})}},{key:"triggerEvent",value:function(e){for(var t=p.array.filter(this.eventHandlers,function(t){return t.type==e.type}),n=0;n<t.length;n++)t[n].context?t[n].handler.call(t[n].context,e):t[n].handler(e)}},{key:"getEvents",value:function(e){return p.array.filter(this.eventHandlers,function(t){return t.type===e})}}]),t}(m.SVMXObject),m.ModuleActivator=function(e){function t(){(0,d.default)(this,t);var e=(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e._logger=null,e._module=null,e}return(0,c.default)(t,e),(0,h.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}},{key:"setModule",value:function(e){this._module=e}},{key:"getModule",value:function(){return this._module}},{key:"getLogger",value:function(){return this._logger}},{key:"getResourceUrl",value:function(e){return this._module.getResourceUrl(e)}}]),t}(m.SVMXObject),m.AbstractApplication=function(e){function t(){return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,h.default)(t,[{key:"beforeRun",value:function(e){e.handler.call(e.context)}},{key:"run",value:function(){}}]),t}(m.EventDispatcher),m.AbstractApplication.currentApp=null,m.AbstractCommand=function(e){function t(){return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,h.default)(t,[{key:"executeAsync",value:function(e,t){}}]),t}(m.SVMXObject),m.AbstractOperation=function(e){function t(){return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){}}]),t}(m.SVMXObject),m.AbstractResponder=function(e){function t(){return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,h.default)(t,[{key:"result",value:function(e){}},{key:"fault",value:function(e){}}]),t}(m.SVMXObject),m.AbstractExtension=function(e){function t(){return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e){}}]),t}(m.SVMXObject),m.ExtensionRunner=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__caller=e,i.__extensionName=n,i}return(0,c.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e){var t=p.getLoggingService().getLogger("EXTENSION-RUNNER"),n=function(){var e=new f.Deferred;return e.resolve(),e},i=p.getClient(),a=i.getDeclaration("com.servicemax.client.extension");if(!a)return n();var r=i.getDefinitionsFor(a),o=this.__extensionName;if(r=p.array.filter(r,function(e){return e.config.event===o}),t.info("Running "+o+" with "+r.length+" extensions"),0===r.length)return n();var s=[];if(e&&e.extensionClassName&&""!=e.extensionClassName){var l=p.create(e.extensionClassName);try{s.push(l.perform(this.__caller,e))}catch(e){}}else for(var c=0;c<r.length;c++){var u=r[c],d=u.config["class-name"],l=p.create(d);try{s.push(l.perform(this.__caller,e))}catch(e){}}var _=p.when(s);return _.done(function(){t.info("Running "+o+" completed")}),_.fail(function(){t.error("Running "+o+" failed")}),_}}]),t}(m.SVMXObject),m.ExtensionRunner.run=function(e,t,n){return new m.ExtensionRunner(e,t).perform(n)},p.getCurrentApplication=function(){return m.AbstractApplication.currentApp},e.exports=m},function(e,t,n){"use strict";t.__esModule=!0;var i=n(176),a=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,a.default)(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()},function(module,exports,__webpack_require__){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function execQuery(e){var t=$.Deferred(),n=nativeService.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(n){t.resolve(n.data.data),e.onSuccess&&e.onSuccess(n)}),n.bind("REQUEST_ERROR",function(n){t.reject(n.data.data),e.onError&&e.onError(n)}),n.execute({query:e.query,queryParams:e.queryParams,queryArray:e.queryArray}),t}var _stringify=__webpack_require__(31),_stringify2=_interopRequireDefault(_stringify),_keys=__webpack_require__(16),_keys2=_interopRequireDefault(_keys),_typeof2=__webpack_require__(18),_typeof3=_interopRequireDefault(_typeof2),_createClass2=__webpack_require__(6),_createClass3=_interopRequireDefault(_createClass2),_getPrototypeOf=__webpack_require__(1),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(2),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_possibleConstructorReturn2=__webpack_require__(3),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(4),_inherits3=_interopRequireDefault(_inherits2),$=__webpack_require__(10),SVMX=__webpack_require__(0).utils,Facade=__webpack_require__(11).Facade,DatetimeUtil=__webpack_require__(12).DatetimeUtil,Field=__webpack_require__(99).Field,FieldSet=__webpack_require__(99).FieldSet,Record=__webpack_require__(99).Record,RecordSet=__webpack_require__(99).RecordSet,SVMXObject=__webpack_require__(5).SVMXObject,AbstractExtension=__webpack_require__(5).AbstractExtension,AbstractLogTarget=__webpack_require__(127).AbstractLogTarget,NativeServiceFile=__webpack_require__(11).File,utils={name:"com.servicemax.client.offline.sal.model.utils"},TS=function(){return SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},logger=SVMX.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.utils"),nativeService=Facade,DatetimeUtils=DatetimeUtil,CONST_TAG_JAN="FSA016_TAG031",CONST_TAG_FEB="FSA016_TAG032",CONST_TAG_MAR="FSA016_TAG033",CONST_TAG_APR="FSA016_TAG034",CONST_TAG_MAY="FSA016_TAG035",CONST_TAG_JUN="FSA016_TAG036",CONST_TAG_JUL="FSA016_TAG037",CONST_TAG_AUG="FSA016_TAG038",CONST_TAG_SEP="FSA016_TAG039",CONST_TAG_OCT="FSA016_TAG040",CONST_TAG_NOV="FSA016_TAG041",CONST_TAG_DEC="FSA016_TAG042",CONST_TAG_SUN="FSA016_TAG008",CONST_TAG_MON="FSA016_TAG009",CONST_TAG_TUE="FSA016_TAG010",CONST_TAG_WED="FSA016_TAG011",CONST_TAG_THU="FSA016_TAG012",CONST_TAG_FRI="FSA016_TAG013",CONST_TAG_SAT="FSA016_TAG014",getDataFromEvt=function(e){return SVMX.toObject(e.data.data)};utils.Field=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),t}(Field),utils.FieldSet=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"getFieldSet",value:function(e,t){var n=new $.Deferred;return this.fieldSets[e]?(t&&t(this.fieldSets[e]),n.resolve(this.fieldSets[e])):utils.MetaData.describeObject({objectName:e,sync:!0,onSuccess:SVMX.proxy(this,function(i){var a=new utils.FieldSet(i.fields,e);this.fieldSets[e]=a,t&&t(this.fieldSets[e]),n.resolve(this.fieldSets[e])})}),n}}]),t}(FieldSet),utils.VirtualRecord=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"__loadFieldSet",value:function(e){this._fields=new utils.FieldSet(this.objectDescribe.fields,e);for(var t=this._fields.getFieldsByType("picklist"),n=0;n<t.length;n++)this.__setDisplayValue(t[n],this.getValue(t[n]))}},{key:"writeRecord",value:function(e,t){e&&e()}},{key:"deleteRecord",value:function(e,t){e&&e()}},{key:"loadReferences",value:function(e){e=e||{};var t=e.onSuccess;t&&t()}}]),t}(Record),utils.Record=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"__loadFieldSet",value:function(e){utils.FieldSet.getFieldSet(e,SVMX.proxy(this,function(e){this._fields=e;for(var t=this._fields.getFieldsByType("picklist"),n=0;n<t.length;n++)this.__setDisplayValue(t[n],this.getValue(t[n]));for(var n=0;n<this.__onReadyListeners.length;n++)this.__onReadyListeners[n](this);delete this.__onReadyListeners}))}},{key:"writeRecord",value:function(e,t){utils.Data.writeRecord({data:this,type:this.getTableName(),onSuccess:e,onError:t})}},{key:"deleteRecord",value:function(e,t){utils.Data.deleteRecord({Id:this.Id,data:this,onSuccess:e,onError:t})}},{key:"loadReferences",value:function(e){e=e||{};var t=e.onSuccess,n=void 0;if(e.fields){n=[];for(var i=0;i<e.fields.length;i++){var a=this._fields.getField(e.fields[i]);a&&n.push(a)}}else n=this._fields.getFieldsByType("reference");if(!n.length)return void(t&&t());if(!this.getTableName())return void(t&&t());if(!this.__loadAllReferencesState){this.__loadAllReferencesState={counter:n.length};for(var r=SVMX.proxy(this,function(e){var t=(e.name,this.getDisplayValue(e)),n=this.getValue(e);if(t||!n)return this.__loadAllReferencesState.counter--,void l();utils.MetaData.getTableForId(n,SVMX.proxy(this,function(t){t?utils.MetaData.getNameField(t,SVMX.proxy(this,function(i){if(i){var a=nativeService.createSQLRequest();a.bind("REQUEST_ERROR",SVMX.proxy(this,s,i,e)),a.bind("REQUEST_COMPLETED",SVMX.proxy(this,o,t,i,e)),a.execute({query:"SELECT * FROM '{{table_name}}' where Id='{{Id}}'",queryParams:{table_name:t,Id:n}})}else this.__loadAllReferencesState.counter--,l()})):(this.__loadAllReferencesState.counter--,l())}))}),o=function(e,t,n,i){var a=i.data.data;if(a&&a.length){var r=new utils.Record(a[0],e);r.onReady(SVMX.proxy(this,function(){var e=r.getNameValue();this.__setDisplayValue(n,e),this.__setReferenceRecord(n,r),this.__loadAllReferencesState.counter--,l()}))}else this.__loadAllReferencesState.counter--,l()},s=function(){this.__loadAllReferencesState.counter--,l()},l=SVMX.proxy(this,function(){this.__loadAllReferencesState.counter<=0&&(delete this.__loadAllReferencesState,t&&t())}),i=0;i<n.length;i++)r(n[i])}}}]),t}(Record),utils.Record.__insertKeyIndex=1,utils.Record.__insertKeyTimestamp=(new Date).getTime(),utils.RecordSet=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"resolveReferences",value:function(e){if(this.getSize()>0){var t=this.getItem(0).fields.getFieldsByType("reference"),n=this.getItem(0).fields.getFieldsByType("picklist");utils.Data.getAllReferences({data:this.toArray(),convertPicklists:!1,onSuccess:SVMX.proxy(this,function(){this.forEach(function(e){for(var i=0;i<t.length;i++){var a=t[i],r=e.getValue(a);"object"===(void 0===r?"undefined":(0,_typeof3.default)(r))&&"fieldvalue"in r&&(e.__setDisplayValue(a,r.fieldvalue.value),e.setValue(a,r.fieldvalue.key))}for(var i=0;i<n.length;i++){var a=n[i],r=e.getValue(a);e.__setDisplayValue(a,r)}},this),e()})})}}}],[{key:"getRecordSet",value:function(e){var t=nativeService.createSQLRequest();e.onError&&t.bind("REQUEST_ERROR",e.onError),t.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__queryForRecordsSuccess",e)),t.execute({query:e.query,queryParams:e.queryParams})}},{key:"__queryForRecordsSuccess",value:function(e,t){e.onSuccess(new utils.RecordSet(t.data.data,e.tableName))}}]),t}(RecordSet),utils.Data=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"writeRecord",value:function(e){utils.MetaData.describeObject({objectName:e.type,onSuccess:SVMX.proxy(this,function(t){e.fields=t.fields,e.recordTypeInfos=t.recordTypeInfos,this.__writeRecord(e)}),onError:function(t){e.onError&&e.onError(t.data.data)}})}},{key:"writeBulkRecord",value:function(e){utils.MetaData.describeObject({objectName:e.type,onSuccess:SVMX.proxy(this,function(t){e.fields=t.fields,e.recordTypeInfos=t.recordTypeInfos,this.__writeBulkRecord(e)}),onError:function(t){e.onError&&e.onError(t.data.data)}})}},{key:"__writeBulkRecord",value:function(e){for(var t=e.data,n=[],i=0;i<t.length;i++){var a=t[i];if(a.Id){var r=utils.SyncData.getOpenRecordRemoteId(a.Id);r&&(e.localId=a.Id,a.Id=r)}else a.Id=this.__generateId(e.type);n.push(a)}var o=this.__checkIfRecordExistsInBulk(e,n);o.done(SVMX.proxy(this,function(n){for(var i=0;i<n.length;i++)!function(e){var i=n[e],a=t.findIndex(function(e){return e.Id===i.Id});-1!==a&&(t[a].isUpdate=!0)}(i);this.__writeBulkRecordWithId(e)})),o.fail(SVMX.proxy(this,function(t){e.onError&&e.onError(t.data.data)}))}},{key:"__writeBulkRecordWithId",value:function(e){function t(t){if(void 0===e.sync&&(e.sync=!0),e.sync){var n=[];if(t)for(var i=0;i<t.length;i++){var a=t[i];if(a&&a.isUpdated){var r={Id:a.Id,parentId:e.parentId,objectName:u,isInsert:!1};r.oldValues=a.oldValues,r.newValues=a.newValues,n.push(r)}}for(var o=0;o<l.length;o++){var s=l[o],c={Id:s.Id,parentId:e.parentId,objectName:u,isInsert:!0};n.push(c)}e.onSuccess(n)}}function n(n,i){var a=nativeService.createSQLRequest();a.bind("REQUEST_COMPLETED",function(){i?i():t()}),a.bind("REQUEST_ERROR",function(t){e.onError&&e.onError(t.data.data)}),a.execute({queryArray:n})}function i(e,i){e.__getBulkUpdatedValues(u,s,function(e){n(i,e)},t)}var a=$.isArray(e.data)?e.data:[e.data],r=[],o=[],s=[],l=[],c=utils.SyncData.getOpenRecordRemoteIds();e.parentId in c&&(e.parentId=c[e.parentId]);for(var u=e.type,d=0;d<a.length;d++){for(var _=[],h=a[d],f=void 0===h.isUpdate,p=0;p<e.fields.length;p++){var m=e.fields[p],v=h[m.name];if(v&&"object"===(void 0===v?"undefined":(0,_typeof3.default)(v))&&"fieldvalue"in v&&(v=v.fieldvalue.key),"OwnerId"===m.name&&!v&&f&&(v=utils.SystemData.getUserInfo().UserId),"RecordTypeId"===m.name)if(!v&&f){var g=SVMX.array.get(e.recordTypeInfos,function(e){return e.defaultRecordTypeMapping});g&&"Master"!=g.name&&(v=g.recordTypeId)}else{var y=SVMX.array.get(e.recordTypeInfos,function(e){return v===e.name});y&&(v=y.recordTypeId)}switch("IsDeleted"!==m.name||""!==v&&null!==v&&void 0!==v||(v=!1),m.type){case"int":case"double":case"percent":case"currency":v=null!==v&&void 0!==v&&""!==v?Number(v):"null";break;case"bool":case"boolean":if(null===v||void 0===v){v="null";break}"true"===v?v=!0:"false"===v&&(v=!1),v=v?"'true'":"'false'";break;case"date":case"datetime":v=null!==v&&void 0!==v?"'"+v+"'":"null";break;case"reference":v in c&&(v=c[v]),this.__updateDependentRecords(v,m,u,h);default:null===v||void 0===v?v="''":"string"==typeof v&&(v="'"+v.replace(new RegExp("'","g"),"''")+"'")}_.push({name:m.name,value:v})}if(f){utils.SyncData.addOpenRecords(utils.SyncData.getOwnerId(),[h.Id]);var S=SVMX.array.map(_,function(e){return e.name}),E=SVMX.array.map(_,function(e){return e.value}),b="INSERT INTO `"+u+"` ('"+S.join("','")+"') VALUES ("+E+")";l.push(h),o.push(b)}else{var E=SVMX.array.map(_,function(e){return e.name+" = "+e.value}),T=h.Id;T in c&&(T=[T,c[T]]);var b="UPDATE `"+u+"` SET "+E.join(",")+" WHERE Id IN ('"+($.isArray(T)?T.join("','"):T)+"')";r.push(b),s.push(h)}}o.length>0&&r.length>0?i(this,o.concat(r)):o.length>0?n(o):r.length>0?i(this,r):t()}},{key:"__checkIfRecordExistsInBulk",value:function(e,t){var n=SVMX.Deferred(),i=e.type,a=(e.data,SVMX.array.map(t,function(e){return e.Id})),r="SELECT Id FROM `"+i+"` WHERE Id IN ('"+($.isArray(a)?a.join("','"):a)+"')",o=nativeService.createSQLRequest();return o.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(e){n.resolve(e.data.data)})),o.bind("REQUEST_ERROR",function(e){n.reject(e)}),o.execute({query:r}),n}},{key:"__getBulkUpdatedValues",value:function(e,t,n,i){function a(e,t){e&&logger.error("SERIOUS ERROR: Failed to write record in db: "+recordId),i&&i(t)}function r(e,t){execQuery({query:e}).then(function(e){t($.isEmptyObject(e)?[]:e)},a)}function o(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=t[i],s={oldValues:{Id:o.Id},newValues:{Id:o.Id},isUpdated:!1,Id:r.Id},l=["0","novalue","null"];for(var c in o){var u=r[c],d=o[c];(!u&&"number"!==SVMX.typeOf(u)||"string"===SVMX.typeOf(u)&&l.indexOf(u)>=0)&&(u=""),(!d&&"number"!==SVMX.typeOf(d)||"string"===SVMX.typeOf(d)&&l.indexOf(d)>=0)&&(d=""),"Id"!==c&&u!==d&&(s.isUpdated=!0,s.oldValues[c]=u,s.newValues[c]=d)}n.push(s)}a(null,n)}var s=SVMX.array.map(t,function(e){return e.Id});if(s.length){var l="SELECT * FROM '"+e+"' WHERE ID IN ('"+($.isArray(s)?s.join("','"):s)+"')";r(l,function(e){n(function(){r(l,function(t){o(e,t)})})})}else a(!0)}},{key:"writeSyncRecords",value:function(e,t,n,i){utils.SyncData.writeSyncRecords({insertRecords:e,updateRecords:t,deleteRecords:n,callback:i})}},{key:"__checkIfRecordExists",value:function(e){var t=SVMX.Deferred(),n=e.type,i=e.data,a="SELECT * FROM `"+n+"` WHERE Id='"+i.Id+"'",r=nativeService.createSQLRequest();return r.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(e){t.resolve(0==e.data.data.length)})),r.bind("REQUEST_ERROR",function(e){t.reject(e)}),r.execute({query:a}),t}},{key:"__generateId",value:function(e){return utils.MetaData.getIdForTable(e)+"_local_"+this.__insertKeyTimestamp+"_"+this.__insertKeyIndex++}},{key:"__isRecordSyncInProgress",value:function(e){var t=!1;if(!SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().__syncFinished){var n=utils.SyncData.getSyncPutInsertRecordIds();return e&&n&&n[e]&&(t=!0),t}}},{key:"__writeRecord",value:function(e){var t=e.data;if(t.Id){var n=utils.SyncData.getOpenRecordRemoteId(t.Id);n&&(e.localId=t.Id,t.Id=n);var i=this.__checkIfRecordExists(e);i.done(SVMX.proxy(this,function(t){t&&this.__isRecordSyncInProgress(e.localId)?setTimeout(SVMX.proxy(this,function(){this.__writeRecord(e)}),500):this.__writeRecordWithId(e,t)})),i.fail(SVMX.proxy(this,function(t){e.onError&&e.onError(t.data.data)}))}else t.Id=this.__generateId(e.type),this.__writeRecordWithId(e,!0)}},{key:"__writeRecordWithId",value:function(e,t){function n(n){if(void 0===e.sync&&(e.sync=!0),e.sync){var i=null;(t||n&&n.isUpdated)&&(i={Id:o.Id,parentId:e.parentId,objectName:r},t||(i.oldValues=n.oldValues,i.newValues=n.newValues)),e.onSuccess(t,i)}}function i(t,i){var a=nativeService.createSQLRequest();a.bind("REQUEST_COMPLETED",function(){i?i():n()}),a.bind("REQUEST_ERROR",function(t){e.onError&&e.onError(t.data.data)}),a.execute({query:t})}var a=utils.SyncData.getOpenRecordRemoteIds();e.parentId in a&&(e.parentId=a[e.parentId]);for(var r=e.type,o=e.data,s=[],l=0;l<e.fields.length;l++){var c=e.fields[l],u=o[c.name];if(u&&"object"===(void 0===u?"undefined":(0,_typeof3.default)(u))&&"fieldvalue"in u&&(u=u.fieldvalue.key),"OwnerId"===c.name&&!u&&t&&(u=utils.SystemData.getUserInfo().UserId),"RecordTypeId"===c.name&&"Event"!==r&&r!==SVMX.OrgNamespace+"__SVMX_Event__c")if(!u&&t){var d=SVMX.array.get(e.recordTypeInfos,function(e){return e.defaultRecordTypeMapping});d&&"Master"!=d.name&&(u=d.recordTypeId)}else{var _=SVMX.array.get(e.recordTypeInfos,function(e){return u===e.name});_&&(u=_.recordTypeId)}switch("IsDeleted"!==c.name||""!==u&&null!==u&&void 0!==u||(u=!1),c.type){case"int":case"double":case"percent":case"currency":u=null!==u&&void 0!==u&&""!==u?Number(u):"null";break;case"bool":case"boolean":if(null===u||void 0===u){u="null";break}"true"===u?u=!0:"false"===u&&(u=!1),u=u?"'true'":"'false'";break;case"date":case"datetime":u=null!==u&&void 0!==u?"'"+u+"'":"null";break;case"reference":u in a&&(u=a[u]),this.__updateDependentRecords(u,c,r,o);default:null===u||void 0===u?u="''":"string"==typeof u&&(u="'"+u.replace(new RegExp("'","g"),"''")+"'")}s.push({name:c.name,value:u})}if(t){utils.SyncData.addOpenRecords(utils.SyncData.getOwnerId(),[o.Id]);var h=SVMX.array.map(s,function(e){return e.name}),f=SVMX.array.map(s,function(e){return e.value}),p="INSERT INTO `"+r+"` ('"+h.join("','")+"') VALUES ("+f+")";i(p)}else{var f=SVMX.array.map(s,function(e){return e.name+" = "+e.value}),m=o.Id;m in a&&(m=[m,a[m]]);var p="UPDATE `"+r+"` SET "+f.join(",")+" WHERE Id IN ('"+($.isArray(m)?m.join("','"):m)+"')";this.__getUpdatedValues(m,function(e){i(p,e)},n)}}},{key:"getUpdatedValues",value:function(e,t,n){function i(e){if(a=e.length)for(var t=0,i=a;t<i;t++){var s=e[t];s in r&&r[s]()}else n(o)}var a=e.length,r={},o={};e.forEach(function(e){utils.Data.__getUpdatedValues(e,function(n){r[e]=n,--a||t(i)},function(t){t&&(o[e]=t),--a||n(o)})})}},{key:"__getUpdatedValues",value:function(e,t,n){function i(t,i){t&&logger.error("SERIOUS ERROR: Failed to write record in db: "+e),n&&n(i)}function a(e,t){execQuery({query:e}).then(function(e){t($.isEmptyObject(e)?{}:e[0])},i)}function r(e,t){var n={oldValues:{Id:t.Id},newValues:{Id:t.Id},isUpdated:!1},a=["0","novalue","null"];for(var r in t){var o=e[r],s=t[r];(!o&&"number"!==SVMX.typeOf(o)||"string"===SVMX.typeOf(o)&&a.indexOf(o)>=0)&&(o=""),(!s&&"number"!==SVMX.typeOf(s)||"string"===SVMX.typeOf(s)&&a.indexOf(s)>=0)&&(s=""),"Id"!==r&&o!==s&&(n.isUpdated=!0,n.oldValues[r]=o,n.newValues[r]=s)}i(null,n)}var o=utils.MetaData.getTableForId($.isArray(e)?e[0]:e);if(o){var s="SELECT * FROM '"+o+"' WHERE ID IN ('"+($.isArray(e)?e.join("','"):e)+"')";a(s,function(e){t(function(){a(s,function(t){r(e,t)})})})}else i(!0)}},{key:"__updateDependentRecords",value:function(e,t,n,i){if(e&&-1!=e.indexOf("transient-")&&t.referenceTo&&t.referenceTo.length>0)for(var a=0;a<t.referenceTo.length;a++){var r=t.referenceTo[a];-1==r.indexOf("Site__c")&&-1==r.indexOf("Installed_Product__c")&&"Account"!==r&&-1==r.indexOf("Sub_Location__c")||this.__createDependentEntry(e,n,i.Id,t.name)}}},{key:"__createDependentEntry",value:function(e,t,n,i){var a=nativeService.createSQLRequest();a.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(r){a=nativeService.createSQLRequest(),r&&r.length>0?a.execute({query:"UPDATE SyncDependentLog SET parent_record_id = '{{rec_id}}', local_id = '{{l_id}}', parent_object_name = '{{object_name}}', parent_field_name = '{{field_name}}' ",queryParams:{rec_id:n,l_id:e,object_name:t,field_name:i}}):a.execute({query:"INSERT INTO SyncDependentLog (parent_record_id, local_id, parent_object_name, parent_field_name) VALUES ('{{rec_id}}','{{l_id}}', '{{object_name}}', '{{field_name}}')",queryParams:{rec_id:n,l_id:e,object_name:t,field_name:i}})})),a.bind("REQUEST_ERROR",function(e){}),a.execute({query:"SELECT * FROM SyncDependentLog WHERE parent_record_id = '{{rec_id}}' AND  parent_field_name='{{field_name}}'",queryParams:{rec_id:n,field_name:i}})}},{key:"deleteRecord",value:function(e){void 0==e.sync&&(e.sync=!0);var t=this,n=utils.SyncData.getOpenRecordRemoteId(e.Id);n&&(e.Id=n),utils.SyncData.removeOpenRecord(utils.SyncData.getOwnerId(),e.Id);var i=e.tableName||utils.MetaData.getTableForId(e.Id);if(i){var a=nativeService.createSQLRequest();a.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(){this.__deleteDependentEntry(e.Id),t.__getFiles(e.Id),t.__deleteOfflineAttachmentEntryfromSyncLog(e.Id);var n=void 0;e.sync&&(n={Id:e.Id,parentId:e.parentId,objectName:i}),(e.Id.match(/_local_/)||e.Id.match(/^local_/))&&t._deleteSyncConflict(e.Id),e.onSuccess&&e.onSuccess(n)})),a.bind("REQUEST_ERROR",e.onError||function(e){}),a.execute({query:"DELETE FROM '{{table_name}}' WHERE Id='{{id}}'",queryParams:{table_name:i,id:e.Id}})}else logger.error("SERIOUS ERROR: Failed to delete because table not found for Id="+e.Id),e.onError&&e.onError("Table not found for Id="+e.Id)}},{key:"__deleteDependentEntry",value:function(e){nativeService.createSQLRequest().execute({query:"DELETE FROM SyncDependentLog WHERE parent_record_id = '{{rec_id}}'",queryParams:{rec_id:e}})}},{key:"_deleteSyncConflict",value:function(e){nativeService.createSQLRequest().execute({query:"DELETE FROM ClientSyncConflict WHERE Id = '{{rec_id}}'",queryParams:{rec_id:e}})}},{key:"__getChecklistRecordSuccess",value:function(e,t,n,i,a,r){var o=this,s={},l=utils.CheckListChunkUtils;if(r.data&&r.data.data&&(s=r.data.data[0]),!s)return this.__getRecordError(e,t,r);l.getCombinedChecklistData(s).then(function(l){var c=SVMX.getCustomFieldName("ChecklistJSON"),u=SVMX.getCustomFieldName("ChecklistMetaJSON");s[c]=l[c],s[u]=l[u],o.__getRecordSuccess(e,t,n,i,a,r)})}},{key:"__deleteOfflineAttachmentEntryfromSyncLog",value:function(e){if(e.match(/local.*/)){var t=nativeService.createSQLRequest();t.execute({query:"DELETE FROM ClientSyncLog WHERE id in (Select id from SFAttachments Where parent_id = '"+e+"')"}),t.bind("REQUEST_ERROR",function(){}),t.bind("REQUEST_COMPLETED",function(){})}}},{key:"__getFiles",value:function(e){var t=this,n=nativeService.createSQLRequest();e.match(/local.*/)&&(n.execute({query:"SELECT id as Id, file_path as __path FROM SFAttachments WHERE parent_id = '"+e+"'"}),n.bind("REQUEST_ERROR",function(){}),n.bind("REQUEST_COMPLETED",function(n){t.deleteFiles(t.getPathFromData(n),e)}))}},{key:"deleteFiles",value:function(e,t){var n=this,i=SVMX.array.map(e,function(e){return e.deleteFile()});SVMX.when(i).then(function(){t&&n.__deleteOfflineAttachment(t)})}},{key:"getPathFromData",value:function(e){for(var t=[],n=e.data.data.length,i=0;i<n;i++){var a=e.data.data[i].__path;t.push(this.deleteLocalFile(a))}return t}},{key:"deleteLocalFile",value:function(e){return new NativeServiceFile(e)}},{key:"__deleteOfflineAttachment",value:function(e){if(e.match(/local.*/)){var t=nativeService.createSQLRequest();t.execute({query:"DELETE FROM SFAttachments WHERE parent_id = '"+e+"'"}),t.bind("REQUEST_ERROR",function(){}),t.bind("REQUEST_COMPLETED",function(){})}}},{key:"getRecord",value:function(e){var t=new $.Deferred;if(e.record)t.resolve(e.record);else{var n=function n(a){var r=a.fields,o=a.recordTypeInfos,s=nativeService.createSQLRequest(),l=this;if(this.__isRecordSyncInProgress(e.Id))setTimeout(SVMX.proxy(l,function(){n.call(l,a)}),500);else{if(i===SVMX.getCustomObjectName("Checklist")){var c=utils.ServerInfo.getMultiServerVersionRequest(),u=c.getChecklistSuccessCallback();s.bind("REQUEST_COMPLETED",SVMX.proxy(this,u,t,e,i,r,o))}else s.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__getRecordSuccess",t,e,i,r,o));s.bind("REQUEST_ERROR",SVMX.proxy(this,"__getRecordError",t,e));var d=utils.SyncData.getOpenRecordRemoteId(e.Id);d&&(e.Id=d);var _=this.buildQuery("MAIN.Id='"+e.Id+"'",i,r,"",e.lookupDisplayFieldMap);s.execute({query:_})}},i=utils.MetaData.getTableForId(e.Id);if(i)utils.MetaData.describeObject({objectName:i,sync:!0,onSuccess:SVMX.proxy(this,function(e){n.call(this,e)})});else{var a="FATAL ERROR: Unable to find tableName in getRecord for ID: "+e.Id;logger.error(a),e.onError&&e.onError(a),t.reject(a)}}return t}},{key:"buildQuery",value:function(e,t,n,i,a,r,o){for(var s=SVMX.array.filter(n,function(e){return"reference"==e.type}),l=[],c=["MAIN.*"],u={},d=0;d<s.length;d++){var _=s[d],h=_.referenceTo[_.referenceTo.length-1];if(utils.MetaData.isTableInDatabase(h)){var f=_.relationshipName?_.relationshipName+"Table":"table"+d,p=SVMX.string.substitute("LEFT JOIN `{{referenceTo}}` AS {{alias}} ON MAIN.{{fieldName}} = `{{alias}}`.Id",{referenceTo:h,fieldName:_.name,alias:f});l.push(p);var m=a&&a[_.name];m=m||utils.MetaData.getNameField(h),c.push(SVMX.string.substitute("IFNULL(`{{tableName}}`.{{nameField}}, '') AS {{relationshipName}}",{referenceTo:h,nameField:m,tableName:f,relationshipName:_.relationshipName||"field"+d})),u[_.name]=_.relationshipName||"field"+d}}this.buildQueryForExpression(r,u);var v=SVMX.string.substitute("SELECT {{fieldList}}\n FROM `{{tableName}}` AS MAIN\n {{joins}}\n WHERE {{whereClause}}",{fieldList:c,tableName:t,joins:l.join("\n"),whereClause:e})+(i||"");return r&&r.advancedExpression&&(v=v+" AND ("+r.advancedExpression+")"),v}},{key:"_getSortString",value:function(e,t){var n="";if(!e)return n;var i=e.length?e:e.lstSortingRec;if(!i)return n;var a=void 0;utils.FieldSet.getFieldSet(t,function(e){a=e});for(var r=0;r<i.length;r++){var o=i[r].queryField||"",s=o.indexOf(".");if(s>0)o=o.substring(0,s)+"Table"+o.substring(s);else{if(!a.getFieldType(o))continue;o="MAIN."+o}n&&(n+=", "),n+=o,n+=" "+i[r].sortingOrder}return n&&(n=" ORDER BY "+n),n}},{key:"getExpr",value:function(e,t,n){var i=new $.Deferred;if(t){var a=utils.Cache.readFromJSCache("Expressions",t);if(a){logger.info("Expression exists");var r={exprRecords:a,advancedExpression:a[0].advance_expression,expressionId:t};i.resolve(r)}else logger.info("expression doesnt exists. Fetch expression"),utils.Expressions.evaluate({expressionId:t,data:[],tableName:e,onlyExpressionRecord:!0,onSuccess:SVMX.proxy(this,function(e,t,n){var a={exprRecords:e,advancedExpression:t,expressionId:n};i.resolve(a)}),onError:SVMX.proxy(this,function(e){logger.error("ERROR in _runExpressionOnLineItems: "+e),n&&n.expressionCounter--,i.resolve(e)})})}else i.resolve(null);return i}},{key:"buildQueryForExpression",value:function(e,t){if(e&&e.exprRecords&&e.exprRecords.length){utils.Cache.registerJSCache("sqlExpression",15);var n=utils.Cache.readFromJSCache("sqlExpression",e.expressionId);if(n)logger.info("sqlExpression exist sqlExpression = "+n),e.advancedExpression=n;else{logger.info("sqlExpression doesnt exist. fetch it");for(var i=e.exprRecords,a=0;a<i.length;a++){var r=e.exprRecords[a];r.field_type&&"reference"===r.field_type.toLowerCase()&&"isnotnull"!=r.operator.toLowerCase()&&"isnull"!=r.operator.toLowerCase()?r.source_field_name=t[r.source_field_name]:r.source_field_name="MAIN."+r.source_field_name}for(var o=[],s=0;s<i.length;s++)o[s]=utils.Expressions.__generateExpression(i[s],!0);var l=SVMX.executeSqlExpressions(o);if(!e.advancedExpression){for(var c=[],u=0;u<l.length;u++)c[u]=u+1;e.advancedExpression=c.join(" and ")}for(var d=0;d<l.length;d++){var _=d+1;e.advancedExpression=e.advancedExpression.replace(_,_+"__REPLACE__SVMX__CONDITION")}for(var h=0;h<l.length;h++){var f=h+1;e.advancedExpression=e.advancedExpression.replace(f+"__REPLACE__SVMX__CONDITION",l[h])}utils.Cache.writeToJSCache("sqlExpression",e.expressionId,e.advancedExpression)}logger.info("SQL Expression = "+e.advancedExpression)}}},{key:"buildExpressionOnOperatorType",value:function(e,t,n){if(e&&e.exprRecords&&e.exprRecords.length){logger.info("sqlExpression doesnt exist. fetch it");for(var i=e.exprRecords,a=0;a<i.length;a++){var r=e.exprRecords[a];r.field_type&&"reference"===r.field_type.toLowerCase()&&"isnotnull"!=r.operator.toLowerCase()&&"isnull"!=r.operator.toLowerCase()?r.source_field_name=t[r.source_field_name]:r.source_field_name="MAIN."+r.source_field_name}for(var o=[],s={},l=0;l<i.length;l++){var c=i[l].sequence,u=void 0;if("value"===i[l].operatorType){u=utils.Expressions.__generateExpression(i[l],!0,void 0,!0);var d=s[c];d?d.push(u):s[c]=[u]}else u=utils.Expressions.__generateExpressionForFields(i[l],t,n),o.push({index:c,expr:"("+u+")"})}var _=[];if(s&&(0,_keys2.default)(s).length)for(var h in s){var f=SVMX.executeSqlExpressions(s[h]),p="("+f.join(" AND ")+")";_.push(p)}if(o&&o.length)for(var m=0;m<o.length;m++){var v=o[m];_.splice(v.index,0,v.expr)}if(!e.advancedExpression){for(var g=[],y=0;y<_.length;y++)g[y]=y+1;e.advancedExpression=g.join(" and ")}for(var S=0;S<_.length;S++){var E=S+1;e.advancedExpression=e.advancedExpression.replace(E,E+"__REPLACE__SVMX__CONDITION")}for(var b=0;b<_.length;b++){var T=b+1;e.advancedExpression=e.advancedExpression.replace(T+"__REPLACE__SVMX__CONDITION",_[b])}logger.info("SQL Expression = "+e.advancedExpression)}}},{key:"__getRecordError",value:function(e,t,n){logger.error("SEVERE ERROR: getRecord FAILED: "+n.data.data+" : "+n.data.parameters.query),t.onError&&t.onError(n.data.data),e.reject(n.data.data)}},{key:"__getRecordSuccess",value:function(e,t,n,i,a,r){var o=getDataFromEvt(r);if(0===o.length)return this.__getRecordError(e,t,r);o=o[0],this.__assembleRelatedData(o,i),execQuery({query:"SELECT * FROM SFRecordName WHERE ID IN ({{ids}})",queryParams:{ids:"'"+this.__getMissingIds(o,i).join("','")+"'"}}).then(SVMX.proxy(this,function(a){this.__assembleNameFieldData(o,i,a),this.__fixupReferenceFields(o,i),o=new utils.Record(o,n),this.__fixPicklists(o,t,i),e.resolve(o)}))}},{key:"__assembleRelatedData",value:function(e,t){for(var n=SVMX.array.filter(t,function(e){return"reference"==e.type}),i=0;i<n.length;i++){var a=n[i],r=e[a.name];e[a.name]={key:r,value:e[a.relationshipName||"field"+i],hasViewSFM:!!r&&utils.MetaData.doesObjectHaveViewProcess(utils.MetaData.getTableForId(r))},delete e[a.relationshipName||"field"+i]}}},{key:"__getMissingIds",value:function(e,t){for(var n=[],i=SVMX.array.filter(t,function(e){return"reference"==e.type}),a=0;a<i.length;a++){var r=i[a];e[r.name]&&e[r.name].key&&!e[r.name].value&&n.push(e[r.name].key)}return n}},{key:"__assembleNameFieldData",value:function(e,t,n){var i={};SVMX.array.forEach(n,function(e){i[e.Id]=e.Name});var a=SVMX.array.filter(t,function(e){return"reference"==e.type});this.__assembleNameFieldDataNameMap(e,a,i)}},{key:"__assembleNameFieldDataNameMap",value:function(e,t,n){for(var i=0;i<t.length;i++){var a=t[i];e[a.name]&&!e[a.name].value&&(e[a.name].value=n[e[a.name].key]||e[a.name].key&&e[a.name].key,e[a.name].isNameSyncData=!0,e[a.name].hasViewSFM=!!e[a.name].key&&utils.MetaData.doesObjectHaveViewProcess(utils.MetaData.getTableForId(e[a.name].key)))}}},{key:"__fixupReferenceFields",value:function(e,t){for(var n=SVMX.array.filter(t,function(e){return"reference"==e.type}),i=0;i<n.length;i++){var a=n[i];e[a.name]&&(e[a.name]={fieldvalue:e[a.name],fieldapiname:a.name})}}},{key:"__fixPicklists",value:function(e,t,n){if(t.convertPicklists){var i=e.getFieldsByType("picklist");i=i.concat(e.getFieldsByType("boolean")),i=i.concat(e.getFieldsByType("date")),i=i.concat(e.getFieldsByType("datetime"));for(var a=0;a<i.length;a++){var r=i[a].name,o=i[a].type,s=e[r];""===s&&"boolean"==o&&(s="false"),e[r]={fieldvalue:{value:s,key:s},fieldapiname:r}}}}},{key:"getRefDisplayValue",value:function(e,t,n,i){var a={query:"SELECT ref.{{fieldName}} AS RefName, rn.Name AS DisplayName FROM [{{refTable}}] AS ref LEFT JOIN SFRecordName AS rn ON RefName = rn.Id WHERE ref.Id = '{{recordId}}'",queryParams:{recordId:e,fieldName:t,refTable:n}};return i&&(a.query="SELECT ref.{{fieldName}} AS RefName, ref.{{defaultName}} AS DefaultName, rn.Name AS DisplayName FROM [{{refTable}}] AS ref LEFT JOIN SFRecordName AS rn ON RefName = rn.Id WHERE ref.Id = '{{recordId}}'",a.queryParams.defaultName=i),execQuery(a)}},{key:"getFromRecordNameTable",value:function(e){var t=new $.Deferred;return e.length?execQuery({query:"SELECT Id, Name FROM SFRecordName WHERE Id IN ({{recordId}})",queryParams:{recordId:'"'+e.join('","')+'"'}}):(t.resolve([]),t)}},{key:"insertUpdateRecordIntoNameTable",value:function(e,t){this.getFromRecordNameTable([e]).then(function(n){var i="INSERT INTO SFRecordName (Id, Name) VALUES ('{{id}}','{{name}}')";n&&n.length&&(t.value=t.value||n[0].Name,i="UPDATE SFRecordName SET Id='{{id}}', Name='{{name}}' WHERE Id='{{rec_id}}'"),execQuery({query:i,queryParams:{id:t.key||e,name:t.value,rec_id:e}})})}},{key:"bulkInsertUpdateIntoRecordNameTable",value:function(e){if(e.length>0){for(var t=[],n=0;n<e.length;n++){var i=e[n],a=i.value&&i.value.value||"";t.push("('"+i.key+"','"+a+"')")}execQuery({query:"INSERT OR IGNORE INTO SFRecordName (Id, Name) VALUES "+t.join()})}}},{key:"executeSourceUpdateMapping",value:function(e){var t=new $.Deferred;return execQuery({query:"select SFSourceUpdate.* from SFSourceUpdate LEFT JOIN SFProcessComponent on SFProcessComponent.Id = SFSourceUpdate.target_process_node where SFProcessComponent.process_id='{{process_id}}'",queryParams:{process_id:e.processId}}).then(SVMX.proxy(this,function(n){n||(n=[]);var i=e.data;SVMX.array.forEach(n,function(e){var t=e.display_value;switch(t){case"Now":var n=i.getFieldType(e.source_field_name);"datetime"===n?t=DatetimeUtils.macroDrivenDatetime(t,"YYYY-MM-DD","HH:mm:ss"):"date"===n&&(t=DatetimeUtils.macroDrivenDatetime(t,"YYYY-MM-DD","","date"));break;case"Today":case"Tomorrow":case"Yesterday":var a=i.getFieldType(e.source_field_name);"datetime"===a?(t=DatetimeUtils.macroDrivenDatetime(t,"YYYY-MM-DD","HH:mm:ss"),t=DatetimeUtils.convertToTimezone(t,void 0,!0)):"date"===a&&(t=DatetimeUtils.macroDrivenDatetime(t,"YYYY-MM-DD","","date"));break;default:"datetime"===i.getFieldType(e.source_field_name)&&(t=DatetimeUtils.convertToTimezone(t,void 0,!0))}switch(e.action){case"Set":i.setValue(e.source_field_name,t);break;case"Increase":i.setValue(e.source_field_name,Number(t)+Number(i.getValue(e.source_field_name)));break;case"Decrease":i.setValue(e.source_field_name,Number(i.getValue(e.source_field_name))-Number(t))}},this),i.writeRecord(function(n,i){void 0==e.sync&&(e.sync=!0),e.sync&&(n&&i?utils.Data.writeSyncRecords([i],null,null,null):i&&utils.Data.writeSyncRecords(null,[i],null,null)),t.resolve()},function(e){logger.error("SERIOUS ERROR IN utils.js executeSourceUpdateMapping: "+e),t.resolve()})})),t}},{key:"executeObjectMapping",value:function(e){var t=new $.Deferred,n=[];e.valueMappingId&&n.push(e.valueMappingId),e.objectMappingId&&n.push(e.objectMappingId),e.targetData&&!$.isArray(e.targetData)&&(e.targetData=[e.targetData]);var i="ASC";if(e.valueMappingId&&e.objectMappingId&&(i=e.valueMappingId>e.objectMappingId?"DESC":"ASC"),n.length&&e.targetData.length>=0){var a=nativeService.createSQLRequest();a.bind("REQUEST_ERROR",SVMX.proxy(this,"__executeObjectMappingError",t)),a.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__executeObjectMappingSuccess",t,e.targetData,e.sourceData,e.headSourceData)),a.execute({query:"Select * FROM SFObjectMappingComponent WHERE object_mapping_id IN ('{{object_mapping_id}}') ORDER BY object_mapping_id {{order}}",queryParams:{object_mapping_id:n.join("','"),order:i}})}else t.resolve();return t}},{key:"__executeObjectMappingForGeoLocation",value:function(e){var t=new $.Deferred,n=this,i=e.length;utils.Cache.registerJSCache("LOCATION_TRACKING",1);var a=utils.Cache.readFromJSCache("LOCATION_TRACKING","CURRENT_LOCATION");if(a&&a.locationCapturedDate&&a.success){var r=a.locationCapturedDate,o=DatetimeUtils.getCurrentDatetime(DatetimeUtils.getSaveFormat("dateTime")),s=DatetimeUtils.getDurationBetween(r,o);if(!(Math.ceil(s.asMilliseconds())>3e4))return t.resolve(a);utils.Cache.removeFromJSCache("LOCATION_TRACKING","CURRENT_LOCATION")}for(var l=!1,c=0;c<i;c++)if("SVMX.GEOLOCATION.COORDS.LATITUDE"===e[c].mapping_value||"SVMX.GEOLOCATION.COORDS.ACCURACY"===e[c].mapping_value||"SVMX.GEOLOCATION.COORDS.LONGITUDE"===e[c].mapping_value){l=!0;break}if(l){var u=nativeService.createLocationTrackingRequest();u.bind("REQUEST_COMPLETED",function(e){var n={};e.data.success?(n=SVMX.toObject(e.data.data),n.hasOwnProperty("location")&&n.location.hasOwnProperty("lat")&&(n.location.lat=parseFloat(n.location.lat)),n.hasOwnProperty("location")&&n.location.hasOwnProperty("lng")&&(n.location.lng=parseFloat(n.location.lng)),n.hasOwnProperty("location")&&n.location.hasOwnProperty("acc")&&(n.accuracy=parseFloat(n.accuracy)),n.success=!0,n.locationCapturedDate=DatetimeUtils.getCurrentDatetime(DatetimeUtils.getSaveFormat("dateTime")),utils.Cache.registerJSCache("LOCATION_TRACKING",1),utils.Cache.writeToJSCache("LOCATION_TRACKING","CURRENT_LOCATION",n),t.resolve(n)):(n.success=!1,t.reject(n))},n),u.bind("REQUEST_ERROR",function(e){var n={};n.success=!1,t.reject(n)},n),u.execute()}else{var d={};d.success=!1,t.reject(d)}return t}},{key:"__executeObjectMappingSuccess",value:function(e,t,n,i,a){var r=SVMX.getLoggingService().getLogger("svmxc-mapping-service"),o=getDataFromEvt(a),s=this;if(0===o.length)return e.fail(a);var l=function(a){n=n||{},i=i||{},a=a||{};var l=t.length*o.length,c=function(){0==--l&&e.resolve()},u=function(e){var t="";if(a&&a.success)switch(e){case"SVMX.GEOLOCATION.COORDS.LATITUDE":t=a.location.lat;break;case"SVMX.GEOLOCATION.COORDS.LONGITUDE":t=a.location.lng;break;case"SVMX.GEOLOCATION.COORDS.ACCURACY":t=a.accuracy}return t};utils.FieldSet.getFieldSet(t[0].sobjectinfo.attributes.type,SVMX.proxy(s,function(e){SVMX.array.forEach(t,function(t){SVMX.array.forEach(o,function(a){var o=a.target_field_name;if(o&&"id"===o.toLowerCase())return r.error("Field Mapping: Cannot mapping into id field. Please remove the mapping!"),c(),!0;var l=e.getField(o)||{type:"string",name:o},d=a.mapping_value,_=void 0;if(0!==d&&""!==d&&void 0!==(d.match(/^SVMX.CURRENTRECORD\./)||{}).input){var h=d.match(/SVMX\.CURRENTRECORD\.(.*)/)[1];_=t.sobjectinfo[h],_&&"object"===(void 0===_?"undefined":(0,_typeof3.default)(_))&&_.fieldvalue&&_.fieldvalue.key&&void 0===_.fieldvalue.value&&(_.fieldvalue.value=_.fieldvalue.key),t.sobjectinfo[o]=_}else if(0!==d&&""!==d&&void 0!==(d.match(/^SVMX.CURRENTRECORDHEADER/)||{}).input){var f=d.match(/SVMX\.CURRENTRECORDHEADER\.(.*)/)[1];_=i[f],_&&"object"===(void 0===_?"undefined":(0,_typeof3.default)(_))&&_.fieldvalue&&_.fieldvalue.key&&void 0===_.fieldvalue.value&&(_.fieldvalue.value=_.fieldvalue.key),t.sobjectinfo[o]=_}else if(0!==d&&""!==d){switch(d){case"Now":case"Today":case"Tomorrow":case"Yesterday":d=DatetimeUtils.macroDrivenDatetime(d,"YYYY-MM-DD","HH:mm:ss");break;case"SVMX.NOW":d=DatetimeUtils.macroDrivenDatetime("Now","YYYY-MM-DD","HH:mm:ss");break;case"SVMX.TODAY":d=DatetimeUtils.macroDrivenDatetime("Today","YYYY-MM-DD","HH:mm:ss");break;case"SVMX.TOMORROW":d=DatetimeUtils.macroDrivenDatetime("Tomorrow","YYYY-MM-DD","HH:mm:ss");break;case"SVMX.YESTERDAY":d=DatetimeUtils.macroDrivenDatetime("Yesterday","YYYY-MM-DD","HH:mm:ss");break;case"SVMX.CURRENTUSERID":case"SVMX.CURRENTUSER":case"SVMX.OWNER":"reference"===l.type?d={fieldvalue:{key:utils.SystemData.getUserInfo().UserId,value:utils.SystemData.getUserInfo().UserName},fieldapiname:l.name}:"boolean"!==l.type&&"date"!==l.type&&"datetime"!==l.type&&(d=utils.SystemData.getUserInfo().UserName);break;case"SVMX.USERTRUNK":var p=utils.SystemData.getUserInfo().UserTrunkDetail?utils.SystemData.getUserInfo().UserTrunkDetail.Id:null;d=p;break;case"SVMX.GEOLOCATION.COORDS.ACCURACY":case"SVMX.GEOLOCATION.COORDS.LATITUDE":case"SVMX.GEOLOCATION.COORDS.LONGITUDE":d=u(d)}switch(l.type){case"boolean":"string"==typeof d&&(d=d.toLowerCase());case"picklist":t.sobjectinfo[o]={fieldvalue:{key:d,value:d},fieldapiname:o};break;case"date":if("Now"!==a.mapping_value&&"Today"!==a.mapping_value&&"Tomorrow"!==a.mapping_value&&"Yesterday"!==a.mapping_value&&"SVMX.NOW"!==a.mapping_value&&"SVMX.TODAY"!==a.mapping_value&&"SVMX.TOMORROW"!==a.mapping_value&&"SVMX.YESTERDAY"!==a.mapping_value)break;t.sobjectinfo[o]={fieldvalue:{key:d,value:d},fieldapiname:o};break;case"datetime":if("Now"!==a.mapping_value&&"Today"!==a.mapping_value&&"Tomorrow"!==a.mapping_value&&"Yesterday"!==a.mapping_value&&"SVMX.NOW"!==a.mapping_value&&"SVMX.TODAY"!==a.mapping_value&&"SVMX.TOMORROW"!==a.mapping_value&&"SVMX.YESTERDAY"!==a.mapping_value)break;"Now"!==a.mapping_value&&"SVMX.NOW"!==a.mapping_value&&(d=DatetimeUtils.convertToTimezone(d,void 0,!0)),t.sobjectinfo[o]={fieldvalue:{key:d,value:d},fieldapiname:o};break;default:t.sobjectinfo[o]=d}}else{void 0!==(d=s.getFieldValue(n,a.source_field_name))&&null!==d||(d="");var m="object"===(void 0===d?"undefined":(0,_typeof3.default)(d))&&void 0!==d.fieldvalue?d.fieldvalue.value:d;switch(void 0!==m&&null!==m&&""!==m||!a.preference_2||(d=s.getFieldValue(n,a.preference_2)),m="object"===(void 0===d?"undefined":(0,_typeof3.default)(d))&&void 0!==d.fieldvalue?d.fieldvalue.value:d,void 0!==m&&null!==m&&""!==m||!a.preference_3||(d=s.getFieldValue(n,a.preference_3)),void 0!==d&&null!==d||(d=""),l.type){case"boolean":"string"==typeof d&&(d=d.toLowerCase());case"picklist":case"date":case"datetime":t.sobjectinfo[o]="object"===(void 0===d?"undefined":(0,_typeof3.default)(d))?d:{fieldvalue:{key:d,value:d}},t.sobjectinfo[o].fieldapiname=o;break;default:t.sobjectinfo[o]=d}}var d=t.sobjectinfo[o];if("RecordTypeId"===o&&"reference"===l.type){var v=t.sobjectinfo.RecordTypeId;"object"===(void 0===v?"undefined":(0,_typeof3.default)(v))&&"fieldvalue"in v?(t.sobjectinfo.RecordTypeId=v,c()):utils.MetaData.describeObject({objectName:t.sobjectinfo.getTableName(),onSuccess:SVMX.proxy(s,function(e){var n=e.recordTypeInfos,i=SVMX.array.get(n,function(e){return e.fixedName===v});i&&(v=i.name,i=i.recordTypeId),t.sobjectinfo.RecordTypeId={fieldvalue:{key:i,value:v},fieldapiname:"RecordTypeId"},c()}),onError:function(e){r.error("ERROR: executeObjectMapping describeObject call failed: "+e),c()}})}else"reference"===l.type&&d&&"object"!==(void 0===d?"undefined":(0,_typeof3.default)(d))&&"RecordTypeId"!=o?(d={fieldvalue:{key:d,value:null},fieldapiname:l.name},"id"===a.source_field_name.toLowerCase()?(d.fieldvalue.value=n[utils.MetaData.getNameField(n.attributes.type)],t.sobjectinfo[o]=d,c()):utils.Data.getRecord({Id:d.fieldvalue.key}).then(function(e){d.fieldvalue.value=e.getNameValue(),t.sobjectinfo[o]=d,c()},function(e){c()})):c();r.info("ObjectMap: SET "+o+" TO "+t.sobjectinfo[o])},s)},s),0===l&&c()}))};s.__executeObjectMappingForGeoLocation(o).done(function(e){l(e)}).fail(function(e){l(e)})}},{key:"getFieldValue",value:function(e,t){if(t in e)return e[t];var n={};return SVMX.forEachProperty(e,function(e,t){n[e.toLowerCase()]=t}),n[t.toLowerCase()]}},{key:"__executeObjectMappingError",value:function(e,t){logger.error("Unable to find Object Mapping: "+t.data.data+"; "+t.data.parameters.query),e.resolve()}},{key:"getAllReferences",value:function(e){var t=new $.Deferred;if(e.onSuccess&&t.done(function(t){e.onSuccess(t)}),e.onError&&t.fail(function(t){e.onError(t)}),0===e.data.length)return t.resolve(e.data),t;e.referencedSetCounter=0;var n=utils.MetaData.getTableForId(e.data[0].Id);return n?(utils.MetaData.describeObject({objectName:n,onSuccess:SVMX.proxy(this,function(n){var i=n.fields,a=n.recordTypeInfos;if(e.convertPicklists)for(var r=SVMX.array.filter(i,function(e){return"picklist"===e.type}),o=0;o<r.length;o++){var s=r[o].name;SVMX.array.forEach(e.data,function(e){var t=e[s];e[s]={fieldvalue:{value:t,key:t},fieldapiname:s}})}var l=SVMX.array.filter(i,function(e){return e.referenceTo.length});e.referencedSetCounter=l.length;for(var o=0;o<l.length;o++)this.__getAllReferencesForField(e,l[o],a,t);0===e.referencedSetCounter&&t.resolve(e.data)})}),t):(logger.error("FATAL ERROR: Could not find table for Id "+e.data[0].Id+" in getAllReferences"),t.reject("Could not find table"),t)}},{key:"__getAllReferencesForField",value:function(e,t,n,i){var a=t.name,r=SVMX.array.map(e.data,function(e){return e[a]}),o=SVMX.array.filter(r,function(e){return e});if(0===o.length)return void(0==--e.referencedSetCounter&&i.resolve(e.data));var s=utils.MetaData.getTableForId(o[0]);if(s)if("RecordTypeId"===a){for(var l=e.data,c=0;c<l.length;c++){var u=l[c].RecordTypeId,d=SVMX.array.filter(n,function(e){return e.recordTypeId===u})[0];d=void 0===d?u:d.name,e.replaceReferenceWithString?l[c].RecordTypeId=u:l[c].RecordTypeId={fieldvalue:{key:u,value:d},fieldapiname:"RecordTypeId"}}0===--e.referencedSetCounter&&i.resolve(e.data)}else{var _=utils.MetaData.getNameField(s),h=nativeService.createSQLRequest();h.bind("REQUEST_ERROR",SVMX.proxy(this,"__getAllReferencesForFieldError",e,i)),h.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__getAllReferencesForFieldSuccess",a,r,e,i)),h.execute({query:"SELECT {{name_field}} as name_field_value, Id, '{{replace_field}}' as replace_field FROM '{{table_name}}' where Id IN({{Ids}})",queryParams:{table_name:s,Ids:"'"+r.join("','")+"'",name_field:_,replace_field:a}})}else this.__getAllReferencesForFieldSuccess(a,r,e,i,{data:{}})}},{key:"__getAllReferencesForFieldError",value:function(e,t,n){0==--e.referencedSetCounter&&t.resolve(e.data)}},{key:"__getAllReferencesForFieldSuccess",value:function(e,t,n,i,a){var r=a.data.parameters&&a.data.parameters.query.match(/SFRecordName/),o=Boolean(!a.data.data),s=o?null:getDataFromEvt(a),l={},c=!1;if(o||0!==s.length||(o=!0),o)c=!0;else{SVMX.array.forEach(t,function(e){e&&(l[e]=!1)},this);for(var u=s[0].replace_field,d=0;d<s.length;d++){var _=s[d];l[_.Id]=_.name_field_value}for(var h=n.data,d=0;d<h.length;d++){var f=h[d][u],p=l[f];!1!==p&&(void 0===p&&(p=f),n.replaceReferenceWithString?h[d][u]=p:h[d][u]&&"object"===(0,_typeof3.default)(h[d][u])||(h[d][u]={fieldvalue:{key:f,value:p},fieldapiname:u},r&&(h[d][u].fieldvalue.isNameSyncData=!0)))}t=[],SVMX.forEachProperty(l,function(e,n){!1===n&&(c=!0,t.push(e))})}if(!c||a.data.parameters&&a.data.parameters.query.match(/SFRecordName/))n.referencedSetCounter--;else{var m=nativeService.createSQLRequest();m.bind("REQUEST_ERROR",SVMX.proxy(this,"__getAllReferencesForFieldError",n,i)),m.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__getAllReferencesForFieldSuccess",e,t,n,i)),m.execute({query:"SELECT Id, Name as name_field_value, '{{replace_field}}' as replace_field FROM SFRecordName WHERE Id IN({{Ids}})",queryParams:{Ids:"'"+t.join("','")+"'",replace_field:e}})}0===n.referencedSetCounter&&i.resolve(n.data)}},{key:"updateExternalLocalRecords",value:function(e,t){function n(e,t){var n=SVMX.Deferred();return execQuery({query:"UPDATE {{parent_object_name}} SET {{parent_field_name}} = '{{parent_field_value}}' WHERE Id = '{{parent_record_id}}'",queryParams:{parent_object_name:e.parent_object_name,parent_field_name:e.parent_field_name,parent_record_id:e.parent_record_id,parent_field_value:t}}).then(SVMX.proxy(this,function(t){logger.info("Sync Dependent record ("+e.parent_record_id+") update completed"),i(e,n)}),SVMX.proxy(this,function(t){logger.info("Sync Dependent record ("+e.parent_record_id+") update failed"),n.resolve()})),n}function i(e,t){execQuery({query:"DELETE FROM SyncDependentLog WHERE parent_field_name = '{{parent_field_name}}' AND parent_record_id = '{{parent_record_id}}'",queryParams:{parent_field_name:e.parent_field_name,parent_record_id:e.parent_record_id}}).then(SVMX.proxy(this,function(n){logger.info("Sync Dependent log ("+e.local_id+") delete completed"),t.resolve()}),SVMX.proxy(this,function(n){logger.info("Sync Dependent log ("+e.local_id+") delete failed"),t.resolve()}))}var a=e.insertRecordsMap,r=[];for(var o in a)r.push(o),this.insertUpdateRecordIntoNameTable(o,{key:a[o]});if(!r.length)return t&&t.handler.call(t.context);(function(e){var t=SVMX.Deferred();return execQuery({query:"SELECT parent_object_name, local_id, parent_record_id, parent_field_name FROM SyncDependentLog WHERE local_id IN ('{{ids}}')",queryParams:{ids:e.join("','")}}).then(SVMX.proxy(this,function(e){t.resolve(e)}),SVMX.proxy(this,function(e){logger.info("Sync Dependent records query failed"),t.resolve()})),t})(r).done(SVMX.proxy(this,function(e){if(e&&e.length){for(var i=[],r=0;r<e.length;r++)i.push(n(e[r],a[e[r].local_id]));$.when(i).then(function(){t&&t.handler.call(t.context)})}else t&&t.handler.call(t.context)}))}},{key:"deleteContentVersions",value:function(e,t){var n=nativeService.createSQLRequest(),i=this,a=e.join("','");n.execute({query:"select Id from ContentDocumentLink where ContentDocumentId IN ('"+a+"')"}),n.bind("REQUEST_ERROR",function(){}),n.bind("REQUEST_COMPLETED",function(e){if(e&&e.data&&e.data.data){for(var n=e.data.data,a=[],r=0;r<n.length;r++){var o=n[r];a.push(o.Id)}a.length>0&&i.deleteSfFileRelatedTables(a,t,!0)}})}},{key:"deleteSfFileRelatedTables",value:function(e,t,n,i){var a=SVMX.Deferred(),r=nativeService.createSQLRequest(),o=this,s=e.join("','");return r.execute({query:"select Id, ContentDocumentId from ContentDocumentLink where ContentDocumentId IN (select ContentDocumentId from ContentDocumentLink where Id in ('"+s+"'))"}),r.bind("REQUEST_ERROR",function(){}),r.bind("REQUEST_COMPLETED",function(e){var i=[],r=[];if(e&&e.data&&e.data.data)for(var s=e.data.data,l=0;l<s.length;l++){var c=s[l];-1===r.indexOf(c.ContentDocumentId)&&r.push(c.ContentDocumentId),-1===i.indexOf(c.Id)&&i.push(c.Id)}o.deleteAttachmentFiles(i,t,n).then(function(){if(r.length>0){var e=r.join("','");execQuery({queryArray:["DELETE FROM ContentDocumentLink WHERE ContentDocumentId IN ('"+e+"');","DELETE FROM ContentVersion WHERE ContentDocumentid IN ('"+e+"');","DELETE FROM ContentDocument WHERE Id IN ('"+e+"');"]}).then(function(){a.resolve()}).fail(function(){a.reject()})}})}),a}},{key:"getSFilePathInfo",value:function(e){if(e&&e.name){var t=e.name.split("."),n=t.length-1,i=t.length>1?t[n]:"---";if(e.fileExtName=i,"SFILE"===e.file_type&&e.content_type){var a="."+e.content_type.toLowerCase();e.name.toLowerCase().includes(a)||(e.name=""+e.name+a),e.file_path.toLowerCase().includes(a)||(e.file_path=""+e.file_path+a),e.fileExtName=i}}return e}},{key:"deleteAttachmentFiles",value:function(e,t,n){var i=this,a=new $.Deferred;return e&&e.length?execQuery({query:"SELECT Id, parent_id ,file_path , content_document_id as cdId, name, content_type, file_type FROM SFAttachments WHERE Id IN ('{{Ids}}') OR content_document_id IN (SELECT ContentDocumentId FROM ContentDocumentLink cdl WHERE Id IN ('{{Ids}}'))",queryParams:{Ids:e.join("','")}}).then(SVMX.proxy(this,function(e){var t=0;if(0==e.length)return a.resolve();for(var r=0;r<e.length;r++)!function(r){var o=i.getSFilePathInfo(e[r]),s=o.file_path,l=o.Id,c=o.cdId,u=o.parent_id||"";if(s){var d=new NativeServiceFile(s);d.info().then(function(e){d.deleteFile()})}utils.Data.deleteRecord({Id:l,tableName:"SFAttachments",parentId:u,onSuccess:function(i){if(n){var r={};r.Id=c,r.parentId=u,r.recordType="attachment",r.objectName="ContentDocument",utils.Data.writeSyncRecords([],[],[r],function(){})}if(++t===e.length){var o=SVMX.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),s=SVMX.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{attachmentActionName:"refreshAllAttachments"}});o.triggerEvent(s),a.resolve()}},onError:function(){logger.error("Error in deleteChecklistAttachmentData for Attachments"),++t===e.length&&a.resolve()}})}(r)})):a.resolve(),a}}]),t}(SVMXObject),utils.Data.__insertKeyIndex=1,utils.Data.__insertKeyTimestamp=(new Date).getTime(),utils.MetaData=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"describeObject",value:function(e){var t=new $.Deferred;e=e||{},e.onSuccess=e.onSuccess||function(){},utils.Cache.registerJSCache("DescribeObject",50);var n=utils.Cache.readFromJSCache("DescribeObject",e.objectName);if(n)return e.sync?(e.onSuccess(n),t.resolve(n)):SVMX.doLater(function(){e.onSuccess(n),t.resolve(n)},this),t;if(e.deferred=t,this.__describeObjectPendingEvents[e.objectName])return this.__describeObjectPendingEvents[e.objectName].push(e),t;this.__describeObjectPendingEvents[e.objectName]=[e];var i=nativeService.createSQLRequest();return i.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__onDescribeObjectSuccess",e)),i.bind("REQUEST_ERROR",SVMX.proxy(this,"__onDescribeObjectError",e)),i.execute({query:"SELECT object_describe FROM SFObjectDescribe WHERE object_name='{{object_name}}'",queryParams:{object_name:e.objectName}}),t}},{key:"__onDescribeObjectSuccess",value:function(e,t){var n=getDataFromEvt(t);if(!n.length||!n[0].object_describe)return this.__onDescribeObjectError(e,t);n=SVMX.toObject(n[0].object_describe),SVMX.array.forEach(n.fields,function(e){e.accessible=!0}),SVMX.array.forEach(n.recordTypeInfos,function(e){e.fixedName=utils.MetaData.getRecordTypeNameFromId(e.recordTypeId)},this),SVMX.array.forEach(n.fields,function(e){e.dataType=e.type}),utils.Cache.writeToJSCache("DescribeObject",e.objectName,n);for(var i=this.__describeObjectPendingEvents[e.objectName],a=0;a<i.length;a++)i[a].onSuccess&&i[a].onSuccess(n,e.objectName),i[a].deferred.resolve(n);delete this.__describeObjectPendingEvents[e.objectName]}},{key:"__onDescribeObjectError",value:function(e,t){logger.error("DescribeObject Failed: "+t.data.parameters.query+"; "+t.data.data);var n=this.__describeObjectPendingEvents[e.objectName];delete this.__describeObjectPendingEvents[e.objectName];for(var i=0;i<n.length;i++)n[i].onError&&n[i].onError(t,e.objectName),n[i].deferred.reject(t,e.objectName)}},{key:"getObjectNameFromKeyPrefix",value:function(e){var t=new $.Deferred;e=e||{},e.onSuccess=e.onSuccess||function(){},e.deferred=t,utils.Cache.registerJSCache("KeyPrefix_ObjectName_Mapping",150);var n=utils.Cache.readFromJSCache("KeyPrefix_ObjectName_Mapping",e.key_prefix);if(n)SVMX.doLater(function(){e.onSuccess(n),t.resolve(n)},this);else{if(this.__describeKeyPrefixEvents[e.key_prefix])return void this.__describeKeyPrefixEvents[e.key_prefix].push(e);this.__describeKeyPrefixEvents[e.key_prefix]=[e];var i=nativeService.createSQLRequest();i.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__ongetObjectNameFromKeyPrefixSuccess",e)),i.bind("REQUEST_ERROR",SVMX.proxy(this,"__ongetObjectNameFromKeyPrefixError",e)),i.execute({query:"SELECT object_name, key_prefix FROM SFObjectDescribe"})}return t}},{key:"__ongetObjectNameFromKeyPrefixSuccess",value:function(e,t){var n=getDataFromEvt(t),i=n.length,a=void 0,r=0;if(!i)return this.__ongetObjectNameFromKeyPrefixError(e,t);for(r;r<i;r++){var o=n[r].key_prefix,s=n[r].object_name;utils.Cache.writeToJSCache("KeyPrefix_ObjectName_Mapping",o,s),o===e.key_prefix&&(a=s)}for(var l=this.__describeKeyPrefixEvents[e.key_prefix],r=0;r<l.length;r++)l[r].onSuccess&&l[r].onSuccess(a),l[r].deferred.resolve(a);delete this.__describeKeyPrefixEvents[e.key_prefix]}},{key:"__ongetObjectNameFromKeyPrefixError",value:function(e,t){logger.error("DescribeObject Failed: "+t.data.parameters.query+"; "+t.data.data);var n=this.__describeKeyPrefixEvents[e.key_prefix];delete this.__describeKeyPrefixEvents[e.key_prefix];for(var i=0;i<n.length;i++)n[i].onError&&n[i].onError(t,e.key_prefix),n[i].deferred.reject(t,e.key_prefix)}},{key:"isTableInDatabase",value:function(e,t){var n=this.__tablesInDbHash?this.__tablesInDbHash[e]:null;return t&&t(n),n}},{key:"registerNewTableInDatabase",value:function(e){this.__tablesInDbHash&&(this.__tablesInDbHash[e]=!0)}},{key:"getTablesInDatabase",value:function(){return this.__tablesInDbHash}},{key:"__setupTableInDBData",value:function(){var e=new $.Deferred,t=nativeService.createSQLRequest();return t.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(t){this.__tablesInDbHash={};try{for(var n=0;n<t.data.data.length;n++)this.__tablesInDbHash[t.data.data[n].name]=!0}catch(e){logger.error("SERIOUS ERROR IN __setupTableInDBData: "+e.data)}e.resolve()})),t.bind("REQUEST_ERROR",function(t){logger.error("ERROR: __setupTableInDBData failed; this error is expected prior to initial sync and is serious if it occurs after sync"),e.resolve()}),t.execute({query:"SELECT name FROM sqlite_master"}),e}},{key:"__setupObjectsWithViewProcesses",value:function(){var e=new $.Deferred,t=nativeService.createSQLRequest();return t.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(t){this.__objectsWithViewProcessesHash={};try{for(var n=0;n<t.data.data.length;n++)this.__objectsWithViewProcessesHash[t.data.data[n].object_name]=!0}catch(e){logger.error("SERIOUS ERROR IN __setupObjectsWithViewProcesses: "+e.data)}e.resolve()})),t.bind("REQUEST_ERROR",function(t){logger.error("ERROR: __setupObjectsWithViewProcesses failed; this error is expected prior to initial sync and is serious if it occurs after sync"),e.resolve()}),t.execute({query:"select object_name from SFProcess LEFT JOIN SFProcessComponent ON SFProcessComponent.process_id = SFProcess.process_id WHERE process_type='VIEW RECORD' group by object_name"}),e}},{key:"doesObjectHaveViewProcess",value:function(e){return Boolean(this.__objectsWithViewProcessesHash[e])}},{key:"__setupRecordTypeIds",value:function(){var e=new $.Deferred,t=nativeService.createSQLRequest();return t.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(t){this.__recordTypeIdCache={};try{for(var n=0;n<t.data.data.length;n++){var i=t.data.data[n];this.__recordTypeIdCache[i.Id]=i.Name}}catch(e){logger.error("SERIOUS ERROR IN __setupRecordTypeIds: "+e.data)}e.resolve()})),t.bind("REQUEST_ERROR",function(t){logger.error("ERROR: __setupRecordTypeIds failed; this error is expected prior to initial sync and is serious if it occurs after sync"),e.resolve()}),t.execute({query:"SELECT Name, Id FROM RecordType"}),e}},{key:"getRecordTypeNameFromId",value:function(e){return this.__recordTypeIdCache[e]}},{key:"getTableForId",value:function(e,t){return t&&t(this.__tablePrefixHash[e.substring(0,3)]),this.__tablePrefixHash[e.substring(0,3)]}},{key:"__setupTableIdPrefixes",value:function(e){var t=new $.Deferred,n=nativeService.createSQLRequest();return n.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(e){this.__tablePrefixHash={},this.__tableReversePrefixHash={};try{for(var n=0;n<e.data.data.length;n++)this.__tablePrefixHash[e.data.data[n].key_prefix]=e.data.data[n].object_name,this.__tableReversePrefixHash[e.data.data[n].object_name]={prefix:e.data.data[n].key_prefix,label:e.data.data[n].label}}catch(e){logger.error("SERIOUS ERROR IN __setupTableIdPrefixes: "+e.data)}t.resolve()})),n.bind("REQUEST_ERROR",function(e){logger.error("FATAL ERROR: setupTableIdPrefixes failed; this error is expected prior to initial sync and is serious if it occurs after sync"),t.resolve()}),n.execute({query:"SELECT object_name, key_prefix, label from SFObjectDescribe"}),t}},{key:"getIdForTable",value:function(e,t){return this.__tableReversePrefixHash[e].prefix}},{key:"getLabelForTable",value:function(e,t){return this.__tableReversePrefixHash[e].label}},{key:"getNameField",value:function(e,t){var n=void 0;return this.__nameFieldsHash.hasOwnProperty(e)&&(n=this.__nameFieldsHash[e]),n="Case"==e?"CaseNumber":"Event"==e?"Subject":"Solution"==e?"SolutionName":"PartnerNetworkConnection"==e?"ConnectionName":"Task"==e?"Subject":"Name",t&&t(n),n}},{key:"__setupNameFieldData",value:function(e){var t=new $.Deferred,n=nativeService.createSQLRequest();return n.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(e){this.__nameFieldsHash={};var n=e.data.data;try{for(var i=0;i<n.length;i++)this.__nameFieldsHash[n[i].object_api_name]=n[i].api_name}catch(e){logger.error("SERIOUS ERROR IN __setupNameFieldData: "+e.data)}t.resolve()})),n.bind("REQUEST_ERROR",function(e){logger.error("FATAL ERROR: setupNameFieldData Failed; this error is expected prior to initial sync and is serious if it occurs after sync"),t.resolve()}),n.execute({query:"SELECT object_api_name, api_name FROM SFObjectField WHERE name_field = 'true'"}),t}},{key:"getProcess",value:function(e){return e.componentType||(e.componentType="TARGET"),execQuery({query:"SELECT SFProcess.*, SFProcessComponent.object_name as target_object_name, SFProcessComponent.expression_id, SFProcessComponent.value_mapping_id, SFProcessComponent.object_mapping_id FROM SFProcess LEFT JOIN SFProcessComponent ON SFProcess.process_id = SFProcessComponent.process_id WHERE component_type='{{component_type}}' AND {{id_name}}='{{process_id}}'",queryParams:{id_name:e.salesforceProcessId?"SFProcess.process_id":"process_unique_id",process_id:e.salesforceProcessId||e.processId,component_type:e.componentType},onSuccess:e.onSuccess,onError:e.onError})}},{key:"getExpressionIdFromProcessId",value:function(e){this.getProcess({processId:e.processId,salesforceProcessId:e.salesforceProcessId,onSuccess:SVMX.proxy(this,function(t){var n=t.data.data;n&&0!==n.length?e.onSuccess&&e.onSuccess(n[0].expression_id):e.onSuccess&&e.onSuccess(n)}),onError:SVMX.proxy(this,function(t){e.onError})})}},{key:"getQualifiedProcessesForRecord",value:function(e){var t=SVMX.Deferred(),n=[],i=null;return this.getDefaultView(e).then(SVMX.proxy(this,function(a){!0===e.considerDefaultView&&a&&a.length>0?(logger.info("Considered default View Process: "+a[0].process_unique_id),t.resolve(a)):execQuery({query:"Select SFProcess.*, SFProcessComponent.object_name as target_object_name, SFProcessComponent.expression_id FROM SFProcess LEFT JOIN SFProcessComponent ON SFProcess.process_id = SFProcessComponent.process_id WHERE (process_type = '{{process_type}}' AND component_type='TARGET' AND target_object_name = '{{object_name}}') ORDER BY process_unique_id",queryParams:{object_name:e.objectName,process_type:e.processType}}).then(SVMX.proxy(this,this.validateProcessesQualificationForRecord,e)).then(SVMX.proxy(this,function(a,r){n=a,i=r,!0===e.considerDefaultView&&"VIEW RECORD"===e.processType&&n&&n.length>0?this.setDefaultView({objectName:e.objectName,defaultProcess:n[0].process_unique_id}).then(SVMX.proxy(this,function(){t.resolve(n,i)})):t.resolve(n,i)}))})),t}},{key:"validateProcessesQualificationForRecord",value:function(e,t){var n=SVMX.Deferred(),i=[],t=t||[],a=t.length;return a?utils.Data.getRecord({Id:e.recordId,record:e.record,loadReferences:!0,convertPicklists:!1}).then(SVMX.proxy(this,function(e){e?SVMX.array.forEach(t,function(t){t.expression_id?utils.Expressions.evaluate({data:e,expressionId:t.expression_id,onSuccess:SVMX.proxy(this,function(r){r[0]?i.push(t):logger.info("Process "+t.process_unique_id+" failed qualifying criteria"),0==--a&&n.resolve(i,e)})}):(i.push(t),0==--a&&n.resolve(i,e))},this):n.resolve(t,null)})):n.resolve([],null),n}},{key:"getDefaultView",value:function(e){var t=SVMX.Deferred();return e.data,!0===e.considerDefaultView?utils.Cache.readObjectFromDBCache("DEFAULT_VIEW."+e.objectName,function(n){this.getProcess({processId:n,onSuccess:SVMX.proxy(this,function(n){var i=n.data.data;this.validateProcessesQualificationForRecord(e,i).then(SVMX.proxy(this,function(e,n){t.resolve(e,n)}))}),onError:SVMX.proxy(this,function(e){t.resolve([],null)})})},this):t.resolve([],null),t}},{key:"setDefaultView",value:function(e){var t=SVMX.Deferred();return utils.Cache.writeToDBCache("DEFAULT_VIEW."+e.objectName,e.defaultProcess,function(){logger.info("saved process ("+e.defaultProcess+") as default view for object "+e.objectName),t.resolve()},this),t}},{key:"getDetailLineNamesForObject",value:function(e,t){var n=new $.Deferred;return this.describeObject({objectName:e}).done(SVMX.proxy(this,function(e){var t={},i=e.childRelationships;if(i){for(var a=0;a<i.length;a++){var r=i[a];r.cascadeDelete&&(t[r.childSObject]=r.field)}n.resolve(t)}else n.reject("Object describe doesn't contain childRelationships")})),n}}]),t}(SVMXObject),utils.MetaData.__nameFieldsHash=null,utils.MetaData.__tableReversePrefixHash=null,utils.MetaData.__tablePrefixHash=null,utils.MetaData.__recordTypeIdCache={},utils.MetaData.__objectsWithViewProcessesHash=null,utils.MetaData.__tablesInDbHash=null,utils.MetaData.__describeKeyPrefixEvents={},utils.MetaData.__describeObjectPendingEvents={},utils.SetupNameFieldExtension=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"perform",value:function(e){return utils.MetaData.__setupNameFieldData()}}]),t}(AbstractExtension),utils.SetupTableIdPrefixExtension=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"perform",value:function(e){return utils.MetaData.__setupTableIdPrefixes()}}]),t}(AbstractExtension),utils.SetupTableInDBExtension=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"perform",value:function(e){return utils.MetaData.__setupTableInDBData()}}]),t}(AbstractExtension),utils.CacheRecordTypeIdsExtension=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"perform",value:function(e){return utils.MetaData.__setupRecordTypeIds()}}]),t}(AbstractExtension),utils.CacheObjectsWithViewProcessesExtension=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"perform",value:function(e){return utils.MetaData.__setupObjectsWithViewProcesses()}}]),t}(AbstractExtension),utils.SyncData=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"insertRecord",value:function(e,t){e&&this.writeSyncRecords({insertRecords:[e],callback:t})}},{key:"updateRecord",value:function(e,t){e&&this.writeSyncRecords({updateRecords:[e],callback:t})}},{key:"deleteRecord",value:function(e,t){e&&this.writeSyncRecords({deleteRecords:[e],callback:t})}},{key:"insertAttachment",value:function(e,t){e&&this.insertRecord({Id:e.Id,isAttachment:!0,parentId:e.parentId||""},t)}},{key:"isRecordInConflict",value:function(e){var t=new $.Deferred;return execQuery({query:"SELECT operation FROM ClientSyncConflict WHERE Id='{{Id}}' AND error_type='conflict'",queryParams:{Id:e}}).then(function(e){t.resolve(Boolean(e.length))}),t}},{key:"addOpenRecords",value:function(e,t){this.__openRecordOwners[e]=t}},{key:"removeOpenRecords",value:function(e){delete this.__openRecordOwners[e]}},{key:"removeOpenRecord",value:function(e,t){var n=this.__openRecordOwners[e];if(n){var i=n.indexOf(t);i>=0&&delete n[i]}}},{key:"updateOpenRecordId",value:function(e,t){SVMX.forEachProperty(this.__openRecordOwners,function(n,i){var a=i.indexOf(e);a>=0&&(i[a]=t)})}},{key:"getOpenRecords",value:function(){var e=[],t={};return SVMX.forEachProperty(this.__openRecordOwners,function(n,i){SVMX.array.forEach(i,function(n){n&&(t[n]||(t[n]=!0),e.push(n))})}),e}},{key:"isRecordOpen",value:function(e){var t=this.getOpenRecords();return SVMX.array.contains(t,function(t){return t===e})}},{key:"setOwnerId",value:function(e){this.__ownerId=e}},{key:"getOwnerId",value:function(){return this.__ownerId}},{key:"addOpenRecordRemoteId",value:function(e,t){this.__openRecordRemoteIds[e]=t,this.updateOpenRecordId(e,t)}},{key:"getOpenRecordRemoteIds",value:function(){return this.__openRecordRemoteIds}},{key:"getOpenRecordRemoteId",value:function(e){return this.__openRecordRemoteIds[e]}},{key:"addSyncPutInsertRecordId",value:function(e){this.__syncPutInsertRecords[e]=e}},{key:"removeSyncPutInsertRecordId",value:function(e){this.__syncPutInsertRecords[e]&&delete this.__syncPutInsertRecords[e]}},{key:"getSyncPutInsertRecordIds",value:function(){return this.__syncPutInsertRecords}},{key:"writeSyncRecords",value:function(e){function t(t,n){for(var i=0,a=e.insertRecords.length;i<a;i++){var r=e.insertRecords[i];if(r.Id in t)e.updateRecords.push(r);else{var o=r.recordType;o||(o="detail",r.isAttachment?o="attachment":r.parentId||(o="master"));var s={id:r.Id,parent_id:r.parentId,table_name:u,record_type:o,operation:"insert",old_values:SVMX.toJSON(r.oldValues)||"",new_values:SVMX.toJSON(r.newValues)||"",modified_at:_};c&&(r.objectName&&(s.objname_fld=",object_name",s.object_name=",'"+r.objectName+"'"),s.changetype_fld=",change_type",s.change_type=",'"+d+"'"),n.push(SVMX.string.substitute(h,s))}}}function n(t,n){for(var i=0,a=e.updateRecords.length;i<a;i++){var r=e.updateRecords[i],s=null,l=null,p=r.Id.match(/_local_/)||r.Id.match(/^local_/);if(r.Id in t){var m=t[r.Id];m.new_values&&(r.newValues?r.newValues=o(m.new_values,r.newValues):r.newValues=m.new_values),m.old_values&&(r.oldValues?r.oldValues=o(r.oldValues,m.old_values):r.oldValues=m.old_values),s=f,l={id:r.Id,where_id:r.localId||r.Id,table_name:u,operation:p?"insert":"update",old_values:SVMX.toJSON(r.oldValues)||"",new_values:SVMX.toJSON(r.newValues)||"",modified_at:_},c&&(l.change_type_clause=" AND change_type='"+d+"'")}else s=h,l={id:r.Id,parent_id:r.parentId,table_name:u,record_type:r.recordType||(r.parentId?"detail":"master"),operation:p?"insert":"update",old_values:SVMX.toJSON(r.oldValues)||"",new_values:SVMX.toJSON(r.newValues)||"",modified_at:_},c&&(r.objectName&&(l.objname_fld=",object_name",l.object_name=",'"+r.objectName+"'"),l.changetype_fld=",change_type",l.change_type=",'"+d+"'");l.new_values.indexOf("'")>-1&&(l.new_values=l.new_values.replace(/'/g,"''")),l.old_values.indexOf("'")>-1&&(l.old_values=l.old_values.replace(/'/g,"''")),n.push(SVMX.string.substitute(s,l))}}function i(t){var n=[];if(a(e.deleteRecords,n),n.length){var i={table_name:u,rec_ids:n};t.push(SVMX.string.substitute(p,i))}for(var r=0,o=e.deleteRecords.length;r<o;r++){var s=e.deleteRecords[r];if(!s.Id.match(/_local_/)&&!s.Id.match(/^local_/)){var i={id:s.Id,parent_id:s.parentId,table_name:u,record_type:s.recordType||(s.parentId?"detail":"master"),operation:"delete",old_values:"",new_values:"",modified_at:_};c&&(s.objectName&&(i.objname_fld=",object_name",i.object_name=",'"+s.objectName+"'"),i.changetype_fld=",change_type",i.change_type=",'"+d+"'"),t.push(SVMX.string.substitute(h,i))}}}function a(e,t){for(var n=0,i=e.length;n<i;n++){var a=e[n],o="'"+a.Id+"'";t.indexOf(o)<0&&t.push(o),a.localId=a.Id,a.Id in m&&(a.Id=m[a.Id]),a.parentId in m&&(a.parentId=m[a.parentId]),a.oldValues&&r(a.oldValues),a.newValues&&r(a.newValues)}}function r(e){for(var t in e){var n=e[t];n&&n in m&&(e[t]=m[n])}}function o(e,t,n){var i=n;i||(i={});for(var a in t)i[a]=a in e?e[a]:t[a];return n||o(t,e,i),i}function s(a){var o={},s=[];if(a&&a.length)for(var c=0,u=a.length;c<u;c++){var d=a[c];d.Id in m&&(d.Id=m[d.Id]),d.parent_id in m&&(d.parent_id=m[d.parent_id]),d.old_values&&(d.old_values=JSON.parse(d.old_values),r(d.old_values)),d.new_values&&(d.new_values=JSON.parse(d.new_values),r(d.new_values)),o[d.Id]=d}e.insertRecords&&e.insertRecords.length&&t(o,s),e.updateRecords&&e.updateRecords.length&&n(o,s),e.deleteRecords&&e.deleteRecords.length&&i(s),s.length?execQuery({queryArray:s}).then(e.callback,l):e.callback&&e.callback()}function l(t){logger.error("SERIOUS ERROR: Failed to insert/update record(s) into ClientSyncLog: "+t),e.callback&&e.callback()}if(e){var c=!1,u="ClientSyncLog",d="";(c="isSuccessive"in e?e.isSuccessive:SVMX.getCurrentApplication().getSyncImpl().isSuccessiveSyncEnabled())&&(u="ClientSuccSyncLog",d="client",e.isServerUpdates&&(d="server"));var _=DatetimeUtils.getCurrentDatetimeGMT(DatetimeUtils.getSaveFormat("dateTime")),h="INSERT INTO {{table_name}} (Id,parent_id,record_type,operation,modified_at,old_values,new_values{{objname_fld}}{{changetype_fld}}) VALUES ('{{id}}','{{parent_id}}','{{record_type}}','{{operation}}','{{modified_at}}','{{old_values}}','{{new_values}}'{{object_name}}{{change_type}})",f="UPDATE {{table_name}} SET id='{{id}}',operation='{{operation}}',new_values='{{new_values}}',old_values='{{old_values}}',modified_at='{{modified_at}}' WHERE id='{{where_id}}'{{change_type_clause}}",p="DELETE FROM {{table_name}} WHERE Id IN ({{rec_ids}})",m=utils.SyncData.getOpenRecordRemoteIds(),v=[];e.insertRecords&&e.insertRecords.length&&a(e.insertRecords,v),e.updateRecords&&e.updateRecords.length&&a(e.updateRecords,v),v.length?execQuery({query:"SELECT * FROM {{table_name}} WHERE Id In ({{rec_ids}})"+(c?" AND change_type='{{change_type}}'":""),queryParams:{table_name:u,rec_ids:v,change_type:d}}).then(s,l):s()}}},{key:"writeSyncWebServiceRecords",value:function(e){function t(t){var n=e.wsInfo.actions;if(t&&t.length){for(var i=[],a=0;a<n.length;a++){for(var r=n[a],o=!1,s=0;s<t.length;s++)if(r.eventType===t[s].event_type){o=!0;break}o||i.push(r)}n=i}if(n&&n.length){for(var l=[],a=0;a<n.length;a++){var r=n[a],c={Id:e.wsInfo.recordId,record_type:"master",sfm_process_id:e.wsInfo.processId,process_type:e.wsInfo.processType,event_type:r.eventType,action_time:e.wsInfo.actionTime,method_name:r.methodName,call_type:r.callType,sync_type:e.isSuccessive?"successive":""};l.push(SVMX.string.substitute("INSERT INTO SfmWebServiceActionsLog (Id,record_type,sfm_process_id,event_type,process_type,action_time,method_name,call_type,sync_type) VALUES ('{{Id}}','{{record_type}}','{{sfm_process_id}}','{{event_type}}','{{process_type}}','{{action_time}}','{{method_name}}','{{call_type}}','{{sync_type}}')",c))}l.length?execQuery({queryArray:l}).always(e.callback):e.callback&&e.callback()}else e.callback&&e.callback()}if(!(e&&e.wsInfo&&e.wsInfo.actions&&e.wsInfo.actions.length))return void(e.callback&&e.callback());execQuery({query:"SELECT Id, event_type FROM SfmWebServiceActionsLog WHERE Id = '{{Id}}' AND sfm_process_id = '{{processId}}'",queryParams:{Id:e.wsInfo.recordId,processId:e.wsInfo.processId}}).always(t)}},{key:"getSyncWebServiceData",value:function(e){function t(){var t=SVMX.create("com.servicemax.client.offline.sal.model.sfmdelivery.targetrecord.impl.SFMTargetRecord",e.data,e.metadata,e),n=t.getRequest();return n.stringMap=[{key:"SVMX_processId",value:e.processId},{key:"SVMX_recordId",value:e.recordId}],n}function n(e,t){if(t&&t.length){if(t.indexOf(e.pageDataSet.sobjectinfo.Id)>=0)return!1;for(var n=0,i=e.detailDataSet.length;n<i;n++)for(var a=e.detailDataSet[n],r=0,o=a.pageDataSet.length;r<o;r++)if(t.indexOf(a.pageDataSet[r].sobjectinfo.Id)>=0)return!1}return!0}return SVMX.when([function(){var t=$.Deferred();return SVMX.create("com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetPageLayout").performAsync(e,{result:function(n){n&&(e.metadata=n,t.resolve())}}),t}(),function(){var t=$.Deferred();return SVMX.create("com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetPageData").performAsync(e,{result:function(n){n&&(e.data=n,t.resolve())}}),t}()]).then(function(){var i=n(e.data.__data,e.excludeIds);return{triggerable:i,targetRecord:i?t():null}})}},{key:"parseSyncRecord",value:function(e){return{Id:e.Id,parentId:e.parent_id,recordType:e.record_type,operation:e.operation,modifiedAt:e.modified_at,oldValues:e.old_values?JSON.parse(e.old_values):null,newValues:e.new_values?JSON.parse(e.new_values):null,objectName:e.object_name,changeType:e.change_type}}}]),t}(SVMXObject),utils.SyncData.__openRecordRemoteIds={},utils.SyncData.__openRecordOwners={},utils.SyncData.__ownerId=null,utils.SyncData.__syncPutInsertRecords={},utils.ServerInfo=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"getServerVersion",value:function(){return this.__serverVersion}},{key:"setServerVersion",value:function(e,t){e&&(this.__serverVersion=e,t&&t.call(this.__serverVersion))}},{key:"getMultiServerVersionRequest",value:function(){return window.com.servicemax.client.offline.sal.model.multiversionbehavior.Facade.getVersionClass()}}]),t}(SVMXObject),utils.ServerInfo.__serverVersion=null,utils.Cache=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"resetAllJSCaches",value:function(){SVMX.forEachProperty(this.__jscache,function(e,t){t.items=[]},this)}},{key:"registerJSCache",value:function(e,t){e in this.__jscache||(this.__jscache[e]={limit:t,items:[]},this.__configSyncSetup||this.__setupConfigSyncHandler())}},{key:"clearJSCache",value:function(e){var t=this.__getJSCacheItems(e);t&&(t.length=0)}},{key:"readFromJSCache",value:function(e,t){this.__flagJSCache(e,t);var n=this.__getJSCacheItems(e),i=SVMX.array.indexOf(n,function(e){return e.name===t});if(-1!==i){var a=n[i].value;return n[i].isObject&&(a=SVMX.toObject(a)),a}}},{key:"__flagJSCache",value:function(e,t){var n=this.__getJSCacheItems(e),i=SVMX.array.filter(n,function(e){return e.name===t})[0];i&&(SVMX.array.remove(n,i),n.push({name:t,value:i.value,isObject:i.isObject}))}},{key:"writeToJSCache",value:function(e,t,n){var i=this.__getJSCacheItems(e);this.removeFromJSCache(e,t);var a="object"===(void 0===n?"undefined":(0,_typeof3.default)(n));i.push({name:t,value:a?SVMX.toJSON(n):n,isObject:a}),this.__limitJSCacheSize(e)}},{key:"removeFromJSCache",value:function(e,t){var n=this.__getJSCacheItems(e),i=SVMX.array.indexOf(n,function(e){return e.name===t});-1!=i&&SVMX.array.removeElementAt(n,i)}},{key:"__limitJSCacheSize",value:function(e){var t=this.__jscache[e];if(t)for(var n=t.limit;t.items.length>n;)t.items.shift()}},{key:"__getJSCacheItems",value:function(e){var t=this.__jscache[e];return t?t.items:(logger.error("ERROR: Cache "+e+" not found"),[])}},{key:"__setupConfigSyncHandler",value:function(){this.__configSyncSetup=!0;var e=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance(),this.__syncManager.bind("SYNC_COMPLETED",function(e){"INITIAL"!=this.__syncManager.getSyncType()&&"CONFIG"!=this.__syncManager.getSyncType()||(this.resetAllJSCaches(),utils.FieldSet.fieldSets={},execQuery({query:"DELETE FROM ClientCache WHERE key like 'PURGE_ON_CONFIG_SYNC.%'"}))},this)}},{key:"deleteFromDBCache",value:function(e,t,n){var i=this,a=SVMX.string.substitute("delete from ClientCache where key='{{key}}'",{key:e});i.__executeQuery(a,function(){t&&t.call(n)})}},{key:"writeObjectToDBCache",value:function(e,t,n,i){t=SVMX.toJSON(t),this.writeToDBCache(e,t,n,i)}},{key:"writeToDBCache",value:function(e,t,n,i){var a=this,r=SVMX.string.substitute("delete from ClientCache where key='{{key}}'",{key:e});a.__executeQuery(r,function(){if("string"==typeof t){var o=new RegExp("'","gi");t=t.replace(o,"''")}r=SVMX.string.substitute("insert or replace into ClientCache values( '{{key}}', '{{value}}')",{key:e,value:t}),a.__executeQuery(r,function(){n&&n.call(i)})})}},{key:"readObjectFromDBCache",value:function(e,t,n){var i=this.readFromDBCache(e),a=new $.Deferred;return i.then(function(e){e=SVMX.toObject(e),t&&t.call(n,e),a.resolve(e)},function(){t&&t.call(n,null),a.resolve(null)}),a}},{key:"readFromDBCache",value:function(e,t,n){var i=new $.Deferred,a=this,r=SVMX.string.substitute("select value from ClientCache where key='{{key}}' limit 1",{key:e});return a.__executeQuery(r,function(e){var a=null;e&&e.length>0&&(a=e[0].value),t&&t.call(n,a),i.resolve(a)}),i}},{key:"readFromSynchronousDBCache",value:function(e,t){var n=this.__syncDbData[e];if(n){var i=n[t];if(i)return i.isObject?SVMX.toObject(i.value):i.value}else logger.error("MINOR ERROR: Sync Cache "+e+" does not exist")}},{key:"writeToSynchronousDBCache",value:function(e,t,n){var i=n&&"object"===(void 0===n?"undefined":(0,_typeof3.default)(n));n&&"object"===(void 0===n?"undefined":(0,_typeof3.default)(n))&&(n=SVMX.toJSON(n)),null!==n&&void 0!==n||(n="");var a=this.__syncDbData[e];a||(a=this.__syncDbData[e]={}),a[t]={value:n,isObject:i},this.__executeQuery(SVMX.string.substitute("DELETE FROM 'SynchronousCache' WHERE cache_key='{{key}}' AND cache_name='{{cache_name}}';INSERT INTO 'SynchronousCache' ('cache_key', 'cache_name', 'cache_value', is_object) VALUES ('{{key}}', '{{cache_name}}', '{{value}}', {{is_object}})",{key:t,cache_name:e,value:String(n).replace(new RegExp("'","g"),"''"),is_object:i?1:0}))}},{key:"initializeSynchronousDbCache",value:function(){var e=new $.Deferred,t=this.__syncDbData={};return this.__executeQuery("SELECT * FROM 'SynchronousCache'",SVMX.proxy(this,function(n){for(var i=0;i<n.length;i++){var a=n[i];t[a.cache_name]||(t[a.cache_name]={}),t[a.cache_name][a.cache_key]={value:a.cache_value,isObject:a.is_object&&"0"!==a.is_object}}e.resolve()})),e}},{key:"__executeQuery",value:function(e,t){var n=Facade,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){t&&t(e.data.data)},this),i.bind("REQUEST_ERROR",function(e){logger.error(e.data),t&&t(!1)},this),i.execute({query:e,async:!1})}}]),t}(SVMXObject),utils.Cache.__syncDbData={},utils.Cache.__configSyncSetup=!1,utils.Cache.__jscache={},utils.SynchronousDbExtension=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"perform",value:function(e){return utils.Cache.initializeSynchronousDbCache()}}]),t}(AbstractExtension),utils.SystemData=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"getUserInfo",value:function(e){return SVMX.getCurrentApplication().getUserInfo()}},{key:"getUserContextMenuAuthorization",value:function(e){var t=nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",SVMX.proxy(this,"__getUserContextMenuAuthorizationSuccess",e)),t.bind("REQUEST_ERROR",SVMX.proxy(this,"__getUserContextMenuAuthorizationError",e)),t.execute({query:"SELECT value as api_key FROM MobileDeviceSettings WHERE setting_id = '{{fieldName}}'",queryParams:{fieldName:e.apiAccessFieldName}})}},{key:"__getUserContextMenuAuthorizationSuccess",value:function(e,t){var n=t.data,i=!1;n.success&&n.data[0]&&(i="true"===n.data[0].api_key),e.onSuccess(i)}},{key:"__getUserContextMenuAuthorizationError",value:function(e,t){logger.warn("getUserContextMenuAuthorization Failed; typically happens in initial sync when settings table isn't present yet"),e.onError(e)}},{key:"getDisplayTags",value:function(e){var t=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.translation").getInstance();if(!t.isEmpty())return void e.onSuccess(t);utils.MetaData.isTableInDatabase("MobileDeviceTags")?execQuery({query:"SELECT tag_id, value, module_id FROM MobileDeviceTags"}).then(SVMX.proxy(this,function(n){t.setData(n),e.onSuccess(t)}),SVMX.proxy(this,function(n){logger.error("getDisplayTags failed:"+n),e.onError&&e.onError(t)})):e.onSuccess(t)}}]),t}(SVMXObject),utils.SystemData.__displayTagsCache={},utils.SystemData.__userInfoPendingEvents=[],utils.SystemData.__userInfoCache=null,utils.Expressions=function(_SVMXObject7){function _class18(){return(0,_classCallCheck3.default)(this,_class18),(0,_possibleConstructorReturn3.default)(this,(_class18.__proto__||(0,_getPrototypeOf2.default)(_class18)).apply(this,arguments))}return(0,_inherits3.default)(_class18,_SVMXObject7),(0,_createClass3.default)(_class18,null,[{key:"loadExpressionIntoCache",value:function(e){utils.Cache.registerJSCache("Expressions",15);var t=utils.Cache.readFromJSCache("Expressions",e.expressionId);if(t)return void(e.onSuccess&&e.onSuccess(t));var n=nativeService.createSQLRequest();e.onSuccess&&n.bind("REQUEST_COMPLETED",SVMX.proxy(this,function(t){var n=getDataFromEvt(t);if(!n.length)return t.data.data="No expressions found in DB for "+e.expressionId,e.onError(t);utils.Cache.writeToJSCache("Expressions",e.expressionId,n),e.onSuccess()})),e.onError&&n.bind("REQUEST_ERROR",e.onError),n.execute({query:"SELECT * FROM SFExpression LEFT JOIN SFExpressionComponent ON SFExpressionComponent.expression_id = SFExpression.expression_id WHERE SFExpression.expression_id='{{expression_id}}' GROUP BY sequence ORDER BY CAST(sequence AS INTEGER)",queryParams:{expression_id:e.expressionId}})}},{key:"evaluate",value:function(e){if(e.recordId)if(e.validateExtAppRec&&e.data)delete e.recordId,this.evaluate(e);else{var t=utils.Data.getRecord({Id:e.recordId});t.done(SVMX.proxy(this,function(t){delete e.recordId,e.data=t,this.evaluate(e)})),t.fail(e.onError)}else{if(!e.expressionId&&e.processId)return void utils.MetaData.getExpressionIdFromProcessId({processId:e.processId,onSuccess:SVMX.proxy(this,function(t){if(e.expressionId=t,!e.expressionId){for(var n=e.data instanceof Array?e.data.length:1,i=[],a=0;a<n;a++)i.push(!e.returnMessage||{result:!0});return e.onSuccess(i)}this.evaluate(e)}),onError:e.onError});e.expressionId||logger.error("Expression evaluate with no expressionId or valid processId failed");var n=(e.data instanceof Array?e.data[0]&&e.data[0].attributes.type:e.data&&e.data.attributes.type)||e.tableName;utils.MetaData.describeObject({objectName:n,onSuccess:SVMX.proxy(this,function(t){e.recordTypeInfos=t.recordTypeInfos,this.loadExpressionIntoCache({expressionId:e.expressionId,onSuccess:SVMX.proxy(this,"__onGetExpressionsSuccess",e),onError:SVMX.proxy(this,"__onGetExpressionsError",e)})}),onError:SVMX.proxy(this,function(t){this.__onGetExpressionsError(e)})})}}},{key:"__onGetExpressionsSuccess",value:function(e){var t=utils.Cache.readFromJSCache("Expressions",e.expressionId);if(e.onlyExpressionRecord){var n=t[0].advance_expression;e.onSuccess(t,n,e.expressionId)}var i=[];if(e.data instanceof Array)for(var a=0;a<e.data.length;a++)i.push(this.__evaluateExpressions(e.data[a],t,e.recordTypeInfos,e.returnMessage));else i.push(this.__evaluateExpressions(e.data,t,e.recordTypeInfos,e.returnMessage));e.onSuccess(i)}},{key:"__onGetExpressionsError",value:function(e,t){t=t||{data:{data:[],parameters:{query:""}}},logger.error("evaluateExpressions Failed to find Expression: "+t.data.parameters.query+"; "+t.data.data),e.onSuccess([{result:!1}])}},{key:"__evaluateExpressions",value:function __evaluateExpressions(inData,inExprs,recordTypeInfos,returnMessage){var exprs=[],data=void 0,v=void 0;if(inData instanceof utils.Record)data=inData.getRawValues();else{data={};for(var key in inData)inData.hasOwnProperty(key)&&(v=inData[key],v&&"object"===(void 0===v?"undefined":(0,_typeof3.default)(v))&&"fieldvalue"in v?data[key]=v.fieldvalue.value:data[key]=v)}if(data.RecordTypeId&&recordTypeInfos){var match=SVMX.array.get(recordTypeInfos,function(e){return e.name==data.RecordTypeId});match&&(data.RecordTypeId=match.recordTypeId)}if(data.RecordTypeId){var recordTypeId=utils.MetaData.getRecordTypeNameFromId(data.RecordTypeId);recordTypeId&&(data.RecordTypeId=recordTypeId)}for(var i=0;i<inExprs.length;i++)exprs.push(this.__generateExpression(inExprs[i],!1,data));var results=SVMX.executeExpressions(exprs,data);void 0!==results&&null!==results&&(results=SVMX.array.map(results,function(e){return!SVMX.executeExpressionsResultInvalid(e)&&e}));var advancedExpr=inExprs[0].advance_expression,errorMessage=inExprs[0].error_message,evalResults=!1,isError=!1;if(results&&0!==results.length)if(advancedExpr&&"1"!==advancedExpr)try{advancedExpr=advancedExpr.replace(/OR/gi,"||").replace(/AND/gi,"&&").replace(/NOT\s*/gi,"!").replace(/\d+/g,function(e){return results[e-1]}),evalResults=eval(advancedExpr)}catch(e){SVMX.getLoggingService().getLogger("offline.sal.model.getExpressions").error("EXPR:"+advancedExpr+" fails to compile to javascript"),isError=!0}else evalResults=SVMX.array.every(results,function(e){return e});else isError=!0;return returnMessage?{result:evalResults,message:errorMessage}:evalResults}},{key:"__generateExpression",value:function(e,t,n,i){var a=void 0,r=void 0,o=void 0,s=e.field_type;if(s?s=s.toLowerCase():(logger.error("Field Type is missing in Expression Please check if it is intentional:::"+(0,_stringify2.default)(e)),s=""),t)a="'"+e.source_field_name+"'";else switch(s){case"int":case"currency":case"double":case"percent":a=n&&null===n[e.source_field_name]?null:"Number("+e.source_field_name+")";break;case"datetime":a="$DATE( ("+e.source_field_name+") ? com.servicemax.client.lib.datetimeutils.DatetimeUtil.convertToTimezone("+e.source_field_name+", com.servicemax.client.lib.datetimeutils.DatetimeUtil._timeZone, false).substring(0, 10) : null)";break;case"date":a="$DATEONLY("+e.source_field_name+")";break;default:a=e.source_field_name}switch(s){case"datetime":case"date":e.value&&"yesterday"==e.value.toLowerCase()?r="$DATEYESTERDAY()":e.value&&"today"==e.value.toLowerCase()?r="$DATETODAY()":e.value&&"tomorrow"==e.value.toLowerCase()?r="$DATETOMORROW()":"now"==e.value?(a="$DATE("+e.source_field_name+")",r="$DATENOW()"):r="$DATE('"+e.value+"')";break;case"int":case"currency":case"double":case"percent":r="Number("+e.value+")";break;default:r=void 0===e.value||null===e.value?"null":'"'+e.value.replace(/('|")/g,"\\$1")+'"'}"ISNULL"!==o&&"ISNOTNULL"!==o||(a=e.source_field_name);var l=!1,c={NOTCONTAIN:"NOTCONTAINS"},u=e.operator;if(u?o=u.toUpperCase():(logger.error("Operator  is missing in Expression Please check if it is intentional:::"+(0,_stringify2.default)(e)),o=""),o=c[o]||o,o="ISNULL"===o||"ISNOTNULL"===o||"date"!==s&&("datetime"!==s||i)?"$"+o:"$DATE"+o,"date"!==s&&"datetime"!==s&&("$EQ"===o||"$NE"===o)&&-1!=(r||"").indexOf(",")){var d="";"$EQ"===o?d="$IN":"$NE"===o&&(d="$NOTIN"),r='"'+e.value.replace(/('|")/g,"\\$1")+'"',d&&(o=d)}"$IN"!==o&&"$NOTIN"!==o||(l=!0);var _=o+"("+a+","+r+")";return l&&(_=o+"("+r+","+a+")"),_}},{key:"__generateExpressionForFields",value:function(e,t,n){var i=e.operator,a=e.source_field_name,r=e.value,o=void 0;if("field"===e.operatorType)if("IN"!=e.operator&&"NOTIN"!=e.operator){var s=n[r];if(s){var l=n[r],c=l.tableName,u=l.refTo,d=utils.MetaData.getNameField(u);r=c+"."+d}else r="MAIN."+r}else{for(var _=r.split("','"),h=[],f=0;f<_.length;f++){var p=n[r];if(p){var m=n[_[f]],v=m.tableName,g=m.refTo,y=utils.MetaData.getNameField(g);h.push(v+"."+y)}else r="MAIN."+r}r=h.join("','")}switch("EQ"!==i&&"NE"!==i||-1!=(r||"").indexOf(",")&&("EQ"===i?i="IN":"NE"===i&&(i="NOTIN")),i){case"EQ":o=a+" = "+r;break;case"NE":o=a+" != "+r;break;case"LT":o=a+" < "+r;break;case"GT":o=a+" > "+r;break;case"LE":o=a+" <= "+r;break;case"GE":o=a+" >= "+r;break;case"IN":o=a+" IN ('"+r+"')";break;case"NOTIN":o=a+" NOTIN ('"+r+"')"}return o}}]),_class18}(SVMXObject),utils.Attachments=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"copyAttachmentIntoDownloads",value:function(e,t){var n=Facade,i=n.createFileRequest(),a=this.getTargetFileName(e),r={file:e,operation:"COPY",targetPath:"{UploadDirectory}",targetFile:a};i.bind("REQUEST_COMPLETED",function(e){var n={success:e.data.success,targetPath:e.data.parameters.targetPath,targetFileName:e.data.parameters.targetFile};t(n)}),i.execute(r)}},{key:"copyAttachmentIntoUploads",value:function(e,t){var n=Facade,i=n.createFileRequest(),a=this.getTargetFileName(e),r={file:e,operation:"COPY",targetPath:"{DownloadDirectory}",targetFile:a};i.bind("REQUEST_COMPLETED",function(e){var n={success:e.data.success,targetPath:e.data.parameters.targetPath,targetFileName:e.data.parameters.targetFile};t(n)}),i.execute(r)}},{key:"getTargetFileName",value:function(e){var t="";e.indexOf("\\")>-1?t=e.split("\\").pop():e.indexOf("/")>-1&&(t=e.split("/").pop());var n=t.lastIndexOf("."),i=t.substring(n,t.length);return t=t.substring(0,n)+(new Date).getTime()+i}},{key:"getSubQueryForAttachmentsToIgnore",value:function(e,t){var n=[],i="";if(e)for(var a=0;a<e.length;a++)n[a]=e[a].Id;return n.length&&(i="AND "+t+".Id NOT IN ('"+n.join("','")+"') "),i}},{key:"getAttachmentFieldNameInCATable",value:function(){var e=SVMX.OrgNamespace+"__SM_Attachment_ID__c";return utils.ServerInfo.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(e=SVMX.OrgNamespace+"__SM_ContentDocumentLink_ID__c"),e}}]),t}(SVMXObject),utils.DBLogTarget=function(e){function t(e){(0,_classCallCheck3.default)(this,t);var n=(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).call(this,e));return n.tableName=e.tableName,n.isDefaultTarget=!1,n.defaultLogLevel="DEBUG",n}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"log",value:function(e,t){var n="";utils.MetaData.isTableInDatabase(this.tableName)||(n+=SVMX.string.substitute("CREATE TABLE '{{table_name}}'( source varchar, level varchar, text varchar,  json varchar,  created_at varchar);",{table_name:this.tableName}),utils.MetaData.registerNewTableInDatabase(this.tableName));var i=t.type;e instanceof Error&&(e=e.stack?e.stack.toString():e.toString()),n+=SVMX.string.substitute("INSERT INTO '{{table_name}}' (source, level, text, json, created_at) VALUES ('{{source}}', '{{level}}', '{{text}}', '{{json}}', '{{created_at}}')",{table_name:this.tableName,source:t.source,level:i,text:e,json:"",created_at:t.timeStamp}),execQuery({query:n})}}]),t}(AbstractLogTarget),utils.CheckListChunkUtils=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"getCombinedChecklistData",value:function(e){var t=new $.Deferred,n=SVMX.getCustomFieldName("ChecklistJSON"),i=SVMX.getCustomFieldName("ChecklistMetaJSON"),a=SVMX.getCustomObjectName("Checklist"),r=SVMX.getCustomFieldName("SM_Checklist_Group_Id"),o=SVMX.getCustomFieldName("SM_Sequence"),s={};s[n]=null,s[i]=null;var l=e[SVMX.getCustomFieldName("SM_Checklist_Group_Id")];if(l){var c="SELECT  group_concat({{chkListMetaJsonColumn}},'') AS {{chkListMetaJsonColumn}}, group_concat({{chkListJsonColumn}},'') AS {{chkListJsonColumn}} FROM( select {{chkListMetaJsonColumn}}, {{chkListJsonColumn}}   FROM '{{chkListTableName}}'  WHERE {{uniqueIdColumn}} = '{{recordUniqueId}}'  ORDER BY {{sequenceColumn}} ASC )";c=SVMX.string.substitute(c,{chkListJsonColumn:n,chkListMetaJsonColumn:i,chkListTableName:a,uniqueIdColumn:r,sequenceColumn:o,recordUniqueId:l});var u=nativeService.createSQLRequest();u.bind("REQUEST_COMPLETED",function(e){e.data&&e.data.data&&(s=e.data.data[0]),t.resolve(s)}),u.bind("REQUEST_ERROR",function(e){logger.error(e.data.data),t.resolve(s)},this),u.execute({query:c})}else s[n]=e[n],s[i]=e[i],t.resolve(s);return t}},{key:"__getExistingChecklistChunkRows",value:function(e){return execQuery(e)}},{key:"getDbChecklistChunks",value:function(e,t,n,i){var a=new $.Deferred,r=this,o=e[SVMX.getCustomFieldName("SM_Checklist_Group_Id")];if(o){var s={query:"select * from '{{chkListTableName}}' WHERE  {{ChecklistProcessIDColumn}}='{{ChecklistProcessID}}' AND {{SM_Checklist_Group_Id_Column}} IN('0.0','0','','{{Unique_Row_Id}}') ORDER BY {{SM_Sequence}} ASC",queryParams:{SM_Sequence:SVMX.getCustomFieldName("SM_Sequence"),Unique_Row_Id:o,SM_Checklist_Group_Id_Column:SVMX.getCustomFieldName("SM_Checklist_Group_Id"),chkListTableName:SVMX.getCustomObjectName("Checklist"),recordId:e.Id,ChecklistProcessIDColumn:SVMX.getCustomFieldName("ChecklistProcessID"),ChecklistProcessID:t}};SVMX.string.substitute(s.query,s.queryParams),a=r.__getExistingChecklistChunkRows(s)}else a.resolve([]);return a}},{key:"getCheckListChunkRows",value:function(e,t,n,i){var a=this,r=new $.Deferred,o=SVMX.getCustomFieldName("ChecklistMetaJSON"),s=SVMX.getCustomFieldName("ChecklistJSON"),l=SVMX.getCustomFieldName("SM_Sequence"),c=SVMX.getCustomFieldName("SM_Checklist_Group_Id"),u=DatetimeUtil.getTimestampWithSaveFormat(),d=SVMX.getCustomFieldName("Status"),_=[],h=e[SVMX.getCustomFieldName("ChecklistJSON")],f=e[SVMX.getCustomFieldName("ChecklistMetaJSON")],p=e.Id,m=e[d],v=(new Date).getTime(),g=SVMX.splitLongStringToChunkArray(h),y=SVMX.splitLongStringToChunkArray(f);return a.getDbChecklistChunks(e,t,n,i).then(function(t){var n=1,i=y.length;if(i>=g.length&&i>=t.length)for(var a=0;a<i;a++){var h=SVMX.cloneObject(e);h[o]=y[a],g[a]?h[s]=g[a]:h[s]=null,h[l]=n;var f=t[a];f?(h[d]=m,h[c]=f[c],h.Id=f.Id):(h[c]=v,h[d]=m,h.CreatedDate=u,h.Id=0===a?p:null),_.push(h),n++}else _.push(e);r.resolve(_)}),r}}]),t}(SVMXObject),utils.CalendarTranslations=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"setMonthTags",value:function(){this.__arrayForMonthTags=[CONST_TAG_JAN,CONST_TAG_FEB,CONST_TAG_MAR,CONST_TAG_APR,CONST_TAG_MAY,CONST_TAG_JUN,CONST_TAG_JUL,CONST_TAG_AUG,CONST_TAG_SEP,CONST_TAG_OCT,CONST_TAG_NOV,CONST_TAG_DEC]}},{key:"setWeekDaysTags",value:function(){this.__arrayForWeekTags=[CONST_TAG_SUN,CONST_TAG_MON,CONST_TAG_TUE,CONST_TAG_WED,CONST_TAG_THU,CONST_TAG_FRI,CONST_TAG_SAT]}},{key:"setDefaultMonthTagValues",value:function(){this.__dictionaryForMonthDefaultTagValues[CONST_TAG_JAN]="Jan",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_FEB]="Feb",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_MAR]="Mar",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_APR]="Apr",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_MAY]="May",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_JUN]="Jun",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_JUL]="July",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_AUG]="Aug",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_SEP]="Sep",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_OCT]="Oct",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_NOV]="Nov",this.__dictionaryForMonthDefaultTagValues[CONST_TAG_DEC]="Dec"}},{key:"setDefaultWeeksTagValues",value:function(){this.__dictionaryForWeekDefaultTagValues[CONST_TAG_SUN]="Sun",this.__dictionaryForWeekDefaultTagValues[CONST_TAG_MON]="Mon",this.__dictionaryForWeekDefaultTagValues[CONST_TAG_TUE]="Tue",this.__dictionaryForWeekDefaultTagValues[CONST_TAG_WED]="Wed",this.__dictionaryForWeekDefaultTagValues[CONST_TAG_THU]="Thu",this.__dictionaryForWeekDefaultTagValues[CONST_TAG_FRI]="Fri",this.__dictionaryForWeekDefaultTagValues[CONST_TAG_SAT]="Sat"}},{key:"getMonthTagByIndex",value:function(e){return this.__arrayForMonthTags[e]}},{key:"getWeekTagByIndex",value:function(e){return this.__arrayForWeekTags[e]}},{key:"getDefaultMonthTagValueByTag",value:function(e){return this.__dictionaryForMonthDefaultTagValues[e]}},{key:"getDefaultWeekTagValueByTag",value:function(e){return this.__dictionaryForWeekDefaultTagValues[e]}},{key:"getFormatDateForDayTitle",value:function(e){if(e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"===(void 0===e?"undefined":(0,_typeof3.default)(e))&&!isNaN(e.getTime())){var t=e.getDay(),n=e.getMonth(),i=this.getMonthTagByIndex(n),a=this.getDefaultMonthTagValueByTag(i),r=this.getWeekTagByIndex(t),o=this.getDefaultWeekTagValueByTag(r),s=TS().T(i,a);return TS().T(r,o)+" "+s+" "+e.getDate()+", "+e.getFullYear()}return e}},{key:"getLocalizedDayName",value:function(e){if(e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"===(void 0===e?"undefined":(0,_typeof3.default)(e))&&!isNaN(e.getTime())){var t=e.getDay(),n=this.getWeekTagByIndex(t),i=this.getDefaultWeekTagValueByTag(n);return TS().T(n,i)}return e}},{key:"getMonthWithDate",value:function(e){if(e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"===(void 0===e?"undefined":(0,_typeof3.default)(e))&&!isNaN(e.getTime())){var t=e.getMonth(),n=this.getMonthTagByIndex(t),i=this.getDefaultMonthTagValueByTag(n);return TS().T(n,i)+" "+e.getDate()}return e}},{key:"getMonthNameWithFullYear",value:function(e){if(e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"===(void 0===e?"undefined":(0,_typeof3.default)(e))&&!isNaN(e.getTime())){var t=e.getMonth(),n=this.getMonthTagByIndex(t),i=this.getDefaultMonthTagValueByTag(n);return TS().T(n,i)+" "+e.getFullYear()}return e}},{key:"getDateWithFullYear",value:function(e){return e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"!==(void 0===e?"undefined":(0,_typeof3.default)(e))||isNaN(e.getTime())?e:e.getDate()+", "+e.getFullYear()}},{key:"getMonthWithDateFollowedByFullYear",value:function(e){if(e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"===(void 0===e?"undefined":(0,_typeof3.default)(e))&&!isNaN(e.getTime())){var t=e.getMonth(),n=this.getMonthTagByIndex(t),i=this.getDefaultMonthTagValueByTag(n);return TS().T(n,i)+" "+e.getDate()+", "+e.getFullYear()}return e}},{key:"getFormattedDate",value:function(e){return e="string"==typeof e?DatetimeUtils.getJSDateFromStringDate(e):e,"object"!==(void 0===e?"undefined":(0,_typeof3.default)(e))||isNaN(e.getTime())?e:e.getDate()}}]),t}(SVMXObject),utils.ImageCompression=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,null,[{key:"loadImageCompressionSettingValue",value:function(){var e=SVMX.Deferred();return utils.Cache.readFromDBCache("IMG_COMPRESSION_MODE").done(function(e){var t=SVMX.toObject(e),n=SVMX.getClient().getApplicationParameter("image-compression");utils.Cache.registerJSCache("IMG_COMPRESSION_MODE",1),t?utils.Cache.writeToJSCache("IMG_COMPRESSION_MODE","IMG_COMPRESSION_MODE",t):(utils.Cache.writeToJSCache("IMG_COMPRESSION_MODE","IMG_COMPRESSION_MODE",n.defaultMode),utils.Cache.writeToDBCache("IMG_COMPRESSION_MODE",n.defaultMode))}).always(function(){e.resolve()}),e}}]),t}(SVMXObject),utils.CalendarTranslations.__arrayForMonthTags=[],utils.CalendarTranslations.__arrayForWeekTags=[],utils.CalendarTranslations.__dictionaryForMonthDefaultTagValues={},utils.CalendarTranslations.__dictionaryForWeekDefaultTagValues={},utils.CalendarTranslations.setMonthTags(),utils.CalendarTranslations.setWeekDaysTags(),utils.CalendarTranslations.setDefaultMonthTagValues(),utils.CalendarTranslations.setDefaultWeeksTagValues(),SVMX.getLoggingService().generateMissingLogTargets(),SVMX.defineGlobal(utils.name,utils),module.exports=utils},function(e,t,n){(function(e){!function(t,n){e.exports=n()}(0,function(){"use strict";function t(){return Li.apply(null,arguments)}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e){return void 0===e}function s(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function l(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function c(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var n in t)u(t,n)&&(e[n]=t[n]);return u(t,"toString")&&(e.toString=t.toString),u(t,"valueOf")&&(e.valueOf=t.valueOf),e}function _(e,t,n,i){return Ct(e,t,n,i,!0).utc()}function h(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function f(e){return null==e._pf&&(e._pf=h()),e._pf}function p(e){if(null==e._isValid){var t=f(e),n=ki.call(t.parsedDateParts,function(e){return null!=e}),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function m(e){var t=_(NaN);return null!=e?d(f(t),e):f(t).userInvalidated=!0,t}function v(e,t){var n,i,a;if(o(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),o(t._i)||(e._i=t._i),o(t._f)||(e._f=t._f),o(t._l)||(e._l=t._l),o(t._strict)||(e._strict=t._strict),o(t._tzm)||(e._tzm=t._tzm),o(t._isUTC)||(e._isUTC=t._isUTC),o(t._offset)||(e._offset=t._offset),o(t._pf)||(e._pf=f(t)),o(t._locale)||(e._locale=t._locale),Ni.length>0)for(n=0;n<Ni.length;n++)i=Ni[n],a=t[i],o(a)||(e[i]=a);return e}function g(e){v(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===wi&&(wi=!0,t.updateOffset(this),wi=!1)}function y(e){return e instanceof g||null!=e&&null!=e._isAMomentObject}function S(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function E(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=S(t)),n}function b(e,t,n){var i,a=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),o=0;for(i=0;i<a;i++)(n&&e[i]!==t[i]||!n&&E(e[i])!==E(t[i]))&&o++;return o+r}function T(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function M(e,n){var i=!0;return d(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),i){for(var a,r=[],o=0;o<arguments.length;o++){if(a="","object"==typeof arguments[o]){a+="\n["+o+"] ";for(var s in arguments[0])a+=s+": "+arguments[0][s]+", ";a=a.slice(0,-2)}else a=arguments[o];r.push(a)}T(e+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),i=!1}return n.apply(this,arguments)},n)}function I(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),Fi[e]||(T(n),Fi[e]=!0)}function C(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function A(e){var t,n;for(n in e)t=e[n],C(t)?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function D(e,t){var n,i=d({},e);for(n in t)u(t,n)&&(a(e[n])&&a(t[n])?(i[n]={},d(i[n],e[n]),d(i[n],t[n])):null!=t[n]?i[n]=t[n]:delete i[n]);for(n in e)u(e,n)&&!u(t,n)&&a(e[n])&&(i[n]=d({},i[n]));return i}function x(e){null!=e&&this.set(e)}function R(e,t,n){var i=this._calendar[e]||this._calendar.sameElse;return C(i)?i.call(t,n):i}function O(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function L(){return this._invalidDate}function k(e){return this._ordinal.replace("%d",e)}function N(e,t,n,i){var a=this._relativeTime[n];return C(a)?a(e,t,n,i):a.replace(/%d/i,e)}function w(e,t){var n=this._relativeTime[e>0?"future":"past"];return C(n)?n(t):n.replace(/%s/i,t)}function F(e,t){var n=e.toLowerCase();Hi[n]=Hi[n+"s"]=Hi[t]=e}function P(e){return"string"==typeof e?Hi[e]||Hi[e.toLowerCase()]:void 0}function q(e){var t,n,i={};for(n in e)u(e,n)&&(t=P(n))&&(i[t]=e[n]);return i}function V(e,t){zi[e]=t}function B(e){var t=[];for(var n in e)t.push({unit:n,priority:zi[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function j(e,t,n){var i=""+Math.abs(e),a=t-i.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+i}function H(e,t,n,i){var a=i;"string"==typeof i&&(a=function(){return this[i]()}),e&&(Gi[e]=a),t&&(Gi[t[0]]=function(){return j(a.apply(this,arguments),t[1],t[2])}),n&&(Gi[n]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function z(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function U(e){var t,n,i=e.match(Ui);for(t=0,n=i.length;t<n;t++)Gi[i[t]]?i[t]=Gi[i[t]]:i[t]=z(i[t]);return function(t){var a,r="";for(a=0;a<n;a++)r+=C(i[a])?i[a].call(t,e):i[a];return r}}function Y(e,t){return e.isValid()?(t=W(t,e.localeData()),Wi[t]=Wi[t]||U(t),Wi[t](e)):e.localeData().invalidDate()}function W(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(Yi.lastIndex=0;i>=0&&Yi.test(e);)e=e.replace(Yi,n),Yi.lastIndex=0,i-=1;return e}function G(e,t,n){da[e]=C(t)?t:function(e,i){return e&&n?n:t}}function X(e,t){return u(da,e)?da[e](t._strict,t._locale):new RegExp(Q(e))}function Q(e){return J(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,a){return t||n||i||a}))}function J(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function K(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),s(t)&&(i=function(e,n){n[t]=E(e)}),n=0;n<e.length;n++)_a[e[n]]=i}function $(e,t){K(e,function(e,n,i,a){i._w=i._w||{},t(e,i._w,i,a)})}function Z(e,t,n){null!=t&&u(_a,e)&&_a[e](t,n._a,n,e)}function ee(e){return te(e)?366:365}function te(e){return e%4==0&&e%100!=0||e%400==0}function ne(){return te(this.year())}function ie(e,n){return function(i){return null!=i?(re(this,e,i),t.updateOffset(this,n),this):ae(this,e)}}function ae(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function re(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&te(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),ce(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function oe(e){return e=P(e),C(this[e])?this[e]():this}function se(e,t){if("object"==typeof e){e=q(e);for(var n=B(e),i=0;i<n.length;i++)this[n[i].unit](e[n[i].unit])}else if(e=P(e),C(this[e]))return this[e](t);return this}function le(e,t){return(e%t+t)%t}function ce(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=le(t,12);return e+=(t-n)/12,1===n?te(e)?29:28:31-n%7%2}function ue(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Ma).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone}function de(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ma.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _e(e,t,n){var i,a,r,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)r=_([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?(a=ba.call(this._shortMonthsParse,o),-1!==a?a:null):(a=ba.call(this._longMonthsParse,o),-1!==a?a:null):"MMM"===t?-1!==(a=ba.call(this._shortMonthsParse,o))?a:(a=ba.call(this._longMonthsParse,o),-1!==a?a:null):-1!==(a=ba.call(this._longMonthsParse,o))?a:(a=ba.call(this._shortMonthsParse,o),-1!==a?a:null)}function he(e,t,n){var i,a,r;if(this._monthsParseExact)return _e.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(a=_([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(r="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[i]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function fe(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=E(t);else if(t=e.localeData().monthsParse(t),!s(t))return e;return n=Math.min(e.date(),ce(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function pe(e){return null!=e?(fe(this,e),t.updateOffset(this,!0),this):ae(this,"Month")}function me(){return ce(this.year(),this.month())}function ve(e){return this._monthsParseExact?(u(this,"_monthsRegex")||ye.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(u(this,"_monthsShortRegex")||(this._monthsShortRegex=Aa),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function ge(e){return this._monthsParseExact?(u(this,"_monthsRegex")||ye.call(this),e?this._monthsStrictRegex:this._monthsRegex):(u(this,"_monthsRegex")||(this._monthsRegex=Da),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ye(){function e(e,t){return t.length-e.length}var t,n,i=[],a=[],r=[];for(t=0;t<12;t++)n=_([2e3,t]),i.push(this.monthsShort(n,"")),a.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(i.sort(e),a.sort(e),r.sort(e),t=0;t<12;t++)i[t]=J(i[t]),a[t]=J(a[t]);for(t=0;t<24;t++)r[t]=J(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Se(e,t,n,i,a,r,o){var s;return e<100&&e>=0?(s=new Date(e+400,t,n,i,a,r,o),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,n,i,a,r,o),s}function Ee(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function be(e,t,n){var i=7+t-n;return-(7+Ee(e,0,i).getUTCDay()-t)%7+i-1}function Te(e,t,n,i,a){var r,o,s=(7+n-i)%7,l=be(e,i,a),c=1+7*(t-1)+s+l;return c<=0?(r=e-1,o=ee(r)+c):c>ee(e)?(r=e+1,o=c-ee(e)):(r=e,o=c),{year:r,dayOfYear:o}}function Me(e,t,n){var i,a,r=be(e.year(),t,n),o=Math.floor((e.dayOfYear()-r-1)/7)+1;return o<1?(a=e.year()-1,i=o+Ie(a,t,n)):o>Ie(e.year(),t,n)?(i=o-Ie(e.year(),t,n),a=e.year()+1):(a=e.year(),i=o),{week:i,year:a}}function Ie(e,t,n){var i=be(e,t,n),a=be(e+1,t,n);return(ee(e)-i+a)/7}function Ce(e){return Me(e,this._week.dow,this._week.doy).week}function Ae(){return this._week.dow}function De(){return this._week.doy}function xe(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Re(e){var t=Me(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Oe(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Le(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function ke(e,t){return e.slice(t,7).concat(e.slice(0,t))}function Ne(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?ke(n,this._week.dow):e?n[e.day()]:n}function we(e){return!0===e?ke(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Fe(e){return!0===e?ke(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Pe(e,t,n){var i,a,r,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)r=_([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?(a=ba.call(this._weekdaysParse,o),-1!==a?a:null):"ddd"===t?(a=ba.call(this._shortWeekdaysParse,o),-1!==a?a:null):(a=ba.call(this._minWeekdaysParse,o),-1!==a?a:null):"dddd"===t?-1!==(a=ba.call(this._weekdaysParse,o))?a:-1!==(a=ba.call(this._shortWeekdaysParse,o))?a:(a=ba.call(this._minWeekdaysParse,o),-1!==a?a:null):"ddd"===t?-1!==(a=ba.call(this._shortWeekdaysParse,o))?a:-1!==(a=ba.call(this._weekdaysParse,o))?a:(a=ba.call(this._minWeekdaysParse,o),-1!==a?a:null):-1!==(a=ba.call(this._minWeekdaysParse,o))?a:-1!==(a=ba.call(this._weekdaysParse,o))?a:(a=ba.call(this._shortWeekdaysParse,o),-1!==a?a:null)}function qe(e,t,n){var i,a,r;if(this._weekdaysParseExact)return Pe.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(a=_([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(r="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[i]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}}function Ve(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Oe(e,this.localeData()),this.add(e-t,"d")):t}function Be(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function je(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Le(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function He(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ye.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(u(this,"_weekdaysRegex")||(this._weekdaysRegex=ka),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function ze(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ye.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(u(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Na),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ue(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ye.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(u(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=wa),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ye(){function e(e,t){return t.length-e.length}var t,n,i,a,r,o=[],s=[],l=[],c=[];for(t=0;t<7;t++)n=_([2e3,1]).day(t),i=this.weekdaysMin(n,""),a=this.weekdaysShort(n,""),r=this.weekdays(n,""),o.push(i),s.push(a),l.push(r),c.push(i),c.push(a),c.push(r);for(o.sort(e),s.sort(e),l.sort(e),c.sort(e),t=0;t<7;t++)s[t]=J(s[t]),l[t]=J(l[t]),c[t]=J(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function We(){return this.hours()%12||12}function Ge(){return this.hours()||24}function Xe(e,t){H(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Qe(e,t){return t._meridiemParse}function Je(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function $e(e){return e?e.toLowerCase().replace("_","-"):e}function Ze(e){for(var t,n,i,a,r=0;r<e.length;){for(a=$e(e[r]).split("-"),t=a.length,n=$e(e[r+1]),n=n?n.split("-"):null;t>0;){if(i=et(a.slice(0,t).join("-")))return i;if(n&&n.length>=t&&b(a,n,!0)>=t-1)break;t--}r++}return Fa}function et(t){var i=null;if(!Ba[t]&&void 0!==e&&e&&e.exports)try{i=Fa._abbr;n(670)("./"+t),tt(i)}catch(e){}return Ba[t]}function tt(e,t){var n;return e&&(n=o(t)?at(e):nt(e,t),n?Fa=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Fa._abbr}function nt(e,t){if(null!==t){var n,i=Va;if(t.abbr=e,null!=Ba[e])I("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ba[e]._config;else if(null!=t.parentLocale)if(null!=Ba[t.parentLocale])i=Ba[t.parentLocale]._config;else{if(null==(n=et(t.parentLocale)))return ja[t.parentLocale]||(ja[t.parentLocale]=[]),ja[t.parentLocale].push({name:e,config:t}),null;i=n._config}return Ba[e]=new x(D(i,t)),ja[e]&&ja[e].forEach(function(e){nt(e.name,e.config)}),tt(e),Ba[e]}return delete Ba[e],null}function it(e,t){if(null!=t){var n,i,a=Va;i=et(e),null!=i&&(a=i._config),t=D(a,t),n=new x(t),n.parentLocale=Ba[e],Ba[e]=n,tt(e)}else null!=Ba[e]&&(null!=Ba[e].parentLocale?Ba[e]=Ba[e].parentLocale:null!=Ba[e]&&delete Ba[e]);return Ba[e]}function at(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Fa;if(!i(e)){if(t=et(e))return t;e=[e]}return Ze(e)}function rt(){return Pi(Ba)}function ot(e){var t,n=e._a;return n&&-2===f(e).overflow&&(t=n[fa]<0||n[fa]>11?fa:n[pa]<1||n[pa]>ce(n[ha],n[fa])?pa:n[ma]<0||n[ma]>24||24===n[ma]&&(0!==n[va]||0!==n[ga]||0!==n[ya])?ma:n[va]<0||n[va]>59?va:n[ga]<0||n[ga]>59?ga:n[ya]<0||n[ya]>999?ya:-1,f(e)._overflowDayOfYear&&(t<ha||t>pa)&&(t=pa),f(e)._overflowWeeks&&-1===t&&(t=Sa),f(e)._overflowWeekday&&-1===t&&(t=Ea),f(e).overflow=t),e}function st(e,t,n){return null!=e?e:null!=t?t:n}function lt(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function ct(e){var t,n,i,a,r,o=[];if(!e._d){for(i=lt(e),e._w&&null==e._a[pa]&&null==e._a[fa]&&ut(e),null!=e._dayOfYear&&(r=st(e._a[ha],i[ha]),(e._dayOfYear>ee(r)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),n=Ee(r,0,e._dayOfYear),e._a[fa]=n.getUTCMonth(),e._a[pa]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ma]&&0===e._a[va]&&0===e._a[ga]&&0===e._a[ya]&&(e._nextDay=!0,e._a[ma]=0),e._d=(e._useUTC?Ee:Se).apply(null,o),a=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ma]=24),e._w&&void 0!==e._w.d&&e._w.d!==a&&(f(e).weekdayMismatch=!0)}}function ut(e){var t,n,i,a,r,o,s,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)r=1,o=4,n=st(t.GG,e._a[ha],Me(At(),1,4).year),i=st(t.W,1),((a=st(t.E,1))<1||a>7)&&(l=!0);else{r=e._locale._week.dow,o=e._locale._week.doy;var c=Me(At(),r,o);n=st(t.gg,e._a[ha],c.year),i=st(t.w,c.week),null!=t.d?((a=t.d)<0||a>6)&&(l=!0):null!=t.e?(a=t.e+r,(t.e<0||t.e>6)&&(l=!0)):a=r}i<1||i>Ie(n,r,o)?f(e)._overflowWeeks=!0:null!=l?f(e)._overflowWeekday=!0:(s=Te(n,i,a,r,o),e._a[ha]=s.year,e._dayOfYear=s.dayOfYear)}function dt(e){var t,n,i,a,r,o,s=e._i,l=Ha.exec(s)||za.exec(s);if(l){for(f(e).iso=!0,t=0,n=Ya.length;t<n;t++)if(Ya[t][1].exec(l[1])){a=Ya[t][0],i=!1!==Ya[t][2];break}if(null==a)return void(e._isValid=!1);if(l[3]){for(t=0,n=Wa.length;t<n;t++)if(Wa[t][1].exec(l[3])){r=(l[2]||" ")+Wa[t][0];break}if(null==r)return void(e._isValid=!1)}if(!i&&null!=r)return void(e._isValid=!1);if(l[4]){if(!Ua.exec(l[4]))return void(e._isValid=!1);o="Z"}e._f=a+(r||"")+(o||""),yt(e)}else e._isValid=!1}function _t(e,t,n,i,a,r){var o=[ht(e),Ca.indexOf(t),parseInt(n,10),parseInt(i,10),parseInt(a,10)];return r&&o.push(parseInt(r,10)),o}function ht(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function ft(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function pt(e,t,n){if(e){if(Oa.indexOf(e)!==new Date(t[0],t[1],t[2]).getDay())return f(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function mt(e,t,n){if(e)return Qa[e];if(t)return 0;var i=parseInt(n,10),a=i%100;return(i-a)/100*60+a}function vt(e){var t=Xa.exec(ft(e._i));if(t){var n=_t(t[4],t[3],t[2],t[5],t[6],t[7]);if(!pt(t[1],n,e))return;e._a=n,e._tzm=mt(t[8],t[9],t[10]),e._d=Ee.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),f(e).rfc2822=!0}else e._isValid=!1}function gt(e){var n=Ga.exec(e._i);if(null!==n)return void(e._d=new Date(+n[1]));dt(e),!1===e._isValid&&(delete e._isValid,vt(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))}function yt(e){if(e._f===t.ISO_8601)return void dt(e);if(e._f===t.RFC_2822)return void vt(e);e._a=[],f(e).empty=!0;var n,i,a,r,o,s=""+e._i,l=s.length,c=0;for(a=W(e._f,e._locale).match(Ui)||[],n=0;n<a.length;n++)r=a[n],i=(s.match(X(r,e))||[])[0],i&&(o=s.substr(0,s.indexOf(i)),o.length>0&&f(e).unusedInput.push(o),s=s.slice(s.indexOf(i)+i.length),c+=i.length),Gi[r]?(i?f(e).empty=!1:f(e).unusedTokens.push(r),Z(r,i,e)):e._strict&&!i&&f(e).unusedTokens.push(r);f(e).charsLeftOver=l-c,s.length>0&&f(e).unusedInput.push(s),e._a[ma]<=12&&!0===f(e).bigHour&&e._a[ma]>0&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[ma]=St(e._locale,e._a[ma],e._meridiem),ct(e),ot(e)}function St(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(i=e.isPM(n),i&&t<12&&(t+=12),i||12!==t||(t=0),t):t}function Et(e){var t,n,i,a,r;if(0===e._f.length)return f(e).invalidFormat=!0,void(e._d=new Date(NaN));for(a=0;a<e._f.length;a++)r=0,t=v({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[a],yt(t),p(t)&&(r+=f(t).charsLeftOver,r+=10*f(t).unusedTokens.length,f(t).score=r,(null==i||r<i)&&(i=r,n=t));d(e,n||t)}function bt(e){if(!e._d){var t=q(e._i);e._a=c([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}function Tt(e){var t=new g(ot(Mt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Mt(e){var t=e._i,n=e._f;return e._locale=e._locale||at(e._l),null===t||void 0===n&&""===t?m({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),y(t)?new g(ot(t)):(l(t)?e._d=t:i(n)?Et(e):n?yt(e):It(e),p(e)||(e._d=null),e))}function It(e){var n=e._i;o(n)?e._d=new Date(t.now()):l(n)?e._d=new Date(n.valueOf()):"string"==typeof n?gt(e):i(n)?(e._a=c(n.slice(0),function(e){return parseInt(e,10)}),ct(e)):a(n)?bt(e):s(n)?e._d=new Date(n):t.createFromInputFallback(e)}function Ct(e,t,n,o,s){var l={};return!0!==n&&!1!==n||(o=n,n=void 0),(a(e)&&r(e)||i(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=s,l._l=n,l._i=e,l._f=t,l._strict=o,Tt(l)}function At(e,t,n,i){return Ct(e,t,n,i,!1)}function Dt(e,t){var n,a;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return At();for(n=t[0],a=1;a<t.length;++a)t[a].isValid()&&!t[a][e](n)||(n=t[a]);return n}function xt(){return Dt("isBefore",[].slice.call(arguments,0))}function Rt(){return Dt("isAfter",[].slice.call(arguments,0))}function Ot(e){for(var t in e)if(-1===ba.call(Za,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,i=0;i<Za.length;++i)if(e[Za[i]]){if(n)return!1;parseFloat(e[Za[i]])!==E(e[Za[i]])&&(n=!0)}return!0}function Lt(){return this._isValid}function kt(){return $t(NaN)}function Nt(e){var t=q(e),n=t.year||0,i=t.quarter||0,a=t.month||0,r=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=Ot(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+o+7*r,this._months=+a+3*i+12*n,this._data={},this._locale=at(),this._bubble()}function wt(e){return e instanceof Nt}function Ft(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Pt(e,t){H(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+j(~~(e/60),2)+t+j(~~e%60,2)})}function qt(e,t){var n=(t||"").match(e);if(null===n)return null;var i=n[n.length-1]||[],a=(i+"").match(er)||["-",0,0],r=60*a[1]+E(a[2]);return 0===r?0:"+"===a[0]?r:-r}function Vt(e,n){var i,a;return n._isUTC?(i=n.clone(),a=(y(e)||l(e)?e.valueOf():At(e).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+a),t.updateOffset(i,!1),i):At(e).local()}function Bt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function jt(e,n,i){var a,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=qt(la,e)))return this}else Math.abs(e)<16&&!i&&(e*=60);return!this._isUTC&&n&&(a=Bt(this)),this._offset=e,this._isUTC=!0,null!=a&&this.add(a,"m"),r!==e&&(!n||this._changeInProgress?an(this,$t(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Bt(this)}function Ht(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function zt(e){return this.utcOffset(0,e)}function Ut(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Bt(this),"m")),this}function Yt(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=qt(sa,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Wt(e){return!!this.isValid()&&(e=e?At(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Gt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Xt(){if(!o(this._isDSTShifted))return this._isDSTShifted;var e={};if(v(e,this),e=Mt(e),e._a){var t=e._isUTC?_(e._a):At(e._a);this._isDSTShifted=this.isValid()&&b(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Qt(){return!!this.isValid()&&!this._isUTC}function Jt(){return!!this.isValid()&&this._isUTC}function Kt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function $t(e,t){var n,i,a,r=e,o=null;return wt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:s(e)?(r={},t?r[t]=e:r.milliseconds=e):(o=tr.exec(e))?(n="-"===o[1]?-1:1,r={y:0,d:E(o[pa])*n,h:E(o[ma])*n,m:E(o[va])*n,s:E(o[ga])*n,ms:E(Ft(1e3*o[ya]))*n}):(o=nr.exec(e))?(n="-"===o[1]?-1:1,r={y:Zt(o[2],n),M:Zt(o[3],n),w:Zt(o[4],n),d:Zt(o[5],n),h:Zt(o[6],n),m:Zt(o[7],n),s:Zt(o[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(a=tn(At(r.from),At(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new Nt(r),wt(e)&&u(e,"_locale")&&(i._locale=e._locale),i}function Zt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function en(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function tn(e,t){var n;return e.isValid()&&t.isValid()?(t=Vt(t,e),e.isBefore(t)?n=en(e,t):(n=en(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function nn(e,t){return function(n,i){var a,r;return null===i||isNaN(+i)||(I(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=i,i=r),n="string"==typeof n?+n:n,a=$t(n,i),an(this,a,e),this}}function an(e,n,i,a){var r=n._milliseconds,o=Ft(n._days),s=Ft(n._months);e.isValid()&&(a=null==a||a,s&&fe(e,ae(e,"Month")+s*i),o&&re(e,"Date",ae(e,"Date")+o*i),r&&e._d.setTime(e._d.valueOf()+r*i),a&&t.updateOffset(e,o||s))}function rn(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function on(e,n){var i=e||At(),a=Vt(i,this).startOf("day"),r=t.calendarFormat(this,a)||"sameElse",o=n&&(C(n[r])?n[r].call(this,i):n[r]);return this.format(o||this.localeData().calendar(r,this,At(i)))}function sn(){return new g(this)}function ln(e,t){var n=y(e)?e:At(e);return!(!this.isValid()||!n.isValid())&&(t=P(t)||"millisecond","millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function cn(e,t){var n=y(e)?e:At(e);return!(!this.isValid()||!n.isValid())&&(t=P(t)||"millisecond","millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function un(e,t,n,i){var a=y(e)?e:At(e),r=y(t)?t:At(t);return!!(this.isValid()&&a.isValid()&&r.isValid())&&(i=i||"()",("("===i[0]?this.isAfter(a,n):!this.isBefore(a,n))&&(")"===i[1]?this.isBefore(r,n):!this.isAfter(r,n)))}function dn(e,t){var n,i=y(e)?e:At(e);return!(!this.isValid()||!i.isValid())&&(t=P(t)||"millisecond","millisecond"===t?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function _n(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function hn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function fn(e,t,n){var i,a,r;if(!this.isValid())return NaN;if(i=Vt(e,this),!i.isValid())return NaN;switch(a=6e4*(i.utcOffset()-this.utcOffset()),t=P(t)){case"year":r=pn(this,i)/12;break;case"month":r=pn(this,i);break;case"quarter":r=pn(this,i)/3;break;case"second":r=(this-i)/1e3;break;case"minute":r=(this-i)/6e4;break;case"hour":r=(this-i)/36e5;break;case"day":r=(this-i-a)/864e5;break;case"week":r=(this-i-a)/6048e5;break;default:r=this-i}return n?r:S(r)}function pn(e,t){var n,i,a=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(a,"months");return t-r<0?(n=e.clone().add(a-1,"months"),i=(t-r)/(r-n)):(n=e.clone().add(a+1,"months"),i=(t-r)/(n-r)),-(a+i)||0}function mn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function vn(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?Y(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):C(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",Y(n,"Z")):Y(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function gn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a=t+'[")]';return this.format(n+i+"-MM-DD[T]HH:mm:ss.SSS"+a)}function yn(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=Y(this,e);return this.localeData().postformat(n)}function Sn(e,t){return this.isValid()&&(y(e)&&e.isValid()||At(e).isValid())?$t({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function En(e){return this.from(At(),e)}function bn(e,t){return this.isValid()&&(y(e)&&e.isValid()||At(e).isValid())?$t({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Tn(e){return this.to(At(),e)}function Mn(e){var t;return void 0===e?this._locale._abbr:(t=at(e),null!=t&&(this._locale=t),this)}function In(){return this._locale}function Cn(e,t){return(e%t+t)%t}function An(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-cr:new Date(e,t,n).valueOf()}function Dn(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-cr:Date.UTC(e,t,n)}function xn(e){var n;if(void 0===(e=P(e))||"millisecond"===e||!this.isValid())return this;var i=this._isUTC?Dn:An;switch(e){case"year":n=i(this.year(),0,1);break;case"quarter":n=i(this.year(),this.month()-this.month()%3,1);break;case"month":n=i(this.year(),this.month(),1);break;case"week":n=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":n=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":n=i(this.year(),this.month(),this.date());break;case"hour":n=this._d.valueOf(),n-=Cn(n+(this._isUTC?0:this.utcOffset()*sr),lr);break;case"minute":n=this._d.valueOf(),n-=Cn(n,sr);break;case"second":n=this._d.valueOf(),n-=Cn(n,or)}return this._d.setTime(n),t.updateOffset(this,!0),this}function Rn(e){var n;if(void 0===(e=P(e))||"millisecond"===e||!this.isValid())return this;var i=this._isUTC?Dn:An;switch(e){case"year":n=i(this.year()+1,0,1)-1;break;case"quarter":n=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":n=i(this.year(),this.month()+1,1)-1;break;case"week":n=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":n=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":n=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":n=this._d.valueOf(),n+=lr-Cn(n+(this._isUTC?0:this.utcOffset()*sr),lr)-1;break;case"minute":n=this._d.valueOf(),n+=sr-Cn(n,sr)-1;break;case"second":n=this._d.valueOf(),n+=or-Cn(n,or)-1}return this._d.setTime(n),t.updateOffset(this,!0),this}function On(){return this._d.valueOf()-6e4*(this._offset||0)}function Ln(){return Math.floor(this.valueOf()/1e3)}function kn(){return new Date(this.valueOf())}function Nn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function wn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Fn(){return this.isValid()?this.toISOString():null}function Pn(){return p(this)}function qn(){return d({},f(this))}function Vn(){return f(this).overflow}function Bn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function jn(e,t){H(0,[e,e.length],0,t)}function Hn(e){return Wn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function zn(e){return Wn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Un(){return Ie(this.year(),1,4)}function Yn(){var e=this.localeData()._week;return Ie(this.year(),e.dow,e.doy)}function Wn(e,t,n,i,a){var r;return null==e?Me(this,i,a).year:(r=Ie(e,i,a),t>r&&(t=r),Gn.call(this,e,t,n,i,a))}function Gn(e,t,n,i,a){var r=Te(e,t,n,i,a),o=Ee(r.year,0,r.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}function Xn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Qn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Jn(e,t){t[ya]=E(1e3*("0."+e))}function Kn(){return this._isUTC?"UTC":""}function $n(){return this._isUTC?"Coordinated Universal Time":""}function Zn(e){return At(1e3*e)}function ei(){return At.apply(null,arguments).parseZone()}function ti(e){return e}function ni(e,t,n,i){var a=at(),r=_().set(i,t);return a[n](r,e)}function ii(e,t,n){if(s(e)&&(t=e,e=void 0),e=e||"",null!=t)return ni(e,t,n,"month");var i,a=[];for(i=0;i<12;i++)a[i]=ni(e,i,n,"month");return a}function ai(e,t,n,i){"boolean"==typeof e?(s(t)&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,s(t)&&(n=t,t=void 0),t=t||"");var a=at(),r=e?a._week.dow:0;if(null!=n)return ni(t,(n+r)%7,i,"day");var o,l=[];for(o=0;o<7;o++)l[o]=ni(t,(o+r)%7,i,"day");return l}function ri(e,t){return ii(e,t,"months")}function oi(e,t){return ii(e,t,"monthsShort")}function si(e,t,n){return ai(e,t,n,"weekdays")}function li(e,t,n){return ai(e,t,n,"weekdaysShort")}function ci(e,t,n){return ai(e,t,n,"weekdaysMin")}function ui(){var e=this._data;return this._milliseconds=vr(this._milliseconds),this._days=vr(this._days),this._months=vr(this._months),e.milliseconds=vr(e.milliseconds),e.seconds=vr(e.seconds),e.minutes=vr(e.minutes),e.hours=vr(e.hours),e.months=vr(e.months),e.years=vr(e.years),this}function di(e,t,n,i){var a=$t(t,n);return e._milliseconds+=i*a._milliseconds,e._days+=i*a._days,e._months+=i*a._months,e._bubble()}function _i(e,t){return di(this,e,t,1)}function hi(e,t){return di(this,e,t,-1)}function fi(e){return e<0?Math.floor(e):Math.ceil(e)}function pi(){var e,t,n,i,a,r=this._milliseconds,o=this._days,s=this._months,l=this._data;return r>=0&&o>=0&&s>=0||r<=0&&o<=0&&s<=0||(r+=864e5*fi(vi(s)+o),o=0,s=0),l.milliseconds=r%1e3,e=S(r/1e3),l.seconds=e%60,t=S(e/60),l.minutes=t%60,n=S(t/60),l.hours=n%24,o+=S(n/24),a=S(mi(o)),s+=a,o-=fi(vi(a)),i=S(s/12),s%=12,l.days=o,l.months=s,l.years=i,this}function mi(e){return 4800*e/146097}function vi(e){return 146097*e/4800}function gi(e){if(!this.isValid())return NaN;var t,n,i=this._milliseconds;if("month"===(e=P(e))||"quarter"===e||"year"===e)switch(t=this._days+i/864e5,n=this._months+mi(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(vi(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function yi(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*E(this._months/12):NaN}function Si(e){return function(){return this.as(e)}}function Ei(){return $t(this)}function bi(e){return e=P(e),this.isValid()?this[e+"s"]():NaN}function Ti(e){return function(){return this.isValid()?this._data[e]:NaN}}function Mi(){return S(this.days()/7)}function Ii(e,t,n,i,a){return a.relativeTime(t||1,!!n,e,i)}function Ci(e,t,n){var i=$t(e).abs(),a=Nr(i.as("s")),r=Nr(i.as("m")),o=Nr(i.as("h")),s=Nr(i.as("d")),l=Nr(i.as("M")),c=Nr(i.as("y")),u=a<=wr.ss&&["s",a]||a<wr.s&&["ss",a]||r<=1&&["m"]||r<wr.m&&["mm",r]||o<=1&&["h"]||o<wr.h&&["hh",o]||s<=1&&["d"]||s<wr.d&&["dd",s]||l<=1&&["M"]||l<wr.M&&["MM",l]||c<=1&&["y"]||["yy",c];return u[2]=t,u[3]=+e>0,u[4]=n,Ii.apply(null,u)}function Ai(e){return void 0===e?Nr:"function"==typeof e&&(Nr=e,!0)}function Di(e,t){return void 0!==wr[e]&&(void 0===t?wr[e]:(wr[e]=t,"s"===e&&(wr.ss=t-1),!0))}function xi(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=Ci(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Ri(e){return(e>0)-(e<0)||+e}function Oi(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,i=Fr(this._milliseconds)/1e3,a=Fr(this._days),r=Fr(this._months);e=S(i/60),t=S(e/60),i%=60,e%=60,n=S(r/12),r%=12;var o=n,s=r,l=a,c=t,u=e,d=i?i.toFixed(3).replace(/\.?0+$/,""):"",_=this.asSeconds();if(!_)return"P0D";var h=_<0?"-":"",f=Ri(this._months)!==Ri(_)?"-":"",p=Ri(this._days)!==Ri(_)?"-":"",m=Ri(this._milliseconds)!==Ri(_)?"-":"";return h+"P"+(o?f+o+"Y":"")+(s?f+s+"M":"")+(l?p+l+"D":"")+(c||u||d?"T":"")+(c?m+c+"H":"")+(u?m+u+"M":"")+(d?m+d+"S":"")}var Li,ki;ki=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,i=0;i<n;i++)if(i in t&&e.call(this,t[i],i,t))return!0;return!1};var Ni=t.momentProperties=[],wi=!1,Fi={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var Pi;Pi=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)u(e,t)&&n.push(t);return n};var qi={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Vi={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Bi=/\d{1,2}/,ji={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Hi={},zi={},Ui=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Yi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Wi={},Gi={},Xi=/\d/,Qi=/\d\d/,Ji=/\d{3}/,Ki=/\d{4}/,$i=/[+-]?\d{6}/,Zi=/\d\d?/,ea=/\d\d\d\d?/,ta=/\d\d\d\d\d\d?/,na=/\d{1,3}/,ia=/\d{1,4}/,aa=/[+-]?\d{1,6}/,ra=/\d+/,oa=/[+-]?\d+/,sa=/Z|[+-]\d\d:?\d\d/gi,la=/Z|[+-]\d\d(?::?\d\d)?/gi,ca=/[+-]?\d+(\.\d{1,3})?/,ua=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,da={},_a={},ha=0,fa=1,pa=2,ma=3,va=4,ga=5,ya=6,Sa=7,Ea=8;H("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),F("year","y"),V("year",1),G("Y",oa),G("YY",Zi,Qi),G("YYYY",ia,Ki),G("YYYYY",aa,$i),G("YYYYYY",aa,$i),K(["YYYYY","YYYYYY"],ha),K("YYYY",function(e,n){n[ha]=2===e.length?t.parseTwoDigitYear(e):E(e)}),K("YY",function(e,n){n[ha]=t.parseTwoDigitYear(e)}),K("Y",function(e,t){t[ha]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return E(e)+(E(e)>68?1900:2e3)};var ba,Ta=ie("FullYear",!0);ba=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),H("MMMM",0,0,function(e){return this.localeData().months(this,e)}),F("month","M"),V("month",8),G("M",Zi),G("MM",Zi,Qi),G("MMM",function(e,t){return t.monthsShortRegex(e)}),G("MMMM",function(e,t){return t.monthsRegex(e)}),K(["M","MM"],function(e,t){t[fa]=E(e)-1}),K(["MMM","MMMM"],function(e,t,n,i){var a=n._locale.monthsParse(e,i,n._strict);null!=a?t[fa]=a:f(n).invalidMonth=e});var Ma=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ia="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ca="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Aa=ua,Da=ua;H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),F("week","w"),F("isoWeek","W"),V("week",5),V("isoWeek",5),G("w",Zi),G("ww",Zi,Qi),G("W",Zi),G("WW",Zi,Qi),$(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=E(e)});var xa={dow:0,doy:6};H("d",0,"do","day"),H("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),H("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),H("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),F("day","d"),F("weekday","e"),F("isoWeekday","E"),V("day",11),V("weekday",11),V("isoWeekday",11),G("d",Zi),G("e",Zi),G("E",Zi),G("dd",function(e,t){return t.weekdaysMinRegex(e)}),G("ddd",function(e,t){return t.weekdaysShortRegex(e)}),G("dddd",function(e,t){return t.weekdaysRegex(e)}),$(["dd","ddd","dddd"],function(e,t,n,i){var a=n._locale.weekdaysParse(e,i,n._strict);null!=a?t.d=a:f(n).invalidWeekday=e}),$(["d","e","E"],function(e,t,n,i){t[i]=E(e)});var Ra="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Oa="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),La="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ka=ua,Na=ua,wa=ua;H("H",["HH",2],0,"hour"),H("h",["hh",2],0,We),H("k",["kk",2],0,Ge),H("hmm",0,0,function(){return""+We.apply(this)+j(this.minutes(),2)}),H("hmmss",0,0,function(){return""+We.apply(this)+j(this.minutes(),2)+j(this.seconds(),2)}),H("Hmm",0,0,function(){return""+this.hours()+j(this.minutes(),2)}),H("Hmmss",0,0,function(){return""+this.hours()+j(this.minutes(),2)+j(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),F("hour","h"),V("hour",13),G("a",Qe),G("A",Qe),G("H",Zi),G("h",Zi),G("k",Zi),G("HH",Zi,Qi),G("hh",Zi,Qi),G("kk",Zi,Qi),G("hmm",ea),G("hmmss",ta),G("Hmm",ea),G("Hmmss",ta),K(["H","HH"],ma),K(["k","kk"],function(e,t,n){var i=E(e);t[ma]=24===i?0:i}),K(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),K(["h","hh"],function(e,t,n){t[ma]=E(e),f(n).bigHour=!0}),K("hmm",function(e,t,n){var i=e.length-2;t[ma]=E(e.substr(0,i)),t[va]=E(e.substr(i)),f(n).bigHour=!0}),K("hmmss",function(e,t,n){var i=e.length-4,a=e.length-2;t[ma]=E(e.substr(0,i)),t[va]=E(e.substr(i,2)),t[ga]=E(e.substr(a)),f(n).bigHour=!0}),K("Hmm",function(e,t,n){var i=e.length-2;t[ma]=E(e.substr(0,i)),t[va]=E(e.substr(i))}),K("Hmmss",function(e,t,n){var i=e.length-4,a=e.length-2;t[ma]=E(e.substr(0,i)),t[va]=E(e.substr(i,2)),t[ga]=E(e.substr(a))});var Fa,Pa=/[ap]\.?m?\.?/i,qa=ie("Hours",!0),Va={calendar:qi,longDateFormat:Vi,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:Bi,relativeTime:ji,months:Ia,monthsShort:Ca,week:xa,weekdays:Ra,weekdaysMin:La,weekdaysShort:Oa,meridiemParse:Pa},Ba={},ja={},Ha=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,za=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ua=/Z|[+-]\d\d(?::?\d\d)?/,Ya=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Wa=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ga=/^\/?Date\((\-?\d+)/i,Xa=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Qa={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};t.createFromInputFallback=M("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Ja=M("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=At.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:m()}),Ka=M("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=At.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:m()}),$a=function(){return Date.now?Date.now():+new Date},Za=["year","quarter","month","week","day","hour","minute","second","millisecond"];Pt("Z",":"),Pt("ZZ",""),G("Z",la),G("ZZ",la),K(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=qt(la,e)});var er=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var tr=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,nr=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;$t.fn=Nt.prototype,$t.invalid=kt;var ir=nn(1,"add"),ar=nn(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var rr=M("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)}),or=1e3,sr=60*or,lr=60*sr,cr=3506328*lr;H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),jn("gggg","weekYear"),jn("ggggg","weekYear"),jn("GGGG","isoWeekYear"),jn("GGGGG","isoWeekYear"),F("weekYear","gg"),F("isoWeekYear","GG"),V("weekYear",1),V("isoWeekYear",1),G("G",oa),G("g",oa),G("GG",Zi,Qi),G("gg",Zi,Qi),G("GGGG",ia,Ki),G("gggg",ia,Ki),G("GGGGG",aa,$i),G("ggggg",aa,$i),$(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=E(e)}),$(["gg","GG"],function(e,n,i,a){n[a]=t.parseTwoDigitYear(e)}),H("Q",0,"Qo","quarter"),F("quarter","Q"),V("quarter",7),G("Q",Xi),K("Q",function(e,t){t[fa]=3*(E(e)-1)}),H("D",["DD",2],"Do","date"),F("date","D"),V("date",9),G("D",Zi),G("DD",Zi,Qi),G("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),K(["D","DD"],pa),K("Do",function(e,t){t[pa]=E(e.match(Zi)[0])});var ur=ie("Date",!0);H("DDD",["DDDD",3],"DDDo","dayOfYear"),F("dayOfYear","DDD"),V("dayOfYear",4),G("DDD",na),G("DDDD",Ji),K(["DDD","DDDD"],function(e,t,n){n._dayOfYear=E(e)}),H("m",["mm",2],0,"minute"),F("minute","m"),V("minute",14),G("m",Zi),G("mm",Zi,Qi),K(["m","mm"],va);var dr=ie("Minutes",!1);H("s",["ss",2],0,"second"),F("second","s"),V("second",15),G("s",Zi),G("ss",Zi,Qi),K(["s","ss"],ga);var _r=ie("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),F("millisecond","ms"),V("millisecond",16),G("S",na,Xi),G("SS",na,Qi),G("SSS",na,Ji);var hr;for(hr="SSSS";hr.length<=9;hr+="S")G(hr,ra);for(hr="S";hr.length<=9;hr+="S")K(hr,Jn);var fr=ie("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var pr=g.prototype;pr.add=ir,pr.calendar=on,pr.clone=sn,pr.diff=fn,pr.endOf=Rn,pr.format=yn,pr.from=Sn,pr.fromNow=En,pr.to=bn,pr.toNow=Tn,pr.get=oe,pr.invalidAt=Vn,pr.isAfter=ln,pr.isBefore=cn,pr.isBetween=un,pr.isSame=dn,pr.isSameOrAfter=_n,pr.isSameOrBefore=hn,pr.isValid=Pn,pr.lang=rr,pr.locale=Mn,pr.localeData=In,pr.max=Ka,pr.min=Ja,pr.parsingFlags=qn,pr.set=se,pr.startOf=xn,pr.subtract=ar,pr.toArray=Nn,pr.toObject=wn,pr.toDate=kn,pr.toISOString=vn,pr.inspect=gn,pr.toJSON=Fn,pr.toString=mn,pr.unix=Ln,pr.valueOf=On,pr.creationData=Bn,pr.year=Ta,pr.isLeapYear=ne,pr.weekYear=Hn,pr.isoWeekYear=zn,pr.quarter=pr.quarters=Xn,pr.month=pe,pr.daysInMonth=me,pr.week=pr.weeks=xe,pr.isoWeek=pr.isoWeeks=Re,pr.weeksInYear=Yn,pr.isoWeeksInYear=Un,pr.date=ur,pr.day=pr.days=Ve,pr.weekday=Be,pr.isoWeekday=je,pr.dayOfYear=Qn,pr.hour=pr.hours=qa,pr.minute=pr.minutes=dr,pr.second=pr.seconds=_r,pr.millisecond=pr.milliseconds=fr,pr.utcOffset=jt,pr.utc=zt,pr.local=Ut,pr.parseZone=Yt,pr.hasAlignedHourOffset=Wt,pr.isDST=Gt,pr.isLocal=Qt,pr.isUtcOffset=Jt,pr.isUtc=Kt,pr.isUTC=Kt,pr.zoneAbbr=Kn,pr.zoneName=$n,pr.dates=M("dates accessor is deprecated. Use date instead.",ur),pr.months=M("months accessor is deprecated. Use month instead",pe),pr.years=M("years accessor is deprecated. Use year instead",Ta),pr.zone=M("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Ht),pr.isDSTShifted=M("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Xt);var mr=x.prototype;mr.calendar=R,mr.longDateFormat=O,mr.invalidDate=L,mr.ordinal=k,mr.preparse=ti,mr.postformat=ti,mr.relativeTime=N,mr.pastFuture=w,mr.set=A,mr.months=ue,mr.monthsShort=de,mr.monthsParse=he,mr.monthsRegex=ge,mr.monthsShortRegex=ve,mr.week=Ce,mr.firstDayOfYear=De,mr.firstDayOfWeek=Ae,mr.weekdays=Ne,mr.weekdaysMin=Fe,mr.weekdaysShort=we,mr.weekdaysParse=qe,mr.weekdaysRegex=He,mr.weekdaysShortRegex=ze,mr.weekdaysMinRegex=Ue,mr.isPM=Je,mr.meridiem=Ke,tt("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===E(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),t.lang=M("moment.lang is deprecated. Use moment.locale instead.",tt),t.langData=M("moment.langData is deprecated. Use moment.localeData instead.",at);var vr=Math.abs,gr=Si("ms"),yr=Si("s"),Sr=Si("m"),Er=Si("h"),br=Si("d"),Tr=Si("w"),Mr=Si("M"),Ir=Si("Q"),Cr=Si("y"),Ar=Ti("milliseconds"),Dr=Ti("seconds"),xr=Ti("minutes"),Rr=Ti("hours"),Or=Ti("days"),Lr=Ti("months"),kr=Ti("years"),Nr=Math.round,wr={ss:44,s:45,m:45,h:22,d:26,M:11},Fr=Math.abs,Pr=Nt.prototype;return Pr.isValid=Lt,Pr.abs=ui,Pr.add=_i,Pr.subtract=hi,Pr.as=gi,Pr.asMilliseconds=gr,Pr.asSeconds=yr,Pr.asMinutes=Sr,Pr.asHours=Er,Pr.asDays=br,Pr.asWeeks=Tr,Pr.asMonths=Mr,Pr.asQuarters=Ir,Pr.asYears=Cr,Pr.valueOf=yi,Pr._bubble=pi,Pr.clone=Ei,Pr.get=bi,Pr.milliseconds=Ar,Pr.seconds=Dr,Pr.minutes=xr,Pr.hours=Rr,Pr.days=Or,Pr.weeks=Mi,Pr.months=Lr,Pr.years=kr,Pr.humanize=xi,Pr.toISOString=Oi,Pr.toString=Oi,Pr.toJSON=Oi,Pr.locale=Mn,Pr.localeData=In,Pr.toIsoString=M("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Oi),Pr.lang=rr,H("X",0,0,"unix"),H("x",0,0,"valueOf"),G("x",oa),G("X",ca),K("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),K("x",function(e,t,n){n._d=new Date(E(e))}),t.version="2.24.0",function(e){Li=e}(At),t.fn=pr,t.min=xt,t.max=Rt,t.now=$a,t.utc=_,t.unix=Zn,t.months=ri,t.isDate=l,t.locale=tt,t.invalid=m,t.duration=$t,t.isMoment=y,t.weekdays=si,t.parseZone=ei,t.localeData=at,t.isDuration=wt,t.monthsShort=oi,t.weekdaysMin=ci,t.defineLocale=nt,t.updateLocale=it,t.locales=rt,t.weekdaysShort=li,t.normalizeUnits=P,t.relativeTimeRounding=Ai,t.relativeTimeThreshold=Di,t.calendarFormat=rn,t.prototype=pr,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},t})}).call(t,n(669)(e))},function(e,t,n){var i=n(17),a=n(43),r=n(35),o=n(36),s=n(44),l=function(e,t,n){var c,u,d,_,h=e&l.F,f=e&l.G,p=e&l.S,m=e&l.P,v=e&l.B,g=f?i:p?i[t]||(i[t]={}):(i[t]||{}).prototype,y=f?a:a[t]||(a[t]={}),S=y.prototype||(y.prototype={});f&&(n=t);for(c in n)u=!h&&g&&void 0!==g[c],d=(u?g:n)[c],_=v&&u?s(d,i):m&&"function"==typeof d?s(Function.call,d):d,g&&o(g,c,d,e&l.U),y[c]!=d&&r(y,c,_),m&&S[c]!=d&&(S[c]=d)};i.core=a,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var i,a;/*!
 * jQuery JavaScript Library v3.2.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2017-03-20T18:59Z
 */
!function(t,n){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,function(n,r){"use strict";function o(e,t){t=t||oe;var n=t.createElement("script");n.text=e,t.head.appendChild(n).parentNode.removeChild(n)}function s(e){var t=!!e&&"length"in e&&e.length,n=ge.type(e);return"function"!==n&&!ge.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function l(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function c(e,t,n){return ge.isFunction(t)?ge.grep(e,function(e,i){return!!t.call(e,i,e)!==n}):t.nodeType?ge.grep(e,function(e){return e===t!==n}):"string"!=typeof t?ge.grep(e,function(e){return de.call(t,e)>-1!==n}):De.test(t)?ge.filter(t,e,n):(t=ge.filter(t,e),ge.grep(e,function(e){return de.call(t,e)>-1!==n&&1===e.nodeType}))}function u(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function d(e){var t={};return ge.each(e.match(ke)||[],function(e,n){t[n]=!0}),t}function _(e){return e}function h(e){throw e}function f(e,t,n,i){var a;try{e&&ge.isFunction(a=e.promise)?a.call(e).done(t).fail(n):e&&ge.isFunction(a=e.then)?a.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}function p(){oe.removeEventListener("DOMContentLoaded",p),n.removeEventListener("load",p),ge.ready()}function m(){this.expando=ge.expando+m.uid++}function v(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Be.test(e)?JSON.parse(e):e)}function g(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(je,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=v(n)}catch(e){}Ve.set(e,t,n)}else n=void 0;return n}function y(e,t,n,i){var a,r=1,o=20,s=i?function(){return i.cur()}:function(){return ge.css(e,t,"")},l=s(),c=n&&n[3]||(ge.cssNumber[t]?"":"px"),u=(ge.cssNumber[t]||"px"!==c&&+l)&&ze.exec(ge.css(e,t));if(u&&u[3]!==c){c=c||u[3],n=n||[],u=+l||1;do{r=r||".5",u/=r,ge.style(e,t,u+c)}while(r!==(r=s()/l)&&1!==r&&--o)}return n&&(u=+u||+l||0,a=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=a)),a}function S(e){var t,n=e.ownerDocument,i=e.nodeName,a=Ge[i];return a||(t=n.body.appendChild(n.createElement(i)),a=ge.css(t,"display"),t.parentNode.removeChild(t),"none"===a&&(a="block"),Ge[i]=a,a)}function E(e,t){for(var n,i,a=[],r=0,o=e.length;r<o;r++)i=e[r],i.style&&(n=i.style.display,t?("none"===n&&(a[r]=qe.get(i,"display")||null,a[r]||(i.style.display="")),""===i.style.display&&Ye(i)&&(a[r]=S(i))):"none"!==n&&(a[r]="none",qe.set(i,"display",n)));for(r=0;r<o;r++)null!=a[r]&&(e[r].style.display=a[r]);return e}function b(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&l(e,t)?ge.merge([e],n):n}function T(e,t){for(var n=0,i=e.length;n<i;n++)qe.set(e[n],"globalEval",!t||qe.get(t[n],"globalEval"))}function M(e,t,n,i,a){for(var r,o,s,l,c,u,d=t.createDocumentFragment(),_=[],h=0,f=e.length;h<f;h++)if((r=e[h])||0===r)if("object"===ge.type(r))ge.merge(_,r.nodeType?[r]:r);else if($e.test(r)){for(o=o||d.appendChild(t.createElement("div")),s=(Qe.exec(r)||["",""])[1].toLowerCase(),l=Ke[s]||Ke._default,o.innerHTML=l[1]+ge.htmlPrefilter(r)+l[2],u=l[0];u--;)o=o.lastChild;ge.merge(_,o.childNodes),o=d.firstChild,o.textContent=""}else _.push(t.createTextNode(r));for(d.textContent="",h=0;r=_[h++];)if(i&&ge.inArray(r,i)>-1)a&&a.push(r);else if(c=ge.contains(r.ownerDocument,r),o=b(d.appendChild(r),"script"),c&&T(o),n)for(u=0;r=o[u++];)Je.test(r.type||"")&&n.push(r);return d}function I(){return!0}function C(){return!1}function A(){try{return oe.activeElement}catch(e){}}function D(e,t,n,i,a,r){var o,s;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=void 0);for(s in t)D(e,s,n,i,t[s],r);return e}if(null==i&&null==a?(a=n,i=n=void 0):null==a&&("string"==typeof n?(a=i,i=void 0):(a=i,i=n,n=void 0)),!1===a)a=C;else if(!a)return e;return 1===r&&(o=a,a=function(e){return ge().off(e),o.apply(this,arguments)},a.guid=o.guid||(o.guid=ge.guid++)),e.each(function(){ge.event.add(this,t,a,i,n)})}function x(e,t){return l(e,"table")&&l(11!==t.nodeType?t:t.firstChild,"tr")?ge(">tbody",e)[0]||e:e}function R(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function O(e){var t=ot.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function L(e,t){var n,i,a,r,o,s,l,c;if(1===t.nodeType){if(qe.hasData(e)&&(r=qe.access(e),o=qe.set(t,r),c=r.events)){delete o.handle,o.events={};for(a in c)for(n=0,i=c[a].length;n<i;n++)ge.event.add(t,a,c[a][n])}Ve.hasData(e)&&(s=Ve.access(e),l=ge.extend({},s),Ve.set(t,l))}}function k(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Xe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function N(e,t,n,i){t=ce.apply([],t);var a,r,s,l,c,u,d=0,_=e.length,h=_-1,f=t[0],p=ge.isFunction(f);if(p||_>1&&"string"==typeof f&&!ve.checkClone&&rt.test(f))return e.each(function(a){var r=e.eq(a);p&&(t[0]=f.call(this,a,r.html())),N(r,t,n,i)});if(_&&(a=M(t,e[0].ownerDocument,!1,e,i),r=a.firstChild,1===a.childNodes.length&&(a=r),r||i)){for(s=ge.map(b(a,"script"),R),l=s.length;d<_;d++)c=a,d!==h&&(c=ge.clone(c,!0,!0),l&&ge.merge(s,b(c,"script"))),n.call(e[d],c,d);if(l)for(u=s[s.length-1].ownerDocument,ge.map(s,O),d=0;d<l;d++)c=s[d],Je.test(c.type||"")&&!qe.access(c,"globalEval")&&ge.contains(u,c)&&(c.src?ge._evalUrl&&ge._evalUrl(c.src):o(c.textContent.replace(st,""),u))}return e}function w(e,t,n){for(var i,a=t?ge.filter(t,e):e,r=0;null!=(i=a[r]);r++)n||1!==i.nodeType||ge.cleanData(b(i)),i.parentNode&&(n&&ge.contains(i.ownerDocument,i)&&T(b(i,"script")),i.parentNode.removeChild(i));return e}function F(e,t,n){var i,a,r,o,s=e.style;return n=n||ut(e),n&&(o=n.getPropertyValue(t)||n[t],""!==o||ge.contains(e.ownerDocument,e)||(o=ge.style(e,t)),!ve.pixelMarginRight()&&ct.test(o)&&lt.test(t)&&(i=s.width,a=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=n.width,s.width=i,s.minWidth=a,s.maxWidth=r)),void 0!==o?o+"":o}function P(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function q(e){if(e in mt)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=pt.length;n--;)if((e=pt[n]+t)in mt)return e}function V(e){var t=ge.cssProps[e];return t||(t=ge.cssProps[e]=q(e)||e),t}function B(e,t,n){var i=ze.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function j(e,t,n,i,a){var r,o=0;for(r=n===(i?"border":"content")?4:"width"===t?1:0;r<4;r+=2)"margin"===n&&(o+=ge.css(e,n+Ue[r],!0,a)),i?("content"===n&&(o-=ge.css(e,"padding"+Ue[r],!0,a)),"margin"!==n&&(o-=ge.css(e,"border"+Ue[r]+"Width",!0,a))):(o+=ge.css(e,"padding"+Ue[r],!0,a),"padding"!==n&&(o+=ge.css(e,"border"+Ue[r]+"Width",!0,a)));return o}function H(e,t,n){var i,a=ut(e),r=F(e,t,a),o="border-box"===ge.css(e,"boxSizing",!1,a);return ct.test(r)?r:(i=o&&(ve.boxSizingReliable()||r===e.style[t]),"auto"===r&&(r=e["offset"+t[0].toUpperCase()+t.slice(1)]),(r=parseFloat(r)||0)+j(e,t,n||(o?"border":"content"),i,a)+"px")}function z(e,t,n,i,a){return new z.prototype.init(e,t,n,i,a)}function U(){gt&&(!1===oe.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(U):n.setTimeout(U,ge.fx.interval),ge.fx.tick())}function Y(){return n.setTimeout(function(){vt=void 0}),vt=ge.now()}function W(e,t){var n,i=0,a={height:e};for(t=t?1:0;i<4;i+=2-t)n=Ue[i],a["margin"+n]=a["padding"+n]=e;return t&&(a.opacity=a.width=e),a}function G(e,t,n){for(var i,a=(J.tweeners[t]||[]).concat(J.tweeners["*"]),r=0,o=a.length;r<o;r++)if(i=a[r].call(n,t,e))return i}function X(e,t,n){var i,a,r,o,s,l,c,u,d="width"in t||"height"in t,_=this,h={},f=e.style,p=e.nodeType&&Ye(e),m=qe.get(e,"fxshow");n.queue||(o=ge._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,s=o.empty.fire,o.empty.fire=function(){o.unqueued||s()}),o.unqueued++,_.always(function(){_.always(function(){o.unqueued--,ge.queue(e,"fx").length||o.empty.fire()})}));for(i in t)if(a=t[i],yt.test(a)){if(delete t[i],r=r||"toggle"===a,a===(p?"hide":"show")){if("show"!==a||!m||void 0===m[i])continue;p=!0}h[i]=m&&m[i]||ge.style(e,i)}if((l=!ge.isEmptyObject(t))||!ge.isEmptyObject(h)){d&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],c=m&&m.display,null==c&&(c=qe.get(e,"display")),u=ge.css(e,"display"),"none"===u&&(c?u=c:(E([e],!0),c=e.style.display||c,u=ge.css(e,"display"),E([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===ge.css(e,"float")&&(l||(_.done(function(){f.display=c}),null==c&&(u=f.display,c="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",_.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),l=!1;for(i in h)l||(m?"hidden"in m&&(p=m.hidden):m=qe.access(e,"fxshow",{display:c}),r&&(m.hidden=!p),p&&E([e],!0),_.done(function(){p||E([e]),qe.remove(e,"fxshow");for(i in h)ge.style(e,i,h[i])})),l=G(p?m[i]:0,i,_),i in m||(m[i]=l.start,p&&(l.end=l.start,l.start=0))}}function Q(e,t){var n,i,a,r,o;for(n in e)if(i=ge.camelCase(n),a=t[i],r=e[n],Array.isArray(r)&&(a=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),(o=ge.cssHooks[i])&&"expand"in o){r=o.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=a)}else t[i]=a}function J(e,t,n){var i,a,r=0,o=J.prefilters.length,s=ge.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var t=vt||Y(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,r=1-i,o=0,l=c.tweens.length;o<l;o++)c.tweens[o].run(r);return s.notifyWith(e,[c,r,n]),r<1&&l?n:(l||s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:ge.extend({},t),opts:ge.extend(!0,{specialEasing:{},easing:ge.easing._default},n),originalProperties:t,originalOptions:n,startTime:vt||Y(),duration:n.duration,tweens:[],createTween:function(t,n){var i=ge.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(a)return this;for(a=!0;n<i;n++)c.tweens[n].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),u=c.props;for(Q(u,c.opts.specialEasing);r<o;r++)if(i=J.prefilters[r].call(c,e,u,c.opts))return ge.isFunction(i.stop)&&(ge._queueHooks(c.elem,c.opts.queue).stop=ge.proxy(i.stop,i)),i;return ge.map(u,G,c),ge.isFunction(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),ge.fx.timer(ge.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}function K(e){return(e.match(ke)||[]).join(" ")}function $(e){return e.getAttribute&&e.getAttribute("class")||""}function Z(e,t,n,i){var a;if(Array.isArray(t))ge.each(t,function(t,a){n||Rt.test(e)?i(e,a):Z(e+"["+("object"==typeof a&&null!=a?t:"")+"]",a,n,i)});else if(n||"object"!==ge.type(t))i(e,t);else for(a in t)Z(e+"["+a+"]",t[a],n,i)}function ee(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,a=0,r=t.toLowerCase().match(ke)||[];if(ge.isFunction(n))for(;i=r[a++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function te(e,t,n,i){function a(s){var l;return r[s]=!0,ge.each(e[s]||[],function(e,s){var c=s(t,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}var r={},o=e===Ht;return a(t.dataTypes[0])||!r["*"]&&a("*")}function ne(e,t){var n,i,a=ge.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((a[n]?e:i||(i={}))[n]=t[n]);return i&&ge.extend(!0,e,i),e}function ie(e,t,n){for(var i,a,r,o,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(a in s)if(s[a]&&s[a].test(i)){l.unshift(a);break}if(l[0]in n)r=l[0];else{for(a in n){if(!l[0]||e.converters[a+" "+l[0]]){r=a;break}o||(o=a)}r=r||o}if(r)return r!==l[0]&&l.unshift(r),n[r]}function ae(e,t,n,i){var a,r,o,s,l,c={},u=e.dataTypes.slice();if(u[1])for(o in e.converters)c[o.toLowerCase()]=e.converters[o];for(r=u.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(o=c[l+" "+r]||c["* "+r]))for(a in c)if(s=a.split(" "),s[1]===r&&(o=c[l+" "+s[0]]||c["* "+s[0]])){!0===o?o=c[a]:!0!==c[a]&&(r=s[0],u.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}var re=[],oe=n.document,se=Object.getPrototypeOf,le=re.slice,ce=re.concat,ue=re.push,de=re.indexOf,_e={},he=_e.toString,fe=_e.hasOwnProperty,pe=fe.toString,me=pe.call(Object),ve={},ge=function(e,t){return new ge.fn.init(e,t)},ye=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Se=/^-ms-/,Ee=/-([a-z])/g,be=function(e,t){return t.toUpperCase()};ge.fn=ge.prototype={jquery:"3.2.1",constructor:ge,length:0,toArray:function(){return le.call(this)},get:function(e){return null==e?le.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ge.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ge.each(this,e)},map:function(e){return this.pushStack(ge.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(le.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:ue,sort:re.sort,splice:re.splice},ge.extend=ge.fn.extend=function(){var e,t,n,i,a,r,o=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[s]||{},s++),"object"==typeof o||ge.isFunction(o)||(o={}),s===l&&(o=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)n=o[t],i=e[t],o!==i&&(c&&i&&(ge.isPlainObject(i)||(a=Array.isArray(i)))?(a?(a=!1,r=n&&Array.isArray(n)?n:[]):r=n&&ge.isPlainObject(n)?n:{},o[t]=ge.extend(c,r,i)):void 0!==i&&(o[t]=i));return o},ge.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ge.type(e)},isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=ge.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==he.call(e))&&(!(t=se(e))||"function"==typeof(n=fe.call(t,"constructor")&&t.constructor)&&pe.call(n)===me)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?_e[he.call(e)]||"object":typeof e},globalEval:function(e){o(e)},camelCase:function(e){return e.replace(Se,"ms-").replace(Ee,be)},each:function(e,t){var n,i=0;if(s(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(ye,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(s(Object(e))?ge.merge(n,"string"==typeof e?[e]:e):ue.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:de.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,a=e.length;i<n;i++)e[a++]=t[i];return e.length=a,e},grep:function(e,t,n){for(var i=[],a=0,r=e.length,o=!n;a<r;a++)!t(e[a],a)!==o&&i.push(e[a]);return i},map:function(e,t,n){var i,a,r=0,o=[];if(s(e))for(i=e.length;r<i;r++)null!=(a=t(e[r],r,n))&&o.push(a);else for(r in e)null!=(a=t(e[r],r,n))&&o.push(a);return ce.apply([],o)},guid:1,proxy:function(e,t){var n,i,a;if("string"==typeof t&&(n=e[t],t=e,e=n),ge.isFunction(e))return i=le.call(arguments,2),a=function(){return e.apply(t||this,i.concat(le.call(arguments)))},a.guid=e.guid=e.guid||ge.guid++,a},now:Date.now,support:ve}),"function"==typeof Symbol&&(ge.fn[Symbol.iterator]=re[Symbol.iterator]),ge.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){_e["[object "+t+"]"]=t.toLowerCase()});var Te=/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(e){function t(e,t,n,i){var a,r,o,s,l,u,_,h=t&&t.ownerDocument,f=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==f&&9!==f&&11!==f)return n;if(!i&&((t?t.ownerDocument||t:V)!==O&&R(t),t=t||O,k)){if(11!==f&&(l=pe.exec(e)))if(a=l[1]){if(9===f){if(!(o=t.getElementById(a)))return n;if(o.id===a)return n.push(o),n}else if(h&&(o=h.getElementById(a))&&P(t,o)&&o.id===a)return n.push(o),n}else{if(l[2])return J.apply(n,t.getElementsByTagName(e)),n;if((a=l[3])&&S.getElementsByClassName&&t.getElementsByClassName)return J.apply(n,t.getElementsByClassName(a)),n}if(S.qsa&&!U[e+" "]&&(!N||!N.test(e))){if(1!==f)h=t,_=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(ye,Se):t.setAttribute("id",s=q),u=M(e),r=u.length;r--;)u[r]="#"+s+" "+d(u[r]);_=u.join(","),h=me.test(e)&&c(t.parentNode)||t}if(_)try{return J.apply(n,h.querySelectorAll(_)),n}catch(e){}finally{s===q&&t.removeAttribute("id")}}}return C(e.replace(re,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>E.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[q]=!0,e}function a(e){var t=O.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var n=e.split("|"),i=n.length;i--;)E.attrHandle[n[i]]=t}function o(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&be(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function l(e){return i(function(t){return t=+t,i(function(n,i){for(var a,r=e([],n.length,t),o=r.length;o--;)n[a=r[o]]&&(n[a]=!(i[a]=n[a]))})})}function c(e){return e&&void 0!==e.getElementsByTagName&&e}function u(){}function d(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function _(e,t,n){var i=t.dir,a=t.next,r=a||i,o=n&&"parentNode"===r,s=j++;return t.first?function(t,n,a){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,a);return!1}:function(t,n,l){var c,u,d,_=[B,s];if(l){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||o)if(d=t[q]||(t[q]={}),u=d[t.uniqueID]||(d[t.uniqueID]={}),a&&a===t.nodeName.toLowerCase())t=t[i]||t;else{if((c=u[r])&&c[0]===B&&c[1]===s)return _[2]=c[2];if(u[r]=_,_[2]=e(t,n,l))return!0}return!1}}function h(e){return e.length>1?function(t,n,i){for(var a=e.length;a--;)if(!e[a](t,n,i))return!1;return!0}:e[0]}function f(e,n,i){for(var a=0,r=n.length;a<r;a++)t(e,n[a],i);return i}function p(e,t,n,i,a){for(var r,o=[],s=0,l=e.length,c=null!=t;s<l;s++)(r=e[s])&&(n&&!n(r,i,a)||(o.push(r),c&&t.push(s)));return o}function m(e,t,n,a,r,o){return a&&!a[q]&&(a=m(a)),r&&!r[q]&&(r=m(r,o)),i(function(i,o,s,l){var c,u,d,_=[],h=[],m=o.length,v=i||f(t||"*",s.nodeType?[s]:s,[]),g=!e||!i&&t?v:p(v,_,e,s,l),y=n?r||(i?e:m||a)?[]:o:g;if(n&&n(g,y,s,l),a)for(c=p(y,h),a(c,[],s,l),u=c.length;u--;)(d=c[u])&&(y[h[u]]=!(g[h[u]]=d));if(i){if(r||e){if(r){for(c=[],u=y.length;u--;)(d=y[u])&&c.push(g[u]=d);r(null,y=[],c,l)}for(u=y.length;u--;)(d=y[u])&&(c=r?$(i,d):_[u])>-1&&(i[c]=!(o[c]=d))}}else y=p(y===o?y.splice(m,y.length):y),r?r(null,o,y,l):J.apply(o,y)})}function v(e){for(var t,n,i,a=e.length,r=E.relative[e[0].type],o=r||E.relative[" "],s=r?1:0,l=_(function(e){return e===t},o,!0),c=_(function(e){return $(t,e)>-1},o,!0),u=[function(e,n,i){var a=!r&&(i||n!==A)||((t=n).nodeType?l(e,n,i):c(e,n,i));return t=null,a}];s<a;s++)if(n=E.relative[e[s].type])u=[_(h(u),n)];else{if(n=E.filter[e[s].type].apply(null,e[s].matches),n[q]){for(i=++s;i<a&&!E.relative[e[i].type];i++);return m(s>1&&h(u),s>1&&d(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(re,"$1"),n,s<i&&v(e.slice(s,i)),i<a&&v(e=e.slice(i)),i<a&&d(e))}u.push(n)}return h(u)}function g(e,n){var a=n.length>0,r=e.length>0,o=function(i,o,s,l,c){var u,d,_,h=0,f="0",m=i&&[],v=[],g=A,y=i||r&&E.find.TAG("*",c),S=B+=null==g?1:Math.random()||.1,b=y.length;for(c&&(A=o===O||o||c);f!==b&&null!=(u=y[f]);f++){if(r&&u){for(d=0,o||u.ownerDocument===O||(R(u),s=!k);_=e[d++];)if(_(u,o||O,s)){l.push(u);break}c&&(B=S)}a&&((u=!_&&u)&&h--,i&&m.push(u))}if(h+=f,a&&f!==h){for(d=0;_=n[d++];)_(m,v,o,s);if(i){if(h>0)for(;f--;)m[f]||v[f]||(v[f]=X.call(l));v=p(v)}J.apply(l,v),c&&!i&&v.length>0&&h+n.length>1&&t.uniqueSort(l)}return c&&(B=S,A=g),m};return a?i(o):o}var y,S,E,b,T,M,I,C,A,D,x,R,O,L,k,N,w,F,P,q="sizzle"+1*new Date,V=e.document,B=0,j=0,H=n(),z=n(),U=n(),Y=function(e,t){return e===t&&(x=!0),0},W={}.hasOwnProperty,G=[],X=G.pop,Q=G.push,J=G.push,K=G.slice,$=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},Z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ne="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",ie=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ne+")*)|.*)\\)|)",ae=new RegExp(ee+"+","g"),re=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),oe=new RegExp("^"+ee+"*,"+ee+"*"),se=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),le=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),ce=new RegExp(ie),ue=new RegExp("^"+te+"$"),de={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+ie),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+Z+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},_e=/^(?:input|select|textarea|button)$/i,he=/^h\d$/i,fe=/^[^{]+\{\s*\[native \w/,pe=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,me=/[+~]/,ve=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),ge=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},ye=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Se=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Ee=function(){R()},be=_(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{J.apply(G=K.call(V.childNodes),V.childNodes),G[V.childNodes.length].nodeType}catch(e){J={apply:G.length?function(e,t){Q.apply(e,K.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}S=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},R=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:V;return i!==O&&9===i.nodeType&&i.documentElement?(O=i,L=O.documentElement,k=!T(O),V!==O&&(n=O.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Ee,!1):n.attachEvent&&n.attachEvent("onunload",Ee)),S.attributes=a(function(e){return e.className="i",!e.getAttribute("className")}),S.getElementsByTagName=a(function(e){return e.appendChild(O.createComment("")),!e.getElementsByTagName("*").length}),S.getElementsByClassName=fe.test(O.getElementsByClassName),S.getById=a(function(e){return L.appendChild(e).id=q,!O.getElementsByName||!O.getElementsByName(q).length}),S.getById?(E.filter.ID=function(e){var t=e.replace(ve,ge);return function(e){return e.getAttribute("id")===t}},E.find.ID=function(e,t){if(void 0!==t.getElementById&&k){var n=t.getElementById(e);return n?[n]:[]}}):(E.filter.ID=function(e){var t=e.replace(ve,ge);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},E.find.ID=function(e,t){if(void 0!==t.getElementById&&k){var n,i,a,r=t.getElementById(e);if(r){if((n=r.getAttributeNode("id"))&&n.value===e)return[r];for(a=t.getElementsByName(e),i=0;r=a[i++];)if((n=r.getAttributeNode("id"))&&n.value===e)return[r]}return[]}}),E.find.TAG=S.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):S.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],a=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[a++];)1===n.nodeType&&i.push(n);return i}return r},E.find.CLASS=S.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&k)return t.getElementsByClassName(e)},w=[],N=[],(S.qsa=fe.test(O.querySelectorAll))&&(a(function(e){L.appendChild(e).innerHTML="<a id='"+q+"'></a><select id='"+q+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+ee+"*(?:value|"+Z+")"),e.querySelectorAll("[id~="+q+"-]").length||N.push("~="),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+q+"+*").length||N.push(".#.+[+~]")}),a(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=O.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+ee+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&N.push(":enabled",":disabled"),L.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(S.matchesSelector=fe.test(F=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&a(function(e){S.disconnectedMatch=F.call(e,"*"),F.call(e,"[s!='']:x"),w.push("!=",ie)}),N=N.length&&new RegExp(N.join("|")),w=w.length&&new RegExp(w.join("|")),t=fe.test(L.compareDocumentPosition),P=t||fe.test(L.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Y=t?function(e,t){if(e===t)return x=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!S.sortDetached&&t.compareDocumentPosition(e)===n?e===O||e.ownerDocument===V&&P(V,e)?-1:t===O||t.ownerDocument===V&&P(V,t)?1:D?$(D,e)-$(D,t):0:4&n?-1:1)}:function(e,t){if(e===t)return x=!0,0;var n,i=0,a=e.parentNode,r=t.parentNode,s=[e],l=[t];if(!a||!r)return e===O?-1:t===O?1:a?-1:r?1:D?$(D,e)-$(D,t):0;if(a===r)return o(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;s[i]===l[i];)i++;return i?o(s[i],l[i]):s[i]===V?-1:l[i]===V?1:0},O):O},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==O&&R(e),n=n.replace(le,"='$1']"),S.matchesSelector&&k&&!U[n+" "]&&(!w||!w.test(n))&&(!N||!N.test(n)))try{var i=F.call(e,n);if(i||S.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return t(n,O,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==O&&R(e),P(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==O&&R(e);var n=E.attrHandle[t.toLowerCase()],i=n&&W.call(E.attrHandle,t.toLowerCase())?n(e,t,!k):void 0;return void 0!==i?i:S.attributes||!k?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.escape=function(e){return(e+"").replace(ye,Se)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,a=0;if(x=!S.detectDuplicates,D=!S.sortStable&&e.slice(0),e.sort(Y),x){for(;t=e[a++];)t===e[a]&&(i=n.push(a));for(;i--;)e.splice(n[i],1)}return D=null,e},b=t.getText=function(e){var t,n="",i=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=b(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[i++];)n+=b(t);return n},E=t.selectors={cacheLength:50,createPseudo:i,match:de,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ve,ge),e[3]=(e[3]||e[4]||e[5]||"").replace(ve,ge),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return de.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ce.test(n)&&(t=M(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ve,ge).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&H(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(a){var r=t.attr(a,e);return null==r?"!="===n:!n||(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(ae," ")+" ").indexOf(i)>-1:"|="===n&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,n,i,a){var r="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===a?function(e){return!!e.parentNode}:function(t,n,l){var c,u,d,_,h,f,p=r!==o?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),g=!l&&!s,y=!1;if(m){if(r){for(;p;){for(_=t;_=_[p];)if(s?_.nodeName.toLowerCase()===v:1===_.nodeType)return!1;f=p="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&g){for(_=m,d=_[q]||(_[q]={}),u=d[_.uniqueID]||(d[_.uniqueID]={}),c=u[e]||[],h=c[0]===B&&c[1],y=h&&c[2],_=h&&m.childNodes[h];_=++h&&_&&_[p]||(y=h=0)||f.pop();)if(1===_.nodeType&&++y&&_===t){u[e]=[B,h,y];break}}else if(g&&(_=t,d=_[q]||(_[q]={}),u=d[_.uniqueID]||(d[_.uniqueID]={}),c=u[e]||[],h=c[0]===B&&c[1],y=h),!1===y)for(;(_=++h&&_&&_[p]||(y=h=0)||f.pop())&&((s?_.nodeName.toLowerCase()!==v:1!==_.nodeType)||!++y||(g&&(d=_[q]||(_[q]={}),u=d[_.uniqueID]||(d[_.uniqueID]={}),u[e]=[B,y]),_!==t)););return(y-=a)===i||y%i==0&&y/i>=0}}},PSEUDO:function(e,n){var a,r=E.pseudos[e]||E.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[q]?r(n):r.length>1?(a=[e,e,"",n],E.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,a=r(e,n),o=a.length;o--;)i=$(e,a[o]),e[i]=!(t[i]=a[o])}):function(e){return r(e,0,a)}):r}},pseudos:{not:i(function(e){var t=[],n=[],a=I(e.replace(re,"$1"));return a[q]?i(function(e,t,n,i){for(var r,o=a(e,null,i,[]),s=e.length;s--;)(r=o[s])&&(e[s]=!(t[s]=r))}):function(e,i,r){return t[0]=e,a(t,null,r,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(ve,ge),function(t){return(t.textContent||t.innerText||b(t)).indexOf(e)>-1}}),lang:i(function(e){return ue.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ve,ge).toLowerCase(),function(t){var n;do{if(n=k?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:s(!1),disabled:s(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return he.test(e.nodeName)},input:function(e){return _e.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[n<0?n+t:n]}),even:l(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:l(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}},E.pseudos.nth=E.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[y]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(y);for(y in{submit:!0,reset:!0})E.pseudos[y]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(y);return u.prototype=E.filters=E.pseudos,E.setFilters=new u,M=t.tokenize=function(e,n){var i,a,r,o,s,l,c,u=z[e+" "];if(u)return n?0:u.slice(0);for(s=e,l=[],c=E.preFilter;s;){i&&!(a=oe.exec(s))||(a&&(s=s.slice(a[0].length)||s),l.push(r=[])),i=!1,(a=se.exec(s))&&(i=a.shift(),r.push({value:i,type:a[0].replace(re," ")}),s=s.slice(i.length));for(o in E.filter)!(a=de[o].exec(s))||c[o]&&!(a=c[o](a))||(i=a.shift(),r.push({value:i,type:o,matches:a}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):z(e,l).slice(0)},I=t.compile=function(e,t){var n,i=[],a=[],r=U[e+" "];if(!r){for(t||(t=M(e)),n=t.length;n--;)r=v(t[n]),r[q]?i.push(r):a.push(r);r=U(e,g(a,i)),r.selector=e}return r},C=t.select=function(e,t,n,i){var a,r,o,s,l,u="function"==typeof e&&e,_=!i&&M(e=u.selector||e);if(n=n||[],1===_.length){if(r=_[0]=_[0].slice(0),r.length>2&&"ID"===(o=r[0]).type&&9===t.nodeType&&k&&E.relative[r[1].type]){if(!(t=(E.find.ID(o.matches[0].replace(ve,ge),t)||[])[0]))return n;u&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(a=de.needsContext.test(e)?0:r.length;a--&&(o=r[a],!E.relative[s=o.type]);)if((l=E.find[s])&&(i=l(o.matches[0].replace(ve,ge),me.test(r[0].type)&&c(t.parentNode)||t))){if(r.splice(a,1),!(e=i.length&&d(r)))return J.apply(n,i),n;break}}return(u||I(e,_))(i,t,!k,n,!t||me.test(e)&&c(t.parentNode)||t),n},S.sortStable=q.split("").sort(Y).join("")===q,S.detectDuplicates=!!x,R(),S.sortDetached=a(function(e){return 1&e.compareDocumentPosition(O.createElement("fieldset"))}),a(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),S.attributes&&a(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),a(function(e){return null==e.getAttribute("disabled")})||r(Z,function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(n);ge.find=Te,ge.expr=Te.selectors,ge.expr[":"]=ge.expr.pseudos,ge.uniqueSort=ge.unique=Te.uniqueSort,ge.text=Te.getText,ge.isXMLDoc=Te.isXML,ge.contains=Te.contains,ge.escapeSelector=Te.escape;var Me=function(e,t,n){for(var i=[],a=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&ge(e).is(n))break;i.push(e)}return i},Ie=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},Ce=ge.expr.match.needsContext,Ae=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,De=/^.[^:#\[\.,]*$/;ge.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?ge.find.matchesSelector(i,e)?[i]:[]:ge.find.matches(e,ge.grep(t,function(e){return 1===e.nodeType}))},ge.fn.extend({find:function(e){var t,n,i=this.length,a=this;if("string"!=typeof e)return this.pushStack(ge(e).filter(function(){for(t=0;t<i;t++)if(ge.contains(a[t],this))return!0}));for(n=this.pushStack([]),t=0;t<i;t++)ge.find(e,a[t],n);return i>1?ge.uniqueSort(n):n},filter:function(e){return this.pushStack(c(this,e||[],!1))},not:function(e){return this.pushStack(c(this,e||[],!0))},is:function(e){return!!c(this,"string"==typeof e&&Ce.test(e)?ge(e):e||[],!1).length}});var xe,Re=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ge.fn.init=function(e,t,n){var i,a;if(!e)return this;if(n=n||xe,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:Re.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof ge?t[0]:t,ge.merge(this,ge.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:oe,!0)),Ae.test(i[1])&&ge.isPlainObject(t))for(i in t)ge.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return a=oe.getElementById(i[2]),a&&(this[0]=a,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):ge.isFunction(e)?void 0!==n.ready?n.ready(e):e(ge):ge.makeArray(e,this)}).prototype=ge.fn,xe=ge(oe);var Oe=/^(?:parents|prev(?:Until|All))/,Le={children:!0,contents:!0,next:!0,prev:!0};ge.fn.extend({has:function(e){var t=ge(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(ge.contains(this,t[e]))return!0})},closest:function(e,t){var n,i=0,a=this.length,r=[],o="string"!=typeof e&&ge(e);if(!Ce.test(e))for(;i<a;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&ge.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(r.length>1?ge.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?de.call(ge(e),this[0]):de.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ge.uniqueSort(ge.merge(this.get(),ge(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ge.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Me(e,"parentNode")},parentsUntil:function(e,t,n){return Me(e,"parentNode",n)},next:function(e){return u(e,"nextSibling")},prev:function(e){return u(e,"previousSibling")},nextAll:function(e){return Me(e,"nextSibling")},prevAll:function(e){return Me(e,"previousSibling")},nextUntil:function(e,t,n){return Me(e,"nextSibling",n)},prevUntil:function(e,t,n){return Me(e,"previousSibling",n)},siblings:function(e){return Ie((e.parentNode||{}).firstChild,e)},children:function(e){return Ie(e.firstChild)},contents:function(e){return l(e,"iframe")?e.contentDocument:(l(e,"template")&&(e=e.content||e),ge.merge([],e.childNodes))}},function(e,t){ge.fn[e]=function(n,i){var a=ge.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(a=ge.filter(i,a)),this.length>1&&(Le[e]||ge.uniqueSort(a),Oe.test(e)&&a.reverse()),this.pushStack(a)}});var ke=/[^\x20\t\r\n\f]+/g;ge.Callbacks=function(e){e="string"==typeof e?d(e):ge.extend({},e);var t,n,i,a,r=[],o=[],s=-1,l=function(){for(a=a||e.once,i=t=!0;o.length;s=-1)for(n=o.shift();++s<r.length;)!1===r[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=r.length,n=!1);e.memory||(n=!1),t=!1,a&&(r=n?[]:"")},c={add:function(){return r&&(n&&!t&&(s=r.length-1,o.push(n)),function t(n){ge.each(n,function(n,i){ge.isFunction(i)?e.unique&&c.has(i)||r.push(i):i&&i.length&&"string"!==ge.type(i)&&t(i)})}(arguments),n&&!t&&l()),this},remove:function(){return ge.each(arguments,function(e,t){for(var n;(n=ge.inArray(t,r,n))>-1;)r.splice(n,1),n<=s&&s--}),this},has:function(e){return e?ge.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return a=o=[],r=n="",this},disabled:function(){return!r},lock:function(){return a=o=[],n||t||(r=n=""),this},locked:function(){return!!a},fireWith:function(e,n){return a||(n=n||[],n=[e,n.slice?n.slice():n],o.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},ge.extend({Deferred:function(e){var t=[["notify","progress",ge.Callbacks("memory"),ge.Callbacks("memory"),2],["resolve","done",ge.Callbacks("once memory"),ge.Callbacks("once memory"),0,"resolved"],["reject","fail",ge.Callbacks("once memory"),ge.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var e=arguments;return ge.Deferred(function(n){ge.each(t,function(t,i){var a=ge.isFunction(e[i[4]])&&e[i[4]];r[i[1]](function(){var e=a&&a.apply(this,arguments);e&&ge.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,a?[e]:arguments)})}),e=null}).promise()},then:function(e,i,a){function r(e,t,i,a){return function(){var s=this,l=arguments,c=function(){var n,c;if(!(e<o)){if((n=i.apply(s,l))===t.promise())throw new TypeError("Thenable self-resolution");c=n&&("object"==typeof n||"function"==typeof n)&&n.then,ge.isFunction(c)?a?c.call(n,r(o,t,_,a),r(o,t,h,a)):(o++,c.call(n,r(o,t,_,a),r(o,t,h,a),r(o,t,_,t.notifyWith))):(i!==_&&(s=void 0,l=[n]),(a||t.resolveWith)(s,l))}},u=a?c:function(){try{c()}catch(n){ge.Deferred.exceptionHook&&ge.Deferred.exceptionHook(n,u.stackTrace),e+1>=o&&(i!==h&&(s=void 0,l=[n]),t.rejectWith(s,l))}};e?u():(ge.Deferred.getStackHook&&(u.stackTrace=ge.Deferred.getStackHook()),n.setTimeout(u))}}var o=0;return ge.Deferred(function(n){t[0][3].add(r(0,n,ge.isFunction(a)?a:_,n.notifyWith)),t[1][3].add(r(0,n,ge.isFunction(e)?e:_)),t[2][3].add(r(0,n,ge.isFunction(i)?i:h))}).promise()},promise:function(e){return null!=e?ge.extend(e,a):a}},r={};return ge.each(t,function(e,n){var o=n[2],s=n[5];a[n[1]]=o.add,s&&o.add(function(){i=s},t[3-e][2].disable,t[0][2].lock),o.add(n[3].fire),r[n[0]]=function(){return r[n[0]+"With"](this===r?void 0:this,arguments),this},r[n[0]+"With"]=o.fireWith}),a.promise(r),e&&e.call(r,r),r},when:function(e){var t=arguments.length,n=t,i=Array(n),a=le.call(arguments),r=ge.Deferred(),o=function(e){return function(n){i[e]=this,a[e]=arguments.length>1?le.call(arguments):n,--t||r.resolveWith(i,a)}};if(t<=1&&(f(e,r.done(o(n)).resolve,r.reject,!t),"pending"===r.state()||ge.isFunction(a[n]&&a[n].then)))return r.then();for(;n--;)f(a[n],o(n),r.reject);return r.promise()}});var Ne=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ge.Deferred.exceptionHook=function(e,t){n.console&&n.console.warn&&e&&Ne.test(e.name)&&n.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ge.readyException=function(e){n.setTimeout(function(){throw e})};var we=ge.Deferred();ge.fn.ready=function(e){return we.then(e).catch(function(e){ge.readyException(e)}),this},ge.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ge.readyWait:ge.isReady)||(ge.isReady=!0,!0!==e&&--ge.readyWait>0||we.resolveWith(oe,[ge]))}}),ge.ready.then=we.then,"complete"===oe.readyState||"loading"!==oe.readyState&&!oe.documentElement.doScroll?n.setTimeout(ge.ready):(oe.addEventListener("DOMContentLoaded",p),n.addEventListener("load",p));var Fe=function(e,t,n,i,a,r,o){var s=0,l=e.length,c=null==n;if("object"===ge.type(n)){a=!0;for(s in n)Fe(e,t,s,n[s],!0,r,o)}else if(void 0!==i&&(a=!0,ge.isFunction(i)||(o=!0),c&&(o?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(ge(e),n)})),t))for(;s<l;s++)t(e[s],n,o?i:i.call(e[s],s,t(e[s],n)));return a?e:c?t.call(e):l?t(e[0],n):r},Pe=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};m.uid=1,m.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Pe(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,a=this.cache(e);if("string"==typeof t)a[ge.camelCase(t)]=n;else for(i in t)a[ge.camelCase(i)]=t[i];return a},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ge.camelCase(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){Array.isArray(t)?t=t.map(ge.camelCase):(t=ge.camelCase(t),t=t in i?[t]:t.match(ke)||[]),n=t.length;for(;n--;)delete i[t[n]]}(void 0===t||ge.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ge.isEmptyObject(t)}};var qe=new m,Ve=new m,Be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,je=/[A-Z]/g;ge.extend({hasData:function(e){return Ve.hasData(e)||qe.hasData(e)},data:function(e,t,n){return Ve.access(e,t,n)},removeData:function(e,t){Ve.remove(e,t)},_data:function(e,t,n){return qe.access(e,t,n)},_removeData:function(e,t){qe.remove(e,t)}}),ge.fn.extend({data:function(e,t){var n,i,a,r=this[0],o=r&&r.attributes;if(void 0===e){if(this.length&&(a=Ve.get(r),1===r.nodeType&&!qe.get(r,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&(i=o[n].name,0===i.indexOf("data-")&&(i=ge.camelCase(i.slice(5)),g(r,i,a[i])));qe.set(r,"hasDataAttrs",!0)}return a}return"object"==typeof e?this.each(function(){Ve.set(this,e)}):Fe(this,function(t){var n;if(r&&void 0===t){if(void 0!==(n=Ve.get(r,e)))return n;if(void 0!==(n=g(r,e)))return n}else this.each(function(){Ve.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Ve.remove(this,e)})}}),ge.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=qe.get(e,t),n&&(!i||Array.isArray(n)?i=qe.access(e,t,ge.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=ge.queue(e,t),i=n.length,a=n.shift(),r=ge._queueHooks(e,t),o=function(){ge.dequeue(e,t)};"inprogress"===a&&(a=n.shift(),i--),a&&("fx"===t&&n.unshift("inprogress"),delete r.stop,a.call(e,o,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return qe.get(e,n)||qe.access(e,n,{empty:ge.Callbacks("once memory").add(function(){qe.remove(e,[t+"queue",n])})})}}),ge.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?ge.queue(this[0],e):void 0===t?this:this.each(function(){var n=ge.queue(this,e,t);ge._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&ge.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ge.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,a=ge.Deferred(),r=this,o=this.length,s=function(){--i||a.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=qe.get(r[o],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),a.promise(t)}});var He=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ze=new RegExp("^(?:([+-])=|)("+He+")([a-z%]*)$","i"),Ue=["Top","Right","Bottom","Left"],Ye=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&ge.contains(e.ownerDocument,e)&&"none"===ge.css(e,"display")},We=function(e,t,n,i){var a,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];a=n.apply(e,i||[]);for(r in t)e.style[r]=o[r];return a},Ge={};ge.fn.extend({show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ye(this)?ge(this).show():ge(this).hide()})}});var Xe=/^(?:checkbox|radio)$/i,Qe=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Je=/^$|\/(?:java|ecma)script/i,Ke={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ke.optgroup=Ke.option,Ke.tbody=Ke.tfoot=Ke.colgroup=Ke.caption=Ke.thead,Ke.th=Ke.td;var $e=/<|&#?\w+;/;!function(){var e=oe.createDocumentFragment(),t=e.appendChild(oe.createElement("div")),n=oe.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),ve.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",ve.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Ze=oe.documentElement,et=/^key/,tt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,nt=/^([^.]*)(?:\.(.+)|)/;ge.event={global:{},add:function(e,t,n,i,a){var r,o,s,l,c,u,d,_,h,f,p,m=qe.get(e);if(m)for(n.handler&&(r=n,n=r.handler,a=r.selector),a&&ge.find.matchesSelector(Ze,a),n.guid||(n.guid=ge.guid++),(l=m.events)||(l=m.events={}),(o=m.handle)||(o=m.handle=function(t){return void 0!==ge&&ge.event.triggered!==t.type?ge.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(ke)||[""],c=t.length;c--;)s=nt.exec(t[c])||[],h=p=s[1],f=(s[2]||"").split(".").sort(),h&&(d=ge.event.special[h]||{},h=(a?d.delegateType:d.bindType)||h,d=ge.event.special[h]||{},u=ge.extend({type:h,origType:p,data:i,handler:n,guid:n.guid,selector:a,needsContext:a&&ge.expr.match.needsContext.test(a),namespace:f.join(".")},r),(_=l[h])||(_=l[h]=[],_.delegateCount=0,d.setup&&!1!==d.setup.call(e,i,f,o)||e.addEventListener&&e.addEventListener(h,o)),d.add&&(d.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),a?_.splice(_.delegateCount++,0,u):_.push(u),ge.event.global[h]=!0)},remove:function(e,t,n,i,a){var r,o,s,l,c,u,d,_,h,f,p,m=qe.hasData(e)&&qe.get(e);if(m&&(l=m.events)){for(t=(t||"").match(ke)||[""],c=t.length;c--;)if(s=nt.exec(t[c])||[],h=p=s[1],f=(s[2]||"").split(".").sort(),h){for(d=ge.event.special[h]||{},h=(i?d.delegateType:d.bindType)||h,_=l[h]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=_.length;r--;)u=_[r],!a&&p!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(_.splice(r,1),u.selector&&_.delegateCount--,d.remove&&d.remove.call(e,u));o&&!_.length&&(d.teardown&&!1!==d.teardown.call(e,f,m.handle)||ge.removeEvent(e,h,m.handle),delete l[h])}else for(h in l)ge.event.remove(e,h+t[c],n,i,!0);ge.isEmptyObject(l)&&qe.remove(e,"handle events")}},dispatch:function(e){var t,n,i,a,r,o,s=ge.event.fix(e),l=new Array(arguments.length),c=(qe.get(this,"events")||{})[s.type]||[],u=ge.event.special[s.type]||{};for(l[0]=s,t=1;t<arguments.length;t++)l[t]=arguments[t];if(s.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,s)){for(o=ge.event.handlers.call(this,s,c),t=0;(a=o[t++])&&!s.isPropagationStopped();)for(s.currentTarget=a.elem,n=0;(r=a.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(r.namespace)||(s.handleObj=r,s.data=r.data,void 0!==(i=((ge.event.special[r.origType]||{}).handle||r.handler).apply(a.elem,l))&&!1===(s.result=i)&&(s.preventDefault(),s.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,i,a,r,o,s=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(r=[],o={},n=0;n<l;n++)i=t[n],a=i.selector+" ",void 0===o[a]&&(o[a]=i.needsContext?ge(a,this).index(c)>-1:ge.find(a,this,null,[c]).length),o[a]&&r.push(i);r.length&&s.push({elem:c,handlers:r})}return c=this,l<t.length&&s.push({elem:c,handlers:t.slice(l)}),s},addProp:function(e,t){Object.defineProperty(ge.Event.prototype,e,{enumerable:!0,configurable:!0,get:ge.isFunction(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[ge.expando]?e:new ge.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==A()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===A()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&l(this,"input"))return this.click(),!1},_default:function(e){return l(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ge.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},ge.Event=function(e,t){if(!(this instanceof ge.Event))return new ge.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?I:C,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ge.extend(this,t),this.timeStamp=e&&e.timeStamp||ge.now(),this[ge.expando]=!0},ge.Event.prototype={constructor:ge.Event,isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=I,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=I,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=I,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ge.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&et.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&tt.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},ge.event.addProp),ge.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){ge.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,a=e.relatedTarget,r=e.handleObj;return a&&(a===i||ge.contains(i,a))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),ge.fn.extend({on:function(e,t,n,i){return D(this,e,t,n,i)},one:function(e,t,n,i){return D(this,e,t,n,i,1)},off:function(e,t,n){var i,a;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,ge(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(a in e)this.off(a,t,e[a]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=C),this.each(function(){ge.event.remove(this,e,n,t)})}});var it=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,at=/<script|<style|<link/i,rt=/checked\s*(?:[^=]|=\s*.checked.)/i,ot=/^true\/(.*)/,st=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;ge.extend({htmlPrefilter:function(e){return e.replace(it,"<$1></$2>")},clone:function(e,t,n){var i,a,r,o,s=e.cloneNode(!0),l=ge.contains(e.ownerDocument,e);if(!(ve.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ge.isXMLDoc(e)))for(o=b(s),r=b(e),i=0,a=r.length;i<a;i++)k(r[i],o[i]);if(t)if(n)for(r=r||b(e),o=o||b(s),i=0,a=r.length;i<a;i++)L(r[i],o[i]);else L(e,s);return o=b(s,"script"),o.length>0&&T(o,!l&&b(e,"script")),s},cleanData:function(e){for(var t,n,i,a=ge.event.special,r=0;void 0!==(n=e[r]);r++)if(Pe(n)){if(t=n[qe.expando]){if(t.events)for(i in t.events)a[i]?ge.event.remove(n,i):ge.removeEvent(n,i,t.handle);n[qe.expando]=void 0}n[Ve.expando]&&(n[Ve.expando]=void 0)}}}),ge.fn.extend({detach:function(e){return w(this,e,!0)},remove:function(e){return w(this,e)},text:function(e){return Fe(this,function(e){return void 0===e?ge.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return N(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){x(this,e).appendChild(e)}})},prepend:function(){return N(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=x(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return N(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return N(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ge.cleanData(b(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ge.clone(this,e,t)})},html:function(e){return Fe(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!at.test(e)&&!Ke[(Qe.exec(e)||["",""])[1].toLowerCase()]){e=ge.htmlPrefilter(e);try{for(;n<i;n++)t=this[n]||{},1===t.nodeType&&(ge.cleanData(b(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return N(this,arguments,function(t){var n=this.parentNode;ge.inArray(this,e)<0&&(ge.cleanData(b(this)),n&&n.replaceChild(t,this))},e)}}),ge.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ge.fn[e]=function(e){for(var n,i=[],a=ge(e),r=a.length-1,o=0;o<=r;o++)n=o===r?this:this.clone(!0),ge(a[o])[t](n),ue.apply(i,n.get());return this.pushStack(i)}});var lt=/^margin/,ct=new RegExp("^("+He+")(?!px)[a-z%]+$","i"),ut=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=n),t.getComputedStyle(e)};!function(){function e(){if(s){s.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Ze.appendChild(o);var e=n.getComputedStyle(s);t="1%"!==e.top,r="2px"===e.marginLeft,i="4px"===e.width,s.style.marginRight="50%",a="4px"===e.marginRight,Ze.removeChild(o),s=null}}var t,i,a,r,o=oe.createElement("div"),s=oe.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",ve.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",o.appendChild(s),ge.extend(ve,{pixelPosition:function(){return e(),t},boxSizingReliable:function(){return e(),i},pixelMarginRight:function(){return e(),a},reliableMarginLeft:function(){return e(),r}}))}();var dt=/^(none|table(?!-c[ea]).+)/,_t=/^--/,ht={position:"absolute",visibility:"hidden",display:"block"},ft={letterSpacing:"0",fontWeight:"400"},pt=["Webkit","Moz","ms"],mt=oe.createElement("div").style;ge.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=F(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,r,o,s=ge.camelCase(t),l=_t.test(t),c=e.style;if(l||(t=V(s)),o=ge.cssHooks[t]||ge.cssHooks[s],void 0===n)return o&&"get"in o&&void 0!==(a=o.get(e,!1,i))?a:c[t];r=typeof n,"string"===r&&(a=ze.exec(n))&&a[1]&&(n=y(e,t,a),r="number"),null!=n&&n===n&&("number"===r&&(n+=a&&a[3]||(ge.cssNumber[s]?"":"px")),ve.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,i))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,i){var a,r,o,s=ge.camelCase(t);return _t.test(t)||(t=V(s)),o=ge.cssHooks[t]||ge.cssHooks[s],o&&"get"in o&&(a=o.get(e,!0,n)),void 0===a&&(a=F(e,t,i)),"normal"===a&&t in ft&&(a=ft[t]),""===n||n?(r=parseFloat(a),!0===n||isFinite(r)?r||0:a):a}}),ge.each(["height","width"],function(e,t){ge.cssHooks[t]={get:function(e,n,i){if(n)return!dt.test(ge.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?H(e,t,i):We(e,ht,function(){return H(e,t,i)})},set:function(e,n,i){var a,r=i&&ut(e),o=i&&j(e,t,i,"border-box"===ge.css(e,"boxSizing",!1,r),r);return o&&(a=ze.exec(n))&&"px"!==(a[3]||"px")&&(e.style[t]=n,n=ge.css(e,t)),B(e,n,o)}}}),ge.cssHooks.marginLeft=P(ve.reliableMarginLeft,function(e,t){if(t)return(parseFloat(F(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ge.each({margin:"",padding:"",border:"Width"},function(e,t){ge.cssHooks[e+t]={expand:function(n){for(var i=0,a={},r="string"==typeof n?n.split(" "):[n];i<4;i++)a[e+Ue[i]+t]=r[i]||r[i-2]||r[0];return a}},lt.test(e)||(ge.cssHooks[e+t].set=B)}),ge.fn.extend({css:function(e,t){return Fe(this,function(e,t,n){var i,a,r={},o=0;if(Array.isArray(t)){for(i=ut(e),a=t.length;o<a;o++)r[t[o]]=ge.css(e,t[o],!1,i);return r}return void 0!==n?ge.style(e,t,n):ge.css(e,t)},e,t,arguments.length>1)}}),ge.Tween=z,z.prototype={constructor:z,init:function(e,t,n,i,a,r){this.elem=e,this.prop=n,this.easing=a||ge.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(ge.cssNumber[n]?"":"px")},cur:function(){var e=z.propHooks[this.prop];return e&&e.get?e.get(this):z.propHooks._default.get(this)},run:function(e){var t,n=z.propHooks[this.prop];return this.options.duration?this.pos=t=ge.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):z.propHooks._default.set(this),this}},z.prototype.init.prototype=z.prototype,z.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ge.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){ge.fx.step[e.prop]?ge.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[ge.cssProps[e.prop]]&&!ge.cssHooks[e.prop]?e.elem[e.prop]=e.now:ge.style(e.elem,e.prop,e.now+e.unit)}}},z.propHooks.scrollTop=z.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ge.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ge.fx=z.prototype.init,ge.fx.step={};var vt,gt,yt=/^(?:toggle|show|hide)$/,St=/queueHooks$/;ge.Animation=ge.extend(J,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return y(n.elem,e,ze.exec(t),n),n}]},tweener:function(e,t){ge.isFunction(e)?(t=e,e=["*"]):e=e.match(ke);for(var n,i=0,a=e.length;i<a;i++)n=e[i],J.tweeners[n]=J.tweeners[n]||[],J.tweeners[n].unshift(t)},prefilters:[X],prefilter:function(e,t){t?J.prefilters.unshift(e):J.prefilters.push(e)}}),ge.speed=function(e,t,n){var i=e&&"object"==typeof e?ge.extend({},e):{complete:n||!n&&t||ge.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ge.isFunction(t)&&t};return ge.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in ge.fx.speeds?i.duration=ge.fx.speeds[i.duration]:i.duration=ge.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){ge.isFunction(i.old)&&i.old.call(this),i.queue&&ge.dequeue(this,i.queue)},i},ge.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ye).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var a=ge.isEmptyObject(e),r=ge.speed(t,n,i),o=function(){var t=J(this,ge.extend({},e),r);(a||qe.get(this,"finish"))&&t.stop(!0)};return o.finish=o,a||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,a=null!=e&&e+"queueHooks",r=ge.timers,o=qe.get(this);if(a)o[a]&&o[a].stop&&i(o[a]);else for(a in o)o[a]&&o[a].stop&&St.test(a)&&i(o[a]);for(a=r.length;a--;)r[a].elem!==this||null!=e&&r[a].queue!==e||(r[a].anim.stop(n),t=!1,r.splice(a,1));!t&&n||ge.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=qe.get(this),i=n[e+"queue"],a=n[e+"queueHooks"],r=ge.timers,o=i?i.length:0;for(n.finish=!0,ge.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),ge.each(["toggle","show","hide"],function(e,t){var n=ge.fn[t];ge.fn[t]=function(e,i,a){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(W(t,!0),e,i,a)}}),ge.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ge.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),ge.timers=[],ge.fx.tick=function(){var e,t=0,n=ge.timers;for(vt=ge.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||ge.fx.stop(),vt=void 0},ge.fx.timer=function(e){ge.timers.push(e),ge.fx.start()},ge.fx.interval=13,ge.fx.start=function(){gt||(gt=!0,U())},ge.fx.stop=function(){gt=null},ge.fx.speeds={slow:600,fast:200,_default:400},ge.fn.delay=function(e,t){return e=ge.fx?ge.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var a=n.setTimeout(t,e);i.stop=function(){n.clearTimeout(a)}})},function(){var e=oe.createElement("input"),t=oe.createElement("select"),n=t.appendChild(oe.createElement("option"));e.type="checkbox",ve.checkOn=""!==e.value,ve.optSelected=n.selected,e=oe.createElement("input"),e.value="t",e.type="radio",ve.radioValue="t"===e.value}();var Et,bt=ge.expr.attrHandle;ge.fn.extend({attr:function(e,t){return Fe(this,ge.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ge.removeAttr(this,e)})}}),ge.extend({attr:function(e,t,n){var i,a,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?ge.prop(e,t,n):(1===r&&ge.isXMLDoc(e)||(a=ge.attrHooks[t.toLowerCase()]||(ge.expr.match.bool.test(t)?Et:void 0)),void 0!==n?null===n?void ge.removeAttr(e,t):a&&"set"in a&&void 0!==(i=a.set(e,n,t))?i:(e.setAttribute(t,n+""),n):a&&"get"in a&&null!==(i=a.get(e,t))?i:(i=ge.find.attr(e,t),null==i?void 0:i))},attrHooks:{type:{set:function(e,t){if(!ve.radioValue&&"radio"===t&&l(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,a=t&&t.match(ke);if(a&&1===e.nodeType)for(;n=a[i++];)e.removeAttribute(n)}}),Et={set:function(e,t,n){return!1===t?ge.removeAttr(e,n):e.setAttribute(n,n),n}},ge.each(ge.expr.match.bool.source.match(/\w+/g),function(e,t){var n=bt[t]||ge.find.attr;bt[t]=function(e,t,i){var a,r,o=t.toLowerCase();return i||(r=bt[o],bt[o]=a,a=null!=n(e,t,i)?o:null,bt[o]=r),a}});var Tt=/^(?:input|select|textarea|button)$/i,Mt=/^(?:a|area)$/i;ge.fn.extend({prop:function(e,t){return Fe(this,ge.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ge.propFix[e]||e]})}}),ge.extend({prop:function(e,t,n){var i,a,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&ge.isXMLDoc(e)||(t=ge.propFix[t]||t,a=ge.propHooks[t]),void 0!==n?a&&"set"in a&&void 0!==(i=a.set(e,n,t))?i:e[t]=n:a&&"get"in a&&null!==(i=a.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=ge.find.attr(e,"tabindex");return t?parseInt(t,10):Tt.test(e.nodeName)||Mt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),ve.optSelected||(ge.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ge.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ge.propFix[this.toLowerCase()]=this}),ge.fn.extend({addClass:function(e){var t,n,i,a,r,o,s,l=0;if(ge.isFunction(e))return this.each(function(t){ge(this).addClass(e.call(this,t,$(this)))});if("string"==typeof e&&e)for(t=e.match(ke)||[];n=this[l++];)if(a=$(n),i=1===n.nodeType&&" "+K(a)+" "){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");s=K(i),a!==s&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,i,a,r,o,s,l=0;if(ge.isFunction(e))return this.each(function(t){ge(this).removeClass(e.call(this,t,$(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(ke)||[];n=this[l++];)if(a=$(n),i=1===n.nodeType&&" "+K(a)+" "){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>-1;)i=i.replace(" "+r+" "," ");s=K(i),a!==s&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):ge.isFunction(e)?this.each(function(n){ge(this).toggleClass(e.call(this,n,$(this),t),t)}):this.each(function(){var t,i,a,r;if("string"===n)for(i=0,a=ge(this),r=e.match(ke)||[];t=r[i++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else void 0!==e&&"boolean"!==n||(t=$(this),t&&qe.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":qe.get(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+K($(n))+" ").indexOf(t)>-1)return!0;return!1}});var It=/\r/g;ge.fn.extend({val:function(e){var t,n,i,a=this[0];{if(arguments.length)return i=ge.isFunction(e),this.each(function(n){var a;1===this.nodeType&&(a=i?e.call(this,n,ge(this).val()):e,null==a?a="":"number"==typeof a?a+="":Array.isArray(a)&&(a=ge.map(a,function(e){return null==e?"":e+""})),(t=ge.valHooks[this.type]||ge.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))});if(a)return(t=ge.valHooks[a.type]||ge.valHooks[a.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(a,"value"))?n:(n=a.value,"string"==typeof n?n.replace(It,""):null==n?"":n)}}}),ge.extend({valHooks:{option:{get:function(e){var t=ge.find.attr(e,"value");return null!=t?t:K(ge.text(e))}},select:{get:function(e){var t,n,i,a=e.options,r=e.selectedIndex,o="select-one"===e.type,s=o?null:[],c=o?r+1:a.length;for(i=r<0?c:o?r:0;i<c;i++)if(n=a[i],(n.selected||i===r)&&!n.disabled&&(!n.parentNode.disabled||!l(n.parentNode,"optgroup"))){if(t=ge(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,i,a=e.options,r=ge.makeArray(t),o=a.length;o--;)i=a[o],(i.selected=ge.inArray(ge.valHooks.option.get(i),r)>-1)&&(n=!0);return n||(e.selectedIndex=-1),r}}}}),ge.each(["radio","checkbox"],function(){ge.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=ge.inArray(ge(e).val(),t)>-1}},ve.checkOn||(ge.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Ct=/^(?:focusinfocus|focusoutblur)$/;ge.extend(ge.event,{trigger:function(e,t,i,a){var r,o,s,l,c,u,d,_=[i||oe],h=fe.call(e,"type")?e.type:e,f=fe.call(e,"namespace")?e.namespace.split("."):[];if(o=s=i=i||oe,3!==i.nodeType&&8!==i.nodeType&&!Ct.test(h+ge.event.triggered)&&(h.indexOf(".")>-1&&(f=h.split("."),h=f.shift(),f.sort()),c=h.indexOf(":")<0&&"on"+h,e=e[ge.expando]?e:new ge.Event(h,"object"==typeof e&&e),e.isTrigger=a?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:ge.makeArray(t,[e]),d=ge.event.special[h]||{},a||!d.trigger||!1!==d.trigger.apply(i,t))){if(!a&&!d.noBubble&&!ge.isWindow(i)){for(l=d.delegateType||h,Ct.test(l+h)||(o=o.parentNode);o;o=o.parentNode)_.push(o),s=o;s===(i.ownerDocument||oe)&&_.push(s.defaultView||s.parentWindow||n)}for(r=0;(o=_[r++])&&!e.isPropagationStopped();)e.type=r>1?l:d.bindType||h,u=(qe.get(o,"events")||{})[e.type]&&qe.get(o,"handle"),u&&u.apply(o,t),(u=c&&o[c])&&u.apply&&Pe(o)&&(e.result=u.apply(o,t),!1===e.result&&e.preventDefault());return e.type=h,a||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(_.pop(),t)||!Pe(i)||c&&ge.isFunction(i[h])&&!ge.isWindow(i)&&(s=i[c],s&&(i[c]=null),ge.event.triggered=h,i[h](),ge.event.triggered=void 0,s&&(i[c]=s)),e.result}},simulate:function(e,t,n){var i=ge.extend(new ge.Event,n,{type:e,isSimulated:!0});ge.event.trigger(i,null,t)}}),ge.fn.extend({trigger:function(e,t){return this.each(function(){ge.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ge.event.trigger(e,t,n,!0)}}),ge.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){ge.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),ge.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ve.focusin="onfocusin"in n,ve.focusin||ge.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){ge.event.simulate(t,e.target,ge.event.fix(e))};ge.event.special[t]={setup:function(){var i=this.ownerDocument||this,a=qe.access(i,t);a||i.addEventListener(e,n,!0),qe.access(i,t,(a||0)+1)},teardown:function(){var i=this.ownerDocument||this,a=qe.access(i,t)-1;a?qe.access(i,t,a):(i.removeEventListener(e,n,!0),qe.remove(i,t))}}});var At=n.location,Dt=ge.now(),xt=/\?/;ge.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new n.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||ge.error("Invalid XML: "+e),t};var Rt=/\[\]$/,Ot=/\r?\n/g,Lt=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;ge.param=function(e,t){var n,i=[],a=function(e,t){var n=ge.isFunction(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!ge.isPlainObject(e))ge.each(e,function(){a(this.name,this.value)});else for(n in e)Z(n,e[n],t,a);return i.join("&")},ge.fn.extend({serialize:function(){return ge.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ge.prop(this,"elements");return e?ge.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ge(this).is(":disabled")&&kt.test(this.nodeName)&&!Lt.test(e)&&(this.checked||!Xe.test(e))}).map(function(e,t){var n=ge(this).val();return null==n?null:Array.isArray(n)?ge.map(n,function(e){return{name:t.name,value:e.replace(Ot,"\r\n")}}):{name:t.name,value:n.replace(Ot,"\r\n")}}).get()}});var Nt=/%20/g,wt=/#.*$/,Ft=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,qt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Vt=/^(?:GET|HEAD)$/,Bt=/^\/\//,jt={},Ht={},zt="*/".concat("*"),Ut=oe.createElement("a");Ut.href=At.href,ge.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At.href,type:"GET",isLocal:qt.test(At.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ge.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ne(ne(e,ge.ajaxSettings),t):ne(ge.ajaxSettings,e)},ajaxPrefilter:ee(jt),ajaxTransport:ee(Ht),ajax:function(e,t){function i(e,t,i,s){var c,_,h,S,E,b=t;u||(u=!0,l&&n.clearTimeout(l),a=void 0,o=s||"",T.readyState=e>0?4:0,c=e>=200&&e<300||304===e,i&&(S=ie(f,T,i)),S=ae(f,S,T,c),c?(f.ifModified&&(E=T.getResponseHeader("Last-Modified"),E&&(ge.lastModified[r]=E),(E=T.getResponseHeader("etag"))&&(ge.etag[r]=E)),204===e||"HEAD"===f.type?b="nocontent":304===e?b="notmodified":(b=S.state,_=S.data,h=S.error,c=!h)):(h=b,!e&&b||(b="error",e<0&&(e=0))),T.status=e,T.statusText=(t||b)+"",c?v.resolveWith(p,[_,b,T]):v.rejectWith(p,[T,b,h]),T.statusCode(y),y=void 0,d&&m.trigger(c?"ajaxSuccess":"ajaxError",[T,f,c?_:h]),g.fireWith(p,[T,b]),d&&(m.trigger("ajaxComplete",[T,f]),--ge.active||ge.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var a,r,o,s,l,c,u,d,_,h,f=ge.ajaxSetup({},t),p=f.context||f,m=f.context&&(p.nodeType||p.jquery)?ge(p):ge.event,v=ge.Deferred(),g=ge.Callbacks("once memory"),y=f.statusCode||{},S={},E={},b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(u){if(!s)for(s={};t=Pt.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return u?o:null},setRequestHeader:function(e,t){return null==u&&(e=E[e.toLowerCase()]=E[e.toLowerCase()]||e,S[e]=t),this},overrideMimeType:function(e){return null==u&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)T.always(e[T.status]);else for(t in e)y[t]=[y[t],e[t]];return this},abort:function(e){var t=e||b;return a&&a.abort(t),i(0,t),this}};if(v.promise(T),f.url=((e||f.url||At.href)+"").replace(Bt,At.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(ke)||[""],null==f.crossDomain){c=oe.createElement("a");try{c.href=f.url,c.href=c.href,f.crossDomain=Ut.protocol+"//"+Ut.host!=c.protocol+"//"+c.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=ge.param(f.data,f.traditional)),te(jt,f,t,T),u)return T;d=ge.event&&f.global,d&&0==ge.active++&&ge.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Vt.test(f.type),r=f.url.replace(wt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Nt,"+")):(h=f.url.slice(r.length),f.data&&(r+=(xt.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(Ft,"$1"),h=(xt.test(r)?"&":"?")+"_="+Dt+++h),f.url=r+h),f.ifModified&&(ge.lastModified[r]&&T.setRequestHeader("If-Modified-Since",ge.lastModified[r]),ge.etag[r]&&T.setRequestHeader("If-None-Match",ge.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&T.setRequestHeader("Content-Type",f.contentType),T.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+zt+"; q=0.01":""):f.accepts["*"]);for(_ in f.headers)T.setRequestHeader(_,f.headers[_]);if(f.beforeSend&&(!1===f.beforeSend.call(p,T,f)||u))return T.abort();if(b="abort",g.add(f.complete),T.done(f.success),T.fail(f.error),a=te(Ht,f,t,T)){if(T.readyState=1,d&&m.trigger("ajaxSend",[T,f]),u)return T;f.async&&f.timeout>0&&(l=n.setTimeout(function(){T.abort("timeout")},f.timeout));try{u=!1,a.send(S,i)}catch(e){if(u)throw e;i(-1,e)}}else i(-1,"No Transport");return T},getJSON:function(e,t,n){return ge.get(e,t,n,"json")},getScript:function(e,t){return ge.get(e,void 0,t,"script")}}),ge.each(["get","post"],function(e,t){ge[t]=function(e,n,i,a){return ge.isFunction(n)&&(a=a||i,i=n,n=void 0),ge.ajax(ge.extend({url:e,type:t,dataType:a,data:n,success:i},ge.isPlainObject(e)&&e))}}),ge._evalUrl=function(e){return ge.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},ge.fn.extend({wrapAll:function(e){var t;return this[0]&&(ge.isFunction(e)&&(e=e.call(this[0])),t=ge(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return ge.isFunction(e)?this.each(function(t){ge(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ge(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ge.isFunction(e);return this.each(function(n){ge(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ge(this).replaceWith(this.childNodes)}),this}}),ge.expr.pseudos.hidden=function(e){return!ge.expr.pseudos.visible(e)},ge.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ge.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Wt=ge.ajaxSettings.xhr();ve.cors=!!Wt&&"withCredentials"in Wt,ve.ajax=Wt=!!Wt,ge.ajaxTransport(function(e){var t,i;if(ve.cors||Wt&&!e.crossDomain)return{send:function(a,r){var o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest");for(o in a)s.setRequestHeader(o,a[o]);t=function(e){return function(){t&&(t=i=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?r(0,"error"):r(s.status,s.statusText):r(Yt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),i=s.onerror=t("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout(function(){t&&i()})},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),ge.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ge.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ge.globalEval(e),e}}}),ge.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ge.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,a){t=ge("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&a("error"===e.type?404:200,e.type)}),oe.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Gt=[],Xt=/(=)\?(?=&|$)|\?\?/;ge.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Gt.pop()||ge.expando+"_"+Dt++;return this[e]=!0,e}}),ge.ajaxPrefilter("json jsonp",function(e,t,i){var a,r,o,s=!1!==e.jsonp&&(Xt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return a=e.jsonpCallback=ge.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Xt,"$1"+a):!1!==e.jsonp&&(e.url+=(xt.test(e.url)?"&":"?")+e.jsonp+"="+a),e.converters["script json"]=function(){return o||ge.error(a+" was not called"),o[0]},e.dataTypes[0]="json",r=n[a],n[a]=function(){o=arguments},i.always(function(){void 0===r?ge(n).removeProp(a):n[a]=r,e[a]&&(e.jsonpCallback=t.jsonpCallback,Gt.push(a)),o&&ge.isFunction(r)&&r(o[0]),o=r=void 0}),"script"}),ve.createHTMLDocument=function(){var e=oe.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),ge.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var i,a,r;return t||(ve.createHTMLDocument?(t=oe.implementation.createHTMLDocument(""),i=t.createElement("base"),i.href=oe.location.href,t.head.appendChild(i)):t=oe),a=Ae.exec(e),r=!n&&[],a?[t.createElement(a[1])]:(a=M([e],t,r),r&&r.length&&ge(r).remove(),ge.merge([],a.childNodes))},ge.fn.load=function(e,t,n){var i,a,r,o=this,s=e.indexOf(" ");return s>-1&&(i=K(e.slice(s)),e=e.slice(0,s)),ge.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(a="POST"),o.length>0&&ge.ajax({url:e,type:a||"GET",dataType:"html",data:t}).done(function(e){r=arguments,o.html(i?ge("<div>").append(ge.parseHTML(e)).find(i):e)}).always(n&&function(e,t){o.each(function(){n.apply(this,r||[e.responseText,t,e])})}),this},ge.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ge.fn[t]=function(e){return this.on(t,e)}}),ge.expr.pseudos.animated=function(e){return ge.grep(ge.timers,function(t){return e===t.elem}).length},ge.offset={setOffset:function(e,t,n){var i,a,r,o,s,l,c,u=ge.css(e,"position"),d=ge(e),_={};"static"===u&&(e.style.position="relative"),s=d.offset(),r=ge.css(e,"top"),l=ge.css(e,"left"),c=("absolute"===u||"fixed"===u)&&(r+l).indexOf("auto")>-1,c?(i=d.position(),o=i.top,a=i.left):(o=parseFloat(r)||0,a=parseFloat(l)||0),ge.isFunction(t)&&(t=t.call(e,n,ge.extend({},s))),null!=t.top&&(_.top=t.top-s.top+o),null!=t.left&&(_.left=t.left-s.left+a),"using"in t?t.using.call(e,_):d.css(_)}},ge.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ge.offset.setOffset(this,e,t)});var t,n,i,a,r=this[0];if(r)return r.getClientRects().length?(i=r.getBoundingClientRect(),t=r.ownerDocument,n=t.documentElement,a=t.defaultView,{top:i.top+a.pageYOffset-n.clientTop,left:i.left+a.pageXOffset-n.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===ge.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),l(e[0],"html")||(i=e.offset()),i={top:i.top+ge.css(e[0],"borderTopWidth",!0),left:i.left+ge.css(e[0],"borderLeftWidth",!0)}),{top:t.top-i.top-ge.css(n,"marginTop",!0),left:t.left-i.left-ge.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===ge.css(e,"position");)e=e.offsetParent;return e||Ze})}}),ge.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;ge.fn[e]=function(i){return Fe(this,function(e,i,a){var r;if(ge.isWindow(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===a)return r?r[t]:e[i];r?r.scrollTo(n?r.pageXOffset:a,n?a:r.pageYOffset):e[i]=a},e,i,arguments.length)}}),ge.each(["top","left"],function(e,t){ge.cssHooks[t]=P(ve.pixelPosition,function(e,n){if(n)return n=F(e,t),ct.test(n)?ge(e).position()[t]+"px":n})}),ge.each({Height:"height",Width:"width"},function(e,t){ge.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){ge.fn[i]=function(a,r){var o=arguments.length&&(n||"boolean"!=typeof a),s=n||(!0===a||!0===r?"margin":"border");return Fe(this,function(t,n,a){var r;return ge.isWindow(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===a?ge.css(t,n,s):ge.style(t,n,a,s)},t,o?a:void 0,o)}})}),ge.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),ge.holdReady=function(e){e?ge.readyWait++:ge.ready(!0)},ge.isArray=Array.isArray,ge.parseJSON=JSON.parse,ge.nodeName=l,i=[],void 0!==(a=function(){return ge}.apply(t,i))&&(e.exports=a);var Qt=n.jQuery,Jt=n.$;return ge.noConflict=function(e){return n.$===ge&&(n.$=Jt),e&&n.jQuery===ge&&(n.jQuery=Qt),ge},r||(n.jQuery=n.$=ge),ge})},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(10),v=n(0).utils,g=n(5).SVMXObject,y=n(5).EventDispatcher,S=n(5).Event;v.sendInvalidJson=!1;var E={name:"com.servicemax.client.offline.sal.model.nativeservice"};E.Facade=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"createRequest",value:function(e,t){var n=v.create("window.com.servicemax.client.offline.sal.model.nativeservice."+e,this);if(t&&t.handler)t.handler.call(t.handler.context,n);else if(!t)return n}},{key:"createHTTPRequest",value:function(e){return this.createRequest("HTTPRequest",e)}},{key:"createSQLRequest",value:function(e){return this.createRequest("SQLRequest",e)}},{key:"createInstallationsRequest",value:function(e){return this.createRequest("InstallationsRequest",e)}},{key:"createSignatureCaptureRequest",value:function(e){return this.createRequest("SignatureCaptureRequest",e)}},{key:"createSignatureDeviceCheckRequest",value:function(e){return this.createRequest("SignatureDeviceCheckRequest",e)}},{key:"createPDFRequest",value:function(e){return this.createRequest("GeneratePDFRequest",e)}},{key:"createTraceRequest",value:function(e){return this.createRequest("TraceRequest",e)}},{key:"createFileRequest",value:function(e){return this.createRequest("FileRequest",e)}},{key:"createReportRequest",value:function(e){return this.createRequest("ReportRequest",e)}},{key:"createUploadRequest",value:function(e){return this.createRequest("UploadRequest",e)}},{key:"createConnectivityRequest",value:function(e){return this.createRequest("ConnectivityRequest",e)}},{key:"createGenerateApiKeyRequest",value:function(e){return this.createRequest("GenerateApiKeyRequest",e)}},{key:"createLoginInfoRequest",value:function(e){return this.createRequest("LoginInfoRequest",e)}},{key:"createSignOutRequest",value:function(e){return this.createRequest("SignOutRequest",e)}},{key:"createExitRequest",value:function(e){return this.createRequest("ExitRequest",e)}},{key:"createSMSRequest",value:function(e){return this.createRequest("SMSRequest",e)}},{key:"createEmailRequest",value:function(e){return this.createRequest("EmailRequest",e)}},{key:"createShareRequest",value:function(e){return this.createRequest("ShareRequest",e)}},{key:"createTELRequest",value:function(e){return this.createRequest("TELRequest",e)}},{key:"createGEORequest",value:function(e){return this.createRequest("GEORequest",e)}},{key:"createScanRequest",value:function(e){return this.createRequest("ScanRequest",e)}},{key:"createExternalAppRequest",value:function(e){return this.createRequest("OpenExternalApp",e)}},{key:"createBrowserRequest",value:function(e){return this.createRequest("BrowserRequest",e)}},{key:"createCheckExternalRequest",value:function(e){return this.createRequest("CheckExternalRequest",e)}},{key:"createSendExternalRequest",value:function(e){return this.createRequest("SendExternalRequest",e)}},{key:"createSetExternalHandlerRequest",value:function(e){return this.createRequest("SetExternalHandlerRequest",e)}},{key:"createApplicationFocusRequest",value:function(e){return this.createRequest("ApplicationFocusRequest",e)}},{key:"createLocationTrackingRequest",value:function(e){return this.createRequest("LocationTrackingRequest",e)}},{key:"createLocaleFormatRequest",value:function(e){return this.createRequest("LocaleFormatRequest",e)}},{key:"createDeviceInfoRequest",value:function(e){return this.createRequest("DeviceInfoRequest",e)}},{key:"createEncryptDecryptRequest",value:function(e){return this.createRequest("EncryptDecryptRequest",e)}},{key:"createAppRestartRequest",value:function(e){return this.createRequest("AppRestartRequest",e)}},{key:"createGetSettingValueRequest",value:function(e){return this.createRequest("GetSettingValueRequest",e)}},{key:"createDataAccessAPIRequest",value:function(e){return this.createRequest("DataAccessAPIRequest",e)}},{key:"createDisableAutoSleepRequest",value:function(e){return this.createRequest("DisableAutoLock",e)}},{key:"createSetSSLCertificatePinningRequest",value:function(e){return this.createRequest("SetSSLCertificatePinning",e)}},{key:"createEnableAutoSleepRequest",value:function(e){return this.createRequest("EnableAutoLock",e)}},{key:"createTCPRequest",value:function(e){return this.createRequest("TCPRequest",e)}},{key:"createCapturePhotoRequest",value:function(e){return this.createRequest("CapturePhoto",e)}},{key:"createPrintHtmlContentRequest",value:function(e){return this.createRequest("PrintHtmlContentRequest",e)}},{key:"createNewRelicCustomEvtRequest",value:function(e){return this.createRequest("NewRelicCustomEvtRequest",e)}},{key:"createForceOrientationRequest",value:function(e){return this.createRequest("ForceOrietnationRequest",e)}},{key:"execute",value:function(e,t){if(!this.__nativeService||!this.__nativeService.Client)return void this.__logger.error("Native client interface is not available");if(t.parameters=t.parameters||{},void 0===t.parameters.async&&(t.parameters.async=!0),t.callback={handler:function(n){n.parameters=t.parameters,this._executeResponse(e,n)},context:this},v.getClient().getApplicationParameter("sal-native-testing"))this._executeResponse(e,{test:!0});else try{this.__nativeService.Client.execute(t)}catch(n){this.__logger.error(n),this.__logger.error(n+". Unable to call native async method: "+t.type),this._executeResponse(e,n)}}},{key:"_executeResponse",value:function(e,t){e&&(t instanceof Error?e._executeError({data:t.toString()}):t&&t.success&&"false"!==t.success?e._executeSuccess(t):e._executeError(t))}}]),t}(g),E.Facade.__logger=v.getLoggingService().getLogger("NATIVE-SERVICE-FACADE-IMPL"),E.ServiceRequest=function(e){function t(e,n){(0,c.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return i.__parent=e,i.__command=null,i}return(0,p.default)(t,e),(0,d.default)(t,[{key:"callbackErrorHandler",value:function(e){var t=v.getCurrentApplication(),n=t.getCurrentView&&t.getCurrentView();if(n&&n.isApplicationBlocked){n.isApplicationBlocked()&&(n.unblockApplication(),setTimeout(function(){n.done()},0))}else v.getLoggingService().getLogger("NATIVE-SERVICE-FACADE-IMPL").warn("Either current view is null or view does not define isApplicationBlocked!")}},{key:"execute",value:function(e){var t=this;this.bind("CALLBACK_ERROR",function(e){t.callbackErrorHandler(e.data)}),this.__parent.execute(this,e)}},{key:"_executeSuccess",value:function(e){var t=new E.ServiceRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(t)}},{key:"_executeError",value:function(e){var t=new E.ServiceRequestEvent("REQUEST_ERROR",this,e);this.triggerEvent(t)}},{key:"_executeCallbackError",value:function(e){var t=new E.ServiceRequestEvent("CALLBACK_ERROR",this,e);this.triggerEvent(t)}}]),t}(y),E.SignOutRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SIGNOUT,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ExitRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.EXIT,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.SMSRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SMS,parameters:{phone:e.phone||"",message:e.message||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.EmailRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.EMAIL,parameters:{address:e.address||"",subject:e.subject||"",message:e.message||"",attachmentFiles:e.attachmentFiles||[]}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ShareRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SHARE,parameters:{files:e.files||[]}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.TELRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.TEL,parameters:{phone:e.phone||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.GEORequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.GEO,parameters:{street:e.street||"",city:e.city||"",state:e.state||"",country:e.country||"",zipcode:e.zipcode||"",latitude:e.latitude||"0",longitude:e.longitude||"0"}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ScanRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SCAN,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.OpenExternalApp=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.OPENEXTERNALAPP,parameters:{url:e.url,param:e.param}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.BrowserRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.BROWSER,parameters:{link:e.link||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.HTTPRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.HTTP,parameters:{url:e.uri||e.url,method:e.method||"GET",headers:e.headers||{},data:e.data,isNonSalesforceUrl:e.isNonSalesforceUrl,allowPost:e.allowPost||!1}};return e.upload&&(n.parameters.upload=e.upload),e.download&&(n.parameters.download=e.download),n.parameters.headers["Content-Type"]||(n.parameters.headers["Content-Type"]="application/json"),"application/json"==n.parameters.headers["Content-Type"]&&(n.parameters.data=v.toJSON(n.parameters.data)),this.__command=n,(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,this.__command)}},{key:"_executeSuccess",value:function(e){var n=this.__command.parameters.headers;if(n&&"application/json"==n["Content-Type"]&&"string"==typeof e.data&&"Success"!=e.data){var i='[{"message":"An unexpected error occurred.","errorCode":"UNKNOWN_EXCEPTION"}]';if(e.data.substring(e.data.length-i.length)===i)return e.data=i,void this._executeError(e);var a=e.data;v.sendInvalidJson&&(e.data+="SendInvalidJson is set to true. This should be used for testing Only!!!");try{e.data=v.toObject(e.data.replace(/(\r|\n)+/g,"&#10;"))}catch(t){e.data=a}}(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"_executeSuccess",this).call(this,e)}}]),t}(E.ServiceRequest),E.SQLRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){e.queryParams&&(e.query=v.string.substitute(e.query,e.queryParams));var n={type:E.AbstractClient.SQL,parameters:{query:e.query,queryArray:e.queryArray||[],doRollBack:e.doRollBack||!1,async:e.async,count:"count"in e?e.count+1:0}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}},{key:"_executeSuccess",value:function(e){var n=e.data;try{"string"==typeof e.data&&e.parameters.query&&e.parameters.query.match(/^\s*SELECT/i)&&(e.data=v.toObject(e.data.replace(/(\r|\n)+/g,"&#10;")))}catch(t){e.data=n}try{(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"_executeSuccess",this).call(this,e)}catch(t){console.error(t.stack?t.stack:t),v.getLoggingService().getLogger("NATIVE-SERVICE-FACADE-IMPL").error("Error in event handler: "+t+" when processing result from query ("+e.parameters.query+")"),this._executeCallbackError({data:t.toString()})}}}]),t}(E.ServiceRequest),E.InstallationsRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.INSTALLATIONS,parameters:{operation:e}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.GeneratePDFRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.GENERATEPDF,parameters:{operation:e,recordId:e.recordId,processId:e.processId,htmlContent:e.htmlContent,sourceRecord:e.sourceRecord,pdfName:e.pdfName||"",callback:e.callback,context:e.context}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.SignatureCaptureRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SIGNATURECAPTURE,parameters:{operation:e,recordId:e.recordId,processId:e.processId,uniqueName:e.uniqueName}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.SignatureDeviceCheckRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SIGNATUREDEVICECHECK,parameters:{operation:e,async:e.async}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.FileRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.FILE,parameters:e},i=["READ","READBASE64","WRITE","APPEND","COPY","DELETE","RENAME","EXECUTE","SELECT","INFO","LIST","READOPENFILE","CLEARSHAREDFILE","QUEUEUSAGEDATA"];if(e.operation&&-1===i.indexOf(e.operation.toUpperCase()))throw"File operation not supported: "+e.operation;return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.TraceRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.TRACE,parameters:{message:e.message}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ReportRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.REPORT,parameters:{recId:e.recId,processId:e.processId}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.DownloadRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.DOWNLOAD,parameters:{sourceObject:e.sourceObject,recordId:e.recordId,file:e.file,fieldName:e.fieldName,isTroubleshootDocumentDownload:e.isTroubleshootDocumentDownload}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.UploadRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.UPLOAD,parameters:{parentId:e.parentId,file:e.file,name:e.name,objectName:e.objectName,contentVersionId:e.contentVersionId}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ConnectivityRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){e=e||{};var n={type:E.AbstractClient.CONNECTIVITY,parameters:{delay:e.delay||2e3}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.GenerateApiKeyRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.GENERATEAPIKEY,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.DisableAutoLock=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.DISABLEAUTOLOCK,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.EnableAutoLock=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.ENABLEAUTOLOCK,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.LoginInfoRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.LOGININFO,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.CheckExternalRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.CHECKEXTERNAL,parameters:{AppName:e.appName||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.SendExternalRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SENDEXTERNAL,parameters:{AppName:e.appName||"",externalRequest:e.externalRequest||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.SetExternalHandlerRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SETEXTERNALHANDLER,parameters:{handler:e.handler||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ApplicationFocusRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.APPLICATIONFOCUS,parameters:{handler:e.handler||""}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.DataAccessAPIRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.DATAACCESSAPI,method:e.method,parameters:{objectName:e.objectName,fields:e.fields,criteria:e.criteria,records:e.records,userName:e.userName,recordIds:e.recordIds,query:e.query}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.ServiceRequestEvent=function(e){function t(e,n,i){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e,n,i))}return(0,p.default)(t,e),t}(S),E.File=function(e){function t(e){(0,c.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return n.__path=e,n.__request=E.Facade.createFileRequest(),n.__request.bind("REQUEST_COMPLETED",n.__onResult,n),n.__request.bind("REQUEST_ERROR",n.__onError,n),n.__requestQueue=[],n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"getPath",value:function(){return this.__path}},{key:"getName",value:function(){var e=this.__path;return e=e.replace(/\\/g,"/"),e.match(/([^\/]*)$/)[1]}},{key:"getParentFolder",value:function(){var e=this.__path;return e=e.replace(/\/.*?$/,""),new E.File(e)}},{key:"__executeRequest",value:function(e,t){var n=new m.Deferred;return this.__requestQueue.push({deferred:n,request:e}),t&&n.done(t),1===this.__requestQueue.length&&this.__executeNextRequest(),n}},{key:"__executeNextRequest",value:function(){if(0!==this.__requestQueue.length){var e=this.__requestQueue[0],t=(e.deferred,e.request);v.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.nativeservice.File").info("FILE OP:"+t.operation+" ON "+t.file),this.__request.execute(t)}}},{key:"__onResult",value:function(e){this.__requestQueue.shift().deferred.resolve(e.data.success,e.data.data),this.__executeNextRequest()}},{key:"__onError",value:function(e){var t=this.__requestQueue.shift();if(t){var n=t.deferred,i=t.request;v.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.nativeservice.File").error("File Error Op="+i.operation+" returned "+e.data.data+" for "+this.getPath()),n.resolve(!1,e.data.data),this.__executeNextRequest()}}},{key:"cancel",value:function(){var e=this.__requestQueue;this.__requestQueue=[];for(var t=0;t<e.length;t++)e.deferred.resolve({success:!1,data:"Canceled by cancelRequest Call"})}},{key:"read",value:function(e){return this.__executeRequest({operation:"READ",file:this.__path},e)}},{key:"exists",value:function(e){var t=new m.Deferred;return this.read().then(function(e,n){t.resolve(!0,e&&""!==n)}),t.done(e),t}},{key:"write",value:function(e,t){return this.__executeRequest({operation:"WRITE",file:this.__path,data:e},t)}},{key:"append",value:function(e,t){return this.__executeRequest({operation:"APPEND",file:this.__path,data:e},t)}},{key:"deleteFile",value:function(e){return this.__executeRequest({operation:"DELETE",file:this.__path},e)}},{key:"renameFile",value:function(e){return this.__executeRequest({operation:"RENAME",file:this.__path},e)}},{key:"execute",value:function(e){return this.__executeRequest({operation:"EXECUTE",file:this.__path.replace(/\//g,"\\")},e)}},{key:"copy",value:function(e,t){var n=e instanceof E.File?e:new E.File(e);return this.__executeRequest({operation:"COPY",file:this.__path,targetPath:n.getParentFolder().getPath(),targetFile:n.getName()},t)}},{key:"move",value:function(e,t){var n=new m.Deferred;return this.copy(e).then(v.proxy(this,function(e){if(e)return this.deleteFile();n.resolve(!1,"")})).then(v.proxy(this,function(t){this.__path=e instanceof E.File?e.getPath():e,n.resolve(status)})),n}},{key:"info",value:function(e){var t=new m.Deferred;return this.__executeRequest({operation:"INFO",file:this.__path},function(n,i){if(n){var a={size:i.FileSizeInBytes,path:i.FilePath,readonly:"true"==i.IsReadOnly.toLowerCase(),createdDate:i.CreatedDateTime,modifiedDate:i.LastModifiedDateTime,fileExtension:i.FileExtension,filePath:i.FilePath};e&&e(n,a),t.resolve(n,a)}else t.reject(i)}),t}}]),t}(g),E.LocationTrackingRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.LOCATION_TRACKING,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.LocaleFormatRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.LOCALE_FORMAT,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.DeviceInfoRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.DEVICEINFO,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.GetSettingValueRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.GETSETTINGVALUE,parameters:{settingName:e.settingName}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.EncryptDecryptRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.ENCRYPT_OR_DECRYPT,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.SetSSLCertificatePinning=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.SETSSLCERTIFICATEPINNING,parameters:{value:e.value}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.AppRestartRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.APP_RESTART,parameters:{}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.TCPRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.TCPREQUEST,parameters:e};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.PrintHtmlContentRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.PRINTHTMLCONTENT,parameters:e};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.NewRelicCustomEvtRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n=this,i={type:E.AbstractClient.NEWRELICCUSTOMEVT,parameters:e.parameters},a=com.servicemax.client.offline.sal.model.utils.Cache,o=a.readFromJSCache("newrelic","nr_org_name");if(o)return i.parameters.orgName=o,(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,i);o=null,a.readObjectFromDBCache("VALIDATE_PROFILE_RESULT",function(e){if(e&&e.valueMap){for(var l=0;l<e.valueMap.length;l++){var c=e.valueMap[l];if("ORGNAME"===c.key.toUpperCase()){a.registerJSCache("newrelic",2),a.writeToJSCache("newrelic","nr_org_name",c.value),o=c.value;break}}i.parameters.orgName=o||void 0}return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",n).call(n,i)})}}]),t}(E.ServiceRequest),E.ForceOrietnationRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.FORCEORIENTATION,parameters:e.parameters};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),E.AbstractClient=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"execute",value:function(e){}}]),t}(g),E.AbstractClient.CAPTUREPHOTO="CAPTUREPHOTO",E.AbstractClient.TCPREQUEST="TCPREQUEST",E.AbstractClient.OPENEXTERNALAPP="OPENEXTERNALAPP",E.AbstractClient.SETSSLCERTIFICATEPINNING="SETSSLCERTIFICATEPINNING",E.AbstractClient.ENABLEAUTOLOCK="ENABLEAUTOLOCK",E.AbstractClient.DISABLEAUTOLOCK="DISABLEAUTOLOCK",E.AbstractClient.GETSETTINGVALUE="GETSETTINGVALUE",E.AbstractClient.DATAACCESSAPI="DATAACCESSAPI",E.AbstractClient.APP_RESTART="APP_RESTART",E.AbstractClient.ENCRYPT_OR_DECRYPT="ENCRYPT_OR_DECRYPT",E.AbstractClient.DEVICEINFO="DEVICEINFO",E.AbstractClient.LOCALE_FORMAT="LOCALEFORMAT",E.AbstractClient.LOCATION_TRACKING="LOCATION_TRACKING",E.AbstractClient.APPLICATIONFOCUS="APPLICATIONFOCUS",E.AbstractClient.SETEXTERNALHANDLER="SETEXTERNALHANDLER",E.AbstractClient.CHECKEXTERNAL="CHECKEXTERNAL",E.AbstractClient.SENDEXTERNAL="SENDEXTERNAL",E.AbstractClient.BROWSER="BROWSER",E.AbstractClient.SCAN="SCAN",E.AbstractClient.GEO="GEO",E.AbstractClient.TEL="TEL",E.AbstractClient.SHARE="SHARE",E.AbstractClient.EMAIL="EMAIL",E.AbstractClient.SMS="SMS",E.AbstractClient.EXIT="EXIT",E.AbstractClient.SIGNOUT="SIGNOUT",E.AbstractClient.GENERATEPDF="GENERATEPDF",E.AbstractClient.CONNECTIVITY="CONNECTIVITY",E.AbstractClient.SIGNATUREDEVICECHECK="SIGNATUREDEVICECHECK",E.AbstractClient.SIGNATURECAPTURE="SIGNATURECAPTURE",E.AbstractClient.INSTALLATIONS="INSTALLATIONS",E.AbstractClient.GENERATEAPIKEY="GENERATEAPIKEY",E.AbstractClient.LOGININFO="LOGININFO",E.AbstractClient.DOWNLOAD="DOWNLOAD",E.AbstractClient.UPLOAD="UPLOAD",E.AbstractClient.REPORT="REPORT",E.AbstractClient.TRACE="TRACE",E.AbstractClient.FILE="FILE",E.AbstractClient.SQL="SQL",E.AbstractClient.HTTP="HTTP",E.AbstractClient.PRINTHTMLCONTENT="PRINTHTMLCONTENT",E.AbstractClient.NEWRELICCUSTOMEVT="NEWRELICCUSTOMEVT",E.AbstractClient.FORCEORIENTATION="FORCEORIENTATION",E.CapturePhoto=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){var n={type:E.AbstractClient.CAPTUREPHOTO,parameters:{mode:e.request.additionalInfo.mode,duration:e.request.additionalInfo.duration||0,imageCompression:e.request.additionalInfo.imageCompression||void 0}};return(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"execute",this).call(this,n)}}]),t}(E.ServiceRequest),v.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(4),d=i(u),_=n(10),h=n(667),f=n(5).SVMXObject,p={name:"com.servicemax.client.lib.datetimeutils"};p.DatetimeUtil=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),t}(f),p.DatetimeUtil.convertFormatToFormat=function(e,t){for(var n=!0,i=0;i<e.length;i++)"'"===e[i]&&(n?(e=e.replace("'","["),n=!1):(e=e.replace("'","]"),n=!0));0===e.indexOf("[")&&(e="svmxdummy"+e);var a=e.split(/\W+/),r=e.split(/\w+/),o=1;return e="",a.forEach(function(n){"string"==typeof t[n]&&(n=t[n]),e+=n,void 0!==r[o]&&(e+=r[o]),o++}),e=e.replace("svmxdummy","")},p.DatetimeUtil.convertFormatToJSFormat=function(e,t){return t=t||p.DatetimeUtil.tokens,p.DatetimeUtil.convertFormatToFormat(e,t)},p.DatetimeUtil.convertISODateStringToSpecifiedFormat=function(e,t){var n=h(p.DatetimeUtil.convertDatetimeForSave(e));return p.DatetimeUtil.getFormattedDatetime(n,t)},p.DatetimeUtil.tokens={d:"D",dd:"DD",ddd:"ddd",dddd:"dddd",f:"S",ff:"SS",fff:"SSS",h:"h",hh:"hh",H:"H",HH:"HH",m:"m",mm:"mm",M:"M",MM:"MM",MMM:"MMM",MMMM:"MMMM",s:"s",ss:"ss",t:"a",tt:"A",y:"YY",yy:"YY",yyy:"YYYY",yyyy:"YYYY",z:"Z",zz:"Z",zzz:"Z",st:"Do",ee:"e",eee:"ddd",eeee:"dddd",EE:"E",EEE:"ddd",EEEE:"dddd"},p.DatetimeUtil.convertFormatFromExt=function(e){var t=p.DatetimeUtil._swap(p.DatetimeUtil.ext_tokens);return p.DatetimeUtil.convertFormatToFormat(e,t)},p.DatetimeUtil.convertFormatForExt=function(e){return e=e||p.DatetimeUtil.getDefaultDatetimeFormat(),p.DatetimeUtil.convertFormatToFormat(e,p.DatetimeUtil.ext_tokens)},p.DatetimeUtil.addUnitToDateTime=function(e,t,n){return h(e).add(t,n).toDate()},p.DatetimeUtil.ext_tokens={YY:"y",YYYY:"Y",M:"n",MM:"m",MMM:"M",MMMM:"F",w:"W",D:"j",Do:"jS",DD:"d",DDD:"z",ddd:"D",dddd:"l",d:"w",H:"G",HH:"H",h:"g",hh:"h",mm:"i",ss:"s",z:"e",zz:"e"},p.DatetimeUtil.getTimestampWithSaveFormat=function(){return p.DatetimeUtil.macroDrivenDatetime("Now","YYYY-MM-DD","HH:mm:ss")},p.DatetimeUtil.getWeekDayNameInUserLocale=function(e,t){return t||(t="ddd"),h().day(e).format(t)},p.DatetimeUtil.getLocalUTCOffset=function(){return h().utcOffset()},p.DatetimeUtil.getLocalUTCOffsetString=function(){return h().format("Z")},p.DatetimeUtil.convertDatetimeForSave=function(e,t){return h.utc(e,t).format(p.DatetimeUtil.getSaveFormat("dateTime"))},p.DatetimeUtil.convertDateForSave=function(e,t){return h.utc(e,t).format(p.DatetimeUtil.getSaveFormat("date"))},p.DatetimeUtil.isSame=function(e,t,n){return h(e).isSame(h(t),n)},p.DatetimeUtil.getDurationBetween=function(e,t){var n=h(e).isValid()&&h(t).isValid(),i=h.duration(h(t).diff(e));return i.isValid=function(){return n},i},p.DatetimeUtil.humanizeRelativeDate=function(e,t){if((t=void 0===t||null===t?7:t)>7)throw new Error("DatetimeUtils.humanizeRelativeDate: timespan for humanized dates too long");var n=h().startOf("d").diff(h(e),"days");return n>=t||n<-t?p.DatetimeUtil.getFormattedDatetime(e):h(e).calendar()},p.DatetimeUtil.convertDatetimeForExt=function(e,t){return h.utc(e,t).format("YYYY-MM-DD HH:mm:ss")},p.DatetimeUtil.convertDateForExt=function(e,t){return h.utc(e,t).format("YYYY-MM-DD")},p.DatetimeUtil.parseGMTDateOnly=function(e,t){var n=h.utc(e,t).startOf("day");if(n&&!n.isValid())throw"Failed to parse date in GMT format: "+e;return n.toDate()},p.DatetimeUtil.parseDateOnly=function(e,t){return h(e,t).startOf("day").toDate()},p.DatetimeUtil.parseGMTDate=function(e,t){var n=h.utc(e,t);if(n&&!n.isValid())throw new Error("Failed to parse date in GMT format: "+e);return n.toDate()},p.DatetimeUtil.parseDate=function(e,t){return h(e,t).toDate()},p.DatetimeUtil.getFormattedUTCDatetime=function(e,t){return null!==t&&void 0!==t||(t=p.DatetimeUtil.getDefaultDatetimeFormat()),h.utc(e).format(t)},p.DatetimeUtil.getFormattedDatetime=function(e,t){return null!==t&&void 0!==t||(t=p.DatetimeUtil.getDefaultDatetimeFormat()),h(e).format(t)},p.DatetimeUtil.getCurrentDatetimeGMT=function(e){return p.DatetimeUtil.getFormattedDatetime(h.utc(),e)},p.DatetimeUtil.getCurrentDatetimeISO=function(){return h().toISOString()},p.DatetimeUtil.getCurrentDatetime=function(e){return""!==p.DatetimeUtil._timeZoneStr?p.DatetimeUtil.getFormattedDatetime(h(),e):p.DatetimeUtil.getFormattedDatetime(h.utc().utcOffset(p.DatetimeUtil._timeZone),e)},p.DatetimeUtil.dateObjFormatter=function(e,t){return console.warn("DatetimeUtils.dateObjFormatter is deprecated! Please use getFormattedDatetime in combination with getSaveFormat instead"),p.DatetimeUtil.getFormattedDatetime(e,p.DatetimeUtil.getSaveFormat(t?"dateOnly":"dateTime"))},p.DatetimeUtil.getSaveFormat=function(e){var t="YYYY-MM-DD";return void 0!==e&&null!==e&&"datetime"===e.toLowerCase()&&(t="YYYY-MM-DD HH:mm:ss"),t},p.DatetimeUtil.isValidDate=function(e){return h(e).isValid()},p.DatetimeUtil.isFormat24HourTime=function(e){return e.indexOf("h")>-1?"12":"24"},p.DatetimeUtil.getEndOf=function(e,t){var n=h(e);return n.isValid()?n.endOf(t).format("YYYY-MM-DD HH:mm:ss"):e},p.DatetimeUtil.getStartOf=function(e,t){var n=h(e);return n.isValid()?n.startOf(t).format("YYYY-MM-DD HH:mm:ss"):e},p.DatetimeUtil.manipulateDatetime=function(e,t,n){var i=h(e);return i.isValid()?n<0?(n*=-1,i.subtract(n,t).format("YYYY-MM-DD HH:mm:ss")):i.add(n,t).format("YYYY-MM-DD HH:mm:ss"):e},p.DatetimeUtil.macroDrivenDatetime=function(e,t,n,i,a){var r=h.utc();switch(t=t||p.DatetimeUtil.getDefaultDateFormat(),n=n||p.DatetimeUtil.getDefaultTimeFormat(),"now"!==e.toLowerCase()&&""===p.DatetimeUtil._timeZoneStr&&(r=r.utcOffset(p.DatetimeUtil._timeZone)),e.toLowerCase()){case"yesterday":r=r.local().subtract(1,"days").startOf("day");break;case"now":r=r.seconds(0);break;case"today":r=r.local().startOf("day");break;case"tomorrow":r=r.local().add(1,"days").startOf("day")}var o=r.format(t+" "+n);return null!==i&&void 0!==i?o="datetime"===i?r.format(t+" "+n):"date"===i?r.format(t):r.format(t+" "+n):null!==a&&void 0!==a&&(o=r.format(t),a.length>12&&(o=r.format(t+" "+n))),o},p.DatetimeUtil.macroDrivenDatetimeLiteralsInGMT=function(e,t,n,i,a,r){var o=h.utc();switch(t=t||p.DatetimeUtil.getDefaultDateFormat(),n=n||p.DatetimeUtil.getDefaultTimeFormat(),e.toLowerCase()){case"yesterday":o=i?o.utcOffset(p.DatetimeUtil._timeZone).subtract(1,"days").endOf("day"):o.utcOffset(p.DatetimeUtil._timeZone).subtract(1,"days").startOf("day"),o=o.subtract(p.DatetimeUtil._timeZone,"minutes");break;case"now":o=o.seconds(0);break;case"today":o=i?o.utcOffset(p.DatetimeUtil._timeZone).endOf("day"):o.utcOffset(p.DatetimeUtil._timeZone).startOf("day"),o=o.subtract(p.DatetimeUtil._timeZone,"minutes");break;case"tomorrow":o=i?o.utcOffset(p.DatetimeUtil._timeZone).add(1,"days").endOf("day"):o.utcOffset(p.DatetimeUtil._timeZone).add(1,"days").startOf("day"),o=o.subtract(p.DatetimeUtil._timeZone,"minutes")}var s=o.format(t+" "+n);return null!==a&&void 0!==a?s="datetime"===a?o.format(t+" "+n):"date"===a?o.format(t):o.format(t+" "+n):null!==r&&void 0!==r&&(s=o.format(t),r.length>12&&(s=o.format(t+" "+n))),s},p.DatetimeUtil.__toInt=function(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n},p.DatetimeUtil.parseOffsetString=function(e){-1===e.indexOf("-")&&-1===e.indexOf("+")&&(e="+"+e);var t=(e||"").match(p.DatetimeUtil.matchOffset)||[],n=t[t.length-1]||[],i=(""+n).match(p.DatetimeUtil.chunkOffset)||["-",0,0],a=60*i[1]+p.DatetimeUtil.__toInt(i[2]);return"+"===i[0]?a:-a},p.DatetimeUtil.matchOffset=/Z|[+-]?\d\d:?\d\d/gi,p.DatetimeUtil.chunkOffset=/([+-]|\d\d)/gi,p.DatetimeUtil.convertToTimezone=function(e,t,n){if(""!==p.DatetimeUtil._timeZoneStr)return n?p.DatetimeUtil.getFormattedDatetime(h(e).utc(),p.DatetimeUtil.getSaveFormat("datetime")):p.DatetimeUtil.getFormattedDatetime(h.utc(e).local(),p.DatetimeUtil.getSaveFormat("datetime"));var i=p.DatetimeUtil._timeZone;return void 0!==t&&null!==t?"number"!=typeof t&&(t=p.DatetimeUtil.parseOffsetString(t)):t=i,n&&(t*=-1),p.DatetimeUtil.getFormattedDatetime(h.utc(e).utcOffset(t),p.DatetimeUtil.getSaveFormat("datetime"))},p.DatetimeUtil.getDisplayDatetimeFormat=function(e){var t=p.DatetimeUtil.getDefaultDatetimeFormat();return"dateonly"!==e.toLowerCase()&&"date"!==e.toLowerCase()||(t=p.DatetimeUtil.getDefaultDateFormat()),t},p.DatetimeUtil.setAmPmText=function(e,t){var n=new RegExp(e+"|"+t,"i"),i=function(e){return e===t},a=function(n,i,a){return n>11?t:e};p.DatetimeUtil.setLocale({meridiemParse:n,isPM:i,meridiem:a})},p.DatetimeUtil.getLocale=function(){return p.DatetimeUtil.__locale},p.DatetimeUtil.setLocale=function(e,t){"string"!=typeof e&&(t=e,e=p.DatetimeUtil.__locale),void 0!==t&&null!==t&&(t.invalidDate=""),p.DatetimeUtil.__locale=h.locale(e,t)},p.DatetimeUtil.getDefaultDatetimeFormat=function(){return p.DatetimeUtil.getDefaultDateFormat()+" "+p.DatetimeUtil.getDefaultTimeFormat()},p.DatetimeUtil.getDefaultTimeFormat=function(){return h.localeData(h.locale())._longDateFormat.LT||"HH:mm:ss"},p.DatetimeUtil.getDefaultDateFormat=function(){return h.localeData(h.locale())._longDateFormat.l||h.localeData(h.locale())._longDateFormat.ll||"MM-DD-YYYY"},p.DatetimeUtil.getTimezone=function(){return p.DatetimeUtil._timeZoneStr},p.DatetimeUtil.getTimezoneOffset=function(e){return p.DatetimeUtil._timeZoneStr?h(e).format("Z"):h(e).utcOffset(p.DatetimeUtil._timeZone).format("Z")},p.DatetimeUtil.setLongDateFormat=function(e){var t=h.localeData(h.locale())._longDateFormat,n=_.extend({},t,{LL:e,ll:e,lll:"ll LT",LLL:"LL LT"});p.DatetimeUtil.setLocale({longDateFormat:n})},p.DatetimeUtil.setTimeFormat=function(e){var t=h.localeData(h.locale())._longDateFormat,n=_.extend({},t,{LT:e,lt:e,lll:"ll LT",LLL:"LL LT"});p.DatetimeUtil.setLocale({longDateFormat:n})},p.DatetimeUtil.setDateFormat=function(e){var t=h.localeData(h.locale())._longDateFormat,n=_.extend({},t,{L:e,l:e,lll:"ll LT",LLL:"LL LT"});p.DatetimeUtil.setLocale({longDateFormat:n})},p.DatetimeUtil.setTimezoneOffset=function(e){p.DatetimeUtil._timeZone=p.DatetimeUtil.parseOffsetString(e)},p.DatetimeUtil.setTimezone=function(e){if(!e)return console.warn("Something tried to set TZ to empty string!");h.tz.setDefault(e),p.DatetimeUtil._timeZoneStr=e},p.DatetimeUtil._swap=function(e){var t={};for(var n in e)t[e[n]]=n;return t},p.DatetimeUtil.resetSecondsAndFormat=function(e,t){var n=h(e);return n.seconds(0),e=p.DatetimeUtil.getFormattedDatetime(n,t)},p.DatetimeUtil.getJSDateFromStringDate=function(e){var t=h(e);return t.isValid()?t.toDate():e},p.DatetimeUtil.getDatetimeInServerFormat=function(e){return e&&(e=e.replace(" ","T"),e+=".000Z"),e},p.DatetimeUtil._timeZoneStr="",p.DatetimeUtil._timeZone=h().utcOffset(),p.DatetimeUtil.__locale=h.locale("en-US"),e.exports=p},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).AbstractCommand,g=n(5).AbstractOperation,y=n(5).AbstractResponder,S={name:"com.servicemax.client.mvc.api"};S.Command=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.__controller=null,e.__eventBus=null,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"setController",value:function(e){this.__controller=e}},{key:"setEventBus",value:function(e){this.__eventBus=e}},{key:"executeAsync",value:function(e,t){}},{key:"_executeOperationAsync",value:function(e,t,n){this.__controller.getModel().executeOperationAsync(e,t,n,this.getEventBus())}},{key:"getController",value:function(){return this.__controller}},{key:"getEventBus",value:function(){return this.__eventBus}}]),t}(v),S.Operation=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.__eventBus=null,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){}},{key:"setEventBus",value:function(e){this.__eventBus=e}},{key:"getEventBus",value:function(){return this.__eventBus}}]),t}(g),S.Responder=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"result",value:function(e){}},{key:"fault",value:function(e){}}]),t}(y),S.CommandWithResponder=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.__responder=null,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"executeAsync",value:function(e,n){(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"executeAsync",this).call(this),this.__responder=n}},{key:"result",value:function(e){this.__responder&&this.__responder(e)}},{key:"fault",value:function(e){}}]),t}(S.Command),m.defineGlobal(S.name,S),e.exports=S},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=n(1),r=i(a),o=n(664),s=i(o);t.default=function e(t,n,i){null===t&&(t=Function.prototype);var a=(0,s.default)(t,n);if(void 0===a){var o=(0,r.default)(t);return null===o?void 0:e(o,n,i)}if("value"in a)return a.value;var l=a.get;if(void 0!==l)return l.call(i)}},function(e,t,n){var i=n(21);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports={default:n(627),__esModule:!0}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=n(633),r=i(a),o=n(641),s=i(o),l="function"==typeof s.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};t.default="function"==typeof s.default&&"symbol"===l(r.default)?function(e){return void 0===e?"undefined":l(e)}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":void 0===e?"undefined":l(e)}},function(e,t,n){var i=n(404),a=n(406),r=n(185),o=n(184);e.exports={form:i,impl:a,signature:r,svmxbasebutton:o}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(33).AbstractConsoleApp,g=(n(407),{name:"com.servicemax.client.sfmconsole.ui.largemodern.console"}),y=m.getLoggingService().getLogger("largemodern.console");g.ConcreteConsoleApp=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e)),i=n.getAppConfig().controller;return i&&(n.__controller=m.create(i["class-name"],n),n.__controller.initAsync({handler:n.__onControllerInit,context:n})),n.__viewConfigs={},m.array.forEach(n.getAppConfig().views,function(e){this.__viewConfigs[e.id]=e},n),n.__views={},n.__viewsById={},n.__sharedMenuItems={},n.__controllerReady=!1,n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"__onControllerInit",value:function(){var e=this.__options||{};e.consoleAppInstance=this,e.onReady={handler:this.__onControllerReady,context:this},e.requestClose={handler:this.popState,context:this},this.__controller.run(e)}},{key:"__onControllerReady",value:function(){this.__controllerReady=!0;for(var e in this.__viewsById)this.__viewsById[e].__ready()}},{key:"getView",value:function(e){return this.__viewsById[e]}},{key:"createView",value:function(e){if(e||(e=this.__getDefaultViewName()),!this.__viewConfigs[e])throw this.getAppConfig().id+" does not have a view named "+e;var t=m.create(this.__viewConfigs[e]["class-name"],{console:this,deliveryEngine:this.__controller,viewConfigId:e});return this.__views[e]=t,this.__viewsById[t.getId()]=t,t.blockApplication(t.getViewLoadMask()),t}},{key:"setViewOptions",value:function(e,t){try{var n=this.getView(e);return n.getOptions()||(n.setOptions(t),this.__controller&&!this.__controllerReady||(n.__ready(),n.unblockApplication())),!0}catch(e){return y.error(e),y.error("Failed to load View: "+e),this.__destroyView(n),!1}}},{key:"__getDefaultViewName",value:function(){for(var e in this.__viewConfigs)if(this.__viewConfigs[e]["default-view"])return e}},{key:"removeAllViews",value:function(){for(var e in this.__viewsById)this.__destroyView(this.__viewsById[e]);this.__viewsById={},this.__views={}}},{key:"pushState",value:function(e){this.__parent.pushState(e)}},{key:"popState",value:function(){m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").back()}},{key:"showSpinner",value:function(e,t){this.__parent.showSpinner(e,t)}},{key:"hideSpinner",value:function(e){this.__parent.hideSpinner(e)}},{key:"__isViewInStateManager",value:function(e){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").findByField("viewInstanceId",e)}},{key:"viewRemoved",value:function(e){if(!this.__isViewInStateManager(e)){var t=this.getView(e);this.__destroyView(t)}}},{key:"__destroyView",value:function(e){e&&(delete this.__views[e.getViewConfigId()],e.getId&&delete this.__viewsById[e.getId()],e.hide(),setTimeout(function(){e.destroy()},1e3))}},{key:"registerMenuItems",value:function(e,t){this.__sharedMenuItems[e]=t}},{key:"getMenuItems",value:function(e){return this.__sharedMenuItems[e]}},{key:"notifyDataChange",value:function(e){this.__controller&&this.__controller.notifyDataChange&&this.__controller.notifyDataChange(e)}},{key:"doCleanup",value:function(){return this.removeAllViews(),this.setPropertyForCleanup(["__controller","__viewsById","__views","__viewConfigs"],!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),g.View=Ext.define(g.name+".View",{extend:"com.servicemax.client.ui.components.modern.navigation.SVMXCard",alias:"widget.sfm.card",config:{console:null,deliveryEngine:null,options:null,viewConfigId:null,menuItems:null},mixins:["Ext.mixin.Responsive"],responsiveFormulas:{narrowScreen:"!(width >= 600 && wide)",wideScreen:"width >= 600 && wide"},layout:{type:"vbox",align:"full"},__bindings:null,__blockAppCount:0,constructor:function(){this.__bindings=[],window.cordova&&(this.bind(m.getCurrentApplication(),"APP_STATUS_BACKGROUND",this.__appInBackGround,this),this.bind(m.getCurrentApplication(),"APP_STATUS_FOREGROUND",this.__appInForeGround,this)),this.callParent(arguments)},initConfig:function(e){e.cls||(e.cls=[]),e.cls.push(this.alias[0].replace(/\./g,"-")+"-view"),this.defaultConfig.cls&&(e.cls=e.cls.concat(this.defaultConfig.cls)),this.callParent([e])},getViewLoadMask:function(){return null},__ready:function(){this.ready(),this.unblockApplication()},__appInBackGround:function(){this.onHide()},__appInForeGround:function(){m.getCurrentApplication().getCurrentView()===this&&this.onShow()},ready:function(){},restore:function(e){},blockApplication:function(e){this.__blockAppCount++;var t=this.getConsole&&this.getConsole();t&&t.showSpinner(this,e)},isApplicationBlocked:function(){return this.__blockAppCount>0},unblockApplication:function(){this.__blockAppCount--;var e=this.getConsole&&this.getConsole();this.__blockAppCount<0&&(this.__blockAppCount=0),0==this.__blockAppCount&&e&&e.hideSpinner(this)},changeView:function(e){e.consoleInstanceId=this.getConsole().getId(),e.app=this.getConsole().getAppConfig().id,this.handleMenuItems(e),this.getConsole().pushState(e)},showViewInDialog:function(e){var t=this.getConsole().createView(e.view,!0);t.__rootView=this,t.setOptions(e.options),t.__ready(),t.__dialog=m.showDialog(t,t.getDialogConfig())},getViewConfig:function(){return this._viewConfigId},getDialogConfig:function(){return{hideOnMaskTap:!0,maskTapHandler:m.proxy(this,this.done,null)}},changeConsoleApp:function(e){if(!e.app)throw"changeConsoleApp requires an app parameter";this.handleMenuItems(e),this.getConsole().pushState(e)},setViewInfo:function(e){this.handleMenuItems(e);var t=m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager"),n=t.getState();n&&n.viewInstanceId==this.getId()&&t.modifyState(e)},handleMenuItems:function(e){if(e.menuItems&&("string"==typeof e.menuItems?this.setMenuItems(this.getConsole().getMenuItems(e.menuItems)):this.setMenuItems(e.menuItems),delete e.menuItems,e.nameMenuItems)){var t=e.nameMenuItems;delete e.nameMenuItems,this.getConsole().registerMenuItems(t,this.getMenuItems())}},getOption:function(e){return this.getOptions()[e]},bind:function(e,t,n,i){this.__bindings.push({eventBus:e,eventName:t,fn:n,context:i}),e.bind(t,n,i)},unbind:function(e,t,n,i){e.unbind(t,n,i)},done:function(e){if(this.__rootView)return void this.doneDialog(e);arguments.length&&(m.getCurrentApplication().__restoreViewData={data:e,viewId:this.getViewConfigId(),viewOptions:this.getOptions()}),m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").back()},doneDialog:function(e){var t=this.__dialog,n=this.__rootView;this.getConsole().__destroyView(this),t&&t.destroy(),n&&((e||""==e)&&n.restore({data:e,viewId:this.getViewConfigId(),viewOptions:this.getOptions()}),n.fireEvent("svmx-unmasked",n))},handleHardwareBack:function(){return!1},updateStateConfig:function(e){return e},doDestroy:function(){m.array.forEach(this.__bindings,function(e){null!=e.eventBus&&e.eventBus.unbind(e.eventName,e.fn,e.context)}),this.callParent()},onShow:function(){this.callParent()},onHide:function(){this.callParent()}}),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){var i=n(90)("wks"),a=n(68),r=n(17).Symbol,o="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=o&&r[e]||(o?r:a)("Symbol."+e))}).store=i},function(e,t,n){n(723);var i=n(725),a=n(104),r=n(726),o=n(407),s=n(405),l=n(727),c=n(185),u=n(406),d=n(404),_=n(184),h=n(0).utils;h.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.uitheme","config":{"theme-defs":[]}}')),h.registerService(JSON.parse('{"id":"com.servicemax.client.cache","class-name":"com.servicemax.client.ui.components.modern.data.CacheService"}')),h.registerService(JSON.parse('{"id":"com.servicemax.client.hotkeys","class-name":"com.servicemax.client.ui.components.modern.impl.HotKeysService"}')),h.registerService(JSON.parse('{"id":"com.servicemax.client.notifications","class-name":"com.servicemax.client.ui.components.modern.notifications.NotificationManager"}')),e.exports={impl:i,data:a,notifications:r,navigation:o,popups:s,pagingtoolbar:l,controls:{signature:c,impl:u,form:d,svmxbasebutton:_}}},function(e,t,n){var i=n(46),a=Math.min;e.exports=function(e){return e>0?a(i(e),9007199254740991):0}},function(e,t,n){e.exports=!n(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(15),a=n(194),r=n(51),o=Object.defineProperty;t.f=n(26)?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),a)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){var n=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(52);e.exports=function(e){return Object(i(e))}},function(e,t,n){e.exports={default:n(656),__esModule:!0}},function(e,t,n){e.exports={default:n(663),__esModule:!0}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g=n(5).EventDispatcher;m.Package("com.servicemax.client.sfmconsole.ui");var y={name:"com.servicemax.client.sfmconsole.api"};y.AbstractConsoleApp=function(e){function t(e){(0,c.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return n.__parent=e.parent,n.__options=e.options,n.__appConfig=e.appConfig,n.__windowId=n.__generateWindowId(),n.__windowTitle=null,n.__callbackContext=null,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"__generateWindowId",value:function(e,t){return y.AbstractConsoleApp.getNextId()}},{key:"getId",value:function(){return this.__windowId}},{key:"getAppTypeId",value:function(){return this.__appConfig.app.id}},{key:"getAppConfig",value:function(){return this.__appConfig}},{key:"isSingleton",value:function(){return!this.__appConfig.multiple}},{key:"show",value:function(){m.doLater(m.proxy(this,"onShow"))}},{key:"hide",value:function(){m.doLater(m.proxy(this,"onHide"))}},{key:"isShowing",value:function(){throw"Subclass must implement isShowing"}},{key:"__start",value:function(e){this.start(e)}},{key:"start",value:function(){}},{key:"requestClose",value:function(){this.__parent.destroyConsoleApp(this)}},{key:"onCanClose",value:function(e){e(!0)}},{key:"onClose",value:function(){}},{key:"onHide",value:function(){}},{key:"onShow",value:function(){}},{key:"showLoadMask",value:function(e){this.__parent.showSpinner(e)}},{key:"hideLoadMask",value:function(e){this.__parent.hideSpinner()}},{key:"getWindowId",value:function(){return this.__windowId}},{key:"setWindowTitle",value:function(e){}},{key:"getWindowTitle",value:function(){return""}},{key:"setRootContainer",value:function(e){}},{key:"setAppInfo",value:function(e){e=e||{},this.__windowTitle=e.windowTitle,this.__parent.applyAppInfo(this,e)}}],[{key:"getNextId",value:function(){return++this.lastId}}]),t}(v),y.AbstractConsoleApp.lastId=0,y.AbstractSync=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return e.__syncManager=null,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"run",value:function(){}},{key:"connectionErrorRetry",value:function(){}},{key:"connectionErrorCancel",value:function(){}},{key:"failedErrorRetry",value:function(){}},{key:"failedErrorContinue",value:function(){}},{key:"getSyncManager",value:function(){return this.__syncManager}}]),t}(g),y.AbstractDeliveryEngine=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"init",value:function(){}},{key:"destroy",value:function(){}},{key:"getView",value:function(){return null}},{key:"initAsync",value:function(e){}},{key:"run",value:function(e){}},{key:"getInterface",value:function(){return this}}]),t}(v),y.CompositionMetaModel=function(e){function t(e,n,i){(0,c.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return a._data=e,a._parent=n,a._children={},a.isDisplayOnly=!!n&&n.isDisplayOnly,a}return(0,p.default)(t,e),(0,d.default)(t,[{key:"doCleanup",value:function(){return this.setPropertyForCleanup("_children"),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"doCleanup",this).call(this)}},{key:"getChildNode",value:function(e){return this._children[e]}},{key:"getData",value:function(){return this._data}},{key:"getRoot",value:function(){return null===this._parent?this:this._parent.getRoot()}},{key:"resolveDependencies",value:function(){}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){var i=n(48),a=n(28),r=n(79),o=n(65),s=n(78),l=function(e,t,n){var c,u,d,_=e&l.F,h=e&l.G,f=e&l.S,p=e&l.P,m=e&l.B,v=e&l.W,g=h?a:a[t]||(a[t]={}),y=g.prototype,S=h?i:f?i[t]:(i[t]||{}).prototype;h&&(n=t);for(c in n)(u=!_&&S&&void 0!==S[c])&&s(g,c)||(d=u?S[c]:n[c],g[c]=h&&"function"!=typeof S[c]?n[c]:m&&u?r(d,i):v&&S[c]==d?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(d):p&&"function"==typeof d?r(Function.call,d):d,p&&((g.virtual||(g.virtual={}))[c]=d,e&l.R&&y&&!y[c]&&o(y,c,d)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){var i=n(27),a=n(67);e.exports=n(26)?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(17),a=n(35),r=n(38),o=n(68)("src"),s=n(427),l=(""+s).split("toString");n(43).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(r(n,"name")||a(n,"name",t)),e[t]!==n&&(c&&(r(n,o)||a(n,o,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=n:s?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||s.call(this)})},function(e,t,n){var i=n(9),a=n(20),r=n(52),o=/"/g,s=function(e,t,n,i){var a=String(r(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(i).replace(o,"&quot;")+'"'),s+">"+a+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),i(i.P+i.F*a(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(91),a=n(52);e.exports=function(e){return i(a(e))}},function(e,t,n){var i=n(92),a=n(67),r=n(39),o=n(51),s=n(38),l=n(194),c=Object.getOwnPropertyDescriptor;t.f=n(26)?c:function(e,t){if(e=r(e),t=o(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return a(!i.f.call(e,t),e[t])}},function(e,t,n){var i=n(38),a=n(29),r=n(135)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var i=n(165)("wks"),a=n(122),r=n(48).Symbol,o="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=o&&r[e]||(o?r:a)("Symbol."+e))}).store=i},function(e,t){var n=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(32);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,a){return e.call(t,n,i,a)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){"use strict";var i=n(20);e.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var i=n(66),a=n(232),r=n(168),o=Object.defineProperty;t.f=n(55)?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),a)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";t.__esModule=!0;var i=n(176),a=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e,t,n){return t in e?(0,a.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){var i=n(21);e.exports=function(e,t){if(!i(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!i(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!i(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!i(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(9),a=n(43),r=n(20);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),i(i.S+i.F*r(function(){n(1)}),"Object",o)}},function(e,t,n){var i=n(44),a=n(91),r=n(29),o=n(25),s=n(151);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,d=6==e,_=5==e||d,h=t||s;return function(t,s,f){for(var p,m,v=r(t),g=a(v),y=i(s,f,3),S=o(g.length),E=0,b=n?h(t,S):l?h(t,0):void 0;S>E;E++)if((_||E in g)&&(p=g[E],m=y(p,E,v),e))if(n)b[E]=m;else if(m)switch(e){case 3:return!0;case 5:return p;case 6:return E;case 2:b.push(p)}else if(u)return!1;return d?-1:c||u?u:b}}},function(e,t,n){e.exports=!n(80)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(177),r=i(a),o=n(180),s=i(o),l=n(98),c=i(l),u=n(50),d=i(u),_=n(18),h=i(_),f=n(16),p=i(f),m=n(1),v=i(m),g=n(2),y=i(g),S=n(6),E=i(S),b=n(3),T=i(b),M=n(4),I=i(M),C=n(30),A=i(C),D=n(10),x=n(0).utils,R=n(5).SVMXObject,O=n(12).DatetimeUtil,L=n(11).Facade,k=n(130),N=n(101),w=n(7).Cache,F=n(7).ServerInfo,P=n(7).Data,q=n(102).Facade,V={name:"com.servicemax.client.sync.syncevent"},B=n(373).FileUploadStatusSoapRequest,j=V,H=F;(0,A.default)(j,k,N);var z=function(){return x.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};j.SyncEvent=function(e){function t(e,n,i){(0,y.default)(this,t);var a=(0,T.default)(this,(t.__proto__||(0,v.default)(t)).apply(this,arguments));return e=e||{},a.__name=n||"SyncEvent",a.__logger=x.getLoggingService().getLogger("SYNC-API"),a.__parent=i||a,a.__requestId=e.requestId,a.__onInfo=a.__prepareEventHandler(e.onInfo),a.__onError=a.__prepareEventHandler(e.onError),a.__onStarted=a.__prepareEventHandler(e.onStarted),a.__onProgress=a.__prepareEventHandler(e.onProgress),a.__onCompleted=a.__prepareEventHandler(e.onCompleted),a.__onRequestStarted=a.__prepareEventHandler(e.onRequestStarted),a.__onRequestCompleted=a.__prepareEventHandler(e.onRequestCompleted),a.__onConnectionWarning=a.__prepareEventHandler(e.onConnectionWarning),a.__onConnectionLoss=a.__prepareEventHandler(e.onConnectionLoss),a.__onAttachmentCompleted=a.__prepareEventHandler(e.onAttachmentCompleted),a.__clientType=x.getClient().getApplicationParameter("client-type").toLowerCase(),a.__serviceRequestCount=0,a.__objectDescribeDataConfig=a.__getObjectDescribeDataConfig(),x.getClient().getApplicationParameter("sal-native")&&(a.__nativeService=j.Utils.nativeService),a.__onStarted(a),a.__description=null,a.__syncThread=null,a.__requestMode=null,a.__resumeHandlers=null,a}return(0,I.default)(t,e),(0,E.default)(t,[{key:"__prepareEventHandler",value:function(e){var t=this.__parent,n=this;return function(i){e&&e.call(t,i,n)}}},{key:"trigger",value:function(){}},{key:"stop",value:function(){this.__syncThread=null}},{key:"pause",value:function(){this.__resumeHandlers=this.__resumeHandlers||[x.proxy(this,function(){this._complete(),this.__logger.info("::Sync Event Resuming ::"+this.getName()),this.trigger()})]}},{key:"resume",value:function(){var e=this.getSyncManager();if(this.__resumeHandlers&&this.__resumeHandlers.length>0){for(var t=null;t=this.__resumeHandlers.shift();)t.call(this);this.__resumeHandlers=null}else e.__eventConfig&&e.__eventGroup&&(e.__eventConfig.unshift(e.__eventGroup),this._complete())}},{key:"getName",value:function(){return this.__name}},{key:"getDescription",value:function(){if(this.__description)return z().T(this.__description[0],this.__description[1])}},{key:"getSyncManager",value:function(){return this.__parent&&this.__parent.__syncManager}},{key:"getSyncType",value:function(){var e=this.getSyncManager();return e?e.getSyncType():null}},{key:"getSyncThread",value:function(){return this.__syncThread||(this.__syncThread=(new Date).getTime()+1e3*Math.random()),this.__syncThread}},{key:"cleanUp",value:function(e){this.__finallyComplete=!1,this.__commonSyncCleanUp(e)}},{key:"_cleanUp",value:function(){this.__finallyComplete=!1}},{key:"isEnableLogging",value:function(){var e=this.getSyncManager()&&this.getSyncManager().isEnableLogging;return e&&e.call(this.getSyncManager())}},{key:"__getObjectDescribeDataConfig",value:function(){return[{parent_node:"fields",isNested:!0,isArray:!0,child_nodes:["autoNumber","calculated","controllerName","createable","defaultedOnCreate","dependentPicklist","label","length","name","nameField","nillable","picklistValues","precision","referenceTo","relationshipName","scale","type","updateable","unique"]},{parent_node:"recordTypeInfos",isNested:!1,isArray:!0},{parent_node:"label",isNested:!1,isArray:!1},{parent_node:"keyPrefix",isNested:!1,isArray:!1},{parent_node:"name",isNested:!1,isArray:!1},{parent_node:"labelPlural",isNested:!1,isArray:!1},{parent_node:"createable",isNested:!1,isArray:!1},{parent_node:"updateable",isNested:!1,isArray:!1},{parent_node:"deletable",isNested:!1,isArray:!1},{parent_node:"queryable",isNested:!1,isArray:!1},{parent_node:"childRelationships",isNested:!1,isArray:!0}]}},{key:"complete",value:function(){this.__finallyComplete||0!==this.__serviceRequestCount||(this.__finallyComplete=!0,this.__logger.info("::Sync Event Completed::"+this.getName()),this.__onCompleted(this))}},{key:"_complete",value:function(e){if(!this.__finallyComplete){if(this.__serviceRequestCount>0&&this.__serviceRequestCount--,"OneCallSync"===this.getName()||"TargetedSync"===this.getName())return;setTimeout(x.proxy(this,function(){this.complete()}),10)}}},{key:"_fail",value:function(){this._setState("FAILED",!0),this._complete()}},{key:"_pauseSync",value:function(){this.__parent&&this.__parent.pauseAll&&(this.pause(),this.__parent.pauseAll())}},{key:"_addResumeHandler",value:function(e){this.__resumeHandlers?this.__resumeHandlers.push(e):e.call(this)}},{key:"_initHTTPServiceRequest",value:function(e,t){this.__serviceRequestCount++,e.protocol=e.protocol||"APEXREST",e.uri=e.uri||"/services/apexrest/"+x.OrgNamespace+"/svmx/MobServiceIntf/"+e.methodName,e.method=e.method||"POST",e.data=e.data||{},e.event=this,this._addClientInfo(e);var n={syncEventName:this.getName(),requestMethodName:e.methodName,requestEventName:e.data.eventName+(e.subDesc&&e.subDesc.length?" ("+e.subDesc+")":""),requestEventType:e.data.eventType,startDate:new Date};this.__onRequestStarted(n);var i=this.getSyncThread();this._initHTTPServiceRequestInternal({request:e,lastCall:e.lastCall||t&&t.lastCall,callback:{handler:function(a,r,o){if(n.error=!!r,n.errorMessage=r||"",n.errorData=o||[{errorMsg:n.errorMessage}],this.__onRequestCompleted(n),i==this.getSyncThread()){if(void 0!==a&&t&&t.handler)try{t.handler.call(t.context||this,a,e,r,o)}catch(e){this.__logger.error("Error in HTTP Request Handler: "+e)}return this._addResumeHandler(function(){this._complete()})}},context:this}})}},{key:"__getValueByKey",value:function(e,t){for(var e=e||[],n=0;n<e.length;n++)if(e[n].key==t){var i=e[n].value;return i}return null}},{key:"__createRemainingTimeLogs",value:function(){var e=this._getState(this.__getTimeLogsCacheKey());if(null!=e&&0!=e.length){for(var t=[],n=void 0,i=0;i<e.length;i++){n=e[i];var a={attributes:{type:x.OrgNamespace+"__SVMX_Job_Logs__c"},Id:n.value};a[x.OrgNamespace+"__Call_Status__c"]="Completed",a[x.OrgNamespace+"__Client_Response_Receive_Timestamp__c"]=this.__getValueByKey(n.valueMap,"SVMX_LOG_T4"),a[x.OrgNamespace+"__Client_Response_Processing_Timestamp__c"]=this.__getValueByKey(n.valueMap,"SVMX_LOG_T5"),t.push(a)}var r={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_TIME_LOG",value:this._getClientId(),valueMap:[]}};r.data.valueMap.push({key:"SVMX_Job_Log",value:x.toJSON(t)});var o=this._getState("LAST_FAILED_REQUEST_IDS");o=o||[];var s=this;j.Utils.Cache.readFromDBCache("LAST_FAILED_REQUEST_IDS").then(x.proxy(s,function(e){e=e||[],e instanceof Array||(e=x.toObject(e)),-1!=o.indexOf(this.__requestId)&&o.splice(o.indexOf(this.__requestId),1);for(var t=0;t<e.length;t++)e[t]!=this.__requestId&&-1===o.indexOf(e[t])&&o.push(e[t]);o.length>0&&r.data.valueMap.push({key:"SVMX_Log_Failed",values:o}),this._setState("LAST_FAILED_REQUEST_IDS",[]),this._initHTTPServiceRequest(r,{handler:x.proxy(this,function(e){e=e||{},this.__logger.info("SYNC_TIME_LOG returned success:"+e.success+", message: "+e.message)})}),this.__lastFailedRequestIds&&0!==this.__lastFailedRequestIds.length||(this.__lastFailedRequestIds=""),j.Utils.Cache.writeObjectToDBCache("LAST_FAILED_REQUEST_IDS",this.__lastFailedRequestIds),this._setState(this.__getTimeLogsCacheKey(),[])}))}}},{key:"__addSyncTimeLog",value:function(e){if(!("string"==typeof e.data||e.data instanceof String||"PREINITIAL"===this.getSyncType()||"MetaSyncRequest"!==e.methodName&&"DataSyncRequest"!=e.methodName||(e.data=e.data||{},"SYNC_TIME_LOG"===e.data.eventName||"MASTER_SYNC_LOG"===e.data.eventName))){var t=[],n=this._getLogContext();t.push({key:"SVMX_LOG_T1",value:(new Date).toISOString()}),t.push({key:"SVMX_LOG_CONTEXT",value:n});var i=this._getState(this.__getTimeLogsCacheKey());if(i=i||[],i.length>0){var a=i.shift();t.push(a)}var r={key:"SVMX_TIME_LOG",valueMap:t};if(e.data.valueMap=e.data.valueMap||[],!e.data.valueMap)throw"ValueMap is undefined";if(e.data.valueMap.push(r),"MetaSyncRequest"==e.methodName&&"SYNC"==e.data.eventType&&"SFM_METADATA"==e.data.eventName)e.data.valueMap.push({key:"SYNC_REQUEST_ID",value:this._getClientId()});else{var o=e.data.value;if(o){if(o!=this._getClientId())throw"request.data.value is not the same as clientId."}else e.data.value=this._getClientId()}}}},{key:"_getLogContext",value:function(){var e="INCREMENTAL DATA SYNC";switch(this.getSyncType()){case"ONECALLSYNC":case"PURGE":e="INCREMENTAL DATA SYNC";break;case"CONFIG":e="CONFIG SYNC";break;case"INITIAL":e="INITIAL SYNC"}return e}},{key:"_initHTTPServiceRequestInternal",value:function(e){var t=this.__parent,n=e.request,i=e.callback,a=e.lastCall;this._createHTTPServiceRequest(n,function(n,r){var o="("+this.__name+") "+r.method+" "+r.uri+(r.methodName?" ("+r.methodName+")":""),s=r.data.eventName||r.data.methodName;s=s?":"+s:"",n.bind("REQUEST_COMPLETED",function(n){var l=n.data.data,c=this.__handleReceivedTimeLogging(l);this.__logger.debug("(HTTP Response) "+o+" "+l);var u=null,d=null;if("REST"===r.protocol||"APEXREST"===r.protocol){if("string"==typeof l&&x.toObject(l)===l){u=this.getName()+" Response data structure: invalid";return d=[{errorMsg:u},{errorMsg:"Event name: "+(r.data.eventName||r.data.methodName||r.endPoint||"Unknown")}],this._setState("ERROR_MESSAGE",u),this._setState("ERROR_DATA",d),this.__onError(u),void this._retryHTTPServiceRequest(e,!1,u,d)}}if("WSSOAP"===r.protocol&&"string"==typeof l){var _=x.stringToXML(l);if(_){var h=x.xmlToJson(_);h&&h.Envelope&&h.Envelope.Body&&h.Envelope.Body.Fault&&h.Envelope.Body.Fault.faultstring&&(n.data.data={success:!1,errors:[h.Envelope.Body.Fault.faultstring]})}}if(n.data.data&&!1===n.data.data.success)return u="Event name: "+(r.data.eventName||r.data.methodName||r.endPoint||"Unknown"),d=n.data.data.errors||[],n.data.data.errors&&0==n.data.data.errors.length&&(d=[{errorMsg:n.data.data.message||"Unexpected Error: "+s},{errorMsg:u}]),this.__onError(u),l=!1,void this._retryHTTPServiceRequest(e,!1,u,d);i&&i.handler.call(i.context||t,l||{},u,d),this.__handleProcessedTimeLogging(c),a&&this.__createRemainingTimeLogs()},this),n.bind("REQUEST_ERROR",function(t){var n=t.data.data||"Unknown",i=t.data.data,a=(this.__handleReceivedTimeLogging(i),"Event name: "+(r.data.eventName||r.data.methodName||r.endPoint||"Unknown")),o=[{errorMsg:n}];this.__onError(a);var s=t.data.headers,l=!s||!s.status||-1!==n.indexOf("UNKNOWN_EXCEPTION"),c={};try{c=JSON.parse(n)}catch(e){}if(x.getClient().isLaptop()||c.StatusCode||c.status&&"string"!=typeof c.status&&(c.StatusCode=c.status),c.StatusCode?"string"!=typeof c.StatusCode&&(c.StatusCode=c.StatusCode.toString()):c.StatusCode="-1",!(l=l&&c&&c.StatusCode&&"4"!==c.StatusCode.charAt(0)&&"5"!==c.StatusCode.charAt(0))){var u="",d="";if(void 0!==c.ResponseBody)if("WSSOAP"===r.protocol&&"string"==typeof c.ResponseBody){var _=x.stringToXML(c.ResponseBody);if(_){var h=x.xmlToJson(_);h&&h.Envelope&&h.Envelope.Body&&h.Envelope.Body.Fault&&h.Envelope.Body.Fault.faultstring&&(d=h.Envelope.Body.Fault.faultstring)}}else{var f=JSON.parse(c.ResponseBody);void 0!==f[0].errorCode&&(u=f[0].errorCode),void 0!==f[0].message&&(d=f[0].message)}else if(!x.getClient().isLaptop()){var p=x.toObject(c.error);u=p[0]&&void 0!==p[0].errorCode?p[0].errorCode:"-1"!==c.StatusCode?c.StatusCode:"Unknown",p[0]&&void 0!==p[0].message?(d=p[0].message,n=d):(d="Unknown",n="Unknown")}var m="Event name: "+(r.data.eventName||r.data.methodName||r.endPoint||"Unknown");o=[{errorMsg:"Error message : "+(d||r.data.methodName)},{errorMsg:"Error code : "+u}],this._setState("ERROR_MESSAGE",m),this._setState("ERROR_DATA",o),this.__onError(m)}this._retryHTTPServiceRequest(e,l,a,o)},this),this.__onInfo("(HTTP) "+o),"INCREMENTAL DATA SYNC"==this._getLogContext()&&!this.isEnableLogging()||r&&r.data&&r.data.eventName&&"SYNC_SALESFORCE_FILES"===r.data.eventName||this.__addSyncTimeLog(r),n.execute(r)})}},{key:"__handleReceivedTimeLogging",value:function(e){if("INCREMENTAL DATA SYNC"!=this._getLogContext()||this.isEnableLogging()){var t=this.__getTimeLogId(e),n=[];if(null!=t){n.push({key:"SVMX_LOG_T4",value:(new Date).toISOString()});return{key:"SVMX_LOG_ID",value:t,valueMap:n}}}return null}},{key:"__handleProcessedTimeLogging",value:function(e){if(null!=e){e.valueMap=e.valueMap||[],e.valueMap.push({key:"SVMX_LOG_T5",value:(new Date).toISOString()});var t=this._getState(this.__getTimeLogsCacheKey());t||(t=[],this._setState(this.__getTimeLogsCacheKey(),t)),t.push(e)}}},{key:"_addClientInfo",value:function(e){e.data=e.data||{};var t=x.getClientTypeForUnifiedApp(),n=x.getClient().ClientVersion||x.getClient().getApplicationParameter("app-version");e.data.clientInfo=[{clientType:t,clientInfo:["appversion:"+n,"appname:SVMX_"+t,"userid:"+this._getUserId(),"clientudid:"+this._getClientUuid(),"syncstarttime:"+this._getState("SYNC_START_TIME")]}]}},{key:"__getTimeLogsCacheKey",value:function(){return"LAST_REQ_TIME_LOGS"}},{key:"__getTimeLogId",value:function(e){for(var t=e.valueMap||[],n=0;n<t.length;n++)if("SVMX_LOG_ID"==t[n].key){var i=t[n].value;return t.splice(n,1),i}return null}},{key:"_createHTTPServiceRequest",value:function(e,t){var n=this.__nativeService.createHTTPRequest();switch(e.protocol){case"SOAP":this.getUserInfo(function(i){var a=new window.com.servicemax.client.sal.impl.SoapRequest({sessionId:i.UserSessionId,apiVersion:x.getClient().getApplicationParameter("salesforce-api-version")}),r=new window.com.servicemax.client.sal.impl.RPRuntimeMode;e.uri=r.getSoapUrl("",a._options.apiVersion),e.data=a._getData(e.soapData,e),e.headers={SOAPAction:e.methodName,"Content-Type":"text/xml"},t.call(this,n,e)});break;case"ATTACHMENTSOAP":this.refreshUserInfoForCustomWebService(function(i){i||(i=window.external.getOauthCredentials?window.external.getOauthCredentials().session_id:x.getCurrentApplication().getUserInfo().UserSessionId);var a=new B({sessionId:i,apiVersion:x.getClient().getApplicationParameter("salesforce-api-version")}),r=new window.com.servicemax.client.sal.impl.RPRuntimeMode;e.uri=r.getSoapUrl("",a._options.apiVersion),e.data=a._getData(e.soapData,e),e.headers={"Content-Type":"text/xml",SOAPAction:'""'},t.call(this,n,e)});break;case"REST":this.getUserInfo(function(i){var a=new window.com.servicemax.client.sal.impl.RestRequest({sessionId:i.UserSessionId,apiVersion:"v24.0"}),r=new window.com.servicemax.client.sal.impl.RPRuntimeMode;e.method="GET",e.uri=r.getUrl(e.restUrl,a._options.apiVersion),e.data="",e.headers={"Content-Type":"application/json"},t.call(this,n,e)});break;case"WSSOAP":this.refreshUserInfoForCustomWebService(function(i){i||(i=window.external.getOauthCredentials?window.external.getOauthCredentials().session_id:x.getCurrentApplication().getUserInfo().UserSessionId);var a=new window.com.servicemax.client.sal.impl.WSSoapRequest({sessionId:i,endPoint:e.endPoint}),r=new window.com.servicemax.client.sal.impl.RPRuntimeMode;e.uri=r.getApexSoapUrl(e.endPoint),e.data=a._getData(e.soapData,e),e.headers={SOAPAction:e.methodName,"Content-Type":"text/xml"},t.call(this,n,e)});break;case"APEXREST":default:t.call(this,n,e)}}},{key:"_retryHTTPServiceRequest",value:function(e,t,n,i){this.__stopped||(!t&&(e.request.canFail||this._getState("FAILED")||e.requestAttempts>=3)?(e.callback&&e.callback.handler.call(e.callback.context||parent,null,n,i),!!e.request.canFail||this._fail()):this._checkConnectivity(function(n){if(n&&e.connectAttempts>=5&&(this.__onError("Retry count 5 exceeds; time to stop the sync"),this.__onConnectionWarning(),e.connectAttempts=0,n=!1),n)t?(e.connectAttempts=e.connectAttempts||1,e.connectAttempts++,this.__onInfo("Connection error. Retrying failed request...")):(e.requestAttempts=e.requestAttempts||1,e.requestAttempts++,this.__onInfo("Server error. Retrying failed request...")),this._initHTTPServiceRequestInternal(e);else{if(e.request.canFail)return;this._pauseSync(),this.__onConnectionLoss("Connection Lost"),this.__onInfo("Not connected, sync event paused...")}}))}},{key:"_checkConnectivity",value:function(e){var t=this.__nativeService.createConnectivityRequest();t.bind("REQUEST_COMPLETED",function(t){var n=t.data.data.toLowerCase(),i="true"===n;e&&e.call(this,i)},this),t.bind("REQUEST_ERROR",function(t){e&&e.call(this,!1)},this),t.execute()}},{key:"__createHTTPServiceRequest",value:function(e){x.getClient().getServiceRegistry().getService("com.servicemax.client.sal.service.factory").getInstanceAsync({handler:function(t){var n=e.options||{},i={type:n.type||"APEXREST",endPoint:n.endPoint||"MobServiceIntf",nameSpace:null===n.namespace?null:x.OrgNamespace},a=t.createServiceManager(i),r=a.createService();r.callMethodAsync=function(e){var t=e.uri,n=e.method||"POST",i=!0;void 0!=e.async&&(i=e.async);var a=new window.com.servicemax.client.sal.impl.ApexRestRequest({sessionId:this._parent.params.sessionId,apiVersion:this.apiVersion});a._getUrl=function(){return t},a.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),a.bind("REQUEST_ERROR",this._callMethodAsyncError,this),a.callAsync({method:n,data:e.data,async:i})},e.handler.call(e.context,r)},context:this})}},{key:"_unSyncronizedSQLServiceRequest",value:function(e,t){var n=this.__nativeService.createSQLRequest();n.bind("REQUEST_COMPLETED",function(e){var n=e.data.data||[];t&&t.handler.call(t.context||this,n)},this),n.bind("REQUEST_ERROR",function(n){var i="SQL Request failed: "+e.query;this.__onError(i),t&&t.handler.call(t.context||this,[],i)},this),n.execute({query:e.query,queryArray:e.queryArray,doRollBack:!1})}},{key:"_initSQLServiceRequest",value:function(e,t){var n=D.Deferred();return this.__serviceRequestCount++,e.binds&&(e.query=j.SQLSchema.bindSQLParams(e.query,e.binds)),void 0===e.dbSync&&(e.dbSync="default"),this._synchronize(e.dbSync,function(i){var a=this.__nativeService.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){i.call(this);var a=e.data.data||[];n.resolve(a),t&&t.handler.call(t.context||this,a),this._complete()},this),a.bind("REQUEST_ERROR",function(a){i.call(this);var r="SQL Request failed: "+e.query;this.__onError(r),n.resolve([],r),t&&t.handler.call(t.context||this,[],r),this._complete()},this),a.execute({query:e.query,queryArray:e.queryArray,queryParams:e.queryParams,doRollBack:e.doRollBack||!1})}),n}},{key:"_initNativeServiceRequest",value:function(e,t,n){var i=x.Deferred();this.__serviceRequestCount++;var a=this.__nativeService.createRequest(e+"Request");return a.bind("REQUEST_COMPLETED",function(e){i.resolve(e.data.data),n&&n.handler&&n.handler.call(n.context||this,e.data.data),this._complete()},this),a.bind("REQUEST_ERROR",function(a){var r=e+" Request failed: "+x.toJSON(t);this.__onError(r),i.resolve(null,r),n&&n.handler&&n.handler.call(n.context||this,null,r),this._complete()},this),a.execute(t),i}},{key:"_getState",value:function(e){return this.__parent.getState(e)}},{key:"_setState",value:function(e,t){return this.__parent.setState(e,t)}},{key:"_getClientId",value:function(){return this._getState("clientId")||this._setState("clientId",this.__requestId),this._getState("clientId")}},{key:"_getClientUuid",value:function(){return x.getClient().getApplicationParameter("client-uuid")}},{key:"_getUserId",value:function(){var e=x.getCurrentApplication().getUserInfo(),t=this._getState("USER_INFO"),n="";return e&&e.UserId?n=e.UserId:t&&t.UserId?n=t.UserId:n||this.__onInfo("User Id not present in SVMX.getCurrentApplication().getUserInfo() or this._getState('USER_INFO')"),n}},{key:"_hasClientId",value:function(){return!!this._getState("clientId")}},{key:"_isTableInDatabase",value:function(e){return!!j.Utils.MetaData.getTablesInDatabase()[e]}},{key:"_isDataSync",value:function(){return this.getSyncManager().isDataSync(this.getSyncType())}},{key:"_isInitialSync",value:function(){return this.getSyncManager().isInitialSync(this.getSyncType())}},{key:"_isConfigSync",value:function(){return this.getSyncManager().isConfigSync(this.getSyncType())}},{key:"_registerTableInDatabase",value:function(e){return j.Utils.MetaData.registerNewTableInDatabase(e)}},{key:"_synchronize",value:function(e,t){if(null===e&&(e="Sync_"+Math.random().toString()),this.__syncBuffer=this.__syncBuffer||{},this.__syncBuffer[e]=this.__syncBuffer[e]||[],this.__syncBuffer[e].length>0)this.__syncBuffer[e].push(t);else{this.__syncBuffer[e]=[t];(function t(){var n=this.__syncBuffer[e][0];n?n.call(this,function(){this.__syncBuffer[e].shift(),t.call(this)}):delete this.__syncBuffer[e]}).call(this)}}},{key:"_insertRecord",value:function(e,t,n,i){this._ensureSObjectTableExists(e,!0,function(a){var r=1;n&&(t instanceof Array||(t=x.array.map(t,function(e){return e})),r=t.length),this.__onInfo("(SQL) Insert "+r+" record"+(1===r?"":"s")+" into "+a),t=this._convertRecordFieldTypes(e,t,n);var o=j.SQLSchema.getInsertQuery(e,t,n,a);this._initSQLServiceRequest({query:o},i)})}},{key:"_insertReplaceRecord",value:function(e,t,n,i,a){var r=x.Deferred(),o=[];return t instanceof Array?x.array.forEach(t,function(e){o.push(e)}):o=t,this._ensureSObjectTableExists(e,!i,function(t){var i=1;n?(o instanceof Array||(o=x.array.map(o,function(e){return e})),i=o.length):o=[o];for(0===o.length&&(a&&a.call(this),r.resolve());o&&o.length>0;){var s=o.splice(0,100);s=this._convertRecordFieldTypes(e,s,n);var l=j.SQLSchema.getInsertReplaceQuery(e,s,!0,t),i=s.length;this.__onInfo("(SQL) Insert/Replace "+i+" record"+(1===i?"":"s")+" into "+t),function(e){this._initSQLServiceRequest({query:l},{handler:function(){0===e&&(a&&a.call(this),r.resolve())}})}.call(this,o.length)}}),r}},{key:"_insertReplaceRecordIncremental",value:function(e,t,n,i){return this._insertReplaceRecord(e,t,n,!0,i)}},{key:"_insertRecordIncremental",value:function(e,t,n){var i=x.Deferred(),a=[];return t instanceof Array?x.array.forEach(t,function(e){a.push(e)}):a.push(t),this._ensureSObjectTableExists(e,function(e){for(var t="SELECT 1 FROM `"+e+"` WHERE Id = {{Id}}";a.length>0;){var r=a.splice(0,1).pop(),o={query:t,binds:{Id:r.Id}};(function(t,a){this._initSQLServiceRequest(o,{handler:function(r){if(r&&r[0])return void(0===a&&(n&&n.call(this),i.resolve()));t=this._convertRecordFieldTypes(e,t);var o=j.SQLSchema.getInsertQuery(e,t);this.__onInfo("(SQL) Insert 1 record into "+e),this._initSQLServiceRequest({query:o},{handler:function(e){i.resolve(),0===a&&(n&&n.call(this),i.resolve())}})}})}).call(this,r,a.length)}}),i}},{key:"_updateRecord",value:function(e,t,n,i){var a=x.Deferred();return this._ensureSObjectTableExists(e,function(e){t=this._convertRecordFieldTypes(e,t,!1);var r=j.SQLSchema.getUpdateQuery(e,t,n);this.__onInfo("(SQL) Update 1 record in "+e),this._initSQLServiceRequest({query:r},{handler:function(e){i&&i.call(this,e),a.resolve()}})}),a}},{key:"_updateRecordIncremental",value:function(e,t,n){var i=x.Deferred();return this._ensureSObjectTableExists(e,function(a){this._insertRecordIncremental(e,t,function(e){if(!1===e){t=this._convertRecordFieldTypes(a,t,!1),t=this._setUndefinedRecordFieldValues(a,t);var r=j.SQLSchema.getUpdateQuery(a,t,t.Id);this.__onInfo("(SQL) Update 1 record in "+a),this._initSQLServiceRequest({query:r},{handler:function(e){n&&n.call(this,e),i.resolve()}})}else n&&n.call(this),i.resolve()})}),i}},{key:"_bufferRecordNames",value:function(e){if(e&&e.length){for(var t=this._getState("RECORD_NAME_VALUES")||{},n=this._getState("RECORD_NAME_COUNTER")||0,i=0;i<e.length;i++)for(var a in e[i])if(e[i][a]){var r=e[i][a].Id,o=null;if(r)for(var s in e[i][a])"Id"!==s&&"attributes"!==s&&(o=e[i][a][s]);r&&o&&!t[r]&&(t[r]={Id:r,Name:o},n++)}this._setState("RECORD_NAME_VALUES",t),this._setState("RECORD_NAME_COUNTER",n),n>=1e3&&this._flushRecordNames()}}},{key:"_flushRecordNames",value:function(e){var t=this,n=this._getState("RECORD_NAME_VALUES");if(this._getState("RECORD_NAME_COUNTER")>0){var i,i;!function(){var a="SFRecordName";t._tempTableCreated("SFRecordName")&&(a=t._getTempTableName(a));var r=[];i=0;for(var o in n)void 0===r[i]&&(r[i]=[]),r[i].push(n[o]),r[i].length>=100&&i++;var s=0;for(i=0;i<r.length;i++){var l=r[i].length;l&&(s++,t.__onInfo("(SQL) Insert "+l+" record"+(1===l?"":"s")+" into "+a),t._initSQLServiceRequest({query:j.SQLSchema.getInsertReplaceQuery("SFRecordName",r[i],!0,a)},{handler:function(){s--,e&&0===s&&e.call(this)}}))}t._setState("RECORD_NAME_VALUES",{}),t._setState("RECORD_NAME_COUNTER",0),0===s&&e.call(t)}()}else e&&e.call(this)}},{key:"_deleteRecord",value:function(e,t,n){var i=x.Deferred(),a="string"!=typeof t&&"length"in t,r=a?t.length:1;if(0===r)return i.resolve(),n&&n.call(this,null);this.__onInfo("Deleting "+r+" record"+(1==r?"":"s")+" from "+e);var o=["DELETE FROM","["+e+"]","WHERE Id",a?"IN('"+t.join("','")+"')":"= {{whereId}}"].join(" "),s={query:o,binds:{whereId:t}};return this._initSQLServiceRequest(s,{handler:function(e){return i.resolve(),n&&n.call(this,e)}}),i.promise()}},{key:"_deleteRecordById",value:function(e,t){if(this.__tableNamesByKey=this.__tableNamesByKey||{},this.__tableNamesByKey[n])return this._deleteRecord(this.__tableNamesByKey[n],e,t);if("attach"===e.substring(0,6))return this._deleteRecord("SFAttachments",e,t);var n=e.substring(0,3);this._describeObjectByKeyPrefix(n,function(i,a){if(a){var r=a.name;this.__tableNamesByKey[n]=r,this._deleteRecord(r,e,t)}else this.__logger.debug("Unable to describe Object by key: "+i),this._complete()})}},{key:"_getSyncRecords",value:function(e,t,n){var i="SELECT * FROM ClientSyncLog WHERE operation = {{op}}"+(n?" AND Id IN ('"+n.join("','")+"')":"");"insert"===e&&(i+=" AND record_type != 'attachment'");var a={query:i,binds:{op:e}};this._initSQLServiceRequest(a,{handler:function(n){n=n||[],this._getSyncRecordResults(n,e,t)}})}},{key:"_getSyncRecordResults",value:function(e,t,n){var i={ids:[],records:{},describe:{},parents:{},byObject:{},byType:{},byOrder:[],syncLogRecords:{},oldRecords:{}};if(0===e.length)return void this._getSyncRecordValues(i,t,n);for(var a=e.length,r=0;r<e.length;r++){var o=e[r].Id,s=e[r].record_type||"master",l=e[r].parent_id,c=o.substring(0,3);i.ids.push(o),i.records[o]={},i.parents[o]=l,i.byObject[c]=i.byObject[c]||{},i.byObject[c][o]=i.records[o],i.byType[s]=i.byType[s]||{},i.byType[s][o]=i.records[o],i.oldRecords[o]={},i.syncLogRecords[o]=e[r],this._describeObjectByKeyPrefix(c,function(e,r){i.describe[e]=r||{},0===--a&&this._getSyncRecordValues(i,t,n)})}}},{key:"_getSyncRecordValues",value:function(e,t,n){var i={},a=0;if(0===(0,p.default)(e.byObject).length)return void this._getSyncRecordOrdering(e,n);for(var r in e.byObject){var o=e.describe[r],s="Event"===o.name;if(i[r]={},o.fields)for(var l=0;l<o.fields.length;l++){var c=o.fields[l];i[r][c.name]=c}var u=o.name;for(var d in e.byObject[r]){a++;var _=e.syncLogRecords[d],h=null,f=null;_.old_values&&(h=x.toObject(_.old_values))&&h.Id&&this._parseRecord(h,e.oldRecords,i,s,!1,!0),_.new_values&&(f=x.toObject(_.new_values));var m=this;this._processRecord(t,e,i,s,d,h,f,u,function(){0===--a&&m._getSyncRecordOrdering(e,n)})}}}},{key:"_processRecord",value:function(e,t,n,i,a,r,o,s,l){this._getRecord(s,a,function(a){if(a&&a[0]){var r=a[0],s="insert"===e;if(!s){if(this._getState("IsFieldMergeEnabled")&&o&&o.Id)for(var c in r)c in o||delete r[c]}this._parseRecord(r,t.records,n,i,s,!1)}l.call()})}},{key:"_parseRecord",value:function(e,t,n,i,a,r){var o=e.Id.substring(0,3),s=void 0,l=t[e.Id],c=this._getState("MAP_REMOTE_IDS")||{};for(var u in e)if(n[o][u]){var d=n[o][u].type,_=n[o][u].updateable;if(!_&&"id"!=d&&"reference"!=d)continue;if(a&&(null===e[u]||""===e[u]))continue;"date"===d&&(""!==e[u]&&null!==e[u]||(e[u]="")),"datetime"===d&&(""!==e[u]&&null!==e[u]||(e[u]="")),"reference"===d&&(s=e[u])&&s in c&&(e[u]=c[s]),"int"===d&&(s=e[u],null===s&&(s=""),""!==s&&"0"!==s||(r||""!==s)&&(s="0"),e[u]=new String(s).valueOf()),"double"!==d&&"currency"!==d&&"percent"!==d||(s=e[u],null===s&&(s=""),""!==s&&"0"!==s||(r||""!==s)&&(s="0.0"),null!==s&&""!==s&&"null"!==s&&(s=new String(s).valueOf(),s.indexOf(".")<=0&&(s+=".0")),e[u]=s),"CurrencyIsoCode"==u&&""==e[u]?this.__logger.info("Not sending CurrencyIsoCode field because its empty and server is sensitive to empty values for this field"):l[u]=e[u]}i&&(delete l.ActivityDateTime,delete l.DurationInMinutes,delete l.RecurrenceInterval,delete l.RecurrenceDayOfWeekMask,delete l.RecurrenceDayOfMonth)}},{key:"_getSyncRecordOrdering",value:function(e,t){for(var n in e.byObject)for(var i in e.byObject[n]){var a=e.parents[i],r=0;do{var o=e.records[a],s=o&&e.parents[o.Id];s&&(r++,a=s)}while(s&&s!=i);for(var l in e.byType)a=e.parents[i],e.byOrder[r]=e.byOrder[r]||{},e.byOrder[r][l]=e.byOrder[r][l]||{},e.byType[l][i]?e.byOrder[r][l][i]=e.records[i]:"master"==l&&e.records[a]&&(e.byOrder[r][l][a]=e.records[a])}t.call(this,e)}},{key:"_getSyncRecordsByObjectOrder",value:function(e,t){this._getSyncRecords(e,function(e){var n=this,i=function(i,a){var a=x.cloneObject(a);!function r(){var o=a.shift();o?t.call(n,i,o,e,"ONE_CALL_SYNC",function(){r()}):a.length>0&&r()}()};for(var a in e.byObject){for(var r=e.describe[a].name,o=[],s=0;s<e.byOrder.length;s++)for(var l in e.byOrder[s])for(var c in e.byOrder[s][l])c in e.byObject[a]&&(o[s]=o[s]||{},o[s][c]=e.byOrder[s][l][c]);i.call(this,r,o)}})}},{key:"_deleteSyncRecord",value:function(e,t){return t?this._deleteRecord("ClientSuccSyncLog",e):this._deleteRecord("ClientSyncLog",e)}},{key:"_getSyncConflicts",value:function(e,t){"function"==typeof e&&(t=e,e=null);var n={query:"SELECT * FROM ClientSyncConflict"};e&&(n.query+=" WHERE operation = {{op}}",n.binds={op:e}),this._initSQLServiceRequest(n,{handler:function(e){e=e||[];for(var n={},i=0;i<e.length;i++)n[e[i].Id]=e[i];t.call(this,n)}})}},{key:"_deleteSyncConflict",value:function(e){return this._deleteRecord("ClientSyncConflict",e)}},{key:"_insertUpdateSyncConflict",value:function(e){for(var t=this,n=e.Id instanceof Array?e.Id:[e.Id],i=0;i<n.length;i++)!function(i){t.__getParentIdForConflictRecord(n[i],function(a){e.Id=n[i],e.parent_id=a,t.__insertUpdateSyncConflictParts(x.cloneObject(e))})}(i)}},{key:"__getParentIdForConflictRecord",value:function(e,t){var n={query:"SELECT parent_id FROM ClientSyncLog WHERE Id = '"+e+"' "};this._initSQLServiceRequest(n,{handler:function(e){if(e&&e[0]){var n=e[0].parent_id;t&&t.call(this,n)}else t&&t.call(this,null)}})}},{key:"__insertUpdateSyncConflictParts",value:function(e){if(e.Id){var t={query:"SELECT 1 FROM ClientSyncConflict WHERE Id = {{Id}} AND operation = {{op}}",binds:{Id:e.Id,op:e.operation}};this._initSQLServiceRequest(t,{handler:function(t){var n=null;e.override_flag="",n=t&&t[0]?j.SQLSchema.getUpdateQuery("ClientSyncConflict",e):j.SQLSchema.getInsertQuery("ClientSyncConflict",e),this._initSQLServiceRequest({query:n})}})}}},{key:"_insertUpdateSyncRecord",value:function(e){var t=D.Deferred(),n={query:"SELECT 1 FROM ClientSyncLog WHERE Id = {{Id}} AND operation = {{op}}",binds:{Id:e.Id,op:e.operation}};return this._initSQLServiceRequest(n,{handler:function(n){var i=null;e.modified_at=O.getCurrentDatetimeGMT(O.getSaveFormat("dateTime")),i=n&&n[0]?j.SQLSchema.getUpdateQuery("ClientSyncLog",e):j.SQLSchema.getInsertQuery("ClientSyncLog",e),this._initSQLServiceRequest({query:i},{handler:function(){t.resolve()}})}}),t}},{key:"_filterGetUpdateObjectReqs",value:function(e,t){this._getSyncConflicts("update",function(n){for(var i=(j.Utils.SyncData.getOpenRecords(),0);i<e.length;i++){for(var a=[],r=0;r<e[i].values.length;r++){var o=e[i].values[r];n[o]||a.push(o)}e[i].values=a}t.call(this,e)})}},{key:"_describeObjectByName",value:function(e,t){function n(n){if(x.getCurrentApplication().getSyncImpl().isDataSyncRunning()){j.SQLSchema.addSObjectSchema(n);var a="SFObjectDescribe";if(this._tempTableCreated(e)&&(a=x.getTempTableName("SFObjectDescribe")),this._isTableInDatabase("SFObjectDescribe"))if(!this._getState("DESCRIBED."+e)&&n){this._setState("DESCRIBED."+e,!0);var r=this.__getOptimizedDescribe(n),o=x.string.substitute("INSERT INTO {{objectName}} (object_name, object_describe, key_prefix, label) VALUES('{{object_name}}', '{{object_describe}}', '{{key_prefix}}', '{{label}}')",{objectName:a,object_name:n.name,object_describe:x.toJSON(r),key_prefix:n.keyPrefix,label:n.label});this._initSQLServiceRequest({query:o},{handler:function(){t.call(i,e,n)}})}else t.call(i,e,n);else t.call(i,e,n)}else t.call(i,e,n)}var i=this;j.Utils.MetaData.describeObject({objectName:e,onSuccess:function(a){a?t.call(i,e,a):i._describeObject(e,n)},onError:function(t){i._describeObject(e,n)}})}},{key:"_describeObjectByKeyPrefix",value:function(e,t){var n=this;n.__serviceRequestCount++,j.Utils.MetaData.getObjectNameFromKeyPrefix({key_prefix:e,onSuccess:function(i){if(n.__serviceRequestCount--,!i)return void t.call(n,e);n.__serviceRequestCount++,j.Utils.MetaData.describeObject({objectName:i,onSuccess:function(i){var a=void 0;i&&(a=i?{name:i.name,fields:i.fields?x.array.map(i.fields,function(e){return{name:e.name,type:e.type,updateable:e.updateable}}):[]}:null),n.__serviceRequestCount--,t.call(n,e,a)},onError:function(a){n.__serviceRequestCount--,t.call(n,e),n.__logger.error("Describe Object Failed for "+i)}})},onError:function(i){n.__serviceRequestCount--,t.call(n,e),n.__logger.error("Describe Object Failed for "+objectName)}})}},{key:"_getDoDRecord",value:function(e,t,n){var i="SELECT * FROM Attachment WHERE Id = '"+e+"'";t&&(i="SELECT ContentVersion.Id, ContentVersion.Title as Name, ContentDocumentLink.LinkedEntityId as ParentId, ContentVersion.CreatedById, ContentVersion.Description, ContentVersion.FileExtension as ContentType, ContentVersion.ContentSize as BodyLength, ContentVersion.LastModifiedDate FROM ContentVersion LEFT JOIN ContentDocumentLink ON ContentDocumentLink.ContentDocumentId = ContentVersion.ContentDocumentId WHERE ContentVersion.Id = '"+e+"'");var a={query:i};this._initSQLServiceRequest(a,{handler:n})}},{key:"_getRecord",value:function(e,t,n){if(!e)return this.__serviceRequestCount++,x.doLater(function(){this.__serviceRequestCount--,n&&n.call(this,null)},this);var i={query:"SELECT * FROM `"+e+"` WHERE Id = {{Id}}",binds:{Id:t}};this._initSQLServiceRequest(i,{handler:n})}},{key:"_getRecords",value:function(e,t){if(!e)return t&&t.call(this,null);var n={query:"SELECT * FROM `"+e+"`"};this._initSQLServiceRequest(n,{handler:t})}},{key:"_getRecordsByIds",value:function(e,t,n){var i={query:"SELECT * FROM `"+e+"` WHERE Id IN('"+t.join("','")+"')"};this._initSQLServiceRequest(i,{handler:n})}},{key:"_convertRecordFieldTypes",value:function(e,t,n){var i=j.SQLSchema.getTableSchema(e);n||(t=[t]);for(var a=0;a<t.length;a++)for(var r in t[a])if(i.fields[r]){var o=t[a][r];"object"!==(void 0===o?"undefined":(0,h.default)(o))?("datetime"==i.fields[r].sftype&&(t[a][r]=this._convertRecordFieldTypeDatetime(o)),"boolean"==i.fields[r].sftype&&(t[a][r]=o&&"false"!==o?"true":"false")):delete t[a][r]}return n?t:t[0]}},{key:"_convertRecordFieldTypeDatetime",value:function(e){var t=e;if("string"==typeof e&&e.match(/T/)){var n=e.split("T"),i=n[0].split("-"),a=n[1].split("."),r=a[0].split(":");t=[i[0],i[1],i[2]].join("-")+" "+[r[0],r[1],r[2]].join(":")}return t}},{key:"_setUndefinedRecordFieldValues",value:function(e,t){var n=j.SQLSchema.getTableSchema(e);if(n)for(var i in n.fields)void 0!==n.fields[i].sftype&&void 0===t[i]&&(t[i]="");return t}},{key:"_insertMetadata",value:function(e,t,n){var i=[],a=this;if(a.callback=n,t instanceof Array)x.array.forEach(t,function(e){i.push(e)});else for(var r in t)i.push(t[r]);this._countRecordsSynced(i),this._ensureTempTableExists(e,function(t){for(;i&&i.length>0;){var n=i.splice(0,100),r=j.SQLSchema.getInsertReplaceQuery(e,n,!0,t),o=n.length;this.__onInfo("(SQL) Insert "+o+" record"+(1===o?"":"s")+" into "+t),this._initSQLServiceRequest({query:r},a.callback)}})}},{key:"_insertUpdateMetadata",value:function(e,t,n,i,a){this._ensureTempTableExists(e,function(i){var a=j.SQLSchema.getSelectQuery(e,n,null,i);this._initSQLServiceRequest({query:a},{handler:function(a){if(a&&a[0]){var r=j.SQLSchema.getUpdateQuery(e,t,n,i);this.__onInfo("(SQL) Update 1 record in "+i+" ("+t.object_name+")"),this._initSQLServiceRequest({query:r})}else{var o=j.SQLSchema.getInsertQuery(e,t,!1,i);this.__onInfo("(SQL) Insert 1 record in "+i+" ("+t.object_name+")"),this._initSQLServiceRequest({query:o})}},context:this})})}},{key:"_getTempTableName",value:function(e){return"TEMP__"+e}},{key:"_tempTableCreated",value:function(e,t){if(void 0===t)return void 0!==e?this._getState("SQL.SCHEMA_TEMP_TABLES."+e):this._getState("SQL.SCHEMA_TEMP_TABLES");var n=this._getState("SQL.SCHEMA_TEMP_TABLES")||{};n[e]=t,this._setState("SQL.SCHEMA_TEMP_TABLES",n),this._setState("SQL.SCHEMA_TEMP_TABLES."+e,t)}},{key:"_createTable",value:function(e,t,n){"function"==typeof t&&(n=t,t=e),this.__onInfo("(SQL) Create table "+t);var i=j.SQLSchema.getCreateQuery(e,t);i="DROP TABLE IF EXISTS `"+t+"`; "+i,this.__serviceRequestCount++;this._initSQLServiceRequest({query:i}).then(x.proxy(this,function(){this._registerTableInDatabase(t),this.__serviceRequestCount--,n&&n.call(this)}))}},{key:"_createIndexForTable",value:function(e){var t=this._tempTableCreated();if(t){var n=Date.now(),i=[];for(var a in t)if("SfmWebServiceActionsLog"!==a){var r=a+"__0",o="CREATE UNIQUE INDEX IF NOT EXISTS "+r+" ON '"+a+"' (Id ASC)";"SmartDocSignature"===a&&(o="DROP INDEX IF EXISTS "+r),i.push(o)}this._initSQLServiceRequest({queryArray:i,doRollBack:!1},{handler:function(t){this.__onInfo("All tables got Indexed in "+(Date.now()-n)/1e3+" seconds"),e&&e.call(this)}})}else e&&e.call(this)}},{key:"_createTempTable",value:function(e,t){var n=this._getTempTableName(e);this._createTable(e,n,function(){return t&&t.call(this,n)})}},{key:"_createSObjectTempTable",value:function(e,t){return this._ensureTempTableExists(e,t)}},{key:"_ensureTableExists",value:function(e,t){if(this._isTableInDatabase(e))t&&t.call(this);else{var n=function(){for(var t=this._getState("TABLE_BUFFER")||{},n=t[e],i=0;i<n.length;i++)n[i]&&n[i].call(this);t[e]=null,this._setState("TABLE_BUFFER",t)},i=this._getState("TABLE_BUFFER")||{};i[e]?i[e].push(t):(i[e]=[t],this._createTable(e,function(){j.Utils.MetaData.registerNewTableInDatabase(e),n.call(this,e)})),this._setState("TABLE_BUFFER",i)}}},{key:"_ensureTempTableExists",value:function(e,t){if(this._tempTableCreated(e)){var n=this._getTempTableName(e);t&&t.call(this,n)}else this.__parent.__ensureMetaBuffer=this.__parent.__ensureMetaBuffer||{},this.__parent.__ensureMetaBuffer[e]?this.__parent.__ensureMetaBuffer[e].push(t):(this.__parent.__ensureMetaBuffer[e]=[t],this._createTempTable(e,function(t){this._tempTableCreated(e,!0);for(var n=this.__parent.__ensureMetaBuffer[e],i=0;i<n.length;i++)n[i]&&n[i].call(this,t);this.__parent.__ensureMetaBuffer[e]=null}))}},{key:"_ensureSObjectDescribeExists",value:function(e){this._getState("DESCRIBED."+e)||(this._setState("DESCRIBED."+e,!0),this._describeObject(e,function(e){j.SQLSchema.addSObjectSchema(e);var t=this.__getOptimizedDescribe(e);this._insertUpdateMetadata("SFObjectDescribe",{object_name:e.name,object_describe:x.toJSON(t),key_prefix:e.keyPrefix,label:e.label},{object_name:e.name}),this._describeLayoutsBatch(e)}))}},{key:"_ensureSObjectTableExists",value:function(e,t,n){if("function"==typeof t&&(n=t,t=!1),1==t)return this._ensureSObjectTempTableExists(e,n);this._isTableInDatabase(e)&&j.SQLSchema.tables[e]?n&&n.call(this,e):this._describeObjectByName(e,function(e,t){j.SQLSchema.addSObjectSchema(t),this._ensureTableExists(e,function(){n&&n.call(this,e)})})}},{key:"_ensureSObjectTempTableExists",value:function(e,t){function n(e,t){i._createSObjectTempTable(e,function(n){for(var a=i.__parent.__ensureSObjectBuffer[e],r=0;r<a.length;r++)a[r]&&a[r].call(i,n,t);i.__parent.__ensureSObjectBuffer[e]=null,delete i.__parent.__ensureSObjectBuffer[e]})}var i=this;if(this._tempTableCreated(e)){var a=this._getTempTableName(e);t&&t.call(this,a)}else if(this.__parent.__ensureSObjectBuffer=this.__parent.__ensureSObjectBuffer||{},this.__parent.__ensureSObjectBuffer[e])this.__parent.__ensureSObjectBuffer[e].push(t);else{this.__parent.__ensureSObjectBuffer[e]=[t];var r=this._getState("DESCRIBED."+e);r?this._describeObjectByName(e,function(e,t){n(e,t)}):this._describeObject(e,function(t){if(t){j.SQLSchema.addSObjectSchema(t),n(e,t),this._setState("DESCRIBED."+e,!0);var i=this.__getOptimizedDescribe(t);this._insertUpdateMetadata("SFObjectDescribe",{object_name:t.name,object_describe:x.toJSON(i),key_prefix:t.keyPrefix,label:t.label},{object_name:t.name}),this._describeLayoutsBatch(t)}})}}},{key:"__getOptimizedDescribe",value:function(e){var t={},n=0,i=this.__objectDescribeDataConfig.length;for(n;n<i;n++){var a=this.__objectDescribeDataConfig[n],r=a.parent_node;a.isNested?t[r]=this.__parseNestedDescribe(e[r],a):t[r]=e[r]}return t}},{key:"__parseNestedDescribe",value:function(e,t){var n=void 0,i=0,a=0,r=e.length,o=t.child_nodes,s=o.length;for(t.isArray&&(n=[]),i;i<r;i++){var l={},c=e[i];for(a=0;a<s;a++){var u=o[a];l[u]=c[u]}n.push(l)}return n}},{key:"_ensureReferencedSObjectTempTableExists",value:function(e){for(var t=0;t<e.fields.length;t++){var n=e.fields[t];if("reference"===n.type)for(var i=0;i<n.referenceTo.length;i++){var a=n.referenceTo[i];this._ensureSObjectTempTableExists(a)}}}},{key:"_forEachSFObjectDescribe",value:function(e,t){"function"==typeof e&&(t=e,e=!1);var n="SFObjectDescribe";e&&(n=this._getTempTableName(n));var i={query:"SELECT object_name FROM "+n};this._initSQLServiceRequest(i,{handler:function(e){if(e)for(var n=0;n<e.length;n++)t.call(this,e[n].object_name)}})}},{key:"_describeObject",value:function(e,t){var n="24.0",i=q.getVersionClass();i.objectDescribeAPIVersion&&(n=i.objectDescribeAPIVersion());var a={uri:"/services/data/v"+n+"/sobjects/"+e+"/describe",method:"GET",methodName:"ObjectDescribe",data:{eventType:"SYNC",eventName:e},canFail:!0};this._initHTTPServiceRequest(a,{handler:function(e){t&&t.call(this,e)}})}},{key:"__qualifiesForLayoutDescribe",value:function(e){var t=[x.OrgNamespace+"__ServiceMax_Processes__c",x.OrgNamespace+"__ServiceMax_Config_Data__c"],n=!1,i=void 0,a=t.length;for(i=0;i<a;i++)if(t[i]==e){n=!0;break}return!n}},{key:"_describeLayoutsBatch",value:function(e,t){if(this.__qualifiesForLayoutDescribe(e.name)){e.recordTypeInfos||(e.recordTypeInfos=[]);for(var n=[],i=0;i<e.recordTypeInfos.length;i++){var a=e.recordTypeInfos[i];"Master"!==a.name&&n.push(a.recordTypeId)}if(0===n.length)return void(t&&t.call(this));this.__describeLayoutsBatchInternal(e.name,n,t)}}},{key:"__describeLayoutsBatchInternal",value:function(e,t,n){for(var i=0,a=this;t.length;){var r=t.splice(0,3);i++,function(t){a._synchronize("describeLayouts",function(r){var o={protocol:"SOAP",methodName:"describeLayout",data:{eventType:"SYNC",eventName:e},soapData:(0,d.default)({sObjectType:e,layoutName:"",recordTypeIds:t},"layoutName","")};a._initHTTPServiceRequest(o,{handler:function(t){a.__describeLayoutsBatchInternalResult(e,t),i--,0===i&&n&&n.call(a),r.call(a)}})})}(r)}}},{key:"__describeLayoutsBatchInternalResult",value:function(e,t){var n=void 0,i=void 0;try{if(!(n=x.stringToXML(t)))return;i=x.xmlToJson(n)}catch(e){return void this.__logger.error(e)}t=i.Envelope.Body.describeLayoutResponse.result;var a={recordTypeMappings:t.recordTypeMappings};a.recordTypeMappings instanceof Array||(a.recordTypeMappings=[a.recordTypeMappings]),this._insertMetadata("SFObjectLayoutDescribe",[{object_name:e,object_layout_describe:x.toJSON(a)}])}},{key:"_convertTempTables",value:function(e){var t=this._tempTableCreated();if(t){var n=Date.now(),i=[],a=[],r=this;for(var o in t){var s=this._getTempTableName(o),l=j.SQLSchema.getRenameTableQuery(s,o);i.push(l),a.push(o)}this._initSQLServiceRequest({queryArray:i,doRollBack:!1},{handler:function(t){var i=a.length,o=0;for(r.__onInfo("All tables got Renamed in "+(Date.now()-n)/1e3+" seconds"),o=0;o<i;o++)r._registerTableInDatabase(a[o]);e&&e.call(r)}})}else e&&e.call(this)}},{key:"_setCache",value:function(e,t,n){j.Utils.Cache.writeToDBCache(e,t,n,this)}},{key:"_setTempCache",value:function(e,t,n){this._setState("TEMP_CACHE."+e,t);var i={query:"INSERT OR REPLACE INTO TEMP__ClientCache (key, value) VALUES ({{key}}, {{value}})",binds:{key:e,value:t}};this._initSQLServiceRequest(i,{handler:function(e){n&&n.call(this,e)},context:this})}},{key:"_getTempCache",value:function(e,t){var n=this._getState("TEMP_CACHE."+e);return t?t.call(this,n):n}},{key:"_getCache",value:function(e,t){this.__serviceRequestCount++,j.Utils.Cache.readFromDBCache(e,x.proxy(this,function(e){t.call(this,e),this.__serviceRequestCount--}))}},{key:"_setLastSyncTime",value:function(e,t){if(e){this._getState("LAST_SYNC_TIME")||this._setState("LAST_SYNC_TIME",e),t&&this._setState("LAST_SYNC_TIME_"+t,e)}}},{key:"_getLastSyncTime",value:function(e,t){"function"==typeof e&&(t=e,e=null);var n="LAST_SYNC_TIME";if(e&&(n+="_"+e),this.__lastSyncTimes||(this.__lastSyncTimes={}),this.__lastSyncTimes[n])return t.call(this,this.__lastSyncTimes[n]);this.__serviceRequestCount++,this._getCache(n,function(i){return!i&&e?(this.__serviceRequestCount--,this._getLastSyncTime(t)):(this.__lastSyncTimes[n]=i,this.__serviceRequestCount--,t.call(this,i))})}},{key:"_cacheLastSyncTime",value:function(){var e=this.getSyncType(),t=O.getCurrentDatetimeGMT(O.getSaveFormat("datetime")),n=e;"ONECALLSYNC"!=n&&"AGGRESSIVE"!=n&&"TARGETEDSYNC"!=n||(n="DATA"),n&&t&&"TARGETEDSYNC"!==e&&this._setCache("LAST_SYNC_TIME."+n,t)}},{key:"_serviceDataToObject",value:function(e){if(!e)return{};if("string"==typeof e)try{e=x.toObject(e)}catch(e){}var t={};if(e.data&&e.data.length&&(e.value=e.data),e.pageUI)t.pageUI=e.pageUI;else if(e.valueMap&&e.valueMap.length)for(var n=0;n<e.valueMap.length;n++){var i=e.valueMap[n].key;if(i){var a=this._serviceDataToObject(e.valueMap[n]),r=e.valueMap[n].value;if(r&&a!=r)if(t[r]&&t[r]instanceof Object&&a instanceof Object)for(var o in a)t[r][o]&&(t[r][o+"_"]?t[r][o+"_"].push(a[o]):t[r][o+"_"]=[t[r][o],a[o]]),t[r][o]=a[o];else t[r]=a;else t[i]?(t[i]instanceof Array||(t[i]=[t[i]]),t[i].push(a)):t[i]=a}else t[n]=this._serviceDataToObject(e.valueMap[n])}else t=e.value?e.value:e.values?e.values:null;return t}},{key:"_commonSaveRecordIds",value:function(e){if(e){var t=void 0,n=void 0,i=void 0;for(n=e.length,t=0;t<n;t++)i=e[t],this._recordNotPurgeIds(i.value,i.values)}}},{key:"_recordNotPurgeIds",value:function(e,t){var n=this._getState("DO_NOT_PURGE_IDS")||{};if(e&&t){var i=void 0,a=void 0,r=n[e]||{};if(t)for(a=t.length,i=0;i<a;i++)r[t[i]]||(r[t[i]]=!0);n[e]=r}this._setState("DO_NOT_PURGE_IDS",n)}},{key:"_commonSyncObjectRecords",value:function(e,t,n){function i(){if(o.length>0){l++;var e=o.shift();c._commonSyncObjectRecordBatch(e.objectName,e.recordIds,t,f)}else 0===o.length&&0===l&&n&&n.call(c,r)}function a(){if(s>0&&o.length>0){s--,l++;var e=o.shift();c._commonSyncObjectRecordBatch(e.objectName,e.recordIds,t,f),a()}}if(e){for(var r=[],o=[],s=3,l=0,c=this,u=0;u<e.length;u++){var d=e[u].value;c._recordNotPurgeIds(d,e[u].values);var _=c.__filterSyncObjectRecordIds(t,e[u].values);_.length>0&&("insert"===t||"insert.incremental"===t)&&c.__onInfo("(DC) Download "+_.length+" records of type "+d);for(;_&&_.length>0;){var h=_.splice(0,150);o.push({objectName:d,recordIds:h})}}0===o.length&&n&&n.call(c,r);var f=function e(t,n,a,o){for(var s=!1,u=0;u<=t.valueMap.length;u++){var d=t.valueMap[u];if(d&&d.value===a&&d.valueMap.length===o.length){s=!0;break}}var _=c._serviceDataToObject(t);if(s)c._processTXFetchResult(a,n,_,r,function(){l--,i()});else{var h=function(e){if(e&&e[a]){var t=e[a];t&&t.length&&(o=o.filter(function(e){return!t.includes(e)})),e[a]=null}},f=_.SAFE_TO_DELETE;if(f)if(D.isArray(f))for(var p=f.length,m=0;m<p;m++)h(f[m]);else h(f);c._setState("BATCHRECORDIDS",o),c._processTXFetchResult(a,n,_,r,function(){l--;for(var t=c._getState("BATCHRECORDIDS"),o=[],s=0;s<=t.length;s++){var u=t[s];u&&-1==r.indexOf(u)&&o.push(u)}o.length>0?(l++,c._commonSyncObjectRecordBatch(a,o,n,e)):i()})}};a()}}},{key:"_commonSyncObjectRecordBatch",value:function(e,t,n,i){if(!e||0===t.length)return void(i&&i.call(this,data,n,e));var a={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"TX_FETCH",valueMap:[{key:"TX_OBJECT",value:e,values:t}]},subDesc:e+" x"+t.length};this._initHTTPServiceRequest(a,{handler:function(a){var r=this._getState("TX_FETCH_RECORD_IDS")||{},o=this._serviceDataToObject(a),s=[];if(o=o[0],"object"===(void 0===o?"undefined":(0,h.default)(o)))for(var l in o){var c=x.toObject(o[l]);c&&s.push(c.Id)}for(var l=0;l<s.length;l++){var u=s[l];r[u]=!0}this._getSyncRecords("update",function(o){if(o&&o.ids&&o.ids.length>0)for(var s=0;s<o.ids.length;s++)r[o.ids[s]]=!1;this._setState("TX_FETCH_RECORD_IDS",r);try{i&&i.call(this,a,n,e,t)}catch(r){i&&i.call(this,a,n,e,t),console.log(r)}})}})}},{key:"_countRecordsSynced",value:function(e,t){var n=e&&e.length||0;if(n){var i=this._getState("RECORD_COUNTS_TOTAL")||0;if(i+=n,this._setState("RECORD_COUNTS_TOTAL",i),t){var a=this._getState("RECORD_COUNTS")||{};a[t]=a[t]||0,a[t]+=n,this._setState("RECORD_COUNTS",a)}this.__onProgress({recordCount:i})}}},{key:"__filterSyncObjectRecordIds",value:function(e,t){if("insert"==e||"insert.incremental"==e){for(var n=[],i=this._getState("TX_FETCH_RECORD_IDS")||{},a=this._getState("IGNORE_OBJECTS")||{},r=0;r<t.length;r++){var o=t[r];void 0===o||a[o]||(i[o]?(this._duplicateDownloadIds=this._duplicateDownloadIds||[],this._duplicateDownloadIds.push(o),this._duplicateDownloadIds.length<100?this.__logger.error("Duplicate record Id sent by server: "+o):100==this._duplicateDownloadIds.length&&this.__logger.error("Too many duplicate record Ids to report")):n.push(o))}return this._setState("TX_FETCH_RECORD_IDS",i),n}return t}},{key:"_processTXFetchResult",value:function(e,t,n,i,a){var r=this;if("function"==typeof i&&(a=i,i=null),!n||!n[0])return a&&a.call(this);n=n[0];var o=[],s={},l=[],c=[];for(var u in n){var d=x.toObject(n[u]);if(d&&"object"===(void 0===d?"undefined":(0,h.default)(d))){var e=d.attributes.type;if(delete d.attributes,"ContentDocumentLink"===e&&d.ContentDocument){var _=d.ContentDocument;_.LatestPublishedVersion&&(c.push(_),l.push(_.LatestPublishedVersion))}o.push(d),i&&i.push(d.Id),s[d.Id]=d}}if(this.__parent.getState("PIQ_ENABLED_FOR_INITIAL_SYNC")){var f=this;if(e===x.getCustomObjectName("Installed_Product")||e===x.getCustomObjectName("Site")){var p=x.cloneObject(i);if(p.length){var m="Sync_Records_Heap";f._tempTableCreated(m)&&(m=x.getTempTableName(m)),function(t){for(var n=[];t.length;){for(var i=t.splice(0,25),a="('"+i[0]+"','"+e+"')",r=1;r<i.length;r++)a+=",('"+i[r]+"','"+e+"')";var o="INSERT OR REPLACE INTO "+m+" (SFId,ObjectName) VALUES "+a;n.push(o)}n.length&&f._initSQLServiceRequest({queryArray:n},{handler:function(){f.__logger.info("Finished inserting records into Sync_Record_Heap")}})}(p)}}}var v=D.Deferred();l.length>0?v=this._insertFileRecords(l,c,t):v.resolve(),v.done(x.proxy(this,function(){"insert"===t||"update"===t?r._insertReplaceRecord(e,o,!0,!1,a):"insert.incremental"===t?r._insertRecordIncremental(e,o,a):r._insertReplaceRecordIncremental(e,o,!0,a),r._countRecordsSynced(o,e),r._bufferRecordNames(o)}))}},{key:"_insertFileRecords",value:function(e,t,n){var i=D.Deferred(),a=[];return"insert"===n||"update"===n?(a.push(this._insertReplaceRecord("ContentVersion",e,!0,!1)),a.push(this._insertReplaceRecord("ContentDocument",t,!0,!1))):"insert.incremental"===n?(a.push(this._insertRecordIncremental("ContentVersion",e)),a.push(this._insertRecordIncremental("ContentDocument",t))):(a.push(this._insertReplaceRecordIncremental("ContentVersion",e,!0)),a.push(this._insertReplaceRecordIncremental("ContentDocument",t,!0))),x.when(a).always(function(){i.resolve()}),i}},{key:"_downloadAttachment",value:function(e,t){var n=this,i=x.Deferred(),a=e.substring(0,3);return this._getObjectNameForKeyPrefix(a,function(a){if(!a||"ContentVersion"!==a&&"Attachment"!==a)i.reject(e);else{var r="ContentVersion"===a;t&&(a=n._getTempTableName(a)),n._getDoDRecord(e,r,function(t){if(!t||!t[0])return void i.reject(e);this._processDownloadAttachment(t[0],!0,r).done(function(){i.resolve(e)}).fail(function(){i.reject(e)})})}}),i}},{key:"_downloadAttachmentsOptimized",value:function(e,t){this.__serviceRequestCount++,t&&t.length?this._commonSyncObjectRecords([{value:"Attachment",values:t}],"INSERT",function(){this._downloadAttachmentsUpsert(e)}):this._downloadAttachmentsUpsert(e)}},{key:"_downloadAttachmentBody",value:function(e,t){var n=H.getMultiServerVersionRequest();if(e&&e.isSalesforceFile&&!n.isSalesForceFilesEnabled())return t&&t.call(this);this.__serviceRequestCount++;var i=this,a=this.getSyncManager();if(!a){a=x.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance()}if(a.__totalAttachmentCount=0,a.__stopped=!1,this.startConnectivityMonitorForAttachmentSync(),e&&e.attachmentRec&&e.attachmentRec.length>0)i.fetchAttachmentBodyInBatches({recs:e.attachmentRec,callback:t,isSalesforceFile:e.isSalesforceFile});else{var r="SELECT * FROM Attachment LEFT JOIN SFAttachments ON SFAttachments.Id = Attachment.Id  WHERE (SFAttachments.last_modified_date < Attachment.LastModifiedDate OR SFAttachments.downloaded IS NULL OR SFAttachments.downloaded != 'true')";switch(e&&e.isSalesforceFile&&(r="SELECT ContentVersion.Id, ContentVersion.Title as Name, SFAttachments.parent_id as ParentId, ContentVersion.CreatedById, ContentVersion.Description, ContentVersion.FileExtension as ContentType, ContentVersion.ContentSize as BodyLength, ContentVersion.LastModifiedDate FROM ContentVersion LEFT JOIN SFAttachments ON SFAttachments.Id = ContentVersion.Id  WHERE (SFAttachments.last_modified_date < ContentVersion.LastModifiedDate OR SFAttachments.downloaded IS NULL OR SFAttachments.downloaded != 'true')"),e&&e.syncType){case"ONECALLSYNC":break;case"TARGETEDSYNC":r=e&&e.isSalesforceFile?r+" AND (SFAttachments.parent_id = '"+e.parentId+"')":r+" AND (Attachment.ParentId = '"+e.parentId+"')";break;default:r=e&&e.isSalesforceFile?"SELECT ContentVersion.Id, ContentVersion.Title as Name, ContentDocumentLink.LinkedEntityId as ParentId, ContentVersion.CreatedById, ContentVersion.Description, ContentVersion.FileExtension as ContentType, ContentVersion.ContentSize as BodyLength, ContentVersion.LastModifiedDate FROM ContentVersion LEFT JOIN ContentDocumentLink ON ContentDocumentLink.ContentDocumentId = ContentVersion.ContentDocumentId":"SELECT * FROM Attachment"}var o={query:r};this._initSQLServiceRequest(o,{handler:function(n){i.fetchAttachmentBodyInBatches({recs:n,callback:t,isSalesforceFile:e.isSalesforceFile})}})}}},{key:"startConnectivityMonitorForAttachmentSync",value:function(){x.getCurrentApplication().getSyncImpl().startConnectivityMonitor()}},{key:"stopConnectivityMonitorForAttachmentSync",value:function(){x.getCurrentApplication().getSyncImpl().stopConnectivityMonitor()}},{key:"fetchAttachmentBodyInBatches",value:function(e){e.recs&&this._downloadAttachmentsArray(e.recs,!0,e.callback,e.isSalesforceFile)}},{key:"_downloadAttachmentsUpsert",value:function(e){var t=this,n=H.getMultiServerVersionRequest(),i={query:"INSERT OR REPLACE INTO SFAttachments ('Id', 'parent_id', 'created_by_id', 'name', 'description', 'content_type', 'content_length', 'last_modified_date', 'file_path', 'downloaded') SELECT Attachment.Id, Attachment.ParentId AS 'parent_id', Attachment.CreatedById AS 'created_by_id', Attachment.Name AS 'name', Attachment.Description AS 'description', Attachment.ContentType AS 'content_type', Attachment.BodyLength AS 'content_length', Attachment.LastModifiedDate AS 'last_modified_date', ('{DownloadDirectory}/' || Attachment.Id || '_' || Attachment.Name) AS 'file_path', SFAttachments.downloaded FROM Attachment LEFT JOIN SFAttachments ON SFAttachments.Id = Attachment.Id"};t._initSQLServiceRequest(i,{handler:function(i){n.isSalesForceFilesEnabled()?t._downloadSFilesUpsert(e):(t._complete(),e&&e.call(t))}})}},{key:"_downloadSFilesUpsert",value:function(e){var t=x.string.substitute("INSERT OR REPLACE INTO {{attachment_table}} (Id,parent_id,created_by_id,name,file_path,description,content_type,content_length,downloaded,last_modified_date,file_type,process_id,content_document_id) SELECT cv.Id as Id, cdl.LinkedEntityId AS parent_id,cv.CreatedById AS created_by_id, cv.Title  AS name,('{DownloadDirectory}/' || cv.Id || '_' || cv.Title) AS file_path ,cv.Description AS description ,cv.FileExtension AS content_type,cv.ContentSize AS content_length,sfa.downloaded AS downloaded ,cv.LastModifiedDate AS last_modified_date ,'SFILE' AS file_type , cv.{{process_id_field}} AS process_id, cv.ContentDocumentId AS content_document_id  FROM {{content_version}} AS cv LEFT JOIN {{attachment_table}} AS sfa ON sfa.Id = cv.Id LEFT JOIN {{content_document_link}} AS cdl on cv.ContentDocumentId = cdl.ContentDocumentId ",{process_id_field:x.OrgNamespace+"__SM_Process_ID__c",content_version:"ContentVersion",content_document_link:"ContentDocumentLink",attachment_table:"SFAttachments"}),n={query:t};this._initSQLServiceRequest(n,{handler:function(t){this._complete(),e&&e.call(this)}})}},{key:"_downloadAttachments",value:function(e,t){var n="Attachment";"function"==typeof e&&(t=e,e=null),e&&(n=this._getTempTableName(n)),this._getRecords(n,function(e){if(!e||!e[0])return t&&t.call(this);this._downloadAttachmentsArray(e,t,null,!1)})}},{key:"_downloadAttachmentsArray",value:function(e,t,n,i){"function"==typeof t&&(n=t,t=null);var a=this.getSyncManager();if(!a){a=x.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance()}a.__totalAttachmentCount=e.length,this.__serviceRequestCount++,j.Utils.executeUntilDone({data:e,inParallelProcessCount:3,process:x.proxy(this,function(e){return this._processDownloadAttachment(e,t,i)}),onSuccess:x.proxy(this,function(){this._complete(),n&&n.call(this)}),onError:x.proxy(this,function(e){n&&n.call(this)})})}},{key:"_processDownloadAttachment",value:function(e,t,n){var i=x.Deferred(),a=x.proxy(this,function(){return t&&this._refreshAttachment(),i.resolve()}),r=x.proxy(this,function(){return i.reject(!0)}),o=!0,s=x.getClient().getApplicationParameter("svmx-mobile");s&&"true"===s&&(o=t||!1);var l={Id:e.Id,parent_id:e.ParentId,created_by_id:e.CreatedById,name:e.Name,file_path:"{DownloadDirectory}/"+e.Id+"_"+e.Name,description:e.Description||"",content_type:e.ContentType,content_length:e.BodyLength,last_modified_date:e.LastModifiedDate};return n&&l.content_type&&(l.file_type="SFILE",l=P.getSFilePathInfo(l),e.Name=l.name),l.Id?this._insertUpdateAttachmentMetadata(l,function(s){var l=t||!s||!s.downloaded||"false"===s.downloaded||s.last_modified_date<e.LastModifiedDate;o&&l&&!this.__stopped?this._processDownloadAttachmentFile(e,a,r,n):i.resolve()}):i.resolve(),i}},{key:"_processDownloadAttachmentFile",value:function(e,t,n,i){this.incrementProgress&&this.incrementProgress();this.__downloadAttachmentFile(0,e,t,n,i)}},{key:"__downloadAttachmentFile",value:function(e,t,n,i,a){e++;var r=a?"ContentVersion":"Attachment",o=a?"VersionData":"Body",s=t.Id+"_"+t.Name;this.__onInfo("(HTTP) Downloading "+r+": "+t.Name+" ("+t.ParentId+") Download Attempts: "+e),this._initNativeServiceRequest("Download",{sourceObject:r,recordId:t.Id,file:s,fieldName:o},{handler:function(r,o){if(r&&t.Id){var s={Id:t.Id,downloaded:!0};this._insertUpdateAttachmentMetadata(s,function(){n&&n.call(this)})}else e>2?i&&i.call(this):this.__downloadAttachmentFile(e,t,n,i,a)}})}},{key:"_insertUpdateAttachmentMetadata",value:function(e,t){var n=x.Deferred(),i={query:"SELECT * FROM SFAttachments WHERE Id = {{Id}}",binds:{Id:e.Id}};return this._initSQLServiceRequest(i,{handler:function(i){var a=null,r=null;i&&i[0]?(r=i[0],a=j.SQLSchema.getUpdateQuery("SFAttachments",e)):a=j.SQLSchema.getInsertQuery("SFAttachments",e),this._initSQLServiceRequest({query:a},{handler:function(){n.resolve(),t&&t.call(this,r)}})}}),n}},{key:"_indicateDataChanged",value:function(e,t,n){this._getState("DATA_CHANGED")}},{key:"__dropUnwantedTables",value:function(){var e=this,t=e._tempTableCreated();if(t){var n=[].concat((0,c.default)(new s.default([].concat((0,c.default)((0,p.default)(function(){var e=j.SQLSchema.tables,t=j.Utils.MetaData.getTablesInDatabase(),n={};for(var i in e)if(e[i].createIfMissing&&!t[i])n[i]=e[i];else{if(!e[i].createAlways)continue;n[i]=e[i]}return n}())),(0,c.default)((0,p.default)(t)),(0,c.default)((0,p.default)(j.SQLSchema.staticTables)))))).sort();e._initSQLServiceRequest({query:"SELECT name FROM sqlite_master WHERE type='table' and name not like '%svmxo_%' and name not like '%sqlite%' order by name ASC;"},{handler:function(t){if(t&&D.isArray(t)&&t.length>0){var i=t.map(function(e){return e.name}),a=i.filter(function(e){return!n.includes(e)});a.length&&a.length>0&&e._initSQLServiceRequest({queryArray:a.map(function(e){return"DROP TABLE "+e}),doRollBack:!1},{handler:function(t){e.__onInfo("Dropped these unwanted tables: "+a)}})}}})}}},{key:"__commonSyncCleanUp",value:function(e){this._flushRecordNames(function(){this._convertTempTables(function(){this._createIndexForTable(function(){if(this._cacheLastSyncTime(),this.__cacheDownloadCriteriaServiceMaxEvents(),this.__cacheOrgNameSpace(),"INITIAL"!==this.getSyncType().toUpperCase())return this._hasClientId()?e&&e():e.call(this);x.getCurrentApplication().__discoverConsoleApps(),this.__dropUnwantedTables(),this._setState("SQL.SCHEMA_TEMP_TABLES",{}),this.__purgeOldFiles().then(x.proxy(this,function(){return this._hasClientId()?e&&e():e.call(this)}))})})})}},{key:"__purgeOldFiles",value:function(){function e(e){var t=x.Deferred(),n=L.createFileRequest();return n.bind("REQUEST_COMPLETED",function(e){var n=[];if(e.data.success){n=x.toObject(e.data.data).FileList||[]}t.resolve(n)},this),n.bind("REQUEST_ERROR",function(e){t.resolve([])},this),n.execute({operation:"LIST",file:e}),t}function t(e){var t=new x.Deferred;if(e){var n=L.createFileRequest();n.bind("REQUEST_COMPLETED",function(e){t.resolve()},this),n.bind("REQUEST_ERROR",function(e){t.resolve()},this),n.execute({operation:"DELETE",file:e})}else t.resolve();return t}var n=x.Deferred(),i=w.readFromJSCache("Old_SFAttachment_File_Path","Old_SFAttachment_File_Path")||null;if(!((i=null!=i?x.toObject(i):null)&&i.length>0))return n.resolve();var a=this,o=e("{DownloadDirectory}"),l=e("{UploadDirectory}");return x.when([o,l]).then(function(e,o){var l=new s.default(e.concat(o)),u=new s.default(i),d=new s.default([].concat((0,c.default)(l)).filter(function(e){return u.has(e)}));a.__onInfo("Deleting these old files: "+[].concat((0,c.default)(d))),x.when((0,r.default)(d).map(function(e){return t(e)})).always(function(){n.resolve(),w.clearJSCache("Old_SFAttachment_File_Path")})}),n}},{key:"__cacheOrgNameSpace",value:function(){var e=this,t="('ORG_NAME_SPACE','"+x.OrgNamespace+"')",n="INSERT OR REPLACE INTO ClientCache (key,value) VALUES "+t;e._initSQLServiceRequest({query:n},{handler:function(){e.__logger.info("Finished inserting records into ClientCache")}})}},{key:"__cacheDownloadCriteriaServiceMaxEvents",value:function(){this._saveServiceMaxEventsToClientCache()}},{key:"_refreshAttachment",value:function(){var e=x.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),t=x.create("com.servicemax.client.lib.api.Event","ATTACHMENT_ON_DEMAND.RELOAD",this,{request:{}});e.triggerEvent(t)}},{key:"getUserInfo",value:function(e){e||(e=function(){});var t=this._getState("USER_INFO");t?e.call(this,t):(this.__serviceRequestCount++,this.getSyncManager().getUserInfo(function(t){e.call(this,t),this._complete()},this))}},{key:"refreshUserInfoForCustomWebService",value:function(e){var t={methodName:"getUserInfo",data:{eventName:"UserInfo",eventType:"SFDC"}};this._initHTTPServiceRequest(t,{handler:function(t){t&&t.UserSessionId?e.call(this,t.UserSessionId):e.call(this,null)}})}},{key:"_getUserTrunkInfo",value:function(e){e||(e=function(){});var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"USER_TRUNK",valueMap:[]}};this._initHTTPServiceRequest(t,{handler:function(t){var n=this._serviceDataToObject(t)||{},i=x.OrgNamespace+"__Service_Group_Members__c",a=x.OrgNamespace+"__Latitude__c",r=x.OrgNamespace+"__Longitude__c",o=x.OrgNamespace+"__Street__c",s=x.OrgNamespace+"__City__c",l=x.OrgNamespace+"__State__c",c=x.OrgNamespace+"__Country__c",u=x.OrgNamespace+"__Zip__c",d=x.toObject(n[i]),_=void 0,h={};D.isArray(d)&&d.length&&(_=d[0].Id,h.street=d[0][o],h.city=d[0][s],h.state=d[0][l],h.country=d[0][c],h.zip=d[0][u],d[0].hasOwnProperty(a)&&d[0].hasOwnProperty(r)&&(h.latitude=d[0][a],h.longitude=d[0][r]));var f=x.OrgNamespace+"__Site__c",p=x.toObject(n[f]);D.isArray(p)&&p.length&&(p=p[0]),e.call(this,_,h,p)}})}},{key:"setUserInfo",value:function(e,t){this._setState("USER_INFO",e),t&&(this.__serviceRequestCount++,this.getSyncManager().setUserInfo(e,this._complete,this))}},{key:"getIsFieldMergeEnabled",value:function(e){var t={query:"SELECT * FROM MobileDeviceSettings WHERE setting_id = 'IPAD018_SET016'"};this._initSQLServiceRequest(t,{handler:function(t){var n=!1;t&&t.length&&t[0].value&&(n="true"===t[0].value.toLowerCase()),e&&e.call(this,n)}})}},{key:"_upgradeSchemaTable",value:function(e,t){var n=this._getTempTableName(e);if(!(n.indexOf("__ServiceMax_Processes__c")>0||n.indexOf("__ServiceMax_Config_Data__c")>0||n.indexOf("__Document")>0)){var i=j.SQLSchema.getCreateQuery(e,n);i="DROP TABLE IF EXISTS `"+n+"`; "+i,this._initSQLServiceRequest({query:i},{handler:function(i){this._tempTableCreated(e,!0);var a="PRAGMA table_info('"+e+"')";this._initSQLServiceRequest({query:a},{handler:function(i){for(var a=x.toObject(i),r=[],o=0;o<a.length;o++){var s=a[o].name;j.SQLSchema.tables[e].fields[s]&&r.push(s)}var l=r.join(","),c="INSERT INTO '"+n+"' ("+l+") SELECT "+l+" FROM '"+e+"'";this._initSQLServiceRequest({query:c},{handler:function(e){return t.call(this)}})}})}})}}},{key:"_oneCallUpgradeSchemaTable",value:function(e,t){for(var n=0,i=[],a=[],r=0;r<e.length;r++){var o=e[r],s=this._getTempTableName(o);if(!(s.indexOf("__ServiceMax_Processes__c")>0||s.indexOf("__ServiceMax_Config_Data__c")>0||s.indexOf("__Document")>0||s.indexOf("__RecordType")>0||s.indexOf("__Code_Snippet__c")>0)){var l=j.SQLSchema.getCreateQuery(o,s);l="DROP TABLE IF EXISTS `"+s+"`; "+l,n++,i.push(o),function(e){this._initSQLServiceRequest({query:l},{handler:function(e){var r=this;if(0==--n){var o;!function(){for(var e=0,n=0;n<i.length;n++){var s=i[n];r._tempTableCreated(s,!0),o="PRAGMA table_info('"+s+"')",e++,function(n){this._initSQLServiceRequest({query:o},{handler:function(i){for(var r=x.toObject(i),o=[],s=0;s<r.length;s++){var l=r[s].name;j.SQLSchema.tables[n].fields[l]&&o.push(l)}var c=o.join(","),u=this._getTempTableName(n),d="INSERT INTO '"+u+"' ("+c+") SELECT "+c+" FROM '"+n+"'";a.push(d),0==--e&&this._initSQLServiceRequest({queryArray:a},{handler:function(e){return t.call(this)}})}})}.call(r,s)}}()}}})}.call(this,o)}}}},{key:"triggerExternalRequest",value:function(e){this.__serviceRequestCount++,this.getSyncManager().triggerExternalRequest(e,{handler:function(t){if(t.error){var n="External Insert Request failed: "+e;this.__onError(n)}this._complete()},context:this})}},{key:"_deleteRecentItems",value:function(e){if(e.length){var t="DELETE FROM RecentItems WHERE RecordId IN ('"+e.join("','")+"')";this._initSQLServiceRequest({query:t})}}},{key:"_deleteWebserviceActionsLog",value:function(e){return this._deleteRecord("SfmWebServiceActionsLog",e)}},{key:"_refreshRecordsFromServer",value:function(e,t,n){if(n=n||"update.incremental",e.length<=0)return void(t&&t());for(var i=[],a={},r=0;r<e.length;r++){for(var o=e[r],s=0;s<o.values.length;s++)a[o.values[s]]=o.value;i=i.concat(o.values)}if(!i.length)return void(t&&t());var l=this;l.__serviceRequestCount++,j.Utils.Data.getUpdatedValues(i,function(t){l._commonSyncObjectRecords(e,n,t)},function(e){l._getRecordsByIds("ClientSuccSyncLog",(0,p.default)(e),function(n){function i(){--v||(t&&t(),l._complete())}var r=[],o=[],s={};if(n&&n.length)for(var c=0;c<n.length;c++){var u=j.Utils.SyncData.parseSyncRecord(n[c]);"client"!==u.changeType||u.Id in s||(s[u.Id]=u)}for(var d in e){var _=e[d],h=s[d];if(_.Id=d,_.operation="update",_.objectName=a[d],o.push(_),h){var f={};for(var p in h.oldValues)f[p]={client:{oldValue:h.oldValues[p],newValue:h.newValues[p]}};for(var p in _.oldValues){var m={oldValue:_.oldValues[p],newValue:_.newValues[p]};p in f?f[p].server=m:f[p]={server:m}}h.oldValues={},h.newValues={};for(var p in f){var u=f[p];"Id"!==p&&u.client&&u.server?(h.newValues[p]=u.client.newValue,h.oldValues[p]=u.server.newValue):u.client?(h.newValues[p]=u.client.newValue,h.oldValues[p]=u.client.oldValue):(h.newValues[p]=u.server.newValue,h.oldValues[p]=u.server.oldValue)}r.push(h)}}var v=1;r.length&&(v++,j.Utils.SyncData.writeSyncRecords({updateRecords:r,isSuccessive:!0,callback:i})),o.length&&(v++,j.Utils.SyncData.writeSyncRecords({updateRecords:o,isSuccessive:!0,isServerUpdates:!0,callback:i})),i()})})}},{key:"_handleServerErrors",value:function(e,t,n){if(D.isPlainObject(e)&&!D.isEmptyObject(e)){for(var i in e){var a=D.map(e[i],function(e,t){return D.isEmptyObject(e)?t:e});this._insertUpdateSyncConflict({Id:a,operation:t,error_type:n?"conflict":"error",error_message:i,override_flag:""})}return!0}return!1}},{key:"_commonSyncObjectRecordsWithInternalBatching",value:function(e,t,n){var i=this;if(e){for(var a,r=[],o=[],s=0,l=[],c=[],u=0;u<e.length;u++){var a=e[u].value;this._recordNotPurgeIds(a,e[u].values),c=this.__filterSyncObjectRecordIds(t,e[u].values),o=c.slice(0),c.length>0&&("insert"===t||"insert.incremental"===t)&&this.__onInfo("(DC) Download "+c.length+" records of type "+a);for(;c&&c.length>0;){var d=c.splice(0,150),_=function e(t,a,c){var u=this._serviceDataToObject(t),d="SAFE_TO_DELETE",_=u[d];if(_&&_[c]){var h=_[c];o=o.filter(function(e){return!h.includes(e)}),u[0]=null,u[d][c]=null}this._processTXFetchResult(c,a,u,r,function(){if(--s<3&&l.length>0){s++;var t=l.shift();this._commonSyncObjectRecordBatch(t.objectName,t.recordIds,a,e)}if(0===s){var u=o.filter(function(e){return-1===r.indexOf(e)});if(u.length>0){var d={value:c,values:u},_=[d];i._commonSyncObjectRecordsWithInternalBatching(_,a,n)}else n&&n.call(this,r)}})};s<3?(s++,this._commonSyncObjectRecordBatch(a,d,t,_)):l.push({objectName:a,recordIds:d})}}0===s&&n&&n.call(this,r)}}},{key:"_commonDownloadCriteriaServiceMaxEventRecords",value:function(e,t,n){for(var i=0;i<e.length;i++){var a=e[i].value,r=e[i].values;if(a===x.getCustomObjectName("SVMX_Event")&&r.length>0){var o=this._getState("DC_SERVICEMAX_EVENTS")||{};if(a&&r){var s=o[a]||[];r&&(s=s.concat(r)),o[a]=s,o.action=t}this._setState("DC_SERVICEMAX_EVENTS",o);break}}}},{key:"_commonDeleteDownloadCriteriaServiceMaxEventRecrods",value:function(e){var t=x.getCustomObjectName("SVMX_Event"),n=this._getState("DELETE_DC_SERVICEMAX_EVENTS")||{};if(t&&e){var i=n[t]||[];e&&(i=i.concat(e)),n[t]=i}this._setState("DELETE_DC_SERVICEMAX_EVENTS",n)}},{key:"_saveDownloadCriteriaServicemaxEvents",value:function(e,t,n){var i=this,a="('DC_SERVICEMAX_EVENTS','"+t+"')",r="INSERT OR REPLACE INTO ClientCache (key,value) VALUES "+a;i._initSQLServiceRequest({query:r},{handler:function(){i.__logger.info("Finished inserting records into ClientCache"),n&&n.call()}})}},{key:"_getDownloadCriteriaEventsFromClientCache",value:function(e,t){var n=this,i="ClientCache";n._tempTableCreated(i)&&(i=x.getTempTableName(i));var a="SELECT * FROM "+i+" WHERE key = 'DC_SERVICEMAX_EVENTS' ";n._initSQLServiceRequest({query:a},{handler:function(n){var i=[],a=[];if(n.length>0)if(i=n[0].value.split(","),e)a=i;else for(var r=0;r<i.length;r++){var o={};o.Id=i[r],o[x.getCustomFieldName("Technician")]="",o[x.getCustomFieldName("WhatId")]="",a.push(o)}t.call(this,a)}})}},{key:"_getUniqueDCEvents",value:function(e,t){for(var n=e.concat(t),i=0;i<n.length;++i){-1!=n.indexOf(i)&&n.splice(pos,1)}return n}},{key:"_saveServiceMaxEventsToClientCache",value:function(e){var t=this,n=this,i=this._getState("DC_SERVICEMAX_EVENTS")||{},a=i[x.getCustomObjectName("SVMX_Event")],r=i.action;(!a||a&&0===a.length)&&(a=[]),"update"===r||"update.incremental"===r||"insert.incremental"===r?this._getDownloadCriteriaEventsFromClientCache(!0,function(i){for(var r=a.concat(i),o=t._getState("DELETE_DC_SERVICEMAX_EVENTS")||{},s=o[x.getCustomObjectName("SVMX_Event")],l=0;l<s.length;l++){var c=r.indexOf(s[l]);-1!=c&&r.splice(c,1)}n._saveDownloadCriteriaServicemaxEvents(x.getCustomObjectName("SVMX_Event"),r,e)}):"insert"===r&&a.length>0&&this._saveDownloadCriteriaServicemaxEvents(x.getCustomObjectName("SVMX_Event"),a,e)}},{key:"_deleteSmartSyncTimeEntries",value:function(){var e={query:"Delete FROM SmartSyncTimeStamp"};this._initSQLServiceRequest(e,{handler:function(e){}})}},{key:"_getSmartSyncTimeStamps",value:function(e){var t={query:"SELECT Id, lastSyncTime FROM SmartSyncTimeStamp"};this._initSQLServiceRequest(t,{handler:function(t){var n={};if(t)for(var i=0;i<t.length;i++){var a=t[i].Id;n[a]=t[i].lastSyncTime}e&&e.call(this,n)}})}},{key:"_saveCurrentSynclogRecords",value:function(e){var t=this._getState("TargetedSyncLogRecords");t||(t=[]);for(var n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);this._setState("TargetedSyncLogRecords",t)}},{key:"_getObjectNameForKeyPrefix",value:function(e,t){j.Utils.MetaData.getObjectNameFromKeyPrefix({key_prefix:e,onSuccess:function(e){t&&t.call(this,e)},onError:function(e){t&&t.call(this,null)}})}},{key:"_deleteAttachmentFile",value:function(e){var t=this;t._getDeletedAttachmentFilePaths(e,function(n){if(n&&n.length>0){for(var i=[],a=n.length,r=0;r<a;r++){var o=n[r].__path;o&&i.push(t._createDeleteFileRequest(o))}x.when(i).always(function(){var n=["SFAttachments","Attachment","ClientSyncLog","ClientSuccSyncLog"];t._deleteAttachmentRelatedRecords(e,n)})}})}},{key:"_getDeletedAttachmentFilePaths",value:function(e,t){var n="SFAttachments";this._tempTableCreated(n)&&(n=x.getTempTableName(n));var i=e.join("','"),a="SELECT Id,file_path as __path FROM "+n+" WHERE Id IN ('"+i+"') ";this._initSQLServiceRequest({query:a},{handler:function(e){t&&t.call(this,e)},context:this})}},{key:"_createDeleteFileRequest",value:function(e){var t=D.Deferred(),n=L.createFileRequest();return n.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)},this),n.bind("REQUEST_ERROR",function(e){t.reject(e.data.data)},this),n.execute({operation:"DELETE",file:e}),t}},{key:"_deleteAttachmentRelatedRecords",value:function(e,t){for(var n=[],i=t.length,a=e.join("','"),r=0;r<i;r++){var o=t[r];this._tempTableCreated(o)&&(o=x.getTempTableName(o));var s="DELETE FROM "+o+" WHERE Id  IN ('"+a+"')";n.push(s)}this._initSQLServiceRequest({queryArray:n},{handler:function(e){var t=x.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),n=x.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{attachmentActionName:"refreshAllAttachments"}});t.triggerEvent(n)},context:this})}},{key:"_updateLocalAttachments",value:function(e,t){function n(e,t,n){var i=x.Deferred();if(t&&t.length>0){var a=t.join("','"),r=null;r=n?"UPDATE SFAttachments SET name=( SELECT ContentVersion.Title FROM ContentVersion WHERE SFAttachments.Id=ContentVersion.Id), file_path=( SELECT '{DownloadDirectory}/' || ContentVersion.Id || '_' || ContentVersion.Title FROM ContentVersion WHERE SFAttachments.Id=ContentVersion.Id), description=( SELECT ContentVersion.Description FROM ContentVersion WHERE SFAttachments.Id=ContentVersion.Id), last_modified_date=( SELECT ContentVersion.LastModifiedDate FROM ContentVersion WHERE  SFAttachments.Id=ContentVersion.Id) where  SFAttachments.Id in('"+a+"')":"UPDATE SFAttachments SET name=( SELECT Attachment.Name FROM Attachment WHERE SFAttachments.Id=Attachment.Id), file_path=( SELECT '{DownloadDirectory}/' || Attachment.Id || '_' || Attachment.Name FROM Attachment WHERE SFAttachments.Id=Attachment.Id), description=( SELECT Attachment.Description FROM Attachment WHERE SFAttachments.Id=Attachment.Id), last_modified_date=( SELECT Attachment.LastModifiedDate FROM Attachment WHERE  SFAttachments.Id=Attachment.Id) where  SFAttachments.Id in('"+a+"')",e._initSQLServiceRequest({query:r},{handler:function(){i.resolve()}})}else i.resolve();return i}if(e&&e.length>0){var i=e.join("','"),a=null;a=t?"SELECT cv.Id id, cv.Title newName, sfa.Name oldName, sfa.file_path filePath from ContentVersion cv, SFAttachments sfa where cv.Title != sfa.Name and cv.Id = sfa.Id and cv.Id IN ('"+i+"')":"SELECT a.Id id, a.Name newName, sfa.Name oldName, sfa.file_path filePath from Attachment a, SFAttachments sfa where a.Name != sfa.Name and a.Id = sfa.Id and a.Id IN ('"+i+"')",this._initSQLServiceRequest({query:a},{handler:function(i){var a=this;if(i&&i.length>0){for(var r=[],o=0;o<i.length;o++){var s=i[o].id,l=i[o].filePath,c=this._initNativeServiceRequest("File",{operation:"RENAME",file:l,targetFileName:s+"_"+i[o].newName},{});r.push(c)}x.when(r).done(function(i){n(a,e,t).done(function(){var e=x.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_RENAMED",a,{request:{}});x.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance().triggerEvent(e)})})}else n(this,e,t)}})}}},{key:"_deleteLocalSFiles",value:function(e){var t=this;t._getDeletedSalesforceFilePaths(e,function(n){if(n&&n.length>0){for(var i=[],a=n.length,r=0;r<a;r++){var o=P.getSFilePathInfo(n[r]),s=o.file_path;s&&i.push(t._createDeleteFileRequest(s))}x.when(i).always(function(){var n=["SFAttachments","ContentVersion","ClientSyncLog","ClientSuccSyncLog","RecentItems"];t._deleteContentVersionRelatedRecords(e,n)})}})}},{key:"_getDeletedSalesforceFilePaths",value:function(e,t){var n="SFAttachments";this._tempTableCreated(n)&&(n=x.getTempTableName(n));var i=e.join("','"),a="SELECT Id,name, file_path, content_type, file_type  FROM "+n+" WHERE Id IN ('"+i+"') ";this._initSQLServiceRequest({query:a},{handler:function(e){t&&t.call(this,e)},context:this})}},{key:"_deleteContentVersionRelatedRecords",value:function(e,t){for(var n=[],i=t.length,a=e.join("','"),r=0;r<i;r++){var o=t[r];this._tempTableCreated(o)&&(o=x.getTempTableName(o));var s="DELETE FROM "+o+" WHERE Id  IN ('"+a+"')";n.push(s)}this._initSQLServiceRequest({queryArray:n},{handler:function(e){var t=x.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),n=x.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{attachmentActionName:"refreshAllAttachments"}});t.triggerEvent(n)},context:this})}},{key:"_getCVIdsForCDLIds",value:function(e,t){if(e&&e.length>0){var n=e.join("','"),i="SELECT Id from ContentVersion where ContentDocumentId IN (SELECT ContentDocumentId FROM ContentDocumentLink where Id IN ('"+n+"') )";this._initSQLServiceRequest({query:i},{handler:function(e){var n=[];if(e)for(var i=0;i<e.length;i++)n.push(e[i].Id);t&&t.call(this,n)}})}else t&&t.call(this,null)}},{key:"_updateLocalSFiles",value:function(e){function t(e,t){var n=x.Deferred();if(t&&t.length>0){var i=t.join("','"),a="UPDATE SFAttachments SET name=( SELECT ContentVersion.Title FROM ContentVersion WHERE SFAttachments.Id=ContentVersion.Id), file_path=( SELECT '{DownloadDirectory}/' || ContentVersion.Id || '_' || ContentVersion.Title FROM ContentVersion WHERE SFAttachments.Id=ContentVersion.Id), description=( SELECT ContentVersion.Description FROM ContentVersion WHERE SFAttachments.Id=ContentVersion.Id), last_modified_date=( SELECT ContentVersion.LastModifiedDate FROM ContentVersion WHERE  SFAttachments.Id=ContentVersion.Id) where  SFAttachments.Id in('"+i+"')";e._initSQLServiceRequest({query:a},{handler:function(){n.resolve()}})}else n.resolve();return n}var n=x.Deferred();if(e&&e.length>0){var i=e.join("','");this._initSQLServiceRequest({query:"SELECT cv.Id id, cv.Title newName, sfa.Name oldName, sfa.name, sfa.file_path , sfa.content_type, sfa.file_type from ContentVersion cv, SFAttachments sfa where cv.Title != sfa.Name and cv.Id = sfa.Id and cv.Id IN ('"+i+"')"},{handler:function(i){var a=this;if(i&&i.length>0){for(var r=[],o=i.length,s=0;s<o;s++){var l=P.getSFilePathInfo(i[s]),c=l.id,u=l.file_path,d=i[s].newName;if(d){var _="."+i[s].content_type.toLowerCase();d.includes(_)||(d=""+d+_)}if(d!==l.oldName){var h=this._initNativeServiceRequest("File",{operation:"RENAME",file:u,targetFileName:c+"_"+d},{});r.push(h)}}x.when(r).done(function(i){t(a,e).done(function(){var e=x.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_RENAMED",a,{request:{}});x.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance().triggerEvent(e),n.resolve()})})}else t(this,e).done(function(){n.resolve()})}})}else n.resolve();return n}}]),t}(R),x.defineGlobal(V.name,V),e.exports=V},function(e,t,n){"use strict";if(n(26)){var i=n(61),a=n(17),r=n(20),o=n(9),s=n(116),l=n(159),c=n(44),u=n(74),d=n(67),_=n(35),h=n(76),f=n(46),p=n(25),m=n(222),v=n(70),g=n(51),y=n(38),S=n(83),E=n(21),b=n(29),T=n(148),M=n(71),I=n(41),C=n(72).f,A=n(150),D=n(68),x=n(23),R=n(54),O=n(106),L=n(94),k=n(153),N=n(85),w=n(111),F=n(73),P=n(152),q=n(211),V=n(27),B=n(40),j=V.f,H=B.f,z=a.RangeError,U=a.TypeError,Y=a.Uint8Array,W=Array.prototype,G=l.ArrayBuffer,X=l.DataView,Q=R(0),J=R(2),K=R(3),$=R(4),Z=R(5),ee=R(6),te=O(!0),ne=O(!1),ie=k.values,ae=k.keys,re=k.entries,oe=W.lastIndexOf,se=W.reduce,le=W.reduceRight,ce=W.join,ue=W.sort,de=W.slice,_e=W.toString,he=W.toLocaleString,fe=x("iterator"),pe=x("toStringTag"),me=D("typed_constructor"),ve=D("def_constructor"),ge=s.CONSTR,ye=s.TYPED,Se=s.VIEW,Ee=R(1,function(e,t){return Ce(L(e,e[ve]),t)}),be=r(function(){return 1===new Y(new Uint16Array([1]).buffer)[0]}),Te=!!Y&&!!Y.prototype.set&&r(function(){new Y(1).set({})}),Me=function(e,t){var n=f(e);if(n<0||n%t)throw z("Wrong offset!");return n},Ie=function(e){if(E(e)&&ye in e)return e;throw U(e+" is not a typed array!")},Ce=function(e,t){if(!(E(e)&&me in e))throw U("It is not a typed array constructor!");return new e(t)},Ae=function(e,t){return De(L(e,e[ve]),t)},De=function(e,t){for(var n=0,i=t.length,a=Ce(e,i);i>n;)a[n]=t[n++];return a},xe=function(e,t,n){j(e,t,{get:function(){return this._d[n]}})},Re=function(e){var t,n,i,a,r,o,s=b(e),l=arguments.length,u=l>1?arguments[1]:void 0,d=void 0!==u,_=A(s);if(void 0!=_&&!T(_)){for(o=_.call(s),i=[],t=0;!(r=o.next()).done;t++)i.push(r.value);s=i}for(d&&l>2&&(u=c(u,arguments[2],2)),t=0,n=p(s.length),a=Ce(this,n);n>t;t++)a[t]=d?u(s[t],t):s[t];return a},Oe=function(){for(var e=0,t=arguments.length,n=Ce(this,t);t>e;)n[e]=arguments[e++];return n},Le=!!Y&&r(function(){he.call(new Y(1))}),ke=function(){return he.apply(Le?de.call(Ie(this)):Ie(this),arguments)},Ne={copyWithin:function(e,t){return q.call(Ie(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return $(Ie(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return P.apply(Ie(this),arguments)},filter:function(e){return Ae(this,J(Ie(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Z(Ie(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Ie(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Q(Ie(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(Ie(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Ie(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ce.apply(Ie(this),arguments)},lastIndexOf:function(e){return oe.apply(Ie(this),arguments)},map:function(e){return Ee(Ie(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Ie(this),arguments)},reduceRight:function(e){return le.apply(Ie(this),arguments)},reverse:function(){for(var e,t=this,n=Ie(t).length,i=Math.floor(n/2),a=0;a<i;)e=t[a],t[a++]=t[--n],t[n]=e;return t},some:function(e){return K(Ie(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(Ie(this),e)},subarray:function(e,t){var n=Ie(this),i=n.length,a=v(e,i);return new(L(n,n[ve]))(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,p((void 0===t?i:v(t,i))-a))}},we=function(e,t){return Ae(this,de.call(Ie(this),e,t))},Fe=function(e){Ie(this);var t=Me(arguments[1],1),n=this.length,i=b(e),a=p(i.length),r=0;if(a+t>n)throw z("Wrong length!");for(;r<a;)this[t+r]=i[r++]},Pe={entries:function(){return re.call(Ie(this))},keys:function(){return ae.call(Ie(this))},values:function(){return ie.call(Ie(this))}},qe=function(e,t){return E(e)&&e[ye]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Ve=function(e,t){return qe(e,t=g(t,!0))?d(2,e[t]):H(e,t)},Be=function(e,t,n){return!(qe(e,t=g(t,!0))&&E(n)&&y(n,"value"))||y(n,"get")||y(n,"set")||n.configurable||y(n,"writable")&&!n.writable||y(n,"enumerable")&&!n.enumerable?j(e,t,n):(e[t]=n.value,e)};ge||(B.f=Ve,V.f=Be),o(o.S+o.F*!ge,"Object",{getOwnPropertyDescriptor:Ve,defineProperty:Be}),r(function(){_e.call({})})&&(_e=he=function(){return ce.call(this)});var je=h({},Ne);h(je,Pe),_(je,fe,Pe.values),h(je,{slice:we,set:Fe,constructor:function(){},toString:_e,toLocaleString:ke}),xe(je,"buffer","b"),xe(je,"byteOffset","o"),xe(je,"byteLength","l"),xe(je,"length","e"),j(je,pe,{get:function(){return this[ye]}}),e.exports=function(e,t,n,l){l=!!l;var c=e+(l?"Clamped":"")+"Array",d="get"+e,h="set"+e,f=a[c],v=f||{},g=f&&I(f),y=!f||!s.ABV,b={},T=f&&f.prototype,A=function(e,n){var i=e._d;return i.v[d](n*t+i.o,be)},D=function(e,n,i){var a=e._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),a.v[h](n*t+a.o,i,be)},x=function(e,t){j(e,t,{get:function(){return A(this,t)},set:function(e){return D(this,t,e)},enumerable:!0})};y?(f=n(function(e,n,i,a){u(e,f,c,"_d");var r,o,s,l,d=0,h=0;if(E(n)){if(!(n instanceof G||"ArrayBuffer"==(l=S(n))||"SharedArrayBuffer"==l))return ye in n?De(f,n):Re.call(f,n);r=n,h=Me(i,t);var v=n.byteLength;if(void 0===a){if(v%t)throw z("Wrong length!");if((o=v-h)<0)throw z("Wrong length!")}else if((o=p(a)*t)+h>v)throw z("Wrong length!");s=o/t}else s=m(n),o=s*t,r=new G(o);for(_(e,"_d",{b:r,o:h,l:o,e:s,v:new X(r)});d<s;)x(e,d++)}),T=f.prototype=M(je),_(T,"constructor",f)):r(function(){f(1)})&&r(function(){new f(-1)})&&w(function(e){new f,new f(null),new f(1.5),new f(e)},!0)||(f=n(function(e,n,i,a){u(e,f,c);var r;return E(n)?n instanceof G||"ArrayBuffer"==(r=S(n))||"SharedArrayBuffer"==r?void 0!==a?new v(n,Me(i,t),a):void 0!==i?new v(n,Me(i,t)):new v(n):ye in n?De(f,n):Re.call(f,n):new v(m(n))}),Q(g!==Function.prototype?C(v).concat(C(g)):C(v),function(e){e in f||_(f,e,v[e])}),f.prototype=T,i||(T.constructor=f));var R=T[fe],O=!!R&&("values"==R.name||void 0==R.name),L=Pe.values;_(f,me,!0),_(T,ye,c),_(T,Se,!0),_(T,ve,f),(l?new f(1)[pe]==c:pe in T)||j(T,pe,{get:function(){return c}}),b[c]=f,o(o.G+o.W+o.F*(f!=v),b),o(o.S,c,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*r(function(){v.of.call(f,1)}),c,{from:Re,of:Oe}),"BYTES_PER_ELEMENT"in T||_(T,"BYTES_PER_ELEMENT",t),o(o.P,c,Ne),F(c),o(o.P+o.F*Te,c,{set:Fe}),o(o.P+o.F*!O,c,Pe),i||T.toString==_e||(T.toString=_e),o(o.P+o.F*r(function(){new f(1).slice()}),c,{slice:we}),o(o.P+o.F*(r(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!r(function(){T.toLocaleString.call([1,2])})),c,{toLocaleString:ke}),N[c]=O?R:L,i||O||_(T,fe,L)}}else e.exports=function(){}},function(e,t,n){var i=n(217),a=n(9),r=n(90)("metadata"),o=r.store||(r.store=new(n(220))),s=function(e,t,n){var a=o.get(e);if(!a){if(!n)return;o.set(e,a=new i)}var r=a.get(t);if(!r){if(!n)return;a.set(t,r=new i)}return r},l=function(e,t,n){var i=s(t,n,!1);return void 0!==i&&i.has(e)},c=function(e,t,n){var i=s(t,n,!1);return void 0===i?void 0:i.get(e)},u=function(e,t,n,i){s(n,i,!0).set(e,t)},d=function(e,t){var n=s(e,t,!1),i=[];return n&&n.forEach(function(e,t){i.push(t)}),i},_=function(e){return void 0===e||"symbol"==typeof e?e:String(e)},h=function(e){a(a.S,"Reflect",e)};e.exports={store:o,map:s,has:l,get:c,set:u,keys:d,key:_,exp:h}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(4),d=i(u),_=n(0).utils,h=n(5).SVMXObject,f={name:"com.servicemax.client.sfmdelivery.constants"};f.Constants=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),t}(h),f.Constants.LOOKUP_CALL_TYPE_META="META",f.Constants.LOOKUP_CALL_TYPE_DATA="DATA",f.Constants.LOOKUP_CALL_TYPE_BOTH="BOTH",f.Constants.PREF_LOGGING="LOGGING",f.Constants.RECORD_TYPE_ID="RecordTypeId",f.Constants.NO_VALUE="noValue",_.defineGlobal(f.name,f),e.exports=f},function(e,t){e.exports=!1},function(e,t,n){var i=n(68)("meta"),a=n(21),r=n(38),o=n(27).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(20)(function(){return l(Object.preventExtensions({}))}),u=function(e){o(e,i,{value:{i:"O"+ ++s,w:{}}})},d=function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,i)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[i].i},_=function(e,t){if(!r(e,i)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[i].w},h=function(e){return c&&f.NEED&&l(e)&&!r(e,i)&&u(e),e},f=e.exports={KEY:i,NEED:!1,fastKey:d,getWeak:_,onFreeze:h}},function(e,t,n){var i=n(23)("unscopables"),a=Array.prototype;void 0==a[i]&&n(35)(a,i,{}),e.exports=function(e){a[i][e]=!0}},function(e,t,n){var i=n(161),a=n(160);e.exports=function(e){return i(a(e))}},function(e,t,n){var i=n(49),a=n(95);e.exports=n(55)?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(59);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){var i=n(196),a=n(136);e.exports=Object.keys||function(e){return i(e,a)}},function(e,t,n){var i=n(46),a=Math.max,r=Math.min;e.exports=function(e,t){return e=i(e),e<0?a(e+t,0):r(e,t)}},function(e,t,n){var i=n(15),a=n(197),r=n(136),o=n(135)("IE_PROTO"),s=function(){},l=function(){var e,t=n(133)("iframe"),i=r.length;for(t.style.display="none",n(137).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[r[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[o]=e):n=l(),void 0===t?n:a(n,t)}},function(e,t,n){var i=n(196),a=n(136).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,a)}},function(e,t,n){"use strict";var i=n(17),a=n(27),r=n(26),o=n(23)("species");e.exports=function(e){var t=i[e];r&&t&&!t[o]&&a.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(44),a=n(209),r=n(148),o=n(15),s=n(25),l=n(150),c={},u={},t=e.exports=function(e,t,n,d,_){var h,f,p,m,v=_?function(){return e}:l(e),g=i(n,d,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(r(v)){for(h=s(e.length);h>y;y++)if((m=t?g(o(f=e[y])[0],f[1]):g(e[y]))===c||m===u)return m}else for(p=v.call(e);!(f=p.next()).done;)if((m=a(p,g,f.value,t))===c||m===u)return m};t.BREAK=c,t.RETURN=u},function(e,t,n){var i=n(36);e.exports=function(e,t,n){for(var a in t)i(e,a,t[a],n);return e}},function(e,t,n){var i=n(21);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(231);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,a){return e.call(t,n,i,a)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(129),a=n(690),r=n(691),o=n(692),s=n(386),l=n(387),c=n(693),u=n(0).utils;u.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.runtime.application"}')),u.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.runtime.uitheme"}')),u.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.runtime.namedinstance"}')),u.registerService(JSON.parse('{"id":"com.servicemax.client.logging","class-name":"com.servicemax.client.lib.services.LoggingService"}')),u.registerService(JSON.parse('{"id":"com.servicemax.client.resourceloader","class-name":"com.servicemax.client.lib.services.ResourceLoaderService"}')),u.registerService(JSON.parse('{"id":"com.servicemax.client.niservice","class-name":"com.servicemax.client.runtime.impl.NamedInstanceService"}')),u.registerService(JSON.parse('{"id":"com.servicemax.client.themeservice","class-name":"com.servicemax.client.runtime.impl.ThemeService"}')),u.registerService(JSON.parse('{"id":"com.servicemax.client.preferences","class-name":"com.servicemax.client.runtime.impl.Preferences"}')),e.exports={api:i,impl:a,jsee:{api:r,expressions:o},constants:s,js_dataaccessapi:l,js_DAIErrorFactory:c}},function(e,t,n){var i=n(27).f,a=n(38),r=n(23)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,n){var i=n(45),a=n(23)("toStringTag"),r="Arguments"==i(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),a))?n:r?i(t):"Object"==(s=i(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var i=n(9),a=n(52),r=n(20),o=n(139),s="["+o+"]",l="",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),d=function(e,t,n){var a={},s=r(function(){return!!o[e]()||l[e]()!=l}),c=a[e]=s?t(_):o[e];n&&(a[n]=c),i(i.P+i.F*s,"String",a)},_=d.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},function(e,t){e.exports={}},function(e,t,n){var i=n(160);e.exports=function(e){return Object(i(e))}},function(e,t,n){var i=n(230),a=n(166);e.exports=Object.keys||function(e){return i(e,a)}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(31),r=i(a),o=n(50),s=i(o),l=n(16),c=i(l),u=n(1),d=i(u),_=n(2),h=i(_),f=n(6),p=i(f),m=n(3),v=i(m),g=n(4),y=i(g),S=n(30),E=i(S),b=n(10),T=n(0).utils,M=n(5).SVMXObject,I=n(7).ServerInfo,C=n(12).DatetimeUtil,A=n(7).Cache,D=n(7).Attachments,x=n(11),R=n(11).File,O=n(7).MetaData,L=O,k=I,N=n(56),w=n(130),F=n(101),P=n(103),q=n(390),V=n(391),B=n(181),j=n(393),H=n(394),z={name:"com.servicemax.client.sync.api"};(0,E.default)(z,N,w,F,P,q,B,j,V,H,{name:z.name});var U=function(){return T.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};z.SyncEventCollection=function(e){function t(e,n){(0,h.default)(this,t);var i=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return i.__logger=T.getLoggingService().getLogger("SYNC-API"),i.__syncManager=e,i.__state=n.state||{},i.__requestId=n.requestId,i.__eventGroup=n.eventGroup,i.__onCompletedCollection=n.onCompleted,i.__syncEvents=null,i.__syncEventCounter=null,i}return(0,y.default)(t,e),(0,p.default)(t,[{key:"triggerAll",value:function(){if(this.stopAll(),this.__syncEvents=[],!(this.__eventGroup.length>0))return this.__onCompleted();this.__onStarted();for(var e=0;e<this.__eventGroup.length;e++)if(this.__eventGroup[e]){if(!z[this.__eventGroup[e]])return this.__logger.error("Sync event not found: "+this.__eventGroup[e]),this.stopAll();var t=this.__eventGroup[e],n="com.servicemax.client.sync.api."+t;this.__syncEvents[e]=T.create(n,{requestId:this.__requestId,onInfo:this.__onEventInfo,onError:this.__onEventError,onStarted:this.__onEventStarted,onProgress:this.__onEventProgress,onCompleted:this.__onEventCompleted,onRequestStarted:this.__onEventRequestStarted,onRequestCompleted:this.__onEventRequestCompleted,onConnectionWarning:this.__onEventConnectionWarning,onConnectionLoss:this.__onConnectionLoss,onAttachmentCompleted:this.__onAttachmentCompleted},t,this)}for(var e=0;e<this.__syncEvents.length;e++)this.__syncEvents[e].trigger(),this.__syncEvents[e].complete()}},{key:"__onStarted",value:function(){this.__syncEventCounter=0,this.__syncManager.dispatchEvent("SYNC_GROUP_STARTED",this)}},{key:"__onCompleted",value:function(e){this.__syncManager.dispatchEvent("SYNC_GROUP_COMPLETED",this),this.__onCompletedCollection.call(this.__syncManager,e)}},{key:"__onEventInfo",value:function(e,t){this.__logger.info(e),this.__syncManager.dispatchEvent("SYNC_INFO",{message:e,syncEvent:t})}},{key:"__onEventError",value:function(e,t){this.__logger.error(e),this.__syncManager.dispatchEvent("SYNC_ERROR",e,t)}},{key:"__onEventStarted",value:function(e){this.__syncEventCounter++,this.__syncManager.dispatchEvent("SYNC_EVENT_STARTED",e)}},{key:"__onEventProgress",value:function(e,t){this.__syncManager.dispatchEvent("SYNC_EVENT_PROGRESS",e,t)}},{key:"__onEventCompleted",value:function(e){this.__syncEventCounter--,this.__syncManager.dispatchEvent("SYNC_EVENT_COMPLETED",e),0===this.__syncEventCounter&&(this.__onCompleted(e),this.__syncEvents=[])}},{key:"__onEventRequestStarted",value:function(e){this.__syncManager.dispatchEvent("SYNC_EVENT_REQUEST_STARTED",e)}},{key:"__onEventRequestCompleted",value:function(e){this.__syncManager.dispatchEvent("SYNC_EVENT_REQUEST_COMPLETED",e)}},{key:"__onEventConnectionWarning",value:function(e){this.getState("CONNECTION_WARNED")||(this.setState("CONNECTION_WARNED",!0),this.__syncManager.dispatchEvent("SYNC_EVENT_CONNECTION_WARNING",e))}},{key:"__onConnectionLoss",value:function(e){this.__logger.info(e),this.__syncManager.dispatchEvent("SYNC_CONNECTION_LOSS")}},{key:"__onAttachmentCompleted",value:function(){this.__syncManager.dispatchEvent("SYNC_ATTACHMENTS_STOPPED")}},{key:"stopAll",value:function(){if(this.__syncEvents)for(var e=0;e<this.__syncEvents.length;e++)this.__syncEvents[e].stop()}},{key:"pauseAll",value:function(){if(this.__syncEvents)for(var e=0;e<this.__syncEvents.length;e++)this.__syncEvents[e].pause()}},{key:"resumeAll",value:function(){if(this.__syncEvents)for(var e=0;e<this.__syncEvents.length;e++)this.__syncEvents[e].resume();this.setState("CONNECTION_WARNED",!1)}},{key:"getState",value:function(e){return e?this.__state[e]:this.__state||{}}},{key:"setState",value:function(e,t){e&&(this.__state[e]=t)}},{key:"getLogger",value:function(){return this.__logger}}]),t}(M),z.CleanUnwantedTableData=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=["RecentItems","SFQuestionBank","SFQBResponseSet","Sync_PiqExisting_Ibs","Sync_Records_Heap","Sync_PiqExisting_Sites"],t=e.length,n=0,i=[];for(n;n<t;n++){var a=e[n],r="DELETE FROM "+a;i.push(r)}this._initSQLServiceRequest({queryArray:i,doRollBack:!1}),this.__logger.info("CleanUnwantedTableData deleted data from  "+t+" tables")}}]),t}(z.SyncEvent),z.SyncCleanUpSelect=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){if(this._hasClientId()){var e={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"CLEAN_UP_SELECT",value:this._getClientId(),valueMap:[]},canFail:!0,lastCall:!0};this._initHTTPServiceRequest(e)}}}]),t}(z.SyncEvent),z.SyncInitServer=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG001","Initializing Sync With Server..."],e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){if("INCREMENTAL DATA SYNC"===this._getLogContext()&&!this.isEnableLogging())return void this.__logger.warn("Skipping init server since sync logging is not enabled.");var e={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"MASTER_SYNC_LOG",value:this._getClientId(),valueMap:[]},canFail:!1};this._initHTTPServiceRequest(e,{handler:function(e){this._setState("USAGE_LOGGING_ENABLED","never");var t=this._serviceDataToObject(e);for(var n in t)"USAGE_LOGGING_ENABLED"===n?this._setState("USAGE_LOGGING_ENABLED",t[n]):"TOOLS_SERVER_URL"===n&&this._setState("TOOLS_SERVER_URL",t[n]);var i=this._getUserId();this._isInitialSync()&&i||this._isConfigSync()?this.refreshUserInfo():this._isInitialSync()&&this.getUserInfo(function(e){this._getUserTrunkInfo(function(t,n){e.UserTechId=t,e.address=n,this.setUserInfo(e)})})}})}},{key:"refreshUserInfo",value:function(){var e={methodName:"getUserInfo",data:{eventName:"UserInfo",eventType:"SFDC"}};this._initHTTPServiceRequest(e,{handler:function(e){e&&this.__getNativeTimeZoneOffset(e,function(){this._getUserTrunkInfo(function(t,n){e.UserTechId=t,e.street=n.street,e.city=n.city,e.state=n.state,e.country=n.country,e.zip=n.zip,e.latitude=n.latitude,e.longitude=n.longitude,this.setUserInfo(e,!0)})})}})}},{key:"__getNativeTimeZoneOffset",value:function(e,t){this._initNativeServiceRequest("LoginInfo",{},{handler:function(n){n&&(e.SalesForceTimezoneOffset=e.TimezoneOffset,e.TimezoneOffset=n.TimeZoneOffSet,e.Timezone=n.TimeZone,t&&t.call(this))}})}}]),t}(z.SyncEvent),z.SyncCacheOldSFAttachmentRecords=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._initSQLServiceRequest({query:"SELECT file_path from SFAttachments"},{handler:function(e){e&&e.length>0&&(A.registerJSCache("Old_SFAttachment_File_Path",1),A.readFromJSCache("Old_SFAttachment_File_Path","Old_SFAttachment_File_Path")||A.writeToJSCache("Old_SFAttachment_File_Path","Old_SFAttachment_File_Path",T.toJSON(e.map(function(e){return e.file_path.replace("\\","/")}))))}})}}]),t}(z.SyncEvent),z.UserTrunk=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this.getUserInfo(function(e){this._getUserTrunkInfo(function(t,n,i){if(e.UserTechId=t,e.address=n,i&&e.UserTrunkDetail)for(key in i)e.UserTrunkDetail[key]=i[key];this.setUserInfo(e)})})}}]),t}(z.SyncEvent),z.SyncServerVersion=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this,t=(T.getCurrentApplication().getUserInfo().UserSessionId,{type:"POST",methodName:"getSVMXVersion",data:[],headers:[]});e._initHTTPServiceRequest(t,{handler:function(t){var n=void 0;if(!(t.length>0&&t[0].value))return void e.__logger.error("Server Version number not updated.");n=t[0].value;var i="ClientCache";e._tempTableCreated(i)&&(i=T.getTempTableName(i)),I.setServerVersion(n);var a={server_version:n},r=T.toJSON(a),o={query:" INSERT OR REPLACE INTO "+i+" VALUES('SERVER_INFO','"+r+"')"};e._initSQLServiceRequest(o,{handler:function(t){e.__logger.info("Server Version number updated.")}})}})}}]),t}(z.SyncEvent),z.SyncFailedRequestIds=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e={query:"SELECT * FROM 'ClientCache' WHERE key = 'LAST_FAILED_REQUEST_IDS';"};this._initSQLServiceRequest(e,{handler:T.proxy(this,function(e){if(e=e||[],e.length>0){e=e[0];var t="INSERT INTO TEMP__ClientCache (key, value) VALUES ('"+e.key+"','"+e.value+"');";this._initSQLServiceRequest({query:t},{handler:function(){}})}})})}}]),t}(z.SyncEvent),z.SyncAttachments=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this.__totalCount=0,this.__currentStep=0,this._describeObjectByName("Attachment",function(e){this.__describeLabel=e&&e.labelPlural?e.labelPlural:"Attachments",this._afterObjectDescribe()})}},{key:"_afterObjectDescribe",value:function(){this.__checkTotalAndStart()}},{key:"__checkTotalAndStart",value:function(){this.getTotalCount(function(e){this.start()})}},{key:"start",value:function(e){this._downloadAttachmentBody({syncType:"initial",attachmentRec:e||[],isSalesforceFile:!1},function(){this._downloadAttachmentBody({syncType:"initial",attachmentRec:e||[],isSalesforceFile:!0},function(){this.__logger.info("Salesforce Files download (initial) done")})})}},{key:"stop",value:function(){this.__stopped=!0}},{key:"incrementProgress",value:function(){this.__currentStep++,this.__onProgress({currentStep:this.__currentStep,totalCount:this.__totalCount,description:this.__describeLabel})}},{key:"getTotalCount",value:function(e){if(this.__totalCount)return e(this.__totalCount);this.__getTotalAttachmentCount(function(t){this.__getTotalSmartDocCount(function(n){return this.__totalCount=t+n,e.call(this,this.__totalCount)})})}},{key:"__getTotalAttachmentCount",value:function(e){this._initSQLServiceRequest({query:this._getAttachmentCountQuery()},{handler:function(t){var n=0;t&&t[0]&&(n=parseInt(t[0]["count(1)"],10)),this._initSQLServiceRequest({query:"SELECT count(1) FROM SFAttachments sfa LEFT JOIN Attachment a ON sfa.Id = a.Id WHERE a.Id IS NULL AND sfa.parent_id NOT LIKE '%local%' "},{handler:function(t){return t&&t[0]&&(n+=parseInt(t[0]["count(1)"],10)),e.call(this,n)}})}})}},{key:"_getAttachmentCountQuery",value:function(){return"SELECT count(1) FROM Attachment a"}},{key:"__getTotalSmartDocCount",value:function(e){this._initSQLServiceRequest({query:"SELECT count(1) FROM SmartDocHTML a "},{handler:function(t){var n=0;return t&&t[0]&&(n=parseInt(t[0]["count(1)"],10)),e.call(this,n)}})}}]),t}(z.SyncEvent),z.SyncAttachmentsInitial=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),t}(z.SyncAttachments),z.SyncAttachmentsIncremental=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.attachedRecords={},e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"start",value:function(){this.targetedAttchmentsOnly=!1,this.performSteps()}},{key:"performSteps",value:function(){this.attachedRecords={};var e="ONECALLSYNC";this.targetedAttchmentsOnly&&(e="TARGETEDSYNC"),this.sFCVIdMappings=null,this._uploadSmartDocs(function(){this._performSalesforceFileSync(function(){this._performSalesforceFileSyncForVersionedPDFs(function(){this._uploadAttachments(function(){this._submitUploadedSmartDocs(function(t){this._downloadAttachmentsOptimized(function(){this._downloadAttachmentBody({syncType:e,parentId:this.parentRecordId,isSalesforceFile:!1},function(){this._downloadAttachmentBody({syncType:e,parentId:this.parentRecordId,isSalesforceFile:!0},function(){this.__logger.info("Salesforce files download (incremental) done")})})},t)})})})})})}},{key:"stop",value:function(){this.__stopped=!0}},{key:"_getAttachmentCountQuery",value:function(){return"SELECT count(1) FROM Attachment a LEFT JOIN SFAttachments sfa ON a.Id = sfa.Id WHERE (sfa.Id IS NOT NULL AND (sfa.downloaded = '' OR sfa.downloaded = 'false' OR sfa.downloaded IS NULL OR sfa.last_modified_date IS NULL)) OR sfa.Id IS NULL"}},{key:"_uploadSmartDocs",value:function(e){this.__attachedSmartDocHTMLs=[],this.__uploadedSmartDocHTMLs=[],this.__submittedSmartDocHTMLs=[],this.__attachedSmartDocSigs=[],this.__uploadedSmartDocSigs=[],this.__submittedSmartDocSigs=[],this.__checklistAttachments=[],this.getUserInfo(function(t){var n="";this.targetedAttchmentsOnly&&this.parentRecordId&&(n=" WHERE record_id = '"+this.parentRecordId+"'");var i=this._initSQLServiceRequest({query:"SELECT * FROM SmartDocHTML "+n}).then(T.proxy(this,function(e){var n=b.when(1);if(e&&e.length)for(var i=0;i<e.length;i++){var a=e[i];a.Id.match(/_local_/)?(this.__attachedSmartDocHTMLs.push(a.Id),n=n.then(T.proxy(this,function(e){return this.__createSmartDocAttachmentLocal(t,e)},a))):"true"===a.submitted?this.__submittedSmartDocHTMLs.push(a.Id):this.__uploadedSmartDocHTMLs.push(a.Id)}return n})),a=this._initSQLServiceRequest({query:"SELECT * FROM SmartDocSignature "+n}).then(T.proxy(this,function(e){var n=b.when(1);if(e&&e.length)for(var i=0;i<e.length;i++){var a=e[i];a.attachment&&"true"===a.attachment?this.__checklistAttachments.push(a.Id):a.Id.match(/_local_/)&&null!==a.html_name&&""!==a.html_name?(this.__attachedSmartDocSigs.push(a.Id),n=n.then(T.proxy(this,function(e){return this.__createSmartDocAttachmentLocal(t,e)},a))):"true"===a.submitted?this.__submittedSmartDocSigs.push(a.Id):null!==a.html_name&&""!==a.html_name&&this.__uploadedSmartDocSigs.push(a.Id)}return n}));this.__serviceRequestCount++,b.when(i,a).done(T.proxy(this,function(){this.__serviceRequestCount--,e.call(this)}))})}},{key:"__createSmartDocAttachmentLocal",value:function(e,t){var n=b.when(1);if(t.Id.match(/_local_/)&&(!t.attachment||""===t.attachment||"false"===t.attachment)){var i=k.getMultiServerVersionRequest(),a=i.isSalesForceFilesEnabled()?"SFILE":null;n=n.then(T.proxy(this,function(){return this._insertUpdateAttachmentMetadata({Id:t.Id,parent_id:t.record_id,created_by_id:e.UserId,name:t.name,file_path:"{UploadDirectory}/"+t.name,file_type:a})})),n=n.then(T.proxy(this,function(){return this._insertUpdateSyncRecord({Id:t.Id,record_type:"attachment",operation:"insert",parent_id:t.record_id,modified_at:C.getCurrentDatetimeGMT(C.getSaveFormat("dateTime"))})}))}return n}},{key:"__isChecklistAttachmentEnabled",value:function(){if(k){return k.getMultiServerVersionRequest().isChecklistAttachementsEnabled()}return!1}},{key:"__isTableInDatabase",value:function(e){var t=!1;return L.isTableInDatabase(e)&&(t=!0),t}},{key:"_uploadAttachments",value:function(e){var t="SELECT a.* FROM SFAttachments a LEFT JOIN ClientSyncLog l ON a.Id = l.Id ";t+="WHERE l.record_type = 'attachment'AND a.parent_id NOT LIKE '%local%' ",this.targetedAttchmentsOnly&&this.parentRecordId&&(t+=" AND a.parent_id = '"+this.parentRecordId+"'");var n=A.readFromJSCache("attachedFileDetails","filesAttached"),i=A.readFromJSCache("attachedFileDetails","deletedContentVersions");i&&i.cVIds&&(n=n||[],n=n.concat(i.cVIds)),n&&(t+=D.getSubQueryForAttachmentsToIgnore(n,"a")),this._initSQLServiceRequest({query:t},{handler:function(t){if(!t||!t[0])return e&&e.call(this);var n=[];this.__serviceRequestCount++,z.Utils.executeUntilDone({data:t,inParallelProcessCount:3,process:T.proxy(this,function(e){if(this.__stopped){var t=T.Deferred();return t.reject(!0),t}return this.__processUploadSFAttachmentsRecord(e,n)}),onSuccess:T.proxy(this,function(){this.__syncUploadedAttachmentRecords(n,function(){this._complete(),this.__onAttachmentCompleted();var t=T.cloneObject(this.attachedRecords);(0,c.default)(t).length>0&&this.__isTableInDatabase(T.OrgNamespace+"__SM_Checklist_Attachment__c")&&this.__isChecklistAttachmentEnabled()&&new com.servicemax.client.lib.api.ExtensionRunner.run(this,"com.servicemax.client.checklist.attachment.extension",{attachmentData:t});e&&e.call(this)})}),onError:T.proxy(this,function(t){e&&e.call(this)})})}})}},{key:"__makeEntrytoClientSyncLog",value:function(e,t,n){for(var i=[],a=n,r=t,o=C.getCurrentDatetimeGMT(C.getSaveFormat("dateTime")),s=0;s<e.length;s++){var l=e[s],c="INSERT INTO ClientSyncLog (Id, record_type, operation, modified_at) VALUES ('"+l+"', '"+a+"', '"+r+"', '"+o+"')";i.push(c)}return this._initSQLServiceRequest({queryArray:i,doRollBack:!1})}},{key:"__processUploadSFAttachmentsRecord",value:function(e,t){return e&&"SFILE"===e.file_type?this.__processUploadFileRecord(e,t):this.__processUploadAttachmentRecord(e,t)}},{key:"__uploadSalesforceFile",value:function(e){var t=T.Deferred(),n=this,i=x.Facade.createHTTPRequest();return i.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)},n),i.bind("REQUEST_ERROR",function(e){logger.error(e.data.data),t.resolve([])},n),i.execute(e),t}},{key:"__processUploadFileRecord",value:function(e,t,n){var i=this,a=T.Deferred(),r=this,o=T.proxy(this,function(){n&&n.call(i,null),a.resolve()}),s=e.parent_id,l=this.sFCVIdMappings?this.sFCVIdMappings[e.Id]:null;if(!s||s.match(/_local_/)||!l)return o(),a;var c=e.file_path;this.__onInfo("(HTTP) Uploading Salesforce File: "+c+" ("+s+")");var u=e.Id||e.id,d=this.isAlreadyAttached(u),_={parentId:s,file:c,name:e.name,objectName:"ContentVersion",contentVersionId:l};return d?r.__uploadAttachmentHandler(this.attachedRecords[u],o,t,e,_):r._initNativeServiceRequest("Upload",_,{handler:function(n){r.__uploadAttachmentHandler(n,o,t,e,_)}}),a}},{key:"__parseCompositeRespose",value:function(e,t){var n=null,i=null,a={};if(a.Success=!1,e&&e.compositeResponse&&e.compositeResponse.length>0){n=e.compositeResponse;for(var r=n.length,o=0;o<r&&(n[o]&&n[o].httpStatusCode&&(i=n[o].httpStatusCode,a.Success=i>=200&&i<300),a.Success);o++);}return a}},{key:"__processUploadAttachmentRecord",value:function(e,t){var n=this,i=T.Deferred(),a=T.proxy(this,function(){return i.resolve()}),r=e.parent_id;if(!r||r.match(/_local_/))return a();var o=e.file_path;this.incrementProgress(),this.__onInfo("(HTTP) Uploading attachment: "+o+" ("+r+")");var s={parentId:r,file:o,name:e.name},l=this,c=e.Id||e.id;return this.isAlreadyAttached(c)?l.__uploadAttachmentHandler(this.attachedRecords[c],a,t,e,s):this.isUploadedToServer(s,c,function(i){if(i.isAttachedAtServer){l.__logger.info("File upload: already uploaded"),n.attachedRecords[c]=i.sfID;var r={id:i.sfID,success:!0,error:[]};l.__uploadAttachmentHandler(r,a,t,e,s)}else l.__logger.info("File upload: not uploaded, it is a new file "),n.attachedRecords[c]="",l._initNativeServiceRequest("Upload",s,{handler:function(n){l.__uploadAttachmentHandler(n,a,t,e,s)}})}),i}},{key:"isAlreadyAttached",value:function(e){return!!this.attachedRecords.hasOwnProperty(e)}},{key:"isUploadedToServer",value:function(e,t,n){var i={isAttachedAtServer:!1,sfID:null};if(t.startsWith("smd_local_")||t.startsWith("sig_local_")){var a={queryData:"SELECT Id FROM Attachment WHERE Name = '"+e.name+"' and ParentId = '"+e.parentId+"'",method:"POST",protocol:"ATTACHMENTSOAP"};this._initHTTPServiceRequest(a,{handler:function(e,t,a,r){if(e&&!a&&!r){var o=T.stringToXML(e),s=T.xmlToJson(o);if(s.Envelope&&s.Envelope.Body&&s.Envelope.Body.queryResponse&&s.Envelope.Body.queryResponse.result){var l=s.Envelope.Body.queryResponse.result;if(l.size&&l.records&&l.records.Id){var c=l.records.Id||[];if(c.length>0){var u=c[0],d=u["#text"];d&&(i.isAttachedAtServer=!0,i.sfID=d)}}}}n&&n.call(this,i)}})}else n&&n.call(this,i)}},{key:"__uploadAttachmentHandler",value:function(e,t,n,i,a){if(null!==e&&0===e.length&&a&&"ContentVersion"===a.objectName&&a.contentVersionId&&a.contentVersionId.length>0)e={},e.Id=a.contentVersionId;else if(e&&e.compositeResponse&&e.compositeResponse.length>0){var r=this.__parseCompositeRespose(e,i.Id);r.Success&&a&&"ContentVersion"===a.objectName&&a.contentVersionId&&a.contentVersionId.length>0&&(e={},e.Id=a.contentVersionId)}var o=!(!a||"ContentVersion"!==a.objectName);if(!e||!e.id&&!e.Id)return this._insertUpdateSyncConflict({Id:i.id,parent_id:a.parentId,operation:"insert",error_type:"error",error_message:U().T("FSA010_TAG116","Unauthorized Access. You do not have permission to perform this action")+" ("+i.name+")",override_flag:""}),t();var s=e.id||e.Id,l=i.Id||i.id;this.__checkAttachmentRecordExists(l).always(T.proxy(this,function(e){if(!(e&&e.length>0))return this._deleteSyncRecord(l),this._deleteSyncConflict(l),z.Utils.SyncData.writeSyncRecords({deletedRecords:[{Id:s,recordType:"attachment",objectName:"Attachment"}]}),t&&t.call(this);this._deleteSyncRecord(l).then(T.proxy(this,this._deleteSyncConflict,l)).then(T.proxy(this,function(){this._updateRecord("SFAttachments",{Id:s},l,function(){this.__isChecklistAttachmentEnabled()&&this.__isTableInDatabase(T.OrgNamespace+"__SM_Checklist_Attachment__c")&&this.updateChecklistAttachment(s,l,o),this.attachedRecords[l]=s,e.Id=s,z.Utils.SyncData.addOpenRecordRemoteId(l,s),this.__processUploadedSmartDocAssets(i,s,t)||(n.push(s),i.Id=s,i.localId=l,this.__moveUploadToDownload(i,function(){return t()}))})}))}))}},{key:"updateChecklistAttachment",value:function(e,t,n){if(!n){var i=T.OrgNamespace+"__SM_Checklist_Attachment__c",a=T.OrgNamespace+"__SM_Attachment_ID__c",r="UPDATE "+i+" SET "+a+" = '"+e+"' WHERE "+a+" = '"+t+"'";this._initSQLServiceRequest({query:r},{handler:function(e){}})}var o=this.getSyncManager();o&&(o.__uploadedRecords||(o.__uploadedRecords={}),o.__uploadedRecords[t]=e)}},{key:"getISOString",value:function(){var e=C.getTimestampWithSaveFormat(),t=C.parseDate(e);return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T"+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":00.000+0000"}},{key:"__checkAttachmentRecordExists",value:function(e){var t="SELECT Id, name FROM SFAttachments WHERE Id = '"+e+"'";return this._initSQLServiceRequest({query:t})}},{key:"__moveUploadToDownload",value:function(e,t){var n=e.file_path,i=e.Id+"_"+e.name,a="{DownloadDirectory}/"+i,r=this.getISOString();this._updateRecord("SFAttachments",{downloaded:!0,file_path:a,last_modified_date:r},e.Id,function(){new x.File(n).move(a).then(T.proxy(this,function(){var n=T.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();T.timer.job("ATTACHMENTS_CHANGED_SYNC"+e.parent_id,500,this,function(){var t=T.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{recordId:e.parent_id,attachmentLocalId:e.localId,attachmentId:e.Id}});n.triggerEvent(t)});var i=T.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_UPLOADED",this,{request:{recordId:e.parent_id,attachmentLocalId:e.localId,attachmentId:e.Id}});return n.triggerEvent(i),t&&t.call(this)}))})}},{key:"__syncUploadedAttachmentRecords",value:function(e,t){t.call(this)}},{key:"__processUploadedSmartDocAssets",value:function(e,t,n){var i=!0;if(-1!==this.__checklistAttachments.indexOf(e.Id)){var a=this.__checklistAttachments.indexOf(e.Id);this.__checklistAttachments.splice(a,1),this.__checklistAttachments.splice(a,0,t),this._updateRecord("SmartDocSignature",{Id:t},e.Id),i=!1}return-1!==this.__attachedSmartDocHTMLs.indexOf(e.Id)?this._updateRecord("SmartDocHTML",{Id:t},e.Id,function(){return this.__uploadedSmartDocHTMLs.push(t),n()}):-1!==this.__attachedSmartDocSigs.indexOf(e.Id)?this._updateRecord("SmartDocSignature",{Id:t},e.Id,function(){return this.__uploadedSmartDocSigs.push(t),n()}):i=!1,i}},{key:"__processSubmittedSmartDocAssets",value:function(e,t,n){if(-1!==this.__attachedSmartDocHTMLs.indexOf(e.Id))this._updateRecord("SmartDocHTML",{Id:t},e.Id,function(){return this.__uploadedSmartDocHTMLs.push(t),n()});else{if(-1===this.__attachedSmartDocSigs.indexOf(e.Id))return!1;this._updateRecord("SmartDocSignature",{Id:t},e.Id,function(){return this.__uploadedSmartDocSigs.push(t),n()})}return!0}},{key:"_submitUploadedSmartDocs",value:function(e){k.getMultiServerVersionRequest().isSalesForceFilesEnabled()?this.__submitUploadedSmartDocsForFiles(e):this.__submitUploadedSmartDocsForAttachments(e)}},{key:"__submitUploadedSmartDocsForAttachments",value:function(e){if(0===this.__uploadedSmartDocHTMLs.length)return void(this.__submittedSmartDocHTMLs.length>0?this.__generatePDFsFromSubmittedSmartDocs(e):e.call(this));var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SUBMIT_DOCUMENT",valueMap:[{key:"HTMLID",values:this.__uploadedSmartDocHTMLs},{key:"SIGNATURE",values:this.__uploadedSmartDocSigs.concat(this.__checklistAttachments)}]}};this._initHTTPServiceRequest(t,{handler:function(t){var n=this._serviceDataToObject(t);if(!n)return e.call(this);this.__removeSmartDocsPostProcessing(n,"DELETE_ID"),this.__removeAttachmentsFromSmartDocSig();for(var i=0;i<this.__uploadedSmartDocHTMLs.length;i++){var a=this.__uploadedSmartDocHTMLs[i];this._updateRecord("SmartDocHTML",{submitted:"true"},a),this.__submittedSmartDocHTMLs.push(a)}for(var r=0;r<this.__uploadedSmartDocSigs.length;r++){var a=this.__uploadedSmartDocSigs[r];this._updateRecord("SmartDocSignature",{submitted:"true"},a),this.__submittedSmartDocSigs.push(a)}this.__generatePDFsFromSubmittedSmartDocs(e)}})}},{key:"__removeAttachmentsFromSmartDocSig",value:function(){var e="DELETE from SmartDocSignature where html_name in (select name from SmartDocHTML where id in ('"+this.__uploadedSmartDocHTMLs.join("','")+"')) AND attachment='true'";this._initSQLServiceRequest({query:e})}},{key:"__generatePDFsFromSubmittedSmartDocs",value:function(e){var t=this,n=this.__uploadedSmartDocSigs.filter(function(e){return t.__checklistAttachments.indexOf(e)<0}),i={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"GENERATE_PDF",valueMap:[{key:"HTMLID",values:this.__uploadedSmartDocHTMLs},{key:"SIGNATURE",values:n}]}};this._initHTTPServiceRequest(i,{handler:function(t){var n=this._serviceDataToObject(t);return n?(this.__removeSmartDocsPostProcessing(n,"SIGNATURE"),e.call(this,n.HTMLID)):e.call(this)}})}},{key:"__submitUploadedSmartDocsForFiles",value:function(e){var t=this,n=this;this._getHtmlSigMappingForFiles(function(i){function a(){if(l>0&&s&&s.length>0){var t=s.splice(0,1),r=i[t]||{};r.submitted?0===u&&o()&&n._generatePDFForFiles(i,e):(l--,u++,n.__makeRequestForSubmitDocFile(t,r,d)),a()}}function r(){if(s&&s.length>0){var t=s.splice(0,1),a=i[t]||{};a.submitted?o()?0===u&&o()&&n._generatePDFForFiles(i,e):r():(u++,n.__makeRequestForSubmitDocFile(t,a,d))}else 0===u&&o()&&n._generatePDFForFiles(i,e)}function o(){return!s||s&&0===s.length}if(!i)return e&&e.call(t);var s=(0,c.default)(i);if(o())return e&&e.call(t);var l=3,u=0,d=function(e){if(u--,e){var t=i[e];t&&(t.submitted=!0,i[e]=t)}r()};a()})}},{key:"__makeRequestForSubmitDocFile",value:function(e,t,n){var i=t.sigIds||[],a=t.attIds||[],r=this._getSubmitDocRequestForFiles(e,i,a);this._initHTTPServiceRequest(r,{handler:function(t){var r=null,o=this._serviceDataToObject(t);if(o){this.__removeSmartDocsPostProcessing(o,"DELETE_ID"),this._updateRecord("SmartDocHTML",{submitted:"true"},{Id:e});for(var s=0;s<i.length;s++)this._updateRecord("SmartDocSignature",{submitted:"true"},{Id:i[s]});for(var l=0;l<a.length;l++)this._updateRecord("SmartDocSignature",{submitted:"true"},{Id:a[l]});r=e}n&&n.call(this,r)}})}},{key:"_getSubmitDocRequestForFiles",value:function(e,t,n){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SUBMIT_DOCUMENT_FILES",valueMap:[{key:"HTMLID",valueMap:[{key:"ContentVersion",values:e}]},{key:"SIGNATURE",valueMap:[{key:"ContentVersion",values:t},{key:"Attachment",values:n}]}]}}}},{key:"_getHtmlSigMappingForFiles",value:function(e){var t={query:"Select htmlrecord.Id as htmlID, htmlrecord.file_process_id as processID, htmlrecord.version_enabled as versionEnabled, sigrecord.Id as sigID, sigrecord.attachment as attachment, cVRecord.ContentDocumentID as htmlCDID, cdlrecord.Id as cDLID, cVRecord2.ContentDocumentID as cDID, htmlrecord.submitted as submitted from SmartDocHTML htmlrecord LEFT JOIN SmartDocSignature sigrecord ON sigrecord.html_name = htmlrecord.name LEFT JOIN ContentVersion cVRecord ON cVRecord.Id = htmlrecord.Id LEFT JOIN ContentVersion cVRecord2 ON cVRecord2.Id = sigrecord.Id LEFT JOIN ContentDocumentLink cdlrecord ON cdlrecord.ContentDocumentID = cVRecord.ContentDocumentID"};this._initSQLServiceRequest(t,{handler:function(t){var n=null;if(t&&t.length>0){n={};for(var i=0;i<t.length;i++)if(t[i].htmlID){var a=t[i],r=n[a.htmlID]||{};if(r.processID=a.processID,r.versionEnabled=a.versionEnabled,r.cDLID=a.cDLID,r.submitted=a.submitted,r.htmlCDID=a.htmlCDID,a.sigID)if(a.cDID){var o=r.sigIds||[];o.push(a.sigID),r.sigIds=o}else{var s=r.attIds||[];s.push(a.sigID),r.attIds=s}if(a.cDID&&(!a.attachment||"true"!==a.attachment)){var l=r.cdIds||[];l.push(a.cDID),r.cdIds=l}n[a.htmlID]=r}}e&&e.call(this,n)}})}},{key:"_generatePDFForFiles",value:function(e,t){function n(){if(l>0&&s&&s.length>0){var t=s.slice(0,1),i=e[t]||{};l--,r(i)&&(u++,o.__makeRequestForGenPDF(t,i,_)),n()}}function i(){if(s&&s.length>0){var n=s.slice(0,1),i=e[n]||{};r(i)?(u++,o.__makeRequestForGenPDF(n,i,_)):0===u&&a()&&t&&t.call(o,null)}else 0===u&&a()&&t&&t.call(o,null)}function a(){return!s||s&&0===s.length}function r(e){var t=!0;return e.submitted?(e.versionEnabled&&"true"===e.versionEnabled&&e.processID?-1===d.indexOf(e.processID)?(d.push(e.processID),s.splice(0,1)):t=!1:s.splice(0,1),t):(s.splice(0,1),!1)}var o=this;if(!e)return t&&t.callback(this);var s=(0,c.default)(e);if(a())return t&&t.callback(this);var l=3,u=0,d=[],_=function(e){if(u--,e.processID){var t=d.indexOf(e.processID);-1!==t&&d.splice(t,1)}i()};n()}},{key:"__makeRequestForGenPDF",value:function(e,t,n){var i=this._getGeneratePDFRequestForFiles(t);this._initHTTPServiceRequest(i,{handler:function(i){var a=this,r=this._serviceDataToObject(i);r?this._parseGenPDFResponse(r,e,t,function(){n&&n.call(a,t)}):n&&n.call(this,t)}})}},{key:"_getGeneratePDFRequestForFiles",value:function(e){var t=e.processID||"",n=!(!e.versionEnabled||"true"!==e.versionEnabled),i=e.cdIds||[];return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"GENERATE_PDF_FILES",valueMap:[{key:"HTMLID",values:[e.cDLID],valueMap:[{key:"process_id",value:t},{key:"version_enabled",value:n}]},{key:"SIGNATURE",valueMap:[{key:"ContentDocument",values:i}]}]}}}},{key:"_parseGenPDFResponse",value:function(e,t,n,i){if(e.FINAL_PDF)for(var a=e.FINAL_PDF,r=(0,c.default)(a),o=0;o<r.length;o++){var s=r[o];if("ContentDocumentLink"===s){var l=a[s];if(l){if(l=T.toObject(l),delete l.attributes,l.ContentDocument){var u=l.ContentDocument;u.LatestPublishedVersion&&(this._insertReplaceRecordIncremental("ContentDocument",u),this._insertReplaceRecordIncremental("ContentVersion",u.LatestPublishedVersion))}this._insertReplaceRecordIncremental(s,l)}}}if(e.HTML&&e.HTML.ContentDocumentLink&&e.SIGNATURE){var d={HTMLID:[t],DELETE_ID:n.sigIds};this.__removeSmartDocsPostProcessing(d,"DELETE_ID");var _=[n.htmlCDID];if(n.cdIds&&(_=_.concat(n.cdIds)),this._removeFileRecordsPostProcessing(_),n.attIds)for(var h=0;h<n.attIds.length;h++)this._deleteRecord("SmartDocSignature",n.attIds[h])}i&&i.call(this,null)}},{key:"_removeFileRecordsPostProcessing",value:function(e){if(e&&e.length>0){var t=e.join("','"),n="DELETE FROM ContentDocumentLink WHERE ContentDocumentId IN ('"+t+"');",i="DELETE FROM ContentVersion WHERE ContentDocumentid IN ('"+t+"');",a="DELETE FROM ContentDocument WHERE Id IN ('"+t+"');",r={queryArray:[n,i,a]};this._initSQLServiceRequest(r,{handler:function(e){}})}}},{key:"__removeSmartDocsPostProcessing",value:function(e,t){var n=R;if(e.HTMLID)for(var i=0;i<e.HTMLID.length;i++)(function(e){this._initSQLServiceRequest({query:"SELECT * FROM SmartDocHTML WHERE Id = '"+e+"'"},{handler:T.proxy(this,function(e){var t=e&&e[0];this._deleteRecord("SmartDocHTML",t.Id),this._deleteRecord("SFAttachments",t.Id),new n("{UploadDirectory}/"+t.name).deleteFile()})})}).call(this,e.HTMLID[i]);if(e[t])for(var i=0;i<e[t].length;i++)(function(e){this._initSQLServiceRequest({query:"SELECT * FROM SmartDocSignature WHERE Id = '"+e+"'"},{handler:T.proxy(this,function(e){var t=e&&e[0];this._deleteRecord("SmartDocSignature",t.Id),this._deleteRecord("SFAttachments",t.Id),new n("{UploadDirectory}/"+t.name).deleteFile()})})}).call(this,e[t][i])}},{key:"_performSalesforceFileSync",value:function(e){var t=this,n=this;A.readFromDBCache("SF_FILE_CV_IDS").done(function(i){t.sFCVIdMappings=i?T.toObject(i):null,t._getLocalContentVersionsFromSFAttachments(function(i){i&&i.length>0?A.readFromDBCache("SF_CV_CLIENTID").done(function(a){function r(){var t=[];i&&0!==i.length?i.length<=l?(t=i,i=null,c=0):t=i.splice(0,l):e&&e.call(n,null),c>0&&c--,u++;var a={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_SALESFORCE_FILES",value:s,values:[],valueMap:[{key:"object_name",value:"ContentVersion",valueMap:t}]}};n._initHTTPServiceRequest(a,{handler:function(e){o(e)}}),c>0&&r()}function o(t){function a(){u--,0!==u||i&&0!==i.length?0===u&&(c=3,r()):e&&e.call(n,null)}var o=[];t&&t.valueMap&&t.valueMap.length>0&&(o=n._parseSFileResponse(t)),o.length>0?n._commonSyncObjectRecords(o,"update.incremental",function(){A.writeToDBCache("SF_FILE_CV_IDS",T.toJSON(n.sFCVIdMappings)),A.writeToDBCache("SF_CV_CLIENTID",null),a()}):a()}var s=a||t._getClientId();s!==a&&A.writeToDBCache("SF_CV_CLIENTID",s);var l=5,c=3,u=0;r()}):e&&e.call(t,null)})})}},{key:"_getLocalContentVersionsFromSFAttachments",value:function(e){var t=this.sFCVIdMappings?(0,c.default)(this.sFCVIdMappings):[],n=t.join("','"),i=T.getClient().isLaptop(),a=i?" AND (process_id IS NULL OR process_id = '' ) ":"",r="";this.targetedAttchmentsOnly&&this.parentRecordId&&(r=" AND parent_id = '"+this.parentRecordId+"'");var o={query:"SELECT Id, parent_id, name, description, content_type, process_id from SFAttachments where file_type = 'SFILE' AND Id LIKE '%local%' AND Id NOT IN ('"+n+"') AND parent_id NOT LIKE '%local%' "+a+" "+r};this._initSQLServiceRequest(o,{handler:function(t){var n=[];if(t&&t.length>0)for(var i=0;i<t.length;i++){var a,r=t[i],o=(a={Id:r.Id,Title:r.name,PathOnClient:"{UploadDirectory}/"+r.name,IsMajorVersion:"false",Description:r.description,FileType:r.content_type},(0,s.default)(a,T.OrgNamespace+"__SM_Process_ID__c",r.process_id),(0,s.default)(a,"FirstPublishLocationId",r.parent_id),a),l={key:r.Id,valueMap:[{key:r.parent_id,value:T.toJSON(o)}]};n.push(l)}e&&e.call(this,n)}})}},{key:"_performSalesforceFileSyncForVersionedPDFs",value:function(e){var t=this;if(!T.getClient().isLaptop())return e&&e.call(this,null);var n=this,i=this.sFCVIdMappings?(0,c.default)(this.sFCVIdMappings):null;this._getLocalPdFsForFiles(function(a){if(!a||0===a.length)return e&&e.call(t,null);A.readFromDBCache("SF_CV_CLIENTID").done(function(r){function o(){if(d=a[0],a.splice(0,1),i&&-1!==i.indexOf(d.Id))n._uploadGeneratedPDFToServer(d,function(){a&&a.length>0&&0===u?o():e&&e.call(n,null)});else{var t;u++;var r=(t={Id:d.Id,Title:d.name,PathOnClient:"{UploadDirectory}/"+d.name,IsMajorVersion:"false",Description:d.description,FileType:d.content_type},(0,s.default)(t,T.OrgNamespace+"__SM_Process_ID__c",d.process_id),(0,s.default)(t,"FirstPublishLocationId",d.parent_id),t),_={key:d.Id,valueMap:[{key:d.parent_id,value:T.toJSON(r)}]},h={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_SALESFORCE_FILES",value:c,values:[],valueMap:[{key:"object_name",value:"ContentVersion",valueMap:[_]},{key:"PROCESS_ID",value:d.process_id}]}};n._initHTTPServiceRequest(h,{handler:function(e){l(e)}})}}function l(t){function i(){u--,0!==u||a&&0!==a.length?0===u&&o():e&&e.call(n,null)}var r=[];t&&t.valueMap&&t.valueMap.length>0&&(r=n._parseSFileResponse(t)),r.length>0?n._commonSyncObjectRecords(r,"update.incremental",function(){A.writeToDBCache("SF_FILE_CV_IDS",T.toJSON(n.sFCVIdMappings)),A.writeToDBCache("SF_CV_CLIENTID",null),n._uploadGeneratedPDFToServer(d,function(){i()})}):i()}var c=r||t._getClientId();c!==r&&A.writeToDBCache("SF_CV_CLIENTID",c);var u=0,d=null;o()})})}},{key:"_uploadGeneratedPDFToServer",value:function(e,t){var n=this;e?this.__processUploadFileRecord(e,[],function(){t&&t.call(n,null)}):t&&t.call(this,null)}},{key:"_getLocalPdFsForFiles",value:function(e){var t="";this.targetedAttchmentsOnly&&this.parentRecordId&&(t=" AND parent_id = '"+this.parentRecordId+"'");var n={query:"SELECT Id, parent_id, name, description, content_type, process_id, content_document_id, file_path from SFAttachments where file_type = 'SFILE' AND Id LIKE '%local%' AND (process_id IS NOT NULL AND process_id != '') AND parent_id NOT LIKE '%local%' AND content_type = 'pdf' "+t+" "};this._initSQLServiceRequest(n,{handler:function(t){for(var n=[],i=0;i<t.length;i++)n.push(t[i]);e&&e.call(this,n)}})}},{key:"_parseSFileResponse",value:function(e){for(var t=this,n=[],i=[],a=[],r=[],o=e.valueMap,s=[],l=0;l<o.length;l++){var c=o[l];if("ERROR"===c.key)t.__logger.info("SALESFORCE FILES error : ",T.toJSON(c));else if(c.key&&c.value){var u=T.string.substitute("UPDATE  {{objectName}} SET {{column3}} WHERE {{column4}}",{objectName:T.OrgNamespace+"__SM_Checklist_Attachment__c ",column3:T.OrgNamespace+"__SM_ContentDocumentLink_ID__c = REPLACE_CDL_ID ",column4:T.OrgNamespace+"__SM_ContentDocumentLink_ID__c = REPLACE_CV_LOCAL_ID "}),d=c.key,_=c.value;if(t.sFCVIdMappings||(t.sFCVIdMappings={}),t.sFCVIdMappings[d]=_,-1===i.indexOf(_)&&i.push(_),c&&c.valueMap&&c.valueMap.length>0){for(var h=c.valueMap,f=h.length,p=0;p<f;p++){var m=h[p];m&&m.key&&"ContentDocument"===m.key&&m.value&&-1===a.indexOf(m.value)?a.push(m.value):m&&m.key&&"ContentDocumentLink"===m.key&&m.value&&-1===r.indexOf(m.value)&&(r.push(m.value),u=u.replace("REPLACE_CDL_ID","'"+m.value+"'"),u=u.replace("REPLACE_CV_LOCAL_ID","'"+d+"'"))}-1===u.indexOf("REPLACE")&&s.push(u)}}}return s.length&&t._initSQLServiceRequest({queryArray:s},{handler:function(e){}}),r.length>0&&n.push({value:"ContentDocumentLink",values:r}),n}}]),t}(z.SyncAttachments),z.SyncTargetedAttachments=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"start",value:function(){this.targetedAttchmentsOnly=!0,this.parentRecordId=A.readFromJSCache("TARGETEDSYNC","recordId")||null,this.__logger.info("parentRecordId in SyncTargetedAttachment = ",this.parentRecordId),this.__logger.info("Clear TARGETEDSYNC from jsCache"),A.removeFromJSCache("TARGETEDSYNC","recordId"),this.performSteps()}}]),t}(z.SyncAttachmentsIncremental),z.SyncAttachmentsConfig=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"start",value:function(){this.__fetchDocTemplateAttachmentsForReset(function(e){this.getSyncManager().__stopped=!1,this._downloadAttachmentsArray(e,!0)})}},{key:"__fetchDocTemplateAttachmentsForReset",value:function(e){this._getRecords("SFDocTemplate",function(t){if(!t||!t.length)return e&&e.call(this,[]);for(var n=[],i=[],a=0;a<t.length;a++){var r=t[a],o=T.Deferred(),s="SELECT * FROM Attachment WHERE ParentId = '"+r.Id+"'";(function(e){this._initSQLServiceRequest({query:s},{handler:function(t){var n=t&&t[0];n&&i.push(n),e.resolve()}})}).call(this,o),n.push(o)}T.when(n).then(T.proxy(this,function(){return e&&e.call(this,i)}))})}}]),t}(z.SyncAttachments),z.SyncLocalDataIncremental=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._forEachSFObjectDescribe(!1,this._ensureSObjectTableExists)}}]),t}(z.SyncEvent),z.SyncDownloadOnDemand=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this._getState("recordId");if(e){var t=e.substring(0,3);this._describeObjectByKeyPrefix(t,function(t,n){var i=n.name,a=[{key:"Object_Name",value:i,valueMap:[{key:"Id",value:e}]}],r=null;i===T.OrgNamespace+"__Service_Order__c"&&(r=T.OrgNamespace+"__Service_Order_Line__c",a.push({key:"Object_Name",value:r,valueMap:[{key:"Id",value:e},{key:"Parent_Reference_Field",value:i}]}));var o={methodName:"DataSyncRequest",data:{eventType:"GET_DATA",eventName:"DATA_ON_DEMAND",valueMap:a}};this._initHTTPServiceRequest(o,{handler:function(e){this.__processDataDownloaded(e,i,r)}})})}}},{key:"__processDataDownloaded",value:function(e,t,n){var i=this._serviceDataToObject(e);if(i&&i[t]){var a=i[t].Parent_Record;i[t].PRICING_DATA&&this.__processPricingDataResult(i);var r=null;n&&i[n]&&"string"==typeof(r=i[n].Child_Record)&&(r=[r]);var o="update.incremental";this._processTXFetchResult(t,o,[[a]],function(){this._processTXFetchResult(n,o,[r],function(){this._flushRecordNames(function(){this.__indexDataOnDemand([a]),this.__indexDataOnDemand(r)})})})}}},{key:"__processPricingDataResult",value:function(e){}},{key:"__indexDataOnDemand",value:function(e){if(e)for(var t=0;t<e.length;t++){var n=T.toObject(e[t]),i=this._convertRecordFieldTypeDatetime(n.LastModifiedDate);this._insertReplaceRecordIncremental("ClientDataOnDemand",{Id:n.Id,last_modified_date:i})}}}]),t}(z.SyncEvent),z.SyncAttachmentDownloadOnDemand=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._getState("recordId")}}]),t}(z.SyncEvent),z.PopulateIgnoreList=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._initSQLServiceRequest({query:"SELECT Id FROM InstallBaseLock"}).done(T.proxy(this,function(e){if(e){for(var t={},n=0;n<e.length;n++)t[e[n].Id]=!0;this._setState("IGNORE_OBJECTS",t)}}))}}]),t}(z.SyncEvent),z.SyncFetchUpdatedRecords=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this._getState("DATA_PURGE.FETCH_IDS")||{},t=this._getState("TX_FETCH_RECORD_IDS")||{};for(var n in e){for(var i=[],a=0;a<e[n].length;a++){var r=e[n][a];t[r]||i.push(r)}var o=[{value:n,values:i}];this._commonSyncObjectRecords(o,"update.incremental")}}}]),t}(z.SyncEvent),z.AbstractExtension=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"perform",value:function(e){}}]),t}(M),z.SyncLocationData=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._getGeolocationAndUpdate()}},{key:"_getGeolocationAndUpdate",value:function(){var e,t,n=this.__nativeService.createLocationTrackingRequest(),i=this;this._addClientInfo(n),t=n.data.clientInfo[0].clientType;var a={deviceType:t,status:"Success",additionalInfo:""};n.bind("REQUEST_COMPLETED",function(e){if(this.__logger.info(this.__syncType),e.data.success){var t=T.toObject(e.data.data);a.location=t.location,a.location.lat>=0&&a.location.lng>=0&&(a.additionalInfo="Location Coordinates fetch from Server was Success"),a.timeRecorded=C.getCurrentDatetimeGMT(C.getSaveFormat("dateTime")),this._checkForLocationChange(a)}else a.location={lat:"",lng:""},a.additionalInfo="Location Coordinates fetch from Server Failed",a.status="Failure",a.timeRecorded=C.getCurrentDatetimeGMT(C.getSaveFormat("dateTime")),this._insertLocationRecord(a)},this),n.bind("REQUEST_ERROR",function(e){var n={deviceType:t,status:"Failure",additionalInfo:""},i=T.getClient().getApplicationParameter("client-type").toLowerCase();n.location={lat:"",lng:""},n.additionalInfo="Location Coordinates fetch from Server Failed "+e.data.data.substr(0,80),"mobile"==i&&"Application Location Service Setting is disabled by the User"==e.data.permission&&(n.additionalInfo="Application Location Service Setting is disabled by the User"),n.timeRecorded=C.getCurrentDatetimeGMT(C.getSaveFormat("dateTime")),this._insertLocationRecord(n)},this);var e={query:"SELECT value FROM ClientCache WHERE key = 'LOCATION_TRACKING_ENABLED'"};this._initSQLServiceRequest(e,{handler:function(r){if(r&&r[0]){"ALLOW"==r[0].value?n.execute():(a.location={lat:"",lng:""},a.additionalInfo="Application Location Service Setting is disabled by the User",a.status="Failure",a.deviceType=t,a.timeRecorded=C.getCurrentDatetimeGMT(C.getSaveFormat("dateTime")),this._insertLocationRecord(a))}else{if(T.getCurrentApplication().checkForMessageId("geoReqWindow")||T.getCurrentApplication().checkForMessageId("toolsSyncWindow"))return;if("laptop"==T.getClient().getApplicationParameter("client-type").toLowerCase());else{e={query:"INSERT INTO ClientCache (key, value) VALUES ('LOCATION_TRACKING_ENABLED', 'ALLOW')"},i._initSQLServiceRequest(e,{handler:function(){i.__logger.info("Inserted LOCATION_TRACKING_ENABLED key "),n.execute()},context:this})}}},context:this})}},{key:"_checkForLocationChange",value:function(e){var t={query:"SELECT value FROM ClientCache WHERE key = 'TECH_LOC_DETAILS'"};this._initSQLServiceRequest(t,{handler:function(t){if(t&&t[0]){var n=JSON.parse(t[0].value);parseFloat(e.location.lat)-parseFloat(n.lat)!=0||parseFloat(e.location.lng)-parseFloat(n.lng)!=0?(this.__logger.info("Location has changed"),this._insertLocationRecord(e)):n.wasTechHomeUpdateSuccess||(this.__logger.info("Updating Tech Location as it failed last time"),e.location.lat&&e.location.lng||(e=n),this._updateTechHomeLocation(e))}else this.__logger.info("First time insertion of location"),this._insertLocationRecord(e)},context:this})}},{key:"_insertLocationRecord",value:function(e){var t={query:"SELECT COUNT() AS GpsLogRecCount FROM UserGPSLog"},n=0;this._initSQLServiceRequest(t,{handler:function(t){this.__logger.info("Rec Count"+t[0].GpsLogRecCount),t&&t[0]&&t[0].GpsLogRecCount&&(n=t[0].GpsLogRecCount);var i={query:"SELECT value FROM MobileDeviceSettings where setting_id = 'Location History Records to cache'"};this._initSQLServiceRequest(i,{handler:function(t){this.__logger.info("Fetched Location History Records to cache From DB");var i=t&&t[0]?t[0].value:100;n<i?this._insertToUserGpsLogTable(e):this._deleteRowFromGpsLogTable(e)},context:this})},context:this})}},{key:"_deleteRowFromGpsLogTable",value:function(e){var t={query:"Delete from UserGPSLog where local_id IN (Select local_id from UserGPSLog ORDER BY local_id limit 1)"};this._initSQLServiceRequest(t,{handler:function(t){this.__logger.info("Deleted a record to maintain the location history record in local cahce setting "),this._insertToUserGpsLogTable(e)},context:this})}},{key:"_insertToUserGpsLogTable",value:function(e){var t={query:"INSERT INTO UserGPSLog (Additional_Info, Device_Type, Latitude, Longitude, Status, Time_Recorded ) VALUES ('"+e.additionalInfo+"','"+e.deviceType+"', '"+e.location.lat+"', '"+e.location.lng+"', '"+e.status+"', '"+e.timeRecorded+"')"};this._initSQLServiceRequest(t,{handler:function(t){this.__logger.info("Inserted into User Gps log"),this._updateTechHomeLocation(e)},context:this})}},{key:"_insertLocationToClientCache",value:function(e){if(e.location.lng&&e.location.lat){var t={query:"INSERT OR REPLACE INTO ClientCache (key,value) VALUES ('TECH_LOC_DETAILS', '"+(0,r.default)(e.location)+"')  "};this._initSQLServiceRequest(t,{handler:function(e){this.__logger.info("Tech location details updated to Cache"),this._updateLocationRecordsToServer()},context:this})}else this._updateLocationRecordsToServer()}},{key:"_updateTechHomeLocation",value:function(e){var t={query:"SELECT value FROM MobileDeviceSettings where setting_id = 'Set Technician Location'"};this._initSQLServiceRequest(t,{handler:function(t){if(t&&t[0]){"true"===t[0].value&&e.location.lat&&e.location.lng?this._checkConnectivity(function(t){if(t){var n={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"TECH_LOCATION_UPDATE",valueMap:[{key:"Fields",valueMap:[{key:T.OrgNamespace+"__Latitude__c",value:e.location.lat},{key:T.OrgNamespace+"__Longitude__c",value:e.location.lng},{key:T.OrgNamespace+"__Time_Recorded__c",value:e.timeRecorded}]}],values:[e.timeRecorded]}};this._initHTTPServiceRequest(n,{handler:function(t){this.__logger.info("Technician Home Location Update Was Successful"),e.location.wasTechHomeUpdateSuccess=t.success,this._insertLocationToClientCache(e)}})}}):(e.location.wasTechHomeUpdateSuccess=!0,this._insertLocationToClientCache(e))}},context:this})}},{key:"_updateLocationRecordsToServer",value:function(){this._checkConnectivity(function(e){e&&this.getUserInfo(function(e){var t={query:"SELECT * FROM UserGPSLog ORDER BY local_id"},n=[],i=0,a={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"LOCATION_HISTORY",valueMap:[]}},r=e?e.UserId:void 0;this._initSQLServiceRequest(t,{handler:function(e){i=e.length;for(var t=0;t<i;t++){var o={key:"Record",valueMap:[]},s=o.valueMap;s.push({key:T.OrgNamespace+"__Latitude__c",value:e[t].Latitude}),s.push({key:T.OrgNamespace+"__Longitude__c",value:e[t].Longitude}),s.push({key:T.OrgNamespace+"__Status__c",value:e[t].Status}),s.push({key:T.OrgNamespace+"__Device_Type__c",value:e[t].Device_Type}),s.push({key:T.OrgNamespace+"__Additional_Info__c",value:e[t].Additional_Info}),r&&s.push({key:T.OrgNamespace+"__User__c",value:r}),s.push({key:T.OrgNamespace+"__Time_Recorded__c",value:e[t].Time_Recorded}),n.push(o)}a.data.valueMap=n,this._initHTTPServiceRequest(a,{handler:function(e){var t={query:"DELETE FROM  UserGPSLog"};this._initSQLServiceRequest(t,{handler:function(e){this.__logger.info("Location History Cleared from local database..")}})},context:this})},context:this})})})}}]),t}(z.SyncEvent),z.SyncConfigReminder=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){A.writeToDBCache("IS_CONFIG_SYNC_DUE","true"),T.getCurrentApplication().checkForMessageId("configReminderWindow")||T.getCurrentApplication().checkForMessageId("toolsSyncWindow")||T.getCurrentApplication().showMessage({type:"INFO",title:U().T("FSA010_TAG117","Configuration sync is due"),text:U().T("FSA010_TAG002","ServiceMax needs to sync forms, rules and other configuration items. If you choose to sync later, this action can be found in Tools."),buttons:[{text:U().T("FSA016_TAG003","OK"),itemId:"OK"}],itemId:"configReminderWindow",handler:function(e){}})}}]),t}(z.SyncEvent),z.InsertExternalLocalRecords=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this;e._getRecords("SyncDependentLog",function(t){var n=[];t.forEach(function(e){n.push(e.local_id)}),n.length&&e.triggerExternalRequest(n)})}}]),t}(z.SyncEvent),z.UpdateServiceMaxEvents=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this;e._getRecords(T.OrgNamespace+"__SVMX_Event__c",function(t){var n=[],i=[];t.forEach(function(t){var a=t[T.OrgNamespace+"__WhatId__c"];if(a&&15==a.length){var r={Id:t.Id,originalId:a};r.mappedId=e._convertToSfdcId(r.originalId),n.push(r),i.push(t.Id)}}),n.length&&(e._updateSvmxEvents(n),e._insertSvmxEventIdMapping(n)),e._purgeMappedSvmxEventIds(i)})}},{key:"_convertToSfdcId",value:function(e){for(var t=e.split("\r").join("").split("\n"),n=new Array,i=0;i<t.length;i++)if(15==t[i].length){for(var a="",r=0;r<3;r++){for(var o=0,s=0;s<5;s++){var l=t[i].charAt(5*r+s);l>="A"&&l<="Z"&&(o+=1<<s)}a+="ABCDEFGHIJKLMNOPQRSTUVWXYZ012345".charAt(o)}n.push(t[i]+a)}return e=n.join("\r\n")}},{key:"_updateSvmxEvents",value:function(e){var t="UPDATE "+T.OrgNamespace+"__SVMX_Event__c SET "+T.OrgNamespace+"__WhatId__c = {{mappedId}} WHERE Id = {{Id}}",n=[];e.forEach(function(e){n.push(z.SQLSchema.bindSQLParams(t,T.cloneObject(e)))}),this._initSQLServiceRequest({queryArray:n,doRollBack:!1},{handler:function(e){this.__logger.info("Successfully updated ServiceMax events to have 18 digits WHatId")}})}},{key:"_insertSvmxEventIdMapping",value:function(e){var t=z.SQLSchema.getInsertQuery("ServiceMaxEventIdMapping",e,!0);this._initSQLServiceRequest({query:t},{handler:function(e){this.__logger.info("Successfully inserted entries for mapped ServiceMax events")}})}},{key:"_purgeMappedSvmxEventIds",value:function(e){var t="DELETE FROM ServiceMaxEventIdMapping";e.length&&(t+=" WHERE Id NOT IN('"+e.join("','")+"')"),this._initSQLServiceRequest({query:t},{handler:function(e){this.__logger.info("Purged mapped ServiceMax event entries")}})}}]),t}(z.SyncEvent),z.UpdateServiceMaxEventsInitial=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.tempPrefix="TEMP__",e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this;e._getRecords(e.tempPrefix+T.OrgNamespace+"__SVMX_Event__c",function(t){var n=[],i=[];t.forEach(function(t){var a=t[T.OrgNamespace+"__WhatId__c"];if(a&&15==a.length){var r={Id:t.Id,originalId:a};r.mappedId=e._convertToSfdcId(r.originalId),n.push(r),i.push(t.Id)}}),n.length&&(e._updateSvmxEvents(n),e._insertSvmxEventIdMapping(n))})}},{key:"_updateSvmxEvents",value:function(e){var t="UPDATE "+this.tempPrefix+T.OrgNamespace+"__SVMX_Event__c SET "+T.OrgNamespace+"__WhatId__c = {{mappedId}} WHERE Id = {{Id}}",n=[];e.forEach(function(e){n.push(z.SQLSchema.bindSQLParams(t,T.cloneObject(e)))}),this._initSQLServiceRequest({queryArray:n,doRollBack:!1},{handler:function(e){this.__logger.info("Successfully updated ServiceMax events to have 18 digits WHatId")}})}},{key:"_insertSvmxEventIdMapping",value:function(e){var t="INSERT INTO "+this.tempPrefix+"ServiceMaxEventIdMapping (originalId,mappedId) VALUES ( {{originalId}},{{mappedId}})",n=[];e.forEach(function(e){n.push(z.SQLSchema.bindSQLParams(t,T.cloneObject(e)))}),this._initSQLServiceRequest({queryArray:n,doRollBack:!1},{handler:function(e){this.__logger.info("Successfully inserted entries for mapped ServiceMax events")}})}}]),t}(z.UpdateServiceMaxEvents),z.SyncValidateProfile=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e=this,t=(T.getCurrentApplication().getUserInfo().UserSessionId,{type:"POST",methodName:"MetaSyncRequest",data:{eventType:"GROUP_PROFILE",eventName:"VALIDATE_PROFILE",values:[]},headers:[]});e._initHTTPServiceRequest(t,{handler:function(t){var n=!1;A.registerJSCache("newrelic",2);for(var i in t.valueMap)"SSL_PINNING"===t.valueMap[i].key&&(n="true"===t.valueMap[i].value.toLowerCase()),"ORGID"===t.valueMap[i].key&&A.writeToJSCache("newrelic","nr_org_id",t.valueMap[i].value);if(window.external.getOauthCredentials?window.external.getOauthCredentials().analytics:void 0!==window.newrelic){var a=A.readFromJSCache("newrelic","nr_org_id");if(a&&a.length>0){var o=x.Facade.createNewRelicCustomEvtRequest(),s={type:"NEWRELICCUSTOMEVT",parameters:{fsaEventType:"FSA SSL Pinning Check",orgId:a}};o.execute(s)}}e._setSSLPinning(n);var l="ClientCache";e._tempTableCreated(l)&&(l=T.getTempTableName(l));var c={query:" INSERT OR REPLACE INTO "+l+" VALUES('VALIDATE_PROFILE_RESULT','"+(0,r.default)(t)+"')"};e._initSQLServiceRequest(c,{handler:function(t){e.__logger.info("Validate Profile Result updated :")}})}})}},{key:"_setSSLPinning",value:function(e){var t=x.Facade,n=t.createSetSSLCertificatePinningRequest();n.bind("REQUEST_COMPLETED",function(t){console.log("Successfully set SSL Certifcate Pinning to "+e)}),n.bind("REQUEST_ERROR",function(t){console.warn("FAILED TO Set SSL Certifcate Pinning to "+e)}),n.execute({value:e})}}]),t}(z.SyncEvent),T.defineGlobal(z.name,z),e.exports=z},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=(n(10),n(0).utils),p=n(5).SVMXObject,m=n(399).StateService,v=n(11).Facade,g={name:"com.servicemax.client.sfmconsole.ui.largemodern.utils"};g.LargeModernStateService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));e.__state=[],e.__cachedStateObjs={},e.__index=0;var n=e;return e.bind("RESET_STATE_MANAGER",function(e){var t=e.data.request.consoleAppId;t=t||f.getClient().getApplicationParameter("sfmconsole-runtime-start")||null;var i={app:t,options:{}};n.getState()&&n.resetAllButOne(i)}),e.__mainStateName=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"pushMainState",value:function(e,t){if(!e)return void console.error("mainStateName must not be null.");if(e==this.__mainStateName)this.__resetToFirstState();else{this.__cacheCurrentMainState();var n=this.__cachedStateObjs[e];if(n&&n.state&&n.state.length>0){for(var i=n.state,a=0;a<i.length;a++)i[a].stopAnimation=t.stopAnimation;this.__restoreMainState(e,n)}else this.__pushMainState(e,t)}}},{key:"resetAll",value:function(){console.log("resetAll: START"),this.reset();for(var e in this.__cachedStateObjs)if(this.__cachedStateObjs.hasOwnProperty(e)){var t=this.__cachedStateObjs[e];this.__destroyState(t)}this.__mainStateName=null,this.__cachedStateObjs={},console.log("resetAll: END")}},{key:"resetAllButOne",value:function(e){console.log("resetAllButOne: "+e.app+": START");for(var t in this.__cachedStateObjs)if(t!=e.app&&this.__cachedStateObjs.hasOwnProperty(t)){var n=this.__cachedStateObjs[t];this.__destroyState(n)}this.__mainStateName=null,this.__cachedStateObjs={},console.log("resetAll: END")}},{key:"__cacheCurrentMainState",value:function(){if(null==this.__mainStateName)return void this.reset();var e={state:this.__state,index:this.__index};this.__cachedStateObjs[this.__mainStateName]=e}},{key:"__restoreMainState",value:function(e,t){console.log("__restoreMainState: START - main state: "+e),this.__mainStateName=e,this.__state=t.state,this.__index=t.index,delete this.__cachedStateObjs[e],this.triggerStateChange(),console.log("__restoreMainState: END - main state: "+e)}},{key:"__pushMainState",value:function(e,t){console.log("__pushMainState: START - main state: "+e),this.__mainStateName=e,this.__state=[],this.__index=0,this.pushState(t),console.log("__pushMainState: END - main state: "+e)}},{key:"__resetToFirstState",value:function(){if(console.log("__resetToFirstState: START - main state: "+this.__mainStateName),this.__state.length<=0)return void console.error("__resetToFirstState: __resetToFirstState should not happen when current state is empty");this.reset(),this.pushState({app:this.__mainStateName,options:{},stopAnimation:!0}),console.log("__resetToFirstState: END - main state: "+this.__mainStateName)}}]),t}(m),g.ConnectionUtil=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__logger=f.getLoggingService().getLogger("SFMDelivery : PlatformSpecifics"),e}return(0,h.default)(t,e),(0,c.default)(t,null,[{key:"checkConnectivity",value:function(){var e=f.Deferred(),t=this,n={type:"CONNECTIVITY",method:"CHECKCONNECTIVITY"},i=v.createConnectivityRequest();return i.bind("REQUEST_COMPLETED",function(t){e.resolve(t.data.data)},t),i.bind("REQUEST_ERROR",function(t){e.resolve("false")},t),i.execute(n),e}}]),t}(p),f.defineGlobal(g.name,g),e.exports=g},function(e,t,n){var i=n(43),a=n(17),r=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(61)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var i=n(45);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";var i=n(15);e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var i=n(15),a=n(32),r=n(23)("species");e.exports=function(e,t){var n,o=i(e).constructor;return void 0===o||void 0==(n=i(o)[r])?t:a(n)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports={}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";t.__esModule=!0;var i=n(177),a=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,a.default)(e)}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(14),s=i(o),l=n(16),c=i(l),u=n(376),d=i(u),_=n(30),h=i(_),f=n(1),p=i(f),m=n(2),v=i(m),g=n(6),y=i(g),S=n(3),E=i(S),b=n(4),T=i(b),M=n(10),I=n(0).utils,C=n(5).ModuleActivator,A=n(5).SVMXObject,D={name:"com.servicemax.client.data.impl"};D.Module=function(e){function t(){return(0,v.default)(this,t),(0,E.default)(this,(t.__proto__||(0,p.default)(t)).call(this))}return(0,T.default)(t,e),(0,y.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(C),D.Field=function(e){function t(e){(0,v.default)(this,t);var n=(0,E.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments)),i=!0,a=!1,r=void 0;try{for(var o,s=(0,d.default)((0,c.default)(e));!(i=(o=s.next()).done);i=!0){var l=o.value;e.hasOwnProperty(l)&&null===e[l]&&delete e[l]}}catch(e){a=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw r}}for(var u=["autoNumber","byteLength","createable","custom","externalId","deprecatedAndHidden","groupable","idLookup","inlineHelpText","nameField","namePointing","nillable","permissionable","relationshipOrder","scale","soapType","sortable","unique","updateable","writeRequiresMasterRead"],_=0;_<u.length;_++)delete e[u[_]];return(0,h.default)(n,e),n}return(0,T.default)(t,e),t}(A),D.FieldSet=function(e){function t(e,n){(0,v.default)(this,t);var i=(0,E.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments));i.fields={},i.fieldsByLabel={},i.tableName=n;for(var a=0;a<e.length;a++){var r=e[a];r.nameField&&(i.nameField=r.name),i.fields[r.name]=new D.Field(r),i.fieldsByLabel[r.label]=i.fields[r.name]}return D.FieldSet.registerFieldSet(n,i),i}return(0,T.default)(t,e),(0,y.default)(t,[{key:"getField",value:function(e){if(e instanceof D.Field)return e;if(this.fields[e])return this.fields[e];var t=e;return 0!=t.indexOf(I.OrgNamespace)&&(t=I.OrgNamespace+"__"+t),t.match(/__c$/)||(t+="__c"),this.fields[t]?this.fields[t]:this.fieldsByLabel[e]?this.fieldsByLabel[e]:void 0}},{key:"getFieldType",value:function(e){var t=this.getField(e);return t?t.type:""}},{key:"getNameField",value:function(){return this.fields[this.nameField]}},{key:"getFieldsByType",value:function(e){var t=[];for(var n in this.fields)this.fields.hasOwnProperty(n)&&this.fields[n].type===e&&t.push(this.fields[n]);return t}},{key:"forEach",value:function(e){for(var t in this.fields)this.fields.hasOwnProperty(t)&&e(this.fields[t])}}],[{key:"getFieldSet",value:function(e,t){}},{key:"registerFieldSet",value:function(e,t){this.fieldSets[e]=t}}]),t}(A),D.FieldSet.fieldSets={},D.Record=function(e){function t(e,n){(0,v.default)(this,t);var i=(0,E.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments));return i._fields=null,i.__nextListenerId=0,e instanceof D.Record?(e.forEachField(I.proxy(i,function(t){this[t.name]=e[t.name]})),i.attributes={type:e.attributes.type}):(M.extend(i,e),!n&&"attributes"in i&&(n=i.attributes.type)),i.__onReadyListeners=[],i.__listeners={RECORD:[]},i.attributes={type:n,url:"TODO"},i._references={},i._displayValues={},i.__loadFieldSet(n),i}return(0,T.default)(t,e),(0,y.default)(t,[{key:"__loadFieldSet",value:function(){for(var e=0;e<this.__onReadyListeners.length;e++)this.__onReadyListeners[e](this);delete this.__onReadyListeners}},{key:"onReady",value:function(e){this._fields?e(this):this.__onReadyListeners.push(e)}},{key:"__generateId",value:function(e){}},{key:"setIsSavedToServer",value:function(e){this._isSavedToServer=Boolean(e)}},{key:"getIsSavedToServer",value:function(){return this._isSavedToServer}},{key:"addListener",value:function(e,t,n){var i=void 0,a=void 0;n&&t&&(t=I.proxy(n,t)),e&&(a=this._fields.getField(e)),a?(this.__listeners[a.name]||(this.__listeners[a.name]=[]),i=this.__listeners[a.name]):i=this.__listeners.RECORD;var r={handler:t,field:a,id:this.__nextListenerId++};return i.push(r),r}},{key:"removeListener",value:function(e){var t=e.field;t?(this.__listeners[t.name]||(this.__listeners[fiinFieldeld.name]=[]),listener=this.__listeners[t.name]):listener=this.__listeners.RECORD,listener&&I.array.remove(listener,function(t){return t.id===e.id})}},{key:"__fireListener",value:function(e,t){var n=void 0,i=void 0;e&&I.timer.job(this.Id+" FireListeners "+e.name,1,this,function(){if(n=this.__listeners[e.name])for(i=0;i<n.length;i++)n[i].handler(e,t)}),I.timer.job(this.Id+" FireListeners",1,this,function(){if(n=this.__listeners.RECORD)for(i=0;i<n.length;i++)n[i].handler(e,t)})}},{key:"getFieldsByType",value:function(e){return this._fields?this._fields.getFieldsByType(e):[]}},{key:"getFieldType",value:function(e){var t=this._fields.getField(e);return t?t.type:null}},{key:"getFieldDef",value:function(e){return this._fields.getField(e)}},{key:"__isDisplayField",value:function(e){this._fields.getField(e);switch(e.type){case"picklist":case"reference":return!0}}},{key:"getValue",value:function(e){return this[this._fields.getField(e).name]}},{key:"setValue",value:function(e,t){var n=this._fields.getField(e),i=n.name;if(this.getValue(e)!==t){switch(this[i]=t,n.type){case"reference":this.__setDisplayValue(n,e,void 0);break;case"picklist":this.__setDisplayValue(n,e,t)}this.__fireListener(n,t)}}},{key:"getDisplayValue",value:function(e){var t=this._fields.getField(e);return this.__isDisplayField(t)?this._displayValues[t.name]:this[t.name]}},{key:"__setDisplayValue",value:function(e,t){var n=this._fields.getField(e);this.__isDisplayField(n)&&(this._displayValues[n.name]=t)}},{key:"getNameValue",value:function(){var e=this._fields.getNameField();return this.getValue(e)}},{key:"__setReferenceRecord",value:function(e,t){var n=this._fields.getField(e);this._references[n.name]=t}},{key:"getReferenceRecord",value:function(e){var t=this._fields.getField(e);return this._references[t.name]}},{key:"toJSON",value:function(){var e={};return this.forEachField(I.proxy(this,function(t){var n=t.name;e[n]=this.getValue(t)})),e.attributes=this.attributes,this.details&&(I.forEachProperty(this.details,function(e,t){t.lines=I.array.map(t.lines,function(e){return e instanceof D.Record?e.toJSON():e},this)},this),e.details=this.details),"__new"in this&&(e.__new=this.__new),"sourceRecordId"in this&&(e.sourceRecordId=this.sourceRecordId),e}},{key:"getRawValues",value:function(){var e={};return this.forEachField(I.proxy(this,function(t){var n=t.name;e[n]=this.getValue(t),e[n]&&"object"===(0,r.default)(e[n])&&"fieldvalue"in e[n]&&(e[n]=e[n].fieldvalue.value)})),e}},{key:"messupData",value:function(){this.forEachField(I.proxy(this,function(e){if("date"===e.type||"datetime"===e.type||"boolean"===e.type||"picklist"===e.type){var t=this.getValue(e);t&&"object"!==(void 0===t?"undefined":(0,r.default)(t))&&("boolean"===e.type&&(t=String(t).toLowerCase()),this[e.name]={fieldvalue:{key:t,value:t},fieldapiname:e.name})}}))}},{key:"toString",value:function(){return(0,s.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"toString",this).call(this,this.getTableName()+":"+this.Id)}},{key:"forEachField",value:function(e){this._fields.forEach(e)}},{key:"getTableName",value:function(){return this.attributes.type}},{key:"writeRecord",value:function(e,t){}},{key:"deleteRecord",value:function(e,t){}},{key:"loadReferences",value:function(e){}}]),t}(A),D.RecordSet=function(e){function t(e,n){(0,v.default)(this,t);var i=(0,E.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments));i.__data=[];for(var a=0;a<e.length;a++)i.__data.push(new utils.Record(e[a],n));return i}return(0,T.default)(t,e),(0,y.default)(t,[{key:"toArray",value:function(){return this.__data}},{key:"resolveReferences",value:function(e){}},{key:"getItem",value:function(e){return this.__data[e]}},{key:"getValue",value:function(e,t){return this.__data[e].getValue(t)}},{key:"setValue",value:function(e,t,n){return this.__data[e].setValue(t,n)}},{key:"getSize",value:function(){return this.__data.length}},{key:"forEach",value:function(e,t){I.array.forEach(this.__data,e,t)}}],[{key:"getRecordSet",value:function(e){}}]),t}(A),I.defineGlobal(D.name,D),e.exports=D},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=E.Deferred(),n=j.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)}),n.bind("REQUEST_ERROR",function(e){t.reject(e.data.data)}),n.execute({query:e.query,queryParams:e.queryParams}),t}var r=n(31),o=i(r),s=n(18),l=i(s),c=n(16),u=i(c),d=n(1),_=i(d),h=n(2),f=i(h),p=n(6),m=i(p),v=n(3),g=i(v),y=n(4),S=i(y),E=n(10),b=n(0).utils,T=n(7).Expressions,M=n(7).SyncData,I=n(7).MetaData,C=n(7).SystemData,A=n(7).Data,D=n(11).Facade,x=n(7).Cache,R=n(5).SVMXObject,O=n(12).DatetimeUtil,L=n(11).File,N=n(88),w={name:"com.servicemax.client.offline.sal.model.sfwdeliveryutils"},F=T,P=M,q=I,V=C,B=A,j=D,H=x,z=function(){return b.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};w.Utils=function(e){function t(){return(0,f.default)(this,t),(0,g.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments))}return(0,S.default)(t,e),(0,m.default)(t,null,[{key:"processWizardRawData",value:function(e){var t=b.Deferred(),n=this;return this.__fetchWizardData(e).then(b.proxy(this,function(i){if(i&&i.length>0){var a=void 0,r=i.length,o=[],s={};for(a=0;a<r;a++)o.push(i[a].wizard_id),s[i[a].wizard_id]=[];this.__fetchWizardStepsData(e,o).then(b.proxy(this,this.__filterExternalSteps,e,o)).then(function(a){if(a&&a.length>0){var r=void 0,o=a.length;for(r=0;r<o;r++)s[a[r].wizard_id].push(a[r]);for(o=i.length,r=0;r<o;r++)i[r].steps=s[i[r].wizard_id]}var l=b.getClient().getApplicationParameter("InstallBase"),c=b.OrgNamespace+"__Service_Order__c",u=e&&e.attributes&&e.attributes.type,d=void 0;if(l&&c===u){var _=n.__checkHaveProductsServiced(e);d={expression_id:"",is_active:"true",local_id:"99999999",object_name:i[0].object_name,sequence:"99999999",wizard_description:z().T("TODO",""),wizard_id:"",wizard_name:z().T("FSA008_TAG090","ProductIQ"),steps:[{action_description:z().T("TODO",""),action_id:"",action_name:z().T("FSA008_TAG091","Open tree view"),action_type:"EXTERNAL",class_name:"",expressionPassed:_,expression_id:"",local_id:"999999",method_name:"",perform_sync:"false",process_id:"Products Serviced",sequence:"1.00",wizard_id:""}]},i.unshift(d)}l&&i&&i.length>0&&i[0].install_base&&(d={expression_id:"",is_active:"true",local_id:"99999999",object_name:i[0].object_name,sequence:"99999999",wizard_description:z().T("TODO",""),wizard_id:"",wizard_name:z().T("FSA008_TAG090","ProductIQ"),steps:[{action_description:z().T("TODO",""),action_id:"",action_name:z().T("FSA008_TAG091","Open tree view"),action_type:"EXTERNAL",class_name:"",expressionPassed:!0,expression_id:"",local_id:"999999",method_name:"",perform_sync:"false",process_id:"View",sequence:"1.00",wizard_id:""}]},i.unshift(d)),t.resolve(i)})}else t.resolve([])}),b.proxy(this,function(e){t.resolve(e)})),t}},{key:"__hasInstalledProductField",value:function(e){var t=void 0,n=void 0,i=!1,a=b.OrgNamespace+"__Installed_Product__c";if(e&&e._fields&&e._fields.fields){n=e._fields.fields;for(var r in n)if(n.hasOwnProperty(r)&&(t=n[r])&&t.referenceTo&&t.referenceTo instanceof Array)for(var o=0;o<t.referenceTo.length;o++)if(t.referenceTo[o]==a){var s=t.name,l=e[s];if(l&&l.fieldvalue&&l.fieldvalue.key){i=!0;break}}}return i}},{key:"__checkHaveProductsServiced",value:function(e){var t=!1,n=b.OrgNamespace+"__Installed_Product__c",i=void 0;if(t||(t=this.__hasInstalledProductField(e)),!t&&e.details)for(var a in e.details){i=e.details[a].lines.length;for(var r=0;!t&&r<i;r++){var o=e.details[a].lines[r][n];t=this.__hasInstalledProductField(o)}}return t}},{key:"__filterExternalSteps",value:function(e,t,n){var i=b.Deferred();if(b.getClient().getApplicationParameter("InstallBase")&&n&&n.length>0&&t&&t.length>0){var a=void 0,r=n.length,o=[],s=[];for(a=0;a<r;a++)"SFM"===n[a].action_type?o.push("'"+n[a].process_id+"'"):"OUTPUT_DOCUMENT"===n[a].action_type&&s.push("'"+n[a].process_id+"'");if(o.length>0||s.length>0){var l=o.join(","),c=(s.join(","),"SELECT pc.process_id as process_id FROM SFProcessComponent AS pc JOIN InstallBaseObject as ib ON ib.object_name = pc.object_name JOIN SFSourceUpdate AS su ON pc.process_id = su.process WHERE pc.process_id in ("+l+") UNION SELECT pc.process_id as process_id FROM SFProcessComponent as pc JOIN InstallBaseObject as ib ON ib.object_name = pc.object_name JOIN SFProcess as p ON pc.process_id = p.process_id WHERE pc.component_type in ('TARGET', 'TARGETCHILD') AND p.process_type != 'VIEW RECORD' AND pc.process_id IN ("+l+")"),u="SELECT pc.process_id FROM SFProcessComponent AS pc JOIN InstallBaseObject as ib ON ib.object_name = pc.object_name JOIN SFSourceUpdate AS su ON pc.Id = su.target_process_node WHERE pc.process_id in ("+s+")",d=this.__executeDeferredQuery(c),_=this.__executeDeferredQuery(u);b.when([d,_]).then(function(e,t){var a={},o=void 0;for(o=0;o<e.length;o++)a[e[o].process_id]=!0;for(o=0;o<t.length;o++)a[t[o].process_id]=!0;for(o=0;o<r;o++)a[n[o].process_id]&&(n[o].expressionPassed=!1);i.resolve(n)})}else i.resolve(n)}else i.resolve(n);return i}},{key:"__fetchExternalObjectTypes",value:function(){var e=this.__executeDeferredQuery("SELECT Object_Name FROM InstallBaseObject"),t=b.Deferred();return e.then(b.proxy(this,function(e){t.resolve(e)}),b.proxy(this,function(e){t.reject(e)})),t}},{key:"__fetchWizardData",value:function(e){var t={key:"object_name",value:e.attributes.type},n=b.string.substitute("SELECT w.*, ib.object_name AS install_base FROM SFWizard AS w LEFT JOIN InstallBaseObject AS ib ON ib.object_name = w.object_name WHERE w.{{key}}='{{value}}' ORDER BY CAST(w.sequence AS INTEGER)",t),i=this.__executeDeferredQuery(n),a=b.Deferred();return i.then(b.proxy(this,function(t){this.__filterDataByExpression(e,t).then(function(e){a.resolve(e)})}),b.proxy(this,function(e){a.reject(e)})),a}},{key:"__filterDataByExpression",value:function(e,t){var n=[],i=[],a={},r=E.Deferred(),o=void 0;for(o=0;o<t.length;o++)t[o].expression_id&&(a[t[o].expression_id]=void 0,i.push(t[o]),n.push(E.Deferred()));return b.when(n).done(b.proxy(this,function(){for(var e=b.array.filter(t,function(e){return!e.expression_id||a[e.expression_id]}),n=[],i=[],o="1",s=!1;e.length;){s=!0;for(var l=0;l<e.length;l++){if(""==e[l].sequence){i.push(e[l]),e.splice(l,1),s=!1;break}n.push(e[l]),e.splice(l,1);break}s&&(o="1"==o?"2":"1")}n=n.concat(i),r.resolve(n)})),b.array.forEach(i,b.proxy(this,function(t,i){F.evaluate({expressionId:t.expression_id,data:[e],onSuccess:b.proxy(this,function(e){a[t.expression_id]=e[0],n[i].resolve(e)}),onError:b.proxy(this,function(e){a[t.expression_id]=!0,n[i].resolve(e)})})})),r}},{key:"__fetchWizardStepsData",value:function(e,t){var n=b.string.substitute("'{{value}}'",{value:t.join("','")}),i={key:"wizard_id",value:n},a=b.string.substitute("select * from SFWizardComponent where {{key}} in ({{value}}) AND (action_type IN ('SFM', 'OUTPUT_DOCUMENT', 'CHECKLIST', 'OTHERS'))",i),r=this.__executeDeferredQuery(a),o=E.Deferred();return r.then(b.proxy(this,function(n){for(var i=[],a=0;a<t.length;a++){var r=t[a],s=n.filter(function(e){if(e.wizard_id===r)return e}),l=s.sort(function(e,t){return e.sequence-t.sequence});i=i.concat(l)}this.__filterWizardStepsByExpressions(e,i).then(function(e){o.resolve(e)})}),b.proxy(this,function(e){o.resolve(e)})),o}},{key:"__filterWizardStepsByExpressions",value:function(e,t){for(var n=[],i=E.Deferred(),a=0;a<t.length;a++)n.push(E.Deferred());return b.when(n).done(function(e){i.resolve(t)}),b.array.forEach(t,b.proxy(this,function(t,i){t.expression_id?F.evaluate({expressionId:t.expression_id,data:[e],onSuccess:b.proxy(this,function(e){t.expressionPassed=e[0],n[i].resolve(e)}),onError:b.proxy(this,function(e){t.expressionPassed=!0,n[i].resolve(e)})}):(t.expressionPassed=!0,n[i].resolve())})),i}},{key:"__executeDeferredQuery",value:function(e){var t=b.Deferred(),n=D,i=n.createSQLRequest();return i.bind("REQUEST_COMPLETED",function(e){t.resolve(b.toObject(e.data.data))},this),i.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger(e.data),t.reject(e.data)},this),i.execute({query:e,async:!0}),t}}]),t}(R),w.PlatformSpecifics=function(e){function t(){(0,f.default)(this,t);var e=(0,g.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments));return e.__logger=b.getLoggingService().getLogger("SFW:Offline:PlatformSpecifics"),e.__wizCompData={},e.__customParamArray=[],e.__record={},e}return(0,S.default)(t,e),(0,m.default)(t,[{key:"getSupportedActionTypes",value:function(){return[]}},{key:"performAction",value:function(e){var t=b.Deferred(),n=e.actionType;return"SFM"==n?(t.resolve(),this.__performSFMAction(e)):"OUTPUT_DOCUMENT"==n?(t.resolve(),this.__performOUTPUTDOCUMENTAction1(e)):"EXTERNAL"==n?(t.resolve(),this.__performExternalAction(e)):"CHECKLIST"==n?(t.resolve(),this.__performChecklistAction(e)):"OTHERS"==n&&(t=this.__performCustomAction(e)),t.promise()}},{key:"__performCustomAction",value:function(e){var t=b.Deferred();this.__logger.info("Performing SFM action => "+e.getName());var n=this,i=D,a=i.createSQLRequest(),r=e.getRoot().recordId,o=e.getData().actionDef[b.OrgNamespace+"__Process__r"][b.OrgNamespace+"__ProcessID__c"],s=e.getRoot().record,l=e.ObjectInfo;return a.bind("REQUEST_COMPLETED",function(e){var i=e.data.data;if(i&&i[0]){var a=i[0],c=void 0;if("url"==a.customActionType.toLowerCase())c=n.__getParametersForCustomAction(a,s,o,r),l&&(s.parentObjectInfo=l),c=c.then(b.proxy(this,function(e){return n.__buildUrlAndLaunch(s,r,e,a)})),c=c.done(b.proxy(this,function(){t.resolve()})),c=c.fail(b.proxy(this,function(e){t.reject(e)}));else if("web-service"==a.customActionType.toLowerCase())c=n.__getParametersForCustomAction(a,s,o,r),c=c.then(b.proxy(this,function(e){return n.__performWebServiceCall(s,r,e,a)})),c=c.done(b.proxy(this,function(e){t.resolve(e)})),c=c.fail(b.proxy(this,function(e){t.reject(e)}));else if("app-to-app"==a.customActionType.toLowerCase()){var u=b.getClient().getApplicationParameter("client-type").toLowerCase();"mobile"==u?(c=n.__getParametersForCustomAction(a,s,o,r),l&&(s.parentObjectInfo=l),c=c.then(b.proxy(this,function(e){return n.__buildAppUrlSchemeAndLaunch(s,e,a)})),c=c.done(b.proxy(this,function(){t.resolve()})),c=c.fail(b.proxy(this,function(e){t.reject(e)}))):t.resolve()}else t.reject({text:b.string.substitute(z().T("FSA003_TAG002","Unkown process type {{processType}}. Please contact your administrator."),{processType:a.customActionType}),type:"ERROR"})}}),a.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getRealProcessId Failed"+e.data.data),t.reject({text:z().T("FSA008_TAG094","Process not found; check your configuration"),type:"ERROR"})}),a.execute({query:"SELECT * FROM SFWizardComponent WHERE process_id = '"+o+"'"}),t.promise()}},{key:"__getRecordData",value:function(e){var t=void 0;t=[];var n=[];if(e.details)for(var i=(0,u.default)(e.details),a=0;a<i.length;a++)if(e.details[i[a]]&&e.details[i[a]].lines&&e.details[i[a]].lines.length>0)for(var r=0;r<e.details[i[a]].lines.length;r++)n.push(e.details[i[a]].lines[r]);for(var o=0;o<n.length;o++){var s=this.__getModifiedRecordDataToSend(n[o]),l=!1;if(t&&t.length>0){for(var c=0;c<t.length;c++)if(t[c].object==s.object){t[c].records.push(s.record),l=!0;break}l||t.push({object:s.object,records:[s.record]})}else t.push({object:s.object,records:[s.record]})}return{details:t}}},{key:"__getModifiedRecordDataToSend",value:function(e){for(var t=e.attributes.type,n={},i=(0,u.default)(e._fields.fields),a=0;a<i.length;a++)e[i[a]]&&e[i[a]].fieldvalue?"reference"===e._fields.fields[i[a]].dataType?n[i[a]]={key:e[i[a]].fieldvalue.key,value:e[i[a]].fieldvalue.value}:n[i[a]]=e[i[a]].fieldvalue.value:n[i[a]]=e[i[a]];return{object:t,record:n}}},{key:"__buildAppUrlSchemeAndLaunch",value:function(e,t,n){var i=this,a=b.Deferred(),r=void 0,o=[],s=[];r={};var l=n.schema_name+"://"+n.path,c=this.__buildURLPayload(e,t,n);if(n.include_object_data_set&&"true"===n.include_object_data_set){var u=this.__getModifiedRecordDataToSend(e);o.push(u.object);for(var d in u)r[d]=u[d];var _=this.__getRecordData(e);for(var h in _)r[h]=_[h];var f=_.details;if(f&&0!==f.length)for(var p=0;p<f.length;++p)if(f[p]&&f[p].object){o.push(_.details[p].object),s[f[p].object]=[];var m=f[p].records;if(m&&0!==m.length)for(var v=0;v<m.length;++v)s[f[p].object].push(m[v].Id)}var g=this._generateEncryptedKeyToken();r.token=g,r.processId=b.getCurrentApplication().getCurrentView().getDeliveryEngine().processId}var y=[];for(var S in s){var E=s[S],T="";if(E&&0!==E.length&&(T=E.join("','")),0!==T.length){var M=i.__getCurrencyCode(S,T);y.push(M)}}var I=b.when(y);return I.fail(function(){a.reject()}),I.done(function(t){i.__getCurrencyCode(e.attributes.type,e.Id).done(function(e){x.readFromDBCache("USER_INFO").done(function(n){var s=b.toObject(n),u="";s&&(u=s.Timezone),i.__getObjectDescribes(o).done(function(n){var i={};if(n)for(var o in n){var s=n[o].fields,d={};if(void 0!==s)for(var _=0,h=s.length;_<h;++_){var f={};0!==s[_].scale&&(f.scale=s[_].scale),0!==s[_].precision&&(f.precision=s[_].precision),0!==s[_].length&&(f.length=s[_].length),f.type=s[_].type,"reference"===s[_].type&&(f.relationship={},f.relationship.name=s[_].relationshipName,s[_].referenceTo&&s[_].referenceTo.length>0&&(f.relationship.object=s[_].referenceTo[0])),"date"!==s[_].type&&"datetime"!==s[_].type||(f.timezone=u),"currency"===s[_].type&&(t&&t[o]?f.currencyCode=t[o]:e&&e[o]?e[o]&&e[o][0]&&e[o][0].CurrencyIsoCode?f.currencyCode=e[o][0].CurrencyIsoCode:f.currencyCode="":f.currencyCode={}),d[s[_].name]=f}i[o]=d}r.objectDescribes=i;var p=b.toJSON(r),m=encodeURIComponent("data")+"="+encodeURIComponent(p);if(!b.TEST){var v=D.createExternalAppRequest();v.bind("REQUEST_COMPLETED",function(e){a.resolve(),console.log("Success")}),v.bind("REQUEST_ERROR",function(e){a.reject({text:e.data,type:"ERROR"}),console.log("Failure")}),v.execute({url:l,param:c.join("&")+"&"+m})}}).fail(function(){a.reject()})}).fail(function(){a.reject()})}).fail(function(){a.reject()})}),a.promise()}},{key:"__getCurrencyCode",value:function(e,t){var n=b.Deferred(),i=j.createSQLRequest();return i.bind("REQUEST_COMPLETED",function(t){if(t.data&&t.data.data){var i=t.data.data,a={};a[e]=i,n.resolve(a)}else n.resolve({})}),i.bind("REQUEST_ERROR",function(e){n.resolve({})}),i.execute({query:"SELECT id, CurrencyIsoCode FROM {{objectName}} WHERE id IN ('{{ids}}')",queryParams:{objectName:e,ids:t}}),n}},{key:"__getObjectDescribes",value:function(e){var t=j.createSQLRequest(),n=b.Deferred();t.bind("REQUEST_COMPLETED",function(e){if(e.data&&e.data.data&&0!==e.data.data.length){for(var t=e.data.data,i={},a=0;a<t.length;++a)i[t[a].object_name]=b.toObject(t[a].object_describe);n.resolve(i)}else n.resolve({})}),t.bind("REQUEST_ERROR",function(e){n.resolve({})});var i="";return e&&0!=e.length&&(i=e.join("','")),t.execute({query:"SELECT object_name, object_describe FROM SFObjectDescribe WHERE object_name IN ('{{objectsToDesc}}')",queryParams:{objectsToDesc:i}}),n}},{key:"_generateEncryptedKeyToken",value:function(){var e=window.crypto.getRandomValues(new Uint8Array(64)).join(""),t=O.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss");return H.registerJSCache("app-to-app",10),H.writeToJSCache("app-to-app",e,t),H.writeObjectToDBCache("app-to-app-tokens",H.__getJSCacheItems("app-to-app")),e}},{key:"__buildUrlAndLaunch",value:function(e,t,n,i){var a=this.__buildURLPayload(e,n,i),r=0==i.customUrl.indexOf("/"),o=void 0;return o=r?this.__checkConnectivity():this.__checkConnectivityAlwaysTrue(),o=o.then(b.proxy(this,function(e){var t=b.Deferred();return e?r?t=this.__getUserInfoFromWeb():t.resolve(!1):t.reject({text:z().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."),type:"INFO"}),t.promise()})),o=o.then(b.proxy(this,function(e){var t=b.Deferred();return e?t=this.__loginInfo():t.resolve(!1),t.promise()})),o=o.then(b.proxy(this,function(e){var t=b.Deferred(),n=!1,r=i.customUrl;if(e&&e.InstanceURL&&(r=e.InstanceURL+r),"mobile"==b.getClient().getApplicationParameter("client-type").toLowerCase()){r=r,n=!0;var o=D.createExternalAppRequest();o.bind("REQUEST_COMPLETED",function(e){console.log("Success")}),o.bind("REQUEST_ERROR",function(e){console.log("Failure")}),o.execute({url:r,param:a.join("&")}),t.resolve()}if(!n){var s=r;a.length>0&&(s=r+"?"+a.join("&")),t=this.__launchUrl(s)}return t.promise()})),o.promise()}},{key:"__loginInfo",value:function(){var e=b.Deferred(),t=D,n=t.createLoginInfoRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data;e.resolve(n)},this),n.bind("REQUEST_ERROR",function(t){e.reject({text:z().T("FSA003_TAG001","Could not determine destination."),type:"INFO"})},this),n.execute(),e.promise()}},{key:"__buildURLPayload",value:function(e,t,n){for(var i=void 0,a=[],r=0;r<t.length;r++)(i=this.__extractRecordData(t[r].ParameterName,t[r].ParameterType,t[r].ParameterValue,e))&&a.push(encodeURIComponent(i.valueMap.key)+"="+encodeURIComponent(i.valueMap.value));return a}},{key:"__launchUrl",value:function(e){var t=b.Deferred(),n=D,i=n.createBrowserRequest();return i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data;t.resolve(n)},this),i.bind("REQUEST_ERROR",function(e){t.reject({text:z().T("FSA003_TAG005","The application does not exist. Please contact your system administrator to update the application path or install the necessary software."),type:"INFO"})},this),i.execute({link:e}),t.promise()}},{key:"__getParametersForCustomAction",value:function(e,t,n,i){var a=b.Deferred(),r=D,o=r.createSQLRequest();return o.bind("REQUEST_COMPLETED",function(e){var t=e.data.data;a.resolve(t)}),o.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getRealProcessId Failed"+e.data.data),a.reject({text:z().T("FSA003_TAG004","Unable to determine parameters."),type:"ERROR"})}),o.execute({query:"Select * from CustomActionParams where DispatchProcessId = '"+n+"'"}),a.promise()}},{key:"__generateStringValueMap",value:function(e,t,n){return e=e||"",t=t||"",n=n||"",{stringMap:{key:e,value1:n,value:t}}}},{key:"__generateValueMap",value:function(e,t){return e=e||"",t=t||"",{valueMap:{value:t,key:e,valueMap:"",values:""}}}},{key:"__performWebServiceCall",value:function(e,t,n,i){var a=b.Deferred(),r=this.__checkConnectivity();return r=r.then(b.proxy(this,function(e){var t=b.Deferred();return e?t=this.__getUserInfoFromWeb():t.reject({text:z().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."),type:"INFO"}),t.promise()})),r=r.then(b.proxy(this,function(a){return this.__makeHttpWSCall(e,t,n,i,a)})),r=r.done(b.proxy(this,function(e){a.resolve(e)})),r=r.fail(b.proxy(this,function(e){e=e||{},e.type=e.type||"INFO",e.text=e.text||"Unknown Exception during WS call.",a.reject({text:e.text,type:e.type})})),a.promise()}},{key:"__extractRecordData",value:function(e,t,n,i){var a=e||null,r=null,o=null;if(a){if("Field Name"==t){var s=i[n];r=void 0===s||null===s||"string"==typeof s?s||"":s.fieldvalue&&s.fieldvalue.key?s.fieldvalue.key||"":""}else r=this.__checkingForLitralsAndPassValue(n,i);o=this.__generateValueMap(a,r)}return o}},{key:"__checkingForLitralsAndPassValue",value:function(e,t){var n=e.toUpperCase(),i="";switch(n){case"SVMX.PRODUCTIQWORKORDERID":if(t.parentObjectInfo)if(this.__IsThisWORecord(t.parentObjectInfo.object)){var a=t.parentObjectInfo.recordID;e=void 0===a||null===a||"string"==typeof a?a||"":a.fieldvalue&&a.fieldvalue.key?a.fieldvalue.key||"":""}else e="";else if(this.__IsThisWORecord(t.attributes.type)){var a=t.Id;e=void 0===a||null===a||"string"==typeof a?a||"":a.fieldvalue&&a.fieldvalue.key?a.fieldvalue.key||"":""}else e="";i=e;break;case"SVMX.USERNAME":i=b.getCurrentApplication().__userInfo.UserLogin;break;case"SVMX.DATAACCESSAPIKEY":i=this.__ApiKey;break;default:i=e||""}return i}},{key:"__IsThisWORecord",value:function(e){return e==b.OrgNamespace+"__Service_Order__c"}},{key:"__getApiKey",value:function(){var e=b.Deferred(),t=this,n=D,i=n.createGenerateApiKeyRequest();return i.bind("REQUEST_COMPLETED",function(n){t.__ApiKey=n.data.data,e.resolve()},this),i.bind("REQUEST_ERROR",function(n){t.__ApiKey="",e.resolve()},this),i.execute(),e}},{key:"__buildWSSoapPayload",value:function(e,t,n,i,a){var r=b.Deferred(),o=b.toXML({userId:a.UserId})+b.toXML({groupId:"WS_"+Math.floor((new Date).getTime())+"_"+Math.floor(1e3*Math.random())})+b.toXML({profileId:b.getClient().getApplicationParameter("client-uuid")})+b.toXML({fieldsToNull:""});o+=b.toXML(this.__generateStringValueMap("key",e.attributes.type,t));for(var s=void 0,l=0;l<n.length;l++)(s=this.__extractRecordData(n[l].ParameterName,n[l].ParameterType,n[l].ParameterValue,e))&&(o+=b.toXML(s));return this.__getModifiedRecordsForWS(t,e.attributes.type).done(function(e){o+=e,r.resolve(o)}),r}},{key:"__makeHttpWSCall",value:function(e,t,n,i,a){var r=this,o=b.Deferred();return this.__buildWSSoapPayload(e,t,n,i,a).done(function(e){var t="true"===i.perform_sync,n={method:"POST",protocol:"SOAP",methodName:i.method_name,endPoint:i.class_name,soapData:e},s=new window.com.servicemax.client.sal.impl.WSSoapRequest({sessionId:a.UserSessionId,endPoint:i.class_name}),l=new window.com.servicemax.client.sal.impl.RPRuntimeMode;n.uri=l.getApexSoapUrl(n.endPoint),n.data=s._getData(n.soapData,n),n.headers={SOAPAction:i.method_name,"Content-Type":"text/xml"};var c=D.createHTTPRequest();c.bind("REQUEST_COMPLETED",b.proxy(r,function(e){var n=e.data.data;if("string"==typeof n){var a=b.stringToXML(n);if(a){var s=b.xmlToJson(a);if(s&&s.Envelope&&s.Envelope.Body&&s.Envelope.Body[i.method_name+"Response"]&&s.Envelope.Body[i.method_name+"Response"].result){var l=s.Envelope.Body[i.method_name+"Response"].result;if(!0===l.success){for(var c=r._parseWSResponse(l),u={},d=0;d<c.records.length;d++){var _=c.records[d];u[_.action]||(u[_.action]={}),u[_.action][_.objectName]||(u[_.action][_.objectName]=[]),u[_.action][_.objectName].push(_.record)}for(var h=[],f=[],p=0;p<c.mappedRecords.length;p++){var m=c.mappedRecords[p],v=r._updateRecord(m.objectName,{Id:m.remoteId},m.localId);f.push(v.promise())}b.when(f).done(function(){for(actionType in u)if("insert"===actionType){var e=u[actionType];for(objectType in e){var n=r._insertRecord(objectType,e[objectType],!0);h.push(n.promise())}}else if("update"===actionType){var i=u[actionType];for(objectType in i)for(var a=i[objectType],s=a.length-1;s>=0;s--){var l=a[s];if(objectType&&"undefined"!==objectType){var d=r._updateRecord(objectType,l,l.Id);h.push(d.promise())}}}b.when(h).done(function(){var e=c.insertedIds.concat(c.updatedIds);j.createSQLRequest().execute({query:'DELETE from ClientSyncLog where Id in ("'+e.join('","')+'")'}),t&&b.getCurrentApplication().getSyncImpl().performSync("AGGRESSIVE"),o.resolve()}),o.resolve()})}else{var g=z().T("FSA003_TAG003","Unable to make request");if(l.valueMap)for(var y=l.valueMap.length-1;y>=0;y--){var S=l.valueMap[y];if("ERROR"===y.key){g=S.value;break}}else l.messageType&&"error"===l.messageType.toLowerCase()&&l.message&&(g=l.message);o.reject({text:g,type:"ERROR"})}}else o.reject({text:z().T("FSA003_TAG003","Unable to make request"),type:"ERROR"})}else o.reject({text:z().T("FSA003_TAG003","Unable to make request"),type:"ERROR"})}})),c.bind("REQUEST_ERROR",function(e){var t=e.data.data,n=z().T("FSA003_TAG003","Unable to make request");if("string"==typeof t){var i=b.toObject(t);if("string"!=typeof i){var a=void 0;if(i.ResponseBody?a=b.stringToXML(i.ResponseBody):i.error&&(a=b.stringToXML(i.error)),a){var r=b.xmlToJson(a);r&&r.Envelope&&r.Envelope.Body&&r.Envelope.Body.Fault&&r.Envelope.Body.Fault.faultstring&&(n=r.Envelope.Body.Fault.faultstring)}}}o.reject({text:n,type:"ERROR"})}),c.execute(n)}),o.promise()}},{key:"_parseWSResponse",value:function(e){var t={insertedIds:[],updatedIds:[],records:[],mappedRecords:[]},n=e.valueMap;n.constructor!==Array&&(n=[n]);for(var i=0;i<n.length;i++){var a=n[i];if("Parent_Object_Name"===a.key||"Child_Object_Name"===a.key){var r=a.value,o=a.valueMap[0],s=a.valueMap[1];"UPDATED_IDS"===o.key&&"Record"===s.key?(t.updatedIds.push(o.values),t.records.push({record:b.toObject(s.value)[0],action:"update",objectName:r,recordId:o.values})):"INSERTED_IDS"===o.key&&"Record"===s.key&&(t.insertedIds.push(o.valueMap.key),t.mappedRecords.push({localId:o.valueMap.key,remoteId:o.valueMap.value,objectName:r}),t.records.push({record:b.toObject(s.value)[0],action:"update",objectName:r}))}else if("object"===(0,l.default)(a.key)){var c=a.record;t.updatedIds.indexOf(c.Id)<0&&t.insertedIds.indexOf(c.Id)<0&&(t.updatedIds.push(c.Id),t.records.push({record:c,action:"update",objectName:c.recordType,recordId:c.Id}))}}return t}},{key:"_filterFields",value:function(e,t){for(var n={},i={},a=void 0,r=t.length-1;r>=0;r--)n[t[r].name]=t[r];for(var o in e)if(n[o]){var s=n[o].type,l=n[o].updateable;if(!l&&"reference"!=s)continue;if(null===e[o]||""===e[o])continue;"date"===s&&(""!==e[o]&&null!==e[o]||(e[o]="")),"datetime"===s&&(""!==e[o]&&null!==e[o]||(e[o]="")),"int"===s&&(a=e[o],null===a&&(a=""),""!==a&&"0"!==a||(isOldRecord||""!==a)&&(a="0"),e[o]=new String(a).valueOf()),"double"!==s&&"currency"!==s&&"percent"!==s||(a=e[o],null===a&&(a=""),""!==a&&"0"!==a||""!==a&&(a="0.0"),null!==a&&""!==a&&"null"!==a&&(a=new String(a).valueOf(),a.indexOf(".")<=0&&(a+=".0")),e[o]=a),"CurrencyIsoCode"==o&&""==e[o]?this.__logger.info("Not sending CurrencyIsoCode field because its empty and server is sensitive to empty values for this field"):i[o]=e[o]}return i}},{key:"_getRecord",value:function(e,t,n){var i=this,a=b.Deferred(),r=j.createSQLRequest();return r.bind("REQUEST_COMPLETED",function(t){var r=t.data.data;if(r.length>0){var o=r[0];q.describeObject({objectName:e,onSuccess:b.proxy(i,function(e){n?n([this._filterFields(o,e.fields)]):a.resolve([this._filterFields(o,e.fields)])}),onError:b.proxy(i,function(e){n?n([]):a.resolve([])})})}else n?n([]):a.resolve([])}),r.bind("REQUEST_ERROR",function(e){n?n([]):a.reject([])}),r.execute({query:"SELECT * FROM `"+e+"` WHERE Id = '"+t+"'"}),a}},{key:"__getModifiedRecordsForWS",value:function(e,t){var n=this,i=b.Deferred(),a=b.Deferred(),r=b.Deferred(),s=j.createSQLRequest();s.bind("REQUEST_COMPLETED",function(e){var a=e.data.data;if(a.length>0){var r=a[0];"insert"===r.operation?n._getRecord(t,r.Id,b.proxy(n,function(e){e.length>0?i.resolve([{objectName:t,recordId:r.Id,modifiedData:(0,o.default)(e[0]),operation:"insert"}]):i.resolve([])})):"update"===r.operation?i.resolve([{objectName:t,recordId:r.Id,modifiedData:r.new_values,operation:"update"}]):i.resolve([])}else i.resolve([])}),s.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("Error retrieving details"),i.reject("Error retrieving details")}),s.execute({query:"SELECT * FROM ClientSyncLog WHERE record_type = 'master' AND Id = '"+e+"'"});var l=j.createSQLRequest();l.bind("REQUEST_COMPLETED",function(e){for(var t=e.data.data,i=t.filter(function(e){return"update"===e.operation}),r=t.filter(function(e){return"insert"===e.operation}),s=[],l=0;l<i.length;l++)!function(e){var t=i[e],a=b.Deferred();q.getTableForId(t.Id,b.proxy(n,function(e){a.resolve([{objectName:e,recordId:t.Id,modifiedData:t.new_values,operation:"update"}])})),s.push(a.promise())}(l);for(var l=0;l<r.length;l++)!function(e){var t=r[e],i=b.Deferred();q.getTableForId(t.Id,b.proxy(n,function(e){this._getRecord(e,t.Id,b.proxy(this,function(n){n.length>0?i.resolve([{objectName:e,recordId:t.Id,modifiedData:(0,o.default)(n[0]),operation:"insert"}]):i.resolve([])}))})),s.push(i.promise())}(l);b.when(s).done(function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];n&&n.length>0&&e.push(n[0])}a.resolve(e)})}),l.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("Error retrieving details"),a.reject("Error retrieving details")}),l.execute({query:"SELECT * FROM ClientSyncLog WHERE record_type = 'detail' AND parent_id = '"+e+"'"});var c=b.when([i.promise(),a.promise()]);return c.done(function(){var n=[],i=arguments[0],a=arguments[1];if(i.length>0){var o=i[0];"update"===o.operation?n.push("<valueMap><key>Parent_Object_Name</key><value>"+o.objectName+"</value><valueMap><key>RECORD_ID</key><value>"+o.modifiedData+"</value></valueMap></valueMap>"):"insert"===o.operation&&n.push("<valueMap><key>Parent_Object_Name</key><value>"+o.objectName+"</value><valueMap><key>"+o.recordId+"</key><value>"+o.modifiedData+"</value></valueMap></valueMap>")}else a.length>0&&n.push("<valueMap><key>Parent_Object_Name</key><value>"+t+'</value><valueMap><key>RECORD_ID</key><value>{"Id":"'+e+'"}</value></valueMap></valueMap>');for(var s=0;s<a.length;s++){var l=a[s];"insert"===l.operation?n.push("<valueMap><key>Child_Object_Name</key><value>"+l.objectName+"</value><valueMap><key>"+l.recordId+"</key><value>"+l.modifiedData+"</value></valueMap></valueMap>"):"update"===l.operation&&n.push("<valueMap><key>Child_Object_Name</key><value>"+l.objectName+"</value><valueMap><key>RECORD_ID</key><value>"+l.modifiedData+"</value></valueMap></valueMap>")}r.resolve(n.join("\n"))}),c.fail(function(e){}),r}},{key:"_insertRecord",value:function(e,t,n,i){var a=b.Deferred(),r=[];t instanceof Array?b.array.forEach(t,function(e){r.push(e)}):r=t;n?(r instanceof Array||(r=b.array.map(r,function(e){return e})),r.length):r=[r];for(;r&&r.length>0;){var o=r.splice(0,100);o=this._convertRecordFieldTypes(e,o,n);var s=N.SQLSchema.getInsertQuery(e,o,!0);o.length;(function(e){this._initSQLServiceRequest({query:s},{handler:function(){0===e&&(i&&i.call(this),a.resolve())}})}).call(this,r.length)}return a}},{key:"_updateRecord",value:function(e,t,n,i){var a=b.Deferred();t=this._convertRecordFieldTypes(e,t,!1);var r=N.SQLSchema.getUpdateQuery(e,t,n);return this._initSQLServiceRequest({query:r},{handler:function(e){i&&i.call(this,e),a.resolve()}}),a}},{key:"_initSQLServiceRequest",value:function(e,t){var n=j.createSQLRequest();n.bind("REQUEST_COMPLETED",function(e){var n=e.data.data||[];t&&t.handler.call(t.context||this,n)},this),n.bind("REQUEST_ERROR",function(n){var i="SQL Request failed: "+e.query;t&&t.handler.call(t.context||this,[],i)},this),n.execute({query:e.query})}},{key:"_convertRecordFieldTypes",value:function(e,t,n){var i=N.SQLSchema.getTableSchema(e);n||(t=[t]);for(var a=0;a<t.length;a++)for(var r in t[a])if(i.fields[r]){var o=t[a][r];"datetime"==i.fields[r].sftype&&(t[a][r]=this._convertRecordFieldTypeDatetime(o)),"boolean"==i.fields[r].sftype&&(t[a][r]=o&&"false"!==o?"true":"false")}return n?t:t[0]}},{key:"_convertRecordFieldTypeDatetime",value:function(e){var t=e;if("string"==typeof e&&e.match(/T/)){var n=e.split("T"),i=n[0].split("-"),a=n[1].split("."),r=a[0].split(":");t=[i[0],i[1],i[2]].join("-")+" "+[r[0],r[1],r[2]].join(":")}return t}},{key:"__getUserInfoFromWeb",value:function(){var e=b.Deferred(),t=D.createHTTPRequest(),n={method:"POST",uri:"/services/apexrest/"+b.OrgNamespace+"/svmx/MobServiceIntf/getUserInfo",data:{}};return t.bind("REQUEST_COMPLETED",function(t){"200"==t.data.status?e.resolve(t.data.data):e.reject()},this),t.bind("REQUEST_ERROR",function(t){e.reject()},this),t.execute(n),e.promise()}},{key:"__checkConnectivity",value:function(){var e=b.Deferred(),t=D,n=t.createConnectivityRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data.toLowerCase(),i="true"===n;e.resolve(i)},this),n.bind("REQUEST_ERROR",function(t){e.resolve(!1)},this),n.execute(),e.promise()}},{key:"__checkConnectivityAlwaysTrue",value:function(){var e=b.Deferred();return e.resolve(!0),e.promise()}},{key:"__showMessage",value:function(e,t){b.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:t,text:e})}},{key:"__performChecklistAction",value:function(e){this.__logger.info("Performing SFM action => "+e.getName());var t=e.getRoot().recordId,n={SVMX_recordId:t,SVMX_action:e.actionType};b.getCurrentApplication().launchConsoleApp("sfmdelivery",n)}},{key:"__performOUTPUTDOCUMENTAction1",value:function(e){this.__logger.info("Performing OUTPUT_DOCUMENT action => "+e.getName());var t=e.getRoot().recordId;if(!t){return void b.getCurrentApplication().getApplicationErrorHandler().notifyApplicationError({message:function(){return b.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG093","You can not generate a document until this record has synced")})}var n=e.getRoot().record,i=e.getData().actionDef[b.OrgNamespace+"__Process__r"][b.OrgNamespace+"__ProcessID__c"],a=e.getData().actionDef[b.OrgNamespace+"__Select_Template_At_Runtime__c"],r=e.getRoot().getDeliveryEngine();q.getProcess({salesforceProcessId:i,onSuccess:b.proxy(this,function(e){var i=e.data.data[0],o={SVMX_processId:i.process_unique_id,SVMX_recordId:t,SVMX_record:n,SVMX_selectTplAtRuntime:a,de:r};b.getCurrentApplication().launchConsoleApp("sfmopdocdelivery",o)})})}},{key:"__performOUTPUTDOCUMENTAction",value:function(e){this.__logger.info("Performing OUTPUT_DOCUMENT action => "+e.getName());var t=e.getRoot().recordId;if(!t){return void b.getCurrentApplication().getApplicationErrorHandler().notifyApplicationError({message:function(){return b.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG093","You can not generate a document until this record has synced")})}var n=e.getRoot().record,i=e.getData().actionDef[b.OrgNamespace+"__Process__r"][b.OrgNamespace+"__ProcessID__c"],r=e.getData().actionDef[b.OrgNamespace+"__Select_Template_At_Runtime__c"],o=this,s=e.getRoot().getDeliveryEngine();q.getProcess({salesforceProcessId:i,onSuccess:b.proxy(this,function(i){var l=i.data.data[0],c={SVMX_processId:l.process_unique_id,SVMX_recordId:t,SVMX_record:n,SVMX_selectTplAtRuntime:r,de:s};o.__openOutputDocReport(c,e,l,function(i){var r=i.fileLocation;i.success?(B.executeSourceUpdateMapping({processId:l.process_id,data:n}),o.__copyOutputDocReportIntoDownloads(c,e,r,function(e){if(e.success){var i=new L(e.targetPath+"/"+e.targetFileName),r="local_"+(new Date).getTime();i.info().then(b.proxy(this,function(n,o){var s=V.getUserInfo().UserId,c=l.process_name+(e.targetFileName.replace(/^.*\./,".")||""),u=i.getPath();return c=c.replace(/'/g,"''"),u=u.replace(/'/g,"''"),a({query:"INSERT INTO SFAttachments (Id, parent_id, file_path, name, last_modified_date, content_length, created_by_id, downloaded) VALUES('{{id}}', '{{record_id}}', '{{target_path}}', '{{file_name}}', '{{last_modified}}', {{size}}, '{{author}}', 'true')",queryParams:{id:r,record_id:t,file_name:c,target_path:u,last_modified:O.getTimestampWithSaveFormat(),size:o.size,author:s}}).then(b.proxy(this,function(){b.getCurrentApplication().getSyncImpl().performAggressiveSync()}))})).then(b.proxy(this,function(){var e=b.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),t=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{recordId:n.Id}});e.triggerEvent(t)})),P.insertAttachment({Id:r,isAttachment:!0,parentId:n.Id||""})}}),o.__copyOutputDocReportIntoUploads(c,e,r,function(e){e.success})):o.__performOUTPUTDOCUMENTAction1(e)})})})}},{key:"__copyOutputDocReportIntoDownloads",value:function(e,t,n,i){var a=D,r=a.createFileRequest(),o=this.getTargetFileName(n),s={file:n,operation:"COPY",targetPath:"{UploadDirectory}",targetFile:o};r.bind("REQUEST_COMPLETED",function(e){var t={success:e.data.success,targetPath:e.data.parameters.targetPath,targetFileName:e.data.parameters.targetFile};i(t)}),r.execute(s)}},{key:"__copyOutputDocReportIntoUploads",value:function(e,t,n,i){var a=D,r=a.createFileRequest(),o=this.getTargetFileName(n),s={file:n,operation:"COPY",targetPath:"{DownloadDirectory}",targetFile:o};r.bind("REQUEST_COMPLETED",function(e){var t={success:e.data.success,targetPath:e.data.parameters.targetPath,targetFileName:e.data.parameters.targetFile};i(t)}),r.execute(s)}},{key:"getTargetFileName",value:function(e){var t="";e.indexOf("\\")>-1?t=e.split("\\").pop():e.indexOf("/")>-1&&(t=e.split("/").pop());var n=t.lastIndexOf("."),i=t.substring(n,t.length);return t=t.substring(0,n)+(new Date).getTime()+i}},{key:"__openOutputDocReport",value:function(e,t,n,i){function a(t,i){t&&(i.processId=t.pid),n.expression_id?T.evaluate({data:e.SVMX_record,expressionId:n.expression_id,returnMessage:!0,onSuccess:b.proxy(this,function(e){e[0].result?o.execute(i):b.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"ERROR",text:e[0].message,buttons:[{text:z().T("FSA016_TAG003","OK"),itemId:"OK"}]})})}):o.execute(i)}var r=D,o=r.createReportRequest();o.bind("REQUEST_COMPLETED",function(e){var t={fileLocation:e.data.fileLocation,success:e.data.success};i(t)}),o.bind("REQUEST_ERROR",function(e){var t={fileLocation:e.data.fileLocation,success:e.data.success};i(t)},this);var s=e.de,l={recId:e.SVMX_recordId,processId:e.SVMX_processId};1==e.SVMX_selectTplAtRuntime?function(e){var n=t.getRoot().availableActions,i=void 0,a=n.length,r=[];for(i=0;i<a;i++)"OUTPUT DOCUMENT"==n[i][b.OrgNamespace+"__Purpose__c"]&&r.push({pid:n[i][b.OrgNamespace+"__ProcessID__c"],name:n[i][b.OrgNamespace+"__Name__c"],desc:n[i][b.OrgNamespace+"__Description__c"]});var o=b.create("com.servicemax.client.ui.components.composites.impl.SVMXWindow",{width:500,height:300,modal:!0,resizable:!1,title:s.translate("CONF016_TAG113"),items:[{xtype:"svmx.listcomposite",height:240,store:{xtype:"svmx.store",fields:["name"],data:r},columns:[{text:"",dataIndex:"name",flex:1}],viewConfig:{emptyText:s.translate("CONF016_TAG115"),deferEmptyText:!1},listeners:{itemdblclick:function(t,n,i,a,r){e(n.raw),o.close()}}}],dockedItems:[{xtype:"svmx.toolbar",dock:"bottom",items:[{xtype:"tbfill"},{xtype:"svmx.button",text:s.translate("CONF016_TAG114"),handler:function(){var t=o.items.getAt(0),n=t.getSelectionModel().getSelection();n&&n.length>0&&(e(n[0].raw),o.close())}},{xtype:"svmx.button",text:s.translate("CONF016_TAG032"),handler:function(){o.close()}}]}]}).show()}(function(e){a(e,l)}):a("",l)}},{key:"__extractInstalledProductField",value:function(e){var t=void 0,n=void 0,i=b.OrgNamespace+"__Installed_Product__c",a=[];if(e&&e._fields&&e._fields.fields){n=e._fields.fields;for(var r in n)if(n.hasOwnProperty(r)&&(t=n[r])&&t.referenceTo&&t.referenceTo instanceof Array)for(k=0;k<t.referenceTo.length;k++)if(t.referenceTo[k]==i){var o=t.name,s=e[o],l="string"==typeof s?s:s&&s.fieldvalue&&s.fieldvalue.key;l&&-1==a.indexOf(l)&&a.push(l)}}return a}},{key:"__getProductsServicedSerials",value:function(e){var t=this,n=b.Deferred(),i=void 0,a=this.__extractInstalledProductField(e),r=b.OrgNamespace+"__Service_Order_Line__c",o=j.createSQLRequest();return o.bind("REQUEST_COMPLETED",function(e){var o=e.data.data;o.length||n.resolve(a),q.describeObject({objectName:r,onSuccess:function(e){for(var r=0;r<o.length;r++){var s=o[r];s._fields={fields:e.fields};var l=t.__extractInstalledProductField(s);for(i=0;i<l.length;i++)-1==a.indexOf(l[i])&&a.push(l[i])}n.resolve(a)}})}),o.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("Error retrieving details")}),o.execute({query:"SELECT * FROM "+b.OrgNamespace+"__Service_Order_Line__c WHERE "+b.OrgNamespace+"__Service_Order__c = '"+e.Id+"'"}),n}},{key:"__performExternalAction",value:function(e){var t=b.getClient().getApplicationParameter("InstallBase");if(this.__logger.info("Performing External SFM action ("+t+") => "+e.getName()),t){var n=function(){var e=D,t=e.createSendExternalRequest();t.bind("REQUEST_COMPLETED",function(e){console.log("SUCCESS",e)}),t.bind("REQUEST_ERROR",function(e){console.log("ERROR",e)}),t.execute({appName:"Installigence",externalRequest:b.toJSON(s)})},i=e.getRoot().recordId,a=e.getRoot().record,r=a.attributes.type,o=e.getData().actionDef[b.OrgNamespace+"__Process__r"][b.OrgNamespace+"__ProcessID__c"],s={action:"VIEW",recordIds:[i],object:r};"Products Serviced"===o?this.__getProductsServicedSerials(a).done(function(e){e&&e.length&&(s={action:"VIEW",recordIds:e,object:r,sourceRecordName:a.Name||""}),n()}):n()}}},{key:"__performSFMAction",value:function(e){this.__logger.info("Performing SFM action => "+e.getName());var t=e.getRoot().recordId,n=e.getRoot().record,i=e.getData().actionDef[b.OrgNamespace+"__Process__r"][b.OrgNamespace+"__ProcessID__c"];this.__getRealProcessId(i,function(e){if(e){var i={SVMX_processId:e.inProcessId,SVMX_recordId:t,SVMX_record:n};b.getCurrentApplication().launchConsoleApp("sfmdelivery",i)}else{b.getCurrentApplication().getApplicationErrorHandler().notifyApplicationError({message:function(){return b.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG094","Process not found; check your configuration")})}})}},{key:"__getRealProcessId",value:function(e,t){var n=D,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i=n&&n.length?{inProcessId:b.toObject(n)[0].process_unique_id}:null;t(i)}),i.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getRealProcessId Failed"+e.data.data)}),i.execute({query:"SELECT process_unique_id FROM SFProcess WHERE process_id = '{{process_id}}'",queryParams:{process_id:e}})}}]),t}(R),b.defineGlobal(w.name,w),e.exports=w},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g={name:"com.servicemax.client.sync.sqlschema"},y=g;y.SQLSchema=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"getCreateQuery",value:function(e,t){var n=[],i=this.getTableSchema(e);for(var a in i.fields)if(i.fields.hasOwnProperty(a)){var r=i.fields[a],o=["'",a,"' ",r.type];r.primary&&o.push(" PRIMARY KEY "),r.auto&&o.push(" AUTOINCREMENT "),r.not_null&&o.push(" NOT NULL "),r.unique&&o.push(" UNIQUE "),o.push(" COLLATE NOCASE "),n.push(o.join(""))}return["CREATE TABLE","`"+(t||i.table)+"`","(",n.join(","),")"].join(" ")}},{key:"getInsertQuery",value:function(e,t,n,i){if(!t)throw"SQLSchema.getInsertQuery: Record is not defined";var a=[],r=this.getTableSchema(e);for(var o in r.fields)r.fields.hasOwnProperty(o)&&(r.fields[o].auto||a.push(o));var s=[];if(n)if(t instanceof Array)s=t;else{if(!t)return null;s=m.array.map(t,function(e){return e})}else s=[t];var l=[],c=0,u=s.length;for(c;c<u;c++){var d=[],_=0,h=a.length;for(_;_<h;_++){var f=r.fields[a[_]],p=s[c][a[_]];p=f&&"DOUBLE"===f.type?null!==p&&void 0!==p&&""!==p?Number(p):null:p||"",p="string"==typeof p?"'"+p.replace(new RegExp("'","g"),"''")+"'":null!==p?"'"+p+"'":"null",d.push(p)}l.push("("+d.join(",")+")")}return["INSERT INTO","`"+(i||r.table)+"`",["('",a.join("','"),"')"].join(""),"VALUES",l.join(",")].join(" ")}},{key:"getInsertReplaceQuery",value:function(e,t,n,i){return this.getInsertQuery(e,t,n,i).replace(/^INSERT/,"INSERT OR REPLACE")}},{key:"getUpdateQuery",value:function(e,t,n,i){var a=this.getTableSchema(e);!n&&t.Id&&(n=t.Id,delete t.Id);var r=[];for(var o in t)o in a.fields&&r.push(o+" = {{"+o+"}}");var s={};if("string"==typeof n)t.whereId=n,s.Id=n;else if(n)for(var o in n)s[o]=n[o];else s.Id=t.Id;var l=[];for(var o in s){var c="where_"+o;l.push(o+" = {{"+c+"}}"),t[c]=s[o]}var u=["UPDATE","`"+(i||a.table)+"`","SET",r.join(","),"WHERE ",l.join(" AND ")].join(" ");return this.bindSQLParams(u,t,a.fields)}},{key:"getDeleteQuery",value:function(e,t,n){var i=this.getTableSchema(e),a=["DELETE FROM",n||i.table,"WHERE Id",t.length>0?"IN('"+t.join("','")+"'')":"= {{whereId}}"].join(" ");return this.bindSQLParams(a,{whereId:t},i.fields)}},{key:"getSelectQuery",value:function(e,t,n,i){var a=this.getTableSchema(e),r=[];for(var o in t)o in a.fields&&r.push(o+" = {{"+o+"}}");0==r.length&&(r=["1 = 1"]);var s=n?n.join(","):"*",l=["SELECT",s,"FROM",i||a.table,"WHERE",r.join(" AND ")].join(" ");return this.bindSQLParams(l,t,a.fields)}},{key:"getRenameTableQuery",value:function(e,t){return"DROP TABLE IF EXISTS `"+t+"`;ALTER TABLE `"+e+"` RENAME TO `"+t+"`;"}},{key:"getTableSchema",value:function(e){if(!this.tables[e])throw"SQL table schema not found by '"+e+"'";if(!this.tables[e].fields)throw"SQL table fields not defined in '"+e+"'";return this.tables[e]}},{key:"addSObjectSchema",value:function(e){var t=e.fields,n=e.name;if(this.tables[n]={table:n,fields:{Id:{type:"VARCHAR",not_null:!0,primary:!0,unique:!0}}},t&&t.length>0)for(var i=0;i<t.length;i++){var a=t[i].name;if(!this.tables[n].fields[a]){var r=null;switch(t[i].type){case"currency":case"double":case"percent":r="DOUBLE";break;case"boolean":case"string":case"textarea":case"date":case"datetime":case"picklist":case"reference":default:r="VARCHAR"}this.tables[n].fields[a]={type:r,sftype:t[i].type}}}}},{key:"bindSQLParams",value:function(e,t,n){for(var i in t){var a="'"+t[i]+"'";if("string"==typeof t[i]){var r=n&&n[i]&&n[i].type||"VARCHAR";-1!==["VARCHAR","DATE","DATETIME"].indexOf(r)&&(a="'"+t[i].replace(new RegExp("'","g"),"''")+"'"),"BOOLEAN"===r&&(a=a?1:0)}t[i]=a}return m.string.substitute(e,t)}}]),t}(v),y.SQLSchema.tables={SFObjectLayoutDescribe:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_name:{type:"VARCHAR"},object_layout_describe:{type:"VARCHAR"}}},SFNamedSearchCriteria:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},id:{type:"VARCHAR",unique:!0},name:{type:"VARCHAR"},default_on:{type:"VARCHAR"},field_name:{type:"VARCHAR"},allow_override:{type:"VARCHAR"},advanced_exp:{type:"VARCHAR"},rule_type:{type:"VARCHAR"},parent_object_criteria:{type:"VARCHAR"},source_object_name:{type:"VARCHAR"},sequence:{type:"VARCHAR"},named_search:{type:"VARCHAR"}}},SFSourceUpdate:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},process_id:{type:"VARCHAR"},Id:{type:"VARCHAR",unique:!0},target_process_node:{type:"VARCHAR"},source_field_name:{type:"VARCHAR"},target_field_name:{type:"VARCHAR"},configuration_type:{type:"VARCHAR"},display_value:{type:"VARCHAR"},process:{type:"VARCHAR"},action:{type:"VARCHAR"},question:{type:"VARCHAR"}},createIfMissing:!0},SFLinkedProcess:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},source_header:{type:"VARCHAR"},target_header:{type:"VARCHAR"},source_detail:{type:"VARCHAR"}}},SFDocTemplate:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},doc_template_id:{type:"VARCHAR"},doc_template_name:{type:"VARCHAR"},is_standard:{type:"VARCHAR"},media_resources:{type:"VARCHAR"},detail_object_count:{type:"VARCHAR"}},createAlways:!0},SFDocTemplateDetail:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},type:{type:"VARCHAR"},alias:{type:"VARCHAR"},doc_template:{type:"VARCHAR"},doc_template_detail_id:{type:"VARCHAR"},doc_template_detail_unique_id:{type:"VARCHAR"},fields:{type:"VARCHAR"},header_ref_fld:{type:"VARCHAR"},object_name:{type:"VARCHAR"},soql:{type:"VARCHAR"}},createAlways:!0},SFProcessBusinessRule:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},business_rule:{type:"VARCHAR"},error_msg:{type:"VARCHAR"},name:{type:"VARCHAR"},process_node_object:{type:"VARCHAR"},sequence:{type:"VARCHAR"},target_manager:{type:"VARCHAR"},description:{type:"VARCHAR"},section:{type:"VARCHAR"},rule_type:{type:"VARCHAR"},target_section:{type:"VARCHAR"}}},SFBusinessRule:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},description:{type:"VARCHAR"},error_msg:{type:"VARCHAR"},name:{type:"VARCHAR"},process_ID:{type:"VARCHAR"},source_object_name:{type:"VARCHAR"},advanced_expression:{type:"VARCHAR"},message_type:{type:"VARCHAR"},rule_type:{type:"VARCHAR"}}},SFExpression:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},expression_id:{type:"VARCHAR",unique:!0},expression:{type:"VARCHAR"},expression_name:{type:"VARCHAR"},advance_expression:{type:"VARCHAR"},source_object_name:{type:"VARCHAR"},error_message:{type:"VARCHAR"},rule_type:{type:"VARCHAR"}}},SFExpressionComponent:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},expression_id:{type:"VARCHAR"},field_type:{type:"VARCHAR"},operator:{type:"CHAR"},sequence:{type:"VARCHAR"},source_field_name:{type:"VARCHAR"},value:{type:"VARCHAR"},expression_rule:{type:"VARCHAR"},expression_type:{type:"VARCHAR"},parameter_type:{type:"VARCHAR"},formula:{type:"VARCHAR"},action_type:{type:"VARCHAR"}}},SFProcess:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},process_id:{type:"VARCHAR",unique:!0},process_unique_id:{type:"VARCHAR",unique:!0},process_type:{type:"VARCHAR"},process_name:{type:"VARCHAR"},process_description:{type:"VARCHAR"},page_layout_id:{type:"VARCHAR"},process_info:{type:"VARCHAR"},doc_template_id:{type:"VARCHAR"},include_skipped_sections:{type:"VARCHAR"},run_targeted_sync:{type:"VARCHAR"},file_version_enabled:{type:"VARCHAR"}},createAlways:!0},SFProcessComponent:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},process_id:{type:"VARCHAR"},component_type:{type:"VARCHAR"},object_name:{type:"VARCHAR"},sequence:{type:"VARCHAR"},layout_id:{type:"VARCHAR"},expression_id:{type:"VARCHAR"},object_mapping_id:{type:"VARCHAR"},value_mapping_id:{type:"VARCHAR"},target_object_label:{type:"VARCHAR"},parent_column:{type:"VARCHAR"},node_parent_api:{type:"VARCHAR"},parent_object:{type:"VARCHAR"},enable_attachment:{type:"VARCHAR"},advanced_options:{type:"VARCHAR"},Id:{type:"VARCHAR",unique:!0},doc_template_detail_id:{type:"VARCHAR"}}},SFPageLayout:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},page_layout_id:{type:"VARCHAR",unique:!0},page_data:{type:"VARCHAR"}}},SFObjectDescribe:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_name:{type:"VARCHAR"},object_describe:{type:"VARCHAR"},key_prefix:{type:"VARCHAR"},label:{type:"VARCHAR"}},createAlways:!0},SFObjectField:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_api_name:{type:"VARCHAR"},api_name:{type:"VARCHAR"},label:{type:"VARCHAR"},precision:{type:"DOUBLE"},scale:{type:"DOUBLE"},length:{type:"INTEGER"},type:{type:"VARCHAR"},reference_to:{type:"VARCHAR"},nillable:{type:"BOOL"},unique:{type:"BOOL"},restricted_picklist:{type:"BOOL"},calculated:{type:"BOOL"},defaulted_on_create:{type:"BOOL"},name_field:{type:"BOOL"},relationship_name:{type:"VARCHAR"},dependent_picklist:{type:"BOOL"},controler_field:{type:"VARCHAR"}},createAlways:!0},SFObjectMapping:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_mapping_id:{type:"VARCHAR",unique:!0},source_object_name:{type:"VARCHAR"},target_object_name:{type:"VARCHAR"}}},SFObjectMappingComponent:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_mapping_id:{type:"VARCHAR"},source_field_name:{type:"VARCHAR"},target_field_name:{type:"VARCHAR"},mapping_value:{type:"VARCHAR"},mapping_value_flag:{type:"VARCHAR"},mapping_component_type:{type:"VARCHAR"},preference_2:{type:"VARCHAR"},preference_3:{type:"VARCHAR"}}},SFRecordName:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},Name:{type:"VARCHAR"}},createAlways:!0},SFNamedSearch:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},default_lookup_column:{type:"VARCHAR"},object_name:{type:"VARCHAR"},search_name:{type:"VARCHAR"},search_type:{type:"VARCHAR"},search_sfid:{type:"VARCHAR",unique:!0},named_search_id:{type:"VARCHAR"},no_of_lookup_records:{type:"VARCHAR"},is_default:{type:"VARCHAR"},is_standard:{type:"VARCHAR"}}},SFNamedSearchComponent:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},expression_type:{type:"VARCHAR"},field_name:{type:"VARCHAR"},named_search:{type:"VARCHAR"},search_object_field_type:{type:"VARCHAR"},field_type:{type:"VARCHAR"},field_relationship_name:{type:"VARCHAR"},sequence:{type:"VARCHAR"}}},SFPickList:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_api_name:{type:"VARCHAR"},field_api_name:{type:"VARCHAR"},label:{type:"VARCHAR"},value:{type:"VARCHAR"},defaultvalue:{type:"VARCHAR"},valid_for:{type:"VARCHAR"},index_value:{type:"INTEGER"}}},SFReferenceTo:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_api_name:{type:"VARCHAR"},field_api_name:{type:"VARCHAR"},reference_to:{type:"VARCHAR"}}},SFRTPicklist:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_api_name:{type:"VARCHAR"},recordtypename:{type:"VARCHAR"},recordtypelayoutid:{type:"VARCHAR"},recordtypeid:{type:"VARCHAR"},field_api_name:{type:"VARCHAR"},label:{type:"VARCHAR"},value:{type:"VARCHAR"},defaultlabel:{type:"VARCHAR"},defaultvalue:{type:"VARCHAR"}}},SFWizard:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_name:{type:"VARCHAR"},wizard_id:{type:"VARCHAR",unique:!0},expression_id:{type:"VARCHAR"},wizard_description:{type:"VARCHAR"},wizard_name:{type:"VARCHAR"},sequence:{type:"VARCHAR"},is_active:{type:"VARCHAR"}}},SFWizardComponent:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},wizard_id:{type:"VARCHAR"},action_id:{type:"VARCHAR",unique:!0},action_description:{type:"VARCHAR"},expression_id:{type:"VARCHAR"},process_id:{type:"VARCHAR"},action_type:{type:"VARCHAR"},action_name:{type:"VARCHAR"},perform_sync:{type:"VARCHAR"},class_name:{type:"VARCHAR"},method_name:{type:"VARCHAR"},sequence:{type:"VARCHAR"},customActionType:{type:"VARCHAR"},customUrl:{type:"VARCHAR"},schema_name:{type:"VARCHAR"},path:{type:"VARCHAR"},include_object_data_set:{type:"VARCHAR"},mode_of_execution:{type:"VARCHAR"}}},SFAttachments:{fields:{Id:{type:"VARCHAR",unique:!0},parent_id:{type:"VARCHAR"},created_by_id:{type:"VARCHAR"},name:{type:"VARCHAR"},file_path:{type:"VARCHAR"},description:{type:"VARCHAR"},content_type:{type:"VARCHAR"},content_length:{type:"VARCHAR"},downloaded:{type:"VARCHAR"},last_modified_date:{type:"VARCHAR"},file_type:{type:"VARCHAR"},process_id:{type:"VARCHAR"},content_document_id:{type:"VARCHAR"}},createAlways:!0},MobileDeviceSettings:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},setting_id:{type:"VARCHAR"},value:{type:"VARCHAR"}},createAlways:!0},MobileDeviceTags:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},module_id:{type:"VARCHAR"},tag_id:{type:"VARCHAR"},value:{type:"VARCHAR"}},createAlways:!0},SmartDocHTML:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},name:{type:"VARCHAR"},process_id:{type:"VARCHAR"},record_id:{type:"VARCHAR"},submitted:{type:"VARCHAR"},file_process_id:{type:"VARCHAR"},version_enabled:{type:"VARCHAR"}},createAlways:!0},SmartDocSignature:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},name:{type:"VARCHAR"},html_name:{type:"VARCHAR"},process_id:{type:"VARCHAR"},record_id:{type:"VARCHAR"},unique_id:{type:"VARCHAR"},submitted:{type:"VARCHAR"},attachment:{type:"VARCHAR"}},createAlways:!0},SFChildRelationship:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},object_api_name_parent:{type:"VARCHAR"},object_api_name_child:{type:"VARCHAR"},cascade_delete:{type:"BOOL"},field_api_name:{type:"VARCHAR"}}},SFM_Search_Field:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},SVMXC__Expression_Rule__c:{type:"VARCHAR"},SVMXC__Field_Name__c:{type:"VARCHAR"},SVMXC__Object_Name2__c:{type:"VARCHAR"},SVMXC__Search_Object_Field_Type__c:{type:"VARCHAR"},ObjectId:{type:"VARCHAR"}}},SFM_Search_Filter_Criteria:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},SVMXC__Display_Type__c:{type:"VARCHAR"},SVMXC__Expression_Rule__c:{type:"VARCHAR"},SVMXC__Field_Name__c:{type:"VARCHAR"},SVMXC__Object_Name2__c:{type:"VARCHAR"},SVMXC__Operand__c:{type:"VARCHAR"},SVMXC__Operator__c:{type:"VARCHAR"},ObjectId:{type:"VARCHAR"}}},SFM_Search_Objects:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},SVMXC__Module__c:{type:"VARCHAR"},SVMXC__ProcessID__c:{type:"VARCHAR"},SVMXC__Target_Object_Name__c:{type:"VARCHAR"},ProcessName:{type:"VARCHAR"},ProcessId:{type:"VARCHAR"},ObjectID:{type:"VARCHAR"},SVMXC__Advance_Expression__c:{type:"VARCHAR"},SVMXC__Name__c:{type:"VARCHAR"}}},SFM_Search_Process:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},Name:{type:"VARCHAR"},SVMXC__Active__c:{type:"VARCHAR"},SVMXC__Description__c:{type:"VARCHAR"},SVMXC__IsDefault__c:{type:"VARCHAR"},SVMXC__IsStandard__c:{type:"VARCHAR"},SVMXC__Name__c:{type:"VARCHAR"},SVMXC__Number_of_Lookup_Records__c:{type:"VARCHAR"},SVMXC__Rule_Type__c:{type:"VARCHAR"}}},ClientCache:{fields:{key:{type:"VARCHAR",unique:!0},value:{type:"VARCHAR"}},createAlways:!0},ClientSyncConflict:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},parent_id:{type:"VARCHAR"},operation:{type:"VARCHAR"},error_type:{type:"VARCHAR"},error_message:{type:"VARCHAR"},override_flag:{type:"VARCHAR"}},createAlways:!0},ClientSyncLog:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},record_type:{type:"VARCHAR"},parent_id:{type:"VARCHAR"},operation:{type:"VARCHAR"},modified_at:{type:"VARCHAR"},old_values:{type:"VARCHAR"},new_values:{type:"VARCHAR"},ObjectName:{type:"VARCHAR"},Pending:{type:"VARCHAR"}},createAlways:!0},SmartSyncTimeStamp:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},lastSyncTime:{type:"VARCHAR"}},createAlways:!0},SfmWebServiceActionsLog:{fields:{Id:{type:"VARCHAR"},record_type:{type:"VARCHAR"},sfm_process_id:{type:"VARCHAR"},event_type:{type:"VARCHAR"},action_time:{type:"VARCHAR"},process_type:{type:"VARCHAR"},method_name:{type:"VARCHAR"},call_type:{type:"VARCHAR"},sync_type:{type:"VARCHAR"}},createAlways:!0},ClientSuccSyncLog:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},record_type:{type:"VARCHAR"},parent_id:{type:"VARCHAR"},operation:{type:"VARCHAR"},modified_at:{type:"VARCHAR"},old_values:{type:"VARCHAR"},new_values:{type:"VARCHAR"},change_type:{type:"VARCHAR"},object_name:{type:"VARCHAR"}},createAlways:!0},SyncDependentLog:{fields:{local_id:{type:"VARCHAR"},parent_object_name:{type:"VARCHAR"},parent_record_id:{type:"VARCHAR"},parent_field_name:{type:"VARCHAR"},sfdc_Id:{type:"VARCHAR"}},createAlways:!0},ClientDataOnDemand:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},last_modified_date:{type:"VARCHAR"}},createAlways:!0},SynchronousCache:{fields:{cache_name:{type:"VARCHAR"},cache_key:{type:"VARCHAR"},cache_value:{type:"VARCHAR"},is_object:{type:"INTEGER"}},createIfMissing:!0},InstallBaseLock:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR",unique:!0},Object_Name:{type:"VARCHAR"}},createIfMissing:!0},InstallBaseObject:{fields:{Object_Name:{type:"VARCHAR",primary:!0,not_null:!0,unique:!0}},createIfMissing:!0},UserGPSLog:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Additional_Info:{type:"VARCHAR"},Device_Type:{type:"VARCHAR"},Latitude:{type:"DOUBLE"},Longitude:{type:"DOUBLE"},Status:{type:"VARCHAR"},Time_Recorded:{type:"VARCHAR"}},createAlways:!0},CustomActionParams:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},Name:{type:"VARCHAR"},DispatchProcessId:{type:"VARCHAR"},ParameterName:{type:"VARCHAR"},ParameterValue:{type:"VARCHAR"},ParameterType:{type:"VARCHAR"}},createIfMissing:!0},ServiceMaxEventIdMapping:{fields:{Id:{type:"VARCHAR",unique:!0},originalId:{type:"VARCHAR"},mappedId:{type:"VARCHAR"}},createAlways:!0,createIfMissing:!0},SFChatterFeedInfo:{fields:{Id:{type:"VARCHAR",unique:!0},feedJSON:{type:"VARCHAR"}},createAlways:!0,createIfMissing:!0},Product_Troubleshoot_Documents:{fields:{Id:{type:"VARCHAR",unique:!0},Name:{type:"VARCHAR"},Description:{type:"VARCHAR"},Keywords:{type:"VARCHAR"},Type:{type:"VARCHAR"},BodyLength:{type:"INTEGER"},attType:{type:"VARCHAR"},attUrl:{type:"VARCHAR"},docType:{type:"VARCHAR"},online:{type:"VARCHAR"},parentId:{type:"VARCHAR"}},createAlways:!0,createIfMissing:!0},RecentItems:{fields:{local_id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Type:{type:"VARCHAR"},RecordId:{type:"VARCHAR",unique:!0},ObjectName:{type:"VARCHAR"},LastAccessed:{type:"VARCHAR"},NameField:{type:"VARCHAR"}},createIfMissing:!0},SFUsageData:{fields:{key:{type:"VARCHAR"},value:{type:"VARCHAR"}},createAlways:!0},ErrorLog:{fields:{key:{type:"VARCHAR",unique:!0},value:{type:"VARCHAR"}},createAlways:!0},Configuration:{fields:{RecordId:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Type:{type:"VARCHAR"},Key:{type:"VARCHAR"},Value:{type:"VARCHAR"}},createAlways:!0},ClientSyncLogTransient:{fields:{RecordId:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:{type:"VARCHAR"},ObjectName:{type:"VARCHAR"},LastModifiedDate:{type:"VARCHAR"},Pending:{type:"VARCHAR"}},createAlways:!0},SFQuestionBank:{fields:{Id:{type:"VARCHAR",unique:!0},Name:{type:"VARCHAR"},LastModifiedBy:{type:"VARCHAR"},CurrencyIsoCode:{type:"VARCHAR"},CreatedBy:{type:"VARCHAR"},Help_URL:{type:"VARCHAR"},Length:{type:"VARCHAR"},Precision:{type:"VARCHAR"},Question:{type:"VARCHAR"},QuestionID:{type:"VARCHAR"},QuestionJSON:{type:"VARCHAR"},Response_Set:{type:"VARCHAR"},Response_Type:{type:"VARCHAR"},Scale:{type:"VARCHAR"},Short_Name:{type:"VARCHAR"},Show_In_SmartDoc:{type:"VARCHAR"},Description_Required:{type:"VARCHAR"}},createAlways:!0},SFChecklistOPDOC:{fields:{Id:{type:"VARCHAR",unique:!0},Name:{type:"VARCHAR"},RecordTypeId:{type:"VARCHAR"},OPDOCProcessId:{type:"VARCHAR"},ChecklistProcessId:{type:"VARCHAR"},ChecklistVersion:{type:"VARCHAR"}},createAlways:!0},SFQBResponseSet:{fields:{Id:{type:"VARCHAR",unique:!0},Name:{type:"VARCHAR"},LastModifiedBy:{type:"VARCHAR"},CurrencyIsoCode:{type:"VARCHAR"},CreatedBy:{type:"VARCHAR"},Response_Set_Values:{type:"VARCHAR"}},createAlways:!0},SFChecklistDefaultResponseSet:{fields:{Id:{type:"VARCHAR",unique:!0},DefaultResponse:{type:"VARCHAR"},Is_literal_Used:{type:"VARCHAR"},Question:{type:"VARCHAR"}},createAlways:!0},Sync_Records_Heap:{fields:{SFId:{type:"VARCHAR",not_null:!0,unique:!0},LocalId:"VARCHAR",ObjectName:"VARCHAR",SyncType:"VARCHAR",SyncFlag:"BOOL",RecordType:"VARCHAR",SyncResponseType:"VARCHAR",ParallelSyncType:"VARCHAR"},createAlways:!0},Sync_PiqExisting_Ibs:{fields:{Local_Id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:"VARCHAR"}},Sync_PiqExisting_Sites:{fields:{Local_Id:{type:"INTEGER",primary:!0,auto:!0,not_null:!0,unique:!0},Id:"VARCHAR"}},InventoryConfig:{fields:{Type:"VARCHAR",Content:"VARCHAR"},createIfMissing:!0},codeSnippetIdConfig:{fields:{snippetId:"VARCHAR"},createIfMissing:!0}},y.SQLSchema.tables=m.toObject(m.toJSON(y.SQLSchema.tables).replace(/"SVMXC__/g,'"'+m.OrgNamespace+"__")),m.array.forEach((0,r.default)(y.SQLSchema.tables),function(e){y.SQLSchema.tables[e].table=e}),y.SQLSchema.staticTables=m.toObject(m.toJSON(y.SQLSchema.tables)),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g=n(7).ServerInfo,y=n(7).CheckListChunkUtils,S=n(11).Facade,E={name:"com.servicemax.client.offline.sal.model.multiversionbehavior"};E.Facade=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"getVersionClass",value:function(){var e=g.getServerVersion(),t=this.getVersionKey(e);return new(0,this.__versionClassMap[t])(this)}},{key:"getVersionKey",value:function(e){e=e?e.replace(".",""):"";for(var t=parseInt(e),n="default",i=(0,r.default)(this.__versionClassMap),a=0;a<i.length;a++){var o=parseInt(i[a]);if(o&&o>=t){n=i[a];break}}return n}}]),t}(v);var b=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"38.0"}},{key:"getPiqProductAttributeDataInitialClassName",value:function(){return"PiqProductAttributeDataInitial"}},{key:"getPiqProductAttributeDataIncrementalClassName",value:function(){return"PiqProductAttributeDataIncremental"}},{key:"isProductIQEnabled",value:function(){return!0}},{key:"getChecklistMetaJson",value:function(e,t,n){var i=e.__data.sfmData,a=this;y.getCombinedChecklistData(i).then(function(i){var r=m.getCustomFieldName("ChecklistMetaJSON");e.__data.sfmData[r]=i[r],a.parseChecklistPageLayout(e,t,n)})}},{key:"parseChecklistPageLayout",value:function(e,t,n){var i=e.__data.sfmData[m.getCustomFieldName("ChecklistMetaJSON")],a=null;if(i){try{a=m.toObject(i)}catch(e){console.warn("Unable to parse Checklist page layout")}t&&a?t.result(a):n(e)}}},{key:"getChecklistSuccessCallback",value:function(){return"__getChecklistRecordSuccess"}},{key:"isChecklistMultiRowSequencingEnabled",value:function(){return!0}},{key:"getChecklistExistingTemplateQuery",value:function(){var e=this.getQueryForChecklistTemplate();return e+=" AND ( "+m.getCustomFieldName("SM_Sequence")+" IN ('','0','1','0.0','1.0'))"}},{key:"getQueryForChecklistTemplate",value:function(){return"SELECT     c.Id as targetId,     c."+m.getCustomFieldName("Completed_On")+",     c."+m.getCustomFieldName("Status")+",     c."+m.getCustomFieldName("ChecklistProcessID")+",     p.process_id, p.process_unique_id, p.process_type,     p.process_name, p.process_description,     pc.expression_id FROM "+m.getCustomFieldName("Checklist")+" AS c JOIN SFProcess as p     ON p.process_id = c."+m.getCustomFieldName("ChecklistProcessID")+" LEFT JOIN SFProcessComponent AS pc     ON c."+m.getCustomFieldName("ChecklistProcessID")+"  = pc.process_id      AND pc.component_type = 'TARGET' WHERE     c."+m.getCustomFieldName("What_Id")+" = '{{record_id}}'"}},{key:"getArrayCollectionForChecklistTemplate",value:function(e){e.arrCols.push(m.getCustomFieldName("ChecklistJSON")),e.arrCols.push(m.getCustomFieldName("ChecklistMetaJSON")),e.arrCols.push("CreatedDate"),e.arrCols.push(m.getCustomFieldName("SM_Checklist_Group_Id")),e.arrCols.push(m.getCustomFieldName("SM_Sequence"))}},{key:"getFirstLevelQueryForChecklistInOpdoc",value:function(e){return e=e+" AND ( "+m.getCustomFieldName("SM_Sequence")+" IN ('','0','1','0.0','1.0'))"}},{key:"isChecklistAttachementsEnabled",value:function(){return!0}},{key:"shouldChecklistLocationAndTimeTracked",value:function(){return!0}},{key:"isTargetedSyncEnabled",value:function(e){var t=this;this._isTargetedSyncEnabledAtProcessLevel(function(n){if(!n||!1===n){var i=m.getCurrentApplication().getSyncImpl(),a=i.getSyncSettingValue("ENABLE_AGGRESSIVE");a&&"smart sync"===(a=a.toString().toLowerCase())&&(n=!0)}e&&e.call(t,n)})}},{key:"_isTargetedSyncEnabledAtProcessLevel",value:function(e){var t={query:"SELECT run_targeted_sync FROM SFProcess WHERE run_targeted_sync = 'true'"};this._initSQLServiceRequest(t,{handler:function(t){var n=!1;t&&t.length>0&&(n=!0),e&&e.call(this,n)}})}},{key:"_initSQLServiceRequest",value:function(e,t){var n=S.createSQLRequest();n.bind("REQUEST_COMPLETED",function(e){var n=e.data.data||[];t&&t.handler.call(t.context||this,n)},this),n.bind("REQUEST_ERROR",function(n){var i="SQL Request failed: "+e.query;t&&t.handler.call(t.context||this,[],i)},this),n.execute({query:e.query})}},{key:"sendTargetedSyncKeyinOneCallMetaSync",value:function(){return!0}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!0}},{key:"isSalesForceFilesEnabled",value:function(){var e=m.getCurrentApplication().getSyncImpl();if(e){return!!e.getSyncSettingValue("SFILES_ENABLED")&&e.getSyncSettingValue("SFILE_SUPPORTED")}return!1}},{key:"isCustomSnippetSupported",value:function(){return!0}},{key:"preventChooseFromLibrary",value:function(e){var t=m.getCurrentApplication().getSyncImpl();return!!t&&t.getSyncSettingValue("PREVENT_CHOOSE_FROM_LIBRARY")}}]),t}(v),T=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(b),M=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!1}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(b),I=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"shouldChecklistLocationAndTimeTracked",value:function(){return!1}},{key:"isTargetedSyncEnabled",value:function(e){e&&e.call(this,!1)}},{key:"sendTargetedSyncKeyinOneCallMetaSync",value:function(){return!1}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!1}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(b),C=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"shouldChecklistLocationAndTimeTracked",value:function(){return!1}},{key:"isTargetedSyncEnabled",value:function(e){e&&e.call(this,!1)}},{key:"sendTargetedSyncKeyinOneCallMetaSync",value:function(){return!1}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!1}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(b),A=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"isChecklistAttachementsEnabled",value:function(){return!1}},{key:"shouldChecklistLocationAndTimeTracked",value:function(){return!1}},{key:"isTargetedSyncEnabled",value:function(e){e&&e.call(this,!1)}},{key:"sendTargetedSyncKeyinOneCallMetaSync",value:function(){return!1}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!1}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(b),D=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"getPiqProductAttributeDataInitialClassName",value:function(){return"PiqProductAttributeDataInitialWin17"}},{key:"getPiqProductAttributeDataIncrementalClassName",value:function(){return"PiqProductAttributeDataIncrementalWin17"}},{key:"isChecklistAttachementsEnabled",value:function(){return!1}},{key:"shouldChecklistLocationAndTimeTracked",value:function(){return!1}},{key:"isTargetedSyncEnabled",value:function(e){e&&e.call(this,!1)}},{key:"sendTargetedSyncKeyinOneCallMetaSync",value:function(){return!1}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!1}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(b),x=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"objectDescribeAPIVersion",value:function(){return"24.0"}},{key:"isProductIQEnabled",value:function(){return!1}},{key:"getChecklistMetaJson",value:function(e,t,n){this.parseChecklistPageLayout(e,t,n)}},{key:"getChecklistSuccessCallback",value:function(){return"__getRecordSuccess"}},{key:"isChecklistMultiRowSequencingEnabled",value:function(){return!1}},{key:"getChecklistExistingTemplateQuery",value:function(){return this.getQueryForChecklistTemplate()}},{key:"getArrayCollectionForChecklistTemplate",value:function(e){e.arrCols.push(m.getCustomFieldName("ChecklistJSON")),e.arrCols.push(m.getCustomFieldName("ChecklistMetaJSON"))}},{key:"getFirstLevelQueryForChecklistInOpdoc",value:function(e){return e}},{key:"isChecklistAttachementsEnabled",value:function(){return!1}},{key:"shouldChecklistLocationAndTimeTracked",value:function(){return!1}},{key:"isTargetedSyncEnabled",value:function(e){e&&e.call(this,!1)}},{key:"sendTargetedSyncKeyinOneCallMetaSync",value:function(){return!1}},{key:"runTargetedSyncForChecklistAndOpdoc",value:function(){return!1}},{key:"isSalesForceFilesEnabled",value:function(){return!1}},{key:"isCustomSnippetSupported",value:function(){return!1}},{key:"preventChooseFromLibrary",value:function(){return!1}}]),t}(D);E.DeprecatedVersionSum17=A,E.DeprecatedVersionWin17=D,E.DeprecatedVersionSum16SP=x,E.LatestVersion=b,E.Facade.__versionClassMap={default:b,183e4:T,182e4:M,181e4:I,173e4:C,172e4:A,171e4:D,166e4:x},E.Facade.__currentVersion=null,m.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(31),s=i(o),l=n(18),c=i(l),u=n(16),d=i(u),_=n(1),h=i(_),f=n(2),p=i(f),m=n(3),v=i(m),g=n(6),y=i(g),S=n(4),E=i(S),b=n(30),T=i(b),M=n(10),I=n(0).utils,C=n(56),A=n(7).ServerInfo,D=n(7).MetaData,x=(n(11).Facade,n(7).Data,{name:"com.servicemax.client.sync.syncdataapi"}),R=x,O=D,L=A;(0,T.default)(R,C),x.SyncGetEvents=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._syncGetEvents({eventName:"EVENT_SYNC",handler:function(e){var t=this._resultToObjectReqs(e);this._commonSyncObjectRecords(t,"insert")}})}},{key:"_syncGetEvents",value:function(e){var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:e.eventName}};e.clientId&&(t.data.value=e.clientId),e.lastSyncTime&&(t.data.valueMap=[{key:"LAST_SYNC_TIME",value:e.lastSyncTime}]),this._initHTTPServiceRequest(t,{handler:function(t){var n=this._serviceDataToObject(t)||{};n.LAST_SYNC&&this._setLastSyncTime(n.LAST_SYNC,e.lastSyncTimeType),"EVENT_SYNC"===e.eventName?this.__filterExtraEvents(n,function(){n&&e.handler&&e.handler.call(this,n,t)}):n&&e.handler&&e.handler.call(this,n,t)}})}},{key:"__filterExtraEvents",value:function(e,t){this._syncGetEvents({eventName:"GET_UPDATE",clientId:this._getClientId(),lastSyncTime:e.LAST_SYNC,lastSyncTimeType:"UPDATE",handler:function(n,i){e.Event=e.Event||{},n.Event=n.Event||{};var a=e.Event.Fields?I.toObject(e.Event.Fields):[],r=n.Event.REC_IDS?I.toObject(n.Event.REC_IDS):[];if(e.Event.Fields_){for(var o=0;o<e.Event.Fields_.length;o++){var s=I.toObject(e.Event.Fields_[o]);a=a.concat(s)}delete e.Event.Fields_}for(var o=0;o<a.length;o++){for(var l=!1,c=0;c<r.length;c++)a[o].Id===r[c].Id&&(l=!0);l||(a.splice(o,1),o--)}e.Event.Fields=I.toJSON(a),t.call(this)}})}},{key:"_resultToObjectReqs",value:function(e){var t=this._getState("SYNC_TXFETCH_IDS")||[],n=[];for(var i in e)if("LAST_SYNC"!=i&&"SVMX_LOG_ID"!=i&&"GET_UPDATE_LST"!=i){var a=i,r=e[i];if(r){"string"==typeof r&&(r={Fields_:[r]});for(var o=r.Fields_||[r.Fields]||[],s=[],l=r.REC_IDS?I.toObject(r.REC_IDS):null,c=0;c<o.length;c++){var u=I.toObject(o[c]);if(u)for(var d=0;d<u.length;d++){if(l){for(var _=!1,i=0;i<l.length;i++)if(u[d].Id===l[i].Id){_=!0;break}if(!_)continue}-1===t.indexOf(u[d].Id)&&-1===s.indexOf(u[d].Id)&&(s.push(u[d].Id),t.push(u[d].Id))}}n.push({value:a,values:s})}}return this._setState("SYNC_TXFETCH_IDS",t),n}}]),t}(R.SyncEvent),x.SyncDataEvent=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"setStateForSyncRequest",value:function(e,t,n,i){var a=this._getState(i+"."+e);a||(a={requestCollection:[],syncEvent:n}),a.requestCollection.push(t),this._setState(i+"."+e,a)}},{key:"_filterUnsyncableRecords",value:function(e){if(!e.ids.length)return!1;var t=[],n=this._getState("UNSYNCABLE_RECORDS")||{};for(var i in e.records)this.__isSyncableRecord(e.records[i],e.describe[i.substring(0,3)],n)&&t.push(i);for(var i in n)if(e.ids.indexOf(i)<0){for(var a=n[i],r=[],o=!1,s=0,l=a.length;s<l;s++){var c=a[s];c.isInsert?o=!0:e.ids.indexOf(c.recId)>=0&&t.indexOf(c.recId)<0&&r.indexOf(c.recId)<0&&r.push(c.recId)}!o&&r.length&&(t=t.concat(r))}for(var u=[],s=0,l=t.length;s<l;s++)e.ids.indexOf(t[s])>=0&&u.push(t[s]);return t=u,this._setState("UNSYNCABLE_RECORDS",n),!(!e.ids.length||e.ids.length===t.length)&&(this._filterSyncRecordsById(e,t),!0)}},{key:"_filterSyncRecordsById",value:function(e,t){function n(e){for(var n in e)t.indexOf(n)<0&&delete e[n]}function i(e){e.master&&n(e.master,t),e.detail&&n(e.detail,t)}if(e&&t){for(var a=0,r=e.byOrder.length;a<r;a++)i(e.byOrder[a]);for(var o in e.byObject)n(e.byObject[o],t);i(e.byType),n(e.syncLogRecords),n(e.oldRecords),n(e.parents),n(e.records)}}},{key:"__isSyncableRecord",value:function(e,t,n){var i=!1,a=!1;if(!(e&&t&&t.fields))return!0;var r=I.getCustomObjectName("Checklist"),o=I.getCustomObjectName("What_Id"),s=I.getCustomObjectName("SVMX_Event"),l=I.getCustomObjectName("WhatId");t.name===r&&(i=!0),t.name!==s&&"Event"!==t.name||(a=!0);for(var c=!0,u=0,d=t.fields.length;u<d;u++){var _=t.fields[u],h=e[_.name];if(("reference"===_.type||"id"===_.type||i||a)&&h&&(h.match(/_local_/)||h.match(/^local_/))){var f=!1;if(h in n){n[h].filter(function(t){return t.recId===e.Id&&t.field===_.name}).length&&(f=!0)}else n[h]=[];"reference"===_.type||i&&_.name===o||a&&_.name===l?(c=!1,f||n[h].push({object:t.name,field:_.name,recId:e.Id})):n[h].push({isInsert:!0})}}return c}},{key:"_updateUnsyncableRecords",value:function(e,t){if(t||(t=this._getState("UNSYNCABLE_RECORDS")))for(var n in e)if(n in t){var i,a={};(t[n]||[]).forEach(function(t){if(!t.isInsert){var i="UPDATE '"+t.object+"' SET "+t.field+"='"+e[n]+"'";(a[i]=a[i]||[]).push(t.recId)}});for(i in a)i+=" WHERE Id IN ('"+a[i].join("','")+"')",this._initSQLServiceRequest({query:i});delete t[n]}}},{key:"_getWebserviceActions",value:function(e,t){var n="SELECT "+(t?"count(*)":"*")+" FROM SfmWebServiceActionsLog WHERE sync_type != 'successive'",i=[],a=this._getState("TargetedSyncLogRecords");if(a){n+=" AND Id IN ("+a.map(function(e){return"'"+e+"'"}).join(",")+")"}for(var r=0,o=e.length;r<o;r++){var s=e[r];"BeforeUpdate"===s?i.push("event_type = 'Before Save/Update'"):"AfterUpdate"===s?i.push("event_type = 'After Save/Update'"):"AfterInsert"===s&&i.push("event_type = 'After Save/Insert'")}return i.length&&(n+=" AND (("+i.join(") OR (")+"))"),this._initSQLServiceRequest({query:n})}},{key:"_triggerWebserviceActions",value:function(e,t){function n(){a.__logger.info("Finished executing webservice actions."),t&&t.call(a)}function i(e){a.__logger.error(e||"Error in executing webservice actions."),t&&t.call(a)}var a=this;a.__triggerWebserviceActions(e).then(n,i)}},{key:"__triggerWebserviceActions",value:function(e){var t=this,n=[],i=[],a=[];return n.push(t.__getWebserviceExcludeIds(e,i)),n.push(t._getWebserviceActions(e).then(function(e){a=e})),I.when(n).then(function(){for(var e=[],n=void 0,r=0;r<i.length;r++)R.Utils.SyncData.removeSyncPutInsertRecordId(i[r]);if(a&&a.length)for(var o=0,s=a.length;o<s;o++)e.push(n=M.Deferred()),t.__triggerWebserviceAction(a[o],i,n);return I.when(e)})}},{key:"__getWebserviceExcludeIds",value:function(e,t){function n(e){if(e&&e.length)for(var n=0,i=e.length;n<i;n++)t.indexOf(e[n].Id)<0&&t.push(e[n].Id)}var i="SELECT Id FROM ClientSyncLog",a=[];return e.indexOf("BeforeUpdate")>=0&&(i+=" WHERE operation != 'update'"),a.push(this._initSQLServiceRequest({query:i}).then(n)),a.push(this._initSQLServiceRequest({query:"SELECT Id FROM ClientSyncConflict"}).then(n)),I.when(a)}},{key:"__triggerWebserviceAction",value:function(e,t,n){function i(t){if(r.__serviceRequestCount--,t.triggerable){var i=e.method_name.split("."),a={endPoint:i[0]||"",methodName:i[1]||"",soapData:t.targetRecord};r.__initCustomWebServiceRequest(e,a,n)}else n.resolve()}function a(){r.__serviceRequestCount--,n.reject()}var r=this,o={recordId:e.Id,processId:e.sfm_process_id,eventType:e.event_type,requesterId:"SYNC",excludeIds:t};r.__serviceRequestCount++,R.Utils.SyncData.getSyncWebServiceData(o).then(i,a)}},{key:"__initCustomWebServiceRequest",value:function(e,t,n){t.method="POST",t.protocol="WSSOAP";try{t.soapData=I.toXML(t.soapData)}catch(e){n.reject("Error in converting soap data to XML")}this._initHTTPServiceRequest(t,{handler:function(t,i,a,r){var o=this;if(!t||a||r)n.resolve();else{var s=e.method_name.split(".");if(("After Save/Update"===e.event_type||"After Save/Insert"===e.event_type)&&s.length>1){var l=s[1],c=I.stringToXML(t),u=I.xmlToJson(c);if(u.Envelope&&u.Envelope.Body&&u.Envelope.Body[l+"Response"]&&u.Envelope.Body[l+"Response"].result){var d=u.Envelope.Body[l+"Response"].result;if(d.pageDataSet&&d.pageDataSet.sobjectinfo&&this._saveCustomWSRecord(d.pageDataSet.sobjectinfo),d.detailDataSet){var _=M.isArray(d.detailDataSet)?d.detailDataSet:[d.detailDataSet];I.array.forEach(_,function(e){e.pageDataSet&&o._parseDetailCustomWSResponse(e.pageDataSet)})}}}this._initSQLServiceRequest({query:"DELETE FROM SfmWebServiceActionsLog WHERE Id = {{Id}} AND sfm_process_id = {{sfm_process_id}} AND event_type = {{event_type}}",binds:e},{handler:function(e){n.resolve()}})}},context:this})}},{key:"_parseDetailCustomWSResponse",value:function(e){var t=this,n=M.isArray(e)?e:[e];I.array.forEach(n,function(e){e.sobjectinfo&&t._saveCustomWSRecord(e.sobjectinfo)})}},{key:"_saveCustomWSRecord",value:function(e){var t=this,n=e.Id;if(n){var i=n.substring(0,3);this._getObjectNameForKeyPrefix(i,function(n){n&&(t._insertReplaceRecordIncremental(n,[e],!0,null),t._updateRequest(e,n))})}}},{key:"_updateRequest",value:function(e,t){if(this._request&&this._request.data&&this._request.data.valueMap)for(var n=this._request.data.valueMap.length,i=0;i<n;i++){var a=this._request.data.valueMap[i];if(a&&a.key&&"PUT_UPDATE"==a.key){var r=a.lstInternal_Request;if(r&&r.length>0){var o=r[0];if(o&&o.valueMap&&o.valueMap.length>0)for(var s=0;s<o.valueMap.length;s++){var l=o.valueMap[s];if(l&&l.value&&"object_name"===l.key&&l.value===t){for(var c=l.valueMap[0].valueMap,u=0;u<c.length;u++){var d=c[u];if("UPDATE"==d.key){var _=d.value,h=I.toObject(_);if(h.Id==e.Id){for(var f in h)e[f]&&h[f]!=e[f]&&(h[f]=e[f]);d.value=I.toJSON(h);break}}}break}}}break}}}},{key:"_getRequest",value:function(e,t,n,i){var a=this._getState(i+"."+e);if(a){var r=void 0;return r="PUT_DELETE"===e||"PUT_INSERT"===e?this._mergeRequests(a):a.request,r?("PUT_INSERT"===e&&this._validateInsertSequence(a),this._filterTimeStamp(r.data,t),r.data.value=n,this.__syncEvents[e]=a.syncEvent,{key:e,lstInternal_Request:[r.data]}):void 0}}},{key:"_mergeRequests",value:function(e){if(e.requestCollection.length){this._removeDuplicateRequests(e);for(var t=I.cloneObject(e.requestCollection[0]),n=1,i=e.requestCollection.length;n<i;n++)for(var a=e.requestCollection[n].data.valueMap,r=0,o=a.length;r<o;r++)t.data.valueMap.push(a[r]);return t}}},{key:"_removeDuplicateRequests",value:function(e){for(var t={},n=0,i=e.requestCollection.length;n<i;n++){var a=e.requestCollection[n].data.valueMap[0];a&&(a.value in t||(t[a.value]=e.requestCollection[n]))}e.requestCollection=[];for(var r in t)e.requestCollection.push(t[r])}},{key:"_validateInsertSequence",value:function(e){for(var t={},n=0,i=e.requestCollection.length;n<i;n++){var a=e.requestCollection[n].data.valueMap[0];a.key in t||(t[a.key]=[]),t[a.key].push(e.requestCollection[n])}if(e.requestCollection=[],"Parent_Object"in t)for(var r=t.Parent_Object,n=0,i=r.length;n<i;n++)e.requestCollection.push(r[n]);if("Child_Object"in t)for(var r=t.Child_Object,n=0,i=r.length;n<i;n++)e.requestCollection.push(r[n])}},{key:"_filterTimeStamp",value:function(e,t){var n=e.valueMap.filter(function(e){return"SYNC_TIME_STAMP"===e.key});n.length>0?n[0].value=t:e.valueMap.splice(0,0,{key:"SYNC_TIME_STAMP",value:t})}},{key:"_parseResponse",value:function(e){if(!(e&&e.valueMap&&e.valueMap.length))return{};for(var t={},n=0;n<e.valueMap.length;n++){var i=e.valueMap[n];if(i){var a=i.key;"CALL_BACK"===a?t[a]=i:(i.lstInternal_Response&&(i=i.lstInternal_Response[0]),t[a]=i)}}return t}},{key:"_triggerNextEventResponders",value:function(e){if(!this.__eventConfig||!this.__eventConfig.length)return e&&e.call(this);this.__eventGroup=this.__eventConfig.shift(),this.__eventGroup||this._triggerNextEventResponders(e),this._triggerEventResponders(e)}},{key:"_triggerEventResponders",value:function(e){var t=!1,n=0,i=this;for(var a in this.__eventGroup){var r=this.__response[a];if(r){n++;var o=this.__syncEvents[a];o?(o._cleanUp(),this.__parent.__onEventStarted(o)):o=I.create(R.name+"."+this.__eventGroup[a],{onStarted:this.__parent.__onEventStarted,onRequestCompleted:this.__parent.__onEventRequestCompleted,onConnectionWarning:this.__parent.__onEventConnectionWarning,onConnectionLoss:this.__parent.__onConnectionLoss},this.__eventGroup[a],this.__parent),o.__onCompleted=I.proxy(o,function(){this.__logger.info("Event completion: "+this.getName()),i.__parent.__onEventCompleted(this),--n||i._triggerNextEventResponders(e)}),"GET_DELETE"!==a&&"GET_UPDATE"!==a&&"GET_UPDATE_DC_OPTIMZED"!==a||(r=this._serviceDataToObject(r),"GET_UPDATE_DC_OPTIMZED"===a&&(o.__processedIds=[],r.DOWNLOAD_CRITERIA_OBJECTS&&(this.__downloadCriteriaObjects=r.DOWNLOAD_CRITERIA_OBJECTS),r=o._objectsToObjectReqs(r,this.__downloadCriteriaObjects))),o.responseHandler&&(t=!0,o.responseHandler(r),o.complete())}}t||this._triggerNextEventResponders(e)}},{key:"_triggerCallBack",value:function(e){for(var t=0,n=0,i=e.valueMap.length;n<i;n++){var a=this.__response[e.valueMap[n].value];if(a){var r=a.valueMap.filter(function(e){return"LAST_INDEX"===e.key});if(r.length>0){t=r[0].value;break}}}var o=I.cloneObject(this._request);o.data.valueMap.push(e),o.data.valueMap.push({key:"LAST_INDEX",value:t}),this._initHTTPServiceRequest(o,{handler:this.responseHandler,context:this})}},{key:"_syncPutInsert",value:function(e,t,n,i){var a={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"PUT_INSERT",value:this._getClientId(),valueMap:[]}},r=[],o={},s={},l=[];for(var c in t.master){var u=c.substring(0,3);if(e.describe[u]){var _=t.master[c];if(!_||_&&(0,d.default)(_).length<=0)this.__logger.error("record doesn't exist for put insert id '"+c+"'");else{var h=e.describe[u].name;h in o||(o[h]={key:"Parent_Object",value:h,valueMap:[{key:"Fields",valueMap:[]}]}),o[h].valueMap[0].valueMap.push({key:c,value:I.toJSON(t.master[c])}),-1===r.indexOf(h)&&r.push(h),l.push(c),R.Utils.SyncData.addSyncPutInsertRecordId(c)}}else this.__logger.error("Describe info not found for key prefix '"+u+"'")}for(var h in o)a.data.valueMap.push(o[h]);for(var c in t.detail)if(c.match(/_local_/)||c.match(/^local_/)){var u=c.substring(0,3),h=e.describe[u].name;if(e.describe[u]){var f=t.detail[c];!f||f&&(0,d.default)(f).length<=0?this.__logger.error("record doesn't exist for put insert id '"+c+"'"):(s[h]||(s[h]={key:"Child_Object",value:h,valueMap:[{key:"Fields",valueMap:[]}]}),s[h].valueMap[0].valueMap.push({key:c,value:I.toJSON(t.detail[c])}),-1===r.indexOf(h)&&r.push(h),l.push(c),R.Utils.SyncData.addSyncPutInsertRecordId(c))}else this.__logger.error("Describe info not found for key prefix '"+u+"'")}for(var h in s)a.data.valueMap.push(s[h]);return this.__insertObjects?this.__insertObjects=this.__insertObjects.concat(r):this.__insertObjects=r,this.setStateForSyncRequest("PUT_INSERT",a,this,n),i&&i.call(this)}},{key:"_syncPutUpdate",value:function(e,t,n,i,a){var r={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"PUT_UPDATE",value:this._getClientId(),valueMap:[]}};if("ONE_CALL_SYNC"===a){var o={key:"SYNC_TIME_STAMP",value:n},s={key:"PUT_INSERT_TIME",value:this._getState("PUT_INSERT_TIME")};r.data.valueMap.push(o),r.data.valueMap.push(s)}this.__syncConflicts=t;var l=!1,c=this.__updateObjects={};for(var u in e.byObject){var d=e.describe[u].name,_=[],h=[];for(var f in e.byObject[u])if(!t[f]){var p=0;for(var m in e.byObject[u][f])p++;p>0&&(_.push({key:"UPDATE",value:I.toJSON(e.byObject[u][f])}),i&&h.push(I.toJSON(e.oldRecords[f])))}h.length>0&&_.push({key:"BEFORE_SAVE",values:h}),_.length>0&&(r.data.valueMap.push({key:"object_name",value:d,valueMap:[{key:"Fields",valueMap:_}]}),c[d]=!0,l=!0)}l&&this._setState(a+".PUT_UPDATE",{request:r,syncEvent:this})}},{key:"_syncResolveConflicts",value:function(e,t,n,i){function a(a){var r=null,o=null;for(var s in a.byObject){var l=a.describe[s].name;for(var c in a.byObject[s])"CLIENT_OVERRIDE"===e[c].override_flag&&(r=r||{},r[l]=r[l]||{},r[l][c]=a.byObject[s][c]),"SERVER_OVERRIDE"===e[c].override_flag&&(o=o||{},o[l]=o[l]||{},o[l][c]=a.byObject[s][c])}null!==r&&this._syncResolveClientOverrides(r,t,a,n,i),null!==o&&this._syncResolveServerOverrides(o,i,t)}var r=[];for(var o in e)r.push(o);0!==r.length&&("ONE_CALL_SYNC"===i?this._getSyncRecords("update",a,r):this._getTargetedSyncHeaderId(function(e){this._getTargetedSyncRecords("update",e,null,a,r)}))}},{key:"_syncResolveClientOverrides",value:function(e,t,n,i,a){var r={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"PUT_UPDATE",value:this._getClientId(),valueMap:[]}};if("ONE_CALL_SYNC"===a){var o={key:"SYNC_TIME_STAMP",value:t};r.data.valueMap.push(o)}this.__clientOverrides=e;for(var s in e){var l=[],c=[];for(var u in e[s])l.push({key:"CLIENT_OVERRIDE",value:I.toJSON(e[s][u])}),i&&c.push(I.toJSON(n.oldRecords[u])),"TARGETED_SYNC"===a&&this._deleteSyncConflict(u);c.length>0&&l.push({key:"BEFORE_SAVE",values:c}),r.data.valueMap.push({key:"object_name",value:s,valueMap:[{key:"Fields",valueMap:l}]})}this._setState(a+".CLIENT_OVERRIDES",{request:r,syncEvent:this})}},{key:"_syncResolveServerOverrides",value:function(e,t){var n=[];for(var i in e){var a=[];for(var r in e[i])a.push(r),this._deleteSyncConflict(r);"TARGETED_SYNC"===t?n.push({key:i,values:a}):n.push({value:i,values:a})}"TARGETED_SYNC"===t?this._setState("TARGETED_SYNC.SERVER_OVERRIDES",n):this._commonSyncObjectRecords(n,"update.incremental",function(e){for(var t=0;t<e.length;t++)this._deleteSyncConflict(e[t]),this._deleteSyncRecord(e[t]);this._deleteWebserviceActionsLog(e)})}},{key:"_syncPutDelete",value:function(e,t,n,i,a){this._saveCurrentSynclogRecords(n.ids);var r=[];for(var o in t)r.push({value:o});var s={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"PUT_DELETE",value:this._getClientId(),valueMap:[{key:"Object_Name",value:e,valueMap:[{key:"Fields",valueMap:r}]}]}};return this.__objectNames=this.__objectNames||{},this.__objectNames[e]||(this.__objectNames[e]=!0),this.setStateForSyncRequest("PUT_DELETE",s,this,i),a&&a.call(this)}},{key:"_syncResolveConflictsForDelete",value:function(e,t){var n=[];for(var i in e)n.push({Id:i});if(0===n.length)return void t.call(this);this._getSyncRecordResults(n,"delete",function(n){var i=null;for(var a in n.byObject){n.describe[a].name;for(var r in n.byObject[a])"CLIENT_DELETE"===e[r].override_flag&&(i=i||[],i.push(r))}null!==i?this._syncResolveClientDeleteForDelete(i,t):t.call(this)})}},{key:"_syncResolveClientDeleteForDelete",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];this._deleteRecordById(i),this._deleteSyncConflict(i),this._deleteSyncRecord(i)}this._deleteRecentItems(e),this._deleteWebserviceActionsLog(e),t.call(this)}},{key:"isSyncBreakRequired",value:function(e){this._getWebserviceActions(["AfterInsert","BeforeUpdate"],!0).then(function(t){e(t&&t.length&&t[0]["count(*)"]?!0:!1)})}},{key:"_checkIfAfterUpdateExists",value:function(e,t){this._getWebserviceActions(["AfterInsert","AfterUpdate"],!0).then(function(e){t(e&&e.length&&e[0]["count(*)"]?!0:!1)})}},{key:"__processResult",value:function(e,t,n){var i=this._getState("DATA_PURGE.FETCH_IDS")||{},a=this._getState("MAP_REMOTE_IDS")||{},r=[],o={},s=[];this.__insertObjects||(this.__insertObjects=n);for(var l=[],c=0,u=this.__insertObjects.length;c<u;c++){var _=this.__insertObjects[c];if(_ in e){var h=e[_];"string"==typeof h&&(h=I.toObject(h));var f=(0,d.default)(h);if(f.length){o[_]=f,s=s.concat(f);var p=[];for(var m in h){var v=h[m];p.push(v),l.push(v),a[m]=v,R.Utils.SyncData.addOpenRecordRemoteId(m,v),this.__updateSyncRecords(m,v)}p.length>0&&r.push({value:_,values:p}),_ in i?i[_].concat(p):i[_]=p}}}this._setState("SYNC_TXFETCH_IDS",l),this._setState("DATA_PURGE.FETCH_IDS",i),this._setState("MAP_REMOTE_IDS",a),"TARGETED_SYNC"!==t&&this.__deleteSyncLogRecords((0,d.default)(a)),this._updateUnsyncableRecords(a),this.__updateReferneceRecords(a,o,t,function(){var e=this;this._updateProcessIdsForFiles(a,function(){"TARGETED_SYNC"!==t&&e._refreshRecordsFromServer(r,function(){for(var e=(0,d.default)(a),t=0;t<e.length;t++){var n=e[t];R.Utils.SyncData.removeSyncPutInsertRecordId(n)}})})})}},{key:"__updateSyncRecords",value:function(e,t){if(this.__syncRecords)for(var n in this.__syncRecords.records)for(var i in this.__syncRecords.records[n])this.__syncRecords.records[n][i]===e&&(this.__syncRecords.records[n][i]=t)}},{key:"__isChecklistAttachmentEnabled",value:function(){if(L){return L.getMultiServerVersionRequest().isChecklistAttachementsEnabled()}return!1}},{key:"__isTableInDatabase",value:function(e){var t=!1;return O.isTableInDatabase(e)&&(t=!0),t}},{key:"_updateProcessIdsForFiles",value:function(e,t){if(L.getMultiServerVersionRequest().isSalesForceFilesEnabled()){var n=I.getClient().isLaptop(),i=n?"SFAttachments":"SmartDocHTML",a=n?"process_id":"file_process_id",r="SELECT count(*) as count from "+i+" where "+a+" like '%_local_%'";this._initSQLServiceRequest({query:r},{handler:function(n){if(n&&n.length>0&&n[0].count&&n[0].count>0){var r=[];for(var o in e){var s=e[o],l="UPDATE "+i+" SET "+a+" = replace("+a+", '"+o+"', '"+s+"' ) WHERE "+a+" LIKE '%"+o+"%'";r.push(l)}r.length>0?this._initSQLServiceRequest({queryArray:r},{handler:function(e){t&&t.call(this,null)}}):t&&t.call(this,null)}else t&&t.call(this,null)}})}else t&&t.call(this,null)}},{key:"__updateReferneceRecords",value:function(e,t,n,i){var a=this;this._getTableList(function(r){a._query="UPDATE '{{table}}' SET {{updateField}} = '{{remoteId}}' WHERE {{whereField}} = '{{localId}}'",a._queryArray=[],a._updatableRecords={},"TARGETED_SYNC"!==n&&(a.__updateSyncLogRecords(e,!1),a.__updateSyncLogRecords(e,!0));for(var o in e){var s=e[o];for(var l in r){var c=r[l],u={table:l,updateField:c.updateField,localId:o,whereField:c.whereField||c.updateField,remoteId:s};a._queryArray.push(I.string.substitute(a._query,u))}}a.__getUpdatableRecordsQueryArray(t,e),a._queryArray.length&&a._initSQLServiceRequest({queryArray:a._queryArray},{handler:i})})}},{key:"_getTableList",value:function(e){for(var t=this,n=I.getCustomObjectName("Checklist"),i=I.getCustomObjectName("What_Id"),a=I.OrgNamespace+"__SM_Checklist_Attachment__c",r=I.OrgNamespace+"__SM_Checklist__c",o=["SfmWebServiceActionsLog","SFAttachments","SmartDocHTML","SmartDocSignature",n,a],s=["Id","parent_id","record_id","record_id",i,r],l={RecentItems:{updateField:"RecordId"}},c=[],u=0;u<o.length;u++)!function(e){var n=o[e],i="SELECT count(*) as count from "+n+" where "+s[e]+" like '%_local_%'",a={query:i},r=I.Deferred();(function(t){this._initSQLServiceRequest(a,{handler:function(i){if(i&&i.length>0){i[0].count>0&&(l[n]={updateField:[s[e]]})}t.resolve()}})}).call(t,r),c.push(r)}(u);I.when(c).then(I.proxy(this,function(){return e&&e.call(this,l)}))}},{key:"__updateSyncLogRecords",value:function(e,t){var n=t?"ClientSuccSyncLog":"ClientSyncLog";this._getRecords(n,function(n){if(n.length){for(var i=[],a=[],r=[],o=0,s=n.length;o<s;o++){var l=R.Utils.SyncData.parseSyncRecord(n[o]),c=!1;l.parentId&&l.parentId in e&&(l.parentId=e[l.parentId],c=!0),l.oldValues&&(c=this.__updateValues(l.oldValues,e)),l.newValues&&(c=this.__updateValues(l.newValues,e)),c&&("insert"===l.operation?l.Id.match(/_local_/)||l.Id.match(/^local_/)?i.push(l):a.push(l):"update"===l.operation?a.push(l):"delete"===l.operation&&r.push(l))}(i.length||a.length||r.length)&&(this.__serviceRequestCount++,R.Utils.SyncData.writeSyncRecords({insertRecords:i,updateRecords:a,deleteRecords:r,isSuccessive:t,callback:I.proxy(this,"_complete")}))}})}},{key:"__updateValues",value:function(e,t){var n=!1;for(var i in e){var a=e[i];if(a&&a in t){var r=t[a];if(e[i]=r,n=!0,"Id"!==i){var o={field:i,localId:a};e.Id in this._updatableRecords?this._updatableRecords[e.Id].push(o):this._updatableRecords[e.Id]=o}}}return n}},{key:"__getUpdatableRecordsQueryArray",value:function(e,t){for(var n in e)for(var i=e[n],a=0,r=i.length;a<r;a++){var o=i[a];if(o in t){var s={table:n,updateField:"Id",localId:o,whereField:"Id",remoteId:t[o]};this._queryArray.push(I.string.substitute(this._query,s))}if(o in this._updatableRecords)for(var l=this._updatableRecords[o],c=l.length;0<r;c++){var u=l[0],s={table:n,updateField:u.field,localId:u.localId,whereField:u.field,remoteId:t[u.localId]};this._queryArray.push(I.string.substitute(this._query,s))}}}},{key:"__deleteSyncLogRecords",value:function(e){this._deleteRecord("ClientSyncLog",e),this._deleteRecord("ClientSyncConflict",e)}}]),t}(R.SyncEvent),x.OneCallSync=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.__eventTypes=[{GET_DELETE:"SyncGetDeleteEvents"},{GET_DELETE_DC_OPTIMZED:"SyncGetDeleteDownloadCriteria"},{PUT_DELETE:"SyncPutDelete",PUT_INSERT:"SyncPutInsert"},{PUT_UPDATE:"SyncPutUpdate"},{GET_UPDATE:"SyncGetUpdateEvents",GET_UPDATE_DC_OPTIMZED:"SyncGetUpdateDownloadCriteria"}],e.__downloadCriteriaObjects=null,e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("UPDATE",function(e){this._getSmartSyncTimeStamps(function(t){this.getRequest(e,t,function(e){this._setState("SYNC_TXFETCH_IDS",null),this._request=e,e=I.cloneObject(e),e.data.valueMap.push({key:"LAST_INDEX",value:"0"}),this._initHTTPServiceRequest(e,{handler:this.responseHandler,context:this})})})})}},{key:"getRequest",value:function(e,t,n){var i=this._getClientId(),a=void 0,r=void 0,o=void 0,s=void 0,l="ONE_CALL_SYNC",c={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:l,value:i,values:[],valueMap:[{key:"LAST_SYNC_TIME",value:e},{key:"SYNC_TIME_STAMP",value:e}]}};if(this.__syncEvents={},t&&(0,d.default)(t).length>0){var u=I.toJSON(t),_={};_.key="TS_KEYS",_.value=u,c.data.valueMap.push(_)}if(a=this._getRequest("PUT_DELETE",e,i,l),a&&c.data.valueMap.push(a),r=this._getRequest("PUT_INSERT",e,i,l),r&&c.data.valueMap.push(r),o=this._getRequest("PUT_UPDATE",e,i,l),o&&c.data.valueMap.push(o),s=this._getRequest("CLIENT_OVERRIDES",e,i,l))if(o)for(var h=s.lstInternal_Request[0].valueMap,f=0,p=h.length;f<p;f++){var m=h[f];"SYNC_TIME_STAMP"!==m.key&&"PUT_INSERT_TIME"!==m.key&&o.lstInternal_Request[0].valueMap.push(m)}else this.__syncEvents.PUT_UPDATE=this.__syncEvents.CLIENT_OVERRIDES,s.key="PUT_UPDATE",c.data.valueMap.push(s);r?this.isSyncBreakRequired(I.proxy(this,function(e){e&&(this._syncBreak=!0,r.lstInternal_Request[0].valueMap.push({key:"After_Insert_Web_Service",value:"true"})),n.call(this,c)})):o?this._triggerWebserviceActions(["BeforeUpdate"],function(){n.call(this,c)}):n.call(this,c)}},{key:"responseHandler",value:function(e){function t(){var e=n.__response.LAST_SYNC,t=n.__response.CALL_BACK;if(e?n._updateLastSyncTime(e.value):n._updateLastSyncTime(),t)n._triggerCallBack(t);else{L.getMultiServerVersionRequest().isTargetedSyncEnabled(function(e){!0===e&&n._deleteSmartSyncTimeEntries()}),n._setState("ONE_CALL_SYNC.PUT_INSERT",null),n._setState("ONE_CALL_SYNC.PUT_UPDATE",null),n._setState("ONE_CALL_SYNC.PUT_DELETE",null),n._setState("ONE_CALL_SYNC.CLIENT_OVERRIDES",null),n.getSyncManager().resetLastFailedSyncTypesStatus(),n._triggerWebserviceActions(["AfterUpdate"],function(){setTimeout(function(){n._getState("RECURSIVE_DATA_SYNC")?n.getSyncManager().triggerRecursiveDataSync(function(){n._setState("RECURSIVE_DATA_SYNC",!1),n.complete()}):n.complete()},2e3)})}}var n=this;n.__response=n._parseResponse(e),n.__eventConfig=I.cloneObject(n.__eventTypes),this._triggerNextEventResponders(function(){n._syncBreak&&"PUT_INSERT"in n.__response?n._triggerWebserviceActions(["AfterInsert","BeforeUpdate"],t):t()})}},{key:"_updateLastSyncTime",value:function(e){var t=this.__response.PUT_UPDATE,n=null;if(t&&t.valueMap){var i=t.valueMap.filter(function(e){return"SYNC_TIME_STAMP"===e.key});i.length>0&&(n=i[0].value)}if(t=this.__response.GET_UPDATE,n=null,t&&t.valueMap){var i=t.valueMap.filter(function(e){return"GET_UPDATE_LST"===e.key});i.length>0&&(n=i[0].value)}n&&(e=n),e&&(this._setState("LAST_SYNC_TIME",e),this._setState("LAST_SYNC_TIME_UPDATE",e),this._setState("LAST_SYNC_TIME_INSERT",e),this._setState("LAST_SYNC_TIME_DELETE",e))}}]),t}(x.SyncDataEvent),x.SyncPutDelete=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getSyncConflicts("delete",function(e){this._syncResolveConflictsForDelete(e,function(){this._getSyncRecordsByObjectOrder("delete",this._syncPutDelete)})})}},{key:"responseHandler",value:function(e){if(this.__objectNames){var t=this._serviceDataToObject(e);for(var n in this.__objectNames){var i=t[n];i&&i.Sucess&&(M.isArray(i.Sucess)||(i.Sucess=[i.Sucess]),"Attachment"===n?(this._deleteRecord("SFAttachments",i.Sucess),this._deleteRecord("Attachment",i.Sucess)):(this._deleteRecord(n,i.Sucess),this._deleteRecentItems(i.Sucess)),this._deleteSyncRecord(i.Sucess),this._deleteSyncRecord(i.Sucess,!0),this._deleteSyncConflict(i.Sucess))}t.ERROR&&this._handleServerErrors(t.ERROR,"delete")}}}]),t}(x.SyncDataEvent),x.SyncPutInsert=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getSyncRecords("insert",function(e){var t=this._getState("INSERT_RECORD_IDS");if(t&&t.length){var n=[];t.forEach(function(t){this.__getReferenceIds(e,t,n)}),this._filterSyncRecordsById(e,n)}else this._filterUnsyncableRecords(e)&&this._setState("RECURSIVE_DATA_SYNC",!0);this.__syncRecords=e,function t(){var n=e.byOrder.shift();n?this._syncPutInsert(e,n,"ONE_CALL_SYNC",function(){t.call(this)}):this._getState("RECURSIVE_PUT_INSERT_SYNC")&&(this._setState("RECURSIVE_PUT_INSERT_SYNC",!1),this.trigger())}.call(this)})}},{key:"__getReferenceIds",value:function(e,t,n){var i=e.describe[t.substring(0,3)];if(i&&i.fields){var a=e.records[t];if(!a)return;for(var r=0,o=i.fields.length;r<o;r++){var s=i.fields[r],l=a[s.name];l&&"reference"===s.type&&l&&(l.match(/_local_/)||l.match(/^local_/))&&this.__getReferenceIds(e,l,n)}}n.push(t)}},{key:"responseHandler",value:function(e){var t=this._serviceDataToObject(e);t&&this.__insertObjects&&(t.PUT_INSERT_TIME&&this._setState("PUT_INSERT_TIME",t.PUT_INSERT_TIME),this.__processResult(t,"ONE_CALL_SYNC"),t.ERROR&&this._handleServerErrors(t.ERROR,"insert")&&this._setState("RECURSIVE_PUT_INSERT_SYNC",!1))}}]),t}(x.SyncDataEvent),x.SyncPutUpdate=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("UPDATE",function(e){this._getSyncConflicts("update",function(t){this.getIsFieldMergeEnabled(function(n){this._setState("IsFieldMergeEnabled",n),this.__logger.info("SyncPutUpdate: Is Field Merge Enabled IPAD018_SET016 : "+n);this._getSyncRecords("update",function(i){this._filterUnsyncableRecords(i)&&this._setState("RECURSIVE_DATA_SYNC",!0),this._syncPutUpdate(i,t,e,n,"ONE_CALL_SYNC")}),this._syncResolveConflicts(t,e,n,"ONE_CALL_SYNC")})})})}},{key:"_putUpdateResponseHandler",value:function(e){if(this.__updateObjects){var t=this._serviceDataToObject(e),n=this._getState("DATA_PURGE.FETCH_IDS")||{};for(var i in this.__updateObjects)if(t[i]){var a=n[i]||[];for(var r in t[i]){var o=t[i][r],s=(this._getErrorRecIdFromRes(t),this._getConflictRecIdFromRes(t));s.indexOf(o)<0&&(this._deleteSyncRecord(o),this.__syncConflicts[o]&&this._deleteSyncConflict(o)),a.push(o)}n[i]=a}this._setState("DATA_PURGE.FETCH_IDS",n),this._handlePutUpdateErrors(t)}}},{key:"_getErrorRecIdFromRes",value:function(e){var t=[];if(e.ERROR)for(var n in e.ERROR)for(var i in e.ERROR[n])t.push(e.ERROR[n][i]);return t}},{key:"_getConflictRecIdFromRes",value:function(e){var t=[];if(e.CONFLICT)for(var n in e.CONFLICT)for(var i in e.CONFLICT[n])t.push(e.CONFLICT[n][i]);return t}},{key:"_clientOverrideResponseHandler",value:function(e){if(this.__clientOverrides){var t=this._serviceDataToObject(e),n=(this._getErrorRecIdFromRes(t),this._getConflictRecIdFromRes(t));for(var i in this.__clientOverrides)if(t[i])for(var a in t[i]){var r=t[i][a];n.indexOf(r)<0&&(this._deleteSyncConflict(r),this._deleteSyncRecord(r))}this._handlePutUpdateErrors(t)}}},{key:"_handlePutUpdateErrors",value:function(e){e.CONFLICT&&this._handleServerErrors(e.CONFLICT,"update",!0),e.ERROR&&this._handleServerErrors(e.ERROR,"update")}},{key:"responseHandler",value:function(e){this._clientOverrideResponseHandler(e),this._putUpdateResponseHandler(e)}}]),t}(x.SyncDataEvent),x.SuccessiveUpdates=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.__updateSyncTypeQuery="UPDATE SfmWebServiceActionsLog SET sync_type='' FROM WHERE Id In ({{recIds}})",e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){var e=this;e._getRecords("ClientSuccSyncLog",function(t){function n(){e._deleteRecord("ClientSuccSyncLog",a);var t=[];u.length>0&&t.push(e.__handleDeleteRecords(u)),(0,d.default)(_).length>0&&t.push(e.__updateReferenceRecords(_)),I.when(t).always(function(){e._complete()})}function i(){e.__serviceRequestCount--,n()}if(t.length){for(var a=[],r=[],o={},s={},l=[],c=[],u=[],_=e._getState("MAP_REMOTE_IDS")||{},h=0,f=t.length;h<f;h++){var p=R.Utils.SyncData.parseSyncRecord(t[h]);p.oldValues&&e.__updateValues(p.oldValues,_),p.newValues&&e.__updateValues(p.newValues,_),a.push(p.Id),r.push(p.Id),p.Id in _&&(a.push(_[p.Id]),r.push(_[p.Id])),p.parentId&&(r.push(p.parentId),p.parentId in _&&(p.parentId=_[p.parentId],r.push(p.parentId))),"server"===p.changeType?o[p.Id]=p:s[p.Id]=p}for(var m in s){var v=s[m],g=o[m];v.newValues&&(e._updateRecord(v.objectName,I.cloneObject(v.newValues),v.Id),g&&e.__validateServerChanges(g,v)),"insert"===v.operation?v.Id.match(/_local_/)||v.Id.match(/^local_/)?l.push(v):c.push(v):"update"===v.operation?c.push(v):"delete"===v.operation&&u.push(v)}if(r.length){this._initSQLServiceRequest({query:I.string.substitute("UPDATE SfmWebServiceActionsLog SET sync_type='' WHERE Id In ('{{recIds}}')",{recIds:r.join("','")})})}l.length||c.length||u.length?(e.__serviceRequestCount++,R.Utils.SyncData.writeSyncRecords({insertRecords:l,updateRecords:c,deleteRecords:u,isSuccessive:!1,callback:i})):n()}})}},{key:"__handleDeleteRecords",value:function(e){for(var t=M.Deferred(),n={},i=0,a=e.length;i<a;i++){var r=e[i];r.object_name&&(r.objectName in n?n[r.object_name].push(r.Id):n[r.object_name]=[r.Id])}var o=[];for(var s in n)o.push(this._deleteRecord(s,n[s]));return I.when(o).always(function(){t.resolve()}),t}},{key:"__updateReferenceRecords",value:function(e){var t=M.Deferred(),n=this;return n._setState("MAP_REMOTE_IDS",null),n._getRecords("ClientSuccSyncLog",function(i){n._getSyncRecordResults(i,"update",function(i){n._getRecords("ClientSyncLog",function(a){n._getSyncRecordResults(a,"update",function(a){n._setState("MAP_REMOTE_IDS",e),n.__updateRecords(a,i,e),t.resolve()})})})}),t}},{key:"__updateRecords",value:function(e,t,n){var i={};this.__getReferences(e.records,e.describe,i),this.__getReferences(t.records,t.describe,i),(0,d.default)(i).length&&this._updateUnsyncableRecords(n,i)}},{key:"__getReferences",value:function(e,t,n){for(var i in e){var a=e[i],r=t[i.substring(0,3)];if(a&&t[i.substring(0,3)]&&r.fields)for(var o=0,s=r.fields.length;o<s;o++){var l=r.fields[o],c=a[l.name];if("reference"===l.type&&c&&(c.match(/_local_/)||c.match(/^local_/))){var u=!1;if(c in n){var d=n[c].filter(function(e){return e.recId===a.Id&&e.field===l.name});d.length&&(u=!0)}else n[c]=[];u||n[c].push({object:r.name,field:l.name,recId:a.Id})}}}}},{key:"__updateValues",value:function(e,t){for(var n in e){var i=e[n];i&&i in t&&(e[n]=t[i])}}},{key:"__validateServerChanges",value:function(e,t){var n={};for(var i in t.oldValues)n[i]={client:{oldValue:t.oldValues[i],newValue:t.newValues[i]}};for(var i in e.oldValues){var a={oldValue:e.oldValues[i],newValue:e.newValues[i]};i in n?n[i].server=a:n[i]={server:a}}t.oldValues={},t.newValues={};for(var i in n){var r=n[i];!r.client||"Id"!==i&&r.server&&r.client.newValue===r.server.newValue||(t.newValues[i]=r.client.newValue,t.oldValues[i]=r.client.oldValue)}}}]),t}(x.SyncDataEvent),x.AfterInsertWebserviceActions=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this.__serviceRequestCount++,this._triggerWebserviceActions(["AfterInsert"],this._complete)}}]),t}(x.SyncDataEvent),x.BeforeUpdateWebserviceActions=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this.__serviceRequestCount++,this._triggerWebserviceActions(["BeforeUpdate"],this._complete)}}]),t}(x.SyncDataEvent),x.AfterUpdateWebserviceActions=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this.__serviceRequestCount++,this._triggerWebserviceActions(["AfterUpdate"],this._complete)}}]),t}(x.SyncDataEvent),x.SyncGetDeleteEvents=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("DELETE",function(e){this._syncGetEvents({eventName:"GET_DELETE",clientId:this._getClientId(),lastSyncTime:e,lastSyncTimeType:"DELETE",handler:this.responseHandler})})}},{key:"responseHandler",value:function(e){var t=this;for(var n in e)if("LAST_SYNC"!==n&&"SVMX_LOG_ID"!==n&&("string"==typeof e[n]&&(e[n]={Fields:e[n]}),e[n]&&e[n].Fields)){for(var i=[],a=I.toObject(e[n].Fields),r=[],o=0;o<a.length;o++)r.push(a[o].Id),i.push(a[o].Id);n===I.getCustomObjectName("SVMX_Event")&&this._commonDeleteDownloadCriteriaServiceMaxEventRecrods(i);var s=this.getWhatIds(r),l=I.OrgNamespace+"__WhatId__c";s.then(function(e){for(var n=[],i=0;i<e.length;i++)e[i].WhatId&&n.push(e[i].WhatId),e[i][l]&&n.push(e[i][l]);var r=t.getSyncManager().getState("WHAT_IDS_TO_DELETE")||[];r=r.concat(n),t.getSyncManager().setState("WHAT_IDS_TO_DELETE",r);for(var i=0;i<a.length;i++)t._deleteRecordById(a[i].Id)}),this._deleteRecentItems(i),this._deleteWebserviceActionsLog(i)}}},{key:"getWhatIds",value:function(e){var t=I.Deferred(),n=[],i=e.join("','");return this._initSQLServiceRequest({query:"select WhatId from Event where Id IN ('"+i+"')"},{handler:function(e){if(e)for(var a=0;a<e.length;a++)n.push(e[a]);var r=I.OrgNamespace+"__SVMX_Event__c",o=I.OrgNamespace+"__WhatId__c";this._initSQLServiceRequest({query:"select "+o+" from "+r+"  where Id IN ('"+i+"')"},{handler:function(e){if(e)for(var i=0;i<e.length;i++)n.push(e[i]);t.resolve(n)}})}}),t}}]),t}(x.SyncGetEvents),x.SyncGetDownloadCriteria=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._syncGetDownloadCriteria({eventName:"SYNC_DOWNLOAD_CRITERIA",handler:function(e){this._commonSyncObjectRecords(e,"insert"),this._commonDownloadCriteriaServiceMaxEventRecords(e,"insert")}})}},{key:"_syncGetDownloadCriteria",value:function(e){this.__processedIds=this.__processedIds||[];var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:e.eventName,value:this._getClientId(),values:e.valuesToSend||[],valueMap:[]}};if(e.lastSyncTime&&t.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime}),void 0!=e.lastIndex&&t.data.valueMap.push({key:"LAST_INDEX",value:e.lastIndex}),this.__partiallyExecutedObject){for(var n=void 0,i=0;i<this.__partiallyExecutedObject.valueMap.length;i++)if("LAST_ID"===this.__partiallyExecutedObject.valueMap[i].key){n=this.__partiallyExecutedObject.valueMap[i].value;break}t.data.valueMap.push({key:this.__partiallyExecutedObject.key,record:this.__partiallyExecutedObject.record,value:this.__partiallyExecutedObject.value,valueMap:[],values:[n]})}this._initHTTPServiceRequest(t,{handler:function(t){e.batch||(e.batch=0),this.__partiallyExecutedObject=null;var n=null,i=null,a=this._parseSyncDownloadCriteriaResponse(t);n=(0,d.default)(a),i=(e.objectHandler||this._objectsToObjectReqs).call(this,a,n),e.handler&&e.handler.call(this,i),this.__partiallyExecutedObject&&this._syncGetDownloadCriteria({eventName:e.eventName,lastSyncTime:e.lastSyncTime,objectNames:n,valuesToSend:t.values,batch:e.batch+1,handler:e.handler})}})}},{key:"_parseSyncDownloadCriteriaResponse",value:function(e){var t=void 0;if(t={},"SYNC_DOWNLOAD_CRITERIA"===e.eventName)for(var n=0;n<e.valueMap.length;n++){var i=e.valueMap[n];"PARTIAL_EXECUTED_OBJECT"===i.key?this.__partiallyExecutedObject=i:t[i.key]={Fields:i.value}}return t}},{key:"_objectsToObjectReqs",value:function(e,t){var n=this._getState("SYNC_TXFETCH_IDS")||[];if(!t)return[];for(var i=[],a=0;a<t.length;a++){var r=t[a].replace(/,.*/,""),o=e[r];if(o){var s=I.toObject(o.Fields),l=[];if(s){for(var c=0;c<s.length;c++)-1===n.indexOf(s[c].Id)&&(l.push(s[c].Id),n.push(s[c].Id)),-1===I.array.indexOf(this.__processedIds,s[c].Id)&&this.__processedIds.push(s[c].Id);i.push({value:r,values:l})}}}return this._setState("SYNC_TXFETCH_IDS",n),i}}]),t}(R.SyncEvent),x.SyncGetDeleteDownloadCriteria=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._doSyncConflictDeletes()}},{key:"responseHandler",value:function(e){for(var t=e.valueMap,n=0;n<t.length;n++)if("Parent_Object"===t[n].key){var i=t[n].value,a=t[n].valueMap,r=void 0;r=[];for(var o=0;o<a.length;o++){var s=a[o];if("Fields"===s.key){for(var l=s.value,c=I.toObject(l),u=0;u<c.length;u++)r[u]=c[u].Id;break}}i===I.getCustomObjectName("SVMX_Event")&&this._commonDeleteDownloadCriteriaServiceMaxEventRecrods(r),r.length&&(this._deleteRecord(i,r),this._deleteSyncConflict(r),this._deleteSyncRecord(r),this._deleteRecentItems(r),this._deleteWebserviceActionsLog(r))}}},{key:"_doSyncConflictDeletes",value:function(){this._getSyncConflicts("insert",function(e){var t=[];for(var n in e)if("CLIENT_DELETE"===e[n].override_flag){var i=e[n].Id;this._deleteRecordById(i),this._deleteSyncConflict(i),this._deleteSyncRecord(i),t.push(i)}this._deleteRecentItems(t),this._deleteWebserviceActionsLog(t)})}}]),t}(R.SyncGetDownloadCriteria),x.SyncGetInsertEvents=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("INSERT",function(e){this._syncGetEvents({eventName:"GET_INSERT",clientId:this._getClientId(),lastSyncTime:e,lastSyncTimeType:"INSERT",handler:function(e){var t=this._resultToObjectReqs(e);this._commonSyncObjectRecords(t,"insert.incremental")}})})}}]),t}(x.SyncGetEvents),x.SyncGetInsertDownloadCriteria=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("INSERT",function(e){this._syncGetDownloadCriteria({eventName:"GET_INSERT_DOWNLOAD_CRITERIA",lastSyncTime:e,handler:function(e){this._commonSyncObjectRecords(e,"insert.incremental")}})})}}]),t}(R.SyncGetDownloadCriteria),x.SyncGetUpdateEvents=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("UPDATE",function(e){this._syncGetEvents({eventName:"GET_UPDATE",clientId:this._getClientId(),lastSyncTime:e,lastSyncTimeType:"UPDATE",handler:this.responseHandler})})}},{key:"responseHandler",value:function(e,t){var n=this;e=this.__parseResult(e);var i=this._resultToObjectReqs(e);this._getDownloadCriteriaEventsFromClientCache(!1,function(t){n.__purgeExtraEvents(e,t),n._filterGetUpdateObjectReqs(i,function(e){n._commonSyncObjectRecords(e,"update.incremental")})})}},{key:"__parseResult",value:function(e){var t=I.OrgNamespace+"__SVMX_Event__c";if(e&&t in e){var n=e[t];if(n&&n.length){var i={};n.forEach(function(e){"object"===(void 0===e?"undefined":(0,c.default)(e))?e.REC_IDS&&(i.REC_IDS=e.REC_IDS):"string"==typeof e&&(i.Fields=e)}),e[t]=i}}return e}},{key:"__purgeExtraEvents",value:function(e,t,n){function i(e,t,n){for(var i=[],a=0;a<t.length;a++){var r,o=t[a].Id,s=I.OrgNamespace+"__WhatId__c";t[a].WhatId&&(r=t[a].WhatId),t[a][s]&&(r=t[a][s]);var l=!1;if(!o.match(/_local_/)&&!o.match(/^local_/)){for(var c=0;c<n.length;c++)o===n[c].Id&&(l=!0);l||(r&&i.push(r),this._deleteRecord(e,o))}}var u=this.getSyncManager().getState("WHAT_IDS_TO_DELETE")||[];u=u.concat(i),this.getSyncManager().setState("WHAT_IDS_TO_DELETE",u)}if(e){e.Event&&e.Event.REC_IDS&&this._getRecords("Event",function(t){var n=I.toObject(e.Event.REC_IDS);i.call(this,"Event",t,n)});var a=I.OrgNamespace+"__SVMX_Event__c";e[a]&&e[a].REC_IDS&&this._getRecords(a,function(n){var r=I.toObject(e[a].REC_IDS);r=this._getUniqueDCEvents(r,t),i.call(this,a,n,r)})}}}]),t}(x.SyncGetEvents),x.DeleteEventRelatedObjects=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.requestObject={},e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){var e=this;this.__filterWhatIds().then(I.proxy(this,function(t){var n=this;this.getChildLineIds(t).then(function(i){n.getChecklistIds(t).then(function(n){i&&(t=t.concat(i)),n&&(t=t.concat(n));var a=[];M.each(t,function(e,t){-1===M.inArray(t,a)&&a.push(t)}),e.getObjectPrefixes(a).then(function(t){e.createRequestStructure(t)})})})}))}},{key:"__filterWhatIds",value:function(){var e=I.Deferred(),t=this._getState("WHAT_IDS_TO_DELETE");return t.length?this._initSQLServiceRequest({query:"SELECT WhatId AS whatIds FROM Event UNION SELECT "+I.getCustomObjectName("WhatId")+" FROM "+I.getCustomObjectName("SVMX_Event")},{handler:function(n){if(n){var i=n.map(function(e){return e.whatIds}),a=t.filter(function(e){return i.indexOf(e)<0});e.resolve(a)}}}):e.resolve([]),e}},{key:"createRequestStructure",value:function(e){var t=this,n=[];for(var i in e){var a={};a.key="Object_Name",a.value=i,a.values=e[i],n.push(a)}t.getDeletableFromServer(n)}},{key:"getDeletableFromServer",value:function(e){var t=this.getEventRequest(e);this._initHttpRequestEvent(t)}},{key:"getEventRequest",value:function(e){var t={methodName:"DataSyncRequest",data:{eventType:"PURGING",eventName:"PURGE_RECORDS",value:this._getClientId(),valueMap:e}};return this._addClientInfo(t),t}},{key:"_initHttpRequestEvent",value:function(e){var t=this;this._initHTTPServiceRequest(e,{handler:I.proxy(this,function(e){for(var n=null,i=[],a=JSON.parse((0,s.default)(t.requestObject)),r=0;r<e.valueMap.length;r++)"PARTIAL_EXECUTED_OBJECT"===e.valueMap[r].key&&(n=e.valueMap[r].value);for(var r=0;r<e.valueMap.length;r++){var o=[];"PARTIAL_EXECUTED_OBJECT"!==e.valueMap[r].key&&(o=e.valueMap[r].values);var l=e.valueMap[r].value;l in a&&(l!==n?delete a[l]:l==n&&"PARTIAL_EXECUTED_OBJECT"!==e.valueMap[r].key&&(i=o));for(var c=0;c<o.length;c++)this._deleteRecordById(o[c])}if(n){var u=a[n],d=i;if(d.length>0){var _=u.filter(function(e){return-1==d.indexOf(e)});a[n]=_}else delete a[n];t.requestObject=a,t.createRequestStructure(a)}})})}},{key:"getChildLineIds",value:function(e){var t=I.Deferred(),n=I.OrgNamespace+"__Service_Order_Line__c",i=I.OrgNamespace+"__Service_Order__c",a=e.join("','");return this._initSQLServiceRequest({query:"select Id from "+n+" where "+i+" IN ('"+a+"')"},{handler:function(e){if(e){for(var n=[],i=0;i<e.length;i++)n.push(e[i].Id);t.resolve(n)}else t.resolve()}}),t}},{key:"getChecklistIds",value:function(e){var t=I.Deferred();0===e.length&&t.resolve();var n=I.OrgNamespace+"__Checklist__c",i=I.OrgNamespace+"__Work_Order__c",a=e.join("','");return this._initSQLServiceRequest({query:"select Id from "+n+" where "+i+" IN ('"+a+"')"},{handler:function(e){if(e){for(var n=[],i=0;i<e.length;i++)n.push(e[i].Id);t.resolve(n)}else t.resolve()}}),t}},{key:"getObjectPrefixes",value:function(e){for(var t=I.Deferred(),n=this,i={},a=e.length,r=0;r<e.length;r++){var o=e[r].substring(0,3);!function(){var s=e[r];n._describeObjectByKeyPrefix(o,function(e,r){if(r){var o=r.name;i[o]?i[o].push(s):(i[o]=[],i[o].push(s))}else this.__logger.debug("Unable to describe Object by key: "+e);0==--a&&(n.requestObject=i,t.resolve(i))})}()}return t}}]),t}(R.SyncEvent),x.SyncGetUpdateDownloadCriteria=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("UPDATE",function(e){this._syncGetDownloadCriteria({eventName:"GET_UPDATE_DOWNLOAD_CRITERIA",lastSyncTime:e,handler:this.responseHandler})})}},{key:"responseHandler",value:function(e){this._commonDownloadCriteriaServiceMaxEventRecords(e,"update.incremental"),this._filterGetUpdateObjectReqs(e,function(e){this._commonSyncObjectRecords(e,"update.incremental")})}}]),t}(R.SyncGetDownloadCriteria),x.SyncGetAdvDownloadCriteria=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._syncGetAdvDownloadCriteria({insertHandler:function(e){this._commonSyncObjectRecords(e,"insert"),this._commonDownloadCriteriaServiceMaxEventRecords(e,"insert")},deleteHandler:function(e){for(var t=0;t<e.length;t++)this._deleteRecordById(e[t])}})}},{key:"_syncGetAdvDownloadCriteria",value:function(e){this.__processedIds=this.__processedIds||[];var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"ADV_DOWNLOAD_CRITERIA",value:this._getClientId(),valueMap:[]}};e.lastSyncTime&&t.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime}),void 0!=e.excludeIds&&t.data.valueMap.push({key:"PARTIAL_EXECUTED_OBJECT",values:e.excludeIds,value:e.partialObject||null}),t.data.valueMap.push({key:"ADC_OPTIMIZED",value:"TRUE"}),e.callbackValues&&(t.data.values=e.callbackValues),this._initHTTPServiceRequest(t,{handler:function(t){e.batch||(e.batch=0);var n=t.values,i=this._serviceDataToObject(t);if(this._handleInserts(i,e),this._handleDeletes(i,e),i.CALL_BACK&&"true"===i.CALL_BACK.toLowerCase()){i.LAST_INDEX;this._syncGetAdvDownloadCriteria({lastSyncTime:e.lastSyncTime,excludeIds:this.__processedIds,partialObject:i.PARTIAL_EXECUTED_OBJECT,batch:e.batch+1,insertHandler:e.insertHandler,updateHandler:e.updateHandler,deleteHandler:e.deleteHandler,callbackValues:n})}}})}},{key:"_handleInserts",value:function(e,t){var n=this._getState("SYNC_TXFETCH_IDS")||[],i=[];for(var a in e)if("CALL_BACK"!==a&&"DELETE"!==a&&"PARTIAL_EXECUTED_OBJECT"!==a){var r=a,o=[];for(var s in e[a])if(e[a].hasOwnProperty(s)){var l=I.toObject(e[a][s]);-1===n.indexOf(l)&&(o.push(l),n.push(l)),this.__processedIds.push(l)}o.length>0&&i.push({value:r,values:o})}t.lastSyncTime?t.updateHandler.call(this,i):t.insertHandler.call(this,i),this._setState("SYNC_TXFETCH_IDS",n)}},{key:"_handleInsertsIncremental",value:function(e,t){for(var n=[],i=[],a=0,r={},o={},s={},l=0;l<e.length;l++){a++;var c=e[l].value,u=e[l].values;o[c]=[],s[c]=[],r[c]=0;for(var d=0;d<u.length;d++){r[c]++;var _=u[d];this._getRecordForAdvCriteriaCheck(c,_,function(e,l,c){c&&c[0]?s[e].push(l):o[e].push(l),0===--r[e]&&(s[e].length>0&&i.push({value:e,values:s[e]}),o[e].length>0&&n.push({value:e,values:o[e]}),0===--a&&(t.insertHandler.call(this,n),t.updateHandler.call(this,i)))})}}}},{key:"_getRecordForAdvCriteriaCheck",value:function(e,t,n){this._getRecord(e,t,function(i){n.call(this,e,t,i)})}},{key:"_handleDeletes",value:function(e,t){for(var n in e.DELETE)if(e.DELETE.hasOwnProperty(n)){var i=e.DELETE[n];n===I.getCustomObjectName("SVMX_Event")&&this._commonDeleteDownloadCriteriaServiceMaxEventRecrods(i),i.length>0&&(t.deleteHandler.call(this,i),this.__processedIds.push.apply(this.__processedIds,i))}}}]),t}(R.SyncEvent),x.SyncGetDownloadSalesforceFiles=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){var e=this;L.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&e._syncGetDownloadEventFiles({insertHandler:function(t,n,i){e._commonSyncObjectRecords(t,"insert",function(){e._triggerCallBack(n,i)})}})}},{key:"_triggerCallBack",value:function(e,t){if(e.CALL_BACK&&e.CALL_BACK.value&&"true"===e.CALL_BACK.value.toLowerCase()){var n=e.CALL_BACK;this._syncGetDownloadEventFiles({lastSyncTime:t.lastSyncTime,insertHandler:t.insertHandler,updateHandler:t.updateHandler,deleteHandler:t.deleteHandler,callbackValues:n})}else this._complete()}},{key:"_syncGetDownloadEventFiles",value:function(e){var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"DOWNLOAD_EVENT_FILES",value:this._getClientId(),valueMap:[]}};e.lastSyncTime&&t.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime}),e.callbackValues&&t.data.valueMap.push(e.callbackValues),this._initHTTPServiceRequest(t,{handler:function(t){var n=this._parseEventSFilesResponse(t);this._handleInserts(n,e)}})}},{key:"_parseEventSFilesResponse",value:function(e){var t={};if(e&&e.valueMap&&e.valueMap.length>0)for(var n=e.valueMap.length,i=0;i<n;i++){var a=e.valueMap[i].key;if(a&&"CALL_BACK"===a)t[a]=e.valueMap[i];else if(a&&"SAFE_TO_DELETE"===a&&e.valueMap[i].valueMap&&e.valueMap[i].valueMap.length>0){for(var r=e.valueMap[i].valueMap,o=r.length,s={},l=0;l<o;l++){var c=r[l].key;c&&r[l].values&&(s[c]=r[l].values)}t[a]=s}else a&&e.valueMap[i].values&&(t[a]=e.valueMap[i].values)}return t}},{key:"_handleInserts",value:function(e,t){var n=this._getState("SYNC_TXFETCH_IDS")||[],i=[];for(var a in e)if("CALL_BACK"!==a&&"SAFE_TO_DELETE"!==a){var r=a,o=[];for(var s in e[a])if(e[a].hasOwnProperty(s)){var l=I.toObject(e[a][s]);-1===n.indexOf(l)&&(o.push(l),n.push(l))}o.length>0&&i.push({value:r,values:o})}t.lastSyncTime?t.updateHandler.call(this,i,e,t):t.insertHandler.call(this,i,e,t),this._setState("SYNC_TXFETCH_IDS",n)}},{key:"_handleDeletes",value:function(e,t){for(var n in e.SAFE_TO_DELETE){var i=e.SAFE_TO_DELETE[n];n&&i&&i.length>0&&t.deleteHandler.call(this,i,n)}}}]),t}(R.SyncEvent),x.SyncGetPriceData=function(e){function t(){(0,p.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this.getSyncManager().isGetPriceEnabled()&&(this._syncGetPriceCalcData({lastIndex:0}),this._syncGetPriceCalcData({lastIndex:1}),this._getWorkDetailActivityTypeValues(function(e){this._syncGetPriceCalcData({lastIndex:2,activityTypes:e})}))}},{key:"_syncGetPriceCalcData",value:function(e){e=e||{};var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"PRICE_CALC_DATA",valueMap:[]}};t.data.valueMap.push({key:"SVMX_TIME_LOG",valueMap:[{key:"SVMX_LOG_CONTEXT",value:"GET_PRICE"}]}),e.lastSyncTime&&(this.__lastSyncTime=e.lastSyncTime,t.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime})),void 0!=e.lastIndex&&(t.data.valueMap.push({key:"LAST_INDEX",value:e.lastIndex}),2==e.lastIndex&&(e.activityTypes&&t.data.valueMap.push({key:"LABOR",values:e.activityTypes}),e.pricebooks&&t.data.valueMap.push({key:"PRICEBOOK_IDs",values:e.pricebooks}),e.currencyCode&&t.data.valueMap.push({key:"CurrencyISO",values:e.currencyCode}),e.servicePricebooks&&t.data.valueMap.push({key:"SERVICE_PRICEBOOK_IDs",values:e.servicePricebooks}))),e.partialExecutedObject&&e.excludeIds&&t.data.valueMap.push({key:"PARTIAL_EXECUTED_OBJECT",values:e.excludeIds,value:e.partialExecutedObject}),e.callbackValues&&(t.data.values=e.callbackValues),this._initHTTPServiceRequest(t,{handler:function(t){var n=this._serviceDataToObject(t),i=t&&t.valueMap[0].values,a=[],r=[];for(var o in n)if("object"===(0,c.default)(n[o])){for(var s in n[o])if("CALL_BACK"!=s&&"LAST_INDEX"!=s&&"PARTIAL_EXECUTED_OBJECT"!=s){var l=[];if("string"==typeof n[o][s])l=I.toObject(n[o][s]);else for(var u in n[o][s])if("string"==typeof n[o][s][u]){var d=I.toObject(n[o][s][u]);l.push(d.Id)}else for(var _ in n[o][s][u]){var d=I.toObject(n[o][s][u][_]);l.push(d.Id)}if(l&&l.length&&(a.push({value:s,values:l}),"true"===n[o].CALL_BACK)){if("0"===n[o].LAST_INDEX&&s.indexOf("__Service_Order__c")>0)for(var _=0;_<l.length;_++)-1===r.indexOf(l[_])&&r.push(l[_]);if(n[o].PARTIAL_EXECUTED_OBJECT)for(var _=0;_<l.length;_++)-1===r.indexOf(l[_])&&r.push(l[_])}}if("true"===n[o].CALL_BACK&&("0"===n[o].LAST_INDEX&&this._syncGetPriceCalcData({lastIndex:e.lastIndex,callbackValues:r,lastSyncTime:this.__lastSyncTime}),n[o].PARTIAL_EXECUTED_OBJECT)){r.sort();var h=r.pop();this._syncGetPriceCalcData({lastIndex:e.lastIndex,excludeIds:[h],partialExecutedObject:n[o].PARTIAL_EXECUTED_OBJECT,callbackValues:i,lastSyncTime:this.__lastSyncTime,activityTypes:e.activityTypes,currencyCode:e.currencyCode,pricebooks:e.pricebooks,servicePricebooks:e.servicePricebooks})}}var f=e.lastSyncTime?"update.incremental":"insert";this._commonSyncObjectRecords(a,f)}})}},{key:"_getWorkDetailActivityTypeValues",value:function(e){var t=this._objectDescribeTable||"TEMP__SFObjectDescribe",n={query:I.string.substitute("SELECT object_describe FROM "+t+" WHERE object_name='{{ns}}__Service_Order_Line__c'",{ns:I.OrgNamespace})};this._initSQLServiceRequest(n,{handler:function(t){var n=[];if(t&&t[0])for(var i=I.toObject(t[0].object_describe),a=0;a<i.fields.length;a++){var r=i.fields[a];if(r.name===I.OrgNamespace+"__Activity_Type__c")for(var o=0;o<r.picklistValues.length;o++)n.push(r.picklistValues[o].value)}e.call(this,n)}})}},{key:"_getPricebooksWithCurrencyCodes",value:function(e){var t={query:"SELECT * FROM Pricebook2"};this._initSQLServiceRequest(t,{handler:function(t){var n=[];if(t)for(var i=0;i<t.length;i++)n[i]=t[i].Id;e.call(this,n)}})}},{key:"_getServicePricebooks",value:function(e){var t={query:"SELECT * FROM "+I.getCustomObjectName("Service_Pricebook")};this._initSQLServiceRequest(t,{handler:function(t){var n=void 0;if(n=[],t)for(var i=0;i<t.length;i++)n[i]=t[i].Id;e.call(this,n)}})}}]),t}(R.SyncEvent),x.SyncGetPriceDataIncremental=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this.getSyncManager().isGetPriceEnabled()&&(this._objectDescribeTable="SFObjectDescribe",this._getLastSyncTime("DELETE",function(e){this._syncGetPriceCalcData({lastSyncTime:e,lastIndex:0}),this._syncGetPriceCalcData({lastSyncTime:e,lastIndex:1}),this._getWorkDetailActivityTypeValues(function(t){this._getPricebooksWithCurrencyCodes(function(n){this._getServicePricebooks(function(i){this.__getCurrencyCodesFromWorkOrder(function(a){this.__getCurrencyCodesFromProductsServicedLines(function(r){if(a=a||[],r&&r.length>0)for(var o=0;o<r.length;o++){var s=r[o];a.indexOf(s)>-1||a.push(s)}this._syncGetPriceCalcData({lastSyncTime:e,lastIndex:2,activityTypes:t,pricebooks:n,servicePricebooks:i,currencyCode:a})})})})})})}))}},{key:"__getCurrencyCodesFromWorkOrder",value:function(e){var t={query:"SELECT DISTINCT CurrencyIsoCode FROM "+I.getCustomObjectName("Service_Order")};this._initSQLServiceRequest(t,{handler:function(t){var n=void 0;if(n=[],t)for(var i=0;i<t.length;i++)n[i]=t[i].CurrencyIsoCode;e.call(this,n)}})}},{key:"__getCurrencyCodesFromProductsServicedLines",value:function(e){var t={query:"SELECT DISTINCT wdl.CurrencyIsoCode, wdl.RecordTypeId FROM "+I.getCustomObjectName("Service_Order_Line")+" as wdl LEFT JOIN RecordType as rt on wdl.RecordTypeId = rt.Id WHERE rt.Name = 'Products Serviced' "};this._initSQLServiceRequest(t,{handler:function(t){var n=[];if(t)for(var i=0;i<t.length;i++)n[i]=t[i].CurrencyIsoCode;e.call(this,n)}})}}]),t}(x.SyncGetPriceData),x.SyncGetPriceDataIncrementalAggressive=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this.getSyncManager().isGetPriceEnabledDuringAggressiveSync()&&(0,r.default)(t.prototype.__proto__||(0,h.default)(t.prototype),"trigger",this).call(this)}}]),t}(x.SyncGetPriceDataIncremental),x.SyncGetAdvDownloadCriteriaIncremental=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){this._getLastSyncTime("UPDATE",function(e){this._syncGetAdvDownloadCriteria({lastSyncTime:e,insertHandler:function(e){var t=this;this.__getConflictRecordIds(t).done(function(t,n){t&&t.length>0&&(e=n.__getNewObjectRequestWithoutConflictRecords(t,e)),n._commonDownloadCriteriaServiceMaxEventRecords(e,"insert.incremental"),n._commonSyncObjectRecords(e,"insert.incremental")})},updateHandler:function(e){var t=this;this.__getConflictRecordIds(t).done(function(t,n){t&&t.length>0&&(e=n.__getNewObjectRequestWithoutConflictRecords(t,e));var i=I.cloneObject(e);n._commonDownloadCriteriaServiceMaxEventRecords(i,"update.incremental"),n._commonSyncObjectRecords(e,"update.incremental",function(){for(var e=0;e<i.length;e++)"Attachment"===i[e].value&&this._updateLocalAttachments(i[e].values)})})},deleteHandler:function(e){var t=e[0].substring(0,3);return this.__tableNamesByKey=this.__tableNamesByKey||{},this.__tableNamesByKey[t]?this._deleteRecord(this.__tableNamesByKey[t],e):"attach"===e[0].substring(0,6)?this._deleteRecord("SFAttachments",e):(this._describeObjectByKeyPrefix(t,function(n,i){if(i){var a=i.name;this.__tableNamesByKey[t]=a,this._deleteRecord(a,e)}else this.__logger.debug("Unable to describe Object by key: "+n)}),void this._removeLocalAttachments(e))}})})}},{key:"_removeLocalAttachments",value:function(e){e.length&&this._describeObjectByName("Attachment",function(t,n){for(var i=0;i<e.length;i++){var a=e[i];a&&n.keyPrefix===a.substring(0,3)&&this._getRecord("SFAttachments",a,function(e){var t=e&&e[0];t&&this._initNativeServiceRequest("File",{operation:"DELETE",file:t.file_path},{handler:function(e){this._deleteRecord("SFAttachments",t.Id)}})})}})}},{key:"__getConflictRecordIds",value:function(e){var t=I.Deferred();return this._initSQLServiceRequest({query:"SELECT Id FROM ClientSyncConflict"},{handler:function(n){n=n||[],t.resolve(n,e)}}),t}},{key:"__getNewObjectRequestWithoutConflictRecords",value:function(e,t){for(var n=t.length,i=0;i<n;i++)for(var a=(t[i].value,t[i].values),r=e.length,o=0;o<r;o++){var s=a.indexOf(e[o].Id);-1!=s&&a.splice(s,1)}return t}}]),t}(x.SyncGetAdvDownloadCriteria),x.SyncGetDownloadSalesforceFilesIncremental=function(e){function t(){return(0,p.default)(this,t),(0,v.default)(this,(t.__proto__||(0,h.default)(t)).apply(this,arguments))}return(0,E.default)(t,e),(0,y.default)(t,[{key:"trigger",value:function(){var e=this;L.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&e._getLastSyncTime("UPDATE",function(t){e._syncGetDownloadEventFiles({lastSyncTime:t,updateHandler:function(t,n,i){var a=I.cloneObject(t);e._commonSyncObjectRecords(t,"update.incremental",function(){var t=a.length,r=[];if(t>0)for(var o=0;o<t;o++)if("ContentDocumentLink"===a[o].value){r=a[o].values;break}e._getCVIdsForCDLIds(r,function(t){e._updateLocalSFiles(t).done(function(){e._handleDeletes(n,i),e._triggerCallBack(n)})})})},deleteHandler:function(t,n){n&&t&&t.length>0&&(e._deleteRecord(n,t),"ContentVersion"===n&&e._deleteLocalSFiles(t))}})})}}]),t}(x.SyncGetDownloadSalesforceFiles),I.defineGlobal(x.name,x),e.exports=x},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),o=i(a),s=n(2),l=i(s),c=n(6),u=i(c),d=n(3),_=i(d),h=n(4),f=i(h),p=n(0).utils,m=n(5).SVMXObject,v={name:"com.servicemax.client.ui.components.modern.data"};v.SVMXStore=Ext.define(v.name+".SVMXStore",{alias:"widget.svmx.store",extend:"Ext.data.Store",constructor:function(){this.callParent(arguments)}}),v.SVMXModel=Ext.define(v.name+".SVMXModel",{alias:"widget.svmx.model",extend:"Ext.data.Model",constructor:function(e){this.raw=Ext.apply({},e),this.callParent(arguments)}}),v.SVMXTreeStore=Ext.define(v.name+".SVMXTreeStore",{alias:"widget.svmx.treestore",extend:"Ext.data.TreeStore",constructor:function(){this.callParent(arguments)}}),v.CacheService=function(e){function t(){(0,l.default)(this,t);var e=(0,_.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments));return e.__logger=p.getLoggingService().getLogger("CACHE-SERVICE"),e.__cacheItems={},e.__cache=null,e}return(0,f.default)(t,e),(0,u.default)(t,[{key:"getItem",value:function(e){try{return p.isCachingEnabled()?this.__getStore().getItem(e):null}catch(t){return this.__logger.error("Could not get <"+e+"> from cache. Error : "+t),null}}},{key:"setItem",value:function(e,t){this.__cacheItems[""+e]=t;try{return p.isCachingEnabled()?(this.clear(e),this.__getStore().setItem(e,t)):null}catch(t){return this.__logger.error("Could not set <"+e+"> into cache. Error : "+t),null}}},{key:"clear",value:function(e){p.isCachingEnabled()&&(e?this.__getStore().removeItem(e):this.__getStore().clear())}},{key:"reset",value:function(e){p.isCachingEnabled()&&this.clear()}},{key:"__getStore",value:function(){return window.localStorage}}]),t}(m),v.SVMXList=Ext.define(v.name+".SVMXList",{alias:"widget.svmx.list",extend:"Ext.List",ui:"svmx-default",itemHeight:50,config:{disableContainerScrollable:!1,indexBar:!1,ui:"normal",flex:1,width:"100%",onItemDisclosure:!1,striped:!1,itemCls:"",useSimpleItems:!0,itemTmpl:"<div>{text}</div>",defaultType:void 0,itemConfig:null,data:null,store:null,scrollToTopOnRefresh:!0,disableSelection:!1,navOnSelect:!0,emptyText:"",sourceConfig:{listItems:[],headerItems:[],updatedItems:[],headerMap:[],recordMap:{},scrollDockItems:{top:[],bottom:[]}}},beforeInitialize:function(){var e=this,t=e.container;e.getBaseCls();Ext.apply(e,e.getSourceConfig()),e.translationMethod="csstransform",t||(t=e.container=e.createContainer()),e.add(t),e.scrollViewElement=t.bodyElement,e.scrollElement=t.innerElement;var n=t.getScrollable();n&&n.on({scroll:"onScroll",refresh:"onScrollerRefresh",scope:e})},createContainer:function(){var e=Ext.merge({scrollable:{autoRefresh:!this.getInfinite()||null}},this.getContainer());return this.getDisableContainerScrollable()&&(e.scrollable=!1),Ext.create(e)},initialize:function(){this.callParent(arguments)},onListStoreClear:function(){var e=this,t=e.container.getScrollable(),n=e.getInfinite();e.pinnedHeader&&e.pinnedHeader.translate(0,-1e4),e.getItemMap().populate(0,0),n?(e.topRenderedIndex=0,e.topVisibleIndex=0,e.updateAllListItems()):e.setItemsCount(0),t&&t.scrollTo(null,0),e.refreshListScroller()},refreshListScroller:function(e){var t=this,n=t.container.getScrollable();t.getInfinite()?t.resizeScroller(e):(t.getGrouped()&&t.getPinHeaders()&&t.updateHeaderMap(),n&&n.refresh())},resizeScroller:function(){var e=this,t=void 0,n=void 0;t=e.getItemMap().getTotalHeight(),r=e.container.getScrollable(),n=r.getSize(),t!=n.y&&r.setSize({x:r.isTouchScroller?n.x:null,y:t}),e||e.onScrollerRefresh(r)},doRefresh:function(){var e=this,t=e.getInfinite(),n=e.getStore().getCount();t&&e.getItemMap().populate(n,this.topRenderedIndex),e.getGrouped()&&e.refreshHeaderIndices(),n?e.repositionScrollerToTop.call(e,n):e.onListStoreClear()},repositionScrollerToTop:function(e){var t=this,n=t.container.getScrollable(),i=t.getInfinite();t.hideScrollDockItems(),t.hideEmptyText(),i?(t.getScrollToTopOnRefresh()&&(t.topRenderedIndex=0,t.topVisibleIndex=0,n&&n.scrollTo(null,0)),t.updateAllListItems()):(t.setItemsCount(e),t.getScrollToTopOnRefresh()&&n&&n.scrollTo(0,0))},doItemSelect:function(){this.callParent(arguments),this.getNavOnSelect()&&p.timer.job(this.getId()+".clearSelection",300,this,function(){this.deselectAll()})}}),v.SVMXComponentList=Ext.define(v.name+".SVMXComponentList",{alias:"widget.svmx.componentlist",extend:v.name+".SVMXList",config:{useComponents:!0,useSimpleItems:!1,defaultType:"svmx.listitem",useHeaders:!1}}),v.SVMXComponentListItem=Ext.define(v.name+".SVMXComponentListItem",{alias:"widget.svmx.list.componentitem",extend:"Ext.dataview.component.DataItem",ui:"svmx-default",config:{}}),p.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(2),r=i(a),o=n(6),s=i(o),l=function(){function e(){(0,r.default)(this,e)}return(0,s.default)(e,null,[{key:"showMenu",value:function(e,t){return console.log("CALLING SVMXPlugin.showMenu"),window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","showMenu",[])}},{key:"hideMenu",value:function(e,t){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","hideMenu",[])}},{key:"signOut",value:function(e,t){return window.cordova.exec(e||function(e){window.location.reload(!0)},t||function(e){},"SVMXGeneralPlugin","signOut",[])}},{key:"getLoginUrl",value:function(e,t){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","getLoginUrl",[])}},{key:"getEnv",value:function(e,t){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","getEnv",[])}},{key:"getAuthorizationState",value:function(e,t,n){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","getAuthorizationState",[n])}},{key:"getGeolocation",value:function(e,t){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","getGeolocation",[])}},{key:"sendSMS",value:function(e,t,n,i){return window.cordova.exec(n||function(e){},i||function(e){},"SVMXGeneralPlugin","sendSMS",[{phone:e||"",message:t||null}])}},{key:"openPhone",value:function(e,t,n){return window.cordova.exec(t||function(e){},n||function(e){},"SVMXGeneralPlugin","openPhone",[{phone:e||""}])}},{key:"openMap",value:function(e,t,n,i,a){return window.cordova.exec(i||function(e){},a||function(e){},"SVMXGeneralPlugin","openMap",[{location:e,latitude:t||"0",longitude:n||"0"}])}},{key:"sendEmail",value:function(e,t,n,i,a,r){return window.cordova.exec(a||function(e){},r||function(e){},"SVMXGeneralPlugin","sendEmail",[{address:e||"",subject:t||"",message:n||"",attachmentFiles:i||[]}])}},{key:"shareFiles",value:function(e,t,n){return window.cordova.exec(t||function(e){},n||function(e){},"SVMXGeneralPlugin","shareFiles",[{files:e||[]}])}},{key:"fileChooser",value:function(e,t,n,i,a){return window.cordova.exec(i||function(e){},a||function(e){},"SVMXGeneralPlugin","fileChooser",[{mimeType:e||"*/*",destPath:t||null,imageCompression:n||void 0}])}},{key:"printHTMLContentRequest",value:function(e,t,n){var i=document.getElementById(n.parameters.parameters.elementId);return cordova.plugins.printer.print(i,"opdoc.html")}},{key:"forceOrientation",value:function(e,t,n){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","forceOrientationForPIQ",[n])}},{key:"newRelicCustomEvtRequest",value:function(e,t,n){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","sendNewRelicCustomEvtReq",[n])}},{key:"executeHttp",value:function(e,t,n){return window.cordova.exec(t||function(e){},n||function(e){},"SVMXGeneralPlugin","executeHttp",[{targetURL:e.targetURL?e.targetURL:"",headers:e.headers&&e.headers instanceof Array?e.headers:[],type:e.type?e.type:"GET",timeout:e.timeout&&!isNaN(e.timeout)?e.timeout:18e4,postData:e.postData?e.postData:""}])}},{key:"executeDownload",value:function(e,t,n){return window.cordova.exec(t||function(e){},n||function(e){},"SVMXGeneralPlugin","executeDownload",[{targetURL:e.targetURL?e.targetURL:"",headers:e.headers&&e.headers instanceof Array?e.headers:[],timeout:e.timeout&&!isNaN(e.timeout)?e.timeout:18e4,fileName:e.fileName?e.fileName:""}])}},{key:"executeUpload",value:function(e,t,n){return window.cordova.exec(t||function(e){},n||function(e){},"SVMXGeneralPlugin","executeUpload",[{targetURL:e.targetURL?e.targetURL:"",headers:e.headers&&e.headers instanceof Array?e.headers:[],timeout:e.timeout&&!isNaN(e.timeout)?e.timeout:18e4,fileName:e.fileName?e.fileName:"",sourcePath:e.sourcePath?e.sourcePath:"",parentId:e.parentId?e.parentId:""}])}},{key:"setOrientation",value:function(e,t,n){function i(e){console.error(e),n&&setTimeout(function(){n(e)},0)}if("string"!=typeof e)return i("Invalid orientation passed to setOrientation (Must be a string)");if("both"!==e.toLowerCase())screen.lockOrientation(e.toLowerCase());else{if("both"!==e.toLowerCase())return i("Unknown orientation passed to setOrientation");screen.unlockOrientation()}t&&setTimeout(function(){t()},0)}},{key:"openLink",value:function(e,t,n){return window.cordova.exec(t||function(e){},n||function(e){},"SVMXGeneralPlugin","openLink",[{link:e||null}])}},{key:"preventAutoLock",value:function(e,t,n){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","preventAutoLock",[n])}},{key:"donotPreventAutoLock",value:function(e,t){return window.cordova.exec(e||function(e){},t||function(e){},"SVMXGeneralPlugin","donotPreventAutoLock",[])}}]),e}();window.SVMXPlugin=l,e.exports=l},function(e,t,n){var i=n(39),a=n(25),r=n(70);e.exports=function(e){return function(t,n,o){var s,l=i(t),c=a(l.length),u=r(o,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(45);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(46),a=n(52);e.exports=function(e){return function(t,n){var r,o,s=String(a(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===c||(o=s.charCodeAt(l+1))<56320||o>57343?e?s.charAt(l):r:e?s.slice(l,l+2):o-56320+(r-55296<<10)+65536)}}},function(e,t,n){var i=n(21),a=n(45),r=n(23)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==a(e))}},function(e,t,n){var i=n(23)("iterator"),a=!1;try{var r=[7][i]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var r=[7],o=r[i]();o.next=function(){return{done:n=!0}},r[i]=function(){return o},e(r)}catch(e){}return n}},function(e,t,n){"use strict";var i=n(83),a=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(e,t)}},function(e,t,n){"use strict";n(213);var i=n(36),a=n(35),r=n(20),o=n(52),s=n(23),l=n(154),c=s("species"),u=!r(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var _=s(e),h=!r(function(){var t={};return t[_]=function(){return 7},7!=""[e](t)}),f=h?!r(function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[_](""),!t}):void 0;if(!h||!f||"replace"===e&&!u||"split"===e&&!d){var p=/./[_],m=n(o,_,""[e],function(e,t,n,i,a){return t.exec===l?h&&!a?{done:!0,value:p.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}}),v=m[0],g=m[1];i(String.prototype,e,v),a(RegExp.prototype,_,2==t?function(e,t){return g.call(e,this,t)}:function(e){return g.call(e,this)})}}},function(e,t,n){var i=n(17),a=i.navigator;e.exports=a&&a.userAgent||""},function(e,t,n){"use strict";var i=n(17),a=n(9),r=n(36),o=n(76),s=n(62),l=n(75),c=n(74),u=n(21),d=n(20),_=n(111),h=n(82),f=n(140);e.exports=function(e,t,n,p,m,v){var g=i[e],y=g,S=m?"set":"add",E=y&&y.prototype,b={},T=function(e){var t=E[e];r(E,e,"delete"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof y&&(v||E.forEach&&!d(function(){(new y).entries().next()}))){var M=new y,I=M[S](v?{}:-0,1)!=M,C=d(function(){M.has(1)}),A=_(function(e){new y(e)}),D=!v&&d(function(){for(var e=new y,t=5;t--;)e[S](t,t);return!e.has(-0)});A||(y=t(function(t,n){c(t,y,e);var i=f(new g,t,y);return void 0!=n&&l(n,m,i[S],i),i}),y.prototype=E,E.constructor=y),(C||D)&&(T("delete"),T("has"),m&&T("get")),(D||I)&&T(S),v&&E.clear&&delete E.clear}else y=p.getConstructor(t,e,m,S),o(y.prototype,n),s.NEED=!0;return h(y,e),b[e]=y,a(a.G+a.W+a.F*(y!=g),b),v||p.setStrong(y,e,m),y}},function(e,t,n){for(var i,a=n(17),r=n(35),o=n(68),s=o("typed_array"),l=o("view"),c=!(!a.ArrayBuffer||!a.DataView),u=c,d=0,_="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(i=a[_[d++]])?(r(i.prototype,s,!0),r(i.prototype,l,!0)):u=!1;e.exports={ABV:c,CONSTR:u,TYPED:s,VIEW:l}},function(e,t,n){"use strict";e.exports=n(61)||!n(20)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n(17)[e]})},function(e,t,n){"use strict";var i=n(9);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var i=n(9),a=n(32),r=n(44),o=n(75);e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,s,l=arguments[1];return a(this),t=void 0!==l,t&&a(l),void 0==e?new this:(n=[],t?(i=0,s=r(l,arguments[2],2),o(e,!1,function(e){n.push(s(e,i++))})):o(e,!1,n.push,n),new this(n))}})}},function(e,t,n){var i=n(163),a=Math.min;e.exports=function(e){return e>0?a(i(e),9007199254740991):0}},function(e,t){e.exports=!0},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){"use strict";var i=n(635)(!0);n(169)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var i=n(66),a=n(637),r=n(166),o=n(164)("IE_PROTO"),s=function(){},l=function(){var e,t=n(233)("iframe"),i=r.length;for(t.style.display="none",n(638).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[r[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[o]=e):n=l(),void 0===t?n:a(n,t)}},function(e,t,n){var i=n(49).f,a=n(78),r=n(42)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(30),r=i(a),o=n(98),s=i(o),l=n(31),c=i(l),u=n(18),d=i(u),_=n(10),h=0,f=0,p={Package:function(e){for(var t=e.split("."),n=window||this,i=0,a=t.length;i<a;i++)n[t[i]]||(n[t[i]]={}),n=n[t[i]];return n.name=e,n.Class=function(e,t,n,i){var a=_.inherit(t,n,i);return a.__className=e,this[e]=a,a.name=this.name+":"+e,f++,a},h++,n}};p.getPackageCount=function(){return h},p.getClassCount=function(){return f},p.destroy=function(e){e&&"object"===(void 0===e?"undefined":(0,d.default)(e))&&(p.forEachProperty(e,function(t){delete e[t]}),e.isDestroyed=!0)},p.delayedDestroy=function(e){window.setTimeout(function(){p.destroy(e)},1e3)},p.cachedScript=function(e,t){return t=_.extend(t||{},{dataType:"script",cache:!0,url:e}),_.ajax(t)},p.stringEndsWith=function(e,t){var n=!1;return e&&e.length>0&&(n=-1!==e.indexOf(t,e.length-t.length)),n},p.string={},p.string.capitalize=function(e){return e[0].toUpperCase()+e.substring(1)},p.string.camelCase=function(e){return e.replace(/_[a-zA-Z]/g,function(e){return e.substring(1).toUpperCase()})},p.string.substitute=function(e,t){return t||(t={}),String(e).replace(/\{\{.*?\}\}/g,function(e){return e=e.substring(2,e.length-2),void 0===t[e]||null===t[e]?"":t[e]})},p.forEachProperty=function(e,t,n){n&&(t=p.proxy(n,t));for(var i in e)e.hasOwnProperty(i)&&t(i,e[i])},p.isPlatform=function(e){var t=!0;try{t=navigator.platform.slice(0,e.length)==e}catch(e){p.getLoggingService().getLogger().error("Cannot detect the platform! "+e)}return t},p.cloneObject=function(e){return p.toObject(p.toJSON(e))},p.deepCloneObject=function(e){return _.extend(!0,{},e)},p.write=function(e){document.write(e)},p.meta=function(e,t){p.write('<meta name="'+e+'" content="'+t+'">')},p.adjustViewportToOrientation=function(e){_("head").append(_('<meta name="viewport" id="'+e+'" content="width=device-height, height=device-width,initial-scale=1.0,maximum-scale=1.0, user-scalable=no">'))},p.fitViewportToOrientation=function(e){_("head").append(_('<meta name="viewport" id="'+e+'" content="width=device-width,initial-scale=1.0,maximum-scale=1.0, user-scalable=no">'))},p.removeMetaTagToAdjustViewPortForOrientation=function(e){_('meta[id="'+e+'"]').remove()};var m=0;p.generateGUID=function(){return++m};var v=[];p.registerCreateHelper=function(e){v.push(e)},p.getCreateHelper=function(e){var t=void 0,n=v.length;for(t=0;t<n;t++){var i=v[t];if(i.canCreate(e))return i}return null},p.getClass=function(e,t){try{for(var n=e.split("."),i=window,a=0,r=n.length;a<r;a++){if(t&&!i)return;i=i[n[a]]}return"function"==typeof i||t||p.getLoggingService().getLogger().error("Cannot find definition for class : "+e),i}catch(n){if(!t)throw p.getLoggingService().getLogger().error("Error while resolving class <"+e+"> :"+n),n}},p.create=function(){var e="";try{if(arguments.length<1)return null;e=arguments[0];var t=p.getCreateHelper(e);if(null!=t)return t.doCreate.apply(t,arguments);var n=void 0,i=arguments.length,a="";for(n=1;n<i;n++)a+="arguments["+n+"],";a.length>0&&(a=a.substring(0,a.length-1));var r=p.getClass(e);return new(Function.prototype.bind.apply(r,arguments))}catch(t){throw p.getLoggingService().getLogger().error("Error while creating class <"+e+" > : "+t),t}},p.typeOf=function(e){return null===e?"":void 0===e?"":"object"===(void 0===e?"undefined":(0,d.default)(e))?e.getClassName?e.getClassName():{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1]:void 0===e?"undefined":(0,d.default)(e)},p.isTypeOf=function(e,t){return p.array.contains(t,function(t){return p.typeOf(e)===t})},p.isObject=function(e){return null!==e&&void 0!==e&&"object"===(void 0===e?"undefined":(0,d.default)(e))},p.proxy=function(){arguments[0];if("string"!=typeof arguments[1]){var e=arguments[0];arguments[0]=arguments[1],arguments[1]=e}return _.proxy.apply(window,arguments)},p.timer={doLater:function(e,t){var n=t?p.proxy(t,e):e;window.setTimeout(n,1)},job:function(e,t,n,i){var a=void 0;a=n&&i?p.proxy(n,i):i||n,p.timer.cancelJob(e);var r=function(){delete p.timer._jobs[e],a()};p.timer._jobs[e]=setTimeout(r,t)},cancelJob:function(e){clearTimeout(p.timer._jobs[e]),delete p.timer._jobs[e]},hasJob:function(e){return Boolean(p,timer._jobs[e])},_jobs:{}},p.doLater=p.timer.doLater,p.ajax=function(e){return _.ajax(e)},p.openInBrowserWindow=function(e){window.open(e,"_blank")},p.openInBrowserWindowLightning=function(e){sforce&&void 0!==sforce.one?sforce.one.navigateToURL(e):window.open(e,"_blank")},p.setWindowTitle=function(e){window.document.title=e||""},p.reloadPage=function(){window.location.reload()},p.navigateTo=function(e){sforce&&void 0!==sforce.one?p.isValidUrl(e)?window.open(e,"_top"):sforce.one.navigateToURL(e):window.location.href=e},p.isValidUrl=function(e){return/^(http[s]?:\/\/)?(www\.)?[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}/.test(e)},p.navigateTopTo=function(e){top.location.href=e},p.getInnerWidth=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},p.onWindowResize=function(e,t){var n=p.getInnerWidth();_(window).resize(function(i){var a={height:window.innerHeight,width:n};p.timer.job("windowResize",50,function(){e.call(t,a)})})},p.getWindowInnerHeight=function(){return window.innerHeight};var g=null;p.isCachingEnabled=function(){if(null===g){var e=p.getClient().getApplicationParameter("enable-cache");void 0!=e&&null!=e&&!0===e?(e=p.getUrlParameter("enable-cache"),e=void 0==e||null==e||"false"!==e):e=!1,g=e}return g};var y=null;p.isLoggingEnabled=function(){if(null===y){var e=p.getClient().getApplicationParameter("enable-log");void 0!=e&&null!=e&&!0===e?(e=p.getUrlParameter("enable-log"),e=void 0==e||null==e||"false"!==e):e=!1,y=e}return y};var S=null;p.getUrlParameter=function(e){if(null==S){S={};for(var t=document.URL,n=t.slice(t.indexOf("?")+1).split("&"),i=0;i<n.length;i++){var a=n[i].split("=");S[a[0]]=a[1]}}var r=S[e];return null!=r&&(r=decodeURIComponent(r),r=r.split("+").join(" ")),r},p.toJSON=function(e){return e?(0,c.default)(e):null},p.stringToXML=function(e){return e?_.parseXML(e):null},p.prettyPrint=function(e,t){function n(e){return new Array(e).join("    ")}t=t||0;var i="";if(_.isArray(e)){i+="[\n";for(var a=0;a<e.length;a++)i+=n(t+1)+a+". "+p.prettyPrint(e[a],t+1),a<e.length-1&&(i+=","),i+="\n";i+=n(t)+"]"}else"object"===(void 0===e?"undefined":(0,d.default)(e))&&null!==e?(i+="{\n",p.forEachProperty(e,function(e,a){i+=n(t+1)+e+": "+p.prettyPrint(a,t+1)+",\n"}),i+=n(t)+"}"):i+=e;return i},p.dump=function(e){console.log(p.prettyPrint(e))},p.toObject=function(e){var t=e;if("string"==typeof e&&e.match(/^\s*\"|\'|\{|\[/))try{t=JSON.parse(e)}catch(e){p.getLoggingService().getLogger().error("SVMX.toObject() failed!")}return t},p.toggleClass=function(e,t){_(e).toggleClass(t)},p.sort=function(e,t){if("string"==typeof t){if(0===e.length)return e;var n=!0;"number"==typeof e[0][t]&&(n=!1);var i=t;return e.sort(function(e,t){var a=e[i],r=t[i];return n&&(a=a.toUpperCase(),r=r.toUpperCase()),a<r?-1:a>r?1:0}),e}},p.when=function(e){return _.when.apply(_,(0,s.default)(e))},p.Deferred=_.Deferred,p.syncWhen=function(){var e=p.Deferred(),t=[],n=[],i=!1,a=Array.prototype.slice.call(arguments);switch(a.length){case 1:a[0]instanceof Array&&(n=a[0]);break;case 2:a[1]&&(i=!0),a[0]instanceof Array&&(n=a[0])}if(!n.length)return e.resolve(),e.promise();var r=function(){i?o(Array.prototype.slice.call(arguments)):e.reject.apply(e,arguments)},o=function(){t=t.concat(Array.prototype.slice.call(arguments));var i=n.shift();if(i)return l(i);e.resolve.apply(e,(0,s.default)(t))},l=function(n){var a=_.Deferred(),s=function(e){var t=Array.prototype.slice.call(arguments);if(t.length>0&&(t=t[0]),"object"===(void 0===t?"undefined":(0,d.default)(t))&&!i&&"rejected"==t.state())throw t;a.resolve(t)};a.promise().then(o,r);try{var l=[a].concat(t);switch(void 0===n?"undefined":(0,d.default)(n)){case"object":n.always(s);break;default:n.apply(window,l).always(s)}}catch(t){e.reject(t)}};return l(n.shift()),e.promise()},p.executeUntilDone=function(e){var t=new _.Deferred,n={},i=!1;e.inParallelProcessCount||(e.inParallelProcessCount=1);for(var a=0;a<e.inParallelProcessCount;a++)n["process"+a]=[];for(a=0;a<e.data.length;a++)n["process"+a%e.inParallelProcessCount].push(e.data[a]);var r=!1;for(a=0;a<e.inParallelProcessCount;a++)!function a(r,o){if(!i){var s=n[r].shift();if(s){var l=e.process(s);l.done(function(){a(r,o)}),l.fail(function(n){e.onError&&(i=e.onError(n)),i?t.fail(n):a(r,o)})}else{delete n[r];var c=0;p.forEachProperty(n,function(e,t){c++}),0===c&&e.onSuccess&&(e.onSuccess(),t.resolve())}}}("process"+a,e.inProcess),r=!0;return r||t.resolve(),t},p.__serializedTasks=[],p.serializeTasks=function(e){if(p.__serializedTasks.length>0)p.__serializedTasks.push(callback);else{callback().resolve(p.__serializeNext)}},p.__serializeNext=function(){if(0!=p.__serializeTasks.length){p.__serializedTasks.pop()().resolve(p.__serializeNext)}},p.loadCss=function(e){_.ajax({type:"GET",url:e,dataType:"css",async:!1,success:function(){},error:function(e,t,n){}}),document.createStyleSheet?document.createStyleSheet(e):_("head").append(_("<link rel='stylesheet' href='"+e+"' type='text/css' media='screen' />"))},p.requireStyleSheet=function(e,t,n,i){_.isArray(e)||(e=[e]);var a=0,r=i.prefix?i.prefix:"";_.each(e,function(){var i=document.getElementsByTagName("head")[0],o=document.createElement("link");o.setAttribute("href",r+this),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css");var s=void 0,l=void 0,c=0,u=0;"sheet"in o?(s="sheet",l="cssRules"):(s="styleSheet",l="rules"),c=setInterval(function(){if(p.getLoggingService().getLogger().debug("requireStyleSheet::setInterval()"),++u>200)clearInterval(c),p.getLoggingService().getLogger().debug("Timeout! clearing interval with id => "+c),i.removeChild(o),++a==e.length&&t.apply(n);else try{o[s]&&o[s][l].length&&(clearInterval(c),p.getLoggingService().getLogger().debug("clearing interval with id => "+c),++a==e.length&&t.apply(n))}catch(e){p.getLoggingService().getLogger().error("There was an error! =>"+e)}},100),i.appendChild(o)})},p.requireScript=function(e,t,n,i,a,r){if(_.isArray(e)||(e=[e]),0!=e.length){var o=p.getClient().getLoadVersion();a&&a.ignoreLoadVersion&&(o="debug"),"micro"==o&&(e=["__all__-min.js"]);var s=0,l=p.isCachingEnabled();_.each(e,function(c,u){var h="",f=void 0==a.async||a.async,m="";"string"==typeof u?(h=a.prefix?a.prefix:"",m=u):"object"===(void 0===u?"undefined":(0,d.default)(u))&&(h=u.location?u.location:"",m=u.name),"min"==o&&(m=m.substring(0,m.length-3)+"-min.js"),_.ajax({cache:l,type:"GET",url:h+m,dataType:"text",async:f,success:function(a,o,l,c){var u=l.responseText+"\r\n//@ sourceURL=/"+String(h).replace(/^.*client\./,"")+m;try{_.globalEval(u)}catch(e){return p.getLoggingService().getLogger().error("Error compiling => "+h+m+" =>"+e),void(n&&n(new Error(m+" Failed to compile")))}++s==e.length&&(r&&r.resolve(),t.apply(i))},error:function(e,t,i){throw p.getLoggingService().getLogger().error("Error while loading => "+h+m+" =>"+i),r&&r.reject(e),n&&n(new Error(m+" Failed to load")),i}})})}},p.requireTemplate=function(e,t,n,i){_.isArray(e)||(e=[e]);var a=0,r=i.prefix?i.prefix:"",o=[];_.each(e,function(){var s=void 0==i.async||i.async,l=this.toString();_.ajax({type:"GET",url:r+this,dataType:"text",async:s,success:function(i,r,s){o[o.length]={name:l,data:i},++a==e.length&&t.call(n,o)},error:function(e,t,n){}})})},p.getDisplayRootId=function(){return"client_display_root"};var E={};p.getClientProperty=function(e){return E[e]},p.setClientProperty=function(e,t){E[e]=t},p.format=function(e){if(0==e.length)return"";for(var t=e[0],n=1;n<e.length;n++){var i="\\{"+(n-1)+"\\}",a=new RegExp(i,"gi");t=t.replace(a,e[n])}return t},p.toXML=function(e,t){function n(){if(0==arguments.length)return"";for(var e=arguments[0],t=1;t<arguments.length;t++){var n=new RegExp("\\{"+(t-1)+"\\}","gi");e=e.replace(n,arguments[t])}return e}function i(e,t){var n="";return null!=t&&void 0!=t&&(t instanceof Array?n+=a(e,t):"object"===(void 0===t?"undefined":(0,d.default)(t))?n+=o(e,t):n+=r(e,t)),n}function a(e,t){for(var n,a="",r=t.length,n=0;n<r;n++){a+=i(e,t[n])}return a}function r(e,t){return t&&"string"==typeof t&&(t=t.split("&").join("&amp;"),t=t.split("<").join("&lt;"),t=t.split(">").join("&gt;"),t=t.split('"').join("&quot;"),t=t.split("'").join("&#39;")),n("<{0}>{1}</{0}>",e,t)}function o(e,t){var a="";for(var r in t){a+=i(r,t[r])}return e&&(a=n("<{0}>{1}</{0}>",e,a)),a}return"string"==typeof e?e:o(t,e)},p.xmlToJson=function(e){var t=void 0,n=e.attributes,i=e.childNodes,a=e.nodeType,r={},o=-1;for(1==a&&n.length?o=-1:3==a&&(r=e.nodeValue);t=i.item(++o);)a=t.nodeName,a=-1!=a.indexOf(":")?a.split(":")[1]:a,r.hasOwnProperty(a)?("[object Array]"!=r.toString.call(r[a])&&(r[a]=[r[a]]),r[a].push(p.xmlToJson(t))):r[a]=p.xmlToJson(t);if(e.nodeName&&"INTF_Response:record"===e.nodeName)for(var s=0;s<n.length;s++){var l=n[s];if(l.nodeName&&"xsi:type"===l.nodeName&&l.nodeValue){r.recordType=l.nodeValue;break}}for(var c in r){var u=r[c];u&&"object"===(void 0===u?"undefined":(0,d.default)(u))&&u.hasOwnProperty("#text")&&(r[c]=u["#text"],"false"===r[c]?r[c]=!1:"true"===r[c]&&(r[c]=!0))}return r},p.array={indexOf:function(e,t,n){if(!e||!e.length)return-1;var i="function"==typeof t;if(i&&n&&(t=p.proxy(n,t)),Array.prototype.indexOf&&!i)return e.indexOf(t);for(var a=0;a<e.length;a++)if(i){if(t(e[a],a))return a}else if(t===e[a])return a;return-1},get:function(e,t,n){var i=p.array.indexOf(e,t,n);return-1==i?null:e[i]},contains:function(e,t,n){return-1!=p.array.indexOf(e,t,n)},map:function(e,t,n){return n&&(t=p.proxy(n,t)),_.map(e,t)},filter:function(e,t,n){return n&&(t=p.proxy(n,t)),e.filter(t)},every:function(e,t,n){if(!e||!e.length)return!1;n&&(t=p.proxy(n,t));for(var i=0;i<e.length;i++)if(!t(e[i],i))return!1;return!0},forEach:function(e,t,n){n&&(t=p.proxy(n,t));for(var i=0;i<e.length;i++){if(!1===t(e[i],i))return}},insert:function(e,t,n){e.splice(n,0,t)},removeElementAt:function(e,t){e.splice(t,1)},remove:function(e,t,n){for(var i="function"==typeof t,a=e.length-1;a>=0;a--){var r=e[a];if((i?t(r,a):r===t)&&(p.array.removeElementAt(e,a),!n))return r}}},p.defineGlobal=function(e,t){for(var n=e.substring(0,e.lastIndexOf(".")),i=n.split("."),a=window||this,o=0,s=i.length;o<s;o++)a[i[o]]||(a[i[o]]={}),a=a[i[o]];var l=a[e.substring(e.lastIndexOf(".")+1)]||{};a[e.substring(e.lastIndexOf(".")+1)]=(0,r.default)(l,t)},p.getClientTypeForUnifiedApp=function(){var e=p.getClient().getApplicationParameter("client-type").toLowerCase();if("laptop"==e)e="MFL";else if("mobile"==e){var t=p.getClient().getApplicationParameter("device-info");if(t&&t["device-platform"])switch(t["device-platform"].toLowerCase()){case"android":e="ANDROID TABLET";break;case"ios":e="IPAD";break;default:e=t["device-platform"]}}return e=e.toUpperCase()},p.splitLongStringToChunkArray=function(e,t){t=t||12e4;for(var n=Math.ceil(e.length/t),i=new Array(n),a=0,r=0;a<n;++a,r+=t)i[a]=e.substr(r,t);return i},p.encodeHTML=function(e){return e&&"string"==typeof e&&(Ext?(e=Ext.String.htmlEncode(e),p.getLoggingService().getLogger("EncodeHTML").info("Ext HTML_ENCODING ==>"+e)):p.getLoggingService().getLogger("EncodeHTML").error("Ext not found")),e},window.SVMX=p,e.exports=p},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(126),m=n(5).EventDispatcher,v=n(5).SVMXObject,g=n(12).DatetimeUtil,y=n(5).Event,S={name:"com.servicemax.client.lib.services"};S.ProfilingService=function(e){function t(e,n,i){if((0,s.default)(this,t),null!=S.ProfilingService.__instance){var a;return a=S.ProfilingService.__instance,(0,d.default)(o,a)}var o=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i));return S.ProfilingService.__instance=o,o.__supportedBrowser=o.__checkBrowser(),o.__performance=window.performance,o.__serverEntries=[],o.__defaultEvents={REFRESH_CONTENT:!0,DATA_UPDATED:!0},o.__timingHash={redirect:{begin:"redirectStart",end:"redirectEnd"},cache:{begin:"fetchStart",end:"domainLookupStart"},dns:{begin:"domainLookupStart",end:"domainLookupEnd"},tcp:{begin:"connectStart",end:"connectEnd"},request:{begin:"requestStart",end:"responseEnd"},response:{begin:"responseStart",end:"responseEnd"},unload:{begin:"unloadStart",end:"unloadEnd"},dom:{begin:"domLoading",end:"domComplete"},content:{begin:"domContentLoadedEventStart",end:"domContentLoadedEventEnd"},load:{begin:"loadEventStart",end:"loadEventEnd"},total:{begin:"navigationStart",end:"loadEventEnd"}},o}return(0,h.default)(t,e),(0,c.default)(t,[{key:"__checkBrowser",value:function(){var e=!1,t=this.__getBrowser().toLowerCase(),n=this.__getBrowserVersion().toLowerCase();switch(t){case"chrome":case"firefox":e=!0;break;case"ie":isNaN(n)||""==n||(n=parseInt(n),e=n>8)}return e}},{key:"__getBrowser",value:function(){var e=navigator.userAgent,t=void 0,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],"IE"):"Chrome"===n[1]&&null!=(t=e.match(/\bOPR\/(\d+)/))?"Opera "+t[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n[0])}},{key:"__getBrowserVersion",value:function(){var e=navigator.userAgent,t=void 0,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],t[1]||"0"):"Chrome"===n[1]&&null!=(t=e.match(/\bOPR\/(\d+)/))?"Opera "+t[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n[1])}},{key:"__findEntryKeyType",value:function(e){e=e||0;var t=["PerformanceMeasure","PerformanceEntry"],n=this.__findEntryTypeKeyByName(t[e]);return n.length>0?n:this.__findEntryKeyType(++e)}},{key:"__getMeasureDataBy",value:function(e,t){for(var n=[],i=this.__findEntryKeyType(),a=this.getEntriesByType(i),r=null,o="",s=0;s<a.length;s++)r=a[s].name.split("_"),r.length>0&&(o=r[t],t>1&&(r.shift(),r.shift(),o=r.join("_")),-1==t&&(o=r[0]+"_"+r[1]),o==e&&n.push(a[s]));return n}},{key:"__isEntryTypeObject",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].action==t.action&&e[n].type==t.type)return!0;return!1}},{key:"__isEntryTypes",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].name==t)return!0;return!1}},{key:"__findEntryTypeKeyByName",value:function(e){for(var t=this.getEntryTypes(),n=0;n<t.length;n++)if(t[n].name==e)return t[n].entry;return""}},{key:"__parseMeasurementName",value:function(e){var t=e.split("_");if(3!=t.length)return{};var n=t[0],i=t[1],e=t[2];return t.length>3&&(t.shift(),t.shift(),e=t.join("_")),{action:n,type:i,name:e}}},{key:"__getServerEntriesBy",value:function(e,t){var n={reqtype:!0,entryType:!0,name:!0,description:!0,endtime:!0,begintime:!0},i=[];if(!n[e])return i;for(var a=this.__serverEntries,r=0;r<a.length;r++){var o=a[r];t==o[e]&&i.push(o)}return i}},{key:"raiseEvent",value:function(e,t,n){if(this.__defaultEvents[e]){var i=t||void 0,a=n||{request:{},responder:{}},r=p.create("com.servicemax.client.lib.api.Event",e,i,a);this.triggerEvent(r)}}},{key:"getDefaultEvents",value:function(){return this.__defaultEvents}},{key:"getTimingOptions",value:function(){return this.__timingHash}},{key:"getNativeProfiler",value:function(){return this.__performance}},{key:"getEntryTypes",value:function(){for(var e=[],t=this.getEntries(),n=0,i=null;n<t.length;n++)0==n?(i={name:p.typeOf(t[n]),entry:t[n].entryType},e.push(i)):(i={name:p.typeOf(t[n]),entry:t[n].entryType},this.__isEntryTypes(e,i.name)||e.push(i));return e}},{key:"getMeasureEntryTypes",value:function(){for(var e=[],t=this.__findEntryKeyType(),n=this.getEntriesByType(t),i=null,a=0;a<n.length;a++)i=this.__parseMeasurementName(n[a].name),i.name&&(delete i.name,0==a?e.push(i):this.__isEntryTypeObject(e,i)||e.push(i));return e}},{key:"getMeasureDataByType",value:function(e){return this.__getMeasureDataBy(e,1)}},{key:"getMeasureDataByAction",value:function(e){return this.__getMeasureDataBy(e,0)}},{key:"getMeasureDataByName",value:function(e){return this.__getMeasureDataBy(e,2)}},{key:"getMeasureDataByText",value:function(e){return this.__getMeasureDataBy(e,-1)}},{key:"getTimes",value:function(){var e=[],t=this.__timingHash,n=this.__performance.timing;for(var i in t){var a={},r=t[i],o=n[r.end]-n[r.begin];a.name=i,a.duration=o,e.push(a)}return e}},{key:"getTimesByType",value:function(e){var t=this.__timingHash[e];if(!t)return 0;var n=this.__performance.timing,i=n[t.end]-n[t.begin];return i<0?0:i}},{key:"getEntries",value:function(){var e=[];return e=f.merge(f.merge(e,this.__performance.getEntries()),this.__serverEntries)}},{key:"getEntriesByName",value:function(e){var t=this.__getServerEntriesBy("name",e);return this.__performance.getEntriesByName&&f.merge(t,this.__performance.getEntriesByName(e)),t}},{key:"getEntriesByType",value:function(e){var t=this.__getServerEntriesBy("entryType",e);return this.__performance.getEntriesByType&&f.merge(t,this.__performance.getEntriesByType(e)),t}},{key:"getMeasurementByName",value:function(e){for(var t=this.getEntriesByType("measure"),n=[],i=0;i<t.length;i++)t[i].name===e&&n.push(t[i]);return n}},{key:"begin",value:function(e,t,n){if(!e)return!1;if("string"!=p.typeOf(e))return!1;n="string"!=p.typeOf(n)?"nonspecAction":n,t="string"!=p.typeOf(t)?"nonspecType":t;var i=[n,t,e].join("_");return this.mark(i,"begin")}},{key:"end",value:function(e,t,n){if(!e)return!1;if("string"!=p.typeOf(e))return!1;n="string"!=p.typeOf(n)?"nonspecAction":n,t="string"!=p.typeOf(t)?"nonspecType":t;var i=[n,t,e].join("_");return this.getEntriesByName(i+"_begin").length>0?this.mark(i,"end",!0,!0):this}},{key:"mark",value:function(e,t,n,i){var a={begin:"begin",end:"end"},r=a[t]?e+"_"+a[t]:e;return this.__performance.mark&&this.__performance.mark(r),n&&this.measure(e),i&&this.clearMarks(e),this}},{key:"measure",value:function(e,t,n){var i=t||e+"_begin",a=n||e+"_end";return this.__performance.measure&&this.__performance.measure(e,i,a),this}},{key:"clearMarks",value:function(e){if(this.__performance.clearMarks&&this.__performance.clearMarks(e),e){var t=e+"_begin",n=e+"_end";this.__performance.clearMarks&&this.__performance.clearMarks(t),this.__performance.clearMarks&&this.__performance.clearMarks(n)}return this}},{key:"clearMeasure",value:function(e){return this.__performance.clearMeasure&&this.__performance.clearMeasure(e),this}},{key:"exportToFile",value:function(){}},{key:"addServerEntry",value:function(e){if("Object"==p.typeOf(e)&&this.__supportedBrowser){var t={reqtype:!0,name:!0,description:!0,endtime:!0,begintime:!0};for(var n in e)if(!t[n])return!1;this.__serverEntries.push(this.__processServerEntryData(e))}}},{key:"__processServerEntryData",value:function(e){var t={rawdata:e},n={reqtype:"entryType",name:"name",begintime:"startTime"},i="";for(var a in e)if(n[a]){var r=n[a];i=e[a],"reqtype"==a&&(i=i.toLowerCase()),t[r]=i}var o=this.__convertToDateTimeObject(e.endtime),s=this.__convertToDateTimeObject(e.begintime);return t.duration=Math.abs(o-s),t.startTime=s.getTime()-performance.timing.navigationStart,t}},{key:"__convertToDateTimeObject",value:function(e){var t=this.__extractDateTime(e);return new Date(t.Y,t.M,t.D,t.hh,t.mm,t.ss,t.ms)}},{key:"__extractDateTime",value:function(e){var t=e.split("T"),n={date:t[0],time:t[1]};return f.extend(n,this.__extractDate(n.date),this.__extractTime(n.time)),n}},{key:"__extractDate",value:function(e){var t=e.split("-");return{Y:1*t[0],M:1*t[1],D:1*t[2]}}},{key:"__extractTime",value:function(e){var t=e.split(": ");1==t.length&&(t=e.split(":"));var n=t[2].split(".");return{hh:1*t[0],mm:1*t[1],ss:1*n[0],ms:1*n[1].substr(0,n[1].length-1)}}},{key:"clearServerEntries",value:function(){this.__serverEntries.length=0}}]),t}(m),S.ProfilingService.getInstance=function(){return null==S.ProfilingService.__instance?new S.ProfilingService:S.ProfilingService.__instance},S.ProfilingService.__instance=null,S.LoggingService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));if(null!=S.LoggingService.__instance){var n;return n=S.LoggingService.__instance,(0,d.default)(e,n)}return S.LoggingService.__instance=e,e.__loggers={},e.__uncreatedLoggers=null,e.__logTargetSettings=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"setTargetSettings",value:function(e){S.LoggingService.clearTargets(),this.generateLogTargets(e.targets);this.__logTargetSettings=e.loggers;for(var t in this.__loggers){var e=this.getLoggerSettings(t);this.__loggers[t].setTargetSettings(e)}}},{key:"generateMissingLogTargets",value:function(e){this.__uncreatedLoggers&&this.generateLogTargets(this.__uncreatedLoggers)}},{key:"generateLogTargets",value:function(e){this.__uncreatedLoggers={};var t=!1;S.LoggingService.__targets;p.forEachProperty(e,function(e,n){if(!p.array.contains(this.__targets,function(t){return t.targetName==e})){var i=n["class-name"];p.getClass(i,!0)?(n.options.targetName=e,p.create(i,n.options)):(this.__uncreatedLoggers[e]=n,t=!0)}},this),t||(this.__uncreatedLoggers=null)}},{key:"getLoggerSettings",value:function(e){if(this.__logTargetSettings)return f.extend({},this.__logTargetSettings.DEFAULT||{},this.__logTargetSettings[e]||{});for(var t=this.getTargets(),n={},i=0;i<t.length;i++)n[t[i].targetName]=t[i].defaultLogLevel;return n}},{key:"getLogger",value:function(e){var t=null;if(void 0!=e&&null!=e||(e="SVMXCONSOLECORE"),void 0==this.__loggers[e]){var n=this.getLoggerSettings(e);t=new S.Logger(this,e,n),this.__loggers[e]=t}else t=this.__loggers[e];return t}},{key:"getTargets",value:function(e){var t=[],n=S.LoggingService.__targets;if(e)for(var i=0;i<n.length;i++)e[n[i].targetName]&&t.push(n[i]);else for(var i=0;i<n.length;i++)n[i].isDefaultTarget&&t.push(n[i]);return t}}]),t}(v),S.LoggingService.clearTargets=function(){S.LoggingService.__targets=[]},S.LoggingService.registerTarget=function(e,t){p.array.remove(S.LoggingService.__targets,function(t){return e.targetName==t.targetName},!0),S.LoggingService.__targets.push(e),p.timer.job("generateMissingLogTargets",10,function(){S.LoggingService.getInstance().generateMissingLogTargets()})},S.LoggingService.getInstance=function(e){return null==S.LoggingService.__instance?new S.LoggingService(e):S.LoggingService.__instance},S.LoggingService.__instance=null,S.LoggingService.__targets=[],S.AbstractLogTarget=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e||(e={}),n.targetName=e.targetName,S.LoggingService.registerTarget(n),n.isDefaultTarget=!1,n.defaultLogLevel="ERROR",n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"log",value:function(e,t){}}]),t}(v),S.BrowserConsoleLogTarget=function(e){function t(e){(0,s.default)(this,t),e||(e={targetName:"Browser"});var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.isDefaultTarget=!0,n.defaultLogLevel="DEBUG",n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"log",value:function(e,t){var n=window.console;if(n){var i=t.type;e instanceof Error&&(e=e.stack?e.stack.toString():e.toString());var a=t.timeStamp+": "+t.source+" "+e;"INFO"==i||"CRITICAL"==i?n.info(a):"ERROR"==i?n.error(a):"WARNING"==i?n.warn(a):"DEBUG"==i?n.debug?n.debug(a):n.info("DEBUG=>INFO "+a):n.log(a)}}}]),t}(S.AbstractLogTarget),new S.BrowserConsoleLogTarget({targetName:"Browser"}),S.AlertLogTarget=function(e){function t(e){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"log",value:function(e,t){if(window.console){var n=t.type;e instanceof Error&&(e=e.stack?e.stack.toString():e.toString());var i=t.timeStamp+": "+t.source+" "+e;alert(n+": "+i)}}}]),t}(S.AbstractLogTarget),S.Logger=function(e){function t(e,n,i){(0,s.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return a.__parent=e,a.__source=n,a.setTargetSettings(i||[]),a}return(0,h.default)(t,e),(0,c.default)(t,[{key:"setTargetSettings",value:function(e){this.__targetSettings=e}},{key:"__shouldSkipLogging",value:function(e,t){var n=!1,i={DEBUG:5,INFO:4,WARNING:3,ERROR:2,CRITICAL:1,NONE:0},a=this.__targetSettings[t];return!a||(i[a]<i[e]&&(n=!0),n)}},{key:"getTimestamp",value:function(){return S?g.macroDrivenDatetime("Now","MM-DD-YYYY","HH:mm:ss"):(new Date).toString()}},{key:"info",value:function(e){for(var t=this.__parent.getTargets(this.__targetSettings),n=this.getTimestamp(),i=0;i<t.length;i++)this.__shouldSkipLogging("INFO",t[i].targetName)||t[i].log(e,{type:"INFO",source:this.__source,timeStamp:n})}},{key:"debug",value:function(e){for(var t=this.__parent.getTargets(this.__targetSettings),n=this.getTimestamp(),i=0;i<t.length;i++)this.__shouldSkipLogging("DEBUG",t[i].targetName)||t[i].log(e,{type:"DEBUG",source:this.__source,timeStamp:n})}},{key:"error",value:function(e){for(var t=this.__parent.getTargets(this.__targetSettings),n=this.getTimestamp(),i=0;i<t.length;i++)this.__shouldSkipLogging("ERROR",t[i].targetName)||t[i].log(e,{type:"ERROR",source:this.__source,timeStamp:n})}},{key:"warning",value:function(e){for(var t=this.__parent.getTargets(this.__targetSettings),n=this.getTimestamp(),i=0;i<t.length;i++)this.__shouldSkipLogging("WARNING",t[i].targetName)||t[i].log(e,{type:"WARNING",source:this.__source,timeStamp:n})}},{key:"warn",value:function(e){this.warning(e)}},{key:"critical",value:function(e){for(var t=this.__parent.getTargets(this.__targetSettings),n=this.getTimestamp(),i=0;i<t.length;i++)this.__shouldSkipLogging("CRITICAL",t[i].targetName)||t[i].log(e,{type:"CRITICAL",source:this.__source,timeStamp:n})}}]),t}(v),S.ResourceLoaderEvent=function(e){function t(e,n,i){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i))}return(0,h.default)(t,e),t}(y),S.ResourceLoader=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"loadAsync",value:function(e){return f.ajax({type:"GET",dataType:e.responseType,data:e.data,cache:e.cache,url:e.url,context:this,async:!0,success:function(e,t,n){this._loadSuccess(e,t)},error:function(e,t,n){this._loadError(e,t,n)}})}},{key:"_loadSuccess",value:function(e,t){var n=new S.ResourceLoaderEvent("LOAD_COMPLETE",this,e);this.triggerEvent(n)}},{key:"_loadError",value:function(e,t,n){var i=new S.ResourceLoaderEvent("LOAD_ERROR",this);this.triggerEvent(i)}}]),t}(m),S.ResourceLoaderService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));if(null!=S.ResourceLoaderService.__instance){var n;return n=S.ResourceLoaderService.__instance,(0,d.default)(e,n)}return S.ResourceLoaderService.__instance=e,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"createResourceLoader",value:function(){return new S.ResourceLoader}}]),t}(v),S.ResourceLoaderService.getInstance=function(){return null==S.ResourceLoaderService.__instance?new S.ResourceLoaderService:S.ResourceLoaderService.__instance},S.ResourceLoaderService.__instance=null,p.getProfilingService=function(){return S.ProfilingService.getInstance()},p.getLoggingService=function(){return S.LoggingService.getInstance()},e.exports=S},function(e,t,n){var i=n(79),a=n(241),r=n(242),o=n(66),s=n(120),l=n(178),c={},u={},t=e.exports=function(e,t,n,d,_){var h,f,p,m,v=_?function(){return e}:l(e),g=i(n,d,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(r(v)){for(h=s(e.length);h>y;y++)if((m=t?g(o(f=e[y])[0],f[1]):g(e[y]))===c||m===u)return m}else for(p=v.call(e);!(f=p.next()).done;)if((m=a(p,g,f.value,t))===c||m===u)return m};t.BREAK=c,t.RETURN=u},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m={name:"com.servicemax.client.runtime.api"};m.AbstractNamedInstance=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e,t,n){}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m=n(11).Facade,v=n(7).Cache,g=n(7).Data,y=n(7).MetaData,S=n(7).SyncData,E={name:"com.servicemax.client.sync.syncutils"},b=E;b.Utils=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,null,[{key:"execQuery",value:function(e,t){var n=f.Deferred(),i=this.nativeService.createSQLRequest();return i.bind("REQUEST_COMPLETED",function(e){var i=e.data.data&&e.data.data[0];t&&t(i),n.resolve(i)}),i.bind("REQUEST_ERROR",function(e){t&&t(void 0,e.data.data),n.resolve(void 0,e.data.data)},this),i.execute({query:"string"==typeof e?e:e.query,binds:e.binds}),n}},{key:"getSyncConflicts",value:function(e,t){"function"==typeof e&&(t=e,e=null);var n={query:"SELECT * FROM ClientSyncConflict"};e&&(n.query+=" WHERE operation = {{op}}",n.binds={op:e});var i=this.nativeService.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i=null;if(n&&n.length>0){i={};for(var a=0;a<n.length;a++)i[n[a].Id]=n[a]}t&&t(i)},this),i.bind("REQUEST_ERROR",function(e){var n=e.data.data;this.logger.error(n),t&&t(null)},this),i.execute(n)}},{key:"getSyncConflictCount",value:function(e,t){"function"==typeof e&&(t=e,e=null);var n={query:"SELECT count(*) FROM ClientSyncConflict"};e&&(n.query+=" WHERE operation = {{op}}",n.binds={op:e});var i=this.nativeService.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i={count:0};if(n&&n.length>0)for(var a=0;a<n.length;a++)i.count=n[a]["count(*)"];t&&t(i)},this),i.bind("REQUEST_ERROR",function(e){var n=e.data.data;this.logger.error(n),t&&t(null)},this),i.execute(n)}},{key:"getDisplayableSyncConflicts",value:function(e){var t=y;this.executeQuery("SELECT c.*, d.object_name, SUBSTR(c.Id, 1, 3) key_prefix FROM ClientSyncConflict c LEFT JOIN SFObjectDescribe d ON d.key_prefix COLLATE BINARY = SUBSTR(c.parent_id, 1, 3)OR d.key_prefix COLLATE BINARY = SUBSTR(c.Id, 1, 3)",function(n){if(n=n||[],n.length)for(var i=0,a=[],r=0;r<n.length;r++){i++;var o=n[r];o.error_message=o.error_message.replace("Error: ",""),function(n){var r=n.parent_id||n.Id;this.executeQuery("SELECT * FROM ["+n.object_name+"] WHERE Id = '"+r+"'",function(r){if(r&&r.length){var o=t.getNameField(n.object_name);n.nameValue=r[0][o]}else n.nameValue=!1;a.push(n),0===--i&&e.call(this,a)})}.call(this,o)}},this)}},{key:"getDetailedSyncConflicts",value:function(e,t){var n=y,i="SELECT c.*, d.object_name, SUBSTR(c.Id, 1, 3) key_prefix, d.label FROM ClientSyncConflict c LEFT JOIN SFObjectDescribe d ON d.key_prefix COLLATE BINARY  = SUBSTR(c.Id, 1, 3)";t&&(i+=" WHERE c.Id = '"+t+"' OR c.parent_id = '"+t+"' "),this.executeQuery(i,function(t){if(t=t||[],t.length)for(var i=0,a=[],r=0;r<t.length;r++){i++;var o=t[r];o.error_message=o.error_message.replace("Error: ",""),function(t){var r=t.Id;t.detailId=r,this.executeQuery("SELECT * FROM "+t.object_name+" WHERE Id = '"+r+"'",function(r){if(r&&r.length){var o=n.getNameField(t.object_name);t.nameValue=r[0][o]}else t.nameValue=!1;a.push(t),0===--i&&e.call(this,a)})}.call(this,o)}},this)}},{key:"executeQuery",value:function(e,t,n){return this.__executeQuery(e,t,function(e){n&&n.call(this,e)})}},{key:"__executeQuery",value:function(e,t,n){var i=f.Deferred();"function"==typeof t&&(n=t,t={});var a=m,r=a.createSQLRequest();return r.bind("REQUEST_COMPLETED",function(e){n&&n.call(this,f.toObject(e.data.data)),i.resolve(f.toObject(e.data.data))},this),r.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),n&&n.call(this,!1),i.reject(e.data)},this),r.execute({query:e,async:!0,queryBinds:t}),i}},{key:"executeUntilDone",value:function(e){var t=f.Deferred(),n={},i=!1,a=!1;f.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().bind("ABORT_ATTACHMENT_DOWNLOAD",function(){a=!0},this);e.inParallelProcessCount||(e.inParallelProcessCount=1);for(var r=0;r<e.inParallelProcessCount;r++)n["process"+r]=[];var o=!1;for(r=0;r<e.data.length;r++){var s=e.data[r],l=s.content_length&&s.content_length>15e6,c=s.content_length&&s.content_length<5e6;l&&(o=!0),o&&c||!o?n["process"+r%e.inParallelProcessCount].push(e.data[r]):n.process0.push(e.data[r])}var u=!1;for(r=0;r<e.inParallelProcessCount;r++)!function r(o,s){if(!i){if(a)return n={},e.onSuccess(),void t.resolve();var l=n[o].shift();if(l){var c=e.process(l);c=c.done(function(){r(o,s)}),c=c.fail(function(n){e.onError&&(i=e.onError(n)),i?t.fail(n):r(o,s)})}else{delete n[o];var u=0;f.forEachProperty(n,function(e,t){u++}),0===u&&e.onSuccess&&(e.onSuccess(),t.resolve())}}}("process"+r,e.inProcess),u=!0;return u||t.resolve(),t}}]),t}(p),b.Utils.SyncData=S,b.Utils.MetaData=y,b.Utils.Data=g,b.Utils.Cache=v,b.Utils.nativeService=m,b.Utils.logger=f.getLoggingService().getLogger("SYNC-API"),f.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.utils"};g.CacheHelper=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"refreshView",value:function(){this.cacheServ=m.getClient().getServiceRegistry().getService("com.servicemax.client.cache").getInstance();for(var e=this.cacheServ.__cacheItems,t=(0,r.default)(e),n=0;n<t.length;n++){var i=t[n];if(Ext.isDefined(i)&&0==t[n].indexOf("sfmsearch")){var a=e[t[n]],o=m.toObject(a);o.interests=[],e[t[n]]=o,this.cacheServ.setItem(t[n],m.toJSON(o))}}}}]),t}(v),g.PIQSearchUtilityHelper=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"getSearchResultsView",value:function(){var e=Ext.ComponentQuery.query("sfm\\.search\\.resultview"),t=e.length,n=null;return!Ext.isEmpty(e)&&t>0&&(n=e[t-1]),n}},{key:"getToolBarView",value:function(){var e=Ext.ComponentQuery.query("sfmsearch\\.sfmsearchbar"),t=null,n=e.length;return n>0&&(t=e[n-1]),t}},{key:"getSearchResultsContainer",value:function(){var e=Ext.ComponentQuery.query("#searchResultsContainer"),t=e.length,n=null;return!Ext.isEmpty(e)&&t>0&&(n=e[t-1]),n}}]),t}(v),m.defineGlobal(g.name,g),e.exports=g},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var i=n(21),a=n(17).document,r=i(a)&&i(a.createElement);e.exports=function(e){return r?a.createElement(e):{}}},function(e,t,n){var i=n(17),a=n(43),r=n(61),o=n(195),s=n(27).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=r?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){var i=n(90)("keys"),a=n(68);e.exports=function(e){return i[e]||(i[e]=a(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var i=n(17).document;e.exports=i&&i.documentElement},function(e,t,n){var i=n(21),a=n(15),r=function(e,t){if(a(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=n(44)(Function.call,n(40).f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(e,t,n){var i=n(21),a=n(138).set;e.exports=function(e,t,n){var r,o=t.constructor;return o!==n&&"function"==typeof o&&(r=o.prototype)!==n.prototype&&i(r)&&a&&a(e,r),e}},function(e,t,n){"use strict";var i=n(46),a=n(52);e.exports=function(e){var t=String(a(this)),n="",r=i(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){"use strict";var i=n(61),a=n(9),r=n(36),o=n(35),s=n(85),l=n(145),c=n(82),u=n(41),d=n(23)("iterator"),_=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,f,p,m,v){l(n,t,f);var g,y,S,E=function(e){if(!_&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},b=t+" Iterator",T="values"==p,M=!1,I=e.prototype,C=I[d]||I["@@iterator"]||p&&I[p],A=C||E(p),D=p?T?E("entries"):A:void 0,x="Array"==t?I.entries||C:C;if(x&&(S=u(x.call(new e)))!==Object.prototype&&S.next&&(c(S,b,!0),i||"function"==typeof S[d]||o(S,d,h)),T&&C&&"values"!==C.name&&(M=!0,A=function(){return C.call(this)}),i&&!v||!_&&!M&&I[d]||o(I,d,A),s[t]=A,s[b]=h,p)if(g={values:T?A:E("values"),keys:m?A:E("keys"),entries:D},v)for(y in g)y in I||r(I,y,g[y]);else a(a.P+a.F*(_||M),t,g);return g}},function(e,t,n){"use strict";var i=n(71),a=n(67),r=n(82),o={};n(35)(o,n(23)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(o,{next:a(1,n)}),r(e,t+" Iterator")}},function(e,t,n){var i=n(110),a=n(52);e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(a(e))}},function(e,t,n){var i=n(23)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var i=n(85),a=n(23)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[a]===e)}},function(e,t,n){"use strict";var i=n(27),a=n(67);e.exports=function(e,t,n){t in e?i.f(e,t,a(0,n)):e[t]=n}},function(e,t,n){var i=n(83),a=n(23)("iterator"),r=n(85);e.exports=n(43).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||r[i(e)]}},function(e,t,n){var i=n(516);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){"use strict";var i=n(29),a=n(70),r=n(25);e.exports=function(e){for(var t=i(this),n=r(t.length),o=arguments.length,s=a(o>1?arguments[1]:void 0,n),l=o>2?arguments[2]:void 0,c=void 0===l?n:a(l,n);c>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var i=n(63),a=n(212),r=n(85),o=n(39);e.exports=n(144)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,a(1)):"keys"==t?a(0,n):"values"==t?a(0,e[n]):a(0,[n,e[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t,n){"use strict";var i=n(93),a=RegExp.prototype.exec,r=String.prototype.replace,o=a,s=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),l=void 0!==/()??/.exec("")[1];(s||l)&&(o=function(e){var t,n,o,c,u=this;return l&&(n=new RegExp("^"+u.source+"$(?!\\s)",i.call(u))),s&&(t=u.lastIndex),o=a.call(u,e),s&&o&&(u.lastIndex=u.global?o.index+o[0].length:t),l&&o&&o.length>1&&r.call(o[0],n,function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(o[c]=void 0)}),o}),e.exports=o},function(e,t,n){"use strict";var i=n(109)(!0);e.exports=function(e,t,n){return t+(n?i(e,t).length:1)}},function(e,t,n){var i,a,r,o=n(44),s=n(202),l=n(137),c=n(133),u=n(17),d=u.process,_=u.setImmediate,h=u.clearImmediate,f=u.MessageChannel,p=u.Dispatch,m=0,v={},g=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},y=function(e){g.call(e.data)};_&&h||(_=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++m]=function(){s("function"==typeof e?e:Function(e),t)},i(m),m},h=function(e){delete v[e]},"process"==n(45)(d)?i=function(e){d.nextTick(o(g,e,1))}:p&&p.now?i=function(e){p.now(o(g,e,1))}:f?(a=new f,r=a.port2,a.port1.onmessage=y,i=o(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(e){u.postMessage(e+"","*")},u.addEventListener("message",y,!1)):i="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),g.call(e)}}:function(e){setTimeout(o(g,e,1),0)}),e.exports={set:_,clear:h}},function(e,t,n){var i=n(17),a=n(156).set,r=i.MutationObserver||i.WebKitMutationObserver,o=i.process,s=i.Promise,l="process"==n(45)(o);e.exports=function(){var e,t,n,c=function(){var i,a;for(l&&(i=o.domain)&&i.exit();e;){a=e.fn,e=e.next;try{a()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){o.nextTick(c)};else if(!r||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);n=function(){u.then(c)}}else n=function(){a.call(i,c)};else{var d=!0,_=document.createTextNode("");new r(c).observe(_,{characterData:!0}),n=function(){_.data=d=!d}}return function(i){var a={fn:i,next:void 0};t&&(t.next=a),e||(e=a,n()),t=a}}},function(e,t,n){"use strict";function i(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=a(t),this.reject=a(n)}var a=n(32);e.exports.f=function(e){return new i(e)}},function(e,t,n){"use strict";function i(e,t,n){var i,a,r,o=new Array(n),s=8*n-t-1,l=(1<<s)-1,c=l>>1,u=23===t?q(2,-24)-q(2,-77):0,d=0,_=e<0||0===e&&1/e<0?1:0;for(e=P(e),e!=e||e===w?(a=e!=e?1:0,i=l):(i=V(B(e)/j),e*(r=q(2,-i))<1&&(i--,r*=2),e+=i+c>=1?u/r:u*q(2,1-c),e*r>=2&&(i++,r/=2),i+c>=l?(a=0,i=l):i+c>=1?(a=(e*r-1)*q(2,t),i+=c):(a=e*q(2,c-1)*q(2,t),i=0));t>=8;o[d++]=255&a,a/=256,t-=8);for(i=i<<t|a,s+=t;s>0;o[d++]=255&i,i/=256,s-=8);return o[--d]|=128*_,o}function a(e,t,n){var i,a=8*n-t-1,r=(1<<a)-1,o=r>>1,s=a-7,l=n-1,c=e[l--],u=127&c;for(c>>=7;s>0;u=256*u+e[l],l--,s-=8);for(i=u&(1<<-s)-1,u>>=-s,s+=t;s>0;i=256*i+e[l],l--,s-=8);if(0===u)u=1-o;else{if(u===r)return i?NaN:c?-w:w;i+=q(2,t),u-=o}return(c?-1:1)*i*q(2,u-t)}function r(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function o(e){return[255&e]}function s(e){return[255&e,e>>8&255]}function l(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function c(e){return i(e,52,8)}function u(e){return i(e,23,4)}function d(e,t,n){C(e[x],t,{get:function(){return this[n]}})}function _(e,t,n,i){var a=+n,r=M(a);if(r+t>e[z])throw N(R);var o=e[H]._b,s=r+e[U],l=o.slice(s,s+t);return i?l:l.reverse()}function h(e,t,n,i,a,r){var o=+n,s=M(o);if(s+t>e[z])throw N(R);for(var l=e[H]._b,c=s+e[U],u=i(+a),d=0;d<t;d++)l[c+d]=u[r?d:t-d-1]}var f=n(17),p=n(26),m=n(61),v=n(116),g=n(35),y=n(76),S=n(20),E=n(74),b=n(46),T=n(25),M=n(222),I=n(72).f,C=n(27).f,A=n(152),D=n(82),x="prototype",R="Wrong index!",O=f.ArrayBuffer,L=f.DataView,k=f.Math,N=f.RangeError,w=f.Infinity,F=O,P=k.abs,q=k.pow,V=k.floor,B=k.log,j=k.LN2,H=p?"_b":"buffer",z=p?"_l":"byteLength",U=p?"_o":"byteOffset";if(v.ABV){if(!S(function(){O(1)})||!S(function(){new O(-1)})||S(function(){return new O,new O(1.5),new O(NaN),"ArrayBuffer"!=O.name})){O=function(e){return E(this,O),new F(M(e))};for(var Y,W=O[x]=F[x],G=I(F),X=0;G.length>X;)(Y=G[X++])in O||g(O,Y,F[Y]);m||(W.constructor=O)}var Q=new L(new O(2)),J=L[x].setInt8;Q.setInt8(0,2147483648),Q.setInt8(1,2147483649),!Q.getInt8(0)&&Q.getInt8(1)||y(L[x],{setInt8:function(e,t){J.call(this,e,t<<24>>24)},setUint8:function(e,t){J.call(this,e,t<<24>>24)}},!0)}else O=function(e){E(this,O,"ArrayBuffer");var t=M(e);this._b=A.call(new Array(t),0),this[z]=t},L=function(e,t,n){E(this,L,"DataView"),E(e,O,"DataView");var i=e[z],a=b(t);if(a<0||a>i)throw N("Wrong offset!");if(n=void 0===n?i-a:T(n),a+n>i)throw N("Wrong length!");this[H]=e,this[U]=a,this[z]=n},p&&(d(O,"byteLength","_l"),d(L,"buffer","_b"),d(L,"byteLength","_l"),d(L,"byteOffset","_o")),y(L[x],{getInt8:function(e){return _(this,1,e)[0]<<24>>24},getUint8:function(e){return _(this,1,e)[0]},getInt16:function(e){var t=_(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=_(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return r(_(this,4,e,arguments[1]))},getUint32:function(e){return r(_(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return a(_(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return a(_(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){h(this,1,e,o,t)},setUint8:function(e,t){h(this,1,e,o,t)},setInt16:function(e,t){h(this,2,e,s,t,arguments[2])},setUint16:function(e,t){h(this,2,e,s,t,arguments[2])},setInt32:function(e,t){h(this,4,e,l,t,arguments[2])},setUint32:function(e,t){h(this,4,e,l,t,arguments[2])},setFloat32:function(e,t){h(this,4,e,u,t,arguments[2])},setFloat64:function(e,t){h(this,8,e,c,t,arguments[2])}});D(O,"ArrayBuffer"),D(L,"DataView"),g(L[x],v.VIEW,!0),t.ArrayBuffer=O,t.DataView=L},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(162);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){var i=n(165)("keys"),a=n(122);e.exports=function(e){return i[e]||(i[e]=a(e))}},function(e,t,n){var i=n(28),a=n(48),r=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(121)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var i=n(34),a=n(28),r=n(80);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),i(i.S+i.F*r(function(){n(1)}),"Object",o)}},function(e,t,n){var i=n(59);e.exports=function(e,t){if(!i(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!i(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!i(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!i(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";var i=n(121),a=n(34),r=n(235),o=n(65),s=n(96),l=n(636),c=n(125),u=n(234),d=n(42)("iterator"),_=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,f,p,m,v){l(n,t,f);var g,y,S,E=function(e){if(!_&&e in I)return I[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},b=t+" Iterator",T="values"==p,M=!1,I=e.prototype,C=I[d]||I["@@iterator"]||p&&I[p],A=C||E(p),D=p?T?E("entries"):A:void 0,x="Array"==t?I.entries||C:C;if(x&&(S=u(x.call(new e)))!==Object.prototype&&S.next&&(c(S,b,!0),i||"function"==typeof S[d]||o(S,d,h)),T&&C&&"values"!==C.name&&(M=!0,A=function(){return C.call(this)}),i&&!v||!_&&!M&&I[d]||o(I,d,A),s[t]=A,s[b]=h,p)if(g={values:T?A:E("values"),keys:m?A:E("keys"),entries:D},v)for(y in g)y in I||r(I,y,g[y]);else a(a.P+a.F*(_||M),t,g);return g}},function(e,t,n){n(639);for(var i=n(48),a=n(65),r=n(96),o=n(42)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var c=s[l],u=i[c],d=u&&u.prototype;d&&!d[o]&&a(d,o,c),r[c]=r.Array}},function(e,t,n){t.f=n(42)},function(e,t,n){var i=n(122)("meta"),a=n(59),r=n(78),o=n(49).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(80)(function(){return l(Object.preventExtensions({}))}),u=function(e){o(e,i,{value:{i:"O"+ ++s,w:{}}})},d=function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,i)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[i].i},_=function(e,t){if(!r(e,i)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[i].w},h=function(e){return c&&f.NEED&&l(e)&&!r(e,i)&&u(e),e},f=e.exports={KEY:i,NEED:!1,fastKey:d,getWeak:_,onFreeze:h}},function(e,t,n){var i=n(48),a=n(28),r=n(121),o=n(171),s=n(49).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=r?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(97),a=n(95),r=n(64),o=n(168),s=n(78),l=n(232),c=Object.getOwnPropertyDescriptor;t.f=n(55)?c:function(e,t){if(e=r(e),t=o(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return a(!i.f.call(e,t),e[t])}},function(e,t,n){e.exports={default:n(654),__esModule:!0}},function(e,t,n){e.exports={default:n(659),__esModule:!0}},function(e,t,n){var i=n(243),a=n(42)("iterator"),r=n(96);e.exports=n(28).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||r[i(e)]}},function(e,t,n){n(672);var i=n(374),a=n(11),r=n(382),o=n(7),s=n(695),l=n(375),c=n(389),u=n(696),d=n(100),_=n(698),h=n(699),f=n(700),p=n(395),m=n(701),v=n(702),g=n(703),y=n(704),S=n(705),E=n(706),b=n(707),T=n(396),M=n(708),I=n(709),C=n(182),A=n(102),D=n(377),x=n(710),R=n(381),O=n(711),L=n(0).utils;n(81),n(183),L.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"MODEL",data:[{operationId:"SFMDELIVERY.GET_PAGELAYOUT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetPageLayout"},{operationId:"SFMDELIVERY.DESCRIBE_OBJECT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.DescribeObject"},{operationId:"SFMDELIVERY.GET_PAGEDATA",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetPageData"},{operationId:"SFMDELIVERY.GET_TEMPLATEDATA",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetTemplateData"},{operationId:"SFMDELIVERY.CLOSE_PROCESS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.CloseProcess"},{operationId:"SFMDELIVERY.RETRIEVE_SETTINGS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.RetrieveSettings"},{operationId:"SFMDELIVERY.GET_USERINFO",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetUserInfo"},{operationId:"SFMDELIVERY.GET_RECORD_CONFLICTED",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetRecordConflicted"},{operationId:"SFMDELIVERY.GET_VIEW_PROCESSES",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetViewProcesses"},{operationId:"SFMDELIVERY.GET_RECORD_ALREADY_OPEN",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetRecordAlreadyOpen"},{operationId:"SFMDELIVERY.GET_LOOKUPCONFIG",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetLookupConfig"},{operationId:"SFMDELIVERY.SAVE_TARGETRECORD",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.SaveTargetRecord"},{operationId:"SFMDELIVERY.GET_NEXTSTEPINFO",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetNextStepInfo"},{operationId:"SFMDELIVERY.INVOKE_EVENT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.InvokeEvent"},{operationId:"SFMDELIVERY.ADD_RECORDS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.AddRecords"},{operationId:"SFMDELIVERY.DELETE_RECORDS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.DeleteRecords"},{operationId:"SFMDELIVERY.COPY_RECORDS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.CopyRecords"},{operationId:"SFMDELIVERY.GET_BUBBLEDATA",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetBubbleData"},{operationId:"SFMDELIVERY.GET_RECORD_TYPES",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetRecordTypes"},{operationId:"SFMDELIVERY.GET_DETAIL_MAPPEDINFO",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetDetailMappedInfo"},{operationId:"SFMDELIVERY.GET_URL_AND_PARAMETERS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetUrlAndParameters"},{operationId:"SFMDELIVERY.GET_PRODUCT_HISTORY",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetProductHistory"},{operationId:"SFMDELIVERY.GET_ONLINE_PRODUCT_HISTORY",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetOnlineProductHistory"},{operationId:"SFMDELIVERY.GET_ACCOUNT_HISTORY",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetAccountHistory"},{operationId:"SFMDELIVERY.GET_ONLINE_ACCOUNT_HISTORY",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetOnlineAccountHistory"},{operationId:"SFMDELIVERY.DOWNLOAD_RECORD_ON_DEMAND",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.DownloadRecordOnDemand"},{operationId:"SFMDELIVERY.IS_DOD_RECORD",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.IsDodRecord"},{operationId:"SFMDELIVERY.CHECKLIST_FILE_ATTACHMENT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.ChecklistFileAttachment"},{operationId:"SFMEVENTDELIVERY.GET_EVENT_DATA",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.GetEventData"},{operationId:"SFMEVENTDELIVERY.DELETE_EVENT_DATA",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.DeleteEventData"},{operationId:"SFMEVENTDELIVERY.UPDATE_EVENT_DATE",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.UpdateEventDate"},{operationId:"SFMEVENTDELIVERY.GET_FIRST_EVENT_PROCESS",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.GetFirstEventProcess"},{operationId:"SFMEVENTDELIVERY.GET_EDITABLE_OBJECTS",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.GetEditableObjectNames"},{operationId:"SFMEVENTDELIVERY.GET_PRIORITY_COLORS",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.GetPriorityColors"},{operationId:"SFMEVENTDELIVERY.RETRIEVE_MOBILE_SETTINGS",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.RetrieveMobileSettings"},{operationId:"SFMEVENTDELIVERY.SAVE_NEW_EVENT",operation:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.SaveNewEvent"},{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_INFO",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.GetSearchInfo"},{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_RESULTS",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.GetSearchResults"},{operationId:"SFMSEARCHDELIVERY.GET_USERINFO",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.GetUserInfo"},{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.GetSearchResultLimitSettings"},{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_COUNT",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.GetSearchResultCount"},{operationId:"SFWDELIVERY.GET_WIZARD_INFO",operation:"com.servicemax.client.offline.sal.model.sfwdelivery.operations.GetWizardInfo"},{operationId:"SFMCREATEDELIVERY.GET_CREATE_PROCESSES_INFO",operation:"com.servicemax.client.offline.sal.model.sfmcreatedelivery.operations.GetCreateProcessInfo"},{operationId:"SFMCREATEDELIVERY.GET_RECENTS_INFO",operation:"com.servicemax.client.offline.sal.model.sfmcreatedelivery.operations.GetRecentsInfo"},{operationId:"SFMCREATEDELIVERY.ADD_TO_RECENTS",operation:"com.servicemax.client.offline.sal.model.sfmcreatedelivery.operations.AddToRecents"},{operationId:"SFMCREATEDELIVERY.GET_PROCESS_ID",operation:"com.servicemax.client.offline.sal.model.sfmcreatedelivery.operations.GetProcessId"},{operationId:"SFMCONSOLE.GET_USERINFO",operation:"com.servicemax.client.offline.sal.model.sfmconsole.operations.GetUserInfo"},{operationId:"SFMCONSOLE.RETRIEVE_DISPLAY_TAGS",operation:"com.servicemax.client.offline.sal.model.sfmconsole.operations.RetrieveDisplayTags"},{operationId:"SFMCONSOLE.RETRIEVE_ON_DEMAND_APP_SETTINGS",operation:"com.servicemax.client.offline.sal.model.sfmconsole.operations.RetrieveOnDemandAppSettings"},{operationId:"SFMCONSOLE.GET_APP_INFO",operation:"com.servicemax.client.offline.sal.model.sfmconsole.operations.GetAppInfo"},{operationId:"SFMDELIVERY.LIST_ATTACHMENTS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.ListAttachments"},{operationId:"SFMDELIVERY.LIST_OUTPUTDOC_ATTACHMENTS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.ListOutputDocAttachments"},{operationId:"SFMDELIVERY.DELETE_ATTACHMENTS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.DeleteAttachments"},{operationId:"SFMDELIVERY.EDIT_ATTACHMENT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.EditAttachment"},{operationId:"SFMDELIVERY.SHARE_ATTACHMENTS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.ShareAttachments"},{operationId:"SFMDELIVERY.ATTACH_FILE",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.AttachFile"},{operationId:"SFMDELIVERY.OPEN_FILE",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.OpenFile"},{operationId:"SFMDELIVERY.OPEN_BROWSER",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.OpenBrowser"},{operationId:"SFMDELIVERY.OPEN_TELEPHONE",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.OpenTelephone"},{operationId:"SFMDELIVERY.OPEN_SMS",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.OpenSMS"},{operationId:"SFMDELIVERY.OPEN_EMAIL",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.OpenEmail"},{operationId:"SFMDELIVERY.CHECK_IF_CONFLICT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.CheckIfConflict"},{operationId:"SFMDELIVERY.GET_CHECKLIST_ATTACHMENT_FILE_PATH",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetChecklistAttachmentFilePath"},{operationId:"SFMOPDOCDELIVERY.GET_USERINFO",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.GetUserInfo"},{operationId:"SFMOPDOCDELIVERY.GET_TEMPLATE",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.GetTemplate"},{operationId:"SFMOPDOCDELIVERY.GET_DOCUMENT_METADATA",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.GetDocumentMetadata"},{operationId:"SFMOPDOCDELIVERY.GET_DOCUMENT_DATA",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.GetDocumentData"},{operationId:"SFMOPDOCDELIVERY.DESCRIBE_OBJECT",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.DescribeObject"},{operationId:"SFMOPDOCDELIVERY.CAPTURE_SIGNATURE",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.CaptureSignature"},{operationId:"SFMOPDOCDELIVERY.FINALIZE",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.Finalize"},{operationId:"SFMOPDOCDELIVERY.SUBMIT_QUERY",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.SubmitQuery"},{operationId:"SFMOPDOCDELIVERY.GET_DISPLAY_TAGS",operation:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.GetDisplayTags"},{operationId:"SYNC.GET_SYNC_STATUS",operation:"com.servicemax.client.offline.sal.model.sync.operations.GetSyncStatus"},{operationId:"SFMSEARCHDELIVERY.GET_ONLINE_RESULTS",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.GetOnlineResults"},{operationId:"SFMSEARCHDELIVERY.DOWNLOAD_RECORD_ON_DEMAND",operation:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations.DownloadRecordOnDemand"},{operationId:"TOOLSPAGES.UPDATE_CONFLICT",operation:"com.servicemax.client.offline.sal.model.toolspages.operations.UpdateConflict"},{operationId:"TOOLSPAGES.GET_OUTPUT_DOCS_COUNT",operation:"com.servicemax.client.offline.sal.model.toolspages.operations.GetOutputDocsCount"},{operationId:"TOOLSPAGES.ALLOW_API_ACCESS",operation:"com.servicemax.client.offline.sal.model.toolspages.operations.AllowApiAccess"},{operationId:"TASKS.GET_TASKS_LIST",operation:"com.servicemax.client.offline.sal.model.tasks.operations.GetTasksList"},{operationId:"TASKS.MANAGE_TASK",operation:"com.servicemax.client.offline.sal.model.tasks.operations.ManageTask"},{operationId:"TROUBLESHOOTDELIVERY.GET_FEED_INFO",operation:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations.GetFeedInfo"},{operationId:"TROUBLESHOOTDELIVERY.SAVE_FEED_INFO",operation:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations.SaveFeedInfo"},{operationId:"TROUBLESHOOTDELIVERY.GET_PRODUCT_DOCUMENTS",operation:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations.GetProductDocuments"},{operationId:"TROUBLESHOOTDELIVERY.GET_PRODUCT_MANUAL",operation:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations.GetProductManual"},{operationId:"TROUBLESHOOTDELIVERY.DOWNLOAD_DOCUMENT_ON_DEMAND",operation:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations.DownloadDocumentOnDemand"},{operationId:"TROUBLESHOOTDELIVERY.GET_ALL_DOCUMENTS",operation:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations.GetAllDocuments"},{operationId:"RECENTS.ADD_RECENTS",operation:"com.servicemax.client.offline.sal.model.recents.operations.AddRecents"},{operationId:"RECENTS.GET_RECENTS",operation:"com.servicemax.client.offline.sal.model.recents.operations.GetRecents"},{operationId:"PRODUCTIQ.GET_TOP_LEVEL_IBS",operation:"com.servicemax.client.offline.sal.model.productiq.operations.GetTopLevelIBs"},{operationId:"PRODUCTIQ.GET_MORE_IBS",operation:"com.servicemax.client.offline.sal.model.productiq.operations.GetMoreIBs"},{operationId:"PRODUCTIQ.GET_DETAILPAGEINFO",operation:"com.servicemax.client.offline.sal.model.productiq.operations.GetDetalPageInfo"},{operationId:"PRODUCTIQ.GET_SEARCHPROCESSIB",operation:"com.servicemax.client.offline.sal.model.productiq.operations.GetSearchProcessIB"},{operationId:"PRODUCTIQ.GET_METADATA",operation:"com.servicemax.client.offline.sal.model.productiq.operations.GetMetadata"},{operationId:"PRODUCTIQ.GET_ALL_PARENT_IBS",operation:"com.servicemax.client.offline.sal.model.productiq.operations.GetAllParentIBs"},{operationId:"PRODUCTIQ.FIND_TA_TEMPLATE_FOR_SELECTD_IB",operation:"com.servicemax.client.offline.sal.model.productiq.operations.FindTechnicalAttributeTemplateForIB"},{operationId:"PRODUCTIQ.SAVE_TA_TEMPLATE_INSTANCE_FOR_SELECTD_IB",operation:"com.servicemax.client.offline.sal.model.productiq.operations.SaveTechnicalAttributeTemplateInstanceForIB"},{operationId:"PRODUCTIQ.UPDATE_TA_TEMPLATE_FOR_SELECTD_IB",operation:"com.servicemax.client.offline.sal.model.productiq.operations.UpdateTechnicalAttributeTemplateForIB"},{operationId:"PRODUCTIQ.FIND_SELECTED_IB_IN_LOCAL_DB",operation:"com.servicemax.client.offline.sal.model.productiq.operations.FindIBRecordDetailsInLocalDB"},{operationId:"PRODUCTIQ.DELETE_RECORDS",operation:"com.servicemax.client.offline.sal.model.productiq.operations.DeleteRecords"},{operationId:"PRODUCTIQ.UPDATE_IB_HIERARCHY",operation:"com.servicemax.client.offline.sal.model.productiq.operations.UpdateIBHierarchy"},{operationId:"PRODUCTIQ.FIND_TA_TEMPLATE_HISTORY_FOR_SELECTD_IB",operation:"com.servicemax.client.offline.sal.model.productiq.operations.FindTechnicalAttributeHistoryTemplateForIB"},{operationId:"MOBILEINVENTORY.GET_META_DATA",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetMetadata"},{operationId:"MOBILEINVENTORY.GET_TRUNK_STOCK_SEARCH_RESULTS",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetTrunkStockSearchResults"},{operationId:"MOBILEINVENTORY.GET_CATALOG_SEARCH_RESULTS",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetCatalogSearchResults"},{operationId:"MOBILEINVENTORY.GET_PRODUCT_STOCK",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetProductStock"},{operationId:"MOBILEINVENTORY.GET_PRODUCT_IMAGE",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetProductImage"},{operationId:"MOBILEINVENTORY.GET_TECHNICIAN_RECORDS",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetTechnicianRecords"},{operationId:"MOBILEINVENTORY.GET_LOCATE_PART_SEARCH_RESULTS",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.GetLocatePartSearchResults"},{operationId:"MOBILEINVENTORY.STOCK_TRANSFER",operation:"com.servicemax.client.offline.sal.model.mobileinventory.operations.StockTransfer"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_DATA_FOR_QUERY_OBJECT",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetDataForQueryObject"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_CLIENT_TYPE",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.getClientType"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_USER_LANGUAGE",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.getUserLanguage"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_EVENT_INFO",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.getEventInfoForCustomSnippet"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_RECORD",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.getSfmRecordForCustomSnippet"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_PICKLIST_VALUES",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.GetPicklistValuesForCustomSnippet"},{operationId:"SFMDELIVERY.CUSTOMSNIPPET.SET_SFM_FIELD_VALUE",operation:"com.servicemax.client.offline.sal.model.sfmdelivery.operations.SetFieldValueForCustomSnippet"}]}}}),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.sync.extensions.SFMObjectFieldExtension","event":"com.servicemax.client.sync.extensions"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.sync.extensions.InstallBaseExtension","event":"com.servicemax.client.sync.extensions"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.utils.SetupNameFieldExtension","event":"com.servicemax.client.onFrameworkLoad"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.utils.SetupTableIdPrefixExtension","event":"com.servicemax.client.onFrameworkLoad"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.utils.SetupTableInDBExtension","event":"com.servicemax.client.onFrameworkLoad"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.utils.CacheRecordTypeIdsExtension","event":"com.servicemax.client.onFrameworkLoad"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.utils.CacheObjectsWithViewProcessesExtension","event":"com.servicemax.client.onFrameworkLoad"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.utils.SynchronousDbExtension","event":"com.servicemax.client.onFrameworkLoad"}}')),L.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.offline.sal.model.sync.extensions.SFObjectFieldPopulateExtension","event":"com.servicemax.client.sync.extensions"}}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.platformspecifics","class-name":"com.servicemax.client.offline.sal.model.impl.PlatformSpecifics"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.sfw.platformspecifics","class-name":"com.servicemax.client.offline.sal.model.sfwdeliveryutils.PlatformSpecifics"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.sfmsearch.platformspecifics","class-name":"com.servicemax.client.offline.sal.model.sfmsearch.utils.impl.PlatformSpecifics"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.sfmcreate.platformspecifics","class-name":"com.servicemax.client.offline.sal.model.sfmcreateutils.PlatformSpecifics"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.sfmevent.platformspecifics","class-name":"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations.PlatformSpecifics"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.sfmopdoc.platformspecifics","class-name":"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations.PlatformSpecifics"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.offline.sal.service.factory","class-name":"com.servicemax.client.offline.sal.model.impl.ServiceManagerFactory"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.offline.sal.service.placeholder","class-name":"com.servicemax.client.offline.sal.model.impl.Placeholder"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.storageprovider","class-name":"com.servicemax.client.offline.sal.model.impl.StorageProvider"}')),L.registerService(JSON.parse('{"id":"com.servicemax.client.attachmentnotifications","class-name":"com.servicemax.client.offline.sal.model.impl.AttachmentNotificationService"}')),L.registerDefinition({type:"com.servicemax.client.extension",config:{"class-name":"com.servicemax.client.offline.sal.model.checklist.extensions.ChecklistAttachmentExtension",event:"com.servicemax.client.checklist.attachment.extension"}}),e.exports={impl:i,nativeservice:a,sfmdeliveryoperations:r,utils:o,sfmeventdeliveryoperations:s,sfmsearchdeliveryoperations:l,sfmsearchutils:c,sfwdeliveryoperations:u,sfwdeliveryutils:d,sfmcreatedeliveryoperations:_,sfmcreateutils:h,sfmconsoleoperations:f,sfmopdocdeliveryoperations:p,sfmopdocdeliveryutils:m,syncextensions:v,syncoperations:g,toolspagesoperations:y,tasksoperations:S,recentsoperations:E,troubleshootdeliveryoperations:b,sfchatterfeedutils:T,targetrecord:M,productiqoperations:I,productiqoperationutils:C,multiversionbehavior:A,mobileinventoryoperations:D,mobileinventoryutils:x,apptoappoperation:R,checklistextensions:O}},function(e,t,n){e.exports={default:n(675),__esModule:!0}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(16),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=n(30),y=i(g),S=n(10),E=n(0).utils,b=n(5).ExtensionRunner,T=n(101).SQLSchema,M=n(56),I=(n(11).Facade,n(7).ServerInfo),C=n(7).Cache,A={name:"com.servicemax.client.sync.syncpiq"},D=A;(0,y.default)(D,M),D.SyncPiqSettingsLocalDb=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){this.getPiQSettingValue(function(e){this.getPiQTechAttrSettingValue(function(t){this.getPiqLastDataSyncTime(function(n){this._setState("PIQ_ENABLED_FOR_INITIAL_SYNC",e),this._setState("PIQ_TECH_ATTR_ENABLED_FOR_INITIAL_SYNC",t),this._setState("PIQ_LAST_SYNC_TIME",n)})}),T.tables.Sync_Records_Heap||this._ensureTableExists("Sync_Records_Heap",function(){this.__logger.info("Sync_Records_Heap created")})})}},{key:"getPiQSettingValue",value:function(e){var t=this,n=!1,i="MobileDeviceSettings";t._tempTableCreated(i)&&(i=E.getTempTableName(i));var a="SELECT setting_id, value FROM "+i+" WHERE setting_id IN ('PRODIQ002_SET001')";t._initSQLServiceRequest({query:a},{handler:function(t){if(t&&t.length){var i=t[0];n="True"===i.value||"true"===i.value||!0===i.value}e&&e.call(this,n)},context:t})}},{key:"getPiQTechAttrSettingValue",value:function(e){var t=this,n=!1,i="",a="Configuration";t._tempTableCreated(a)&&(a=E.getTempTableName(a)),i="SELECT value FROM "+a+" where type='user' ",t._initSQLServiceRequest({query:i},{handler:function(i){if(i&&i.length){var a=JSON.parse(i[0].Value);a=a||{};var r=a.isTechnicalAttributesEnabled;r&&(n=!("True"!==r&&"true"!==r&&!0!==r));var o=a.attachment;if(o){var s=o.length?o[0].isAttachmentsEnabled&&o[0].isAttachmentsEnabled.toLowerCase():"false";t._setState("PIQ_AttachmentEnabled",s)}}e&&e.call(this,n)},context:t})}},{key:"getPiqLastDataSyncTime",value:function(e,t){var n=this,i="ClientCache";n._tempTableCreated(i)&&(i=E.getTempTableName(i));var a="SELECT value FROM "+i+" WHERE key = 'LastDataSyncTime'";n._initSQLServiceRequest({query:a},{handler:function(i){var a=i.length?i[0].value:"";e.call(t||n,a)},context:n})}}]),t}(D.SyncEvent),D.SyncPiqInitial=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"getSyncManagerRef",value:function(){return this.getSyncManager()}},{key:"isPiQEnabled",value:function(){return this.getSyncManagerRef().isProductIQEnabled()}},{key:"trigger",value:function(e){e.length?e&&this._getPiqObjectDescribe(e):this.__logger.error("No objects availble to perform ObjectDescribe")}},{key:"_getPiqObjectDescribe",value:function(e){function t(){var e=n._getState("PIQ_TABLES_DESCRIBED");if(e.length>0){new b.run(n.getSyncManagerRef(),"com.servicemax.client.sync.extensions",{tables:e,extensionClassName:"com.servicemax.client.offline.sal.model.sync.extensions.SFObjectFieldPopulateExtension"}).then(function(){n.__logger.info("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.SFObjectFieldPopulateExtension for PIQ to populate SObjectField Table")})}}for(var n=this,i=1,a=0;a<e.length;a++){var r=e[a];this._ensureSObjectTableExists(r,!0,function(n){++i===e.length&&t()})}}},{key:"_initPiqHttpServiceRequest",value:function(e,t){var n="/services/apexrest/{{OrgNamespace}}/svmx/rest/ProductIQServiceIntf/"+e+"/9.0/";n=E.string.substitute(n,{OrgNamespace:E.OrgNamespace});var i={uri:n,method:"POST"};this._initHTTPServiceRequest(i,{handler:t,context:this})}},{key:"_performTXFetch",value:function(e,t,n){var i=e.map(function(e){var t=(0,s.default)(e)[0],n=void 0;return n=Array.isArray(e[t])?e[t]:Array(e[t]),{value:t,values:n}});this._commonSyncObjectRecords(i,n||this.piqActionType||"insert",t)}},{key:"getPiQSetting",value:function(){return this._getState("PIQ_ENABLED_FOR_INITIAL_SYNC")}},{key:"getPiqAttchmentSetting",value:function(){return this._getState("PIQ_AttachmentEnabled")}},{key:"getPiqFileSetting",value:function(){return!!I.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&this.getPiqAttchmentSetting()}},{key:"getTechAttrSetting",value:function(){return this._getState("PIQ_TECH_ATTR_ENABLED_FOR_INITIAL_SYNC")}},{key:"getPiqLastSyncTime",value:function(){return this._getState("PIQ_LAST_SYNC_TIME")}},{key:"getPiqTableName",value:function(e){return this._tempTableCreated(e)&&(e=E.getTempTableName(e)),e}}]),t}(D.SyncEvent),D.PiqDataSync=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.piqActionType="insert",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e,t){var n=this;n.piqActionType=t||"insert",this.installedProductFieldRef={},this.installedProductFields=function(){return[E.getCustomObjectName("Company"),E.getCustomObjectName("Product"),E.getCustomObjectName("Site"),E.getCustomObjectName("Top_Level")]}();var i=this.installedProductFields.join("','"),a="SELECT object_api_name as object_name, api_name, reference_to, relationship_name FROM SFObjectField sField WHERE sField.object_api_name = '{{tableName}}' AND api_name  IN ('"+i+"')",r={tableName:E.getCustomObjectName("Installed_Product")};a=E.string.substitute(a,r),this.__serviceRequestCount++,n._initSQLServiceRequest({query:a},{handler:function(t){if(this.__serviceRequestCount--,t.length)for(var i=0;i<t.length;i++){var r=t[i];n.installedProductFieldRef[r.api_name]=r.reference_to}n.__logger.info("Api Name Query for IB reference Fields & Results: "+a,n.installedProductFieldRef),this.__serviceRequestCount++,n.buildAndTriggerRequest(e,n.piqActionType)},context:this})}},{key:"buildAndTriggerRequest",value:function(e,t){var n=this,i=n._getPiqRequest();if(i.data.valueMap.push({key:"LAST_INDEX",value:"0"}),e&&e.length)for(var a=0;a<e.length;a++)i.data.valueMap.push(e[a]);n._initHTTPServiceRequest(i,{handler:n._handlePiqData,context:n})}},{key:"_getPiqRequest",value:function(){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_PRODUCTIQ_DATA",value:this._getClientId(),valueMap:[]}}}},{key:"_handlePiqData",value:function(e){function t(){for(var e=[],t=0;t<n.installedProductFields.length;t++){var i=n.installedProductFields[t],a={},r=n.installedProductFieldRef[i];r&&(a[r]=[],e.push(a))}return e}var n=this,i=this._parseResponse(e);this.__serviceRequestCount--;var a=i[E.getCustomObjectName("Site")],r=i[E.getCustomObjectName("Installed_Product")],o=[],s=[],l={},c=this._getState("SYNC_TXFETCH_IDS")||[];a&&(o=function(e){var t={},n=[],i=[];if(e.values.length){for(var r=0;r<e.values.length;r++)-1===c.indexOf(e.values[r])&&(i.push(e.values[r]),c.push(e.values[r]));t[a.key]=i,n.push(t)}return n}(a)),r&&(l=JSON.parse(r.value),function(){s=t();for(var e=[],i=0;i<l.length;i++){var a=l[i];-1===c.indexOf(a.Id)&&(e.push(a.Id),c.push(a.Id));for(var r=0;r<n.installedProductFields.length;r++){var u=n.installedProductFields[r],d=n.installedProductFieldRef[u];d&&(s[r][d]=s[r][d]||[],a[u]&&d&&-1===c.indexOf(a[u])&&(s[r][d].push(a[u]),c.push(a[u])))}}for(var _=E.getCustomObjectName("Installed_Product"),h=E.getCustomObjectName("Site"),f=0;f<s.length;f++)if(s[f].hasOwnProperty(_)&&e.length)n.__logger.info("Installed_Product Record Count:"+e.length),n.__logger.info("Installed_Product from Reference :"+s[f][_].length),s[f][_]=s[f][_].concat(e);else if(s[f].hasOwnProperty(h)&&o.length){var p=o[0][h];p&&p.length&&(s[f][h]=s[f][h].concat(p))}}()),r?n._processRecords(s,i):a&&n._processRecords(o,i),this._setState("SYNC_TXFETCH_IDS",c)}},{key:"_processRecords",value:function(e,t){var n=this;e.length?this._performTXFetch(e,function(){n._triggerCallBack(!0,t)},this.piqActionType):n._triggerCallBack(!1,t)}},{key:"_triggerCallBack",value:function(e,t){var n=t.CALL_BACK;if(n){var i=n.value,a=t.LAST_INDEX.value;if("true"===i){this.__serviceRequestCount++;var r=this._getPiqRequest();"ONECALLSYNC"===this.getSyncType()&&r.data.valueMap.push({key:"PRODUCTIQ_LAST_SYNC",value:this.lastSyncTime}),r.data.valueMap.push({key:"LEVEL",value:t.LEVEL.value},{key:"LAST_INDEX",value:t.LAST_INDEX.value},t.CALL_BACK),this._initHTTPServiceRequest(r,{handler:this._handlePiqData,context:this})}else"false"!==i||"1"!==a&&"2"!==a||this._siteStatus&&this._ibStatus&&this._woSiteStatus||(this._siteStatus||"1"!==a?this._woSiteStatus||"2"!==a?(this.__serviceRequestCount--,this._ibStatus=!0,this._piqDataCompleted(t)):(this._woSiteStatus=!0,this._requestInstalledProductIds(t)):(this._siteStatus=!0,this._requestInstalledProductIds(t)))}else e||this.__serviceRequestCount--}},{key:"_requestInstalledProductIds",value:function(e){var t=this._getPiqRequest();"ONECALLSYNC"===this.getSyncType()&&t.data.valueMap.push({key:"PRODUCTIQ_LAST_SYNC",value:this.lastSyncTime}),t.data.valueMap.push({key:"LAST_INDEX",value:e.LAST_INDEX.value}),this.__serviceRequestCount++,this._initHTTPServiceRequest(t,{handler:this._handlePiqData,context:this})}},{key:"_piqDataCompleted",value:function(e){var t=e.PRODUCTIQ_LAST_SYNC.value;this._setState("LastDataSyncTime",t)}},{key:"_parseResponse",value:function(e){if(!(e&&e.valueMap&&e.valueMap.length))return{};for(var t={},n=0;n<e.valueMap.length;n++){var i=e.valueMap[n];if(i){t[i.key]=i}}return t}}]),t}(D.SyncPiqInitial),D.PiqObjectDescribeInitial=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this,t=e.getPiQSetting(),n=e.getTechAttrSetting();e.performDescribe(t,n)}},{key:"performDescribe",value:function(e,n){var i=this,a=[];if(e){var o=["Account","Product2",E.getCustomObjectName("Site"),E.getCustomObjectName("Installed_Product")];for(var s in o){var l=o[s];this._getState("DESCRIBED."+l)&&o.splice(s,1)}if(a=a.concat(o),n){var u=[E.getCustomObjectName("SM_IB_Attributes_History"),E.getCustomObjectName("SM_Attributes_Template"),E.getCustomObjectName("SM_Product_Attributes"),E.getCustomObjectName("SM_IB_Attributes_Template_Instance")];a=a.concat(u)}else i.__logger.info("Product IQ Status:"+e+" Technical Attribute Status:"+n)}a.length>0?(i._setState("PIQ_TABLES_DESCRIBED",a),(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this,a)):i.__logger.error("PIQ is not enabled to perform ObjectDescribe -Setting piQEnabled value is :"+e+"  ::Setting techAttributeEnabled value is:"+n)}}]),t}(D.SyncPiqInitial),D.PiqUserConfiguration=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){this.__serviceRequestCount++,this._initPiqHttpServiceRequest("getUserConfiguration",function(e){this.__serviceRequestCount--,this._insertMetadata("Configuration",[{Type:"user",Value:E.toJSON(e)}])})}}]),t}(D.SyncPiqInitial),D.PiqObjectDescribeForDependentPicklistBase=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){this._initSQLServiceRequest({query:"SELECT DISTINCT object_api_name FROM 'SFObjectField' of WHERE ( (of.dependent_picklist = 'true' ) )"},{handler:function(e){if(e&&e.length)for(var t=e.map(function(e){return e.object_api_name}),n=0;n<t.length;n++)this._ensureSObjectDescribeExists(t[n])},context:this})}}]),t}(D.SyncPiqInitial),D.PiqObjectDescribeForDependentPickListInitial=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){this.getPiQSetting()&&(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this)}}]),t}(D.PiqObjectDescribeForDependentPicklistBase),D.PiqDeletedProductIqData=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this,t=e.getPiQSetting(),n=e.getPiqLastSyncTime();if(t&&n){var i={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"GET_DELETE_PRODUCTIQ_DATA",value:this._getClientId(),valueMap:[{key:"LAST_INDEX",value:"0"},{key:"PRODUCTIQ_LAST_SYNC",value:n}]}};e._initHTTPServiceRequest(i,{handler:function(t){for(var n=[],i=0;i<t.valueMap.length;i++){for(var a=t.valueMap[i],r=JSON.parse(a.value),o=[],s=0;s<r.length;s++)o.push(r[s].Id);n.push({tableName:a.key,recordIds:o})}for(var l=!1,c=!1,u=[],d=E.getCustomObjectName("Installed_Product"),i=0;i<n.length;i++){var a=n[i];a.recordIds.length&&(e._deleteRecord(e.getPiqTableName(a.tableName),a.recordIds,function(){a.tableName===e.getPiqTableName("Product2")&&(l=!0),a.tableName===d&&(c=!0,u=a.recordIds)}()),e._deleteSyncRecord(a.recordIds),e._deleteSyncRecord(a.recordIds,!0))}if(c){e.__logger.info("Delete related attributes for the IB");var _="com.servicemax.client.offline.sal.model.sync.extensions.PurgeIBRelatedRecords",h="com.servicemax.client.sync.extensions";new b.run(e.getSyncManager(),h,{extensionClassName:_,ibRecordIds:u,context:e}).then(function(){e.__logger.info("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.PurgeIBRelatedRecords")})}if(l){e.__logger.info("Delete related attributes for the product");var _="com.servicemax.client.offline.sal.model.sync.extensions.PurgePiqTechnicalAttributeRelatedRecords",h="com.servicemax.client.sync.extensions";new b.run(e.getSyncManager(),h,{syncEvent:e,extensionClassName:_}).then(function(){e.__logger.info("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.PurgePiqTechnicalAttributeRelatedRecords")})}}})}}}]),t}(D.SyncPiqInitial),D.PiqDataInitial=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this.__serviceRequestCount++;var n=e.getPiQSetting();e.getTechAttrSetting();n?(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this,{},"insert"):this.__serviceRequestCount--}}]),t}(D.PiqDataSync),D.PiqDataIncremental=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this.__serviceRequestCount++;var n=e.getPiQSetting(),i=e.getPiqLastSyncTime();if(n)if(i){var a=[{}];a[0]={key:"PRODUCTIQ_LAST_SYNC",value:i},this.lastSyncTime=i,this.piqActionType="update.incremental",(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this,a,"update.incremental")}else(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this,{},"update.incremental");else this.__serviceRequestCount--}}]),t}(D.PiqDataSync),D.PiqTechnicalAttributesInitial=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.actionMode="insert",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"parseAndGetRecordIds",value:function(e,t){var n=[],i=e.values;return i.length>0&&n.push({value:t,values:i}),n}},{key:"parseAndGetRecordIdsFromValue",value:function(e,t){var n=[],i=E.toObject(e.value);return i.length>0&&n.push({value:t,values:i}),n}},{key:"handleDeletedAttributeRecords",value:function(e){for(var t=this,n=0;n<e.length;n++){var i=e[n],a=i.values,r=i.value;a.length>0&&(t._deleteRecord(t.getPiqTableName(r),a),t._deleteSyncRecord(a),t._deleteSyncRecord(a,!0))}}},{key:"_parseResponse",value:function(e){if(!(e&&e.valueMap&&e.valueMap.length))return{};for(var t={},n=0;n<e.valueMap.length;n++){var i=e.valueMap[n];if(i){t[i.key]=i}}return t}}]),t}(D.SyncPiqInitial),D.PiqProductAttributeDataInitialWin17=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e._productAttributeResponse=null,e.actionMode="insert",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){var t=this;this.__serviceRequestCount++;var n=t.getPiQSetting(),i=t.getTechAttrSetting();t.makeProductAttributeRequest(n,i,e)}},{key:"makeProductAttributeRequest",value:function(e,t,n){var i=this;if(e&&t){var a=i._getTechAttrRequest();if(n&&n.length)for(var r=0;r<n.length;r++)a.data.valueMap.push(n[r]);i._initHTTPServiceRequest(a,{handler:i._handleProductAttributeData})}else this.__serviceRequestCount--,console.error("Product IQ Status:"+e+" Technical Attribute Status:"+t)}},{key:"_getTechAttrRequest",value:function(){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_PRODUCTIQ_PRODUCT_ATTR",value:this._getClientId(),valueMap:[]}}}},{key:"_handleProductAttributeData",value:function(e,t){var n=this;this.__serviceRequestCount--;var i=e.message;i&&console.error("PiqProductAttributeDataInitial: Message Attribute Received in Response:",i),n._productAttributeResponse=this._parseResponse(e);var a=[],r=n._productAttributeResponse.ATTRIBUTE_TEMPLATE,o=n._productAttributeResponse.PRODUCT_ATTRIBUTE,s=n._productAttributeResponse.PRODUCT_ATTRIBUTE_DELETED,l=n._productAttributeResponse.ATTRIBUTE_TEMPLATE_DELETED,c=n._productAttributeResponse.CALL_BACK,u=E.getCustomObjectName("SM_Attributes_Template"),d=E.getCustomObjectName("SM_Product_Attributes");if(r){var _=n.parseAndGetRecordIds(r,u);a=a.concat(_)}if(o){var h=n.parseAndGetRecordIds(o,d);a=a.concat(h)}if(s){var f=n.parseAndGetRecordIds(s,d);n.handleDeletedAttributeRecords(f)}if(l){var p=n.parseAndGetRecordIds(l,u);n.handleDeletedAttributeRecords(p)}a.length>0?n._commonSyncObjectRecords(a,n.actionMode,function(e){c&&n._triggerCallBack(c)}):c?n._triggerCallBack(c):this.__serviceRequestCount--}},{key:"_triggerCallBack",value:function(e){var t=this;if("true"===e.value){this.__serviceRequestCount++;var n=this._getTechAttrRequest();n.data.valueMap.push(e),t._initHTTPServiceRequest(n,{handler:function(e){t._handleProductAttributeData(e,"callbackMode")},context:this})}else this.__serviceRequestCount--}}]),t}(D.PiqTechnicalAttributesInitial),D.PiqProductAttributeDataInitial=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e._productAttributeResponse=null,e.actionMode="insert",e.__batchSizeForProdIDs=1e4,e.__numberOfProdEntries=0,e.__productTableName="Product2",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){var t=this.getPiQSetting(),n=this.getTechAttrSetting();this._processProductAttributeRequest(t,n,e)}},{key:"_processProductAttributeRequest",value:function(e,t,n){var i=this;e&&t?(i._tempTableCreated(i.__productTableName)&&(i.__productTableName=E.getTempTableName(i.__productTableName)),i._initSQLServiceRequest({query:"SELECT COUNT(*) AS count FROM "+i.__productTableName},{handler:function(e){e&&e.length&&(i.__numberOfProdEntries=e[0].count,i._processProductIDsInBatches(n))},context:i})):i.__logger.error("Product IQ Status:"+e+" Technical Attribute Status:"+t)}},{key:"_processProductIDsInBatches",value:function(e){var t=this,n=0,i=parseInt(Math.ceil(t.__numberOfProdEntries/t.__batchSizeForProdIDs))||0;t.__logger.info(" Possible batch count "+i);do{!function(e,n){var i=e*t.__batchSizeForProdIDs,a="SELECT DISTINCT Id FROM "+t.__productTableName+" LIMIT "+t.__batchSizeForProdIDs+" OFFSET "+i;t.__logger.info(" Query => "+a),t._initSQLServiceRequest({query:a},{handler:function(i){t.__logger.info("No of Product IDs: "+i.length+", Batch no: "+(e+1));var a=i.map(function(e){return e.Id});if(a&&a.length>0){var r=E.cloneObject(n||[]);r.push({key:"Object_Name",value:"Product2",values:a}),t._makeProductAttributeRequest(r)}},context:t})}(n++,e)}while(i>n)}},{key:"_getTechAttrRequest",value:function(e){var t={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_PRODUCT_TEMPLATES",value:this._getClientId(),valueMap:[]}};if(e&&e.length)for(var n=0;n<e.length;n++)t.data.valueMap.push(e[n]);return t}},{key:"_makeProductAttributeRequest",value:function(e){var t=this,n=t._getTechAttrRequest(e);t._initHTTPServiceRequest(n,{handler:t._handleProductAttributeData,context:t})}},{key:"_handleProductAttributeData",value:function(e,t){var n=this,i=e.message;i&&n.__logger.error("PiqProductAttributeDataInitial: Message Attribute Received in Response:"+i),n._productAttributeResponse=this._parseResponse(e);var a=[],r=n._productAttributeResponse.ATTRIBUTE_TEMPLATE,o=n._productAttributeResponse.PRODUCT_ATTRIBUTE,s=n._productAttributeResponse.PRODUCT_ATTRIBUTE_DELETED,l=n._productAttributeResponse.ATTRIBUTE_TEMPLATE_DELETED,c=n._productAttributeResponse.PRODUCT_LASTID,u=n._productAttributeResponse.PRODUCTATTR_LASTID,d=[];if(c&&c.key&&c.value&&d.push({key:c.key,value:c.value}),u&&u.key&&u.value&&d.push({key:u.key,value:u.value}),d&&d.length>0)for(var _=0;_<t.data.valueMap.length;_++)if(console.warn("Callback key: "+t.data.valueMap[_].key+", value: "+t.data.valueMap[_].value+", values: "+t.data.valueMap[_].values),"Object_Name"===t.data.valueMap[_].key){var h=t.data.valueMap[_].values;d.push({key:"Object_Name",value:"Product2",values:h})}else"LAST_SYNC_TIME"===t.data.valueMap[_].key&&d.push(t.data.valueMap[_]);var f=E.getCustomObjectName("SM_Attributes_Template"),p=E.getCustomObjectName("SM_Product_Attributes");if(r){var m=n.parseAndGetRecordIdsFromValue(r,f);a=a.concat(m)}if(o){var v=n.parseAndGetRecordIdsFromValue(o,p);a=a.concat(v)}if(s){var g=n.parseAndGetRecordIdsFromValue(s,p);n.handleDeletedAttributeRecords(g)}if(l){var y=n.parseAndGetRecordIdsFromValue(l,f);n.handleDeletedAttributeRecords(y)}a.length>0?n._commonSyncObjectRecords(a,n.actionMode,function(e){d&&d.length>0&&n._triggerCallBack(d)}):d&&d.length&&n._triggerCallBack(d)}},{key:"_triggerCallBack",value:function(e){var t=this,n=this._getTechAttrRequest(e);t._initHTTPServiceRequest(n,{handler:t._handleProductAttributeData,context:t})}}]),t}(D.PiqTechnicalAttributesInitial),D.SyncPiqGetLocalTopLevelIbs=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this,t=e.getPiQSetting(),n=e.getTechAttrSetting();t&&n&&(this.__serviceRequestCount++,this.getTopLevelIbs(function(e){this._setState("PIQ_LOCAL_TOP_LEVEL_IBS",e),this.__serviceRequestCount--}))}},{key:"getTopLevelIbs",value:function(e){var t=this,n=E.getCustomObjectName("Installed_Product");t._tempTableCreated(n)&&(n=E.getTempTableName(n));var i={columnName:E.getCustomFieldName("Top_Level"),tableName:n},a=E.string.substitute("select Id from {{tableName}} where {{columnName}} IS NULL OR {{columnName}}='' ",i);this.__serviceRequestCount++,t._initSQLServiceRequest({query:a},{handler:function(t){this.__serviceRequestCount--;var n=t.map(function(e){return e.Id});e&&e.call(this,n)},context:t})}}]),t}(D.SyncPiqInitial),D.PiqIBAttributeDataInitial=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e._ibAttributeResponse=null,e.topLevelIbs=null,e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){var t=this;e=e||[],this.__serviceRequestCount++;var n=t.getPiQSetting(),i=t.getTechAttrSetting();t.makeIbAttributeRequest(n,i,e)}},{key:"makeIbAttributeRequest",value:function(e,t,n){var i=this;if(e&&t){var a=i._getTechAttrRequestForIB();if(i.topLevelIbs=this._getState("PIQ_LOCAL_TOP_LEVEL_IBS"),n.push({key:"TOP_LEVEL_IB_IDS",values:i.topLevelIbs}),n&&n.length)for(var r=0;r<n.length;r++)a.data.valueMap.push(n[r]);i._initHTTPServiceRequest(a,{handler:i._handleIBAttributeData,context:i})}else this.__serviceRequestCount--,i.__logger.error("Product IQ Status:"+e+" Technical Attribute Status:"+t)}},{key:"_getTechAttrRequestForIB",value:function(){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_PRODUCTIQ_IB_ATTR",value:this._getClientId(),valueMap:[]}}}},{key:"_handleIBAttributeData",value:function(e,t){var n=this;this.__serviceRequestCount--,n._ibAttributeResponse=this._parseResponse(e);var i=e.message;i&&n.__logger.error("PiqIBAttributeDataInitial Message Attribute Received in Response:",i);var a=[],r=n._ibAttributeResponse.IB_ATTRIBUTE_HISTORY,o=n._ibAttributeResponse.IB_ATTRIBUTE,s=n._ibAttributeResponse.IB_ATTRIBUTE_HISTORY_DELETED,l=n._ibAttributeResponse.IB_ATTRIBUTE_DELETED,c=n._ibAttributeResponse.CALL_BACK,u=E.getCustomObjectName("SM_IB_Attributes_History"),d=E.getCustomObjectName("SM_IB_Attributes_Template_Instance");if(r){var _=n.parseAndGetRecordIds(r,u);a=a.concat(_)}if(o){var h=n.parseAndGetRecordIds(o,d);a=a.concat(h)}if(s){var f=n.parseAndGetRecordIds(s,u);n.handleDeletedAttributeRecords(f)}if(l){var p=n.parseAndGetRecordIds(l,d);n.handleDeletedAttributeRecords(p)}a.length>0?n._commonSyncObjectRecords(a,n.actionMode,function(){c&&n._triggerCallBack(c)}):c?n._triggerCallBack(c):this.__serviceRequestCount--}},{key:"_triggerCallBack",value:function(e){var t=this;if("true"===e.value){var n=this._getTechAttrRequestForIB();n.data.valueMap.push(e),n.data.valueMap.push({key:"TOP_LEVEL_IB_IDS",values:t.topLevelIbs}),this.__serviceRequestCount++,this._initHTTPServiceRequest(n,{handler:function(e){t._handleIBAttributeData(e,"callbackMode")},context:this})}}}]),t}(D.PiqTechnicalAttributesInitial),D.PiqProductAttributeDataIncrementalWin17=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.actionMode="update.incremental",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){var t=this;this.__serviceRequestCount++;var n=t.getPiQSetting(),i=t.getTechAttrSetting(),a=t.getPiqLastSyncTime();n?(e=e||[],a&&e.push({key:"PRODUCTIQ_LAST_SYNC",value:a}),t.makeProductAttributeRequest.call(t,n,i,e)):this.__serviceRequestCount--}}]),t}(D.PiqProductAttributeDataInitialWin17),D.PiqProductAttributeDataIncremental=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.actionMode="update.incremental",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){var t=this,n=t.getPiQSetting(),i=t.getTechAttrSetting(),a=t.getPiqLastSyncTime();n&&(e=e||[],a&&e.push({key:"LAST_SYNC_TIME",value:a}),t._processProductAttributeRequest.call(t,n,i,e))}}]),t}(D.PiqProductAttributeDataInitial),D.PiqIBAttributeDataInitialIncremental=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.actionMode="update.incremental",e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){var t=this;this.__serviceRequestCount++;var n=t.getPiQSetting(),i=t.getTechAttrSetting(),a=t.getPiqLastSyncTime();n?(e=e||[],a&&e.push({key:"PRODUCTIQ_LAST_SYNC",value:a}),t.makeIbAttributeRequest.call(t,n,i,e)):this.__serviceRequestCount--}}]),t}(D.PiqIBAttributeDataInitial),D.PiqAttachmentSync=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__batchSize=200,e.__currentPageOfIbEntries=null,e.__numberOfIbs=0,e.__currentPageOfSiteEntries=null,e.__numberOfSites=0,e.__currentPageOfCurrentSyncIbEntries=null,e.__numberOfCurrentSyncIbs=0,e.__currentPageOfCurrentSyncSiteEntries=null,e.__numberOfCurrentSyncSites=0,e.sendLastSyncTime=!1,e.isIncrementalSync=!1,e.__sqlFields=[],e.__sfSqlFields=["Id","parent_id","created_by_id","name","file_path","description","content_type","content_length","downloaded","last_modified_date"],e.__objectNames={},e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){function e(){var e=E.Deferred(),t="SELECT COUNT(*) AS count FROM "+a.getPiqTableName(a.__objectNames.ib);return a._initSQLServiceRequest({query:t},{handler:function(t){a.__numberOfIbs=t[0].count,a.__logger.info("getTotalIbs Total IBS = "+a.__numberOfIbs+"fetched from "+a.__objectNames.ib),a.__numberOfIbs&&(a.__currentPageOfIbEntries=0),e.resolve()},context:a}),e}function t(){var e=E.Deferred(),t="SELECT COUNT(*) AS count FROM "+a.getPiqTableName(a.__objectNames.site);return a._initSQLServiceRequest({query:t},{handler:function(t){a.__numberOfSites=t[0].count,a.__logger.info("getTotalSites Total sites = "+a.__numberOfSites+"fetched from "+a.__objectNames.site),a.__numberOfSites&&(a.__currentPageOfSiteEntries=0),e.resolve()},context:a}),e}function n(){var e=E.Deferred(),t="SELECT COUNT(*) AS count FROM "+a.getPiqTableName("Sync_Records_Heap")+" WHERE ObjectName = '"+E.getCustomFieldName("Installed_Product")+"'";return a._initSQLServiceRequest({query:t},{handler:function(t){a.__numberOfCurrentSyncIbs=t[0].count,a.__logger.info("getTotalIbsOfCurrentSync Total IBS = "+a.__numberOfCurrentSyncIbs),a.__numberOfCurrentSyncIbs&&(a.__currentPageOfCurrentSyncIbEntries=0),e.resolve()},context:a}),e}function i(){var e=E.Deferred(),t="SELECT COUNT(*) AS count FROM "+a.getPiqTableName("Sync_Records_Heap")+" WHERE ObjectName = '"+E.getCustomFieldName("Site")+"'";return a._initSQLServiceRequest({query:t},{handler:function(t){a.__numberOfCurrentSyncSites=t[0].count,a.__logger.info("getTotalIbsOfCurrentSync Total sites = "+a.__numberOfCurrentSyncSites),a.__numberOfCurrentSyncSites&&(a.__currentPageOfCurrentSyncSiteEntries=0),e.resolve()},context:a}),e}var a=this;if(this.__logger.info("PiqFilesEnabled = ",this.isPiqFilesEnabled),a.getPiQSetting()){var r=[],o=T.getTableSchema("Attachment");for(var s in o.fields)o.fields.hasOwnProperty(s)&&(o.fields[s].auto||r.push(s));a.__sqlFields=r,a.__objectNames={ib:E.getCustomObjectName("Installed_Product"),site:E.getCustomObjectName("Site")},a._getLastSyncTime("UPDATE",function(r){a.lastSyncTime=r,a.__logger.info("me.isIncrementalSync = ",a.isIncrementalSync),a.isIncrementalSync?(this._createTable("Sync_PiqExisting_Ibs","Sync_PiqExisting_Ibs",function(){a.__logger.info("Sync_PiqExisting_Ibs table created"),a.fillPiqExistingIbTable(function(t){t&&(a.__serviceRequestCount++,S.when(e()).then(a.getIbIdsInBatch.bind(a)).then(a.queryIbAttachments.bind(a))),a.__serviceRequestCount++,S.when(n()).then(a.getIbIdsOfCurrentSyncInBatch.bind(a)).then(a.queryCurrentSyncIbAttachments.bind(a))})}),this._createTable("Sync_PiqExisting_Sites","Sync_PiqExisting_Sites",function(){a.__logger.info("Sync_PiqExisting_Sites table created"),a.fillPiqExistingSiteTable(function(e){e&&(a.__serviceRequestCount++,S.when(t()).then(a.getSiteIdsInBatch.bind(a)).then(a.querySiteAttachments.bind(a))),a.__serviceRequestCount++,S.when(i()).then(a.getSiteIdsOfCurrentSyncInBatch.bind(a)).then(a.queryOfCurrentSyncSiteAttachments.bind(a))})})):(a.__serviceRequestCount++,S.when(e()).then(a.getIbIdsInBatch.bind(a)).then(a.queryIbAttachments.bind(a)),a.__serviceRequestCount++,S.when(t()).then(a.getSiteIdsInBatch.bind(a)).then(a.querySiteAttachments.bind(a)))})}}},{key:"getEventName",value:function(){return"SYNC_PIQ_ATTACHMENTS"}},{key:"fillPiqExistingIbTable",value:function(e){var t=this,n="SELECT Id FROM "+E.getCustomObjectName("Installed_Product")+" WHERE Id NOT IN (SELECT SFId FROM Sync_Records_Heap)";this.__serviceRequestCount++,this._initSQLServiceRequest({query:n},{handler:function(n){if(this.__serviceRequestCount--,n.length){t.__objectNames.ib=t.getPiqTableName("Sync_PiqExisting_Ibs");var i=T.getInsertQuery("Sync_PiqExisting_Ibs",n,!0,"Sync_PiqExisting_Ibs");this._initSQLServiceRequest({query:i},{handler:function(){e&&e.call(t,!0)},context:t})}else e&&e.call(t,!1)},context:t})}},{key:"fillPiqExistingSiteTable",value:function(e){var t=this,n="SELECT Id FROM "+E.getCustomObjectName("Site")+" WHERE Id NOT IN (SELECT SFId FROM Sync_Records_Heap)";this._initSQLServiceRequest({query:n},{handler:function(n){if(n.length){t.__objectNames.site=t.getPiqTableName("Sync_PiqExisting_Sites");var i=T.getInsertQuery("Sync_PiqExisting_Sites",n,!0,"Sync_PiqExisting_Sites");this._initSQLServiceRequest({query:i},{handler:function(){e&&e.call(t,!0)},context:t})}else e&&e.call(t,!1)},context:t})}},{key:"getIbIdsInBatch",value:function(){var e=E.Deferred(),t=this.__currentPageOfIbEntries*this.__batchSize,n="SELECT DISTINCT Id FROM "+this.getPiqTableName(this.__objectNames.ib)+" LIMIT "+this.__batchSize+" OFFSET "+t;return this._initSQLServiceRequest({query:n},{handler:function(t){this._setState("PIQ_Fetch_Attachments_For_Ib",t.map(function(e){return e.Id})),this.__currentPageOfIbEntries++,e.resolve()},context:this}),e}},{key:"getSiteIdsInBatch",value:function(){var e=E.Deferred(),t=this.__currentPageOfSiteEntries*this.__batchSize,n="SELECT DISTINCT Id FROM "+this.getPiqTableName(this.__objectNames.site)+" LIMIT "+this.__batchSize+" OFFSET "+t;return this._initSQLServiceRequest({query:n},{handler:function(t){this._setState("PIQ_Fetch_Attachments_For_Site",t.map(function(e){return e.Id})),this.__currentPageOfSiteEntries++,e.resolve()},context:this}),e}},{key:"getIbIdsOfCurrentSyncInBatch",value:function(){var e=E.Deferred(),t=this.__currentPageOfCurrentSyncIbEntries*this.__batchSize,n="SELECT DISTINCT SFId FROM "+this.getPiqTableName("Sync_Records_Heap")+" WHERE ObjectName = '"+E.getCustomFieldName("Installed_Product")+"' LIMIT "+this.__batchSize+" OFFSET "+t;return this._initSQLServiceRequest({query:n},{handler:function(t){var n=t.map(function(e){return e.SFId});this._setState("PIQ_Fetch_Attachments_For_CurrentSyncIb",n),this.__currentPageOfCurrentSyncIbEntries++,e.resolve()},context:this}),e}},{key:"getSiteIdsOfCurrentSyncInBatch",value:function(){var e=E.Deferred(),t=this.__currentPageOfCurrentSyncSiteEntries*this.__batchSize,n="SELECT DISTINCT SFId FROM "+this.getPiqTableName("Sync_Records_Heap")+" WHERE ObjectName = '"+E.getCustomFieldName("Site")+"' LIMIT "+this.__batchSize+" OFFSET "+t;return this._initSQLServiceRequest({query:n},{handler:function(t){this._setState("PIQ_Fetch_Attachments_For_CurrentSyncSite",t.map(function(e){return e.SFId})),this.__currentPageOfCurrentSyncSiteEntries++,e.resolve()},context:this}),e}},{key:"getIbRequest",value:function(e){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:this.getEventName(),valueMap:[{key:"TX_OBJECT",value:E.getCustomObjectName("Installed_Product"),values:this._getState(e)}]}}}},{key:"getIbRequestForCurrentSync",value:function(e){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:this.getEventName(),valueMap:[{key:"MODIFIED_OBJECT",value:E.getCustomObjectName("Installed_Product"),values:this._getState(e)}]}}}},{key:"sendRequest",value:function(e,t){this._initHTTPServiceRequest(e,{handler:this[t],context:this})}},{key:"queryIbAttachments",value:function(e){if(this.__numberOfIbs){var t=this.getIbRequest("PIQ_Fetch_Attachments_For_Ib");if(this.sendLastSyncTime){var n={key:"LAST_SYNC_TIME",value:this.getPiqLastSyncTime()};t.data.valueMap.push(n)}e&&t.data.valueMap.push(e),this.sendRequest(t,"processIbResponse")}else this.__serviceRequestCount--}},{key:"queryCurrentSyncIbAttachments",value:function(e){if(this.__numberOfCurrentSyncIbs){var t=this.getIbRequestForCurrentSync("PIQ_Fetch_Attachments_For_CurrentSyncIb");if(this.sendLastSyncTime){var n={key:"LAST_SYNC_TIME",value:this.getPiqLastSyncTime()};t.data.valueMap.push(n)}e&&t.data.valueMap.push(e),this.sendRequest(t,"processCurrentSyncIbResponse")}else this.__serviceRequestCount--}},{key:"getSiteRequest",value:function(e){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:this.getEventName(),valueMap:[{key:"TX_OBJECT",value:E.getCustomObjectName("Site"),values:this._getState(e)}]}}}},{key:"getSiteRequestForCurrentSync",value:function(e){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:this.getEventName(),valueMap:[{key:"MODIFIED_OBJECT",value:E.getCustomObjectName("Site"),values:this._getState(e)}]}}}},{key:"querySiteAttachments",value:function(e){if(this.__numberOfSites){var t=this.getSiteRequest("PIQ_Fetch_Attachments_For_Site");if(this.sendLastSyncTime){var n={key:"LAST_SYNC_TIME",value:this.getPiqLastSyncTime()};t.data.valueMap.push(n)}e&&t.data.valueMap.push(e),this.sendRequest(t,"processSiteResponse")}else this.__serviceRequestCount--}},{key:"queryOfCurrentSyncSiteAttachments",value:function(e){if(this.__numberOfCurrentSyncSites){var t=this.getSiteRequestForCurrentSync("PIQ_Fetch_Attachments_For_CurrentSyncSite");if(this.sendLastSyncTime){var n={key:"LAST_SYNC_TIME",value:this.getPiqLastSyncTime()};t.data.valueMap.push(n)}e&&t.data.valueMap.push(e),this.sendRequest(t,"processCurrentSyncSiteResponse")}else this.__serviceRequestCount--}},{key:"processIbResponse",value:function(e){for(var t=[],n=this,i=e&&e.valueMap&&e.valueMap.length||0,a=0;a<i;a++){var r=e.valueMap[a]||{};if(r&&r.key===E.getCustomObjectName("Installed_Product")){var o=JSON.parse(r.value);n.processPIQAttachmentsRelatedObject(o,r.key)}r&&"SAFE_TO_DELETE"===r.key&&n.processDeletedAttachmentRecords(r),r&&"PARTIAL_EXECUTED_OBJECT"===r.key&&(t.length?n.__logger.error("Server Error: more than one PARTIAL_EXECUTED_OBJECT obtained"):t[0]=r)}this.triggerNextIbAttachmentQuery(t)}},{key:"processCurrentSyncIbResponse",value:function(e){for(var t=[],n=this,i=e&&e.valueMap&&e.valueMap.length||0,a=0;a<i;a++){var r=e.valueMap[a]||{};if(r&&r.key===E.getCustomObjectName("Installed_Product")){var o=JSON.parse(r.value);n.processCurrentSyncAttachment(o)}r&&"SAFE_TO_DELETE"===r.key&&n.processDeletedAttachmentRecords(r),r&&"PARTIAL_EXECUTED_OBJECT"===r.key&&(t.length?n.__logger.error("Server Error: more than one PARTIAL_EXECUTED_OBJECT obtained"):t[0]=r)}this.triggerNextCurrentIbAttachmentQuery(t)}},{key:"processPIQAttachmentsRelatedObject",value:function(e,t){var n=this;if(n.isIncrementalSync){for(var i=[],a=0;a<e.length;a++){var r=e[a];r.Parent&&r.Parent.Id&&i.push(r.Parent.Id)}i.length>0?n.validatePIQAttachmentRelatedObjects(e,i,t,function(e,t){for(var i=[],a=0;a<t.length;a++)for(var r=t[a],o=0;o<e.length;o++){var s=e[o];r.Id===s.Parent.Id&&i.push(s)}n.processAttachment(i)}):n.processAttachment(e)}else n.processAttachment(e)}},{key:"processDeletedAttachmentRecords",value:function(e){for(var t=this,n=e&&e.valueMap&&e.valueMap.length||0,i=0;i<n;i++){var a=e.valueMap[i]||{};if(a){var r=JSON.parse(a.value),o=[];if(r&&r.length>0){for(var s=r.length,l=0;l<s;l++)o.push(r[l].Id);t._deleteAttachmentFile(o)}}}}},{key:"processSiteResponse",value:function(e){for(var t=[],n=this,i=e&&e.valueMap&&e.valueMap.length||0,a=0;a<i;a++){var r=e.valueMap[a]||{};if(r&&r.key===E.getCustomObjectName("Site")){var o=JSON.parse(r.value);n.processPIQAttachmentsRelatedObject(o,r.key)}r&&"SAFE_TO_DELETE"===r.key&&n.processDeletedAttachmentRecords(r),r&&"PARTIAL_EXECUTED_OBJECT"===r.key&&(t.length?n.__logger.error("Server Error: more than one PARTIAL_EXECUTED_OBJECT obtained"):t[0]=r)}this.triggerNextSiteAttachmentQuery(t)}},{key:"processCurrentSyncSiteResponse",value:function(e){for(var t=[],n=this,i=e&&e.valueMap&&e.valueMap.length||0,a=0;a<i;a++){var r=e.valueMap[a]||{};if(r&&r.key===E.getCustomObjectName("Site")){var o=JSON.parse(r.value);n.processCurrentSyncAttachment(o)}r&&"SAFE_TO_DELETE"===r.key&&n.processDeletedAttachmentRecords(r),r&&"PARTIAL_EXECUTED_OBJECT"===r.key&&(t.length?n.__logger.error("Server Error: more than one PARTIAL_EXECUTED_OBJECT obtained"):t[0]=r)}this.triggerNextCurrentSiteAttachmentQuery(t)}},{key:"triggerNextIbAttachmentQuery",value:function(e){var t=this;if(e.length)this.queryIbAttachments(e[0]);else{if(this.__currentPageOfIbEntries*this.__batchSize>=this.__numberOfIbs)return this.__logger.info("Downloaded all Attachments and files for Ibs"),delete this.__parent.__state.PIQ_Fetch_Attachments_For_Ib,void this.__serviceRequestCount--;S.when(t.getIbIdsInBatch()).done(t.queryIbAttachments.bind(t))}}},{key:"triggerNextCurrentIbAttachmentQuery",value:function(e){var t=this;if(e.length)this.queryCurrentSyncIbAttachments(e[0]);else{if(this.__currentPageOfCurrentSyncIbEntries*this.__batchSize>=this.__numberOfCurrentSyncIbs)return this.__logger.info("Downloaded all Attachments and files for Ibs received in currentSync"),delete this.__parent.__state.PIQ_Fetch_Attachments_For_CurrentSyncIb,void this.__serviceRequestCount--;S.when(t.getIbIdsOfCurrentSyncInBatch()).done(t.queryCurrentSyncIbAttachments.bind(t))}}},{key:"triggerNextSiteAttachmentQuery",value:function(e){var t=this;if(e.length)this.querySiteAttachments(e[0]);else{this.__currentPageOfSiteEntries*this.__batchSize>=this.__numberOfSites?(this.__logger.info("Downloaded all Attachments and files for Sites"),delete this.__parent.__state.PIQ_Fetch_Attachments_For_Site,this.__serviceRequestCount--):S.when(t.getSiteIdsInBatch()).done(t.querySiteAttachments.bind(t))}}},{key:"triggerNextCurrentSiteAttachmentQuery",value:function(e){var t=this;if(e.length)this.queryOfCurrentSyncSiteAttachments(e[0]);else{this.__currentPageOfCurrentSyncSiteEntries*this.__batchSize>=this.__numberOfCurrentSyncSites?(this.__logger.info("Downloaded all Attachments and files for Sites received in currentSync"),delete this.__parent.__state.PIQ_Fetch_Attachments_For_CurrentSyncSite,this.__serviceRequestCount--):S.when(t.getSiteIdsOfCurrentSyncInBatch()).done(t.queryOfCurrentSyncSiteAttachments.bind(t))}}},{key:"filterAndInsertAttachment",value:function(e,t,n,i){var a=this,r="",o="",s="";for(var l in i){var c=i[l],u=e[c]&&e[c].toString()||"",d="'"+u+"'";r=r?r+","+d:d;var _=c===n?s="'"+a._parseDateTimeValue(u)+"'":c;o=o?o+","+_:_}var h=E.string.substitute("INSERT OR IGNORE INTO {{tableName}} ({{fields}}) VALUES ({{insertStatement}});\n                                REPLACE INTO {{tableName}} ({{fields}}) SELECT {{insertStatement}} FROM {{tableName}}\n                                WHERE EXISTS (SELECT {{replaceStatement}} FROM {{tableName}} \n                                WHERE Id = '{{recId}}' AND {{lastModifiedFieldName}} < {{lastModifiedDate}}) AND Id = '{{recId}}'",{tableName:t,fields:i.join(","),insertStatement:r,replaceStatement:o,recId:e.Id,lastModifiedFieldName:n,lastModifiedDate:s});!function(e){a._initSQLServiceRequest({query:e},{handler:function(e){a.__logger.info("inserted Attachment")},context:a})}(h)}},{key:"_parseDateTimeValue",value:function(e){var t=e;if("string"==typeof e&&e.match(/T/)){var n=e.split("T"),i=n[0].split("-"),a=n[1].split("."),r=a[0].split(":");t=[i[0],i[1],i[2]].join("-")+" "+[r[0],r[1],r[2]].join(":")}return t}},{key:"processAttachment",value:function(e){var t=this;!function(e){if(e.length){for(var n=[],i=0;i<e.length;i++){var a=e[i];n.push({Id:a.Id||"",parent_id:a.ParentId||"",created_by_id:a.CreatedById||"",name:a.Name||"",file_path:"",description:a.Description||"",content_type:a.ContentType||"",content_length:a.BodyLength||"",downloaded:"",last_modified_date:a.LastModifiedDate})}t.insertIntoAttachments(e),t.insertIntoSFAttachment(n)}}(e)}},{key:"processCurrentSyncAttachment",value:function(e){var t=this;!function(e){if(e.length)for(var n=e,i=0;i<n.length;i++){var a=n[i],r={Id:a.Id||"",parent_id:a.ParentId||"",created_by_id:a.CreatedById||"",name:a.Name||"",file_path:"",description:a.Description||"",content_type:a.ContentType||"",content_length:a.BodyLength||"",downloaded:"",last_modified_date:a.LastModifiedDate};t.filterAndInsertAttachment(a,"Attachment","LastModifiedDate",t.__sqlFields),t.filterAndInsertAttachment(r,"SFAttachments","last_modified_date",t.__sfSqlFields)}}(e)}},{key:"validatePIQAttachmentRelatedObjects",value:function(e,t,n,i){var a=this,r=n;a._tempTableCreated(r)&&(r=E.getTempTableName(r));var o=t.join("','"),s="SELECT Id,Name FROM "+r+" WHERE Id  IN ('"+o+"')";this._initSQLServiceRequest({query:s},{handler:function(t){i&&i.call(this,e,t)},context:this})}},{key:"getDeletedAttachmentFilePaths",value:function(e,t){var n="SFAttachments";this._tempTableCreated(n)&&(n=E.getTempTableName(n));var i=e.join("','"),a="SELECT Id,file_path as __path FROM "+n+" WHERE Id IN ('"+i+"') ";this._initSQLServiceRequest({query:a},{handler:function(e){t&&t.call(this,e)},context:this})}},{key:"insertIntoAttachments",value:function(e){var t=this,n=this.getPiqTableName("Attachment"),i=T.getInsertReplaceQuery("Attachment",e,!0,n);this._initSQLServiceRequest({query:i},{handler:function(n){t.__logger.info("inserted "+e.length+" attachments")},context:this})}},{key:"insertIntoSFAttachment",value:function(e){var t=this,n=this.getPiqTableName("SFAttachments"),i=T.getInsertReplaceQuery("SFAttachments",e,!0,n);this._initSQLServiceRequest({query:i},{handler:function(n){t.__logger.info("inserted "+e.length+" SFAttachments")},context:this})}}]),t}(D.SyncPiqInitial),D.PiqAttachmentSyncIntial=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){"true"===this.getPiqAttchmentSetting()&&(this.piqAttachmentActionType="insert",(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this))}}]),t}(D.PiqAttachmentSync),D.PiqAttachmentSyncIncremental=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){"true"===this.getPiqAttchmentSetting()&&(this.getPiqLastSyncTime()&&(this.sendLastSyncTime=!0,this.isIncrementalSync=!0),this.piqAttachmentActionType="update.incremental",(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this))}}]),t}(D.PiqAttachmentSync),D.PiqFileSync=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"getEventName",value:function(){return"SYNC_PIQ_FILES"}},{key:"processFileResponse",value:function(e){for(var t=null,n=[{ContentDocumentLink:[]}],i=e.length,a=0;a<i;a++){var r=e[a].key,o=void 0;switch(r){case"ContentDocumentLink":o=JSON.parse(e[a].value),n[0].ContentDocumentLink=n[0].ContentDocumentLink.concat(o);break;case"SAFE_TO_DELETE":if(o=e[a].value,"true"===o.toLowerCase()){var s=e[a].valueMap;this.deleteSfFileRelatedRecords(s)}break;case"CALL_BACK":t=e[a]}}return{sfArr:n,callbackArr:t}}},{key:"processIbResponse",value:function(e){var t=this,n=this;if(e&&e.valueMap&&e.valueMap.length){var i=this.processFileResponse(e.valueMap);this.__serviceRequestCount++,this.getSfFileRecord(i.sfArr).done(function(){t.__serviceRequestCount--;var e=i.callbackArr?[i.callbackArr]:[];n.triggerNextIbAttachmentQuery(e)})}else this.__serviceRequestCount--}},{key:"processCurrentSyncIbResponse",value:function(e){var t=this,n=this;if(e&&e.valueMap&&e.valueMap.length){var i=this.processFileResponse(e.valueMap);this.__serviceRequestCount++,this.getSfFileRecord(i.sfArr).done(function(){t.__serviceRequestCount--;var e=i.callbackArr?[i.callbackArr]:[];n.triggerNextCurrentIbAttachmentQuery(e)})}else this.__serviceRequestCount--}},{key:"processSiteResponse",value:function(e){var t=this,n=this;if(e&&e.valueMap&&e.valueMap.length){var i=this.processFileResponse(e.valueMap);this.__serviceRequestCount++,this.getSfFileRecord(i.sfArr).done(function(){t.__serviceRequestCount--;var e=i.callbackArr?[i.callbackArr]:[];n.triggerNextSiteAttachmentQuery(e)})}else this.__serviceRequestCount--}},{key:"processCurrentSyncSiteResponse",value:function(e){var t=this,n=this;if(e&&e.valueMap&&e.valueMap.length){var i=this.processFileResponse(e.valueMap);this.__serviceRequestCount++,this.getSfFileRecord(i.sfArr).done(function(){t.__serviceRequestCount--;var e=i.callbackArr?[i.callbackArr]:[];n.triggerNextCurrentSiteAttachmentQuery(e)})}else this.__serviceRequestCount--}},{key:"deleteSfFileRelatedRecords",value:function(e){if(e&&e.length)for(var t=e.length,n=0;n<t;n++){var i=e[n].key,a=e[n].values;switch(i){case"ContentDocumentLink":this._deleteRecord("ContentDocumentLink",a);break;case"ContentDocument":this._deleteRecord("ContentDocument",a);break;case"ContentVersion":this._deleteRecord("ContentVersion",a),this._deleteLocalSFiles(a)}}}},{key:"getSfFileRecord",value:function(e){var t=this,n=S.Deferred(),i=e&&e[0]&&e[0].ContentDocumentLink?E.cloneObject(e[0].ContentDocumentLink):[];return this._performTXFetch(e,function(){t._getCVIdsForCDLIds(i,function(e){t._updateLocalSFiles(e).done(function(){n.resolve()})})},this.piqAttachmentActionType),n}},{key:"queryCurrentSyncIbAttachments",value:function(e){if(this.__numberOfCurrentSyncIbs){var t=this.getEventName(),n={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:t,valueMap:[{key:"MODIFIED_OBJECT",value:E.getCustomObjectName("Installed_Product"),values:this._getState("PIQ_Fetch_Attachments_For_CurrentSyncIb")}]}};if(this.sendLastSyncTime){var i={key:"LAST_SYNC_TIME",value:this.getPiqLastSyncTime()};n.data.valueMap.push(i)}e&&n.data.valueMap.push(e),this.sendRequest(n,"processCurrentSyncIbResponse")}else this.__serviceRequestCount--}},{key:"queryOfCurrentSyncSiteAttachments",value:function(e){if(this.__numberOfCurrentSyncSites){var t=this.getEventName(),n={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:t,valueMap:[{key:"MODIFIED_OBJECT",value:E.getCustomObjectName("Site"),values:this._getState("PIQ_Fetch_Attachments_For_CurrentSyncSite")}]}};if(this.sendLastSyncTime){var i={key:"LAST_SYNC_TIME",value:this.getPiqLastSyncTime()};n.data.valueMap.push(i)}e&&n.data.valueMap.push(e),this.sendRequest(n,"processCurrentSyncSiteResponse")}else this.__serviceRequestCount--}}]),t}(D.PiqAttachmentSync),D.PiqFileSyncInitial=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){this.getPiqFileSetting()&&(this.piqAttachmentActionType="insert",C.writeToDBCache("piqFilesSendLastSyncTime",!0),(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this))}}]),t}(D.PiqFileSync),D.PiqFileSyncIncremental=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this.getPiqFileSetting()&&(this.getPiqLastSyncTime()?(this.isIncrementalSync=!0,this.__serviceRequestCount++,this.getPiqSendLastSyncTime().done(function(n){"true"===n?e.sendLastSyncTime=!0:(e.sendLastSyncTime=!1,C.writeToDBCache("piqFilesSendLastSyncTime",!0)),e.piqAttachmentActionType="update.incremental",(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",e).call(e),e.__serviceRequestCount--})):(this.piqAttachmentActionType="update.incremental",(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this)))}},{key:"getPiqSendLastSyncTime",value:function(){var e=new E.Deferred;return C.readFromDBCache("piqFilesSendLastSyncTime").done(function(t){e.resolve(t)}),e}}]),t}(D.PiqFileSync),D.PiqCleanUnwantedTableData=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){if(this.getPiQSetting()){for(var e=["Sync_PiqExisting_Ibs","Sync_Records_Heap","Sync_PiqExisting_Sites"],t=[],n=0;n<e.length;n++){var i=e[n],a="DELETE FROM "+i;t.push(a)}this._initSQLServiceRequest({queryArray:t}),this.__logger.info("PiqCleanUnwantedTableData deleted data")}}}]),t}(D.SyncPiqInitial),E.defineGlobal(A.name,A),e.exports=A},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(10),v=n(0).utils,g=n(5).SVMXObject,y=n(11).Facade,S={name:"com.servicemax.client.offline.sal.model.productiq.utils"};S.Query=function(e){function t(e){(0,c.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return n.__logger=v.getLoggingService().getLogger(),n.__q="",e&&e.query&&(n.__q=e.query),n.__insertColumns=null,n.__multiQueries=null,n.__multiQueryIndex=0,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"query",value:function(e){return this.__q=e,this}},{key:"clone",value:function(){var e=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});for(var t in this)e[t]=this[t];return e}},{key:"update",value:function(e){return this.__q="UPDATE `"+e+"` ",this}},{key:"setValue",value:function(e){return this.__q+=" SET "+e,this}},{key:"andSetValue",value:function(e){return this.__q+=" , "+e,this}},{key:"equals",value:function(e){return this.__q+=" = '"+e+"'",this}},{key:"select",value:function(e){return e instanceof Array||(e=[e]),this.__q="SELECT "+e.join(","),this}},{key:"selectDistinct",value:function(e){return e instanceof Array||(e=[e]),this.__q="SELECT DISTINCT "+e.join(","),this}},{key:"from",value:function(e){return e instanceof Array||(e=[e]),this.__q+=" FROM "+e.join(","),this}},{key:"deleteFrom",value:function(e){return this.__q="DELETE FROM "+e,this}},{key:"where",value:function(e){return this.__whered?this.__q+=" AND "+e:(this.__q+=" WHERE "+e,this.__whered=!0),this}},{key:"within",value:function(e){if("string"==typeof e)this.__q+=" IN ('"+e+"')";else if(e instanceof Array)this.__q+=" IN ('"+e.join("','")+"')";else if(e.q){var t=e.q();if(t instanceof Array){var n=void 0,i=t.length,a=[];for(n=0;n<i;n++)a.push(this.__q+" IN ("+t[n]+")");this.__q=a}else this.__q+=" IN ("+t+")"}return this}},{key:"batchWithinIds",value:function(e){var t=[],n=void 0,i=e.length,a=[];for(n=0;n<i;n++)a.push(e[n]),(n+1)%200==0&&(t.push(a),a=[]);a.length>0&&t.push(a),i=t.length;var r=[];for(n=0;n<i;n++)this.__q instanceof Array?r.push(this.__q[n]+" IN ('"+t[n].join("','")+"')"):r.push(this.__q+" IN ('"+t[n].join("','")+"')");return this.__q=r,this}},{key:"or",value:function(e){if(this.__q instanceof Array){var t=void 0,n=this.__q.length;for(t=0;t<n;t++)this.__q[t]+=" OR "+e}else this.__q+=" OR "+e;return this}},{key:"and",value:function(e){return this.__q+=" AND "+e,this}},{key:"orderBy",value:function(e){return this.__q+=" Order By "+e,this}},{key:"desc",value:function(){return this.__q+=" DESC ",this}},{key:"like",value:function(e){return this.__q+=" LIKE '%"+e+"%'",this}},{key:"q",value:function(){return this.__q}},{key:"limit",value:function(e){return this.__q+=" LIMIT "+e,this}},{key:"offset",value:function(e){return this.__q+=" OFFSET "+e,this}},{key:"insertInto",value:function(e){return this.__q="INSERT INTO `"+e+"`",this}},{key:"insertIntoSelect",value:function(e,t,n,i){return this.__q="INSERT INTO `"+e+"` ",this.columns(t),this.__q+=" SELECT "+i.join(",")+" FROM `"+n+"`",this}},{key:"replaceInto",value:function(e){return this.__q="INSERT OR REPLACE INTO `"+e+"`",this}},{key:"columns",value:function(e){this.__insertColumns=e;var t=[],n=void 0,i=e.length;for(n=0;n<i;n++){var a=e[n];t.push(a.name)}return this.__q+=" ('"+t.join("','")+"')",this}},{key:"values",value:function(e){e instanceof Array||(e=[e]);e.length>200&&(this.__multiQueries=[],this.__multiQueryIndex=-1);var t=[],n=void 0,i=e.length;for(n=0;n<i;n++)t.push(this.values2(e[n])),null!=this.__multiQueries&&(n+1)%200==0&&(this.__multiQueries.push(this.__q+" VALUES "+t.join(",")),t=[]);return null==this.__multiQueries?this.__q+=" VALUES "+t.join(","):(t.length>0&&this.__multiQueries.push(this.__q+" VALUES "+t.join(",")),this.__q=this.__moveNext()),this}},{key:"__moveNext",value:function(){return null==this.__multiQueries?null:(this.__multiQueryIndex++,this.__multiQueryIndex<this.__multiQueries.length?this.__multiQueries[this.__multiQueryIndex]:null)}},{key:"values2",value:function(e){var t=[],n=void 0,i=this.__insertColumns,a=i.length,r=void 0;for(n=0;n<a;n++)r=e[i[n].name]||"",r="'"+r+"'","string"==typeof e[i[n].name]&&(r="'"+e[i[n].name].replace(new RegExp("'","g"),"''")+"'"),t.push(r);return" ("+t.join(",")+")"}},{key:"replaceTable",value:function(e,t,n){return this.__q="DROP TABLE IF EXISTS `"+t+"`;ALTER TABLE `"+e+"` RENAME TO `"+t+"`;",this.execute(n)}},{key:"dropTable",value:function(e,t){return this.__q="DROP TABLE IF EXISTS `"+e+"`;",this.execute(t)}},{key:"createTable",value:function(e,t,n){var i=[],a=void 0,r=t.length,o=null;for(o=["'RecordId' ","INTEGER"," PRIMARY KEY "," AUTOINCREMENT "],i.push(o.join("")),a=0;a<r;a++){var s=t[a];o=["'",s.name,"' ",s.type],s.isUnique&&o.push(" UNIQUE "),s.isAuto&&o.push(" AUTOINCREMENT "),i.push(o.join(""))}var l=["CREATE TABLE","`"+e+"`","(",i.join(","),")"].join(" ");return this.__q="DROP TABLE IF EXISTS `"+e+"`; "+l,this.execute(n)}},{key:"execute",value:function(e){var t=m.Deferred();return this.executeInternal(this.q(),function(n){e?t.resolveWith(e,n):t.resolve(n)}),t}},{key:"executeInternal",value:function(e,t){function n(e){var n=r.__moveNext();n?r.executeInternal(n,t):t.call(r,e)}var i=y,a=i.createSQLRequest(),r=this;a.bind("REQUEST_COMPLETED",function(e){n(e.data.data)},this),a.bind("REQUEST_ERROR",function(t){this.__logger.error("Error QUERY: "+e),n([])},this),this.__logger.info("Executing QUERY: "+e.substring(0,e.length>150?150:e.length)),a.execute({query:e})}}]),t}(g),S.API=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.__logger=v.getLoggingService().getLogger(),e.__method="SELECT",e.__record=[],e.__criteria=[],e.__recordIds=[],e.__objectName=null,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"method",value:function(e){return this.__method=e,this}},{key:"objectName",value:function(e){return this.__objectName=e,this}},{key:"addField",value:function(e,t){return this.__record.push({name:e,value:t}),this}},{key:"record",value:function(e){return this.__record=e,this}},{key:"recordIds",value:function(e){return this.__recordIds=e,this}},{key:"criteria",value:function(e){return this.__criteria=e,this}},{key:"execute",value:function(e){var t=m.Deferred();return this.executeInternal(function(n){e?t.resolveWith(e,n):t.resolve(n)}),t}},{key:"executeInternal",value:function(e){var t=this;t.__chkExternalAppExists("LaptopMobile").done(function(n){var i=v.toObject(n);i&&i.length>0&&"true"===i[0].Installed?t.__getLoggedInUserInfo().done(function(n){var i={objectName:t.__objectName,fields:t.__record,criteria:t.__criteria,userName:n.UserName,recordIds:t.__recordIds};i.type="DATAACCESSAPI",i.method=t.__method;var a=y.createDataAccessAPIRequest();a.bind("REQUEST_COMPLETED",function(t){e(t.data)},this),a.bind("REQUEST_ERROR",function(t){e(t.data)},this),a.execute(i)}):responder.result([])})}},{key:"__getLoggedInUserInfo",value:function(){var e=v.Deferred(),t=y.createLoginInfoRequest();return t.bind("REQUEST_COMPLETED",function(t){e.resolve(t.data.data)},this),t.bind("REQUEST_ERROR",function(t){e.resolve({})},this),t.execute(),e}},{key:"__getFieldData",value:function(e){var t=[];for(var n in e)fieldData={},fieldData.name=n,fieldData.value=e[n],t.push(fieldData);return t}},{key:"__chkExternalAppExists",value:function(e){var t=v.Deferred(),n={appName:e},i=y.createCheckExternalRequest();return i.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)},this),i.bind("REQUEST_ERROR",function(e){t.resolve({})},this),i.execute(n),t}}]),t}(g),S.Http=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.__logger=v.getLoggingService().getLogger(),e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"doGet",value:function(e){var t=m.Deferred();return e.d=t,e.method="GET",this._initRequest(e),t}},{key:"doPost",value:function(e){var t=m.Deferred();return e.d=t,e.method="POST",this._initRequest(e),t}},{key:"doHttpGetQuery",value:function(e){var t=v.getClient().getApplicationParameter("sfdc-api-version")||"32.0",n="/services/data/v{{apiVersion}}/query?q={{queryString}}";return n=v.string.substitute(n,{apiVersion:t,queryString:encodeURI(e)}),v.create("com.servicemax.client.offline.sal.model.productiq.utils.Http",{}).doGet({url:n})}},{key:"_initRequest",value:function(e){var t=y,n=t.createHTTPRequest();n.bind("REQUEST_COMPLETED",function(t){e.d.resolve(t.data)},this),n.bind("REQUEST_ERROR",function(t){this._handleError(t,e)},this),this._executeRequest(n,e)}},{key:"_executeRequest",value:function(e,t){if(S.Http.__resumeHandlers){var n=this;S.Http.__addResumeHandler(function(){n.__logger.info("Executing HTTP ("+t.method+"): "+t.url),e.execute({method:t.method,url:t.url,data:t.data,headers:t.headers})})}else this.__logger.info("Executing HTTP ("+t.method+"): "+t.url),e.execute({method:t.method,url:t.url,data:t.data,headers:t.headers})}},{key:"_handleError",value:function(e,t){var n="string"==typeof e.data.data?e.data.data:"Unknown";this.__logger.error("Request error: "+t.url+" ("+n+") "+v.toJSON(e.data)),void 0!==v.stringStartsWith&&v.stringStartsWith(n,"InternalServerError ")&&(n=n.replace("InternalServerError ",""));var i=e.data.headers,a=!i||!i.status||-1!==n.indexOf("UNKNOWN_EXCEPTION"),r={};try{r=JSON.parse(n)}catch(e){r.StatusCode=""}if(r.constructor===Array){if(r.length>0&&"APEX_ERROR"===r[0].errorCode){S.Http;t.errorMsg=r[0].errorCode+": "+r[0].message,a=!1}}else a=a&&"4"!==r.StatusCode[0]&&"5"!==r.StatusCode[0];this._retryRequest(t,a)}},{key:"_retryRequest",value:function(e,t){var n=this,i=S.Http;e.requestAttempts>=3?(e.requestAttempts=0,e.errorMsg&&e.errorMsg.length>0?i.__triggerServerResponseErrorDialog(e.errorMsg):i.__triggerRequestErrorDialog(),i.__addResumeHandler(function(){e.errorMsg="",n._retryRequest(e)})):this._checkConnectivity().done(function(a){a?t?(e.connectAttempts=e.connectAttempts||1,e.connectAttempts++,e.connectAttempts>=3?(e.connectAttempts=0,i.__triggerConnectionWarningDialog(),i.__addResumeHandler(function(){n._retryRequest(e,!0)})):(n.__logger.warn("Connection error. Retrying failed request..."),n._initRequest(e))):(e.requestAttempts=e.requestAttempts||1,e.requestAttempts++,n.__logger.warn("Server error. Retrying failed request..."),n._initRequest(e)):(n.__logger.warn("Not connected, request stream paused..."),i.__triggerConnectionErrorDialog(),i.__addResumeHandler(function(){n._retryRequest(e,!0)}))})}},{key:"_checkConnectivity",value:function(){var e=v.Deferred(),t=y,n=t.createConnectivityRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data.toLowerCase(),i="true"===n;e.resolve(i)},this),n.bind("REQUEST_ERROR",function(t){e.resolve(!1)},this),n.execute(),e}}],[{key:"pause",value:function(){S.Http.__resumeHandlers=S.Http.__resumeHandlers||[]}},{key:"resume",value:function(){if(S.Http.__resumeHandlers){for(var e=null;e=S.Http.__resumeHandlers.shift();)e();S.Http.__resumeHandlers=null}}},{key:"cancel",value:function(){if(S.Http.__connectionWatchers){for(var e=S.Http.__connectionWatchers,t=0;t<e.length;t++)e[t]();delete S.Http.__resumeHandlers,delete S.Http.__connectionWatchers}}},{key:"onConnectionCanceled",value:function(e){S.Http.__connectionWatchers=S.Http.__connectionWatchers||[],S.Http.__connectionWatchers.push(e)}},{key:"offConnectionCanceled",value:function(e){if(S.Http.__connectionWatchers)for(var t=S.Http.__connectionWatchers,n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),n--)}},{key:"__addResumeHandler",value:function(e){S.Http.__resumeHandlers?S.Http.__resumeHandlers.push(e):e()}},{key:"__triggerConnectionWarningDialog",value:function(e){S.Http.pause(),v.getCurrentApplication().showConnectionWarningDialog({onRetry:function(){S.Http.resume()},onCancel:function(){S.Http.cancel()}})}},{key:"__triggerConnectionErrorDialog",value:function(e){S.Http.pause(),v.getCurrentApplication().showConnectionErrorDialog({onRetry:function(){S.Http.resume()},onCancel:function(){S.Http.cancel()}})}},{key:"__triggerRequestErrorDialog",value:function(e){S.Http.pause(),v.getCurrentApplication().showRequestErrorDialog({onRetry:function(){S.Http.resume()},onCancel:function(){S.Http.cancel()}})}},{key:"__triggerServerResponseErrorDialog",value:function(e,t){S.Http.pause(),v.getCurrentApplication().showRequestErrorDialog({errorMessage:e,onRetry:function(){S.Http.resume()},onCancel:function(){S.Http.cancel()}})}}]),t}(g),S.Http.__connectionWatchers=null,S.Http.__resumeHandlers=null,S.Util=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"getAllChildren4IB",value:function(e){var t=v.Deferred(),n=this;return n.findPIQCircularRefenceRecords().done(function(i){n.executeAllChildren4IB(e,i).done(function(e){t.resolve(e)})}),t}},{key:"getAllParents4IB",value:function(e){var t=v.Deferred(),n=this;return n.findPIQCircularRefenceRecords().done(function(i){n.executeAllParents4IB(e,i).done(function(e){t.resolve(e)})}),t}},{key:"executeAllParents4IB",value:function(e,t){var n=v.Deferred(),i=v.string.substitute("WITH RECURSIVE all_parents(ids,  level, account, site) AS (  SELECT Id, 1, {{companyFieldName}}, {{siteFieldName}}  from {{objectName}} where id = '{{nodeId}}' UNION SELECT a.{{parentFieldName}}, level + 1, a.{{companyFieldName}}, a.{{siteFieldName}} from {{objectName}} a, all_parents where a.id = all_parents.ids AND all_parents.ids NOT IN ('{{circurlarIds}}') ) SELECT ids, level, account, site FROM all_parents a where a.ids != '' order by level",{nodeId:e,objectName:v.getCustomObjectName("Installed_Product"),parentFieldName:v.getCustomFieldName("Parent"),companyFieldName:v.getCustomFieldName("Company"),siteFieldName:v.getCustomFieldName("Site"),circurlarIds:t.join("','")});return v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{query:i}).execute().done(function(t){"string"==typeof t&&(t=v.toObject(t));var i=void 0,a=t.length,r=[];for(i=0;i<a;i++)t[i].Id!=e&&r.push(t[i]);n.resolve(r)}),n}},{key:"executeAllChildren4IB",value:function(e,t){var n=v.Deferred(),i=v.string.substitute("WITH RECURSIVE all_children(ids) AS ( VALUES('{{parentId}}') UNION SELECT Id FROM {{objectName}}, all_children WHERE {{objectName}}.{{fieldName}} = all_children.ids AND all_children.ids NOT IN ('{{circurlarIds}}') ) SELECT Id FROM {{objectName}} WHERE {{objectName}}.Id IN all_children",{parentId:e,objectName:v.getCustomObjectName("Installed_Product"),fieldName:v.getCustomFieldName("Parent"),circurlarIds:t.join("','")});return v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{query:i}).execute().done(function(t){"string"==typeof t&&(t=v.toObject(t));var i=void 0,a=t.length,r=[];for(i=0;i<a;i++)t[i].Id!=e&&r.push(t[i]);n.resolve(r)}),n}},{key:"getObjectDescribeByName",value:function(e){var t=v.Deferred();return v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("object_describe").from("SFObjectDescribe").where("Object_Name").equals(e).execute().done(function(e){if(e&&e[0]&&e[0].object_describe){var n=v.toObject(e[0].object_describe);t.resolve(n)}}),t}},{key:"isTableInDatabase",value:function(e){var t=v.Deferred();return v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("*").from("sqlite_master").where("name").equals(e).execute().done(function(e){if(e&&e[0]&&e[0].DescribeResult){var n=v.toObject(e[0].DescribeResult);t.resolve(n)}else{var n={};t.resolve(n)}}),t}},{key:"getUserConfiguration",value:function(){var e=v.Deferred();return v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Value").from("Configuration").where("Type = 'user'").execute().done(function(t){if(t&&t[0]&&t[0].Value){var n=v.toObject(t[0].Value);e.resolve(n)}}),e}},{key:"getObjectNameByNodeType",value:function(e){switch(e){case"ACCOUNT":return v.getCustomObjectName("Account");case"LOCATION":return v.getCustomObjectName("Site");case"SUBLOCATION":return v.getCustomObjectName("Sub_Location");case"IB":return v.getCustomObjectName("Installed_Product")}}},{key:"findPIQCircularRefenceRecords",value:function(){var e=v.Deferred(),t=v.getCustomObjectName("Installed_Product"),n=v.string.substitute("WITH RECURSIVE CTE AS (  SELECT {{parentFieldName}} as start_id, Id  FROM {{objectName}} UNION ALL  SELECT CTE.start_id, a.Id from CTE   JOIN {{objectName}} a ON a.{{parentFieldName}} = CTE.Id WHERE CTE.start_id != CTE.Id   ) SELECT * FROM CTE Ref  where Ref.start_id = Ref.Id",{objectName:t,parentFieldName:v.getCustomFieldName("Parent")});return v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{query:n}).execute().done(function(t){var n=[];if(t&&"string"==typeof t){t=v.toObject(t);var i=void 0,a=t.length;for(i=0;i<a;i++)n.push(t[i].Id)}e.resolve(n)}),e}}]),t}(g),S.GetRecords=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"fromServer",value:function(e){var t=v.Deferred(),n=this;return this.__checkConnectivity().done(function(i){if("false"==i)return t.resolve([]),t;var a=e.fields,r=e.fieldsDescribe,a=n.__getQueryFields(a,r),o=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(o.select(a).from(e.objectName),e.text){var s=0,l=e.searchFields.length;for(searchQuery="",s=0;s<l;s++)s>0&&(searchQuery+=" OR "),searchQuery=searchQuery+n.__getSearchableField(e.searchFields[s],r)+" like '%"+e.text+"%'";searchQuery.length>0&&(searchQuery="("+searchQuery+")",o.where(searchQuery))}o.limit(v.getCurrentApplication().getSearchResultsLimit());var c=o.q();n._downloadRecords(c).done(function(e){S.Http.offConnectionCanceled(n.onConnectionCanceled),t.resolve(e)})}),this.onConnectionCanceled=function(){t.resolve([])},S.Http.onConnectionCanceled(this.onConnectionCanceled),t}},{key:"FromServerWithPreBuildQuery",value:function(e){var t=v.Deferred(),n=this;return this.__checkConnectivity().done(function(i){if("False"==i)return t.resolve([]),t;n._downloadRecords(e).done(function(e){S.Http.offConnectionCanceled(n.onConnectionCanceled),t.resolve(e)})}),this.onConnectionCanceled=function(){t.resolve([])},S.Http.onConnectionCanceled(this.onConnectionCanceled),t}},{key:"__checkConnectivity",value:function(){var e=v.Deferred(),t=this,n={type:"CONNECTIVITY",method:"CHECKCONNECTIVITY"},i=y.createConnectivityRequest();return i.bind("REQUEST_COMPLETED",function(t){e.resolve(t.data.data)},t),i.bind("REQUEST_ERROR",function(t){e.resolve("False")},t),i.execute(n),e}},{key:"__getSearchableField",value:function(e,t){var n=t[e];return n&&"reference"==n.type&&(e=n.relationshipName+".Name"),e}},{key:"__getQueryFields",value:function(e,t){var n=0,i=e.length,a=[];for(n=0;n<i;n++)field=t?t[e[n]]:void 0,field&&"reference"==field.type?a.push(field.relationshipName+".Name"):a.push(e[n]);return a}},{key:"_downloadRecords",value:function(e){var t=v.Deferred(),n=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Http",{});"string"==typeof e&&(e=[e]);var i=0,a=[],r=void 0,o=e.length;for(i=o,r=0;r<o;r++)n.doHttpGetQuery(e[r]).done(function(e){a=a.concat(e.data.records),0==--i&&t.resolve(a)});return t}}]),t}(g),S.SyncData=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,null,[{key:"createSyncLogs",value:function(e,t,n,i){var a=this,r=v.Deferred();return S.Util.getObjectDescribeByName(e).done(function(e){for(var o=m.when(1),s=0;s<t.length;s++)o=o.then(a.__createSyncLog(e,t[s],n,i));o.done(function(){r.resolve()})}),r}},{key:"__createSyncLog",value:function(e,t,n,i){if("delete"===n)return this.deleteSyncLog(t);var a=this,r=v.Deferred();return this.__validateRecord(e,t,i).done(function(i,o){var s=!t.match(/local.*/);"update"!==n||s||(n="insert"),"insert"===n&&s&&(n="update");var l=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),c=i?"ClientSyncLog":"ClientSyncLogTransient",u=(new Date).toISOString(),l=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});"ClientSyncLog"==c?a.getRecordLocalId(t,e.name).done(function(s){a.checkSyncLog(s).done(function(s){var c=[{name:"Id"},{name:"record_type"},{name:"parent_id"},{name:"operation"},{name:"modified_at"},{name:"old_values"},{name:"new_values"},{name:"objectName"},{name:"pending"}],d={Id:t,record_type:"master",parent_id:"",operation:n,modified_at:u,old_values:"",new_values:"",objectName:e.name,pending:o?"":"true"};l.replaceInto("ClientSyncLog").columns(c).values(d),l.execute().done(function(e){a.__updateRecordSyncStatus(i,t).done(function(){r.resolve()})})})}):(l.replaceInto(c).columns([{name:"Id"},{name:"Operation"},{name:"ObjectName"},{name:"LastModifiedDate"},{name:"Pending"}]).values({Id:t,Operation:n,ObjectName:e.name,LastModifiedDate:u,Pending:o?"":"true"}),l.execute().done(function(e){a.__updateRecordSyncStatus(i,t).done(function(){r.resolve()})}))}),r}},{key:"getRecordLocalId",value:function(e,t){var n=v.Deferred(),i=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return i.select("Id").from(t).where("Id").equals(e),i.execute().done(function(e){var t="";e&&e.length>0&&(t=e[0].Id),n.resolve(t)}),n}},{key:"checkSyncLog",value:function(e){var t=v.Deferred(),n=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return n.select("Id").from("ClientSyncLog").where("Id").equals(e),n.execute().done(function(e){var n="";e&&e.length>0&&(n=e[0].Id),t.resolve(n)}),t}},{key:"deleteSyncLog",value:function(e){var t=this,n=v.Deferred(),i=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return i.deleteFrom("ClientSyncLog").where("Id").equals(e),i.execute().done(function(){v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).deleteFrom("ClientSyncLogTransient").where("Id").equals(e).execute().done(function(){t.__updateRecordSyncStatus(!0,e).done(function(){n.resolve()})})}),n}},{key:"__validateRecord",value:function(e,t,n){var i=this,a=v.Deferred(),r=r=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return r.select("*").from(e.name).where("Id").equals(t).execute().done(function(t){var r=t[0],o=!0;e.fields;if(r){for(var s=0;s<e.fields.length;s++){var l=e.fields[s];if(""===r[l.name]&&!l.defaultedOnCreate)if("boolean"===l.type)r[l.name]="false";else if(l.createable&&!l.nillable){o=!1;break}}if(void 0!==n&&null!==n){var c=[];for(var u in n)c.push(u);for(var s=0;s<c.length;s++)if(""===r[c[s]]&&n[c[s]]){o=!1;break}}}i.__validateUpwardHierarchy(e.name,r).done(function(e){a.resolve(o,e)})}),a}},{key:"__validateUpwardHierarchy",value:function(e,t){function n(e,t){if(e===v.getCustomObjectName("Installed_Product")){var r=v.getCustomObjectName("Installed_Product"),o=v.getCustomFieldName("Parent"),s=t[o];s?i.getSyncLogTransient(s).done(function(e){if(e&&e.length)return void a.resolve(!1);i.__getRecord(r,s).done(function(e){e.length?n(r,e[0]):a.resolve(!0)})}):(r=v.getCustomObjectName("Sub_Location"),o=v.getCustomFieldName("Sub_Location"),s=t[o],s?i.getSyncLogTransient(s).done(function(e){if(e&&e.length)return void a.resolve(!1);i.__getRecord(r,s).done(function(e){e.length?n(r,e[0]):a.resolve(!0)})}):(r=v.getCustomObjectName("Sub_Location"),o=v.getCustomFieldName("Sub_Location"),s=t[o],s?i.getSyncLogTransient(s).done(function(e){if(e&&e.length)return void a.resolve(!1);i.__getRecord(r,s).done(function(e){e.length?n(r,e[0]):a.resolve(!0)})}):a.resolve(!0)))}else if(e===v.getCustomObjectName("Sub_Location")){var o=v.getCustomFieldName("Location"),s=t[o];i.getSyncLogTransient(s).done(function(e){e&&e.length?a.resolve(!1):a.resolve(!0)})}else a.resolve(!0)}var i=this,a=v.Deferred();return n(e,t),a}},{key:"__updateRecordSyncStatus",value:function(e,t){var n=v.Deferred(),i=e?"ClientSyncLogTransient":"ClientSyncLog",a=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return a.deleteFrom(i).where("Id").equals(t),a.execute().done(function(){}),n}},{key:"getSyncLogTransient",value:function(e){var t=t=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return t.select("Id").from("ClientSyncLogTransient").where("Id").equals(e).execute()}},{key:"__getRecord",value:function(e,t){var n=n=v.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return n.select("*").from(e).where("Id").equals(t).execute()}},{key:"getTableInfoFromDescribe",value:function(e,t){e=v.toObject(e);var n={name:e.name,columns:[]};if(e&&e.fields&&e.fields.length){var i,a,o=e.fields,s=o.length;for(i=0;i<s;i++)a=o[i],n.columns.push({name:a.name,type:"VARCHAR",isUnique:"Id"==a.name})}else if(t&&t[0])for(var o=(0,r.default)(t[0]),i=0;i<o.length;i++)"attributes"!==o[i]&&n.columns.push({name:o[i],type:"VARCHAR",isUnique:"Id"==o[i]});return n}}]),t}(g),v.defineGlobal(S.name,S),e.exports=S},function(e,t,n){n(81),n(712);var i=n(33),a=n(397),r=n(399),o=n(714),s=n(715),l=n(398),c=n(716),u=n(385),d=n(388),_=n(0).utils;_.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sfmconsole.deliveryengine"}')),_.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sfmconsole.settings"}')),_.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sfmconsole.consoleapp"}')),_.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sfmconsole.synchronizer"}')),_.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.extension"}')),_.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sfmconsole.translation-tags"}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"SFMCONSOLE.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMCONSOLE.GET_USERINFO","command":"com.servicemax.client.sfmconsole.commands.GetUserInfo"},{"event":"SFMCONSOLE.GET_APP_INFO","command":"com.servicemax.client.sfmconsole.commands.GetAppInfo"},{"event":"SFMCONSOLE.RETRIEVE_DISPLAY_TAGS","command":"com.servicemax.client.sfmconsole.commands.RetrieveDisplayTags"},{"event":"SFMCONSOLE.RETRIEVE_ON_DEMAND_APP_SETTINGS","command":"com.servicemax.client.sfmconsole.commands.RetrieveOnDemandAppSettings"},{"event":"SFMCONSOLE.SIGNOUT","command":"com.servicemax.client.sfmconsole.commands.SignOutUser"}]}}}')),_.registerService(JSON.parse('{"id":"com.servicemax.client.translation","class-name":"com.servicemax.client.sfmconsole.utils.TranslationService"}')),e.exports={api:i,impl:a,utils:r,engine:o,commands:s,constants:l,patterns:{api:c},expressionbridge:u,customExpressionbridge:d}},function(e,t,n){var i=n(10),a=n(0).utils,r={name:"com.servicemax.client.ui.components.modern.controls.svmxbasebutton"};Ext.define(r.name+".SVMXBaseButton",{extend:"Ext.Button",xtype:"svmx.basebutton",config:{tapMask:null,tapMaskFactor:2,tapOverflowLeft:10,tapOverflowRight:10,tapOverflowTop:10,tapOverflowBottom:10},template:[{tag:"span",className:Ext.baseCSSPrefix+"button-icon",reference:"iconElement"},{tag:"span",reference:"badgeElement",hidden:!0},{tag:"span",reference:"textElement",hidden:!0},{tag:"span",reference:"tapMask",style:{position:"absolute",width:"100%",height:"100%",boxSizing:"content-box"}}],initialize:function(){var e=this;e.setPressingCls("svmx-button-pressing");var t=e.element;e.callParent(),t.setStyle("overflow","visible"),e.setTapMaskSize(1),e.getTapMask()&&e.setTapMaskColor(!0),t.on({scope:e,touchstart:"onClickOrPressStart",dragend:"onRelease",drag:"onDragOrMove",tap:"onTap"}),this.zoomLevel=e.__getZoomLevel()},__getZoomLevel:function(){var e=Ext.Viewport&&Ext.Viewport.getId(),t=1;return e&&(t=i("#"+e).css("zoom")),t},setTapMaskSize:function(e){var t=this,n=e||t.getTapMaskFactor(),i=t.getTapOverflowTop(),a=t.getTapOverflowLeft(),r=t.getTapOverflowRight(),o=t.getTapOverflowBottom(),s=i*n+"px",l=r*n+"px",c=o*n+"px",u=a*n+"px",d="-"+i*n+"px",_="-"+a*n+"px",h={paddingTop:s,paddingRight:l,paddingBottom:c,paddingLeft:u,top:d,left:_};t.tapMask.setStyle(h)},performRelease:function(e,t,n){var i=e;i.setTapMaskSize(1),i.getTapMask()&&i.setTapMaskSize(!0),i.pressed&&(i.pressed=!1,i.hasOwnProperty("pressedTimeout")&&(clearTimeout(i.pressedTimeout),delete i.pressedTimeout),i.releasedTimeout=setTimeout(function(){if(i&&i.element){i.element.removeCls(i.getPressingCls());var e=t.pageX/i.zoomLevel,n=t.pageY/i.zoomLevel,a=i.pressedTargetTop,r=i.pressedTargetLeft,o=i.pressedTargetWidth,s=i.pressedTargetHeight;e<r||e>r+o||n<a||n>a+s||i.fireAction("tap",[i,t],"doTap")}i.pressedTarget=null},10))},setTapMaskColor:function(e){if(e){var t={background:"orange",opacity:"0.2"};this.tapMask.setStyle(t)}else{var n={background:"green",opacity:"0.2"};this.tapMask.setStyle(n)}},onClickOrPressStart:function(e){var t=this,n=t.element,i=t.getPressingCls();if(!t.getDisabled()){t.pressed=!0,t.setTapMaskSize(),t.getTapMask()&&t.setTapMaskColor(),e.target.children.length?t.pressedTarget=e.target.id:t.pressedTarget=e.target.parentElement.id;var a=Ext.getCmp(t.pressedTarget),r=t.getTapMaskFactor(),o=a.element,s=t.getTapOverflowLeft(),l=t.getTapOverflowTop(),c=t.getTapOverflowRight(),u=t.getTapOverflowBottom(),d=o.getX()-s*r,_=o.getWidth()+s*r+c*r,h=o.getY()-l*r,f=o.getHeight()+l*r+u*r;t.pressedTargetLeft=d,t.pressedTargetWidth=_,t.pressedTargetTop=h,t.pressedTargetHeight=f,t.hasOwnProperty("releasedTimeout")&&(clearTimeout(t.releasedTimeout),delete t.releasedTimeout),n.addCls(i)}},onDragOrMove:function(e,t){var n=this,t=n.element;if(n.pressed){var i=n.zoomLevel,a=e.pageX/i,r=e.pageY/i,o=n.pressedTargetLeft,s=n.pressedTargetTop,l=n.pressedTargetWidth,c=n.pressedTargetHeight,u=n.getPressingCls();a<o||a>o+l||r<s||r>s+c?(t.removeCls(u),n.getTapMask()&&n.tapMask.setStyle({background:"red"})):(t.addCls(u),n.getTapMask()&&n.tapMask.setStyle({background:"green"}))}},onRelease:function(e,t){this.fireAction("release",[this,e,t],"performRelease")},onTap:function(e){return!1}}),a.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(0).utils,a=n(10),r={name:"com.servicemax.client.ui.components.modern.controls.signature"};r.SignaturePad=function(e,t){var n=t||{};this.velocityFilterWeight=n.velocityFilterWeight||.7,this.minWidth=n.minWidth||.5,this.maxWidth=n.maxWidth||2.5,this.dotSize=n.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=n.penColor||"black",this.backgroundColor=n.backgroundColor||"rgba(0,0,0,0)",this.onEnd=n.onEnd,this.onBegin=n.onBegin,this._canvas=e,this._ctx=e.getContext("2d");var i=this._ctx,e=this._canvas;i.fillStyle=this.backgroundColor,i.fillRect(0,0,e.width,e.height),this._reset(),this._handleMouseEvents(),this._handleTouchEvents(),this.zoomLevel=this.__getZoomLevel()},r.SignaturePad.prototype.__getZoomLevel=function(){var e=Ext.Viewport&&Ext.Viewport.getId(),t=1;return e&&(t=a("#"+e).css("zoom")),t},r.SignaturePad.prototype.clear=function(){var e=this._ctx,t=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._reset()},r.SignaturePad.prototype.toDataURL=function(e,t){var n=this._canvas;return n.toDataURL.apply(n,arguments)},r.SignaturePad.prototype.fromDataURL=function(e){var t=this,n=new Image,i=window.devicePixelWidth||1,a=this._canvas.width/i,r=this._canvas.height/i;this._reset(),n.src=e,n.onload=function(){t._ctx.drawImage(n,0,0,a,r)},this._isEmpty=!1},r.SignaturePad.prototype._strokeUpdate=function(e){var t=this._createPoint(e);this._addPoint(t)},r.SignaturePad.prototype._strokeBegin=function(e){this._reset(),this._strokeUpdate(e),"function"==typeof this.onBegin&&this.onBegin(e)},r.SignaturePad.prototype._strokeDraw=function(e){var t=this._ctx,n="function"==typeof this.dotSize?this.dotSize():this.dotSize;t.beginPath(),this._drawPoint(e.x,e.y,n),t.closePath(),t.fill()},r.SignaturePad.prototype._strokeEnd=function(e){var t=this.points.length>2,n=this.points[0];!t&&n&&this._strokeDraw(n),"function"==typeof this.onEnd&&this.onEnd(e)},r.SignaturePad.prototype._handleMouseEvents=function(){var e=this;this._mouseButtonDown=!1,a(this._canvas).on("mousedown",function(t){1===t.which&&(e._mouseButtonDown=!0,e._strokeBegin(t))}),a(this._canvas).on("mousemove",function(t){e._mouseButtonDown&&e._strokeUpdate(t)}),a(document).on("mouseup",function(t){1===t.which&&e._mouseButtonDown&&(e._mouseButtonDown=!1,e._strokeEnd(t))})},r.SignaturePad.prototype._handleTouchEvents=function(){var e=this;this._canvas.style.msTouchAction="none",a(this._canvas).on("touchstart",function(t){var n=t.originalEvent.changedTouches[0];e._strokeBegin(n)}),a(this._canvas).on("touchmove",function(t){t.preventDefault();var n=t.originalEvent.changedTouches[0];e._strokeUpdate(n)}),a(document).on("touchend",function(t){t.target===e._canvas&&e._strokeEnd(t)})},r.SignaturePad.prototype.isEmpty=function(){return this._isEmpty},r.SignaturePad.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._isEmpty=!0,this._ctx.fillStyle=this.penColor},r.SignaturePad.prototype._createPoint=function(e){var t=this._canvas.getBoundingClientRect();return new r.Point(e.clientX/this.zoomLevel-t.left,e.clientY/this.zoomLevel-t.top)},r.SignaturePad.prototype._addPoint=function(e){var t=this.points,n=void 0,i=void 0,a=void 0,o=void 0;t.push(e),t.length>2&&(3===t.length&&t.unshift(t[0]),o=this._calculateCurveControlPoints(t[0],t[1],t[2]),n=o.c2,o=this._calculateCurveControlPoints(t[1],t[2],t[3]),i=o.c1,a=new r.Bezier(t[1],n,i,t[2]),this._addCurve(a),t.shift())},r.SignaturePad.prototype._calculateCurveControlPoints=function(e,t,n){var i=e.x-t.x,a=e.y-t.y,o=t.x-n.x,s=t.y-n.y,l={x:(e.x+t.x)/2,y:(e.y+t.y)/2},c={x:(t.x+n.x)/2,y:(t.y+n.y)/2},u=Math.sqrt(i*i+a*a),d=Math.sqrt(o*o+s*s),_=l.x-c.x,h=l.y-c.y,f=d/(u+d),p={x:c.x+_*f,y:c.y+h*f},m=t.x-p.x,v=t.y-p.y;return{c1:new r.Point(l.x+m,l.y+v),c2:new r.Point(c.x+m,c.y+v)}},r.SignaturePad.prototype._addCurve=function(e){var t=e.startPoint,n=e.endPoint,i=void 0,a=void 0;i=n.velocityFrom(t),i=this.velocityFilterWeight*i+(1-this.velocityFilterWeight)*this._lastVelocity,a=this._strokeWidth(i),this._drawCurve(e,this._lastWidth,a),this._lastVelocity=i,this._lastWidth=a},r.SignaturePad.prototype._drawPoint=function(e,t,n){var i=this._ctx;i.moveTo(e,t),i.arc(e,t,n,0,2*Math.PI,!1),this._isEmpty=!1},r.SignaturePad.prototype._drawCurve=function(e,t,n){var i=this._ctx,a=n-t,r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0,_=void 0,h=void 0,f=void 0,p=void 0;for(r=Math.floor(e.length()),i.beginPath(),s=0;s<r;s++)l=s/r,c=l*l,u=c*l,d=1-l,_=d*d,h=_*d,f=h*e.startPoint.x,f+=3*_*l*e.control1.x,f+=3*d*c*e.control2.x,f+=u*e.endPoint.x,p=h*e.startPoint.y,p+=3*_*l*e.control1.y,p+=3*d*c*e.control2.y,p+=u*e.endPoint.y,o=t+u*a,this._drawPoint(f,p,o);i.closePath(),i.fill()},r.SignaturePad.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)},r.Point=function(e,t,n){this.x=e,this.y=t,this.time=n||(new Date).getTime()},r.Point.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1},r.Point.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},r.Bezier=function(e,t,n,i){this.startPoint=e,this.control1=t,this.control2=n,this.endPoint=i},r.Bezier.prototype.length=function(){var e=0,t=void 0,n=void 0,i=void 0,a=void 0,r=void 0,o=void 0,s=void 0,l=void 0;for(t=0;t<=10;t++)n=t/10,i=this._point(n,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),a=this._point(n,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y),t>0&&(s=i-r,l=a-o,e+=Math.sqrt(s*s+l*l)),r=i,o=a;return e},r.Bezier.prototype._point=function(e,t,n,i,a){return t*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*i*(1-e)*e*e+a*e*e*e},i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(10),a=n(0).utils,r=(n(22).View,n(416).ResultsView),o=n(89).ConnectionUtil,s=n(12).DatetimeUtil,l=(n(5).SVMXObject,n(131)),c=n(7).Data,u={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.api"},d=function(){return a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},_=a.getLoggingService().getLogger("sfmsearch-ui"),h=u.name,f=o;Ext.define(u.name+".DynamicViewIdHelper",{alias:"widget.sfmsearch.dynamicviewidhelper",getGridId:function(e){return"search-result-obj-grid-"+e},getStoreId:function(e){return"store-search-result-"+e}}),Ext.define(u.name+".DownloadOnDemandHelper",{alias:"widget.sfmsearch.dodhelper",triggerDownloadStatusEvent:function(e,t){var n=a.create("com.servicemax.client.lib.api.Event","SFMSEARCH.DOWNLOAD_STATUS_CHANGED",this,{});n.data={status:e,record:t},a.getCurrentApplication().triggerEvent(n)},downloadRecord:function(e,t){var n=this,o=r;if(o.downloadCount===o.maxParallelDownloadCount)return a.Msg.toast({text:a.string.substitute(d().T("FSA008_TAG039"," You can download maximum of {{maxParallelDownloadCount}} record(s) at a time."),{maxParallelDownloadCount:o.maxParallelDownloadCount}),duration:2e3}),void n.triggerDownloadStatusEvent("cancel",e);e.beginEdit(),n.updateDODStatus(e,"downloading"),e.set("online","downloading"),e.endEdit(),n.triggerDownloadStatusEvent("downloading",e);var s=function(t){e.beginEdit(),n.updateDODStatus(e,"downloaded"),e.set("online",""),e.endEdit(),o.downloadCount--,n.triggerDownloadStatusEvent("downloaded",e)},l=function(t){var i="";if(a.getClient().isLaptop())i=t.error.error||t.error;else{var r=a.toObject(t.error.error)||a.toObject(t.error);0===r.StatusCode?i=d().T("FSA004_TAG030","Device is not connected to the internet"):(i=r.ResponseBody||r,a.isObject(i)&&(i=d().T("FSA004_TAG030","Device is not connected to the internet")))}a.Msg.toast({text:i}),e.beginEdit(),n.updateDODStatus(e,"error"),e.set("online","true"),e.endEdit(),o.downloadCount--,n.triggerDownloadStatusEvent("error",e)};if(Ext.isEmpty(e.get("Id")))_.error("Record Id is not found for the Current Record ");else{var c=a.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.DOWNLOAD_RECORD_ON_DEMAND",this,{request:{data:{recordId:e.get("Id"),objectName:t.targetObjectName},dodDefer:e._dodDefer=i.Deferred(),searchDetail:t},responder:{result:a.proxy(this,s),fault:a.proxy(this,l)}}),u=a.getCurrentApplication();o.downloadCount++,u.triggerEvent(c)}},updateDODStatus:function(e,t){e.set("dodstatus",t)},cancelDownloadRecord:function(e){var t=this,n=r;e._dodDefer&&e._dodDefer.reject(function(e){e.success}),e.beginEdit(),t.updateDODStatus(e,""),e.set("online","true"),e.endEdit(),n.downloadCount--,t.triggerDownloadStatusEvent("cancel",e)},openRecord:function(e){var t=e.get("Id");if(Ext.isEmpty(t))_.warn("Record Id not found in Field List to open the record:"+e.get("Id"));else{var n=a.getClient().getServiceRegistry().getService("com.servicemax.client.sfmsearch.platformspecifics").getInstance(),i=l.PIQSearchUtilityHelper.getSearchResultsView();switch(i.searchType){case"SFMSEARCHDELIVERY":i.blockApplication(i.getViewLoadMask());n.showRecord({key:t,objectName:""}).always(function(){i.unblockApplication()});break;case"PRODUCTIQ":i.onRecordSelected(e)}}}}),Ext.define(h+".RecordViewPopOver",{extend:"com.servicemax.client.ui.components.modern.popups.SVMXSheet",alias:"widget.sfmsearch.recordviewpopover",ui:"svmx-default",constructor:function(e){this.callParent(arguments)},record:null,columns:null,centered:!0,modal:!0,cls:"sfmsearch-popover-panel",scrollable:!0,hideOnMaskTap:!0,getDisplayItem:function(e){var t=e,n=a.Deferred(),i=this;return c.getRecord({Id:t.recordId||""}).done(a.proxy(this,function(e){if(e){var a=i.getPopOverDisplayLabel(t);n.resolve(a)}else{t.cls="svmx-search-lookup-disabled",t.handler=null;var r=i.getPopOverDisplayLabel(t);n.resolve(r)}})).fail(a.proxy(this,function(){t.cls="svmx-search-lookup-disabled",t.handler=null;var e=i.getPopOverDisplayLabel(t);n.resolve(e)})),n},getPopOverDisplayLabel:function(e){return{xtype:"svmx.verticalpanel",cls:"sfmsearch-r-view-item",displaySequence:e.sequence,items:[{xtype:"svmx.label",cls:"sfmsearch-r-view-item-label",html:e.label},{xtype:"svmx.label",cls:"sfmsearch-r-view-item-value "+e.cls,html:e.value,listeners:{painted:function(t){t.el.on("tap",e.handler||Ext.emptyFn)}}}]}},dateColumnValueFormatter:function(e,t){return s.getFormattedDatetime(e,s.getDefaultDateFormat())},dateTimeColumnValueFormatter:function(e,t){var n=s,i=n.convertToTimezone(e);return n.getFormattedDatetime(i)},referenceColumnValueFormatter:function(e){var t=l.PIQSearchUtilityHelper.getSearchResultsView();if(t&&"PRODUCTIQ"!==t.searchType){return Ext.String.format("<a href='#' class='sfmsearch-record-view-reference-field' >{0}</a>",e)}return e},getFormattedColumnValue:function(e,t){var n=(e.type,e.format),i=t.get(e.dataIndex),a=e.dataIndex?e.dataIndex+"__key":"",r=(t.get(a),e.displayType),o=i;return Ext.isEmpty(i)||(o="REFERENCE"===r?this.referenceColumnValueFormatter(i):"DATE"===r&&!0==!e.timeColumn?this.dateColumnValueFormatter(i,n):"DATETIME"===r&&!0===e.timeColumn?this.dateTimeColumnValueFormatter(i,n):Ext.String.htmlEncode(i)),o},getButtonText:function(e){var t=e.get("dodstatus"),n=d().T("FSA004_TAG003","Open");return Ext.isEmpty(t)&&"true"===e.get("online")?n=d().T("FSA004_TAG004","Download"):"downloaded"===t?n=d().T("FSA004_TAG003","Open"):"error"===t?n=d().T("FSA004_TAG005","Error Downloading"):"downloading"===t&&(n=d().T("FSA008_TAG044","Downloading...")+" | "+d().T("FSA004_TAG007","<a class='cancel-download-text'>Cancel Download </a>")),n},canHideOpenButton:function(e){var t=!1;return"offline"===e.get("dodstatus")&&(t=!0),t},getButtonState:function(e){var t=e.get("dodstatus"),n="open";return Ext.isEmpty(t)&&"true"===e.get("online")?n="download":"downloaded"===t?n="open":"error"===t?n="error":"downloading"===t?n="downloading":"offline"===t&&(n="offline"),n},initialize:function(){var e=this,t=this,n=50*t.columns.length;n>500&&(n=500),t.setHeight(n);var i=t._record,r=t.columns,o=r.map(function(e){var t=e._dataIndex;return e.columnObj.fld?{dataIndex:t,text:e._text,type:e.xtype,timeColumn:e.timeColumn,skipInViewRecord:e.skipInViewRecord,displayType:e.columnObj.fld.displayType,format:e._format}:{dataIndex:t,text:e._text,type:e.xtype,timeColumn:e.timeColumn,skipInViewRecord:e.skipInViewRecord,format:e._format}}),s=[],l=[];o.map(function(n,a){if(!n.skipInViewRecord){var r=n.dataIndex?n.dataIndex.substring(0,n.dataIndex.indexOf("@__"))+"__key":"",o=i.get(r),c=n.displayType,u=t.getFormattedColumnValue(n,i);u=u||"";var d=t.getDisplayItem({label:n.text,value:u,displayType:c,sequence:a,recordId:o,handler:"REFERENCE"===c&&o?t.openLinkedRecord.bind(e,o,""):null});s.push(d),d.done(function(e){l.push(e)})}}),a.when(s).done(function(){t.add(l.sort(function(e,t){return e.displaySequence-t.displaySequence}));var n=t.currentSearchDetails;a.getCurrentApplication().bind("SFMSEARCH.DOWNLOAD_STATUS_CHANGED",function(e){var n=e.data;if(t.recordLinkButton){var i=n.status;if("downloaded"===i&&(_.info("DOD : Download complete stop connectivity monitor task"),t.task.stop()),"downloading"===i)t.label.setHtml(d().T("FSA008_TAG044","Downloading...")),t.label.addCls("svmx-search-popover-record-link-cancel-button"),t.button.addCls("svmx-search-popover-record-link-cancel-button"),t.button.buttonCurrentStatus=t.getButtonState(n.record),t.button.setText(d().T("FSA004_TAG007","<a class='cancel-download-text'>Cancel Download </a>")),t.label.show();else{t.label.hide(),t.button.removeCls("svmx-search-popover-record-link-cancel-button");var a=t.getButtonText(n.record);t.button.buttonCurrentStatus=t.getButtonState(n.record),t.button.setText(a)}}},e);var r={xtype:"svmx.horizontalpanel",itemId:"popoverRecordViewOpenLink",docked:"bottom",width:"100%",items:[{xtype:"svmx.label",width:"100%",itemId:"popoverRecordViewOpenLinkLabel",hidden:!0,cls:"svmx-search-popover-record-link"},{xtype:"svmx.button",width:"100%",hidden:t.canHideOpenButton(i),itemId:"popoverRecordViewOpenLinkButton",text:t.getButtonText(i),cls:"svmx-search-popover-record-link",buttonCurrentStatus:t.getButtonState(i),listeners:{tap:function(e,a,r){var o=i,s=Ext.create(u.name+".DownloadOnDemandHelper",{}),l=Ext.query(".cancel-download-text").length>0,c=this.buttonCurrentStatus;"open"===c?(s.openRecord(o),t.hide()):"error"===c||("downloading"===c&&l?s.cancelDownloadRecord(o):"download"===c&&s.downloadRecord(o,n))}}}]};t.add(r),t.recordLinkButton=t.down("#popoverRecordViewOpenLink"),t.label=t.down("#popoverRecordViewOpenLinkLabel"),t.button=t.down("#popoverRecordViewOpenLinkButton"),t.initConnectivityTaskForButton(i)})},initConnectivityTaskForButton:function(e){var t=this,n=new Ext.util.TaskRunner;t.isConnected=!0;var i=function(){f.checkConnectivity().then(function(n){"false"===n.toLowerCase()?(t.isConnected=!1,_.info("DOD : Connection lost. Hide button"),"open"!==t.getButtonState(e)&&t.recordLinkButton&&!t.recordLinkButton.isHidden()&&t.recordLinkButton.hide()):t.isConnected||(_.info("DOD : Connection regained. Show button"),t.recordLinkButton&&t.recordLinkButton.isHidden()&&t.recordLinkButton.show())})};t.task=n.newTask({run:i,interval:1e3}),_.info("DOD : Download started. start connectivity task"),t.task.start()},getReferenceElements:function(){var e=this;e.el;return Ext.dom.Query.select(".sfmsearch-record-view-reference-field")},openLinkedRecord:function(e,t){var n=this,i=l.PIQSearchUtilityHelper.getSearchResultsView();if(!i||"PRODUCTIQ"!==i.searchType)if(n.hide(),e){var r=a.getClient().getServiceRegistry().getService("com.servicemax.client.sfmsearch.platformspecifics").getInstance();r.showRecord({key:e,objectName:""})}else{var o=d().T("FSA008_TAG070","No records found");a.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:o,buttons:[{text:d().T("FSA016_TAG003","OK"),itemId:"OK"}]}),_.warn("Record Id not found in Field List to open the record:"+e)}},doDestroy:function(){var e=this;e.getReferenceElements().un("tap",e.openLink),e.callParent()}}),Ext.define(h+".TutorialPopover",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.sfmsearch.tutorial",ui:"svmx-default",cls:"sfmsearch-tutorial-popover",left:0,modal:!0,minHeight:90,hideOnMaskTap:!0,initialize:function(){this.add({xtype:"component",centered:!0,cls:"sfmsearch-tutorial-popover-arrow"})}}),Ext.define(h+".SearchResultGrid",{extend:"com.servicemax.client.ui.components.modern.controls.impl.CollapsibleGrid",alias:"widget.sfmsearch.sfmsearchresultgrid",ui:"svmx-default",showAnimation:null,hideAnimation:null,cls:"sfmsearch-svmx-sfmsearchresultgrid",initialHeightSet:!1,constructor:function(e){e=e||{},e.initialTitle=e.title||"",this.callParent(arguments)},mixins:["Ext.mixin.Responsive"],config:{hide4thColumn:null},hide4thColumn:function(){for(var e=this.getColumns(),t=0,n=0;n<e.length;n++){var i=e[n];if(i.isHidden()||i.skipInViewRecord||(t+=1),4==t)return i.hiddenByResponsive=!0,void i.setHidden(!0)}},show4thColumn:function(){for(var e=this.getColumns(),t=0;t<e.length;t++){var n=e[t];if(n.hiddenByResponsive)return n.hiddenByResponsive=!1,void n.setHidden(!1)}},updateHide4thColumn:function(e){e?this.hide4thColumn():this.show4thColumn()},plugins:["responsive"],responsiveConfig:{"!(width >= 600 && wide)":{hide4thColumn:!0},"width >= 600 && wide":{hide4thColumn:!1}},bufferSize:0,controller:"sfmsearch.SfmSearchResultController",itemConfig:{viewModel:"sfmsearch.SearchResultViewModel"},layout:"fit",autoHeight:!0,listeners:{itemtap:{fn:"onItemTap"}},doDestroy:function(){this.store&&this.store.destroy(),this.config&&this.config.store&&(this.config.store.destroy(),this.config=null),this.callParent()}}),Ext.define(h+".SfmSearchBar",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.sfmsearch.sfmsearchbar",ui:"svmx-default",cls:"sfmsearch-search-bar",constructor:function(e){this.callParent(arguments)},layout:{type:"hbox",align:"start",pack:"start"},initialize:function(e,t){var n=this,i=n.onlineSearchEnabled,r=(n.defaultRecordLimit,n.searchTapHandler),o=[{xtype:"svmx.field.picklist",itemId:"operator",ui:"svmx-default",cls:"x-field-select sfmsearch-operator-picklist",value:d().T("FSA004_TAG024","Contains"),store:"operatorStore",maxWidth:200,queryMode:"local",displayField:"opLabel",valueField:"opValue",flex:1,listeners:{change:function(){var e=Ext.ComponentQuery.query("sfmsearch\\.sfmsearchbar")[0].getComponent("searchButton");e&&e.getText()==d().T("FSA004_TAG014","Reset")&&e.setText(d().T("FSA004_TAG011","Search"))}}},{xtype:"svmx.field.search",itemId:"keyWord",ui:"svmx-default",cls:"sfmsearch-keyword-field",minWidth:60,disabled:!1,placeHolder:d().T("FSA004_TAG008","Search term"),name:"keyWord",enableSearch:!0,enableBarcode:a.getClient().isBarCodeEnabled(),alwaysShowBarcode:!0,flex:1,searchAction:r,listeners:{change:function(){var e=Ext.ComponentQuery.query("sfmsearch\\.sfmsearchbar")[0].getComponent("searchButton");e&&e.getText()==d().T("FSA004_TAG014","Reset")&&e.setText(d().T("FSA004_TAG011","Search"))}},barcodeHandler:function(e,t){r()}},{xtype:"togglefield",itemId:"includeOnline",name:"includeOnline",label:d().T("FSA_TAG_NEW","Online Items"),labelWidth:"80%",value:!1,disabledCls:"sfmsearch-include-online-field-disabled",hidden:!i,cls:"sfmsearch-include-online-field",labelCls:"sfmsearch-include-online-label",listeners:{change:function(e,t){var n=Ext.ComponentQuery.query("sfmsearch\\.sfmsearchbar")[0].getComponent("searchButton");n&&n.getText()===d().T("FSA004_TAG014","Reset")&&n.setText(d().T("FSA004_TAG011","Search"));var i=Ext.ComponentQuery.query("sfm\\.search\\.resultview");if(!Ext.isEmpty(i)){i[0].onlineSearchValueChanged(t)}}}},{xtype:"button",itemId:"searchButton",ui:"button-sfmsearch-search",cls:"sfmsearch-search-button",text:d().T("FSA004_TAG011","Search"),listeners:{tap:r}}];this.add(o),this.disable()}}),a.defineGlobal(u.name,u),e.exports=u},function(e,t,n){n(764);var i=n(767),a=n(417),r=n(188),o=n(768),s=n(769),l=n(60),c=n(383),u=n(770),d=n(0).utils;d.registerDeclaration({id:"com.servicemax.client.sfmdelivery.extension"}),d.registerDeclaration({id:"com.servicemax.client.sfmdelivery.slaclock"}),d.registerDeclaration({id:"com.servicemax.client.sfmdelivery.productiq"}),d.registerDeclaration({id:"com.servicemax.client.sfmdelivery.mobileinventory"}),d.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{define:{name:"SFMDELIVERY.VIEW",type:"com.servicemax.client.mvc.impl.View"}}}),d.registerDefinition({type:"com.servicemax.client.extension",config:{"class-name":"com.servicemax.client.sfmdelivery.engine.EngineUpdaterExtension",event:"com.servicemax.client.onDataChange"}}),d.registerDefinition({type:"com.servicemax.client.sfmconsole.deliveryengine",config:{engine:{id:"sfmdelivery","class-name":"com.servicemax.client.sfmdelivery.engine.DeliveryEngineImpl"}}}),d.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"CONTROLLER",data:[{event:"SFMDELIVERY.GET_PAGELAYOUT",command:"com.servicemax.client.sfmdelivery.commands.GetPageLayout"},{event:"SFMDELIVERY.DESCRIBE_OBJECT",command:"com.servicemax.client.sfmdelivery.commands.DescribeObject"},{event:"SFMDELIVERY.GET_PAGEDATA",command:"com.servicemax.client.sfmdelivery.commands.GetPageData"},{event:"SFMDELIVERY.GET_TEMPLATEDATA",command:"com.servicemax.client.sfmdelivery.commands.GetTemplateData"},{event:"SFMDELIVERY.CLOSE_PROCESS",command:"com.servicemax.client.sfmdelivery.commands.CloseProcess"},{event:"SFMDELIVERY.RETRIEVE_SETTINGS",command:"com.servicemax.client.sfmdelivery.commands.RetrieveSettings"},{event:"SFMDELIVERY.GET_USERINFO",command:"com.servicemax.client.sfmdelivery.commands.GetUserInfo"},{event:"SFMDELIVERY.GET_RECORD_ALREADY_OPEN",command:"com.servicemax.client.sfmdelivery.commands.GetRecordAlreadyOpen"},{event:"SFMDELIVERY.GET_RECORD_CONFLICTED",command:"com.servicemax.client.sfmdelivery.commands.GetRecordConflicted"},{event:"SFMDELIVERY.GET_VIEW_PROCESSES",command:"com.servicemax.client.sfmdelivery.commands.GetViewProcesses"},{event:"SFMDELIVERY.GET_URL_AND_PARAMETERS",command:"com.servicemax.client.sfmdelivery.commands.GetUrlAndParameters"},{event:"SFMDELIVERY.GET_LOOKUPCONFIG",command:"com.servicemax.client.sfmdelivery.commands.GetLookupConfig"},{event:"SFMDELIVERY.SAVE_TARGETRECORD_WARNING",command:"com.servicemax.client.sfmdelivery.commands.SaveTargetRecordWarning"},{event:"SFMDELIVERY.SAVE_TARGETRECORD",command:"com.servicemax.client.sfmdelivery.commands.SaveTargetRecord"},{event:"SFMDELIVERY.SAVE_CHECKLISTRECORD",command:"com.servicemax.client.sfmdelivery.commands.SaveChecklistTargetRecord"},{event:"SFMDELIVERY.GET_NEXTSTEPINFO",command:"com.servicemax.client.sfmdelivery.commands.GetNextStepInfo"},{event:"SFMDELIVERY.INVOKE_EVENTS",command:"com.servicemax.client.sfmdelivery.commands.InvokeEvents"},{event:"SFMDELIVERY.ADD_RECORDS",command:"com.servicemax.client.sfmdelivery.commands.AddRecords"},{event:"SFMDELIVERY.DELETE_RECORDS",command:"com.servicemax.client.sfmdelivery.commands.DeleteRecords"},{event:"SFMDELIVERY.COPY_RECORDS",command:"com.servicemax.client.sfmdelivery.commands.CopyRecords"},{event:"SFMDELIVERY.GET_BUBBLEDATA",command:"com.servicemax.client.sfmdelivery.commands.GetBubbleData"},{event:"SFMDELIVERY.GET_RECORD_TYPES",command:"com.servicemax.client.sfmdelivery.commands.GetRecordTypes"},{event:"SFMDELIVERY.GET_DETAIL_MAPPEDINFO",command:"com.servicemax.client.sfmdelivery.commands.GetDetailMappedInfo"},{event:"SFMDELIVERY.LOOKUP_ITEM_SELECTED",command:"com.servicemax.client.sfmdelivery.commands.LookupItemSelected"},{event:"SFMDELIVERY.NOTIFY_APP_ERROR",command:"com.servicemax.client.sfmdelivery.commands.NotifyApplicationError"},{event:"SFMDELIVERY.NOTIFY_QUICK_MESSAGE",command:"com.servicemax.client.sfmdelivery.commands.NotifyQuickMessage"},{event:"SFMDELIVERY.LIST_ATTACHMENTS",command:"com.servicemax.client.sfmdelivery.commands.ListAttachments"},{event:"SFMDELIVERY.LIST_OUTPUTDOC_ATTACHMENTS",command:"com.servicemax.client.sfmdelivery.commands.ListOutputDocAttachments"},{event:"SFMDELIVERY.EDIT_ATTACHMENT",command:"com.servicemax.client.sfmdelivery.commands.EditAttachment"},{event:"SFMDELIVERY.DELETE_ATTACHMENTS",command:"com.servicemax.client.sfmdelivery.commands.DeleteAttachments"},{event:"SFMDELIVERY.SHARE_ATTACHMENTS",command:"com.servicemax.client.sfmdelivery.commands.ShareAttachments"},{event:"SFMDELIVERY.ATTACH_FILE",command:"com.servicemax.client.sfmdelivery.commands.AttachFile"},{event:"SFMDELIVERY.OPEN_ATTACHMENT",command:"com.servicemax.client.sfmdelivery.commands.OpenAttachment"},{event:"SFMDELIVERY.GET_CHECKLIST_ATTACHMENT_FILE_PATH",command:"com.servicemax.client.sfmdelivery.commands.GetChecklistAttachmentFilePath"},{event:"SFMDELIVERY.OPEN_TELEPHONE",command:"com.servicemax.client.sfmdelivery.commands.OpenTelephone"},{event:"SFMDELIVERY.OPEN_SMS",command:"com.servicemax.client.sfmdelivery.commands.OpenSMS"},{event:"SFMDELIVERY.OPEN_EMAIL",command:"com.servicemax.client.sfmdelivery.commands.OpenEmail"},{event:"SFMDELIVERY.OPEN_BROWSER",command:"com.servicemax.client.sfmdelivery.commands.OpenBrowser"},{event:"SFMDELIVERY.CHECK_IF_CONFLICT",command:"com.servicemax.client.sfmdelivery.commands.CheckIfConflict"},{event:"SFMDELIVERY.GET_PRODUCT_HISTORY",command:"com.servicemax.client.sfmdelivery.commands.GetProductHistory"},{event:"SFMDELIVERY.GET_ONLINE_PRODUCT_HISTORY",command:"com.servicemax.client.sfmdelivery.commands.GetOnlineProductHistory"},{event:"SFMDELIVERY.GET_ACCOUNT_HISTORY",command:"com.servicemax.client.sfmdelivery.commands.GetAccountHistory"},{event:"SFMDELIVERY.GET_ONLINE_ACCOUNT_HISTORY",command:"com.servicemax.client.sfmdelivery.commands.GetOnlineAccountHistory"},{event:"SFMDELIVERY.DOWNLOAD_RECORD_ON_DEMAND",command:"com.servicemax.client.sfmdelivery.commands.DownloadRecordOnDemand"},{event:"SFMDELIVERY.IS_DOD_RECORD",command:"com.servicemax.client.sfmdelivery.commands.IsDodRecord"},{event:"SFMDELIVERY.EVALUATE_ENTRY_CRITERIA",command:"com.servicemax.client.sfmdelivery.commands.ChecklistEntryCriteria"},{event:"SFMDELIVERY.EVALUATE_EXIT_CRITERIA",command:"com.servicemax.client.sfmdelivery.commands.ChecklistExitCriteria"},{event:"SFMDELIVERY.SAVE_TARGETATTACHMENTRECORD",command:"com.servicemax.client.sfmdelivery.commands.SaveTargetAttachmentRecord"},{event:"SFMDELIVERY.CHECKLIST_FILE_ATTACHMENT",command:"com.servicemax.client.sfmdelivery.commands.ChecklistFileAttachment"},{event:"SFMDELIVERY.CUSTOMSNIPPET.GET_DATA_FOR_QUERY_OBJECT",command:"com.servicemax.client.sfmdelivery.commands.GetDataForQueryObject"},{event:"SFMDELIVERY.CUSTOMSNIPPET.GET_CLIENT_TYPE",command:"com.servicemax.client.sfmdelivery.commands.GetClientType"},{event:"SFMDELIVERY.CUSTOMSNIPPET.GET_USER_LANGUAGE",command:"com.servicemax.client.sfmdelivery.commands.GetUserLanguage"},{event:"SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_RECORD",command:"com.servicemax.client.sfmdelivery.commands.GetSfmRecord"},{event:"SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_PICKLIST_VALUES",command:"com.servicemax.client.sfmdelivery.commands.GetPicklistValuesForCustomSnippet"},{event:"SFMDELIVERY.CUSTOMSNIPPET.SET_SFM_FIELD_VALUE",command:"com.servicemax.client.sfmdelivery.commands.SetFieldValueForCustomSnippet"},{event:"SFMDELIVERY.CUSTOMSNIPPET.GET_CUSTOM_EVT_INFO",command:"com.servicemax.client.sfmdelivery.commands.GetCustomEvtInfo"}]}}}),e.exports={impl:i,utils:a,engine:r,commands:o,responders:s,constants:l,operationutils:c,countDownTimer:u}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(50),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(14),v=i(m),g=n(4),y=i(g),S=n(10),E=n(0).utils,b=n(60).Constants,T=n(12).DatetimeUtil,M=n(33).AbstractDeliveryEngine,I=n(0).api,C=n(5).AbstractExtension,A=n(5).SVMXObject,D=n(33).CompositionMetaModel,x=n(417).SFMUtils,R={name:"com.servicemax.client.sfmdelivery.engine"},O=b,L=function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},k=0;R.DeliveryEngineImpl=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this));e.__modifiedFields=[],e.__appCurrentState="",e.__extensions=e.__loadExtensions(),T.setAmPmText(L().T("FSA016_TAG005","AM"),L().T("FSA016_TAG006","PM")),e.__navigationStack=[],e.__logger=E.getLoggingService().getLogger("SFM-DEL-ENGINE-IMPL");var n=E.getCurrentApplication();return e.__clientType=E.getClient().getApplicationParameter("client-type"),"LIGHTNING"===E.getClient().getServiceRegistry().getService("com.servicemax.client.themeservice").getInstance().getCurrentTheme()&&(E.getClient().addApplicationParameter("svmx-sfm-section-label-align","top"),E.getClient().addApplicationParameter("svmx-sfm-section-label-style","font-weight:normal")),n.setApplicationStateHandler(e),n.setApplicationErrorHandler(e),n.setApplicationQuickMessageHandler(n),R.DeliveryEngineImpl.addEngine(e),e.__sm=null,e.__page=null,e.__root=null,e.recordId=null,e.record=null,e.processId=null,e.__settings=null,e.returnUrl=null,e.nextStepId=null,e.__eventBus=null,e.__parentContainer=null,e.__rootContainerId=null,e.__view=null,e.__objectNameMap=null,e.console=null,e.isConflict=null,e.__clonedData=null,e.__modifiedFields=[],e.__appCurrentState="",e.__dataUpdated=!1,e.__UIToBeRendered=!1,e}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initAsync",value:function(e){this.__appId=e&&e.context&&e.context.__appConfig&&e.context.__appConfig.app&&e.context.__appConfig.app.id;var t=E.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=E.create("com.servicemax.client.sfmdelivery.impl.SFMDeliveryEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("SFMDELIVERY.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"__loadExtensions",value:function(){var e=E.getClient(),t=e.getDeclaration("com.servicemax.client.sfmdelivery.extension"),n=e.getDefinitionsFor(t),i={};return E.array.forEach(n,function(e){var t=e.config["extension-type"];i[t]||(i[t]=[]),i[t].push(e)},this),i}},{key:"getExtensions",value:function(e){var t=this.__extensions[e]||[];return E.array.filter(t,function(e){try{var t,n,i,a=e.config,t=a.validator;return!t||!!(i=E.getClass(a["class-name"]))&&(!!(n=i[t])&&n(this.getPageMetaData(),this.getTargetData()))}catch(e){return this.__logger.error("Extension failed to validate: "+e+"; "+a["class-name"]),!1}},this)}},{key:"showMessage",value:function(e){E.getCurrentApplication().showMessage(e)}},{key:"showQuickMessage",value:function(e){E.getCurrentApplication().getApplicationQuickMessageHandler().showQuickMessage(e.message,3e3,e.type)}},{key:"allowSyncPopUp",value:function(){E.getCurrentApplication().getSyncImpl().triggerEvent(new I.Event("EDITMODE_OUT",this,{}))}},{key:"blockSyncPopUp",value:function(){E.getCurrentApplication().getSyncImpl().triggerEvent(new I.Event("EDITMODE_IN",this,{}))}},{key:"notifyApplicationError",value:function(e){if(e){var t=e.message;if(t instanceof Array||(t=[{message:t,messageType:e.messageType,msgDetail:e.msgDetail,serverError:e.serverError,eventType:e.eventType}]),this.__root)this.__root.showErrorUI(t);else{var n=t[0].message;E.getCurrentApplication().showMessage({type:"CUSTOM",title:L().T("FSA008_TAG069","Error"),text:n,buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}]})}}}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"__loadInternal",value:function(e){if(this.__parentContainer=e.container,this.__sourceRecordId=this.recordId=e.recordId,this.record=e.record,this.processId=e.processId,this.additionalInfo=e.additionalInfo||{},this.nextStepId=e.nextStepId,this.returnUrl=e.returnUrl,this.onEngineReady=e.onEngineReady,this.onEngineRendered=e.onEngineRendered,this.requestClose=e.requestClose,this.onLoadFailed=e.onLoadFailed,this.console=e.console,"CHECKLIST"!==this.additionalInfo.sfwActionType){E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance().getQualificationInfo(this.recordId,this.record,this.processId,this.additionalInfo.isDataFromExternalApp,E.proxy(this,"__onQualificationInfoResponse"))}else this.__onQualificationInfoResponse({isSFMProcess:!0,isQualified:!0})}},{key:"__onQualificationInfoResponse",value:function(e){var t=this.getEventBus(),n=null,i=this,a=this,r=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();if(e.isSFMProcess&&e.isQualified){var o=E.getClient().getProgressMonitor();!0===E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr")&&E.create("com.servicemax.client.lib.core.MiniSplash",o),o.start({params:{stepTitle:"Loading SFM Delivery Engine..."}}),!i.processId&&i.additionalInfo&&"CHECKLIST"!==i.additionalInfo.sfwActionType?(o.finish(),n=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_APP_ERROR",i,{request:{deliveryEngine:a,message:"Process Id is missing!"},responder:{}}),t.triggerEvent(n)):(n=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_USERINFO",i,{request:{},responder:E.create("com.servicemax.client.sfmdelivery.responders.GetUserInfoResponder",i)}),t.triggerEvent(n),o.finishStep({stepTitle:"Retrieving user information..."}))}else{i.__logger.error("Not qualified!");r.getBasicDisplayTags();E.getCurrentApplication().showMessage({type:"CUSTOM",title:" ",text:e.errorMessage,buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:E.proxy(i,function(){i.handleInplaceBackwardNavigation()})}),this.onLoadFailed&&this.onLoadFailed.handler.apply(this.onLoadFailed.context),this.unblockApplication()}}},{key:"closeProcess",value:function(){var e=this.getEventBus();if(e&&this.getRootContainerId()){var t=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CLOSE_PROCESS",this,{request:{requesterId:this.getRootContainerId()}});e.triggerEvent(t)}}},{key:"__cleanUp",value:function(){this.closeProcess(),this.__root&&(this.__root.destroy&&this.__root.destroy(),this.__root.doCleanup&&this.__root.doCleanup(),delete this.__root),this.__page&&(this.__page.doCleanup(),delete this.__page)}},{key:"doCleanup",value:function(){this.__cleanUp();var e=E.getCurrentApplication();return e.setApplicationStateHandler(null),e.setApplicationErrorHandler(null),e.setApplicationQuickMessageHandler(null),R.DeliveryEngineImpl.removeEngine(this),this.setPropertyForCleanup(["record","__eventBus","__settings","__clonedData"],!0),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"doClose",value:function(){if(this.requestClose)this.requestClose.handler.apply(this.requestClose.context);else{var e=this.returnUrl;e&&""!=e&&(-1!=e.indexOf("%2F")&&(e="/"+e.substring(3,e.length)),E.navigateToCheckExternal?E.navigateToCheckExternal(e,!1):E.navigateTo(e)),E.doLater(function(){this.doCleanup()},this)}}},{key:"onCanClose",value:function(e){!this.__root||this.getPageMetaData().isDisplayOnly?e(!0):this.__root.cancel(!1,e)}},{key:"updateNavigationStack",value:function(e,t){if(!e)return this.__navigationStack.pop();this.__navigationStack.push(t)}},{key:"getNavigationStack",value:function(){return this.__navigationStack}},{key:"handleInplaceForwardNavigation",value:function(e){this.closeProcess();var t=null;this.getPageMetaData()&&this.getPageMetaData().getData()&&(t=this.getPageMetaData().getData().processTitle),this.updateNavigationStack(!0,{recordId:this.getSourceRecordId(),record:this.record,processId:this.processId,additionalInfo:this.additionalInfo,sfmProcessTitle:t});var n=e.recordId,i=e.record,a=e.processId,r=e.additionalInfo||{},o=this.__parentContainer,s=this.onEngineReady,l=this.onEngineRendered;this.onLoadFailed;void 0!==e.isLinkedSFM&&(r.isLinkedSFM=e.isLinkedSFM);var c={recordId:n,record:i,processId:a,returnUrl:this.returnUrl,nextStepId:"",container:o,onEngineReady:s,onEngineRendered:l,requestClose:this.requestClose,onLoadFailed:this.onLoadFailed,console:this.console,additionalInfo:r};this.__loadInternal(c)}},{key:"handleInplaceBackwardNavigation",value:function(){this.closeProcess();var e=this.updateNavigationStack(!1);if(e){var t=e.recordId,n=e.record,i=e.processId,a=e.additionalInfo||{},r=this.__parentContainer,o=this.onEngineReady,s=this.onEngineRendered,l=this.onLoadFailed,c={recordId:t,record:n,processId:i,returnUrl:this.returnUrl,nextStepId:"",container:r,onEngineReady:o,onEngineRendered:s,onLoadFailed:l,requestClose:this.requestClose,console:this.console,additionalInfo:a};this.__loadInternal(c)}else this.doClose()}},{key:"navigateToViewprocess",value:function(e){var t;this.closeProcess();var n=e.recordId,i=e.record,a=e.processId,r=e.additionalInfo||{},o=e.engine,l=o.getRootContainerId(),c=o.nextStepId,u=o.returnUrl,d=o.onEngineReady,_=o.onEngineRendered,h=o.onLoadFailed,f=(t={recordId:n,record:i,processId:a,returnUrl:this.returnUrl,nextStepId:"",container:l},(0,s.default)(t,"returnUrl",u),(0,s.default)(t,"nextStepId",c),(0,s.default)(t,"onEngineReady",d),(0,s.default)(t,"onEngineRendered",_),(0,s.default)(t,"onLoadFailed",h),(0,s.default)(t,"requestClose",this.requestClose),(0,s.default)(t,"console",this.console),(0,s.default)(t,"additionalInfo",r),t);this.__loadInternal(f)}},{key:"appDataHasBeenUpdated",value:function(e){if(e.engine!=this){if("CHECKLIST LIST"===this.getMetaModel().getProcessType())return void this.processPageData();if(e.changedData)for(var t=0;t<e.changedData.length;t++){var n=e.changedData[t].Id,i=this.getHeaderAndDetailIds();(i&&i.hasOwnProperty(n)||n==this.recordId)&&("VIEW RECORD"===this.getMetaModel().getProcessType()?this.setDataUpdated(!0):this.processPageData())}}}},{key:"run",value:function(e){this.__logger.debug("Finally running delivery engine!!!");var t=e.SVMX_recordId||E.getUrlParameter("SVMX_recordId"),n=e.SVMX_record,i=e.SVMX_processId||E.getUrlParameter("SVMX_processId"),a=e.SVMX_retURL||E.getUrlParameter("SVMX_retURL"),r=e.SVMX_NxtStepID||E.getUrlParameter("SVMX_NxtStepID"),o=e.SVMX_action||E.getUrlParameter("SVMX_action");o="null"!==o?o:null,i="null"!==i?i:null,t="null"!==t?t:null;var s=e.additionalInfo||{};s.sfwActionType||(s.sfwActionType=o),e.additionalInfo||(s.targetId=E.getUrlParameter("SVMX_targetId"),s.status=E.getUrlParameter("SVMX_status"),s.sfProcessId=E.getUrlParameter("SVMX_sfProcessId"));var l="CONSOLE"===E.getClient().getApplicationParameter("sfmconsole-runtime-mode");!l&&!n&&!t&&"svmx_sfm_delivery_test_record"in window&&(t=window.svmx_sfm_delivery_test_record),!l&&!i&&"svmx_sfm_delivery_test_process"in window&&(i=window.svmx_sfm_delivery_test_process),"CHECKLIST"===e.SVMX_action&&(s.parent=e.parent);var e={recordId:t,record:n,processId:i,returnUrl:a,nextStepId:r,sfwActionType:o,onEngineReady:e.onReady,onEngineRendered:e.onRendered,requestClose:e.requestClose,onLoadFailed:e.onLoadFailed,container:e.container,console:e.console,additionalInfo:s};this.__loadInternal(e)}},{key:"onGetUserInfoCompleted",value:function(e){var t=E.getClient(),n=E.create("com.servicemax.client.lib.api.Event","GLOBAL.HANDLE_USER_INFO",this,e);t.triggerEvent(n);var i=E.getClient().getProgressMonitor(),a=this.getEventBus(),r=null;this.__page&&this.__page.__dataModel&&this.__page.__dataModel.__data&&this.__page.__dataModel.__data.__data&&this.__page.__dataModel.__data.__data.sfmData&&(r=this.__page.__dataModel.__data.__data.sfmData.sourceRecord);var o=E.create("com.servicemax.client.sfmconsole.utils.EventCollection",a,[E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PAGELAYOUT",this,{request:{recordId:this.recordId,processId:this.processId,additionalInfo:this.additionalInfo,sourceRecord:r}}),E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_RECORD_ALREADY_OPEN",this,{request:{recordId:this.recordId,additionalInfo:this.additionalInfo}})]);0==this.getNavigationStack().length&&o.addEvent(E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.RETRIEVE_SETTINGS",this,{request:{moduleId:"SFM002"}})),i.finishStep({stepTitle:"Retrieving pagelayout and settings..."}),i.start({params:{stepTitle:"Processing pagelayout and settings..."}}),o.triggerAll(function(t){var n=t.items(),a=n.length,r=void 0,o=void 0,s=null;for(r=0;r<a;r++){var l=n[r];"SFMDELIVERY.GET_RECORD_ALREADY_OPEN"===l.type()&&(o=l.response)}for(r=0;r<a;r++){var l=n[r];"SFMDELIVERY.GET_PAGELAYOUT"==l.type()?(this.__cleanUp(),E.getClient().getApplicationParameter("svmx-sfm-delivery-disable-test-record-open")||!o||"STANDALONE EDIT"!=l.response.response.sfmProcessType&&"SOURCE TO TARGET CHILD"!=l.response.response.sfmProcessType&&"CHECKLIST"!=l.response.response.sfmProcessType||("CHECKLIST"==l.response.response.sfmProcessType?this.additionalInfo.specialProcessType="VIEW":l.response.response.sfmProcessType="VIEW RECORD",this.showMessage({type:"CUSTOM",text:L().T("FSA008_TAG123","Opening as view-only because this record is already opened for editing"),buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:function(){}})),s=l.response.response.sfmProcessType,this.__page=!s||"CHECKLIST"!==s&&"CHECKLIST LIST"!==s?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageMetaModel",l.response,e,this):E.create("com.servicemax.client.sfmdelivery.engine.SFMChecklistPageMetaModel",l.response,e,this),this.__page&&this.__page.getData()&&this.__page.getData().processTitle&&(this.__page.getData().processTitle=Ext.String.htmlEncode(this.__page.getData().processTitle)),"CHECKLIST"===s&&(this.__page._sourceRecord=l.__event.data.request.sourceRecord),void 0!==l.__event.data.request.additionalInfo.targetId&&null!=l.__event.data.request.additionalInfo.targetId||(this.__page.checklistStatus="Not Started"),this.__objectNameMap={header:l.response.page.header.headerLayout[E.OrgNamespace+"__Object_Name__c"]},E.array.forEach(l.response.page.details,function(e){this.__objectNameMap[e.DetailLayout.Id]=e.DetailLayout[E.OrgNamespace+"__Object_Name__c"]},this),this.__lookupDisplayFieldMap=l.response.lookupDisplayFieldMap):"SFMDELIVERY.RETRIEVE_SETTINGS"==l.type()&&(this.__settings=E.create("com.servicemax.client.sfmdelivery.engine.Settings",l.response))}this.__page.initialize(function(){i.finishStep({stepTitle:"Processing pagelayout and settings..."}),i.start({params:{stepTitle:"Starting to layout..."}}),null!=this.__rootContainerId&&void 0!=this.__rootContainerId||(this.__rootContainerId="svmx_sfm_delivery_root_container"+k++);var e={id:this.__rootContainerId,deliveryEngine:this,consoleAppInstance:this.console};this.__parentContainer||(e.renderTo=E.getDisplayRootId());var t=null;t=!s||"CHECKLIST"!==s&&"CHECKLIST LIST"!==s?this.__view.createComponent("ROOTCONTAINER",e):this.__view.createComponent("CHECKLISTROOTCONTAINER",e),t&&(t.blockApplication(),"VIEW RECORD"!=s&&t.compose(this.__page),this.__root=t),i.finish(),this.processPageData();var n=E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr"),a=window.device&&window.device.platform&&window.device.platform.toLowerCase();(n||"android"===a||"productIQ"===this.__appId)&&this.onEngineReady?this.onEngineReady.handler.apply(this.onEngineReady.context):this.__UIToBeRendered=!0},this)},this)}},{key:"getRootContainerId",value:function(){return this.__rootContainerId}},{key:"getObjectNameMap",value:function(){return this.__objectNameMap}},{key:"notifyDataChange",value:function(e){this.recordId===e.recordId&&this.processPageData()}},{key:"setDataUpdated",value:function(e){this.__dataUpdated=e}},{key:"getDataUpdated",value:function(){return this.__dataUpdated}},{key:"processPageData",value:function(){var e=this.getEventBus(),t=this.getMetaModel().getProcessType(),n="CHECKLIST LIST"===t?"SFMDELIVERY.GET_TEMPLATEDATA":"SFMDELIVERY.GET_PAGEDATA",i=!0;"CHECKLIST"===t&&this.additionalInfo&&(this.checklistId=this.additionalInfo.targetId,!1===this.additionalInfo.qualify&&(i=!1));var a={recordId:this.recordId,targetId:this.checklistId,processId:this.processId,qualify:i,refreshData:!1,objectNameMap:this.getObjectNameMap(),lookupDisplayFieldMap:this.__lookupDisplayFieldMap,layout:this.getMetaModel().getDeliveryEngine().__page.getData(),objMetadataTypeMap:this.getMetaModel().getDeliveryEngine().__page.objMetadataTypeMap};this.getNavigationStack().length>0?(a.qualify=i,a.requesterId=this.getRootContainerId()):a.requesterId=this.getPageMetaData().isDisplayOnly?null:this.getRootContainerId();var r=E.create("com.servicemax.client.lib.api.Event",n,this,{request:a,responder:E.create("com.servicemax.client.sfmdelivery.responders.GetPageDataResponder",this)});e.triggerEvent(r);var o=this.record&&this.record.attributes&&this.record.attributes.type,s=E.OrgNamespace+"__Service_Order__c";(o!==s||o===s&&!E.getClient().getApplicationParameter("InstallBase"))&&this.__root&&this.__root.run()}},{key:"onGetPageDataCompleted",value:function(e){var t=!0;if(this.getPageMetaData()&&this.getPageMetaData().isDisplayOnly)try{var n=E.getClient().getApplicationParameter("enable-sla-clock");if(this.__root&&n&&e&&e.__data){var i=e.__data.pageDataSet.sobjectinfo.attributes.type,a=this.__page.getObjectLabel(i);if("Work Order"==a||"Case"==a){var r=E.getClient().getDeclaration("com.servicemax.client.sfmdelivery.slaclock");if(r){var o=E.getClient().getDefinitionsFor(r);if(o&&o.length>0){var s=o[0],l=s.config["class-name"];this.slaclockobj=E.create(l,{object_data:e,object_settings:this.__settings.__data,container:this.__root.__childrenCollection[0],objectType:a,user_info:this.__page.__userInfo,rootId:this.getRootContainerId()})}}}}}catch(e){this.__logger.error("Warning : SLA CLOCK NOT SUPPORTED",e)}if(0==e.isQualified)return this.unblockApplication(),E.getCurrentApplication().showMessage({type:"CUSTOM",title:" ",text:L().T("FSA008_TAG124","Record saved successfully, but does not meet the qualification criteria for this SFM transaction any longer. This transaction will now close."),buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:E.proxy(this,function(e){this.handleInplaceBackwardNavigation()})}),void this.triggerViewLoadedEvent(t,!1,this);if(e&&e.getError()&&0==S.isEmptyObject(e.getError()))return this.unblockApplication(),E.getCurrentApplication().showMessage({type:"CUSTOM",title:" ",text:e.getError(),buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:E.proxy(this,function(e){this.doClose()})}),void this.triggerViewLoadedEvent(t,!1,this);this.recordId=e.getValueFromPath("Id"),delete this.record;var c=E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");"STANDALONE EDIT"!==this.getMetaModel().getProcessType()||this.additionalInfo.isDataFromExternalApp||c||(e.__originalData=E.cloneObject(e.__data.sfmData)),this.__UIToBeRendered&&this.onEngineReady&&(this.__UIToBeRendered=!1,this.onEngineReady.handler.apply(this.onEngineReady.context)),this.__root&&"VIEW RECORD"==this.getMetaModel().getProcessType()&&!this.getTargetData().getData()?(this.__clonedData=E.cloneObject(e.__data.sfmData.getRawValues()),this.getTargetData().setData(e,!1),this.__root.compose(this.__page),t=!0):(t=!1,this.__root&&"VIEW RECORD"==this.getMetaModel().getProcessType()&&(this.__modifiedFields=this.getModifiedFields(this.__clonedData,e.__data.sfmData.getRawValues()),this.__clonedData=E.cloneObject(e.__data.sfmData.getRawValues()),t=!0),this.getTargetData().setData(e,!0,this.__modifiedFields,t)),this.__root&&this.__root.__sfwPanel&&this.__root.__sfwPanel.__sfw.doReload&&(this.__root.__sfwPanel.__sfw.reload(),this.__root.__sfwPanel.__sfw.doReload=!1);var u=E.create("com.servicemax.client.lib.api.Event","DATA_LOADED",this,this.__page.getDataModel());this.getEventBus().triggerEvent(u),this.__userTrunk=e.__data.svmxConstants&&E.array.filter(e.__data.svmxConstants,function(e){return"SVMX.USERTRUNK"===e.key})[0],this.__userTrunk&&(this.__userTrunk=this.__userTrunk.value);var d=this.__page.getHeaderMetaModel().getPageEventInfoFor("On Load");if(d){this.blockApplication();var u,_=this.getEventBus();u=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:[d],data:this.getTargetData().getData(),metadata:this.getPageMetaData().getRawPageMetaData(),deliveryEngine:this,additionalInfo:{sfmProcessId:this.processId,nextStepId:this.nextStepId},invokedFrom:"On Load"},responder:E.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)}),_.triggerEvent(u)}var i=e.__data.pageDataSet.sobjectinfo.attributes.type,h=this.__page.getObjectLabel(i);if(this.onEngineRendered){var f=e.__data.pageDataSet.sobjectinfo.getNameValue?e.__data.pageDataSet.sobjectinfo.getNameValue()||"":"";if(this.__root.__sfwPanel){var p=this.__root.__sfwPanel.defaultTitle+": "+f;p=Ext.String.htmlEncode(p),this.__root.__sfwPanel.setTitle(p)}f&&(f=Ext.String.htmlEncode(f)+": &nbsp;&nbsp;"),this.onEngineRendered.handler.apply(this.onEngineRendered.context,[h,f+this.__page._data.processTitle])}if(this.updateConflictState(),this.getRoot()){this.getRoot().onDataUpdated(this.getTargetData());this.getTargetData().getData().getRawData().sfmData.attributes.type===E.OrgNamespace+"__Service_Order__c"&&E.getClient().getApplicationParameter("InstallBase")&&this.__root&&this.__root.run(),E.timer.job(this.getRoot().getId()+".unblockApplication",50,this,"unblockApplication"),this.triggerViewLoadedEvent(t,!0,this)}}},{key:"getModifiedFields",value:function(e,t){var n=[];for(var i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&n.push(i);return n}},{key:"triggerViewLoadedEvent",value:function(e,t,n){if(e&&this.__clientType&&"laptop"===this.__clientType.toLowerCase()){var i=E.getCurrentApplication(),a=null;t&&(a=n.requestClose.context);var r=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.VIEW_LOADED",n,a);i.triggerEvent(r)}}},{key:"loadViewProcesses",value:function(e,t,n){if(this.getPageMetaData().isDisplayOnly){var i=this.getEventBus(),a=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_VIEW_PROCESSES",this,{request:{record:e},responder:E.proxy(this,"viewProcessesLoaded",t,n)});i.triggerEvent(a)}}},{key:"viewProcessesLoaded",value:function(e,t,n){n=t?E.array.map(n,function(e){return e.isCurrentView=this.processId===e.process_unique_id,e},this):E.array.filter(n,function(e){return this.processId!=e.process_unique_id},this),this.getPageMetaData().setAssociatedViewProcesses(n),this.getRoot()&&this.getRoot().setAssociatedViewProcesses(this.getPageMetaData().associatedViewProcesses),e&&e(n)}},{key:"updateConflictState",value:function(){var e=this.getEventBus(),t=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_RECORD_CONFLICTED",this,{request:{recordId:this.recordId},responder:E.proxy(this,"setConflictState")});e.triggerEvent(t)}},{key:"setConflictState",value:function(e){var t=Boolean(this.__isConflict);this.__isConflict=Boolean(e),this.getRoot()&&this.getRoot().setConflictState(e),e&&t!=this.__isConflict&&!this.getPageMetaData().isDisplayOnly&&this.showMessage({type:E.baseCSSPrefix+"sfmd-sync-conflict-medium-icon",text:L().T("FSA008_TAG125","This record has changed on the server.  Editing this record may result in errors"),buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:function(){}})}},{key:"onInvokeEventsComplete",value:function(){this.unblockApplication()}},{key:"onInvokeCustomEventsComplete",value:function(e){var t="",n={};"success"!=e.status?(this.__logger.error("Validation_Error for custom snippet : ",e.error_message),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",n.error_msg=e.error_message):(console.log("Response from snippet: No errors found"),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETSUCCESS");var i=E.getCurrentApplication().getCurrentView().getDeliveryEngine().getEventBus(),a=E.create("com.servicemax.client.lib.api.Event",t,this,{request:n,responder:{}});i.triggerEvent(a),this.unblockApplication()}},{key:"blockApplication",value:function(e){var t=e||{newState:"block"},n=this.getEventBus(),i=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CHANGE_APP_STATE",this,t);n.triggerEvent(i)}},{key:"unblockApplication",value:function(e){var t=e||{newState:"unblock"},n=this.getEventBus(),i=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CHANGE_APP_STATE",this,t);n.triggerEvent(i)}},{key:"getTargetData",value:function(){return this.__page.getDataModel()}},{key:"getPageMetaData",value:function(){return this.__page}},{key:"getHeaderAndDetailIds",value:function(){var e=this.getTargetData(),t=e&&e.getData();return t&&t.headerAndDetailIds}},{key:"getMetaModel",value:function(){return this.__page}},{key:"saveToModel",value:function(e){return this.__page.getDataModel().readBindings(e)}},{key:"resolveModel",value:function(){return this.__page.getDataModel().resolveBindings()}},{key:"getSettings",value:function(){return this.__settings}},{key:"getRoot",value:function(){return this.__root}},{key:"getUserTrunk",value:function(){return null===this.__userTrunk||void 0===this.__userTrunk?"":this.__userTrunk}},{key:"getSourceRecordId",value:function(){return this.__sourceRecordId}},{key:"getRecordId",value:function(){return this.recordId}},{key:"isFieldUpdatesEnabled",value:function(){return!1!==E.getClient().getApplicationParameter("svmx-fieldvalue-updates-enable")}},{key:"refreshFromServer",value:function(e,t){var n=(this.getEventBus(),E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DOWNLOAD_RECORD_ON_DEMAND",this,{request:{data:{recordId:e.recordId,objectName:e.objectName},callback:t}}));E.getCurrentApplication().triggerEvent(n)}},{key:"isRecordDownloadedOnDemand",value:function(){var e=S.Deferred(),t=this.getEventBus(),n=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.IS_DOD_RECORD",this,{request:{recordId:this.recordId},responder:function(t){t&&t.length>0?e.resolve(!0):e.resolve(!1)}});return t.triggerEvent(n),e}}],[{key:"addEngine",value:function(e){this.engines.push(e)}},{key:"removeEngine",value:function(e){E.array.remove(this.engines,e)}}]),t}(M),R.DeliveryEngineImpl.engines=[],R.EngineUpdaterExtension=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e,t){for(var n=0;n<R.DeliveryEngineImpl.engines.length;n++){R.DeliveryEngineImpl.engines[n].appDataHasBeenUpdated(t)}var i=new S.Deferred;return i.resolve(),i}}]),t}(C),R.Settings=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));n.__data={};var i=e.stringMap,a=void 0,r=i.length,o=void 0;for(a=0;a<r;a++)o=i[a],n.__data[o.key]=o.value;return n}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getSetting",value:function(e,t){var n=this.__data[e];return t&&n&&"bool"==t&&(n="true"==n.toLowerCase()),n}}]),t}(A),R.SFMPageModel=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.__allBindings=[],n.__allBindingsHash={},n.__detailsBindings={},n.__parent=e,n.__logger=E.getLoggingService().getLogger("SFMDELIVERY-PAGE-MODEL"),n.__data=null,n.__isBindingExecuting=!1,n}return(0,y.default)(t,e),(0,h.default)(t,[{key:"doCleanup",value:function(){return this.__data&&this.__data.unbindContext(this),this.setPropertyForCleanup(["__allBindings","__allBindingsHash","__detailsBindings"]),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"setData",value:function(e,t,n,i){this.__data=e,this.__parent.evaluateFieldUpdateRules(),this.__data.bind("MODEL_UPDATED",function(){this.executeBinding()},this),this.__data.bind("DETAIL_RECORDS_CLONED",function(e){this.__onNewRecordsCloned(e.data)},this),this.__data.bind("DETAIL_RECORDS_ADDED",function(e){this.__onNewRecordsAdded(e.data)},this),this.__data.bind("DETAIL_RECORDS_DELETED",function(e){var t=e.data.bindingPath,n=e.data.lines;this.__detailsBindings[t].onRecordsDeleted(n)},this),this.__data.bind("DETAIL_RECORDS_COPY",function(e){this.__onNewRecordsCopy(e.data)},this),t&&(i?this.executeBindingForViewWithDetails(n):this.executeBinding())}},{key:"__onNewRecordsCloned",value:function(e){var t=e.bindingPath,n=e.newRecords.lines,i=e.onSuccess,a=void 0,r=n.length;for(a=0;a<r;a++){var o=n[a];n[a]=this.__restructureDetailLine(o,t)}this.__detailsBindings[e.bindingPath].onNewRecordsCloned({lines:n},i),i()}},{key:"__onNewRecordsAdded",value:function(e){var t=e.bindingPath,n=e.bindingPath.replace(/^details\./,""),i=e.newRecords.lines,a=e.onSuccess,r=void 0,o=i.length;for(r=0;r<o;r++){var s=i[r];i[r]=this.__restructureDetailLine(s,t)}var l=this.__parent.getDeliveryEngine(),c=l.getEventBus(),u=l.processId,d=(E.array.get(this.__parent.getData().page.details,function(e){return e.dtlLayoutId==n}),E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_DETAIL_MAPPEDINFO",this,{request:{processId:u,alias:n},responder:E.create("com.servicemax.client.sfmdelivery.responders.GetDetailMappedInfoResponder",this,i,e.bindingPath,a)}));c.triggerEvent(d)}},{key:"__onNewRecordsCopy",value:function(e){var t=e.bindingPath,n=e.newRecords.lines,i=e.onSuccess,a=void 0,r=n.length;for(a=0;a<r;a++){var o=n[a];n[a]=this.__restructureDetailLine(o,t)}this.__detailsBindings[e.bindingPath].onNewRecordsCopy({lines:n},i),i()}},{key:"getModelRoot",value:function(){return this.__parent}},{key:"onGetDetailMappedInfoComplete",value:function(e,t,n,i){var a=this.__parent.getDetailMetaModel().getDetail(n),o=(t.length,e.mappedValues),s=e.mappedLiterals.sort(function(e,t){return e.value.match(/^SVMX.CURRENTRECORD\./)?1:-1}),l=a.objectName,c=this.getModelRoot().getRecordTypesFor(l),u=(a.getRoot().getUserInfo().DateFormat,a.getRoot().getUserInfo().TimeFormat,a.getRoot().objMetadataMap[l]),d=u.fields;E.array.forEach(t,E.proxy(this,function(e,t){var n,i,l;for(n=0;n<o.length;n++){var u,_;if(i=o[n],l=e[i.key],"RecordTypeId"==i.key){var h=e[i.key+"__key"];h&&function(){var e=h.key;u=E.array.get(c,function(t){return t.recordTypeId==e})}(),u&&(_=u.name)}if(l){e[i.key]=i.value;var f=a.getFieldInfo(i.key);if(f&&"boolean"===f.datatype){var p=e[i.key+"__key"];p&&p.value!=i.value&&(p.key=i.value)}"RecordTypeId"==i.key&&(e[i.key]=_)}l=e[i.key+"__key"],l&&l.value!=i.value&&(l.value=i.value,"RecordTypeId"===i.key&&(u?(l.value=u.name,l.key=u.recordTypeId):l.key=""))}var m,v,g,y,S,b=E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr"),M={};b||(OfflineCacheUtils=com.servicemax.client.offline.sal.model.utils.Cache,OfflineCacheUtils.registerJSCache("LOCATION_TRACKING",1),M=OfflineCacheUtils.readFromJSCache("LOCATION_TRACKING","CURRENT_LOCATION"));for(var n=0;n<s.length;n++){y=s[n];var I=s[n].key,m=null,C=e[I];if(S=E.array.filter(d,function(e){return e.name==I})[0],S&&(m=S.type),g=y.value,v=g,-1!=E.array.indexOf(["Now","Today","Tomorrow","Yesterday"],y.value))v=T.macroDrivenDatetime(y.value,"YYYY-MM-DD","HH:mm:ss"),"Now"!==y.value&&"datetime"===m&&(v=T.convertToTimezone(v,void 0,!0)),g=v;else if(-1!=E.array.indexOf(["SVMX.NOW","SVMX.TODAY","SVMX.TOMORROW","SVMX.YESTERDAY"],y.value))v=T.macroDrivenDatetime(y.value.replace(/SVMX\./,""),"YYYY-MM-DD","HH:mm:ss"),"SVMX.NOW"!==y.value&&"datetime"===m&&(v=T.convertToTimezone(v,void 0,!0)),g=v;else if(y.value.match(/SVMX\.CURRENTRECORDHEADER\./)){var A=y.value.match(/SVMX\.CURRENTRECORDHEADER\.(.*)/)[1],D=a.getRoot(),x=D.getDataModel().__allBindingsHash;g=x[A]?x[A].__getter.call(x[A].__context):D.getDeliveryEngine().getTargetData().getData().getRawValues()[A],v=g}else if(y.value.match(/SVMX\.CURRENTRECORD\./)){var A=y.value.match(/SVMX\.CURRENTRECORD\.(.*)/)[1];e[A+"__key"]?(g=e[A+"__key"].value,v=e[A+"__key"].key):(g=e[A],v=g)}else if(y.value.match(/SVMX\.USERTRUNK/))!0===E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr")?(g=a.getRoot().getDeliveryEngine().getUserTrunk(),v=g):(g=E.getCurrentApplication().getUserInfo().UserTrunkDetail?E.getCurrentApplication().getUserInfo().UserTrunkDetail.Name:null,v=E.getCurrentApplication().getUserInfo().UserTrunkDetail?E.getCurrentApplication().getUserInfo().UserTrunkDetail.Id:null);else if(y.value.match(/SVMX\.CURRENTUSERID/))g=E.getCurrentApplication().getUserInfo().UserName,v=E.getCurrentApplication().getUserInfo().UserId;else if(-1!=E.array.indexOf(["SVMX.GEOLOCATION.COORDS.ACCURACY","SVMX.GEOLOCATION.COORDS.LATITUDE","SVMX.GEOLOCATION.COORDS.LONGITUDE"],y.value)){switch(y.value){case"SVMX.GEOLOCATION.COORDS.ACCURACY":g=M&&M.success&&M.accuracy?M.accuracy:"";break;case"SVMX.GEOLOCATION.COORDS.LATITUDE":g=M&&M.success&&M.location.lat?M.location.lat:"";break;case"SVMX.GEOLOCATION.COORDS.LONGITUDE":g=M&&M.success&&M.location.lng?M.location.lng:""}v=g}null!==g&&void 0!==g||(v=g=""),"date"===m&&g&&g.match(/\:/)||"datetime"===m&&g&&("object"===(void 0===g?"undefined":(0,r.default)(g))?!x[A]&&g.fieldvalue.value&&g.fieldvalue.value.match(/\:/)?(v=g.fieldvalue.key,g=T.getFormattedDatetime(T.parseDate(g.fieldvalue.value),T.getDefaultDatetimeFormat())):x[A]&&g.value&&g.value.match(/\:/)&&(g=T.getFormattedDatetime(T.parseDate(g.value),T.getDefaultDatetimeFormat())):"string"!=typeof g||g.match(/\:/)||(g=T.getFormattedDatetime(T.parseDate(g),T.getDefaultDatetimeFormat()))),"object"===(void 0===g?"undefined":(0,r.default)(g))&&"value"in g?(e[y.key]=g.value,e[y.key+"__key"]={value:g.value,key:g.key}):"object"===(void 0===g?"undefined":(0,r.default)(g))&&"fieldvalue"in g?(e[y.key]=g.fieldvalue.value,e[y.key+"__key"]={fieldvalue:{value:g.fieldvalue.value,key:g.fieldvalue.key}}):"reference"==m&&C?e[y.key]=C:(e[y.key]=g,y.key+"__key"in e?(e[y.key+"__key"].key=v,e[y.key+"__key"].value=g):e[y.key+"__key"]={key:v,value:g})}})),this.__detailsBindings[n].onNewRecordsAdded({lines:t}),i()}},{key:"__restructureDetailLine",value:function(e,t){var n=void 0,i={},a=null,o=void 0;for(n in e)if("attributes"!=n&&"attributes__key"!=n)if("__new"==n)i[n]=e[n];else{var s=e[n];s&&"object"===(void 0===s?"undefined":(0,r.default)(s))&&(a=s.fieldvalue)&&(i[n+"__key"]=a,o=this.__parent.getDetailMetaModel().getDetail(t).translate(s.fieldapiname,"RecordTypeId"==n&&a.key?a.key:a.value,a),i[n]=o)}for(n in i)e[n]=i[n];return e}},{key:"resolveBindings",value:function(){var e=void 0,t=this.__allBindings.length,n=[];for(e=0;e<t;e++)n.push(this.__allBindings[e].resolveBinding());return n}},{key:"validateBindings",value:function(){var e=void 0,t=this.__allBindings.length,n=[];for(e=0;e<t;e++){var i=this.__allBindings[e].validateBinding();"[object Array]"===Object.prototype.toString.call(i)?n=n.concat(i):n.push(i)}return n}},{key:"readBindings",value:function(e){var t=[],n=[],i=void 0,a=void 0,r={canContinue:!0,validations:t,hasWarnings:!1},o=[];if(e)for(t=this.validateBindings(),r.validations=t,a=t.length,i=0;i<a;i++)t[i].isValid?t[i].additionalInfo&&o.push(t[i]):n.push(t[i]);if(r.errors=n,r.warnings=o,r.hasWarnings=o.length>0,n.length>0)r.canContinue=!1;else for(a=this.__allBindings.length,i=0;i<a;i++)this.__allBindings[i].persistBinding();return r}},{key:"getData",value:function(){return this.__data}},{key:"getValueFromPath",value:function(e){var t=this.__data.getValueFromPath(e);return t&&"object"===(void 0===t?"undefined":(0,r.default)(t))&&(t="RecordTypeId"==e?t.fieldvalue.key:t.fieldvalue.value),t}},{key:"setValueToPath",value:function(e,t){t&&"object"===(void 0===t?"undefined":(0,r.default)(t))&&(t={fieldvalue:t}),this.__data.setValueToPath(e,t)}},{key:"getReferenceValueFromPath",value:function(e){return this.__data.getValueFromPath(e)}},{key:"setReferenceValueToPath",value:function(e,t){this.__data.setValueToPath(e,t)}},{key:"getDetailValueFromPath",value:function(e){var t=E.toJSON(this.__data.getValueFromPath(e));t=E.toObject(t)||{};var n=void 0,i=t.lines||[],a=i.length;for(n=0;n<a;n++){var r=i[n];i[n]=this.__restructureDetailLine(r,e)}return t}},{key:"setDetailValueToPath",value:function(e,t){var n=this.__data.getValueFromPath(e),i=this.updateRecords(n,t);this.__data.setValueToPath(e,i)}},{key:"updateRecords",value:function(e,t){var n=void 0,i=t.lines.length,a=null,o=null;e||(e={lines:[]});var s=E.array.filter(e.lines,function(e){return!e.Id});for(n=0;n<i;n++){a=t.lines[n],o=E.array.get(e.lines,function(e){return e.Id&&e.Id==a.Id}),o||(o=s.shift());for(var l in a)if(-1===l.indexOf("__key",l.length-"__key".length)&&0!=l.indexOf("_")){var c=a[l],u=a[l+"__key"];void 0!==u&&""!==u&&null!=u&&(c=u);var d=null;if("attributes"==l)d=c;else if(c&&"object"===(void 0===c?"undefined":(0,r.default)(c))){d={fieldapiname:l,fieldvalue:{key:c.key,value:c.value}};var _=o&&o[l+"__key"];a.__isCopied&&_&&"object"===(void 0===c?"undefined":(0,r.default)(c))&&(o[l+"__key"]=c)}else d=c;o&&(o[l]=d)}}return e}},{key:"executeBinding",value:function(){this.__logger.info("Executing data bindings...");var e=void 0,t=this.__allBindings.length;for(this.__isBindingExecuting=!0,e=0;e<t;e++)this.__allBindings[e].executeBinding();this.__isBindingExecuting=!1}},{key:"executeBindingForViewWithDetails",value:function(e){var t=e.length,n=void 0,i=[];for(n=0;n<t;n++){var a=e[n],r=E.array.filter(this.__allBindings,function(e){return e.__path===a});r.length>0&&r[0].executeBinding()}for(i=E.array.filter(this.__allBindings,function(e){return e.__path.indexOf("details.")>=0}),t=i.length,n=0;n<t;n++)i[n].executeBinding()}},{key:"createBinding",value:function(e,t,n,i){var a=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelBinding",this,e,t,n,i);return this.__allBindings[this.__allBindings.length]=a,this.__allBindingsHash[e]=a,a}},{key:"createPicklistBinding",value:function(e,t,n,i){var a=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelPicklistBinding",this,e,t,n,i);return this.__allBindings[this.__allBindings.length]=a,this.__allBindingsHash[e]=a,a}},{key:"createReferenceBinding",value:function(e,t,n,i){var a=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelReferenceBinding",this,e,t,n,i);return this.__allBindings[this.__allBindings.length]=a,this.__allBindingsHash[e]=a,a}},{key:"createDetailBinding",value:function(e,t,n,i){var a=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailBinding",this,e,t,n,i);return this.__allBindings[this.__allBindings.length]=a,this.__detailsBindings[e]=a,this.__allBindingsHash[e]=a,a}},{key:"getRelatedBindingValue",value:function(e,t){}},{key:"isBindingExecuting",value:function(){return this.__isBindingExecuting}}]),t}(A),R.SFMChecklistPageModel=function(e){function t(e){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"setData",value:function(e,n){var i={};if(e&&e.__data&&e.__data.pageDataSet){if(e.__data.pageDataSet.sobjectinfo=e.__data.pageDataSet.sobjectinfo||{},e.__data.sfmData=e.__data.sfmData||{},e.__data.pageDataSet.sobjectinfo&&e.__data.pageDataSet.sobjectinfo[E.OrgNamespace+"__ChecklistJSON__c"])try{i=E.toObject(e.__data.pageDataSet.sobjectinfo[E.OrgNamespace+"__ChecklistJSON__c"])}catch(t){console.error("Unable to parse question answers for record: "+(e&&e._targetRecordId))}else e.__data.pageDataSet.sobjectinfo&&e.__data.pageDataSet.sobjectinfo.LIST_SECTION_FIELD_ID?(e.__data.pageDataSet.sobjectinfo.LIST_SECTION_FIELD_ID.fieldvalue.value=this.__parseTemplateResults(e.__data.pageDataSet.sobjectinfo.LIST_SECTION_FIELD_ID.fieldvalue.value),e.__data.sfmData.LIST_SECTION_FIELD_ID.fieldvalue.value=e.__data.pageDataSet.sobjectinfo.LIST_SECTION_FIELD_ID.fieldvalue.value):e&&e._targetRecordId&&console.warn("No checklist data for record: "+e._targetRecordId);var a=this.getModelRoot(),r={};a&&a.getQuestionTypes&&(r=a.getQuestionTypes());var o=void 0,s=void 0,l=void 0;for(o in i)s=i[o],l=r[o],s&&s.fieldvalue&&("multi-select picklist"===l||"picklist"===l)&&(s=s.fieldvalue.key||s),e.__data.sfmData[o]=s}else console.error("Missing data to set for record: "+(e&&e._targetRecordId));(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"setData",this).call(this,e,n)}},{key:"getValueFromPath",value:function(e){var t=this.__data.getValueFromPath(e);return!t||"object"!==(void 0===t?"undefined":(0,r.default)(t))||t instanceof Array?void 0===t&&"RecordTypeId"!==e&&"LIST_SECTION_FIELD_ID"!==e&&(t=this.getDefaultValueFromPath(e)):t="RecordTypeId"==e?t.fieldvalue.key:t.fieldvalue.value,t}},{key:"__getSourceObjectRecord",value:function(){return this.__parent._sourceRecord||this.__parent.__deliveryEngine.additionalInfo.sourceRecord.__page.__dataModel.__data.__data.sfmData||{}}},{key:"__getSourceObjectFieldsDescribe",value:function(){return this.__getSourceObjectRecord()._fields.fields||{}}},{key:"__getFieldDescribe",value:function(e){return this.__getSourceObjectFieldsDescribe()[e]||{}}},{key:"__getTranslatedValue",value:function(e,t){for(var n=t,i=e.picklistValues||[],a=0;a<i.length;a++){var r=i[a];if(r.value===t){n=r.label||r.key;break}}return n}},{key:"getDefaultValueFromPath",value:function(e){var t=this.__data.getValueFromPath(e);E.getCurrentApplication().getUserInfo();if(t)t=t;else for(var n=this.__parent.getChildNode("header").getChildNode("sections"),i=0;i<n.length;i++)for(var a=n[i].getChildNode("fields"),o=0;o<a.length;o++){var s=a[o],l=s.__fieldInfo.question.responseType;if(s.fieldName===e){if(s._data&&s._data.fieldDetail&&s._data.fieldDetail[E.OrgNamespace+"__SM_Checklist_Source_Field_API_Name__c"]){var c=s._data.fieldDetail[E.OrgNamespace+"__SM_Checklist_Source_Field_API_Name__c"],u=this.__getSourceObjectRecord(),d=this.__getFieldDescribe(c),_=d.dataType,h=u[c];"object"===(void 0===h?"undefined":(0,r.default)(h))?(t=h&&h.fieldvalue&&h.fieldvalue.value,"date"===u._fields.fields[c].dataType.toLowerCase()&&"datetime"===l.toLowerCase()&&(t=t&&T.convertToTimezone(t,null,!0))):t="Multi-select Picklist"===s.__fieldInfo.question.responseType?h&&h.split(";"):h,t&&"picklist"===_&&(t=this.__getTranslatedValue(d,t))}else if(s.__fieldInfo.defaultChecklistRes){var f=E.toObject(s.__fieldInfo.defaultChecklistRes[E.OrgNamespace+"__SM_Default_Response__c"]);if((t=f)&&null===t.literalValue)t.listOfDefaultValues&&t.listOfDefaultValues.length>0&&"Multi-select Picklist"!==s.__fieldInfo.question.responseType&&"Checkbox"!==s.__fieldInfo.question.responseType?(t=t.listOfDefaultValues.join(),t="datetime"===l.toLowerCase()?T.convertToTimezone(t,null,!0):t):t=t.listOfDefaultValues;else if(t&&t.literalValue&&("Today"===t.literalValue||"Yesterday"===t.literalValue||"Now"===t.literalValue||"Tomorrow"===t.literalValue))if("datetime"===l.toLowerCase()){var p=t.literalValue;t=T.macroDrivenDatetime(t.literalValue,"YYYY-MM-DD","HH:mm:ss"),t="Now"===p?t:T.convertToTimezone(t,null,!0)}else"date"===l.toLowerCase()&&(t=T.macroDrivenDatetime(t.literalValue,"YYYY-MM-DD","","date"))}break}}return t}},{key:"_processDateToUserTimezone",value:function(e){var t=this.__parent.getUserInfo().TimezoneOffset;return T.convertToTimezone(e,t,!1)}},{key:"__parseTemplateResults",value:function(e){e=e||[];var t=void 0,n=void 0,i=void 0,a=void 0,r=void 0,o=e.length,s={},l=[];for(t=0;t<o;t++)switch(n=e[t],i="Qualified"!==n.status,a="Qualified"===n.status,r="In Process"!==n.status,s[n.processId]?(s[n.processId].removeTemplate=i||s[n.processId].removeTemplate,s[n.processId].allowNew=!1!==s[n.processId].allowNew&&r,s[n.processId].hasTemplate=!1!==s[n.processId].hasTemplate||a):s[n.processId]={allowNew:r,removeTemplate:i,hasTemplate:a},n.statusLabel="",n.status){case"Qualified":n.statusLabel=L().T("FSA008_TAG116","Not Started"),n.actionLabel=L().T("TODO",""),n.internalLabel="";break;case"In Process":n.statusLabel=L().T("FSA008_TAG117","In Progress"),n.actionLabel=L().T("TODO",""),n.internalLabel="";break;case"Completed":n.statusLabel=L().T("FSA008_TAG118","Completed"),n.actionLabel=L().T("FSA008_TAG119","Start New"),n.internalLabel="Start New";break;default:n.statusLabel=n.status}for(t=0;t<o;t++)n=e[t],"Qualified"===n.status?s[n.processId].removeTemplate||(n.allowNew=s[n.processId].allowNew&&s[n.processId].hasTemplate,l.push(n)):(n.allowNew=s[n.processId].allowNew&&s[n.processId].hasTemplate,n.allowNew||(n.actionLabel=L().T("TODO","")),l.push(n));return l.sort(function(e,t){var n=e.processName?e.processName.toLowerCase():"",i=t.processName?t.processName.toLowerCase():"";if(n<i)return-1;if(n>i)return 1;var a="In Process"===e.status?1:"Qualified"===e.status?2:3,r="In Process"===t.status?1:"Qualified"===t.status?2:3;if(a<r)return-1;if(a>r)return 1;var o=e.completionDate?e.completionDate.toLowerCase():"",s=t.completionDate?t.completionDate.toLowerCase():"";return o<s?-1:o>s?1:0}),l}},{key:"createAttachmentBinding",value:function(e,t,n,i){var a=E.create("com.servicemax.client.sfmdelivery.engine.SFMChecklistPageModelAttachmentBinding",this,e,t,n,i);return this.__allBindings[this.__allBindings.length]=a,this.__allBindingsHash[e]=a,a}},{key:"getValueForAttachment",value:function(e){return this.__data&&this.__data.__attachementData&&this.__data.__attachementData.getAttachementValuefromPath(e)}},{key:"setValueForAttachment",value:function(e,t){this.__data&&this.__data.__attachementData&&this.__data.__attachementData.setAttachementValueToPath(e,t)}}]),t}(R.SFMPageModel),R.SFMPageModelBinding=function(e){function t(e,n,i,a,r){(0,d.default)(this,t);var o=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return o.__path=n,o.__setter=i,o.__getter=a,o.__context=r,o.__parent=e,o._logger=E.getLoggingService().getLogger("SFMDELIVERY-PAGE-MODEL-BINDING"),o.__validator=null,o.__resolver=null,o.__bizzRuleValidator=null,o}return(0,y.default)(t,e),(0,h.default)(t,[{key:"toString",value:function(){return(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"toString",this).call(this,this.__path)}},{key:"setValidator",value:function(e){this.__validator=e}},{key:"setBizRuleValidator",value:function(e){this.__bizzRuleValidator=e}},{key:"setResolver",value:function(e){this.__resolver=e}},{key:"resolveBinding",value:function(){var e={isResolved:!0};return this.__resolver&&this.__resolver.handler&&(e=this.__resolver.handler.call(this.__resolver.context)),e}},{key:"validateBinding",value:function(){var e={isValid:!0};return this.__validator&&this.__validator.handler&&(e=this.__validator.handler.call(this.__validator.context)),e}},{key:"executeBinding",value:function(){var e=this.__parent.getValueFromPath(this.__path);this._logger.info("Executing (set)binding for => "+this.__path),this.__setter.call(this.__context,e)}},{key:"getValue",value:function(){return this.__getter.call(this.__context)}},{key:"setValue",value:function(e){this.__setter.call(this.__context,e)}},{key:"persistBinding",value:function(){var e=this.__getter.call(this.__context);this.__parent.setValueToPath(this.__path,e)}},{key:"getRelatedBindingValue",value:function(e,t){var n="";this.__parent.__allBindingsHash[e]&&(n=this.__parent.__allBindingsHash[e].getValue());var i=this.__parent.__allBindingsHash[e];if(i||this.__context.getCompositionMetamodel){var a=this.__context.getCompositionMetamodel?this.__context.getCompositionMetamodel():i.__context.compositionMetamodel;if("datetime"==a.datatype){var o=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance(),s=this.__parent.__parent.getUserInfo().TimezoneOffset;n=o.getFormattedDateTimeValue(n,s)}else if("date"==a.datatype){var o=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();n=o.getFormattedDateValue(n)}}return n&&"object"===(void 0===n?"undefined":(0,r.default)(n))&&(n=n.key),n}}]),t}(A),R.SFMPageModelPicklistBinding=function(e){function t(e,n,i,a,r){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i,a,r))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"executeBinding",value:function(){var e=this.__parent.getValueFromPath(this.__path);this._logger.info("Executing (set)binding for => "+this.__path),this.__context.forceSelection=!1,this.__setter.call(this.__context,e),this.__context.forceSelection=!this.__context.readOnly}}]),t}(R.SFMPageModelBinding),R.SFMPageModelReferenceBinding=function(e){function t(e,n,i,a,r){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i,a,r))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"executeBinding",value:function(){var e=this.__parent.getReferenceValueFromPath(this.__path);this._logger.info("Executing (set) reference binding for => "+this.__path),e&&"object"===(void 0===e?"undefined":(0,r.default)(e))?(e={key:e.fieldvalue.key,value:e.fieldvalue.value,isNameSyncData:e.fieldvalue.isNameSyncData,hasViewSFM:e.fieldvalue.hasViewSFM},this.__setter.call(this.__context,e)):this.__setter.call(this.__context,e)}},{key:"getValue",value:function(){return this.__getter.call(this.__context)}},{key:"setValue",value:function(e,t){this.__setter.call(this.__context,e,t)}},{key:"persistBinding",value:function(){var e=this.getValue(),t={fieldvalue:{key:null,value:null}};e&&"object"===(void 0===e?"undefined":(0,r.default)(e))&&(t.fieldvalue.key=e.key,t.fieldvalue.value=e.value),this.__parent.setReferenceValueToPath(this.__path,t)}}]),t}(R.SFMPageModelBinding),R.SFMPageModelDetailBinding=function(e){function t(e,n,i,a,r){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i,a,r))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"executeBinding",value:function(){var e=this.__parent.getDetailValueFromPath(this.__path);this.__setter.call(this.__context,e)}},{key:"getValue",value:function(){return this.__getter.call(this.__context)}},{key:"onNewRecordsCloned",value:function(e,t){this.__setter.call(this.__context,e,{type:"CLONED",onSuccess:t})}},{key:"onNewRecordsAdded",value:function(e,t){this.__setter.call(this.__context,e,{type:"ADDED",onSuccess:t})}},{key:"onRecordsDeleted",value:function(e){this.__setter.call(this.__context,e,{type:"DELETED"})}},{key:"onNewRecordsCopy",value:function(e,t){this.__setter.call(this.__context,e,{type:"COPY",onSuccess:t})}},{key:"persistBinding",value:function(){var e=this.getValue();this.__parent.setDetailValueToPath(this.__path,e)}}]),t}(R.SFMPageModelBinding),R.SFMChecklistPageModelAttachmentBinding=function(e){function t(e,n,i,a,r){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i,a,r))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"executeBinding",value:function(){var e=this.__parent.getValueForAttachment(this.__path);this._logger.info("Executing (set)binding for => "+this.__path),this.__setter.call(this.__context,e)}},{key:"persistBinding",value:function(){if(!this.__parent.__parent.isDisplayOnly){var e=this.__getter.call(this.__context);this.__parent.setValueForAttachment(this.__path,e)}}},{key:"validateBinding",value:function(){var e={isValid:!0};return this.__validator&&this.__validator.handler&&(e=this.__validator.handler.call(this.__validator.context)),e}}]),t}(R.SFMPageModelBinding),R.SFMPageLookupModel=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.__refMetaModel=e,n.__callback=null,n.__lookupData=null,n}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getResultFieldsInfo",value:function(){for(var e=[],t=this.__lookupData,n=null,i=t?t.namesearchinfo.namedSearch[0].namedSearchDetails[0].fields:[],a=0;a<i.length;a++)"Result"==i[a][E.OrgNamespace+"__Search_Object_Field_Type__c"]&&"Id"!=i[a][E.OrgNamespace+"__Field_Name__c"]&&(n={fieldLabel:this.__refMetaModel.getFieldLabelFromRelatedObject(i[a][E.OrgNamespace+"__Field_Name__c"]),fieldType:this.__refMetaModel.getFieldTypeFromRelatedObject(i[a][E.OrgNamespace+"__Field_Name__c"]),fieldName:i[a][E.OrgNamespace+"__Field_Name__c"],fieldSequence:i[a][E.OrgNamespace+"__Sequence__c"]},e[e.length]=n);return e=E.sort(e,"fieldSequence")}},{key:"getReferenceMetaModel",value:function(){return this.__refMetaModel}},{key:"getResultData",value:function(){var e=this.__lookupData,t=e&&e.data,n=void 0,i=t?t.length:0,a=[];for(n=0;n<i;n++){var r=t[n].FieldMap;if(r){var o,s=r.length,l={};for(o=0;o<s;o++){var c=r[o];if("Result"==c.ftype||"Reference"==c.ftype){l[c.key]=void 0===c.value?null:c.value;if("picklist"==this.__refMetaModel.getFieldTypeFromRelatedObject(c.key)){var u,d;u=this.__refMetaModel.getPicklistValuesFromRelatedObject(c.key),d=u.length;for(var _=0;_<d;_++)if(u[_].value==c.value){l[c.key]=u[_].label,l[c.key+"__m"]=u[_].value;break}}}}a[a.length]=l}}return a}},{key:"getDefaultColumnName",value:function(){var e=this.__lookupData,t=e.namesearchinfo.namedSearch[0].namedSearchHdr,n=t[E.OrgNamespace+"__Default_Lookup_Column__c"];return n||(n=this.__refMetaModel.nameFieldName),n}},{key:"getNameColumnName",value:function(){return this.__refMetaModel.nameFieldName}},{key:"getLookupObjectName",value:function(){return this.__refMetaModel.objectName}},{key:"getNameColumnNameLabel",value:function(e,t){return this.__refMetaModel.getRoot().getLabel(e,t)}},{key:"getLookupId",value:function(){var e=this.__refMetaModel.namedSearchId;return e||(e=this.__refMetaModel.objectName),e}},{key:"invoke",value:function(e,t){var n={};this.__callback=t,n.KeyWord=e.keyword,n.callType=e.callType,n.filtersToQuery=e.filtersToQuery,n.formFillFields=this.__refMetaModel.getRoot().__fieldMappings.getFieldList(this.__refMetaModel.fieldMappingId),n.userTrunk=e.userTrunk,n.SearchOperator=e.searchOperator?e.searchOperator:"contains",n.priqChecked=e.priqChecked,n.searchOnlineRecord=e.searchOnlineRecord,n.currentRecordId=e.currentRecordId;var i=this.__refMetaModel.namedSearchId;if(i?(n.LookupRecordId=i,n.ObjectName=this.__refMetaModel.objectName):n.ObjectName=this.__refMetaModel.objectName,!1===e.bOverrideRelatedLookup){var a=this.__refMetaModel.lookupContext;if(a){var o=void 0;if(this.record){var s=this.record[a+"__key"];o=s===this.record[a]?void 0:s}else o=this.__refMetaModel.lookupContextFieldInfo&&this.__refMetaModel.lookupContextFieldInfo.getDataBinding().getValue();var l=this.__refMetaModel.lookupContextFieldInfo&&this.__refMetaModel.lookupContextFieldInfo.datatype;o&&"object"===(void 0===o?"undefined":(0,r.default)(o))&&(o=1==o.extendedEditExtra?o.key===o.value&&"reference"===l?void 0:o.key:"Name"==this.__refMetaModel.lookupQueryField?o.value:o.key),n.LookupContext=o,n.LookupQueryField=this.__refMetaModel.lookupQueryField}}var c=this.__refMetaModel.getRoot().getDeliveryEngine().getEventBus(),u=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_LOOKUPCONFIG",this,{request:n,responder:E.create("com.servicemax.client.sfmdelivery.responders.GetLookupConfigResponder",this)});c.triggerEvent(u)}},{key:"onGetLookupConfigComplete",value:function(e){this.__lookupData=e;var t=this.__refMetaModel.namedSearchId;this.__refMetaModel.getRoot().describeObject(this.__refMetaModel.objectName,{handler:function(){this.__callback.handler.call(this.__callback.context,e),delete this.__callback},context:this,lookupID:t})}},{key:"onGetLookupConfigError",value:function(e){this.__callback.handler.call(this.__callback.context,e)}}]),t}(A),R.SFMPageMetaModel=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,null));a.__logger=E.getLoggingService().getLogger("SFMD-PAGE-META-MODEL"),a.__userInfo=n,a.__deliveryEngine=i,a.__recordTypesMap={};var r=a.getProcessType();return a.isDisplayOnly="VIEW RECORD"===r,a.__dataModel=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModel",a),a.__fieldMappings=E.create("com.servicemax.client.sfmdelivery.engine.SFMFieldMappingModel",e),a.__fieldUpdateRuleValidator=E.create("com.servicemax.client.sfmbizrules.impl.FieldUpdateRuleValidator"),a.title=null,a.objMetadataMap=null,a.__initializeCallback=null,a.__initializeCallbackContext=null,a}return(0,y.default)(t,e),(0,h.default)(t,[{key:"doCleanup",value:function(){return this._children&&this._children.header&&this._children.header.doCleanup(),this._children&&this._children.details&&this._children.details.doCleanup(),this.setPropertyForCleanup(["__dataModel","__fieldMappings","__fieldUpdateRuleValidator","__recordTypesMap","__userInfo"]),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}}]),(0,h.default)(t,[{key:"__retrieveSortingFields",value:function(e){var t={},n=void 0,i=e.response.stringMap;for(n=0;n<i.length;n++)i[n].value1&&(t[i[n].key]=E.toObject(i[n].value1));return t}},{key:"getSortingFields",value:function(e){return this.__configSorting[e]?this.__configSorting[e]:null}},{key:"getDeliveryEngine",value:function(){return this.__deliveryEngine}},{key:"getDataModel",value:function(){return this.__dataModel}},{key:"getRawPageMetaData",value:function(){return this._data}},{key:"getUserInfo",value:function(){return this.__userInfo}},{key:"getObjectInfo",value:function(e){return this.objMetadataMap[e]}},{key:"getObjectLabel",value:function(e){return this.getObjectInfo(e).label}},{key:"getObjectNameField",value:function(e){var t=this.getObjectInfo(e);return E.array.get(t.fields,function(e){return e.nameField}).name}},{key:"getObjectPluralLabel",value:function(e){return this.getObjectInfo(e).labelPlural}},{key:"getFieldInfo",value:function(e,t){var n=function(e){var t=null;return e.fieldDetail?t=e.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"]:e.name&&(t=e.name),t}(t);return this.getFieldInfoFromName(e,n)}},{key:"getFieldInfoFromName",value:function(e,t){var n=this.objMetadataMap[e],i=n.fields,a=void 0,r=i.length,o=null;for(a=0;a<r;a++){var s=i[a];if(s.name==t){o=s;break}}return o}},{key:"getFieldHelpText",value:function(e,t){var n=this.getFieldInfo(e,t),i=t.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"];return null!=n&&(i=n.inlineHelpText),i}},{key:"getPrecision",value:function(e,t){var n=this.getFieldInfo(e,t),i=0;return n&&(i=n.precision),i}},{key:"getScale",value:function(e,t){var n=this.getFieldInfo(e,t),i=0;return n&&(i=n.scale),i}},{key:"getFieldLabel",value:function(e,t){var n=this.getFieldInfo(e,t),i=t.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"];return null!=n&&(i=n.label),i}},{key:"isFieldAccessible",value:function(e,t){var n=this.getFieldInfo(e,t),i=!1;return n&&(i=n.accessible),i}},{key:"isFieldRequired",value:function(e,t){var n=!0,i=this.getFieldInfo(e,t);if(null!=i){n=!i.nillable}return n}},{key:"isFieldReadOnly",value:function(e,t){var n=!0,i=this.getFieldInfo(e,t);if(null!=i){n=!i.updateable}return n}},{key:"getControllingPicklist",value:function(e,t){var n=this.getFieldInfo(e,t),i=null;return n&&n.dependentPicklist&&(i=n.controllerName),i}},{key:"getAllPicklists",value:function(e){var t=this.objMetadataMap[e].fields,n=void 0,i=t.length,a=[];for(n=0;n<i;n++)"picklist"!=t[n].dataType&&"boolean"!=t[n].dataType||a.push(t[n]);return a}},{key:"getPicklistValues",value:function(e,t){var n=this.getFieldInfo(e,t),i=[];return null!=n&&(i=n.picklistValues),i}},{key:"getPicklistValuesFromFieldName",value:function(e,t){var n=this.getFieldInfoFromName(e,t),i=[];return n&&(i=n.picklistValues),i}},{key:"getLabel",value:function(e,t){var n=this.getObjectInfo(e),i=n.fields,a=void 0,r=i.length,o=t;for(a=0;a<r;a++){var s=i[a];if(s.name==t){o=s.label;break}}return o}},{key:"getFieldType",value:function(e,t){var n=this.getObjectInfo(e),i=n.fields,a=void 0,r=i.length,o=null;for(a=0;a<r;a++){var s=i[a];if(s.name==t){o=s.dataType;break}}return o}},{key:"getFieldTypes",value:function(){var e={},t=void 0,n=void 0,i=void 0,a=void 0,r=this.objMetadataMap;for(n in r)for(e[n]={},i=r[n].fields,t=0;t<i.length;t++)a=i[t],e[n][a.name]=a.dataType||a.type;return e}},{key:"describeObject",value:function(e,t){var n=this.getObjectInfo(e),i=t.lookupID;if(n)t.handler.call(t.context);else{var a=this.getDeliveryEngine().getEventBus(),r=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DESCRIBE_OBJECT",this,{request:{objectName:e,lookupId:i},responder:E.create("com.servicemax.client.sfmdelivery.responders.DescribeObjectResponder",e,this,{callback:t})});a.triggerEvent(r)}}},{key:"onDescribeObjectComplete",value:function(e,t,n){this.objMetadataMap[e]=t,n.callback.handler.call(n.callback.context)}},{key:"initialize",value:function(e,t){this.__logger.info("initializing the meta model..."),this.__initializeCallbackContext=t,this.__initializeCallback=e;var n=[this._data.page.header.headerLayout[E.OrgNamespace+"__Object_Name__c"]],i=this._data.page.details,a=void 0,r=i.length;for(a=0;a<r;a++){var o=i[a];n[a+1]=o.DetailLayout[E.OrgNamespace+"__Object_Name__c"]}this.objMetadataMap={},this.objMetadataTypeMap={},r=n.length;var s=[],l=[];for(a=0;a<r;a++)if(-1==l.indexOf(n[a])){var c=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DESCRIBE_OBJECT",this,{request:{objectName:n[a],processId:t.processId}});s.push(c),l.push(n[a])}var u=this.getDeliveryEngine().getEventBus(),d=E.create("com.servicemax.client.sfmconsole.utils.EventCollection",u,s);this.__logger.info("triggering request to describe objects"),d.triggerAll(this.onDescribeObjectsComplete,this)}},{key:"onDescribeObjectsComplete",value:function(e){var t=e.items(),n=t.length,i=void 0;for(i=0;i<n;i++){var a=t[i],r=a.getEventObj().data.request.objectName,o=a.response,s=e.__context._data.response.sfmProcessType;if(("SOURCE TO TARGET ALL"==s||"SOURCE TO TARGET CHILD"==s||"STANDALONE CREATE"==s)&&1==o.createable&&0==o.updateable){o.updateable=!0;for(var l=0;l<o.fields.length;l++){var c=o.fields[l];c.createable&&!c.updateable&&(c.updateable=!0)}}this.objMetadataMap[r]=o;for(var u={},d=0;d<o.fields.length;d++){var _=o.fields[d];"datetime"!==_.dataType&&"date"!==_.dataType||(u[_.name]=_.dataType)}this.objMetadataTypeMap[r]=u}this.__processRecordTypes(function(){this.title=E.getClient().getApplicationParameter("svmx-sfm-hide-title-bar")?"":window.svmx_sfm_delivery_process_title,this.title||(this.title=""),this._children.header=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageHeader",this._data.page.header,this),this._children.header.initialize(),this.initializeDetails()},this)}},{key:"__processRecordTypes",value:function(e,t){var n,i,a=[],r=this._data.page.details,o=null;for(a.push({objectName:this._data.page.header.headerLayout[E.OrgNamespace+"__Object_Name__c"]}),i=r.length,n=0;n<i;n++)o=r[n],a.push({objectName:o.DetailLayout[E.OrgNamespace+"__Object_Name__c"]});if(a.length>0){var s=[],i=a.length;for(n=0;n<i;n++){var l=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_RECORD_TYPES",this,{request:{objectName:a[n].objectName}});s[n]=l}var c=this.getDeliveryEngine().getEventBus(),u=E.create("com.servicemax.client.sfmconsole.utils.EventCollection",c,s);this.__logger.info("triggering request to get record types"),u.triggerAll(function(n){var i=n.items(),a=i.length,r=void 0;for(r=0;r<a;r++){var o=i[r],s=o.getEventObj().data.request.objectName,l=o.response;this.__recordTypesMap[s]=l}e.call(t)},this)}else e.call(t)}},{key:"getRecordTypesFor",value:function(e){return this.__recordTypesMap[e]}},{key:"getCurrentRecordTypeInfo",value:function(e,t){var n=null,i=null,a=void 0,r=void 0;if(e&&(i=this.getRecordTypesFor(t)))for(r=i.length,a=0;a<r;a++)if(i[a].recordTypeId==e){n=i[a];break}return n}},{key:"getProcessType",value:function(){return this._data.response.sfmProcessType}},{key:"getAssociatedViewProcesses",value:function(){return this._data.response.associatedViewProcesses}},{key:"setAssociatedViewProcesses",value:function(e){var t=void 0,n=void 0,i=[];for(n=e?e.length:0,t=0;t<n;t++){var a=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageAssociatedViewProcesses",e[t]);i.push(a)}this.associatedViewProcesses=i}},{key:"resolveDependencies",value:function(){for(var e in this._children)this._children[e].resolveDependencies()}},{key:"initializeDetails",value:function(){this._children.details=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetails",this._data.page.details,this),this._children.details.initialize(this.onDetailsInitalizeComplete,this)}},{key:"onDetailsInitalizeComplete",value:function(){this.resolveDependencies(),this.__initializeCallback.call(this.__initializeCallbackContext)}},{key:"getHeaderMetaModel",value:function(){return this._children.header}},{key:"getDetailMetaModel",value:function(){return this._children.details}},{key:"getBusinessRules",value:function(){var e=this._data.page.businessRules||[],t=[];return e.forEach(function(e){("Field Update Rule"!==e.ruleInfo.bizRule[E.OrgNamespace+"__Rule_Type__c"]||e.ruleInfo.bizRuleDetails.length>0&&"Business_Rule"===e.ruleInfo.bizRuleDetails[0][E.OrgNamespace+"__Expression_Type__c"])&&t.push(e)}),t}},{key:"getBusinessRulesHash",value:function(){var e=void 0,t=this.getBusinessRules(),n=this.getData().page.details,i={header:{key:"",rules:[]}};for(e=0;e<n.length;e++){var a=n[e],r=a.DetailLayout[E.OrgNamespace+"__Page_Layout_ID__c"],o=a.DetailLayout[E.OrgNamespace+"__Name__c"],s=a.dtlLayoutId;i[r]={key:s,id:r,name:o,rules:[]}}for(e=0;e<t.length;e++){var l=t[e],c=l.aliasName;i[c]?i[c].rules.push(l):i.header.rules.push(l)}return i}},{key:"getFieldUpdateRules",value:function(){var e=this._data.page.businessRules||[],t=[];return e.forEach(function(e){(e.ruleInfo.bizRule&&"Field Update Rule"===e.ruleInfo.bizRule[E.OrgNamespace+"__Rule_Type__c"]||e.ruleInfo.bizRuleDetails.length>0&&"Field_Update_Rule"===e.ruleInfo.bizRuleDetails[0][E.OrgNamespace+"__Expression_Type__c"])&&t.push(e)}),t}},{key:"getFieldUpdateRulesHash",value:function(){var e=void 0,t=this.getFieldUpdateRules(),n=this.getData().page.details,i=this.getData().page.header,a=i.headerLayout[E.OrgNamespace+"__Page_Layout_ID__c"],r={header:{id:a,key:i.hdrLayoutId,rules:[]}};for(e=0;e<n.length;e++){var o=n[e],s=o.DetailLayout[E.OrgNamespace+"__Page_Layout_ID__c"],l=o.DetailLayout[E.OrgNamespace+"__Name__c"],c=o.dtlLayoutId;r[s]={key:c,id:s,name:l,rules:[]}}for(e=0;e<t.length;e++){var u=t[e],d=u.aliasName;r[d]?r[d].rules.push(u):r.header.rules.push(u)}return r}},{key:"evaluateFieldUpdateRules",value:function(){if(this.getDeliveryEngine().isFieldUpdatesEnabled()){var e=this.getFieldUpdateRulesHash();if(E.array.map(e,function(e){return e.rules}).length){var t=this.getFieldTypes(),n=this.getDataModel().getData(),i=n.getRawValues(),a=this.__fieldUpdateRuleValidator.evaluateFieldUpdateRules({rules:e,data:i,fields:t,pageModel:n});if(a.errors.length||a.warnings.length){var r=this.getDeliveryEngine().getEventBus(),o=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.FIELD_UPDATE_VALIDATION_ERROR",this,{request:{original:{request:{},responder:{}},deliveryEngine:this.getDeliveryEngine(),result:a,eventType:"onload"},responder:{}});return r.triggerEvent(o)}var s=this.__fieldUpdateRuleValidator.getUpdatableFields(e);this.applyFieldUpdateResults(i,a.response,s,t)}}}},{key:"applyFieldUpdateResults",value:function(e,t,n,i){var a=void 0,o=void 0,s=void 0,l=void 0,c=this.__fieldUpdateRuleValidator.getRawData(e,this.getDataModel().getData(),!1);t=this.__fieldUpdateRuleValidator.parseResult(t,n,i);for(l in t)"details"!==l&&l in n&&(a=t[l],o=c[l],a!==o&&(s=e[l],s&&"object"===(void 0===s?"undefined":(0,r.default)(s))&&"fieldvalue"in s?(s.fieldvalue.key=a,s.fieldvalue.value=a):s=a,e[l]=s));if(t.details&&e.details)for(l in t.details)l in e.details&&this.__applyChildFieldUpdateResults(e.details[l].lines||[],t.details[l].lines||[],n.details[l]||{},i)}},{key:"__applyChildFieldUpdateResults",value:function(e,t,n,i){var a=void 0,r=e.length,o={},s={};for(a=0;a<r;a++)o[e[a].Id]=e[a];for(r=t.length,a=0;a<r;a++)s[t[a].Id]=t[a];for(var l in s)l in o&&(o[l].Id&&o[l].Id.indexOf("tempChildId_")>=0&&(o[l].Id=s[l].Id=void 0),this.applyFieldUpdateResults(o[l],s[l],n,i))}},{key:"getBindingHash",value:function(){return this.__dataModel.__allBindingsHash}},{key:"executeFieldMappings",value:function(e,t,n,i,a){var o=n||this.getBindingHash(),s=void 0,l=void 0,c=void 0;if(l=e,a)s=a;else{for(;!l.getFieldTypes;)l=l._parent;s=l.getFieldTypes()}var u=this.getRoot().getDataModel();c=e.getRoot().__fieldMappings,c.forEachField(e.fieldMappingId,function(n,a){var l=s[n],c=void 0;if(a.value)switch(c=a.value){case"Tomorrow":case"Yesterday":case"Today":c=T.macroDrivenDatetime(c,"YYYY-MM-DD","HH:mm:ss"),"datetime"==l&&(c=T.convertToTimezone(c,null,!0));break;case"Now":c=T.macroDrivenDatetime(c,"YYYY-MM-DD","HH:mm:ss")}else"reference"===l&&a.field+"__key"in t?(key=t[a.field+"__key"],value=t[a.field],!key&&a.field2&&(key=t[a.field2+"__key"],value=t[a.field2]),!key&&a.field3&&(key=t[a.field3+"__key"],value=t[a.field3]),c=key&&"object"===("undefined"==typeof key?"undefined":(0,r.default)(key))?{key:key.key,value:key.value}:key&&value?{key:key,value:value}:key):"reference"===l&&"Id"===a.field?(key=t[a.field],value=e.nameFieldName?t[e.nameFieldName]:t.Name,c=key&&value?{key:key,value:value}:key):(c=t[a.field+"__m"],c||(c=t[a.field]),!c&&a.field2&&(c=t[a.field2]),!c&&a.field3&&(c=t[a.field3]));void 0===c&&(c=null);var d=o[n];d?d.setValue(c):i?(i[n]=c,i.hasOwnProperty(n+"__key")&&(i[n+"__key"]=c)):u.setValueToPath(n,c)})}},{key:"getRelatedBindingValue",value:function(e,t){var n=this._data.page.header.sections.length,i=void 0;for(i=0;i<n;i++)for(var a=this._data.page.header.sections[i].fields.length,r=0;r<a;r++)this._data.page.header.sections[i].fields[r];this._data.getRelatedBindingValue(e,t)}}]),t}(D),R.SFMChecklistPageMetaModel=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i));return i=i||{},i.additionalInfo=i.additionalInfo||{},"VIEW"===i.additionalInfo.specialProcessType&&(a.isDisplayOnly=!0),a.__dataModel=E.create("com.servicemax.client.sfmdelivery.engine.SFMChecklistPageModel",a),a}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(e,t){this.__logger.info("initializing the meta model..."),this.__initializeCallbackContext=t,this.__initializeCallback=e,this.objMetadataMap={};var n=this._data.page.header.headerLayout[E.OrgNamespace+"__Object_Name__c"];if(this.__buildDescribeObject(n),this.title=E.getClient().getApplicationParameter("svmx-sfm-hide-title-bar")?"":window.svmx_sfm_delivery_process_title,this.title||E.getClient().getApplicationParameter("svmx-sfm-hide-title-bar")||this._data&&this._data.page&&this._data.page.processTitle&&(this.title=this._data.page.processTitle),this.title=this.title?this.title:"","CHECKLIST"==this.__deliveryEngine.additionalInfo.sfwActionType&&"NEW"==this.__deliveryEngine.additionalInfo.checklistStatus)this.getUpdatedSourceObjectRecord();else if(this._sourceRecord&&this.objMetadataMap[n].fields&&this.objMetadataMap[n].fields.length>0&&"question"===this.objMetadataMap[n].fields[0].dataType&&"Not Started"===this.checklistStatus){var i=this.getDeliveryEngine().getEventBus(),a=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EVALUATE_ENTRY_CRITERIA",this,{request:{data:this._sourceRecord,sourceRecordId:this.__deliveryEngine.getSourceRecordId(),metadata:this.__deliveryEngine.getPageMetaData().getRawPageMetaData(),deliveryEngine:this.__deliveryEngine,additionalInfo:{toModelOnly:!1,eventType:"entryCriteria"}},responder:E.create("com.servicemax.client.sfmdelivery.responders.ChecklistEntryResponder",this)});i.triggerEvent(a)}else this.continueIntializing()}},{key:"getUpdatedSourceObjectRecord",value:function(){var e=this.getDeliveryEngine().getEventBus(),t=this.__deliveryEngine.additionalInfo.sourceRecord;if(t){var n=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PAGEDATA",this,{request:{recordId:t.getSourceRecordId(),targetId:t.recordId,processId:t.processId,qualify:!1,refreshData:!0,objectNameMap:t.getObjectNameMap(),requesterId:t.getRootContainerId(),layout:t.__page.getData()},responder:E.create("com.servicemax.client.sfmdelivery.responders.GetUpdatedSourceObjectRecordResponder",this)});e.triggerEvent(n)}}},{key:"ongetUpdatedSourceObjectRecordComplete",value:function(e){var t=this.getDeliveryEngine().getEventBus(),n=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EVALUATE_ENTRY_CRITERIA",this,{request:{data:e.__data.pageDataSet.sobjectinfo,sourceRecordId:this.__deliveryEngine.getSourceRecordId(),metaData:this.__deliveryEngine.getPageMetaData().getRawPageMetaData(),deliveryEngine:this.__deliveryEngine,additionalInfo:{toModelOnly:!1,eventType:"entryCriteria"}},responder:E.create("com.servicemax.client.sfmdelivery.responders.ChecklistEntryResponder",this)});t.triggerEvent(n)}},{key:"continueIntializing",value:function(){this._children.header=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageHeader",this._data.page.header,this),this._children.header.initialize(),this.__initializeCallback.call(this.__initializeCallbackContext)}},{key:"getBusinessRules",value:function(){for(var e=this._data.page.businessRules||[],t=[],n=0;n<e.length;n++){var i=e[n];i.ruleInfo.bizRule&&"Field Update Rule"!==i.ruleInfo.bizRule[E.getCustomFieldName("Rule_Type")]&&"Checklist_Section_Entry_Criteria"!==i.ruleInfo.bizRule[E.getCustomFieldName("Rule_Type")]&&i.ruleInfo.bizRuleDetails.length>0&&"Business_Rule"===i.ruleInfo.bizRuleDetails[0][E.getCustomFieldName("Expression_Type")]&&t.push(i)}return t}},{key:"getBusinessRulesHash",value:function(){var e=this.getBusinessRules();return"CHECKLIST"===this.__deliveryEngine.getMetaModel().getProcessType()&&this.removeChecklistSkippedQuestionRules(e),this.__commonMethodForBusinessRule(e)}},{key:"__getEntryExitCriteriaBusinessRule",value:function(e){e="entryCriteria"===e?"Checklist_Section_Entry_Criteria":"Checklist_Section_Exit_Criteria";for(var t=this._data.page.businessRules||[],n=[],i=0;i<t.length;i++){var a=t[i];a.ruleInfo.bizRule&&a.ruleInfo.bizRule[E.getCustomFieldName("Rule_Type")]===e&&a.ruleInfo.bizRuleDetails.length>0&&"Business_Rule"===a.ruleInfo.bizRuleDetails[0][E.getCustomFieldName("Expression_Type")]&&(a.ruleInfo.bizRule&&"Checklist_Section_Exit_Criteria"===a.ruleInfo.bizRule[E.getCustomFieldName("Rule_Type")]&&(a.message=a.ruleInfo.bizRule.Id,a.ruleInfo.bizRule[E.getCustomFieldName("Message_Type")]="Error"),n.push(a))}return n}},{key:"getSkippedSectionIndexList",value:function(){return this.__deliveryEngine.skippedSectionsQuestions}},{key:"removeChecklistSkippedQuestionRules",value:function(e){for(var t=e.length-1;t>=0;t--){var n=e[t];if(n.ruleInfo.bizRule&&"Checklist_Section_Exit_Criteria"===n.ruleInfo.bizRule[E.OrgNamespace+"__Rule_Type__c"])e.splice(t,1);else{var i=n.ruleInfo.bizRuleDetails[0][E.OrgNamespace+"__Field_Name__c"];this.getSkippedSectionIndexList().indexOf(i)>-1&&e.splice(t,1)}}}},{key:"getEntryCriteriaBusinessRuleHash",value:function(e){var t=this.__getEntryExitCriteriaBusinessRule(e);return this.__commonMethodForBusinessRule(t)}},{key:"__commonMethodForBusinessRule",value:function(e){var t=void 0,n=this.getData().page.details,i={header:{key:"",rules:[]}};for(t=0;t<n.length;t++);for(t=0;t<e.length;t++){var a=e[t];a.aliasName;i.header.rules.push(a)}return i}},{key:"onEntryCriteriaExecutionComplete",value:function(){var e=this,t=this.__deliveryEngine.getPageMetaData().getRawPageMetaData(),n=function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};if(this.__isAnySectionSatisfyEntryCriteria(t.page.header.sections))this.continueIntializing();else{var i=E.getCurrentApplication();i.hideSpinner(),i.showMessage({type:"CUSTOM",title:" ",text:n().T("FSA008_TAG143","None of the sections meet the entry criteria for this Checklist Process."),buttons:[{text:n().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:function(t){e.closeAndGoBack()}})}}},{key:"__isAnySectionSatisfyEntryCriteria",value:function(e){var t=!1;if(e)for(var n=e.length,i=0;i<n;i++){var a=e[i],r=a.sectionDetail;if(r){var o=r[E.OrgNamespace+"__Entry_Criteria__c"]||!1;if(!o){t=!0;break}}}return t}},{key:"closeAndGoBack",value:function(){0==this.getDeliveryEngine().getNavigationStack().length?(this.__logger.info("Closing Checklist and going back"),this.getDeliveryEngine().doClose()):this.getDeliveryEngine().handleInplaceBackwardNavigation()}},{key:"getFieldInfo",value:function(e,t){return t&&t.fieldDetail&&t.fieldDetail[E.OrgNamespace+"__QuestionInfoJSON__c"]?E.toObject(t.fieldDetail[E.OrgNamespace+"__QuestionInfoJSON__c"]):t}},{key:"getFieldTypes",value:function(){var e={},t=void 0,n=void 0,i=void 0,a=void 0,r=this.objMetadataMap;for(n in r)for(e[n]={},i=r[n].fields,t=0;t<i.length;t++)a=i[t],e[n][a.question.questionID]=a.question.responseType.toLowerCase();return e}},{key:"getQuestionTypes",value:function(){var e={},t=void 0,n=void 0,i=void 0,a=void 0,r=this.objMetadataMap;for(n in r)for(i=r[n].fields,t=0;t<i.length;t++)a=i[t],e[a.question.questionID]=a.question.responseType.toLowerCase();return e}},{key:"getQuestionNames",value:function(){var e=[],t=void 0,n=void 0,i=void 0,a=void 0,r=this.objMetadataMap;for(n in r)for(i=r[n].fields,t=0;t<i.length;t++)a=i[t],e.push(a.question.questionID);return e}},{key:"getQuestionData",value:function(e){for(var t={},n=this.getQuestionNames(),i=this.getQuestionTypes(),a=0;a<n.length;a++){var r=e[n[a]],o=i[n[a]];r&&r.fieldvalue&&("multi-select picklist"==o||"picklist"==o||"checkbox"==o||"radio button"==o)&&(r=r.fieldvalue.key),"number"==o&&0===r&&(r="0"),t[n[a]]=r||""}return t}},{key:"removeQuestionData",value:function(e){for(var t=this.getQuestionNames(),n=0;n<t.length;n++)delete e[t[n]]}},{key:"getObjectLabel",value:function(e){var t=this.getObjectInfo(e);return t&&t.label||"Unknown"}},{key:"getPicklistValues",value:function(e,t){var n=this.getFieldInfo(e,t),i=[];return null!=n&&(i=n.questionResponses)instanceof Array&&i.sort(function(e,t){return(e.sequence||0)-(t.sequence||0)}),i}},{key:"getServicemaxProcessesForExit",value:function(e){for(var t={},n=[],i=[],a=this._data.page.businessRules||[],r=0;r<a.length;r++){var o=a[r];o.ruleInfo.bizRule&&"Checklist_Section_Exit_Criteria"===o.ruleInfo.bizRule[E.getCustomFieldName("Rule_Type")]&&i.push(o)}for(var s=0;s<i.length;s++){var l=i[s],c={};l.ruleInfo.bizRule&&l.ruleInfo.bizRule[E.getCustomFieldName("SM_Section")]===e&&(c[E.OrgNamespace+"__Active__c"]=!0,c[E.OrgNamespace+"__Process3__c"]=l.ruleInfo.bizRule.Id,c[E.OrgNamespace+"__Rule_Type__c"]=l.ruleInfo.bizRule[E.getCustomFieldName("Rule_Type")],c[E.OrgNamespace+"__SM_Section__c"]=l.ruleInfo.bizRule[E.getCustomFieldName("SM_Section")],c[E.OrgNamespace+"__SM_Target_Section__c"]=l.ruleInfo.bizRule[E.getCustomFieldName("SM_Target_Section")],c[E.OrgNamespace+"__Sequence__c"]=l.ruleInfo.bizRule[E.getCustomFieldName("Sequence")],n.push(c))}return t.records=n,t}},{key:"__buildDescribeObject",value:function(e){var t=this,n={activateable:!1,childRelationships:[],fields:[],name:"Checklist__c",label:"Checklist",recordTypeInfos:[],recordTypeMapping:[]},i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=E.OrgNamespace+"__QuestionInfoJSON__c";if(this._data&&this._data.page&&this._data.page.header&&this._data.page.header.sections&&this._data.page.header.sections.length>0)for(a=this._data.page.header.sections.length,i=0;i<a;i++)if(l=this._data.page.header.sections[i],this._data.page.header.sections[i].sectionDetail[E.OrgNamespace+"__Entry_Criteria__c"]=l.sectionDetail[E.OrgNamespace+"__Entry_Criteria__c"]||!1,l.sectionDetail.hasOwnProperty(E.OrgNamespace+"__ServiceMax_Processes__r")||(this._data.page.header.sections[i].sectionDetail[E.OrgNamespace+"__ServiceMax_Processes__r"]=this.getServicemaxProcessesForExit(l.sectionDetail.Id)),l.fields&&l.fields.length>0){for(s=l.fields.length,o=0;o<s;o++)if(c=l.fields[o],c.fieldDetail&&c.fieldDetail[u]){var d=E.toObject(c.fieldDetail[u]);d.dataType="question",n.fields.push(d)}else if(c.fieldDetail&&"Question"===c.fieldDetail[E.OrgNamespace+"__Detail_Type__c"]&&void 0===c.fieldDetail[u]){var _=function(){var e=t;return E.getCurrentApplication().showMessage({type:"CUSTOM",title:L().T("FSA008_TAG077","Warning"),text:"Unable to proceed. Error found in Configured Checklist.",buttons:[{text:L().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:E.proxy(e,function(){e.closeAndGoBack(),console.warn("Checklist Page Layout Missing section Question Field")})}),{v:void 0}}();if("object"===(void 0===_?"undefined":(0,r.default)(_)))return _.v}}else console.warn("Checklist Page Layout Section '"+i+"' Missing Questions");else console.warn("Checklist Page Layout Missing Sections");this.objMetadataMap[e]=n}}]),t}(R.SFMPageMetaModel),R.SFMFieldMappingModel=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments)),i=n.__mapping={};return e.page.lstObjectMapInfo&&E.array.forEach(e.page.lstObjectMapInfo,function(e){var t=i[e.mapId]={};E.array.forEach(e.objectMap.fields,function(e){var n=e.fieldMapRecord[E.OrgNamespace+"__Source_Field_Name__c"];t[e.fieldMapRecord[E.OrgNamespace+"__Target_Field_Name__c"]]=n?{field:e.fieldMapRecord[E.OrgNamespace+"__Source_Field_Name__c"],field2:e.fieldMapRecord[E.OrgNamespace+"__Preference_2__c"],field3:e.fieldMapRecord[E.OrgNamespace+"__Preference_3__c"]}:{value:e.fieldMapRecord[E.OrgNamespace+"__Display_Value__c"]}})}),n}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getFieldList",value:function(e){var t=[],n=this.__mapping[e];return n&&E.forEachProperty(n,function(e,n){n.field&&t.push(n.field),n.field2&&t.push(n.field2),n.field3&&t.push(n.field3)}),t}},{key:"forEachField",value:function(e,t){if(e){var n=this.__mapping[e];n&&E.forEachProperty(n,t)}}}]),t}(A),R.SFMPageAssociatedViewProcesses=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.initialize(e),n.title=null,n.processId=null,n}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(e){this.title=e.process_name,this.processId=e.process_unique_id}}]),t}(A),R.SFMPageHeader=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.pageEvents=[],i.__controllingPicklistFields=[],i.objectName=null,i.actions=null,i.helpURL="",i.hideQuickSave=!1,i.hideSave=!1,i.hideSaveAndNew=!1,i.hideChatter=!1,i.pageHelp=null,i.__recordTypeField=null,i.__currentRecordType=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"doCleanup",value:function(){var e=this.getChildNode("sections");e&&E.array.forEach(e,function(e){e.doCleanup()});var n=this.getChildNode("actions");return n&&E.array.forEach(n,function(e){e.doCleanup()}),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(){var e=this._parent.getProcessType(),t=!1;this.getRoot()&&this.getRoot().getDeliveryEngine()&&this.getRoot().getDeliveryEngine().additionalInfo&&"VIEW"===this.getRoot().getDeliveryEngine().additionalInfo.specialProcessType&&(t=!0);var n=t||"VIEW RECORD"==e||"CHECKLIST LIST"==e;this.isDisplayOnly=n,this.objectName=this._data.headerLayout[E.OrgNamespace+"__Object_Name__c"],this.helpURL=this._data.headerLayout[E.OrgNamespace+"__Help_URL__c"],this.hideQuickSave=n||this._data.headerLayout[E.OrgNamespace+"__Hide_Quick_Save__c"]||"STANDALONE EDIT"!=e&&"CHECKLIST"!=e,this.hideSave=n||this._data.headerLayout[E.OrgNamespace+"__Hide_Save__c"],this.hideSaveAndNew="STANDALONE CREATE"!=e,this.hideChatter="STANDALONE EDIT"!=e,this.pageHelp=this._data.headerLayout[E.OrgNamespace+"__Page_Help__c"],this.isDisplayOnly&&(this.associatedViewProcesses=this._parent.associatedViewProcesses);var i,a,r,o=this._data.pageEvents,s=o.length,l=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();for(i=0;i<s;i++)r=o[i][E.OrgNamespace+"__Event_Type__c"],"Before Save/Update"==r||"Before Save/Insert"==r?r="Before Save":"After Save/Update"!=r&&"After Save/Insert"!=r||(r="After Save"),a=o[i][E.OrgNamespace+"__Event_Call_Type__c"],a||(a="WEBSERVICE",o[i][E.OrgNamespace+"__Event_Call_Type__c"]=a),l.isEventSupported(o[i])&&(this.pageEvents[this.pageEvents.length]={callType:a,target:o[i][E.OrgNamespace+"__Target_Call__c"],eventType:r,eventId:o[i].Id,eventRawData:o[i]});for(var c=this._data.sections.length,u=[],d=E.getClient().getApplicationParameter("enable-sla-clock"),_=0;_<c;_++){var h=this._data.sections[_],f=h.sectionDetail[E.OrgNamespace+"__Entry_Criteria__c"]||!1;if((d||h.sectionDetail)&&!f){var p=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageSection",h,this);p.initialize(),u.push(p)}}this._children.sections=E.sort(u,"sequence");var m=this.getRecordTypeField();!m&&this._children.sections.length>0&&(m=this.createHiddenRecordTypeField(this._children.sections[0]),this.registerRecordTypeField(m));var v,i,g,y,S=this.getAllPageFields(),b=this._parent.getAllPicklists(this.objectName),T=[],s=b.length,M=S.length;for(i=0;i<s;i++){for(y=!1,g=0;g<M;g++)if(b[i].name==S[g].fieldDetail[E.OrgNamespace+"__Field_API_Name__c"]){y=!0;break}y||T.push(b[i])}var I=void 0,C=T.length;for(I=0;I<C;I++)v=this.createHiddenControllingPicklistField(T[I]),this.registerControllingPicklistField(v);var A=this._data.buttons,D=void 0;for(s=A.length,u=[],i=0;i<s;i++)l.isActionButtonVisible(A[i])&&(D=u[u.length]=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageAction",A[i],this),D.initialize());this._children.actions=u}},{key:"getAllPageFields",value:function(){var e=this._children.sections,t=void 0,n=e.length,i=void 0,a=[];for(i=0;i<n;i++)for(t=0;t<e[i].getData().fields.length;t++)a.push(e[i].getData().fields[t]);return a}},{key:"getFieldTypes",value:function(){for(var e=this.getAllFields(),t={},n=0;n<e.length;n++){var i=e[n];t[i.name]=i.type}return t}},{key:"getAllFields",value:function(){var e=this.getRoot(),t=e.objMetadataMap[this.objectName];return t?t.fields:[]}},{key:"getPageEventInfoFor",value:function(e){var t=void 0,n=this.pageEvents.length,i=null;for(t=0;t<n;t++)if(this.pageEvents[t].eventType==e){i=this.pageEvents[t];break}return i}},{key:"getAttachmentsHidden",value:function(){return!this._data||!this._data.headerLayout[E.OrgNamespace+"__Enable_Attachments__c"]||!E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance().getAttachmentsEnabled()}},{key:"getPrecision",value:function(e){return this._parent.getPrecision(this.objectName,e)}},{key:"getScale",value:function(e){return this._parent.getScale(this.objectName,e)}},{key:"getFieldLabel",value:function(e){return this._parent.getFieldLabel(this.objectName,e)}},{key:"isFieldAccessible",value:function(e){return this._parent.isFieldAccessible(this.objectName,e)}},{key:"isFieldRequired",value:function(e){return this._parent.isFieldRequired(this.objectName,e)}},{key:"isFieldReadOnly",value:function(e){return this._parent.isFieldReadOnly(this.objectName,e)}},{key:"getPicklistValues",value:function(e){return this._parent.getPicklistValues(this.objectName,e)}},{key:"getControllingPicklist",value:function(e){return this._parent.getControllingPicklist(this.objectName,e)}},{key:"resolveDependencies",value:function(){var e=this._children.sections,t=void 0,n=e.length;for(t=0;t<n;t++)e[t].resolveDependencies()}},{key:"getFieldMetaInfoFromName",value:function(e){return this._parent.getFieldInfoFromName(this.objectName,e)}},{key:"getFieldInfoFromName",value:function(e){var t=this._children.sections,n=null,i=void 0,a=t.length;for(i=0;i<a&&!(n=t[i].getFieldInfo(e));i++);return n}},{key:"getControllingPicklistFieldDataFromName",value:function(e){var t=this.getFieldInfoFromName(e);if(t&&(t=t.getFieldData()),!t){var n=void 0,i=this.__controllingPicklistFields.length;for(n=0;n<i;n++)if(this.__controllingPicklistFields[n].fieldName==e){t=this.__controllingPicklistFields[n].getFieldData();break}}return t}},{key:"getLookupContextFieldInfo",value:function(e){var t=this._children.sections,n=null,i=void 0,a=t.length;for(i=0;i<a&&!(n=t[i].getFieldInfo(e));i++);return n}},{key:"getObjectName",value:function(){return this.objectName}},{key:"createHiddenRecordTypeField",value:function(e){return null==this.__recordTypeField&&(this.__recordTypeField=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageRecordTypeField",null,e),this.__recordTypeField.initialize()),this.__recordTypeField}},{key:"createHiddenControllingPicklistField",value:function(e){var t=e.name,n=this.getRoot(),e=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageHiddenPicklistField",e,n);return e.initialize(t),e}},{key:"registerRecordTypeField",value:function(e){null==this.__recordTypeField&&(this.__recordTypeField=e)}},{key:"registerControllingPicklistField",value:function(e){return this.__controllingPicklistFields.push(e)}},{key:"getRecordTypeField",value:function(){return this.__recordTypeField}},{key:"getControllingPicklistFields",value:function(){return this.__controllingPicklistFields}},{key:"setCurrentRecordType",value:function(e){this.__currentRecordType=e}},{key:"getCurrentRecordTypeInfo",value:function(){return this._parent.getCurrentRecordTypeInfo(this.__currentRecordType,this.objectName)}}]),t}(D),R.SFMPageSection=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.title=null,i.colCount=0,i.labelAlignment="",i.labelStyle="",i.sequence=0,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"doCleanup",value:function(){var e=this.getChildNode("fields");return e&&E.array.forEach(e,function(e){e.doCleanup&&"function"==typeof e.doCleanup&&e.doCleanup()}),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(){this.title=this._data.sectionDetail[E.OrgNamespace+"__Title__c"],this.colCount=this.__extractColumnCount(),this.labelAlignment=E.getClient().getApplicationParameter("svmx-sfm-section-label-align"),this.labelStyle=E.getClient().getApplicationParameter("svmx-sfm-section-label-style"),this.sequence=this._data.sectionDetail[E.OrgNamespace+"__Sequence__c"];var e=void 0,t=this._data.fields.length,n=[],i=null;for(e=0;e<t;e++){var a=this._data.fields[e],r=a.fieldDetail[E.OrgNamespace+"__DataType__c"],o=a.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"],s=a.fieldDetail[E.OrgNamespace+"__Detail_Type__c"];o==O.RECORD_TYPE_ID?i=n[e]=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageRecordTypeField",a,this):"reference"==r&&"Question"===s?(this.getRoot()&&this.getRoot().getDeliveryEngine()&&this.getRoot().getDeliveryEngine().additionalInfo&&"VIEW"===this.getRoot().getDeliveryEngine().additionalInfo.specialProcessType&&(a.fieldDetail[E.OrgNamespace+"__Readonly__c"]=!0),n[e]=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageQuestionField",a,this)):n[e]="reference"==r&&"List"===s?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageListField",a,this):"reference"==r?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageReferenceField",a,this):"picklist"==r?E.create("com.servicemax.client.sfmdelivery.engine.SFMPagePicklistField",a,this):"multipicklist"==r?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageMultiPicklistField",a,this):"boolean"==r?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageBooleanField",a,this):E.create("com.servicemax.client.sfmdelivery.engine.SFMPageField",a,this),n[e].initialize()}this._children.fields=n,null!=i&&this._parent.registerRecordTypeField(i)}},{key:"registerControllingPicklistField",value:function(e){return this._parent.registerControllingPicklistField(e)}},{key:"__extractColumnCount",value:function(){var e=this._data.sectionDetail[E.OrgNamespace+"__No_Of_Columns__c"]||1,t=E.getUrlParameter("column-count");if(t&&""!=t)try{t=parseInt(t),isNaN(t)||(e=t)}catch(e){}return e}},{key:"getRecordTypeField",value:function(){return this._parent.getRecordTypeField()}},{key:"getControllingPicklistFields",value:function(){return this._parent.getControllingPicklistFields()}},{key:"setCurrentRecordType",value:function(e){this._parent.setCurrentRecordType(e)}},{key:"getCurrentRecordTypeInfo",value:function(){return this._parent.getCurrentRecordTypeInfo()}},{key:"getFieldLabel",value:function(e){return this._parent.getFieldLabel(e)}},{key:"getPrecision",value:function(e){return this._parent.getPrecision(e)}},{key:"getScale",value:function(e){return this._parent.getScale(e)}},{key:"getObjectName",value:function(){return this._parent.getObjectName()}},{key:"isFieldAccessible",value:function(e){return this._parent.isFieldAccessible(e)}},{key:"isFieldRequired",value:function(e){return this._parent.isFieldRequired(e)}},{key:"isFieldReadOnly",value:function(e){return this._parent.isFieldReadOnly(e)}},{key:"getPicklistValues",value:function(e){return this._parent.getPicklistValues(e)}},{key:"resolveDependencies",value:function(){var e=this._children.fields,t=void 0,n=e.length;for(t=0;t<n;t++)e[t].resolveDependencies()}},{key:"getFieldInfoFromName",value:function(e){return this._parent.getFieldInfoFromName(e)}},{key:"getFieldInfo",value:function(e){var t=this._children.fields,n=null,i=void 0,a=t.length;for(i=0;i<a;i++)if(t[i].fieldName==e){n=t[i];break}return n}},{key:"getLookupContextFieldInfo",value:function(e){return this._parent.getLookupContextFieldInfo(e)}},{key:"getControllingPicklist",value:function(e){return this._parent.getControllingPicklist(e)}},{key:"getFieldMetaInfoFromName",value:function(e){return this._parent.getFieldMetaInfoFromName(e)}},{key:"getControllingPicklistFieldDataFromName",value:function(e){return this._parent.getControllingPicklistFieldDataFromName(e)}},{key:"getData",value:function(){return this._data}},{key:"getRelatedBindingValue",value:function(e,t){this._parent.getRelatedBindingValue(e,t)}}]),t}(D),R.SFMPageField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i._logger=E.getLoggingService().getLogger("SFMDELIVERY-SFMPAGEFIELD"),i.fieldName=null,i.fieldLabel=null,i.datatype=null,i.readOnly=!1,i.required=!1,i.sequence=0,i.row=null,i.column=null,i.__dataBinding=null,i.fieldEvents=null,i.fieldWidth=0,i.charLength=0,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.fieldLabel=this.getFieldLabel(),this.datatype=this._data.fieldDetail[E.OrgNamespace+"__DataType__c"],this.readOnly=this._isFieldReadOnly(),this.required=this._isFieldRequired(),this.fieldName=this._data.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"];var e=this.getRoot().getFieldInfo(this._parent.getObjectName(),this._data);this.charLength=e?e.length:0,this.row=this._data.fieldDetail[E.OrgNamespace+"__Display_Row__c"],this.column=this._data.fieldDetail[E.OrgNamespace+"__Display_Column__c"],this.fieldWidth=this._data.fieldDetail[E.OrgNamespace+"__Width__c"],this.fieldEvents=[];var t=this._data.fieldEvents,n=void 0,i=t.length,a=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();for(n=0;n<i;n++)a.isEventSupported(t[n])&&(this.fieldEvents[this.fieldEvents.length]={callType:t[n][E.OrgNamespace+"__Event_Call_Type__c"],target:t[n][E.OrgNamespace+"__Target_Call__c"],eventType:t[n][E.OrgNamespace+"__Event_Type__c"],eventId:t[n].Id,eventRawData:t[n]});this.sequence=this._data.fieldDetail[E.OrgNamespace+"__Sequence__c"],this.precision=this.getPrecision(),this.scale=this.getScale()}},{key:"getEventInfoFor",value:function(e){var t=void 0,n=this.fieldEvents.length,i=null;for(t=0;t<n;t++)if(this.fieldEvents[t].eventType==e){i=this.fieldEvents[t];break}return i}},{key:"getFieldData",value:function(){return this._data}},{key:"getPrecision",value:function(){return this._parent.getPrecision(this._data)}},{key:"getScale",value:function(){return this._parent.getScale(this._data)}},{key:"getFieldLabel",value:function(){return this._parent.getFieldLabel(this._data)}},{key:"isFieldAccessible",value:function(){return this._parent.isFieldAccessible(this._data)}},{key:"_isFieldRequired",value:function(){if("boolean"==this.datatype)return!1;var e=this._parent.isFieldRequired(this._data);return 0==e&&(e=this._data.fieldDetail[E.OrgNamespace+"__Required__c"]),e}},{key:"_isFieldReadOnly",value:function(){var e=this._parent.isFieldReadOnly(this._data);return 0==e&&(e=this._data.fieldDetail[E.OrgNamespace+"__Readonly__c"]),e}},{key:"getPicklistValues",value:function(){return E.getLoggingService().getLogger().warning("SFMPageField::getPicklistValues() is deprecated!"),E.cloneObject(this._parent.getPicklistValues(this._data))}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding=this.getRoot().getDataModel().createBinding(this.fieldName,e,t,n),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding?this.__dataBinding:this._parent.getDataBinding()}}]),t}(D),R.SFMPagePicklistField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.isDependentPickList=!1,i.controllingPicklist=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.controllingPicklist=this._parent.getControllingPicklist(this._data),this.controllingPicklist&&(this.isDependentPickList=!0)}},{key:"registerControllingPicklistField",value:function(e){return this._parent.registerControllingPicklistField(e)}},{key:"__getParentIndexFor",value:function(e){var t=this._parent.getFieldInfoFromName(this.controllingPicklist),n=this._parent.getPicklistValues(t.getFieldData()),i=void 0,a=n.length,r=-1;for(i=0;i<a;i++)if(n[i].value===e){r=i;break}return r}},{key:"__getParentPicklistEntryFor",value:function(e){var t=this._parent.getControllingPicklistFieldDataFromName(this.controllingPicklist),n=null;if(t){var i=this._parent.getPicklistValues(t),a=void 0,r=i.length;for(a=0;a<r;a++){var o=void 0!==e&&null!==e?e.toString():e;if(i[a].value===o){n=i[a];break}}}return n}},{key:"getPicklistEntryLabelFor",value:function(e){var t=this.getPicklistValues({},!0),n=void 0,i=t.length,a="";if(void 0!==e&&null!==e)for(n=0;n<i;n++)if(t[n].value==e){a=t[n].label;break}return a}},{key:"getPicklistValues",value:function(e,t){var n=this._parent.getPicklistValues(this._data),i=n,a=void 0,r=void 0,o=void 0,s=void 0;if(this.isDependentPickList&&!t&&!this.isDisplayOnly&&(i=[],e)){var l=this.__getParentPicklistEntryFor(e.value);if(l){var c=l.dependendPicklist;if(c)for(r=c.length,a=0;a<r;a++)if(c[a].fieldAPIName==this.fieldName){var u=c[a].value;if(u){u=u.split(";");var d=n.length;for(o=0,s=0;o<d;o++)u[s]==o&&(i.push(n[o]),s++)}break}}}var _=this._getCurrentRecordTypeInfo(e);if(_){var h=this._extractPicklistFromRecordTypeInfo(_);if(h&&h.length>0){var f=[],p=h.length;for(r=i.length,a=0;a<r;a++)for(o=0;o<p;o++)if(i[a].value==h[o].value){f.push(i[a]);break}i=f}}var m=L().T("FSA008_TAG065","--None--");return i=E.cloneObject(i),i.splice(0,0,{label:m,value:O.NO_VALUE}),i}},{key:"_getCurrentRecordTypeInfo",value:function(e){return this._parent.getCurrentRecordTypeInfo()}},{key:"_extractPicklistFromRecordTypeInfo",value:function(e){if(!e.picklistsForRecordType)return[];var t=null,n=e.picklistsForRecordType,i=void 0,a=n.length,r=void 0,o=void 0,s=void 0;for(i=0;i<a;i++)if(n[i].picklistName==this.fieldName){r=n[i].picklistValues;break}if(r){var l=this._parent.getPicklistValues(this._data),c=r[0].value;if(c){var u=c.split(";"),d=l.length;for(t=[],o=0,s=0;o<d;o++)u[s]==o&&(t.push(l[o]),s++)}}return t}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding=this.getRoot().getDataModel().createPicklistBinding(this.fieldName,e,t,n),this.__dataBinding}},{key:"getControllerBinding",value:function(){var e=void 0,t=null;return this._parent.getFieldMetaInfoFromName(this.controllingPicklist),e=this._parent.getControllingFieldInfo(this.controllingPicklist),e&&(t=e.getDataBinding()),t}},{key:"getRecordTypeField",value:function(){return this._parent.getRecordTypeField()}},{key:"getControllingPicklistFields",value:function(){if(void 0!=this._parent.getControllingPicklistFields())return this._parent.getControllingPicklistFields()}},{key:"resolveDependencies",value:function(){var e=void 0,t=void 0;if(this.isDependentPickList)if(t=this._parent.getFieldMetaInfoFromName(this.controllingPicklist),e=this._parent.getFieldInfoFromName(this.controllingPicklist))e.bind("CHANGED",this._parentValueChanged,this),e.bind("AFTER_CHANGED",this._afterValueChanged,this);else{var n=this.getControllingPicklistFields(),i=void 0,a=n.length;if(t&&t.name)for(i=0;i<a;i++)n[i]._data.name==t.name&&(n[i].bind("CHANGED",this._parentValueChanged,this),n[i].bind("AFTER_CHANGED",this._afterValueChanged,this));this._logger.warning(this.fieldName+" is a dependent picklist but the controlling picklist is not modeled!")}else if(this.shouldParticipateInDependencyChain()){var r=this.getRecordTypeField();r&&(r.bind("CHANGED",this._parentValueChanged,this),r.bind("AFTER_CHANGED",this._afterValueChanged,this))}}},{key:"_parentValueChanged",value:function(e){var t=E.create("com.servicemax.client.lib.api.Event","PARENT_CHANGED",this,e.data);this.triggerEvent(t)}},{key:"_afterValueChanged",value:function(e){var t=E.create("com.servicemax.client.lib.api.Event","AFTER_CHANGED",this,e.data);this.triggerEvent(t)}},{key:"shouldParticipateInDependencyChain",value:function(){return!0}}]),t}(R.SFMPageField),R.SFMPageBooleanField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"resolveDependencies",value:function(){var e=this._parent.getRecordTypeField();e&&(e.bind("CHANGED",this._parentValueChanged,this),e.bind("AFTER_CHANGED",this._afterValueChanged,this))}},{key:"_parentValueChanged",value:function(e){var t=E.create("com.servicemax.client.lib.api.Event","PARENT_CHANGED",this,e.data);this.triggerEvent(t)}},{key:"_afterValueChanged",value:function(e){var t=E.create("com.servicemax.client.lib.api.Event","AFTER_CHANGED",this,e.data);this.triggerEvent(t)}}]),t}(R.SFMPageField),R.SFMPageMultiPicklistField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this)}}]),t}(R.SFMPagePicklistField),R.SFMPageRecordTypeField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){null==this._data?(this.fieldName="RecordTypeId",this._initializeHiddenMode()):(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.datatype="recordtype",this.fieldLabel=L().T("FSA008_TAG126","Record Type")}},{key:"_initializeHiddenMode",value:function(){var e=null;this.__dataBinding=this.getRoot().getDataModel().createBinding(this.fieldName,function(t){e=t;var n=E.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:e});this.triggerRecordTypeChanged(n)},function(){return e},this)}},{key:"getPicklistValues",value:function(e,t){var n=this._parent.getObjectName(),i=this.getRoot().getRecordTypesFor(n),a=L().T("FSA008_TAG065","--None--"),r=[{label:a,value:O.NO_VALUE}],o=void 0,s=i.length;for(o=0;o<s;o++)r.push({label:i[o].name,value:i[o].recordTypeId});return r}},{key:"triggerRecordTypeChanged",value:function(e){var t=e.data.value;t===O.NO_VALUE&&(t=null),this._parent.setCurrentRecordType(t),this.triggerEvent(e)}},{key:"shouldParticipateInDependencyChain",value:function(){return!1}}]),t}(R.SFMPagePicklistField),R.SFMPageHiddenPicklistField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.fieldName=this._data.name;var e=null;this.__dataBinding=this.getRoot().getDataModel().createBinding(this.fieldName,function(t){e="boolean"==typeof t?t.toString():t;var n=E.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:e});this.triggerHiddenPicklistChanged(n)},function(){var t=e;return"boolean"!=this._data.dataType||void 0!==e&&null!==e&&""!==e||(t=!!e),t},this)}},{key:"triggerHiddenPicklistChanged",value:function(e){this.triggerEvent(e)}}]),t}(R.SFMPagePicklistField),R.SFMPageReferenceField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.objectName=null,i.namedSearchId=null,i.bOverrideRelatedLookup=!0,i.lookupContext=null,i.lookupQueryField=null,i.lookupContextFieldInfo=null,i.__lookupModel=null,i.enableRecentItems=!1,i.nameFieldName=null,i.fieldMappingId=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.objectName=this._data.fieldDetail[E.OrgNamespace+"__Related_Object_Name__c"],this.namedSearchId=this._data.fieldDetail[E.OrgNamespace+"__Named_Search__c"],this.bOverrideRelatedLookup=this._data.fieldDetail[E.OrgNamespace+"__Override_Related_Lookup__c"],this.lookupQueryField=this._data.fieldDetail[E.OrgNamespace+"__Lookup_Query_Field__c"],this.lookupContext=this._data.fieldDetail[E.OrgNamespace+"__Lookup_Context__c"],this.nameFieldName=this._data.fieldDetail[E.OrgNamespace+"__Related_Object_Name_Field__c"],this.fieldMappingId=this._data.fieldDetail[E.OrgNamespace+"__Field_Mapping__c"],this.autoResolveLookup=this.getRoot().getDeliveryEngine().getSettings().getSetting("SET001","bool"),this.enableRecentItems=this.getRoot().getDeliveryEngine().getSettings().getSetting("SET003","bool")}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding=this.getRoot().getDataModel().createReferenceBinding(this.fieldName,e,t,n),this.__dataBinding}},{key:"resolveDependencies",value:function(){this.lookupContext&&(this.lookupContextFieldInfo=this._parent.getLookupContextFieldInfo(this.lookupContext))}},{key:"getLookupModel",value:function(e){return null==this.__lookupModel&&(this.__lookupModel=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageLookupModel",this)),e&&(this.__lookupModel=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageLookupModel",this)),this.__lookupModel}},{key:"getFieldLabelFromRelatedObject",value:function(e){return this.getRoot().getLabel(this.objectName,e)}},{key:"getFieldTypeFromRelatedObject",value:function(e){return this.getRoot().getFieldType(this.objectName,e)}},{key:"getRelatedObjectLabel",value:function(){return this.getRoot().getObjectLabel(this.objectName)}},{key:"getRelatedObjectPluralLabel",value:function(){return this.getRoot().getObjectPluralLabel(this.objectName)}},{key:"getPicklistValuesFromRelatedObject",value:function(e){return this.getRoot().getPicklistValuesFromFieldName(this.objectName,e)}}]),t}(R.SFMPageField),R.SFMPageQuestionField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.__fieldInfo={},i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this._data.fieldDetail&&this._data.fieldDetail[E.OrgNamespace+"__QuestionInfoJSON__c"]&&(this.__fieldInfo=E.toObject(this._data.fieldDetail[E.OrgNamespace+"__QuestionInfoJSON__c"])),this.fieldLabel=this.getFieldLabel(),this.datatype=this.__getDataType(),this.readOnly=this._isFieldReadOnly(),this.required=this._isFieldRequired(),this.fieldName=this.__getFieldName(),this.questionSFID=this.__getQuestionId(),this.questionName=this.__getQuestionName(),this.isDisplayOnly=this._isFieldReadOnly(),this.isDescriptionRequired=this._isDescriptionRequired(),this.isImageShowInOPDoc=this._isImageShowInOPDoc(),this.charLength=this.__fieldInfo&&this.__fieldInfo.question&&this.__fieldInfo.question.length?this.__fieldInfo.question.length:0,this.row=this._data.fieldDetail[E.OrgNamespace+"__Sequence__c"],this.column=1,this.fieldWidth=this._data.fieldDetail[E.OrgNamespace+"__Width__c"],this.fieldEvents=[];var e=this._data.fieldEvents,t=void 0,n=e.length,i=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();for(t=0;t<n;t++)i.isEventSupported(e[t])&&(this.fieldEvents[this.fieldEvents.length]={callType:e[t][E.OrgNamespace+"__Event_Call_Type__c"],target:e[t][E.OrgNamespace+"__Target_Call__c"],eventType:e[t][E.OrgNamespace+"__Event_Type__c"],eventId:e[t].Id,eventRawData:e[t]});this.sequence=this._data.fieldDetail[E.OrgNamespace+"__Sequence__c"],this.precision=this.getPrecision(),this.scale=this.getScale()}},{key:"__getQuestionId",value:function(){return this._data&&this._data.fieldDetail[E.OrgNamespace+"__Question__c"]}},{key:"__getQuestionName",value:function(){return this._data.fieldDetail.Name}},{key:"__getDataType",value:function(){var e="";return this._data&&this._data.fieldDetail[E.OrgNamespace+"__Detail_Type__c"]&&(e=this._data.fieldDetail[E.OrgNamespace+"__Detail_Type__c"],e=e&&e.toLowerCase()),e}},{key:"__getQuestionInfo",value:function(e){var t=null;return e&&this.__fieldInfo&&this.__fieldInfo.question&&(t=this.__fieldInfo.question[e]||null),t}},{key:"__getFieldName",value:function(){return this.__getQuestionInfo("questionID")}},{key:"_isFieldReadOnly",value:function(){return this._data.fieldDetail[E.OrgNamespace+"__Readonly__c"]}},{key:"_isFieldRequired",value:function(){return"boolean"!=this.datatype&&this._data.fieldDetail[E.OrgNamespace+"__Required__c"]}},{key:"_isDescriptionRequired",value:function(){return this.__fieldInfo.question.DescriptionRequired||this.__fieldInfo.question.descriptionRequired}},{key:"_isImageShowInOPDoc",value:function(){return this.__fieldInfo.question.ShowInSmartDoc||this.__fieldInfo.question.showInSmartDoc}},{key:"getQuestionType",value:function(){var e=this.__getQuestionInfo("responseType");return e=e&&e.toLowerCase()}},{key:"getFieldLabel",value:function(){return this.__getQuestionInfo("question")}},{key:"getPrecision",value:function(){return this.__getQuestionInfo("precision")||0}},{key:"getScale",value:function(){return this.__getQuestionInfo("scale")||0}},{key:"getHelpURL",value:function(){var e=this.__getQuestionInfo("helpURL")||void 0,t=/^((http|https):\/\/)/,n=void 0!=e?e.toLowerCase():void 0;return n&&n.length>0&&!t.test(n)&&(e="http://"+e),e}},{key:"isFieldRequired",value:function(){return this.required}},{key:"isFieldAccessible",value:function(){return this.__getQuestionInfo("active")||!1}},{key:"createAttachmentBinding",value:function(e,t,n){return this.__dataBinding=this.getRoot().getDataModel().createAttachmentBinding(""+this.fieldName,e,t,n),this.__dataBinding}}]),t}(R.SFMPageField),R.SFMPageListField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.__fieldInfo={},i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this._data.fieldDetail&&this._data.fieldDetail[E.OrgNamespace+"__QuestionInfoJSON__c"]&&(this.__fieldInfo=E.toObject(this._data.fieldDetail[E.OrgNamespace+"__QuestionInfoJSON__c"])),this.fieldLabel=this.getFieldLabel(),this.datatype=this.__getDataType(),this.readOnly=this._isFieldReadOnly(),this.required=this._isFieldRequired(),this.fieldName=this.__getFieldName(),this.isDisplayOnly=this._isFieldReadOnly(),this.charLength=0,this.row=this._data.fieldDetail[E.OrgNamespace+"__Sequence__c"],this.column=1,this.fieldWidth=this._data.fieldDetail[E.OrgNamespace+"__Width__c"],this.fieldEvents=[];var e=this._data.fieldEvents,t=void 0,n=e.length,i=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();for(t=0;t<n;t++)i.isEventSupported(e[t])&&(this.fieldEvents[this.fieldEvents.length]={callType:e[t][E.OrgNamespace+"__Event_Call_Type__c"],target:e[t][E.OrgNamespace+"__Target_Call__c"],eventType:e[t][E.OrgNamespace+"__Event_Type__c"],eventId:e[t].Id,eventRawData:e[t]});this.sequence=this._data.fieldDetail[E.OrgNamespace+"__Sequence__c"],this.precision=this.getPrecision(),this.scale=this.getScale()}},{key:"__getDataType",value:function(){return"list"}},{key:"__getFieldName",value:function(){return this._data.fieldDetail.Id||""}},{key:"_isFieldReadOnly",value:function(){return this._data.fieldDetail[E.OrgNamespace+"__Readonly__c"]}},{key:"getFieldLabel",value:function(){return""}},{key:"getPrecision",value:function(){return 0}},{key:"getScale",value:function(){return 0}},{key:"isFieldAccessible",value:function(){return!0}}]),t}(R.SFMPageField),R.SFMPageAction=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.events=[],i.title=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.title=this._data.buttonDetail[E.OrgNamespace+"__Title__c"];var e=this._data.buttonEvents,t=void 0,n=e.length,i=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();for(t=0;t<n;t++)i.isEventSupported(e[t])&&(this.events[this.events.length]={callType:e[t][E.OrgNamespace+"__Event_Call_Type__c"],target:e[t][E.OrgNamespace+"__Target_Call__c"],eventType:e[t][E.OrgNamespace+"__Event_Type__c"],eventId:e[t].Id,eventRawData:e[t]})}}]),t}(D),R.SFMPageDetails=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.__path="details",i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"doCleanup",value:function(){var e=this.getChildNode("details");return e&&E.array.forEach(e,function(e){e.doCleanup&&"function"==typeof e.doCleanup&&e.doCleanup()}),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(e,t){var n=void 0,i=this._data.length,a=[];for(n=0;n<i;n++)a[n]=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetail",this._data[n],this),a[n].initialize();for(this._children.details=E.sort(a,"sequence"),i=this._children.details.length,n=0;n<i;n++)this._children.details[n].afterSort(n+1);e.call(t)}},{key:"getCurrentRecordTypeInfo",value:function(e,t){return this._parent.getCurrentRecordTypeInfo(e,t)}},{key:"getFieldLabel",value:function(e,t){return this._parent.getFieldLabel(e,t)}},{key:"getPrecision",value:function(e,t){return this._parent.getPrecision(e,t)}},{key:"getScale",value:function(e,t){return this._parent.getScale(e,t)}},{key:"isFieldAccessible",value:function(e,t){return this._parent.isFieldAccessible(e,t)}},{key:"isFieldRequired",value:function(e,t){var n=this._parent.isFieldRequired(e,t);return n||(n=t.fieldDetail[E.OrgNamespace+"__Required__c"]),n}},{key:"isFieldReadOnly",value:function(e,t){return this._parent.isFieldReadOnly(e,t)}},{key:"getPicklistValues",value:function(e,t){return this._parent.getPicklistValues(e,t)}},{key:"getControllingPicklist",value:function(e,t){return this._parent.getControllingPicklist(e,t)}},{key:"getAllPicklists",value:function(e){var t=this._parent.objMetadataMap[e].fields,n=void 0,i=t.length,a=[];for(n=0;n<i;n++)"picklist"!=t[n].dataType&&"boolean"!=t[n].dataType||a.push(t[n]);return a}},{key:"getFieldMetaInfoFromName",value:function(e,t){return this._parent.getFieldInfoFromName(e,t)}},{key:"resolveDependencies",value:function(){var e=this._children.details,t=void 0,n=e.length;for(t=0;t<n;t++)e[t].resolveDependencies()}},{key:"getParent",value:function(){return this._parent}},{key:"getDetail",value:function(e){var t=this._children.details,n=void 0,i=t.length,a=null;for(n=0;n<i;n++)if(t[n].layoutId==e.split(".")[1]){a=t[n];break}return a}},{key:"getPath",value:function(){return this.__path}},{key:"getControllingPicklistFieldDataFromName",value:function(e,t){var n=this._parent.getFieldInfoFromName(e,t);if(!n){var i=void 0,a=this.__controllingPicklistFields.length;for(i=0;i<a;i++)if(this.__controllingPicklistFields[i].fieldName==t){n=this.__controllingPicklistFields[i].getFieldData();break}}return n}},{key:"getRelatedBindingValue",value:function(e,t,n){var i="";if("CURRENTRECORD"==t){if(n&&n.valueHash){var a=n.valueHash[e+"__key"];if(null!=a&&void 0!=a&&""!=a&&"object"===(void 0===a?"undefined":(0,r.default)(a))){if(i=a.key,n.isDateTime){i=T.getFormattedDatetime(i);var o=n.userInfo.TimezoneOffset,s=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();i=s.getFormattedDateTimeValue(i,o)}else if(n.isDateOnly){var s=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();i=s.getFormattedDateValue(i)}}else i=n.valueHash[e]}}else{i=this.getRoot().__dataModel.__allBindingsHash[e].getValue();var l=this.getRoot().__dataModel.__allBindingsHash[e],c=l.__context;if(null!=c){var u=c.getCompositionMetamodel&&c.getCompositionMetamodel()||c.compositionMetamodel;if("datetime"==u.datatype){var s=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance(),o=this.getRoot().getUserInfo().TimezoneOffset;i=s.getFormattedDateTimeValue(i,o)}else if("date"==u.datatype){var s=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();i=s.getFormattedDateValue(i)}}i&&"object"===(void 0===i?"undefined":(0,r.default)(i))&&(i=i.key)}return i}}]),t}(D),R.SFMPageDetail=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.__logger=E.getLoggingService().getLogger("SFMDELIVERY-PAGE-DETAIL-MODEL"),i.events=[],i.title="",i.sequence=0,i.allowNewLines=!1,i.allowDeleteLines=!1,i.actionOnZeroLines="",i.objectName="",i.layoutId=null,i.__dataBinding=null,i.__allColumnDataBindings=null,i.__allColumnDataBindingsHash=null,i.colCount=0,i.labelAlignment=null,i.labelStyle=null,i.__recordTypeField=null,i.multiAddSearchObject=null,i.multiAddSearchField=null,i.enableRecentItems=!0,i.__controllingPicklistFields=[],i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"doCleanup",value:function(){var e=this.getChildNode("fields");return e&&E.array.forEach(e,function(e){e.doCleanup&&"function"==typeof e.doCleanup&&e.doCleanup()}),(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(){this.__allColumnDataBindings=[],this.__allColumnDataBindingsHash={};var e=E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");this.colCount=e?1:2,this.labelAlignment=E.getClient().getApplicationParameter("svmx-sfm-section-label-align"),this.labelStyle=E.getClient().getApplicationParameter("svmx-sfm-section-label-style"),this.title=this._data.DetailLayout[E.OrgNamespace+"__Name__c"],this.sequence=this._data.DetailLayout[E.OrgNamespace+"__Sequence__c"],this.allowNewLines=this._data.DetailLayout[E.OrgNamespace+"__Allow_New_Lines__c"],this.allowDeleteLines=this._data.DetailLayout[E.OrgNamespace+"__Allow_Delete_Lines__c"],this.actionOnZeroLines=this._data.DetailLayout[E.OrgNamespace+"__Action_On_Zero_Lines__c"],this.objectName=this._data.DetailLayout[E.OrgNamespace+"__Object_Name__c"],this.layoutId=this._data.DetailLayout.Id,this.multiAddSearchField=this._data.DetailLayout[E.OrgNamespace+"__Multi_Add_Search_Field__c"],this.multiAddSearchObject=this._data.DetailLayout[E.OrgNamespace+"__Multi_Add_Search_Object__c"],this.enableRecentItems=this.getRoot().getDeliveryEngine().getSettings().getSetting("SET003","bool");var t,n=this._data.linkedProcesses,i=[],a=0;for(n&&(a=n.length),t=0;t<a;t++){var r=new R.SFMPageDetailLinkedProcess(n[t]);i.push(r)}this.linkedProcesses=E.sort(i,"sequence");var o,s=this._data.events,l=s.length,c=E.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance();for(o=0;o<l;o++)c.isEventSupported(s[o])&&(this.events[this.events.length]={callType:s[o][E.OrgNamespace+"__Event_Call_Type__c"],target:s[o][E.OrgNamespace+"__Target_Call__c"],eventType:s[o][E.OrgNamespace+"__Event_Type__c"],eventId:s[o].Id,eventRawData:s[o]});l=this._data.fields.length;var u=[];for(o=0;o<l;o++){var d=this._data.fields[o],_=d.fieldDetail[E.OrgNamespace+"__DataType__c"];d.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"]==O.RECORD_TYPE_ID?this.__recordTypeField=u[o]=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailRecordTypeField",d,this):u[o]="reference"==_?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailReferenceField",d,this):"picklist"==_?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailPicklistField",d,this):"multipicklist"==_?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailMultiPicklistField",d,this):"datetime"==_||"date"==_?E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailDatetimeField",d,this):E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailField",d,this),u[o].initialize()}null==this.__recordTypeField&&(this.__recordTypeField=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailRecordTypeField",null,this),this.__recordTypeField.initialize());var h,o,f,p,m=this.getAllDetailFields(),v=this._parent.getAllPicklists(this.objectName),g=[],l=v.length,y=m.length;for(o=0;o<l;o++){for(p=!1,f=0;f<y;f++)if(v[o].name==m[f].fieldDetail[E.OrgNamespace+"__Field_API_Name__c"]){p=!0;break}p||g.push(v[o])}var t,S=g.length;for(t=0;t<S;t++)h=this.createHiddenControllingPicklistField(g[t]),this.registerControllingPicklistField(h);this._children.fields=E.sort(u,"sequence")}},{key:"getAllFieldData",value:function(){return this._children.fields}},{key:"getAllDetailFields",value:function(){return this._data.fields}},{key:"getAllObjectFieldTypes",value:function(){var e={};return E.array.forEach(this.getRoot().getObjectInfo(this.objectName).fields,function(t){e[t.name]=t.type},this),e}},{key:"getFieldTypes",value:function(){for(var e=this.getAllDetailFields(),t={},n=0;n<e.length;n++){var i=e[n];t[i.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"]]=i.fieldDetail[E.OrgNamespace+"__DataType__c"]}return t}},{key:"getAllFieldTypes",value:function(){var e=this.getRoot().objMetadataMap[this.objectName],t=e?e.fields:[],n={};return E.array.forEach(t,function(e){n[e.name]=e.type},this),n}},{key:"registerControllingPicklistField",value:function(e){return this.__controllingPicklistFields.push(e)}},{key:"getControllingPicklistFieldDataFromName",value:function(e){return this._parent.getControllingPicklistFieldDataFromName(this.objectName,e)}},{key:"createHiddenControllingPicklistField",value:function(e){var t=e.name,e=(this.getRoot(),E.create("com.servicemax.client.sfmdelivery.engine.SFMPageDetailHiddenPicklistField",e,this));return e.initialize(t),e}},{key:"afterSort",value:function(e){this.sequence=this._data.DetailLayout[E.OrgNamespace+"__Sequence__c"]=e}},{key:"getEventInfoFor",value:function(e){var t=void 0,n=this.events.length,i=null;for(t=0;t<n;t++)if(this.events[t].eventType==e){i=this.events[t];break}return i}},{key:"getRecordTypeField",value:function(){return this.__recordTypeField}},{key:"getControllingPicklistFields",value:function(){return this.__controllingPicklistFields}},{key:"getCurrentRecordTypeInfo",value:function(e){return this._parent.getCurrentRecordTypeInfo(e,this.objectName)}},{key:"getObjectName",value:function(){return this.objectName}},{key:"getPrecision",value:function(e){return this._parent.getPrecision(this.objectName,e)}},{key:"getScale",value:function(e){return this._parent.getScale(this.objectName,e)}},{key:"getFieldLabel",value:function(e){return this._parent.getFieldLabel(this.objectName,e)}},{key:"isFieldAccessible",value:function(e){return this._parent.isFieldAccessible(this.objectName,e)}},{key:"isFieldRequired",value:function(e){return this._parent.isFieldRequired(this.objectName,e)}},{key:"isFieldReadOnly",value:function(e){return this._parent.isFieldReadOnly(this.objectName,e)}},{key:"getPicklistValues",value:function(e){return this._parent.getPicklistValues(this.objectName,e)}},{key:"getControllingPicklist",value:function(e){return this._parent.getControllingPicklist(this.objectName,e)}},{key:"getFieldMetaInfoFromName",value:function(e){return this._parent.getFieldMetaInfoFromName(this.objectName,e)}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding=this.getRoot().getDataModel().createDetailBinding(this._parent.getPath()+"."+this.layoutId,e,t,n),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding}},{key:"resolveDependencies",value:function(){var e=this._children.fields,t=void 0,n=e.length;for(t=0;t<n;t++)e[t].resolveDependencies()}},{key:"getFieldInfo",value:function(e){var t=this._children.fields,n=null,i=void 0,a=t.length;for(i=0;i<a;i++)if(t[i].fieldName==e){n=t[i];break}return n}},{key:"getControllingFieldInfo",value:function(e){var t=this.getFieldInfo(e);if(!t){var n=void 0,i=this.__controllingPicklistFields.length;for(n=0;n<i;n++)if(e==this.__controllingPicklistFields[n].fieldName){t=this.__controllingPicklistFields[n];break}}return t}},{key:"getFieldInfoFromName",value:function(e){return this.getFieldInfo(e)}},{key:"getLookupContextFieldInfo",value:function(e,t){var n=null;return"CURRENT_RECORD"==t?n=this.getFieldInfo(e):"PARENT_RECORD"==t?n=this._parent.getParent().getHeaderMetaModel().getLookupContextFieldInfo(e):(n=this.getFieldInfo(e),E.getLoggingService().getLogger("SFMPageDetail").warn("Unknown context source type, defaulting to current record! =>"+t)),n}},{key:"getBindingHash",value:function(){return this.__allColumnDataBindingsHash}},{key:"__addBinding",value:function(e,t){this.__allColumnDataBindings[this.__allColumnDataBindings.length]=t,this.__allColumnDataBindingsHash[e]=t}},{key:"createColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createHiddenColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelHiddenFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createPicklistColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailPicklistFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createMultiPicklistColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailMultiPicklistFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createRecordTypeColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailRecordTypeFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createHiddenPicklistColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailHiddenPicklistFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createReferenceColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailReferenceFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"createDatetimeColumnBinding",value:function(e){var t=E.create("com.servicemax.client.sfmdelivery.engine.SFMPageModelDetailDatetimeFieldBinding",this,e);return this.__addBinding(e,t),t}},{key:"resetRowBindingContext",value:function(){this.__currentRowContext=null;var e=void 0,t=this.__allColumnDataBindings,n=t.length;for(e=0;e<n;e++)t[e].setContextInternal(null)}},{key:"setRowBindingContext",value:function(e){this.__currentRowContext=e;var t=void 0,n=this.__allColumnDataBindings,i=n.length;for(t=0;t<i;t++)n[t].setContextInternal(e)}},{key:"setExtendedEditRowBindingContext",value:function(e){this.__extendedEditData=E.cloneObject(e.raw||e.data),this.setRowBindingContext(e)}},{key:"executeBindings",value:function(){var e=void 0,t=this.__allColumnDataBindings,n=t.length;for(e=0;e<n;e++)t[e].executeBinding()}},{key:"persistBindings",value:function(){if(!this.isDisplayOnly){this.getRecordTypeField().getDataBinding().persistBinding();var e=void 0,t=this.__allColumnDataBindings,n=t.length;for(e=0;e<n;e++)t[e].persistBinding()}}},{key:"extendedEditPersistBindings",value:function(){var e=this.__extendedEditData,t=this.__currentRowContext,n=E.array.map(this.getAllDetailFields(),function(e){return e.fieldDetail[E.OrgNamespace+"__Field_API_Name__c"]}),i=this.getAllObjectFieldTypes();E.forEachProperty(e,function(a,o){if(-1==E.array.indexOf(n,a)&&i[a])if(e[a+"__key"])t.data[a+"__key"]=e[a+"__key"],t.set(a,o),t.data[a]=o,t.raw&&(t.raw[a+"__key"]=e[a+"__key"],t.raw[a]=o);else{if("reference"===i[a]){var s=void 0;s={key:"",value:""},"object"===(void 0===o?"undefined":(0,r.default)(o))?(s.key=o.key,null===o.value?s.value=o.key:s.value=o.value):(s.key=o,s.value=o),t.data[a+"__key"]=s,t.raw&&(t.raw[a+"__key"]=s)}t.set(a,o),t.data[a]=o,t.raw&&(t.raw[a]=o)}}),this.persistBindings()}},{key:"validateFields",value:function(){var e=[];return E.array.forEach(this.__allColumnDataBindings,function(t){if(t.__validator){var n=t.__validator.handler.call(t.__validator.context);n.isValid||e.push(n)}}),e}},{key:"translate",value:function(e,t,n){var i=this.getFieldInfoFromName(e),a=t,r=void 0,o=void 0,s=void 0,l=void 0,c=E.getClient().getApplicationParameter("svmx-sfm-disable-translate-dates");if(i&&i.fieldName==O.RECORD_TYPE_ID){var u=this.getCurrentRecordTypeInfo(t);u&&(a=u.name,n.value=a)}else if(i&&"picklist"==i.datatype){for(r=this.getPicklistValues(i.getFieldData()),l=r.length,o=0;o<l;o++)if(r[o].value==t){a=r[o].label;break}}else if(i&&"multipicklist"==i.datatype&&t){t=t.split(";"),a="",r=this.getPicklistValues(i.getFieldData()),l=r.length;var d=t.length,_=[];for(s=0;s<d;s++)for(o=0;o<l;o++)r[o].value==t[s]&&_.push(r[o].value);a=_.join(";")}else i&&"date"==i.datatype&&t&&!c?(n.key=t,n.value=t):i&&"datetime"==i.datatype&&t&&!c?(n.key=t,n.value=t):i&&("textarea"==i.datatype||"string"==i.datatype)&&t&&a&&("string"!=typeof a&&(a=""+a),a=a.split("<").join("&lt;"),a=a.split(">").join("&gt;"),a=a.split('"').join("&quot;"));return a}},{key:"executeFieldMappings",value:function(e,t){for(var n=this.getBindingHash(),i=this._parent;!i.executeFieldMappings;)i=i._parent;if(i.executeFieldMappings){var a=this.getAllObjectFieldTypes();i.executeFieldMappings(e,t,n,this.__extendedEditData,a)}}},{key:"executeGridFieldMappings",value:function(e,t,n){if(n){var i=this.getAllFieldTypes(),a=this.getRoot().__fieldMappings,o=n.data,s=(this.getRoot().getUserInfo().DateFormat,this.getRoot().getUserInfo().TimeFormat);T.isFormat24HourTime(s);a.forEachField(e.fieldMappingId,function(a,s){var l=i[a],c=void 0;if(s.value){switch(c=s.value){case"Tomorrow":case"Yesterday":case"Today":c=T.macroDrivenDatetime(c,"YYYY-MM-DD","HH:mm:ss"),"datetime"==l&&(c=T.convertToTimezone(c,null,!0));break;case"Now":c=T.macroDrivenDatetime(c,"YYYY-MM-DD","HH:mm:ss")}o[a+"__key"]={key:c,value:c}}else"reference"===l&&s.field+"__key"in t?(key=t[s.field+"__key"],value=t[s.field],!key&&s.field2&&(key=t[s.field2+"__key"],value=t[s.field2]),!key&&s.field3&&(key=t[s.field3+"__key"],value=t[s.field3]),key&&"object"===("undefined"==typeof key?"undefined":(0,r.default)(key))?(o[a+"__key"]={key:key.key,value:key.value},c=o[a+"__key"].value):key&&value?(o[a+"__key"]={key:key,value:value},c=o[a+"__key"].value):c=key):"reference"===l&&"Id"===s.field?(key=t[s.field],value=e.nameFieldName?t[e.nameFieldName]:t.Name,key&&value?(o[a+"__key"]={key:key,value:value},c=o[a+"__key"].value):c=key):(c=t[s.field+"__m"],c||(c=t[s.field]),!c&&s.field2&&(c=t[s.field2]),!c&&s.field3&&(c=t[s.field3]),void 0===c&&(c=null),o[a+"__key"]={key:c,value:c});void 0===c&&(c=null),n.set(a,c)})}}},{key:"getRelatedBindingValue",value:function(e,t,n){var i=void 0;if("CURRENTRECORD"==t&&this.getFieldInfo(e)){var a=this.getFieldInfo(e).getRoot().getUserInfo();return i="datetime"==this.getFieldInfo(e).datatype?{valueHash:n,isDateTime:!0,userInfo:a,isDateOnly:!1}:"date"==this.getFieldInfo(e).datatype?{valueHash:n,isDateOnly:!0,userInfo:a}:{valueHash:n,isDateTime:!1,isDateOnly:!1},this._parent.getRelatedBindingValue(e,t,i)}return this._parent.getRelatedBindingValue(e,t)}},{key:"cloneDetailLine",value:function(e){var t=this.getRoot().getDeliveryEngine(),n=t.processId;this.__logger.info("Performing cloneDetailLine()"),t.blockApplication();var i=t.getEventBus(),a=void 0;a=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ADD_RECORDS",this,{request:{processId:n,alias:this.layoutId,data:t.getTargetData().getData(),isCloned:!0,objectName:this.objectName},responder:E.create("com.servicemax.client.sfmdelivery.responders.AddRecordsResponder",this,[],e)}),i.triggerEvent(a)}},{key:"addNew",value:function(e){var t=this.getRoot().getDeliveryEngine(),n=t.processId;this.__logger.info("Performing addNew()"),t.blockApplication();var i=t.getEventBus(),a=void 0;a=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ADD_RECORDS",this,{request:{processId:n,alias:this.layoutId,data:t.getTargetData().getData(),objectName:this.objectName},responder:E.create("com.servicemax.client.sfmdelivery.responders.AddRecordsResponder",this,[],e)}),i.triggerEvent(a)}},{key:"addMultipleNew",value:function(e,t,n){var i=this.getRoot().getDeliveryEngine(),a=i.processId;this.__logger.info("Performing multiAdd()"),i.blockApplication();var r=[],o=void 0,s=t.length,l=[];for(o=0;o<s;o++)r.push(t[o].key),l.push(t[o].value);var c=i.getEventBus(),u=void 0;u=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ADD_RECORDS",this,{request:{processId:a,alias:this.layoutId,multiAddFieldApiName:this.multiAddSearchField,multiAddFieldRecordIds:r,multiAddFieldRecordValues:l,data:i.getTargetData().getData(),objectName:this.objectName},responder:E.create("com.servicemax.client.sfmdelivery.responders.AddRecordsResponder",this,n,e)}),c.triggerEvent(u)}},{key:"onAddRecordsComplete",value:function(e,t,n){var i=this.getRoot().getDeliveryEngine(),a=i.getEventBus();if(t&&t.length){for(var r=this;!r.executeFieldMappings;)r=r._parent;var o=this.getFieldInfo(this.multiAddSearchField),s=n.getStore(),l=s.getCount();if(!0===E.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr"))for(var c=0;c<t.length;c++){var u=s.getAt(l-t.length+c);r.executeGridFieldMappings(o,t[c],u)}else{for(var d=E.getClient().getApplicationParameter("sfm-delivery-max-childlines-per-page"),_=!1,h=0;h<t.length;h++){var f=Math.ceil((h+1)/d);s.currentPage!=f&&(s.loadPage(f),_=!0);var p=h%d,m=s.getAt(p);r.executeGridFieldMappings(o,t[h],m)}_&&s.loadPage(1)}}var v=this.getEventInfoFor("After Add Record");this.__sfmdetail=n,this.__dataLength=e.length,this.__addedData=e,E.getClient().getApplicationParameter("svmx-sfm-disable-events")&&(v=null),v?this.invokeAfterAddRecordsEvents(v,i,a):(i.unblockApplication(),n.onAddRecordsComplete(e.length,e))}},{key:"invokeAfterAddRecordsEvents",value:function(e,t,n){var i=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:[e],data:t.getTargetData().getData(),metadata:t.getPageMetaData().getRawPageMetaData(),deliveryEngine:t,additionalInfo:{processId:t.processId,nextStepId:this.getRoot().getDeliveryEngine().nextStepId},invokedFrom:"After Add"},responder:E.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)});n.triggerEvent(i)}},{key:"copyDetailRecord",value:function(e,t,n){var i=this.getRoot().getDeliveryEngine(),a=i&&i.getTargetData().getData(),r=i&&i.processId,o=t&&t.getData(),s=o.attributes&&o.attributes.type,l=i.getEventBus(),c=void 0;c=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.COPY_RECORDS",this,{request:{alias:e,data:a,objectName:s,processId:r,sourceRecord:o},responder:E.create("com.servicemax.client.sfmdelivery.responders.CopyRecordsResponder",this,n)}),l.triggerEvent(c)}},{key:"onCopyRecordsCompleted",value:function(e,t){var n=this.getRoot().getDeliveryEngine(),i=n.getEventBus(),a=this.getEventInfoFor("After Add Record");this.__sfmdetail=t,this.__dataLength=e.length,this.__addedData=e,E.getClient().getApplicationParameter("svmx-sfm-disable-events")&&(a=null),a?this.invokeAfterAddRecordsEvents(a,n,i):(t.onCopyRecordsComplete(e.length,e),n.unblockApplication())}},{key:"onInvokeEventsComplete",value:function(){this.getRoot().getDeliveryEngine().unblockApplication(),this.__sfmdetail.onAddRecordsComplete(this.__dataLength,this.__addedData),this.__sfmdetail=null,this.__dataLength=null,this.__addedData=null}},{key:"onInvokeCustomEventsComplete",value:function(e){var t="",n={};"success"!=e.status?(this.__logger.error("Validation_Error for custom snippet : ",e.error_message),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",n.error_msg=e.error_message):(console.log("Response from snippet: No errors found"),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETSUCCESS");var i=E.getCurrentApplication().getCurrentView().getDeliveryEngine().getEventBus(),a=E.create("com.servicemax.client.lib.api.Event",t,this,{request:n,responder:{}});i.triggerEvent(a)}}]),t}(D),R.SFMPageDetailLinkedProcess=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.title=e.title,n.processId=e.processId,n.sequence=e.sequence,n}return(0,y.default)(t,e),t}(A),R.SFMPageDetailField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.createDetailBinding(this.fieldName)}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding.setter=e,this.__dataBinding.getter=t,this.__dataBinding.bindingContext=n,this.__dataBinding}},{key:"createDetailBinding",value:function(e){return this.__dataBinding||(this.__dataBinding=this._parent.createColumnBinding(e)),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding}}]),t}(R.SFMPageField),R.SFMPageDetailPicklistField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.createDetailBinding(this.fieldName)}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding.setter=e,this.__dataBinding.getter=t,this.__dataBinding.bindingContext=n,this.__dataBinding}},{key:"createDetailBinding",value:function(e){return this.__dataBinding||(this.__dataBinding=this._parent.createPicklistColumnBinding(e),this.__dataBinding.field=this),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding}},{key:"_parentValueChanged",value:function(e){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"_parentValueChanged",this).call(this,e);var n=null;if(this.getDataBinding().getter?(n=this.getDataBinding().getLocalValue())&&(n=n.value):n=this.getDataBinding().getValue(),e.data.persistInDataModel){var i=this.getPicklistValues({value:e.data.value}),n=i[0].value;this.datatype&&"multipicklist"===this.datatype&&(n=""),this.getDataBinding().persistBinding({key:n,value:n})}var e=E.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:n,persistInDataModel:e.data.persistInDataModel,passOnInformation:e.data.passOnInformation});this.triggerEvent(e)}},{key:"_getCurrentRecordTypeInfo",value:function(e){var t=null;if(e&&e.passOnInformation&&e.passOnInformation.recordType)t=this._parent.getCurrentRecordTypeInfo(e.passOnInformation.recordType);else if(this.__dataBinding){var n=this.__dataBinding.getContext();if(n){var i=n.data[O.RECORD_TYPE_ID+"__key"]||n.data[O.RECORD_TYPE_ID];if(i){var a=null;a="string"==typeof i?i:i.key,t=this._parent.getCurrentRecordTypeInfo(a)}}}return t}},{key:"triggerEvent",value:function(e){if(!e.data.passOnInformation){var n=this.getRecordTypeField().getDataBinding();if(n&&n.setter){var n=this.getRecordTypeField().getDataBinding();if(n){var i=n.getLocalValue();void 0!==i&&(e.data.passOnInformation={recordType:i.key})}}}(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(R.SFMPagePicklistField),R.SFMPageDetailMultiPicklistField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"createDetailBinding",value:function(e){return this.__dataBinding||(this.__dataBinding=this._parent.createMultiPicklistColumnBinding(e),this.__dataBinding.field=this),this.__dataBinding}},{key:"getPicklistEntryLabelFor",value:function(e){var t=this.getPicklistValues({},!0),n=void 0,i=void 0,a=t.length,r="";if(void 0!==e&&null!==e){var o=e.split(";"),s=o.length;for(n=0;n<a;n++)for(i=0;i<s;i++)t[n].value==o[i]&&(r=t[n].label+";"+r);";"==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1))}return r}}]),t}(R.SFMPageDetailPicklistField),R.SFMPageDetailRecordTypeField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),null!=this._data&&this.createDetailBinding(this.fieldName)}},{key:"_initializeHiddenMode",value:function(){this.__dataBinding=this._parent.createHiddenColumnBinding(this.fieldName)}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding.setter=e,this.__dataBinding.getter=t,this.__dataBinding.bindingContext=n,this.__dataBinding}},{key:"createDetailBinding",value:function(e){return this.__dataBinding||(this.__dataBinding=this._parent.createRecordTypeColumnBinding(e),this.__dataBinding.field=this),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding}},{key:"triggerRecordTypeChanged",value:function(e){var t=e.data.value;t===O.NO_VALUE&&(t=null),e.data.passOnInformation={recordType:t},this.triggerEvent(e)}},{key:"_getCurrentRecordTypeInfo",value:function(e){return null}}]),t}(R.SFMPageRecordTypeField),R.SFMPageDetailHiddenPicklistField=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.fieldName=this._data.name,this.__dataBinding=this._parent.createHiddenPicklistColumnBinding(this.fieldName);var e=null,t=this;this.__dataBinding.setter=function(n){e="boolean"==typeof n?n.toString():n;var i=E.create("com.servicemax.client.lib.api.Event","CHANGED",t,{value:e});t.triggerHiddenPicklistChanged(i)},this.__dataBinding.getter=function(){var n=e;return"boolean"!=t._data.dataType||void 0!==e&&null!==e&&""!==e||(n=!!e),n}}}]),t}(R.SFMPageHiddenPicklistField),R.SFMPageDetailReferenceField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.contextSource=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.contextSource=this._data.fieldDetail[E.OrgNamespace+"__Context_Source_Object__c"],this.createDetailBinding(this.fieldName)}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding.setter=e,this.__dataBinding.getter=t,this.__dataBinding.bindingContext=n,this.__dataBinding}},{key:"createDetailBinding",value:function(e){return this.__dataBinding||(this.__dataBinding=this._parent.createReferenceColumnBinding(e)),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding}},{key:"resolveDependencies",value:function(){this.lookupContext&&(this.lookupContextFieldInfo=this._parent.getLookupContextFieldInfo(this.lookupContext,this.contextSource))}}]),t}(R.SFMPageReferenceField),R.SFMPageDetailDatetimeField=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.contextSource=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.createDetailBinding(this.fieldName)}},{key:"createBinding",value:function(e,t,n){return this.__dataBinding.setter=e,this.__dataBinding.getter=t,this.__dataBinding.bindingContext=n,this.__dataBinding}},{key:"createDetailBinding",value:function(e){return this.__dataBinding||(this.__dataBinding=this._parent.createDatetimeColumnBinding(e)),this.__dataBinding}},{key:"getDataBinding",value:function(){return this.__dataBinding}}]),t}(R.SFMPageField),R.SFMPageModelDetailFieldBinding=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return i._path=n,i._parent=e,i._context=null,i.setter=null,i.getter=null,i.bindingContext=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getValue",value:function(){return null!=this.bindingContext&&null!=this.getter?this.getter.call(this.bindingContext):this.getValueFromContext()}},{key:"getValueFromContext",value:function(){var e=null;if(this._context&&(e=this._context.data[this._path],this._context.data[this._path+"__key"]&&(e=this._context.data[this._path+"__key"]),e&&"object"===(void 0===e?"undefined":(0,r.default)(e))))if(e.hasOwnProperty("value")&&e.hasOwnProperty("key"))e=e.value;else{for(var t in e){var n=function e(t){var n=null;if(t&&"object"===(void 0===t?"undefined":(0,r.default)(t)))if(t.hasOwnProperty("value")&&t.hasOwnProperty("key"))n=t.value;else for(var i in t)if(n=e(t[i]))break;return n}(e[t]);if(n){e=n;break}}}return e}},{key:"setValue",value:function(e,t){this.setter&&this.setter.call(this.bindingContext,e,t)}},{key:"setValidator",value:function(e){this.__validator=e}},{key:"setBizRuleValidator",value:function(){}},{key:"setResolver",value:function(e){}},{key:"setContext",value:function(e){this._parent.setRowBindingContext(e)}},{key:"resetContext",value:function(){this._parent.resetRowBindingContext()}},{key:"setContextInternal",value:function(e){this._context=e,e||(this.setter=null,this.getter=null,this.bindingContext=null)}},{key:"executeBinding",value:function(){var e=this.getValueFromContext();this.setter&&this.setter.call(this.bindingContext,e)}},{key:"getLocalValue",value:function(){return null!=this.bindingContext&&null!=this.getter?this.getter.call(this.bindingContext):this.getValueFromContext()}},{key:"persistBinding",value:function(){if(this.getter){var e=this.getter.call(this.bindingContext);if("object"===(void 0===e?"undefined":(0,r.default)(e))&&null!=e&&void 0!=e)this._context.data[this._path+"__key"]=e,this._context.set(this._path,e.value);else{var t=this.bindingContext.getCompositionMetamodel?this.bindingContext.getCompositionMetamodel():this.bindingContext.compositionMetamodel,n=x.prepareDataForDisplay(e,t.datatype);this._context.data[this._path+"__key"]={key:e,value:e},this._context.set(this._path,n)}}}},{key:"getContext",value:function(){return this._context}},{key:"getRelatedBindingValue",value:function(e,t){var n=null,i=null,a=null;if(this.getContext()&&(n=E.cloneObject(this.getContext().data),"CURRENTRECORD"==t)){var o=this._parent.__allColumnDataBindingsHash[e];o&&o.getter&&(n[e+"__key"]=o.getter.call(o.bindingContext),n[e]=n[e]&&"object"===(0,r.default)(n[e])?n[e].key:n[e])}var s=this._parent.getRelatedBindingValue(e,t,n);if(this.getContext()){var l=void 0!==this.getContext().raw?this.getContext().raw:this.getContext().getData();if(l){var c=l[e+"__key"];a=c&&"object"===(void 0===c?"undefined":(0,r.default)(c))?c.key:l[e]}}return i=s,!s&&a&&(i=a),i}}]),t}(A),R.SFMPageModelHiddenFieldBinding=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.setValidator({context:i,handler:function(){return{isValid:!0}}}),i.getValue={},i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"persistBinding",value:function(){}},{key:"executeBinding",value:function(){}},{key:"setValue",value:function(e){}},{key:"getLocalValue",value:function(){}}]),t}(R.SFMPageModelDetailFieldBinding),R.SFMPageModelDetailPicklistFieldBinding=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.field=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getValue",value:function(){return(0,v.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"getValue",this).call(this)}},{key:"executeBinding",value:function(){var e=this.getValueFromContext();this.setter&&(this.bindingContext&&(this.bindingContext.forceSelection=!1),this.setter.call(this.bindingContext,e),this.bindingContext&&(this.bindingContext.forceSelection=!0))}},{key:"persistBinding",value:function(e){if(void 0===e&&(e=this.getter.call(this.bindingContext)),void 0!==e&&void 0!==this.field&&null!=this.field){var t="";e&&e.value&&(t=this.field.getPicklistEntryLabelFor(e.value)||e.value),this._context.data[this._path+"__key"]=e,this._context.set(this._path,t)}}}]),t}(R.SFMPageModelDetailFieldBinding),R.SFMPageModelDetailMultiPicklistFieldBinding=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.field=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"persistBinding",value:function(e){if(void 0===e&&(e=this.getter.call(this.bindingContext)),void 0!==e&&void 0!==this.field&&null!=this.field){var t="";e&&e.value&&(t=e.value),this._context.data[this._path+"__key"]=e,this._context.set(this._path,t)}}}]),t}(R.SFMPageModelDetailPicklistFieldBinding),R.SFMPageModelDetailRecordTypeFieldBinding=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.field=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getValueFromContext",value:function(){var e=null;return this._context&&(e=this._context.data[this._path],this._context.data[this._path+"__key"]&&(e=this._context.data[this._path+"__key"]),e&&"object"===(void 0===e?"undefined":(0,r.default)(e))&&(e=e.key)),e}},{key:"persistBinding",value:function(e){void 0===e&&(e=this.getter.call(this.bindingContext)),e&&(this._context.data[this._path+"__key"]=e,this._context.set(this._path,e.value))}}]),t}(R.SFMPageModelDetailPicklistFieldBinding),R.SFMPageModelDetailHiddenPicklistFieldBinding=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.setValidator({context:i,handler:function(){return{isValid:!0}}}),i.field=null,i}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getValueFromContext",value:function(){var e=null;return this._context&&this._context.data&&void 0!==this._context.data[this._path]?e=this._context.data[this._path]:this._context&&this._context.raw&&void 0!==this._context.raw[this._path]&&(e=this._context.raw[this._path]),e}},{key:"setContextInternal",value:function(e){this._context=e,e||(this.bindingContext=null)}}]),t}(R.SFMPageModelDetailPicklistFieldBinding),R.SFMPageModelDetailReferenceFieldBinding=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"getValueFromContext",value:function(){return this._context?E.cloneObject(this._context.data[this._path+"__key"]):null}},{key:"executeBinding",value:function(){var e=this.getValueFromContext();this.setter&&this.setter.call(this.bindingContext,e)}},{key:"persistBinding",value:function(){if(this.getter){var e=this.getter.call(this.bindingContext);this._context.data[this._path+"__key"]=e;var t=e.value;t||"object"===(void 0===e?"undefined":(0,r.default)(e))||(t=e||""),this._context.set(this._path,t)}}}]),t}(R.SFMPageModelDetailFieldBinding),R.SFMPageModelDetailDatetimeFieldBinding=function(e){function t(e,n){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n))}return(0,y.default)(t,e),(0,h.default)(t,[{key:"persistBinding",value:function(){var e=this.getter.call(this.bindingContext);this._context.data[this._path+"__key"]={key:e,value:e},this._context.set(this._path,e)}}]),t}(R.SFMPageModelDetailFieldBinding),E.defineGlobal(R.name,R),e.exports=R},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m={name:"com.servicemax.client.sfmdelivery.ui.largemodern.utils"};m.Utils=function(e){function t(e){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,null,[{key:"getEncodedFileName",value:function(e){var t=e;try{t=decodeURIComponent(t)}catch(e){}if(t&&t.length>0){var n=t.split("/");if(n&&n.length>1){var i=n[n.length-1];i=encodeURIComponent(i),n[n.length-1]=i,t=n.join("/")}}return t}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a,r=n(50),o=i(r),s=n(1),l=i(s),c=n(2),u=i(c),d=n(6),_=i(d),h=n(3),f=i(h),p=n(4),m=i(p),v=n(0).utils,g=n(5).SVMXObject,y={name:"com.servicemax.client.sfmopdocdelivery.utils"};y.SFMOPDOCUtils=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),(0,_.default)(t,null,[{key:"localeFormat",value:function(e,t,n){var i=".",a=",";if(void 0!==this.localeInfo[e]&&null!==this.localeInfo[e]&&this.localeInfo[e]){var r=this.localeInfo[e];i=r.DS,a=r.TS}return this.__formatNumber(t,i,a,n)}},{key:"__formatNumber",value:function(e,t,n,i){var a=void 0;a=isNaN(i)?e.toString():e.toFixed(i);var r=a.split(".");return r[0].replace(/\B(?=(\d{3})+(?!\d))/g,n)+(r[1]?t+r[1]:"")}},{key:"htmlEncoding",value:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}},{key:"getEncodedFileName",value:function(e){var t=e;try{t=decodeURIComponent(t)}catch(e){}if(t&&t.length>0){var n=t.split("/");if(n&&n.length>1){var i=n[n.length-1];i=encodeURIComponent(i),n[n.length-1]=i,t=n.join("/")}}return t}}]),t}(g),y.SFMOPDOCUtils.localeInfo=(a={en_US:{DS:".",TS:","},en_GB:{DS:".",TS:","},en_AU:{DS:".",TS:","},en_NZ:{DS:".",TS:","},fr:{DS:",",TS:" "},fr_BE:{DS:",",TS:"."},fr_CA:{DS:",",TS:" "},fr_CH:{DS:".",TS:"'"},fr_FR:{DS:",",TS:" "},fr_LU:{DS:",",TS:" "},fr_MC:{DS:",",TS:" "},pt_BR:{DS:",",TS:"."},pt_AO:{DS:",",TS:"."},pt_PT:{DS:",",TS:"."},pt:{DS:",",TS:"."},es:{DS:",",TS:"."},es_AR:{DS:",",TS:"."},es_BO:{DS:",",TS:"."},es_CL:{DS:",",TS:"."},es_CO:{DS:",",TS:"."},es_CR:{DS:".",TS:","},es_DO:{DS:".",TS:","},es_EC:{DS:",",TS:"."},es_ES:{DS:",",TS:"."},es_GT:{DS:".",TS:","},es_HN:{DS:".",TS:","},es_MX:{DS:".",TS:","},es_PA:{DS:".",TS:","},es_PE:{DS:",",TS:"."},es_PR:{DS:".",TS:","},es_PY:{DS:",",TS:"."},es_SVUS:{DS:".",TS:","},es_UY:{DS:",",TS:"."},es_VE:{DS:",",TS:"."},de:{DS:",",TS:"."},de_AT:{DS:",",TS:"."},de_CH:{DS:".",TS:"'"},de_DE:{DS:",",TS:"."},de_LU:{DS:",",TS:"."},ja:{DS:".",TS:","},ja_JP:{DS:".",TS:","},zh:{DS:".",TS:","},zh_CN:{DS:".",TS:","},zh_SG:{DS:".",TS:","},zh_TW:{DS:".",TS:","},zh_HK:{DS:".",TS:","}},(0,o.default)(a,"zh_CN",{DS:".",TS:","}),(0,o.default)(a,"zh_MO",{DS:".",TS:","}),(0,o.default)(a,"ko",{DS:".",TS:","}),(0,o.default)(a,"ko_KR",{DS:".",TS:","}),(0,o.default)(a,"it",{DS:",",TS:"."}),(0,o.default)(a,"it_CH",{DS:".",TS:"'"}),(0,o.default)(a,"it_IT",{DS:",",TS:"."}),(0,o.default)(a,"nl",{DS:",",TS:"."}),(0,o.default)(a,"nl_BE",{DS:",",TS:"."}),(0,o.default)(a,"nl_NL",{DS:",",TS:"."}),(0,o.default)(a,"nl_SR",{DS:",",TS:"."}),a),v.defineGlobal(y.name,y),e.exports=y},function(e,t){var n={},i=void 0,a=void 0;n.init=function(e,t){function n(e){console.warn("FIRST FAIL"),setTimeout(function(){i=window.sqlitePlugin.openDatabase(s,r,o)},0)}function a(){console.warn("onDatabaseSuccess"),e&&e.call()}function r(){console.warn("onDatabaseSuccess2"),e&&e.call()}function o(e){console.warn("LAST FAIL"),t&&t.call(null,e)}try{var s={name:"svmx",key:"",bgType:0,location:2};i=window.sqlitePlugin.openDatabase(s,a,n)}catch(e){console.error("Database Init error: "+e)}},n.destroy=function(){},n.query=function(e){function t(t,n){if(u.length>0){return void r(t,u.shift())}var i=n;e.onSuccess.call(s,i)}function n(e){r(e,l)}function r(e,n){if(0==n.toUpperCase().indexOf("DROP TABLE")){var i=n.indexOf(";");i>0&&n.length>i+1&&(c=n.substring(i+1,n.length),n=n.substring(0,i+1),u.push(c))}e.executeSql(n,[],t,o)}function o(t,n){if(n=n||{message:"unknown DB error.",code:0},"string"==typeof n&&(n={message:n,code:0}),n.query=l,e.onError)if(u.length>0&&!a){var i=u.shift();n.query=i,r(t,i)}else e.onError.call(s,n.message);else alert("DBAL Error ("+n.code+"): "+n.message);return a}var e=e||{},s=e.context||window,l=e.query||"",c=null,u=e.queryArray||[];a=e.doRollBack||!1,u.length>0&&(l=u.shift()),i.transaction(n,o)},e.exports=n},function(e,t,n){var i=n(31),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(901),o=n(193),s=n(0).utils,l=n(105),c={},u=18e4;c.setTimeout=function(e){u=6e4*e},c.setSalesforceRequest=function(e){if(!e||!e.instance_url||!e.session_id)return!1;var t=r.decycle(e);t&&t.context&&delete t.context;var n=JSON.parse((0,a.default)(t));n.onSuccess=e.onSuccess,n.onError=e.onError,n.context=e.context,n.uri||(n.uri="");var i=n.uri;0!=i.indexOf("http")&&(n.uri=n.instance_url+i),n.type=n.type||"POST",n.type=0!=i.indexOf("/services/data/")||e.allowPost?n.type:"GET",n.headers=n.headers||[],n.headers.push({Header:"Authorization",Value:"OAuth "+n.session_id}),!e.actionType||"download"!=e.actionType&&"upload"!=e.actionType?-1!=i.indexOf("/svmx/MobServiceIntf/DataSyncRequest")&&n.data&&-1!=n.data.indexOf('"eventName":"GENERATE_PDF"')?c.sendCordovaHTTPRequest(e):(n=n||{},n.responseErrorAsSuccess=!0,c.sendRequest(n)):c.sendCordovaHTTPRequest(e)},c.sendRequest=function(e){return c.sendCordovaHTTPRequest(e)},c.enableSSLPinningHTTPRequests=function(e){window.cordovaHTTP.enableSSLPinning(e.SSLSettingValue,e.onSuccess,e.onError)},c.sendRequestJS=function(e){if(!e)return!1;var t=null,n="";window.XMLHttpRequest&&(t=new XMLHttpRequest),e.context=e.context||window,e.type=e.type||"GET",e.data=e.data||"",e.uri=e.uri||"/","post"===e.type.toLowerCase()&&e.data&&(n=e.data),e.timeout=e.timeout||u,t.timeout=e.timeout,t.ontimeout=function(){e.onError&&e.onError.call(e.context,"Request Timeout",500)},t.open(e.type,e.uri,!0),t.overrideMimeType("text/plain; charset=utf-8");if(e.headers)for(var i=0;i<e.headers.length;i++)t.setRequestHeader(e.headers[i].Header,e.headers[i].Value);t.setRequestHeader("Cache-Control","no-cache"),t.setRequestHeader("Pragma","no-cache"),t.onreadystatechange=function(){if(4==t.readyState)if(e.responseErrorAsSuccess||t.status<400){if(e.onSuccess){for(var n=t.getAllResponseHeaders().split("\r\n"),i=[],a=null,r=0;r<n.length;r++)a=n[r].split(":"),i.push({Header:a[0],Value:a[1]});e.onSuccess.call(e.context,t.responseText,i,t.status)}}else e.onError&&e.onError.call(e.context,"Request Exception",t.status)};try{t.send(n)}catch(t){e.onError&&e.onError.call(e.context,"Request Exception",500)}},c.sendRequestNative=function(e){if(!e)return!1;var t={headers:[]};e.context=e.context||window,t.type=e.type||"GET",t.postData="post"===e.type.toLowerCase()&&e.data?e.data:"",t.targetURL=e.uri||"/",t.timeout=e.timeout||u;var n=!1;if(e.headers)for(var i=0;i<e.headers.length;i++)e.headers[i].Header&&e.headers[i].Value&&("content-type"===e.headers[i].Header.toLowerCase()&&(n=!0),t.headers.push({Header:e.headers[i].Header,Value:e.headers[i].Value}));n||t.headers.push({Header:"Content-Type",Value:"text/plain;charset=UTF-8"}),t.headers.push({Header:"Origin",Value:"http://localhost:8080"}),t.headers.push({Header:"Cache-Control",Value:"no-cache"}),t.headers.push({Header:"Pragma",Value:"no-cache"});var a=function(t){var n={status:-1,responseText:'[{"message":"Invalid JSON response.","errorCode":"INVALID_RESULTS"}]'};try{n=JSON.parse(t)}catch(e){}switch(!0){case n.status>199&&n.status<300:case n.status>=300&&n.status<400:if(e.onSuccess){var i=n.responseHeaders,a=[];for(var r in i)i.hasOwnProperty(r)&&a.push({Header:r,Value:i[r]});e.onSuccess.call(e.context,n.responseText,a,n.status)}break;default:e.onError&&e.onError.call(e.context,n.responseText,n.status)}},r=function(t){e.onError&&e.onError.call(e.context,'[{"message":"Request Exception.","errorCode":"UNKNOWN_EXCEPTION"}]',500)};"download"==e.actionType?(t.fileName=e.fileName?o.__convertBaseDirectory(e.fileName):null,l.executeDownload(t,a,r)):"upload"==e.actionType?(t.fileName=e.fileName,t.parentId=e.parentId,t.sourcePath=e.sourcePath?o.__convertBaseDirectory(e.sourcePath):null,l.executeUpload(t,a,r)):l.executeHttp(t,a,r)},c.sendCordovaHTTPRequest=function(e){var t=e.type||"POST";e.uri||(e.uri="");var n=e.uri;0!=n.indexOf("http")&&(e.uri=e.instance_url+n),t=0!=n.indexOf("/services/data/")||e.allowPost?e.type:"GET",t=t||"POST";var i=(e.context||window,"post"===t.toLowerCase()&&e.data?e.data:""),a=e.uri||"/",r=(e.timeout,!1),l={};if(e.headers&&e.headers.length>0)for(var c=0;c<e.headers.length;c++)(e.headers[c].Header||e.headers[c].Value)&&(l[e.headers[c].Header]=e.headers[c].Value,"content-type"===e.headers[c].Header.toLowerCase()&&(r=!0));r||(l["Content-Type"]="text/plain;charset=UTF-8"),e.session_id&&(l.Authorization="OAuth "+e.session_id),window.cordovaHTTP.setHeader("Origin","http://localhost:8080"),window.cordovaHTTP.setHeader("Cache-Control","no-cache"),window.cordovaHTTP.setHeader("Pragma","no-cache");var u=function(t){t&&(t.isFile||t.isDirectory)&&t.nativeURL&&(t.nativeURL=t.nativeURL.replace("file:///","file://"),t.status||(t.status=200));var n={status:-1,data:'[{"message":"Invalid JSON response.","errorCode":"INVALID_RESULTS"}]'};try{n=s.isObject(t)?t:JSON.parse(t)}catch(e){}switch(!0){case n.status>199&&n.status<300:case n.status>=300&&n.status<400:if(e.onSuccess){var i=n.headers,a=[];for(var r in i)i.hasOwnProperty(r)&&a.push({Header:r,Value:i[r]});e.onSuccess.call(e.context,n.data,a,n.status)}break;default:e.onError&&e.onError.call(e.context,n.data,n.status)}},d=function(t){var n=s.toJSON(t);e.onError&&e.onError.call(e.context,n,t.status||500)};if("download"==e.actionType){var _=e.fileName?o.__convertBaseDirectory(e.fileName):null;window.cordovaHTTP.downloadFile(a,{},l,_,u,d)}else if("upload"==e.actionType){var h=e.sourcePath?o.__convertBaseDirectory(e.sourcePath):null;i={name:e.fileName,parentId:e.parentId,objectName:e.objectName,compositeURL:e.compositeUri,contentVersionId:e.contentVersionId},window.cordovaHTTP.uploadFile(a,i,l,h,e.fileName,u,d)}else"get"==t.toLowerCase()?window.cordovaHTTP.get(a,{},l,u,d):"post"==t.toLowerCase()&&window.cordovaHTTP.post(a,i,l,u,d)},e.exports=c},function(e,t,n){var i=n(31),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=n(105),s={},l=void 0,c="com.servicemax.mobile.android.default";s.init=function(e,t){function n(t){l=t,e&&e.call()}function i(e){console.log("FileSystem init failure code: "+e.code),t&&t.call(null,e.code)}window.requestFileSystem(window.LocalFileSystem.PERSISTENT,0,n,i)},s._setPackage=function(e){c=e},s.readTextFile=function(e){function t(e){e.file(n,a)}function n(e){i(e)}function i(t){var n=new FileReader;n.onloadend=function(t){e.onSuccess&&e.onSuccess.call(r,{Result:t.target.result,Status:!0})},n.readAsText(t)}function a(t){e.onSuccess&&e.onSuccess.call(r,{Result:"File Not Found",Status:!1})}e=e||{},e.operationData=e.operationData||{};var r=e.context||window;if(e.operationData.FileName){var o=s.__convertBaseDirectory(e.operationData.FileName);l.root.getFile(o,null,t,a)}else a()},s.readFile=function(e){function t(e){e.file(n,a)}function n(e){i(e)}function i(t){var n=new FileReader;n.onloadend=function(t){if(e.onSuccess){var n=t.target.result.indexOf("base64,"),i=t.target.result;n>7&&(i=t.target.result.substring(n+7)),e.onSuccess.call(r,{Result:i,Status:!0})}},n.readAsDataURL(t)}function a(t){e.onSuccess&&e.onSuccess.call(r,{Result:"File Not Found",Status:!1})}e=e||{},e.operationData=e.operationData||{};var r=e.context||window;if(e.operationData.FileName){var o=s.__convertBaseDirectory(e.operationData.FileName);l.root.getFile(o,null,t,a)}else a()},s.writeTextFile=function(e){function t(e){e.createWriter(n,a)}function n(t){t.onwriteend=function(t){e.onSuccess&&e.onSuccess.call(r,{Result:"Successfully written to file",Status:!0})};var n=void 0;n=e.operationData.isBase64Encoded?atob(e.operationData.WriteContent):e.operationData.WriteContent;var a=void 0;if(!0===e.operationData.isSmartDoc)a=new Blob([n],{type:"text/plain"});else try{a=i(n)}catch(e){}t.write(a)}function i(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0,a=e.length;i<a;i++)n[i]=e.charCodeAt(i);return t}function a(t){e.onSuccess&&e.onSuccess.call(r,{Result:"FileIO Error Code: "+t.code,Status:!1})}e=e||{},e.operationData=e.operationData||{};var r=e.context||window;if(e.operationData.FileName){var o=s.__convertBaseDirectory(e.operationData.FileName);s._getFileEntry({FilePath:o,createFile:!0,context:r,onSuccess:t,onError:a})}else a({code:FileError.NOT_FOUND_ERR})},s.writeLine=function(e){function t(e){e.createWriter(n,i)}function n(t){t.onwriteend=function(t){e.onSuccess&&e.onSuccess.call(a,{Result:"Successfully appended to file",Status:!0})},t.seek(t.length),t.write(e.operationData.WriteContent)}function i(t){e.onSuccess&&e.onSuccess.call(a,{Result:"File Not Found: "+t.code,Status:!1})}e=e||{},e.operationData=e.operationData||{};var a=e.context||window;if(e.operationData.FileName){var r=s.__convertBaseDirectory(e.operationData.FileName);s._getFileEntry({FilePath:r,createFile:!0,context:a,onSuccess:t,onError:i})}else i({code:FileError.NOT_FOUND_ERR})},s.copyFile=function(e){function t(e){o=e,s._getDirectoryEntry({FilePath:u,createFile:!0,context:r,onSuccess:n,onError:a})}function n(t){var n=o.name;e.operationData.TargetFileName&&e.operationData.TargetFileName.length>0&&(n=e.operationData.TargetFileName),o.copyTo(t,n,i,a)}function i(t){e.onSuccess&&e.onSuccess.call(r,{Result:"File copied successfully",Status:!0})}function a(t){e.onSuccess&&e.onSuccess.call(r,{Result:"File Not Found",Status:!1})}e=e||{operationData:{}},e.operationData=e.operationData||{};var r=e.context||window,o=void 0;if(e.operationData.FilePath){var c=s.__convertBaseDirectory(e.operationData.FilePath);c.indexOf("cache/")>-1?c=c.replace("files/",""):e.operationData.FilePath.indexOf("Camera")>0&&(c=e.operationData.FilePath.replace(l.root.nativeURL,""));var u=e.operationData.DestinationPath&&e.operationData.DestinationPath.length>0?s.__convertBaseDirectory(e.operationData.DestinationPath):s.__convertBaseDirectory("{UploadDirectory}/");l.root.getFile(c,{create:!1,exclusive:!1},t,a)}else a({code:FileError.NOT_FOUND_ERR})},s.deleteFile=function(e){function t(e){e.remove(n,i)}function n(t){e.onSuccess&&e.onSuccess.call(a,{Result:"File deleted successfully",Status:!0})}function i(t){e.onSuccess&&e.onSuccess.call(a,{Result:"File Not Found",Status:!1})}e=e||{},e.operationData=e.operationData||{};var a=e.context||window;if(e.operationData.FilePath){var r=s.__convertBaseDirectory(e.operationData.FilePath);l.root.getFile(r,null,t,i)}else i({code:FileError.NOT_FOUND_ERR})},s.renameFile=function(e){function t(e){o=e;var t=s.__convertBaseDirectory("{DownloadDirectory}");s._getDirectoryEntry({FilePath:t,createFile:!0,context:r,onSuccess:n,onError:a})}function n(t){var n=void 0;e.operationData.TargetFileName&&e.operationData.TargetFileName.length>0&&null!=o?(n=e.operationData.TargetFileName,o.moveTo(t,n,i,a)):a({code:FileError.NOT_FOUND_ERR})}function i(t){e.onSuccess&&e.onSuccess.call(r,{Result:"File renamed successfully",Status:!0})}function a(t){e.onError&&e.onError.call(r,{Result:"Source File Not Found",Status:!1})}e=e||{},e.operationData=e.operationData||{};var r=e.context||window,o=null;if(e.operationData.FilePath&&e.operationData.TargetFileName){var c=s.__convertBaseDirectory(e.operationData.FilePath);null!=c&&void 0!=c?l.root.getFile(c,null,t,a):a({code:FileError.NOT_FOUND_ERR})}else a({code:FileError.NOT_FOUND_ERR})},s.openFile=function(e){e=e||{},e.operationData=e.operationData||{};var t=e.context||window;s.fileInfo({operationData:{FilePath:e.operationData.FilePath},onSuccess:function(n){if(!0===n.Status){var i=r.toObject(n.Result),a=void 0;switch(i.FileExtension=i.FileExtension||"",i.FileExtension.toLowerCase()){case"pdf":a="application/pdf";break;case"doc":case"docx":a="application/msword";break;case"ppt":case"pptx":a="application/vnd.ms-powerpoint";break;case"xls":case"xlsx":a="application/vnd.ms-excel";break;case"rtf":a="application/rtf";break;case"wav":a="audio/x-wav";break;case"gif":a="image/gif";break;case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"txt":case"xml":a="text/plain";break;case"htm":case"html":a="text/html";break;case"mpg":case"mpeg":case"mpe":case"mp4":case"avi":case"mov":case"3gp":case"flv":case"mkv":a="video/*";break;default:a="*/*"}var o=decodeURIComponent(i.FilePath),s=i.FileExtension.toLowerCase();if("pdf"===s||"jpeg"===s||"jpg"===s||"png"===s||"gif"===s||"mp4"===s||"mp3"===s||"txt"===s||"html"===s||"doc"===s||"docx"===s||"xls"===s||"xlsx"===s||"mov"===s){var l=void 0,c=r.getClient().getApplicationParameter("device-info");if(o=o.replace(i.FileName,encodeURIComponent(i.FileName)),c&&c["device-platform"]){switch(c["device-platform"].toLowerCase()){case"ios":l="_blank";var u=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG028","Done");window.cordova.InAppBrowser.open(o+document.location.search,l,"location=no,enableViewportScale=yes,closebuttoncaption="+u);break;case"android":if("pdf"===s||"doc"===s||"docx"===s||"xls"===s||"xlsx"===s||"mov"===s)l="_system",window.cordova.InAppBrowser.open(o,l,"location=no");else{l="_blank";var d=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG028","Done");window.cordova.InAppBrowser.open(o,l,"location=no,enableViewportScale=yes,closebuttoncaption="+d)}break;default:l="_system"}e.onSuccess&&e.onSuccess.call(t,{Result:"File opened successfully",Status:!0})}}else window.cordova.plugins.fileOpener2.open(o,a,{error:function(n){e.onSuccess&&e.onSuccess.call(t,{Result:"Error status: "+n.status+" - Error message: "+n.message,Status:!1}),console.log("Error status: "+n.status+" - Error message: "+n.message)},success:function(){e.onSuccess&&e.onSuccess.call(t,{Result:"File opened successfully",Status:!0})}})}else e.onSuccess&&e.onSuccess.call(t,{Result:"File Not Found",Status:!1})}})},s.fileInfo=function(e){function t(e){e.file(n,i),r.FilePath=e.nativeURL,r.FileName=e.name}function n(t){r.FileSizeInBytes=t.size,r.LastModifiedDateTime=t.lastModifiedDate,r.CreatedDateTime=t.lastModifiedDate;var n=t.name.split(".");n.length>1&&(r.FileExtension=n[n.length-1]),e.onSuccess&&e.onSuccess.call(o,{Result:(0,a.default)(r),Status:!0})}function i(t){e.onSuccess&&e.onSuccess.call(o,{Result:"File Not Found",Status:!1})}e=e||{};var r={FilePath:"",FileName:"",FileSizeInBytes:"",IsReadOnly:"false",CreatedDateTime:"",LastModifiedDateTime:"",FileExtension:""};e.operationData=e.operationData||{};var o=e.context||window;if(e.operationData.FilePath){var c=s.__convertBaseDirectory(e.operationData.FilePath);l.root.getFile(c,null,t,i)}else i({code:FileError.NOT_FOUND_ERR})},s.dirInfo=function(e){function t(t){var n={FilePath:""};n.FilePath=t.nativeURL,e.onSuccess&&e.onSuccess.call(i,{Result:(0,a.default)(n),Status:!0})}function n(t){e.onSuccess&&e.onSuccess.call(i,{Result:"File Not Found",Status:!1})}e=e||{},e.operationData=e.operationData||{};var i=e.context||window;if(e.operationData.FilePath){var r=s.__convertBaseDirectory(e.operationData.FilePath);l.root.getDirectory(r,null,t,n)}else n({code:FileError.NOT_FOUND_ERR})},s.browseAndCopyFile=function(e){function t(e){var t=e.nativeURL;-1===e.nativeURL.indexOf(h)&&(t=e.nativeURL+h),o.fileChooser(u,t,_,function(e){n(e)},function(e){i(e)})}function n(t){var n=r.toObject(t),i=[{OriginalFileName:n.FileName,FilePath:d+n.FileName}];e.onSuccess&&e.onSuccess.call(c,{Result:(0,a.default)(i),Status:!0})}function i(t){e.onError&&e.onError.call(c,{message:t})}function l(t){e.onError&&e.onError.call(c,{message:'{"error":true,"errorCode":999,"errorMessage":"Unable to find destination directory."}'})}e=e||{},e.operationData=e.operationData||{};var c=e.context||window,u="*/*",d="{UploadDirectory}/",_=e.operationData.imageCompression||null;u=e.operationData.MimeType||"*/*",d=e.operationData.DestinationPath&&e.operationData.DestinationPath.length>0?e.operationData.DestinationPath:"{UploadDirectory}/",-1===d.indexOf("/",d.length-1)&&(d+="/");var h=s.__convertBaseDirectory(d);s._getDirectoryEntry({FilePath:h,createFile:!0,context:c,onSuccess:t,onError:l})},s.listFiles=function(e){function t(e){e.createReader().readEntries(n,i)}function n(t){if(e.onSuccess){var n=void 0,i=[];for(n=0;n<t.length;n++)i.push(e.operationData.FilePath+"/"+t[n].name);e.onSuccess.call(r,{Result:(0,a.default)({FileList:i}),Status:!0})}}function i(){e.onSuccess&&e.onSuccess.call(r,{Result:(0,a.default)({FileList:[]}),Status:!0})}e=e||{},e.operationData=e.operationData||{};var r=e.context||window;if(e.operationData.FilePath&&(e.operationData.FilePath=e.operationData.FilePath.replace("/","")),!e.operationData.FilePath||"{DownloadDirectory}"!==e.operationData.FilePath&&"{UploadDirectory}"!==e.operationData.FilePath&&"{TroubleshootDocumentDirectory}"!==e.operationData.FilePath)e.onSuccess&&e.onSuccess.call(r,{Result:(0,a.default)([]),Status:!0});else{var o=s.__convertBaseDirectory(e.operationData.FilePath+"/");l.root.getDirectory(o,null,t,i)}},s._getFileEntry=function(e){function t(e){e.getFile(l,{create:r,exclusive:!1},n,i)}function n(t){e.onSuccess&&e.onSuccess.call(a,t)}function i(t){e.onError&&(t=t||{code:FileError.NOT_FOUND_ERR},e.onError.call(a,t))}e=e||{};var a=e.context||window,r=e.createFile||!1;if(e.FilePath){var o=e.FilePath.split("/"),l=o.pop();s._createDirectoryRecursive({path:o,context:a,onSuccess:t,onError:i})}else i()},s._getDirectoryEntry=function(e){function t(t){e.onSuccess&&e.onSuccess.call(i,t)}function n(t){e.onError&&(t=t||{code:FileError.NOT_FOUND_ERR},e.onError.call(i,t))}e=e||{};var i=e.context||window;if(e.FilePath){var a=e.FilePath.split("/");s._createDirectoryRecursive({path:a,context:i,onSuccess:t,onError:n})}else n()},s._createDirectoryRecursive=function(e){function t(t){if(r<e.path.length)return void n(t,e.path[r++]);e.onSuccess&&e.onSuccess.call(a,t)}function n(e,n){e.getDirectory(n,{create:!0,exclusive:!1},t,i)}function i(t){e.onError&&(t=t||{code:FileError.NOT_FOUND_ERR},e.onError.call(a,t))}e=e||{};var a=e.context||window,r=0;e.path?t(l.root):i()},s.__convertBaseDirectory=function(e){var t=e.replace(new RegExp("\\\\","g"),"/").replace(new RegExp("//","g"),"/");if(t=t.replace("{ReportTemplateFolder}/","Download/"),t=t.replace("{DownloadDirectory}/","Download/"),t=t.replace("{DownloadDirectory}","Download"),t=t.replace("{TroubleshootDocumentDirectory}/","TroubleshootDocuments/"),t=t.replace("{UploadDirectory}/","Upload/"),"iOS"===window.device.platform)t="NoCloud/"+t;else{t=(window.cordova.file.externalDataDirectory||window.cordova.file.dataDirectory).replace(l.root.nativeURL,"")+t}return t},s.__convertBase64toBlob=function(e,t){for(var n=[],i=atob(t),a=0;a<i.length;a+=512){for(var r=i.slice(a,a+512),o=new Array(r.length),s=0;s<r.length;s++)o[s]=r.charCodeAt(s);var l=new Uint8Array(o);n.push(l)}return new Blob(n,{type:e})},e.exports=s},function(e,t,n){e.exports=!n(26)&&!n(20)(function(){return 7!=Object.defineProperty(n(133)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){t.f=n(23)},function(e,t,n){var i=n(38),a=n(39),r=n(106)(!1),o=n(135)("IE_PROTO");e.exports=function(e,t){var n,s=a(e),l=0,c=[];for(n in s)n!=o&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~r(c,n)||c.push(n));return c}},function(e,t,n){var i=n(27),a=n(15),r=n(69);e.exports=n(26)?Object.defineProperties:function(e,t){a(e);for(var n,o=r(t),s=o.length,l=0;s>l;)i.f(e,n=o[l++],t[n]);return e}},function(e,t,n){var i=n(39),a=n(72).f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return a(e)}catch(e){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==r.call(e)?s(e):a(i(e))}},function(e,t,n){"use strict";var i=n(69),a=n(107),r=n(92),o=n(29),s=n(91),l=Object.assign;e.exports=!l||n(20)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=i})?function(e,t){for(var n=o(e),l=arguments.length,c=1,u=a.f,d=r.f;l>c;)for(var _,h=s(arguments[c++]),f=u?i(h).concat(u(h)):i(h),p=f.length,m=0;p>m;)d.call(h,_=f[m++])&&(n[_]=h[_]);return n}:l},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var i=n(32),a=n(21),r=n(202),o=[].slice,s={},l=function(e,t,n){if(!(t in s)){for(var i=[],a=0;a<t;a++)i[a]="a["+a+"]";s[t]=Function("F,a","return new F("+i.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=i(this),n=o.call(arguments,1),s=function(){var i=n.concat(o.call(arguments));return this instanceof s?l(t,i.length,i):r(t,i,e)};return a(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(17).parseInt,a=n(84).trim,r=n(139),o=/^[-+]?0[xX]/;e.exports=8!==i(r+"08")||22!==i(r+"0x16")?function(e,t){var n=a(String(e),3);return i(n,t>>>0||(o.test(n)?16:10))}:i},function(e,t,n){var i=n(17).parseFloat,a=n(84).trim;e.exports=1/i(n(139)+"-0")!=-1/0?function(e){var t=a(String(e),3),n=i(t);return 0===n&&"-"==t.charAt(0)?-0:n}:i},function(e,t,n){var i=n(45);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=i(e))throw TypeError(t);return+e}},function(e,t,n){var i=n(21),a=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&a(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){var i=n(142),a=Math.pow,r=a(2,-52),o=a(2,-23),s=a(2,127)*(2-o),l=a(2,-126),c=function(e){return e+1/r-1/r};e.exports=Math.fround||function(e){var t,n,a=Math.abs(e),u=i(e);return a<l?u*c(a/l/o)*l*o:(t=(1+o/r)*a,n=t-(t-a),n>s||n!=n?u*(1/0):u*n)}},function(e,t,n){var i=n(15);e.exports=function(e,t,n,a){try{return a?t(i(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&i(r.call(e)),t}}},function(e,t,n){var i=n(32),a=n(29),r=n(91),o=n(25);e.exports=function(e,t,n,s,l){i(t);var c=a(e),u=r(c),d=o(c.length),_=l?d-1:0,h=l?-1:1;if(n<2)for(;;){if(_ in u){s=u[_],_+=h;break}if(_+=h,l?_<0:d<=_)throw TypeError("Reduce of empty array with no initial value")}for(;l?_>=0:d>_;_+=h)_ in u&&(s=t(s,u[_],_,c));return s}},function(e,t,n){"use strict";var i=n(29),a=n(70),r=n(25);e.exports=[].copyWithin||function(e,t){var n=i(this),o=r(n.length),s=a(e,o),l=a(t,o),c=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===c?o:a(c,o))-l,o-s),d=1;for(l<s&&s<l+u&&(d=-1,l+=u-1,s+=u-1);u-- >0;)l in n?n[s]=n[l]:delete n[s],s+=d,l+=d;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i=n(154);n(9)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(e,t,n){n(26)&&"g"!=/./g.flags&&n(27).f(RegExp.prototype,"flags",{configurable:!0,get:n(93)})},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var i=n(15),a=n(21),r=n(158);e.exports=function(e,t){if(i(e),a(t)&&t.constructor===e)return t;var n=r.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var i=n(218),a=n(77);e.exports=n(115)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=i.getEntry(a(this,"Map"),e);return t&&t.v},set:function(e,t){return i.def(a(this,"Map"),0===e?0:e,t)}},i,!0)},function(e,t,n){"use strict";var i=n(27).f,a=n(71),r=n(76),o=n(44),s=n(74),l=n(75),c=n(144),u=n(212),d=n(73),_=n(26),h=n(62).fastKey,f=n(77),p=_?"_s":"size",m=function(e,t){var n,i=h(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var u=e(function(e,i){s(e,u,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[p]=0,void 0!=i&&l(i,n,e[c],e)});return r(u.prototype,{clear:function(){for(var e=f(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var n=f(this,t),i=m(n,e);if(i){var a=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=a),a&&(a.p=r),n._f==i&&(n._f=a),n._l==i&&(n._l=r),n[p]--}return!!i},forEach:function(e){f(this,t);for(var n,i=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(f(this,t),e)}}),_&&i(u.prototype,"size",{get:function(){return f(this,t)[p]}}),u},def:function(e,t,n){var i,a,r=m(e,t);return r?r.v=n:(e._l=r={i:a=h(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=r),i&&(i.n=r),e[p]++,"F"!==a&&(e._i[a]=r)),e},getEntry:m,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=f(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?u(0,n.k):"values"==t?u(0,n.v):u(0,[n.k,n.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";var i=n(218),a=n(77);e.exports=n(115)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(a(this,"Set"),e=0===e?0:e,e)}},i)},function(e,t,n){"use strict";var i,a=n(17),r=n(54)(0),o=n(36),s=n(62),l=n(199),c=n(221),u=n(21),d=n(77),_=n(77),h=!a.ActiveXObject&&"ActiveXObject"in a,f=s.getWeak,p=Object.isExtensible,m=c.ufstore,v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},g={get:function(e){if(u(e)){var t=f(e);return!0===t?m(d(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(d(this,"WeakMap"),e,t)}},y=e.exports=n(115)("WeakMap",v,g,c,!0,!0);_&&h&&(i=c.getConstructor(v,"WeakMap"),l(i.prototype,g),s.NEED=!0,r(["delete","has","get","set"],function(e){var t=y.prototype,n=t[e];o(t,e,function(t,a){if(u(t)&&!p(t)){this._f||(this._f=new i);var r=this._f[e](t,a);return"set"==e?this:r}return n.call(this,t,a)})}))},function(e,t,n){"use strict";var i=n(76),a=n(62).getWeak,r=n(15),o=n(21),s=n(74),l=n(75),c=n(54),u=n(38),d=n(77),_=c(5),h=c(6),f=0,p=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},v=function(e,t){return _(e.a,function(e){return e[0]===t})};m.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var c=e(function(e,i){s(e,c,t,"_i"),e._t=t,e._i=f++,e._l=void 0,void 0!=i&&l(i,n,e[r],e)});return i(c.prototype,{delete:function(e){if(!o(e))return!1;var n=a(e);return!0===n?p(d(this,t)).delete(e):n&&u(n,this._i)&&delete n[this._i]},has:function(e){if(!o(e))return!1;var n=a(e);return!0===n?p(d(this,t)).has(e):n&&u(n,this._i)}}),c},def:function(e,t,n){var i=a(r(t),!0);return!0===i?p(e).set(t,n):i[e._i]=n,e},ufstore:p}},function(e,t,n){var i=n(46),a=n(25);e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=a(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var i=n(72),a=n(107),r=n(15),o=n(17).Reflect;e.exports=o&&o.ownKeys||function(e){var t=i.f(r(e)),n=a.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";function i(e,t,n,c,u,d,_,h){for(var f,p,m=u,v=0,g=!!_&&s(_,h,3);v<c;){if(v in n){if(f=g?g(n[v],v,t):n[v],p=!1,r(f)&&(p=f[l],p=void 0!==p?!!p:a(f)),p&&d>0)m=i(e,t,f,o(f.length),m,d-1)-1;else{if(m>=9007199254740991)throw TypeError();e[m]=f}m++}v++}return m}var a=n(108),r=n(21),o=n(25),s=n(44),l=n(23)("isConcatSpreadable");e.exports=i},function(e,t,n){var i=n(25),a=n(141),r=n(52);e.exports=function(e,t,n,o){var s=String(r(e)),l=s.length,c=void 0===n?" ":String(n),u=i(t);if(u<=l||""==c)return s;var d=u-l,_=a.call(c,Math.ceil(d/c.length));return _.length>d&&(_=_.slice(0,d)),o?_+s:s+_}},function(e,t,n){var i=n(69),a=n(39),r=n(92).f;e.exports=function(e){return function(t){for(var n,o=a(t),s=i(o),l=s.length,c=0,u=[];l>c;)r.call(o,n=s[c++])&&u.push(e?[n,o[n]]:o[n]);return u}}},function(e,t,n){var i=n(83),a=n(228);e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},function(e,t,n){var i=n(75);e.exports=function(e,t){var n=[];return i(e,!1,n.push,n,t),n}},function(e,t){e.exports=Math.scale||function(e,t,n,i,a){return 0===arguments.length||e!=e||t!=t||n!=n||i!=i||a!=a?NaN:e===1/0||e===-1/0?e:(e-t)*(a-i)/(n-t)+i}},function(e,t,n){var i=n(78),a=n(64),r=n(629)(!1),o=n(164)("IE_PROTO");e.exports=function(e,t){var n,s=a(e),l=0,c=[];for(n in s)n!=o&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~r(c,n)||c.push(n));return c}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){e.exports=!n(55)&&!n(80)(function(){return 7!=Object.defineProperty(n(233)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(59),a=n(48).document,r=i(a)&&i(a.createElement);e.exports=function(e){return r?a.createElement(e):{}}},function(e,t,n){var i=n(78),a=n(86),r=n(164)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){e.exports=n(65)},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var i=n(162);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(230),a=n(166).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,a)}},function(e,t){},function(e,t,n){e.exports={default:n(652),__esModule:!0}},function(e,t,n){var i=n(66);e.exports=function(e,t,n,a){try{return a?t(i(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&i(r.call(e)),t}}},function(e,t,n){var i=n(96),a=n(42)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[a]===e)}},function(e,t,n){var i=n(162),a=n(42)("toStringTag"),r="Arguments"==i(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),a))?n:r?i(t):"Object"==(s=i(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(6),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(10),v=n(126),g=n(5).Event,y=n(5).EventDispatcher,S=n(5).SVMXObject,E=n(127).ResourceLoader,b=n(127).ResourceLoaderService,T=n(5).ExtensionRunner,M={name:"com.servicemax.client.lib.core"};M.LoadProgressEvent=function(e){function t(e,n,i){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i))}return(0,p.default)(t,e),t}(g),M.LoadProgressMonitor=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i));return a.totalSteps=0,a.currentStep=0,a}return(0,p.default)(t,e),(0,s.default)(t,[{key:"start",value:function(e){this.totalSteps=e.totalSteps,this.currentStep=1;var t=new M.LoadProgressEvent("LOAD_STARTED",this,e.params);this.triggerEvent(t)}},{key:"finishStep",value:function(e){var t=new M.LoadProgressEvent("STEP_FINISHED",this,e);this.triggerEvent(t),this.currentStep++}},{key:"finish",value:function(){var e=new M.LoadProgressEvent("LOAD_FINISHED",this);this.triggerEvent(e)}}]),t}(y),M.ModuleLoaderEvent=function(e){function t(e,n,i){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i))}return(0,p.default)(t,e),t}(g),M.ModuleLoader=function(e){function t(e){(0,d.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.__options=e,n.__logger=v.getLoggingService().getLogger("MODULE-LOADER"),n.module=null,n.templateList=null,n}return(0,p.default)(t,e),(0,s.default)(t,[{key:"loadAsync",value:function(){return this.__options.manifestOnly?this.__loadManifest():this.__loadModuleScripts()}},{key:"getOptions",value:function(){return this.__options}},{key:"__loadManifest",value:function(){var e=this.__getCodeBase(),t=v.isCachingEnabled(),n=e+"/manifest/module.json";return m.ajax({cache:t,type:"GET",dataType:"json",url:n,context:this,async:!0,success:function(e,t,n){this.__loadManifestSuccess(e,t)},error:function(e,t,n){this.__loadManifestError(e,t,n)}})}},{key:"__loadManifestSuccess",value:function(e,t){var n=new M.ModuleLoaderEvent("LOAD_COMPLETE",this,e);this.triggerEvent(n)}},{key:"__loadManifestError",value:function(e,t,n){this.__logger.error("Cannot load manifest for "+this.__options.id+", XHR Status = "+t);var i=new M.ModuleLoaderEvent("LOAD_ERROR",this);this.triggerEvent(i)}},{key:"__getCodeBase",value:function(){var e=this.__options.codebase;return null!=e?"/"!=e.charAt(e.length-1)&&(e+="/"):e="",e+=this.__options.id}},{key:"__loadModuleScripts",value:function(){var e=v.Deferred(),t=this.__getCodeBase(),n=t+"/src/";return v.requireScript(this.__options.module.scripts,this.__loadModuleScriptsComplete,v.proxy(this,"__loadModuleError"),this,{async:!0,prefix:n},e),e}},{key:"__loadModuleError",value:function(e){this.__logger.error(e);var t=new M.ModuleLoaderEvent("LOAD_ERROR",this);this.triggerEvent(t)}},{key:"__loadModuleScriptsComplete",value:function(){this.__loadModuleTemplates()}},{key:"__loadModuleTemplates",value:function(){if(this.__options.module.templates&&this.__options.module.templates.length>0){var e=this.__getCodeBase(),t=e+"/resources/templates/";v.requireTemplate(this.__options.module.templates,this.__loadModuleTemplatesComplete,this,{async:!0,prefix:t})}else this.__loadModuleTemplatesComplete()}},{key:"__loadModuleTemplatesComplete",value:function(e){this.templateList=e;var t=new M.ModuleLoaderEvent("LOAD_COMPLETE",this);this.triggerEvent(t)}}]),t}(y),M.Module=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));a.client=e,a.dependencies=[],a.declarations=[],a.definitions=[],a.services=[],a.id=n.id,a.version=n.version,a.name=n.name,a.description=n.description,a.def=n,a.scripts=n.scripts,a.tests=n.tests?n.tests:[],a.activatorClass=n["module-activator"],a.loadAtStartup=n["load-at-startup"],a.codebase=i.codebase,a.templates=n.templates,a.__extractDependencies(),a.__extractDeclaredInterfaces(),a.__extractInterfaceImplementations(),a.__extractServices();var r=0;for(r=0;r<a.declarations.length;r++)e.registerDeclaration(a.declarations[r]);return a.__activator=null,a.loadedTemplates=null,a}return(0,p.default)(t,e),(0,s.default)(t,[{key:"setLoadedTemplates",value:function(e){this.loadedTemplates=e}},{key:"getTemplate",value:function(e){if(!this.loadedTemplates)return null;for(var t=0;t<this.loadedTemplates.length;t++)if(e==this.loadedTemplates[t].name)return this.loadedTemplates[t].data;return null}},{key:"createActivator",value:function(){var e=v.getClass(this.activatorClass);this.__activator=new e,this.__activator.setModule(this)}},{key:"beforeInitialize",value:function(){this.__activator.beforeInitialize()}},{key:"initialize",value:function(){this.__activator.initialize()}},{key:"afterInitialize",value:function(){this.__activator.afterInitialize()}},{key:"resolveDefinitions",value:function(){for(var e=0;e<this.definitions.length;e++){var t=this.client.registerDefinition(this.definitions[e]);if(0==t)return t}return!0}},{key:"resolveServices",value:function(){for(var e=0;e<this.services.length;e++){var t=this.client.registerService(this.services[e]);if(0==t)return t}return!0}},{key:"__extractServices",value:function(){for(var e=this.def.services,t=e.length,n=0;n<t;n++){var i=new M.Service(this,e[n]);this.services[n]=i}}},{key:"__extractDependencies",value:function(){for(var e=this.def.depends,t=e.length,n=0;n<t;n++){var i=new M.Dependency(this,e[n]);this.dependencies[n]=i}}},{key:"__extractDeclaredInterfaces",value:function(){for(var e=this.def.declares,t=e.length,n=0;n<t;n++){var i=new M.DeclaredInterface(this,e[n]);this.declarations[n]=i}}},{key:"__extractInterfaceImplementations",value:function(){for(var e=this.def.defines,t=e.length,n=0;n<t;n++){var i=new M.InterfaceDefinition(this,e[n]);this.definitions[n]=i}}},{key:"getResourceUrl",value:function(e){return this.__getCodeBase()+"/resources/"+e}},{key:"__getCodeBase",value:function(){var e=this.codebase;return null!=e?"/"!=e.charAt(e.length-1)&&(e+="/"):e="",e+=this.id}}]),t}(S),M.DeclaredInterface=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return i.id=n.id,i.description=n.description,i.module=e,i}return(0,p.default)(t,e),t}(S),M.InterfaceDefinition=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return i.type=n.type,i.id=n.id,i.config=n.config,i.module=e,i}return(0,p.default)(t,e),(0,s.default)(t,[{key:"createInstanceAsync",value:function(e,t){this.__createInstanceAsyncInternal(e,t)}},{key:"__createInstanceAsyncInternal",value:function(e,t){var n=v.getClass(e),i=new n;t.handler.call(t.context,i)}},{key:"getResourceUrl",value:function(e){return this.module.getResourceUrl(e)}}]),t}(S),M.Dependency=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return i.id=n.id,i.version=n.version,i.module=e,i}return(0,p.default)(t,e),t}(S),M.ModuleResourceLoader=function(e){function t(e){(0,d.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.__module=e,n}return(0,p.default)(t,e),(0,s.default)(t,[{key:"loadAsync",value:function(e){return e.url=this.__getCodeBase()+"/resources/"+e.url,(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"loadAsync",this).call(this,e)}},{key:"__getCodeBase",value:function(){var e=this.__module.getModule().codebase;return null!=e?"/"!=e.charAt(e.length-1)&&(e+="/"):e="",e+=this.__module.getModule().id}},{key:"getResourceUrl",value:function(e){return this.__getCodeBase()+"/resources/"+e}}]),t}(E),M.Service=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return i.id=n.id,i.__serviceClassName=n["class-name"],i.module=e,i.__serviceInstance=null,i}return(0,p.default)(t,e),(0,s.default)(t,[{key:"getInstance",value:function(){if(null==this.__serviceInstance){var e=v.getClass(this.__serviceClassName);this.__serviceInstance=new e}return this.__serviceInstance}},{key:"getInstanceAsync",value:function(e){this.__getInstanceAsyncInternal(e)}},{key:"__getInstanceAsyncInternal",value:function(e){if(null==this.__serviceInstance){var t=v.getClass(this.__serviceClassName);this.__serviceInstance=new t}e.handler.call(e.context,this.__serviceInstance)}}]),t}(S),M.ClientEvent=function(e){function t(e,n,i){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i))}return(0,p.default)(t,e),t}(g),M.Client=function(e){function t(){var e;if((0,d.default)(this,t),null!=M.Client.__instance)return e=M.Client.__instance,(0,h.default)(n,e);var n=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return n.__moduleId2Modules={},n.__declarationId2Definitions={},n.__declarationId2Declarations={},n.__serviceId2Services={},n.__appParams={},n.__progressMonitor=new M.LoadProgressMonitor,n.__logger=v.getLoggingService().getLogger(),n.__profiler=v.getProfilingService(),M.Client.__instance=n,n.__loadVersion="debug",n.__applicationTitle=null,n.__loadModulesContext=0,n.__allDependencies=null,n.__loadManifestTriggeredFor=null,n.__loadModuleTriggeredFor=null,n}return(0,p.default)(t,e),(0,s.default)(t,[{key:"run",value:function(e){if(jQuery.ajaxSettings.converters["text json"]=this.__parseJSON,v.Deferred=m.Deferred,void 0!=e.loadVersion&&null!=e.loadVersion&&(this.__loadVersion=e.loadVersion),"remote"==e.configType)this.__runWithRemoteConfig(e.data);else{if("local"!=e.configType)throw new Error("Unknown config type!");this.__runWithLocalConfig(e.data)}}},{key:"__parseJSON",value:function(e){var t=/^[\],:{}\s]*$/,n=/(?:^|:|,)(?:\s*\[)+/g,i=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,a=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g;if(!e||"string"!=typeof e)return null;e=jQuery.trim(e);try{if(window.JSON&&window.JSON.parse&&-1==e.indexOf("/*"))return window.JSON.parse(e)}catch(e){}if(t.test(e.replace(i,"@").replace(a,"]").replace(n,"").replace(/\/\*.*?\*\//g,"")))try{return e}catch(e){}throw new Error("Invalid JSON: "+e)}},{key:"getModuleForId",value:function(e){return this.__moduleId2Modules[e]}},{key:"getApplicationTitle",value:function(){return this.__applicationTitle}},{key:"getLoadVersion",value:function(){return this.__loadVersion}},{key:"setLoadVersion",value:function(e){this.__loadVersion=e}},{key:"getApplicationParameter",value:function(e){return this.__appParams[e]}},{key:"addApplicationParameter",value:function(e,t){this.__appParams[e]=t}},{key:"getPlatformParameter",value:function(e){}},{key:"getProgressMonitor",value:function(){return this.__progressMonitor}},{key:"__runWithRemoteConfig",value:function(e){var t=b.getInstance().createResourceLoader();t.bind("LOAD_COMPLETE",this.__configLoadSuccess,this),t.bind("LOAD_ERROR",this.__configLoadError,this);var n=this.__profiler,i=e;n.begin(i,"config","load"),t.loadAsync({url:e,responseType:"json",cache:!1}).always(function(){n.end(i,"config","load")})}},{key:"__configLoadSuccess",value:function(e){this.__run(e.data)}},{key:"__configLoadError",value:function(e){}},{key:"__runWithLocalConfig",value:function(e){this.__run(e)}},{key:"__run",value:function(e){var t=e["app-config"];for(var n in t)this.__appParams[n]=t[n];var i=this.getApplicationParameter("svmx-logging-preferences");i&&v.getLoggingService().setTargetSettings(i),this.__applicationTitle=e.title,v.create("com.servicemax.client.lib.core.MiniSplash",this.__progressMonitor,e),this.__progressMonitor.start({totalSteps:e.modules.length+1,params:{stepTitle:"Starting module load"}}),this.__loadModuleManifests(e.modules)}},{key:"__loadModuleManifests",value:function(e){this.__loadModulesContext=0,this.__loadManifestTriggeredFor={};var t=0,n=e.length;for(t=0;t<n;t++){var i=e[t],a={manifestOnly:!0,id:i.id,codebase:i.codebase};this.__loadModuleManifest(a)}}},{key:"__loadModuleManifest",value:function(e){if(void 0==this.__loadManifestTriggeredFor[e.id]){this.__loadModulesContext++,this.__loadManifestTriggeredFor[e.id]=e.id;var t=new M.ModuleLoader(e);t.bind("LOAD_COMPLETE",this.__loadModuleManifestSuccess,this),t.bind("LOAD_ERROR",v.proxy(this,"__loadModuleManifestError",e),this);var n=this.__profiler,i=e.id;n.begin(i,"manifest","load"),t.loadAsync().always(function(){n.end(i,"manifest","load")})}}},{key:"__loadModuleManifestSuccess",value:function(e){var t=new M.Module(this,e.data,e.target.getOptions());this.__logger.info("Loaded Module "+t.id),this.__moduleId2Modules[t.id]=t,0==--this.__loadModulesContext&&this.__loadModuleManifestsComplete()}},{key:"__loadModuleManifestError",value:function(e,t){this.__logger.error("loadModuleManifestError: "+e.id+" failed to load")}},{key:"__loadModuleManifestsComplete",value:function(){return this.__progressMonitor.finishStep({stepTitle:"All module manifests loaded"}),this.__logger.info("all module manifest are loaded!"),this.__resolveDefinitions()?this.__resolveServices()?void this.__loadModules():void this.__logger.error("There was an error during services resolution! Client cannot proceed."):void this.__logger.error("There was an error during definitions resolution! Client cannot proceed.")}},{key:"__loadModules",value:function(){this.__loadModulesContext=0,this.__loadModuleTriggeredFor={};for(var e in this.__moduleId2Modules){var t=this.__moduleId2Modules[e];this.__loadModule(t)}}},{key:"__loadModule",value:function(e){if(void 0==this.__loadModuleTriggeredFor[e.id]){this.__loadModulesContext++,this.__loadModuleTriggeredFor[e.id]=e.id;var t={manifestOnly:!1,id:e.id,codebase:e.codebase,module:e},n=new M.ModuleLoader(t);n.bind("LOAD_COMPLETE",this.__loadModuleSuccess,this),n.bind("LOAD_ERROR",this.__loadModuleError,e);var i=this.__profiler,a=e.id;i.begin(a,"module","load"),n.loadAsync().always(function(){i.end(a,"module","load")})}}},{key:"__loadModuleSuccess",value:function(e){var t=e.target.getOptions().module;this.__progressMonitor.finishStep({stepTitle:"Module loaded: "+t.id}),this.__logger.info(t.id+" successfully loaded"),t.setLoadedTemplates(e.target.templateList),t.createActivator(),0==--this.__loadModulesContext&&this.__loadModulesComplete()}},{key:"__loadModuleError",value:function(e,t){}},{key:"__loadModulesComplete",value:function(){this.__logger.info("all modules now loaded are loaded!");for(var e in this.__moduleId2Modules){var t=this.__moduleId2Modules[e];try{t.beforeInitialize()}catch(t){throw this.__logger.error("Error during beforeInitialize() of =>"+e),t}}for(var e in this.__moduleId2Modules){var t=this.__moduleId2Modules[e];try{t.initialize()}catch(t){throw this.__logger.error("Error during initialize() of =>"+e),t}}for(var e in this.__moduleId2Modules){var t=this.__moduleId2Modules[e];try{t.afterInitialize()}catch(t){throw this.__logger.error("Error during afterInitialize() of =>"+e),t}}T.run(this,"com.servicemax.client.onFrameworkLoad").then(v.proxy(this,function(){var e=v.create("com.servicemax.client.lib.core.ClientEvent","READY",this);this.triggerEvent(e)}))}},{key:"__resolveDefinitions",value:function(){for(var e in this.__moduleId2Modules){if(!this.__moduleId2Modules[e].resolveDefinitions())return!1}return!0}},{key:"__resolveServices",value:function(){for(var e in this.__moduleId2Modules){if(!this.__moduleId2Modules[e].resolveServices())return!1}return!0}},{key:"getDeclarationRegistry",value:function(){return this}},{key:"getServiceRegistry",value:function(){return this}},{key:"getDeclaration",value:function(e){return void 0==this.__declarationId2Declarations[e]?(this.__logger.warning("Cannot find declaration <"+e+">!"),null):this.__declarationId2Declarations[e]}},{key:"getDefinitionsFor",value:function(e){var t="";return t="string"==typeof e?e:e.id,this.__declarationId2Definitions[t]}},{key:"forEachDefinition",value:function(e,t){var n=this.getDeclaration(e),i=this.getDefinitionsFor(n);v.array.forEach(i,t)}},{key:"registerDeclaration",value:function(e){var t=e.id;if(void 0!=this.__declarationId2Declarations[t]){var n=this.__declarationId2Declarations[t].module.id,i=e.module.id;return this.__logger.error("Module "+i+" is trying to declare the interface <"+e.id+"> which is already declared by "+n+". Please rectify!"),!1}return this.__declarationId2Declarations[t]=e,this.__declarationId2Definitions[t]=[],!0}},{key:"registerDefinition",value:function(e){var t=e.type;if(void 0==this.__declarationId2Definitions[t])return this.__logger.error("Module "+e.module.id+" is trying to define an interface  <"+t+"> which is not declared. Please rectify!"),!1;var n=this.__declarationId2Definitions[t];return n[n.length]=e,!0}},{key:"iterateOverDefinitionsForDeclaration",value:function(e,t){var n=this.getDeclaration(e);if(n){var i=client.getDefinitionsFor(n);v.array.forEach(i,t)}}},{key:"registerService",value:function(e){var t=e.id;if(void 0!=this.__serviceId2Services[t]){var n=this.__serviceId2Services[t].module.id,i=e.module.id;return this.__logger.error("Module "+i+" is trying to register the service <"+t+"> which is already declared by "+n+". Please rectify!"),!1}return this.__serviceId2Services[t]=e,!0}},{key:"getServiceInstanceAsync",value:function(e,t){var n=this.getService(e);n?n.getInstanceAsync({handler:function(e){t.context?t.handler.call(t.context,e):t.handler(e)},context:this}):t.context?t.handler.call(t.context,null):t.handler(null)}},{key:"getService",value:function(e){return void 0==this.__serviceId2Services[e]?(this.__logger.error("Cannot find service -> "+e),null):this.__serviceId2Services[e]}},{key:"getServiceInstance",value:function(e){var t=this.getService(e);if(t)return t.getInstance()}}]),t}(y),M.Client.getInstance=function(){return null==M.Client.__instance&&(M.Client.__instance=new M.Client),M.Client.__instance},M.Client.__instance=null,M.MiniSplash=function(e){function t(e,n){(0,d.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments)),a=M.MiniSplash.loadingDivId;M.MiniSplash.loadingDivId++;var r=m("body");e.bind("LOAD_STARTED",i.handleLoadStarted,i),e.bind("STEP_FINISHED",i.handleFinishStep,i),e.bind("LOAD_FINISHED",i.handleFinish,i),i.__pm=e;var o=n&&n["app-config"]["svmx-enable-bootstrap-spinner"];r.append("<div class='loading_div' id='loading_div"+a+"'>"+(o?"":'<span class="svmx-sfmd-loading-spinner"></span>')+"<span style='float:right; margin:2px 0 0 0; padding:0' class='loading_span'></span></div>"),i.__ms=m("#loading_div"+a+" .loading_span"),i.__outerNode=m("#loading_div"+a);var s={width:i._width,minHeight:i._height,bottom:0,left:0,fontFamily:"tahoma, arial, verdana, sans-serif",textAlign:"right",fontSize:"12px",color:"#000",borderTop:"solid 1px #c7c7c7",padding:"1px 10px",display:"none",position:"absolute",boxSizing:"border-box",background:"#e0dfdf"};return i.__outerNode.css(s),o&&(r.append('<div id="spinner" style="position: absolute; top: 50%; left: 50%; width: 50%; height: 50%"></div>'),i.__spinner=m("#spinner").get(0),new Spinner({lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,speed:1,trail:60,shadow:!1,hwaccel:!1,color:"#888888",className:"spinner",top:"-100%",left:"-60%"}).spin(i.__spinner)),i.__disconnectFunc=v.proxy(i,"__onScroll"),m(window).on("scroll",i.__disconnectFunc),i._width="100%",i._height="20px",i.__text="",i}return(0,p.default)(t,e),(0,s.default)(t,[{key:"__onScroll",value:function(){this.__outerNode&&this.__outerNode.css("bottom",-m("body")[0].scrollTop)}},{key:"__setText",value:function(e){this.__text=e,this.__ms.text(this.__text)}},{key:"handleLoadStarted",value:function(e){this.__outerNode.show(),this.__setText(e.data.stepTitle)}},{key:"handleFinishStep",value:function(e){this.__setText(e.data.stepTitle)}},{key:"handleFinish",value:function(e){var t=this;this.__ms.text("Loading done"),t.__pm.unbind("LOAD_STARTED",this.handleLoadStarted,this),t.__pm.unbind("STEP_FINISHED",this.handleFinishStep,this),t.__pm.unbind("LOAD_FINISHED",this.handleFinish,this),this.__spinner&&m(this.__spinner).remove(),this.__outerNode.animate({opacity:0},400,null,function(){t.__outerNode.remove(),t.__ms=null,t.__outerNode=null,t.__pm=null,t.__disconnectFunc&&m(window).off("scroll",t.__disconnectFunc)})}}]),t}(S),M.MiniSplash.loadingDivId=0,v.getClient=function(){return M.Client.getInstance()},v.registerService=function(e){return v.getClient().registerService(new M.Service(null,e))},v.registerDefinition=function(e){return v.getClient().registerDefinition(new M.InterfaceDefinition(null,e))},v.registerDeclaration=function(e){return v.getClient().registerDeclaration(new M.DeclaredInterface(null,e))},e.exports=M},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("af",{months:"Januarie_Februarie_Maart_April_Mei_Junie_Julie_Augustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mrt_Apr_Mei_Jun_Jul_Aug_Sep_Okt_Nov_Des".split("_"),weekdays:"Sondag_Maandag_Dinsdag_Woensdag_Donderdag_Vrydag_Saterdag".split("_"),weekdaysShort:"Son_Maa_Din_Woe_Don_Vry_Sat".split("_"),weekdaysMin:"So_Ma_Di_Wo_Do_Vr_Sa".split("_"),meridiemParse:/vm|nm/i,isPM:function(e){return/^nm$/i.test(e)},meridiem:function(e,t,n){return e<12?n?"vm":"VM":n?"nm":"NM"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Vandag om] LT",nextDay:"[Mre om] LT",nextWeek:"dddd [om] LT",lastDay:"[Gister om] LT",lastWeek:"[Laas] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oor %s",past:"%s gelede",s:"'n paar sekondes",ss:"%d sekondes",m:"'n minuut",mm:"%d minute",h:"'n uur",hh:"%d ure",d:"'n dag",dd:"%d dae",M:"'n maand",MM:"%d maande",y:"'n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},i=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},a={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},r=function(e){return function(t,n,r,o){var s=i(t),l=a[e][i(t)];return 2===s&&(l=l[n?0:1]),l.replace(/%d/i,t)}},o=["","","","","","","","","","","",""];return e.defineLocale("ar",{months:o,monthsShort:o,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:r("s"),ss:r("s"),m:r("m"),mm:r("m"),h:r("h"),hh:r("h"),d:r("d"),dd:r("d"),M:r("M"),MM:r("M"),y:r("y"),yy:r("y")},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ar-dz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ar-kw",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:0,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",0:"0"},n=function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},i={s:["  "," ",["",""],"%d ","%d ","%d "],m:["  "," ",["",""],"%d ","%d ","%d "],h:["  "," ",["",""],"%d ","%d ","%d "],d:["  "," ",["",""],"%d ","%d ","%d "],M:["  "," ",["",""],"%d ","%d ","%d "],y:["  "," ",["",""],"%d ","%d ","%d "]},a=function(e){return function(t,a,r,o){var s=n(t),l=i[e][n(t)];return 2===s&&(l=l[a?0:1]),l.replace(/%d/i,t)}},r=["","","","","","","","","","","",""];return e.defineLocale("ar-ly",{months:r,monthsShort:r,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:a("s"),ss:a("s"),m:a("m"),mm:a("m"),h:a("h"),hh:a("h"),d:a("d"),dd:a("d"),M:a("M"),MM:a("M"),y:a("y"),yy:a("y")},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ar-ma",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("ar-sa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ar-tn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[  ] LT",nextDay:"[  ] LT",nextWeek:"dddd [ ] LT",lastDay:"[  ] LT",lastWeek:"dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"-inci",5:"-inci",8:"-inci",70:"-inci",80:"-inci",2:"-nci",7:"-nci",20:"-nci",50:"-nci",3:"-nc",4:"-nc",100:"-nc",6:"-nc",9:"-uncu",10:"-uncu",30:"-uncu",60:"-nc",90:"-nc"};return e.defineLocale("az",{months:"yanvar_fevral_mart_aprel_may_iyun_iyul_avqust_sentyabr_oktyabr_noyabr_dekabr".split("_"),monthsShort:"yan_fev_mar_apr_may_iyn_iyl_avq_sen_okt_noy_dek".split("_"),weekdays:"Bazar_Bazar ertsi_rnb axam_rnb_Cm axam_Cm_nb".split("_"),weekdaysShort:"Baz_BzE_Ax_r_CAx_Cm_n".split("_"),weekdaysMin:"Bz_BE_A__CA_C_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[sabah saat] LT",nextWeek:"[gln hft] dddd [saat] LT",lastDay:"[dnn] LT",lastWeek:"[ken hft] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s vvl",s:"birne saniy",ss:"%d saniy",m:"bir dqiq",mm:"%d dqiq",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir il",yy:"%d il"},meridiemParse:/gec|shr|gndz|axam/,isPM:function(e){return/^(gndz|axam)$/.test(e)},meridiem:function(e,t,n){return e<4?"gec":e<12?"shr":e<17?"gndz":"axam"},dayOfMonthOrdinalParse:/\d{1,2}-(nc|inci|nci|nc|nc|uncu)/,ordinal:function(e){if(0===e)return e+"-nc";var n=e%10,i=e%100-n,a=e>=100?100:null;return e+(t[n]||t[i]||t[a])},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t){var n=e.split("_");return t%10==1&&t%100!=11?n[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?n[1]:n[2]}function n(e,n,i){var a={ss:n?"__":"__",mm:n?"__":"__",hh:n?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===i?n?"":"":"h"===i?n?"":"":e+" "+t(a[i],+e)}return e.defineLocale("be",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{format:"______".split("_"),standalone:"______".split("_"),isFormat:/\[ ?[] ?(?:|)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:function(){return"[] dddd [] LT"},lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:n,mm:n,h:n,hh:n,d:"",dd:n,M:"",MM:n,y:"",yy:n},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e%10!=2&&e%10!=3||e%100==12||e%100==13?e+"-":e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("bg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[ ] dddd [] LT";case 1:case 2:case 4:case 5:return"[ ] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,n=e%100;return 0===e?e+"-":0===n?e+"-":n>10&&n<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("bm",{months:"Zanwuyekalo_Fewuruyekalo_Marisikalo_Awirilikalo_Mkalo_Zuwnkalo_Zuluyekalo_Utikalo_Stanburukalo_kutburukalo_Nowanburukalo_Desanburukalo".split("_"),monthsShort:"Zan_Few_Mar_Awi_M_Zuw_Zul_Uti_St_ku_Now_Des".split("_"),weekdays:"Kari_Ntnn_Tarata_Araba_Alamisa_Juma_Sibiri".split("_"),weekdaysShort:"Kar_Nt_Tar_Ara_Ala_Jum_Sib".split("_"),weekdaysMin:"Ka_Nt_Ta_Ar_Al_Ju_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"MMMM [tile] D [san] YYYY",LLL:"MMMM [tile] D [san] YYYY [lr] HH:mm",LLLL:"dddd MMMM [tile] D [san] YYYY [lr] HH:mm"},calendar:{sameDay:"[Bi lr] LT",nextDay:"[Sini lr] LT",nextWeek:"dddd [don lr] LT",lastDay:"[Kunu lr] LT",lastWeek:"dddd [tmnen lr] LT",sameElse:"L"},relativeTime:{future:"%s kn",past:"a b %s b",s:"sanga dama dama",ss:"sekondi %d",m:"miniti kelen",mm:"miniti %d",h:"lr kelen",hh:"lr %d",d:"tile kelen",dd:"tile %d",M:"kalo kelen",MM:"kalo %d",y:"san kelen",yy:"san %d"},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("bn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("bo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[], LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||""===t&&e<5||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n){return e+" "+a({mm:"munutenn",MM:"miz",dd:"devezh"}[n],e)}function n(e){switch(i(e)){case 1:case 3:case 4:case 5:case 9:return e+" bloaz";default:return e+" vloaz"}}function i(e){return e>9?i(e%10):e}function a(e,t){return 2===t?r(e):e}function r(e){var t={m:"v",b:"v",d:"z"};return void 0===t[e.charAt(0)]?e:t[e.charAt(0)]+e.substring(1)}return e.defineLocale("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h[e]mm A",LTS:"h[e]mm:ss A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY h[e]mm A",LLLL:"dddd, D [a viz] MMMM YYYY h[e]mm A"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondenno",ss:"%d eilenn",m:"ur vunutenn",mm:t,h:"un eur",hh:"%d eur",d:"un devezh",dd:t,M:"ur miz",MM:t,y:"ur bloaz",yy:n},dayOfMonthOrdinalParse:/\d{1,2}(a|vet)/,ordinal:function(e){return e+(1===e?"a":"vet")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n){var i=e+" ";switch(n){case"ss":return i+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return i+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return i+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return i+=1===e?"dan":"dana";case"MM":return i+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return i+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}return e.defineLocale("bs",{months:"januar_februar_mart_april_maj_juni_juli_august_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._aug._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ca",{months:{standalone:"gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),format:"de gener_de febrer_de mar_d'abril_de maig_de juny_de juliol_d'agost_de setembre_d'octubre_de novembre_de desembre".split("_"),isFormat:/D[oD]?(\s)+MMMM/},monthsShort:"gen._febr._mar_abr._maig_juny_jul._ag._set._oct._nov._des.".split("_"),monthsParseExact:!0,weekdays:"diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),weekdaysShort:"dg._dl._dt._dc._dj._dv._ds.".split("_"),weekdaysMin:"dg_dl_dt_dc_dj_dv_ds".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",ll:"D MMM YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",lll:"D MMM YYYY, H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",llll:"ddd D MMM YYYY, H:mm"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[dem a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"d'aqu %s",past:"fa %s",s:"uns segons",ss:"%d segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},dayOfMonthOrdinalParse:/\d{1,2}(r|n|t||a)/,ordinal:function(e,t){var n=1===e?"r":2===e?"n":3===e?"r":4===e?"t":"";return"w"!==t&&"W"!==t||(n="a"),e+n},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e){return e>1&&e<5&&1!=~~(e/10)}function n(e,n,i,a){var r=e+" ";switch(i){case"s":return n||a?"pr sekund":"pr sekundami";case"ss":return n||a?r+(t(e)?"sekundy":"sekund"):r+"sekundami";case"m":return n?"minuta":a?"minutu":"minutou";case"mm":return n||a?r+(t(e)?"minuty":"minut"):r+"minutami";case"h":return n?"hodina":a?"hodinu":"hodinou";case"hh":return n||a?r+(t(e)?"hodiny":"hodin"):r+"hodinami";case"d":return n||a?"den":"dnem";case"dd":return n||a?r+(t(e)?"dny":"dn"):r+"dny";case"M":return n||a?"msc":"mscem";case"MM":return n||a?r+(t(e)?"msce":"msc"):r+"msci";case"y":return n||a?"rok":"rokem";case"yy":return n||a?r+(t(e)?"roky":"let"):r+"lety"}}var i="leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"),a="led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_"),r=[/^led/i,/^no/i,/^be/i,/^dub/i,/^kv/i,/^(vn|erven$|ervna)/i,/^(vc|ervenec|ervence)/i,/^srp/i,/^z/i,/^j/i,/^lis/i,/^pro/i],o=/^(leden|nor|bezen|duben|kvten|ervenec|ervence|erven|ervna|srpen|z|jen|listopad|prosinec|led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i;return e.defineLocale("cs",{months:i,monthsShort:a,monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(leden|ledna|nora|nor|bezen|bezna|duben|dubna|kvten|kvtna|ervenec|ervence|erven|ervna|srpen|srpna|z|jen|jna|listopadu|listopad|prosinec|prosince)/i,monthsShortStrictRegex:/^(led|no|be|dub|kv|vn|vc|srp|z|j|lis|pro)/i,monthsParse:r,longMonthsParse:r,shortMonthsParse:r,weekdays:"nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),weekdaysShort:"ne_po_t_st_t_p_so".split("_"),weekdaysMin:"ne_po_t_st_t_p_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm",l:"D. M. YYYY"},calendar:{sameDay:"[dnes v] LT",nextDay:"[ztra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve stedu v] LT";case 4:return"[ve tvrtek v] LT";case 5:return"[v ptek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[vera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou nedli v] LT";case 1:case 2:return"[minul] dddd [v] LT";case 3:return"[minulou stedu v] LT";case 4:case 5:return"[minul] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"ped %s",s:n,ss:n,m:n,mm:n,h:n,hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("cv",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"YYYY [] MMMM [] D[-]",LLL:"YYYY [] MMMM [] D[-], HH:mm",LLLL:"dddd, YYYY [] MMMM [] D[-], HH:mm"},calendar:{sameDay:"[] LT []",nextDay:"[] LT []",lastDay:"[] LT []",nextWeek:"[] dddd LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:function(e){return e+(/$/i.exec(e)?"":/$/i.exec(e)?"":"")},past:"%s ",s:"- ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-/,ordinal:"%d-",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn l",s:"ychydig eiliadau",ss:"%d eiliad",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},dayOfMonthOrdinalParse:/\d{1,2}(fed|ain|af|il|ydd|ed|eg)/,ordinal:function(e){var t=e,n="",i=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return t>20?n=40===t||50===t||60===t||80===t||100===t?"fed":"ain":t>0&&(n=i[t]),e+n},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_man_tir_ons_tor_fre_lr".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd [d.] D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"p dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[i] dddd[s kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"f sekunder",ss:"%d sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en mned",MM:"%d mneder",y:"et r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?a[n][0]:a[n][1]}return e.defineLocale("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?a[n][0]:a[n][1]}return e.defineLocale("de-at",{months:"Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jn._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?a[n][0]:a[n][1]}return e.defineLocale("de-ch",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._Mrz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:t,mm:"%d Minuten",h:t,hh:"%d Stunden",d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t=["","","","","","","","","","","",""],n=["","","","","","",""];return e.defineLocale("dv",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"D/M/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:"",ss:"d% ",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:7,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}return e.defineLocale("el",{monthsNominativeEl:"___________".split("_"),monthsGenitiveEl:"___________".split("_"),months:function(e,t){return e?"string"==typeof t&&/D/.test(t.substring(0,t.indexOf("MMMM")))?this._monthsGenitiveEl[e.month()]:this._monthsNominativeEl[e.month()]:this._monthsNominativeEl},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),meridiem:function(e,t,n){return e>11?n?"":"":n?"":""},isPM:function(e){return""===(e+"").toLowerCase()[0]},meridiemParse:/[]\.??\.?/i,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendarEl:{sameDay:"[ {}] LT",nextDay:"[ {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[ {}] LT",lastWeek:function(){switch(this.day()){case 6:return"[ ] dddd [{}] LT";default:return"[ ] dddd [{}] LT"}},sameElse:"L"},calendar:function(e,n){var i=this._calendarEl[e],a=n&&n.hours();return t(i)&&(i=i.apply(n)),i.replace("{}",a%12==1?"":"")},relativeTime:{future:" %s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-SG",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"YYYY-MM-DD",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-ie",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-il",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("en-nz",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_agusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_ag_sep_okt_nov_dec".split("_"),weekdays:"dimano_lundo_mardo_merkredo_ado_vendredo_sabato".split("_"),weekdaysShort:"dim_lun_mard_merk_a_ven_sab".split("_"),weekdaysMin:"di_lu_ma_me_a_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D[-a de] MMMM, YYYY",LLL:"D[-a de] MMMM, YYYY HH:mm",LLLL:"dddd, [la] D[-a de] MMMM, YYYY HH:mm"},meridiemParse:/[ap]\.t\.m/i,isPM:function(e){return"p"===e.charAt(0).toLowerCase()},meridiem:function(e,t,n){return e>11?n?"p.t.m.":"P.T.M.":n?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodia je] LT",nextDay:"[Morga je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hiera je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"post %s",past:"anta %s",s:"sekundoj",ss:"%d sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},dayOfMonthOrdinalParse:/\d{1,2}a/,ordinal:"%da",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],a=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;return e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],a=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;return e.defineLocale("es-do",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),i=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],a=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i;return e.defineLocale("es-us",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY h:mm A",LLLL:"dddd, D [de] MMMM [de] YYYY h:mm A"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={s:["mne sekundi","mni sekund","paar sekundit"],ss:[e+"sekundi",e+"sekundit"],m:["he minuti","ks minut"],mm:[e+" minuti",e+" minutit"],h:["he tunni","tund aega","ks tund"],hh:[e+" tunni",e+" tundi"],d:["he peva","ks pev"],M:["kuu aja","kuu aega","ks kuu"],MM:[e+" kuu",e+" kuud"],y:["he aasta","aasta","ks aasta"],yy:[e+" aasta",e+" aastat"]};return t?a[n][2]?a[n][2]:a[n][1]:i?a[n][0]:a[n][1]}return e.defineLocale("et",{months:"jaanuar_veebruar_mrts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_mrts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"phapev_esmaspev_teisipev_kolmapev_neljapev_reede_laupev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[Tna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Jrgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s prast",past:"%s tagasi",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:"%d peva",M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),monthsParseExact:!0,weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] HH:mm",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] HH:mm",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] HH:mm",llll:"ddd, YYYY[ko] MMM D[a] HH:mm"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",ss:"%d segundo",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("fa",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/  |  /,isPM:function(e){return/  /.test(e)},meridiem:function(e,t,n){return e<12?"  ":"  "},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:" d%",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[-]/g,function(e){return n[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,i,a){var r="";switch(i){case"s":return a?"muutaman sekunnin":"muutama sekunti";case"ss":return a?"sekunnin":"sekuntia";case"m":return a?"minuutin":"minuutti";case"mm":r=a?"minuutin":"minuuttia";break;case"h":return a?"tunnin":"tunti";case"hh":r=a?"tunnin":"tuntia";break;case"d":return a?"pivn":"piv";case"dd":r=a?"pivn":"piv";break;case"M":return a?"kuukauden":"kuukausi";case"MM":r=a?"kuukauden":"kuukautta";break;case"y":return a?"vuoden":"vuosi";case"yy":r=a?"vuoden":"vuotta"}return r=n(e,a)+" "+r}function n(e,t){return e<10?t?a[e]:i[e]:e}var i="nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "),a=["nolla","yhden","kahden","kolmen","neljn","viiden","kuuden",i[7],i[8],i[9]];return e.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] HH.mm",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] HH.mm",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] HH.mm",llll:"ddd, Do MMM YYYY, [klo] HH.mm"},calendar:{sameDay:"[tnn] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s pst",past:"%s sitten",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("fo",{months:"januar_februar_mars_aprl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mnadagur_tsdagur_mikudagur_hsdagur_frggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mn_ts_mik_hs_fr_ley".split("_"),weekdaysMin:"su_m_t_mi_h_fr_le".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D. MMMM, YYYY HH:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gjr kl.] LT",lastWeek:"[sstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s sani",s:"f sekund",ss:"%d sekundir",m:"ein minuttur",mm:"%d minuttir",h:"ein tmi",hh:"%d tmar",d:"ein dagur",dd:"%d dagar",M:"ein mnaur",MM:"%d mnair",y:"eitt r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("fr-ca",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("fr-ch",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourdhui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|e)/,ordinal:function(e,t){switch(t){default:case"M":case"Q":case"D":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t="jan._feb._mrt._apr._mai_jun._jul._aug._sep._okt._nov._des.".split("_"),n="jan_feb_mrt_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_");return e.defineLocale("fy",{months:"jannewaris_febrewaris_maart_april_maaie_juny_july_augustus_septimber_oktober_novimber_desimber".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsParseExact:!0,weekdays:"snein_moandei_tiisdei_woansdei_tongersdei_freed_sneon".split("_"),weekdaysShort:"si._mo._ti._wo._to._fr._so.".split("_"),weekdaysMin:"Si_Mo_Ti_Wo_To_Fr_So".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[hjoed om] LT",nextDay:"[moarn om] LT",nextWeek:"dddd [om] LT",lastDay:"[juster om] LT",lastWeek:"[frne] dddd [om] LT",sameElse:"L"},relativeTime:{future:"oer %s",past:"%s lyn",s:"in pear sekonden",ss:"%d sekonden",m:"ien mint",mm:"%d minuten",h:"ien oere",hh:"%d oeren",d:"ien dei",dd:"%d dagen",M:"ien moanne",MM:"%d moannen",y:"ien jier",yy:"%d jierren"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t=["Eanir","Feabhra","Mrta","Aibren","Bealtaine","Mitheamh","Iil","Lnasa","Men Fmhair","Deaireadh Fmhair","Samhain","Nollaig"],n=["Ean","Feab","Mrt","Aibr","Beal","Mit","Iil","Lna","Men","Deai","Samh","Noll"],i=["D Domhnaigh","D Luain","D Mirt","D Cadaoin","Dardaoin","D hAoine","D Satharn"],a=["Dom","Lua","Mi","Ca","Da","hAo","Sat"],r=["Do","Lu","M","Ce","D","hA","Sa"];return e.defineLocale("ga",{months:t,monthsShort:n,monthsParseExact:!0,weekdays:i,weekdaysShort:a,weekdaysMin:r,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Inniu ag] LT",nextDay:"[Amrach ag] LT",nextWeek:"dddd [ag] LT",lastDay:"[Inn aig] LT",lastWeek:"dddd [seo caite] [ag] LT",sameElse:"L"},relativeTime:{future:"i %s",past:"%s  shin",s:"cpla soicind",ss:"%d soicind",m:"nimad",mm:"%d nimad",h:"uair an chloig",hh:"%d uair an chloig",d:"l",dd:"%d l",M:"m",MM:"%d m",y:"bliain",yy:"%d bliain"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t=["Am Faoilleach","An Gearran","Am Mrt","An Giblean","An Citean","An t-gmhios","An t-Iuchar","An Lnastal","An t-Sultain","An Dmhair","An t-Samhain","An Dbhlachd"],n=["Faoi","Gear","Mrt","Gibl","Cit","gmh","Iuch","Ln","Sult","Dmh","Samh","Dbh"],i=["Didmhnaich","Diluain","Dimirt","Diciadain","Diardaoin","Dihaoine","Disathairne"],a=["Did","Dil","Dim","Dic","Dia","Dih","Dis"],r=["D","Lu","M","Ci","Ar","Ha","Sa"];return e.defineLocale("gd",{months:t,monthsShort:n,monthsParseExact:!0,weekdays:i,weekdaysShort:a,weekdaysMin:r,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[An-diugh aig] LT",nextDay:"[A-mireach aig] LT",nextWeek:"dddd [aig] LT",lastDay:"[An-d aig] LT",lastWeek:"dddd [seo chaidh] [aig] LT",sameElse:"L"},relativeTime:{future:"ann an %s",past:"bho chionn %s",s:"beagan diogan",ss:"%d diogan",m:"mionaid",mm:"%d mionaidean",h:"uair",hh:"%d uairean",d:"latha",dd:"%d latha",M:"mos",MM:"%d mosan",y:"bliadhna",yy:"%d bliadhna"},dayOfMonthOrdinalParse:/\d{1,2}(d|na|mh)/,ordinal:function(e){return e+(1===e?"d":e%10==2?"na":"mh")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("gl",{months:"xaneiro_febreiro_marzo_abril_maio_xuo_xullo_agosto_setembro_outubro_novembro_decembro".split("_"),monthsShort:"xan._feb._mar._abr._mai._xu._xul._ago._set._out._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"domingo_luns_martes_mrcores_xoves_venres_sbado".split("_"),weekdaysShort:"dom._lun._mar._mr._xov._ven._sb.".split("_"),weekdaysMin:"do_lu_ma_m_xo_ve_s".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[ma "+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"s":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"s":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(e){return 0===e.indexOf("un")?"n"+e:"en "+e},past:"hai %s",s:"uns segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={s:["thodde secondanim","thodde second"],ss:[e+" secondanim",e+" second"],m:["eka mintan","ek minute"],mm:[e+" mintanim",e+" mintam"],h:["eka voran","ek vor"],hh:[e+" voranim",e+" voram"],d:["eka disan","ek dis"],dd:[e+" disanim",e+" dis"],M:["eka mhoinean","ek mhoino"],MM:[e+" mhoineanim",e+" mhoine"],y:["eka vorsan","ek voros"],yy:[e+" vorsanim",e+" vorsam"]};return t?a[n][0]:a[n][1]}return e.defineLocale("gom-latn",{months:"Janer_Febrer_Mars_Abril_Mai_Jun_Julai_Agost_Setembr_Otubr_Novembr_Dezembr".split("_"),monthsShort:"Jan._Feb._Mars_Abr._Mai_Jun_Jul._Ago._Set._Otu._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Aitar_Somar_Mongllar_Budvar_Brestar_Sukrar_Son'var".split("_"),weekdaysShort:"Ait._Som._Mon._Bud._Bre._Suk._Son.".split("_"),weekdaysMin:"Ai_Sm_Mo_Bu_Br_Su_Sn".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm [vazta]",LTS:"A h:mm:ss [vazta]",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY A h:mm [vazta]",LLLL:"dddd, MMMM[achea] Do, YYYY, A h:mm [vazta]",llll:"ddd, D MMM YYYY, A h:mm [vazta]"},calendar:{sameDay:"[Aiz] LT",nextDay:"[Faleam] LT",nextWeek:"[Ieta to] dddd[,] LT",lastDay:"[Kal] LT",lastWeek:"[Fatlo] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s adim",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}(er)/,ordinal:function(e,t){switch(t){case"D":return e+"er";default:case"M":case"Q":case"DDD":case"d":case"w":case"W":return e}},week:{dow:1,doy:4},meridiemParse:/rati|sokalli|donparam|sanje/,meridiemHour:function(e,t){return 12===e&&(e=0),"rati"===t?e<4?e:e+12:"sokalli"===t?e:"donparam"===t?e>12?e:e+12:"sanje"===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"rati":e<12?"sokalli":e<16?"donparam":e<20?"sanje":"rati"}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("gu",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("he",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D []MMMM YYYY",LLL:"D []MMMM YYYY HH:mm",LLLL:"dddd, D []MMMM YYYY HH:mm",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[ ]LT",nextDay:"[ ]LT",nextWeek:"dddd [] LT",lastDay:"[ ]LT",lastWeek:"[] dddd [ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:function(e){return 2===e?"":e+" "},d:"",dd:function(e){return 2===e?"":e+" "},M:"",MM:function(e){return 2===e?"":e+" "},y:"",yy:function(e){return 2===e?"":e%10==0&&10!==e?e+" ":e+" "}},meridiemParse:/"|"| | | ||/i,isPM:function(e){return/^("| |)$/.test(e)},meridiem:function(e,t,n){return e<5?" ":e<10?"":e<12?n?'"':" ":e<18?n?'"':" ":""}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("hi",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n){var i=e+" ";switch(n){case"ss":return i+=1===e?"sekunda":2===e||3===e||4===e?"sekunde":"sekundi";case"m":return t?"jedna minuta":"jedne minute";case"mm":return i+=1===e?"minuta":2===e||3===e||4===e?"minute":"minuta";case"h":return t?"jedan sat":"jednog sata";case"hh":return i+=1===e?"sat":2===e||3===e||4===e?"sata":"sati";case"dd":return i+=1===e?"dan":"dana";case"MM":return i+=1===e?"mjesec":2===e||3===e||4===e?"mjeseca":"mjeseci";case"yy":return i+=1===e?"godina":2===e||3===e||4===e?"godine":"godina"}}return e.defineLocale("hr",{months:{format:"sijenja_veljae_oujka_travnja_svibnja_lipnja_srpnja_kolovoza_rujna_listopada_studenoga_prosinca".split("_"),standalone:"sijeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_")},monthsShort:"sij._velj._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[juer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prolu] dddd [u] LT";case 6:return"[prole] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[proli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",ss:t,m:t,mm:t,h:t,hh:t,d:"dan",dd:t,M:"mjesec",MM:t,y:"godinu",yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a=e;switch(n){case"s":return i||t?"nhny msodperc":"nhny msodperce";case"ss":return a+(i||t)?" msodperc":" msodperce";case"m":return"egy"+(i||t?" perc":" perce");case"mm":return a+(i||t?" perc":" perce");case"h":return"egy"+(i||t?" ra":" rja");case"hh":return a+(i||t?" ra":" rja");case"d":return"egy"+(i||t?" nap":" napja");case"dd":return a+(i||t?" nap":" napja");case"M":return"egy"+(i||t?" hnap":" hnapja");case"MM":return a+(i||t?" hnap":" hnapja");case"y":return"egy"+(i||t?" v":" ve");case"yy":return a+(i||t?" v":" ve")}return""}function n(e){return(e?"":"[mlt] ")+"["+i[this.day()]+"] LT[-kor]"}var i="vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");return e.defineLocale("hu",{months:"janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),monthsShort:"jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),weekdaysShort:"vas_ht_kedd_sze_cst_pn_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D. H:mm",LLLL:"YYYY. MMMM D., dddd H:mm"},meridiemParse:/de|du/i,isPM:function(e){return"u"===e.charAt(1).toLowerCase()},meridiem:function(e,t,n){return e<12?!0===n?"de":"DE":!0===n?"du":"DU"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return n.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return n.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s mlva",past:"%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("hy-am",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",lastDay:"[] LT",nextWeek:function(){return"dddd [ ] LT"},lastWeek:function(){return"[] dddd [ ] LT"},sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}|\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"DDD":case"w":case"W":case"DDDo":return 1===e?e+"-":e+"-";default:return e}},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"siang"===t?e>=11?e:e+12:"sore"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"siang":e<19?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",ss:"%d detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e){return e%100==11||e%10!=1}function n(e,n,i,a){var r=e+" ";switch(i){case"s":return n||a?"nokkrar sekndur":"nokkrum sekndum";case"ss":return t(e)?r+(n||a?"sekndur":"sekndum"):r+"seknda";case"m":return n?"mnta":"mntu";case"mm":return t(e)?r+(n||a?"mntur":"mntum"):n?r+"mnta":r+"mntu";case"hh":return t(e)?r+(n||a?"klukkustundir":"klukkustundum"):r+"klukkustund";case"d":return n?"dagur":a?"dag":"degi";case"dd":return t(e)?n?r+"dagar":r+(a?"daga":"dgum"):n?r+"dagur":r+(a?"dag":"degi");case"M":return n?"mnuur":a?"mnu":"mnui";case"MM":return t(e)?n?r+"mnuir":r+(a?"mnui":"mnuum"):n?r+"mnuur":r+(a?"mnu":"mnui");case"y":return n||a?"r":"ri";case"yy":return t(e)?r+(n||a?"r":"rum"):r+(n||a?"r":"ri")}}return e.defineLocale("is",{months:"janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),weekdays:"sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),weekdaysShort:"sun_mn_ri_mi_fim_fs_lau".split("_"),weekdaysMin:"Su_M_r_Mi_Fi_F_La".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd, D. MMMM YYYY [kl.] H:mm"},calendar:{sameDay:"[ dag kl.] LT",nextDay:"[ morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[ gr kl.] LT",lastWeek:"[sasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s san",s:n,ss:n,m:n,mm:n,h:"klukkustund",hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("it-ch",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned_marted_mercoled_gioved_venerd_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:function(){switch(this.day()){case 0:return"[la scorsa] dddd [alle] LT";default:return"[lo scorso] dddd [alle] LT"}},sameElse:"L"},relativeTime:{future:function(e){return(/^[0-9].+$/.test(e)?"tra":"in")+" "+e},past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ja",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMD dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMD(ddd) HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:function(e){return e.week()<this.week()?"[]dddd LT":"dddd LT"},lastDay:"[] LT",lastWeek:function(e){return this.week()<e.week()?"[]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("jv",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_Nopember_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nop_Des".split("_"),weekdays:"Minggu_Senen_Seloso_Rebu_Kemis_Jemuwah_Septu".split("_"),weekdaysShort:"Min_Sen_Sel_Reb_Kem_Jem_Sep".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sp".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/enjing|siyang|sonten|ndalu/,meridiemHour:function(e,t){return 12===e&&(e=0),"enjing"===t?e:"siyang"===t?e>=11?e:e+12:"sonten"===t||"ndalu"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"enjing":e<15?"siyang":e<19?"sonten":"ndalu"},calendar:{sameDay:"[Dinten puniko pukul] LT",nextDay:"[Mbenjang pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kala wingi pukul] LT",lastWeek:"dddd [kepengker pukul] LT",sameElse:"L"},relativeTime:{future:"wonten ing %s",past:"%s ingkang kepengker",s:"sawetawis detik",ss:"%d detik",m:"setunggal menit",mm:"%d menit",h:"setunggal jam",hh:"%d jam",d:"sedinten",dd:"%d dinten",M:"sewulan",MM:"%d wulan",y:"setaun",yy:"%d taun"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ka",{months:{standalone:"___________".split("_"),format:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/(|)/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[] LT[-]",nextDay:"[] LT[-]",lastDay:"[] LT[-]",nextWeek:"[] dddd LT[-]",lastWeek:"[] dddd LT-",sameElse:"L"},relativeTime:{future:function(e){return/(|||)/.test(e)?e.replace(/$/,""):e+""},past:function(e){return/(||||)/.test(e)?e.replace(/(|)$/," ")://.test(e)?e.replace(/$/," "):void 0},s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/0|1-|-\d{1,2}|\d{1,2}-/,ordinal:function(e){return 0===e?e:1===e?e+"-":e<20||e<=100&&e%20==0||e%100==0?"-"+e:e+"-"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};return e.defineLocale("kk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){var n=e%10,i=e>=100?100:null;return e+(t[e]||t[n]||t[i])},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("km",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("kn",{months:"___________".split("_"),monthsShort:"___________".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},dayOfMonthOrdinalParse:/\d{1,2}()/,ordinal:function(e){return e+""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ko",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY MMMM D",LLL:"YYYY MMMM D A h:mm",LLLL:"YYYY MMMM D dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY MMMM D",lll:"YYYY MMMM D A h:mm",llll:"YYYY MMMM D dddd A h:mm"},calendar:{sameDay:" LT",nextDay:" LT",nextWeek:"dddd LT",lastDay:" LT",lastWeek:" dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d",m:"1",mm:"%d",h:" ",hh:"%d",d:"",dd:"%d",M:" ",MM:"%d",y:" ",yy:"%d"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"},i=[" ","","","","","","","",""," "," "," "];return e.defineLocale("ku",{months:i,monthsShort:i,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return//.test(e)},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:" ",ss:" %d",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]}).replace(//g,",")},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]}).replace(/,/g,"")},week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};return e.defineLocale("ky",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"[ ] dddd [] [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||)/,ordinal:function(e){var n=e%10,i=e>=100?100:null;return e+(t[e]||t[n]||t[i])},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={m:["eng Minutt","enger Minutt"],h:["eng Stonn","enger Stonn"],d:["een Dag","engem Dag"],M:["ee Mount","engem Mount"],y:["ee Joer","engem Joer"]};return t?a[n][0]:a[n][1]}function n(e){return a(e.substr(0,e.indexOf(" ")))?"a "+e:"an "+e}function i(e){return a(e.substr(0,e.indexOf(" ")))?"viru "+e:"virun "+e}function a(e){if(e=parseInt(e,10),isNaN(e))return!1;if(e<0)return!0;if(e<10)return 4<=e&&e<=7;if(e<100){var t=e%10,n=e/10;return a(0===t?n:t)}if(e<1e4){for(;e>=10;)e/=10;return a(e)}return e/=1e3,a(e)}return e.defineLocale("lb",{months:"Januar_Februar_Merz_Abrll_Mee_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Abr._Mee_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonndeg_Mindeg_Dnschdeg_Mttwoch_Donneschdeg_Freideg_Samschdeg".split("_"),weekdaysShort:"So._M._D._M._Do._Fr._Sa.".split("_"),weekdaysMin:"So_M_D_M_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm [Auer]",LTS:"H:mm:ss [Auer]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm [Auer]",LLLL:"dddd, D. MMMM YYYY H:mm [Auer]"},calendar:{sameDay:"[Haut um] LT",sameElse:"L",nextDay:"[Muer um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gschter um] LT",lastWeek:function(){switch(this.day()){case 2:case 4:return"[Leschten] dddd [um] LT";default:return"[Leschte] dddd [um] LT"}}},relativeTime:{future:n,past:i,s:"e puer Sekonnen",ss:"%d Sekonnen",m:t,mm:"%d Minutten",h:t,hh:"%d Stonnen",d:t,dd:"%d Deeg",M:t,MM:"%d Mint",y:t,yy:"%d Joer"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("lo",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd[] LT",lastDay:"[] LT",lastWeek:"[]dddd[] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},dayOfMonthOrdinalParse:/()\d{1,2}/,ordinal:function(e){return""+e}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){return t?"kelios sekunds":i?"keli sekundi":"kelias sekundes"}function n(e,t,n,i){return t?a(n)[0]:i?a(n)[1]:a(n)[2]}function i(e){return e%10==0||e>10&&e<20}function a(e){return o[e].split("_")}function r(e,t,r,o){var s=e+" ";return 1===e?s+n(e,t,r[0],o):t?s+(i(e)?a(r)[1]:a(r)[0]):o?s+a(r)[1]:s+(i(e)?a(r)[1]:a(r)[2])}var o={ss:"sekund_sekundi_sekundes",m:"minut_minuts_minut",mm:"minuts_minui_minutes",h:"valanda_valandos_valand",hh:"valandos_valand_valandas",d:"diena_dienos_dien",dd:"dienos_dien_dienas",M:"mnuo_mnesio_mnes",MM:"mnesiai_mnesi_mnesius",y:"metai_met_metus",yy:"metai_met_metus"};return e.defineLocale("lt",{months:{format:"sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),standalone:"sausis_vasaris_kovas_balandis_gegu_birelis_liepa_rugpjtis_rugsjis_spalis_lapkritis_gruodis".split("_"),isFormat:/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?|MMMM?(\[[^\[\]]*\]|\s)+D[oD]?/},monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:{format:"sekmadien_pirmadien_antradien_treiadien_ketvirtadien_penktadien_etadien".split("_"),standalone:"sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_"),isFormat:/dddd HH:mm/},weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),weekdaysMin:"S_P_A_T_K_Pn_".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], HH:mm [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, HH:mm [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], HH:mm [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, HH:mm [val.]"},calendar:{sameDay:"[iandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Prajus] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prie %s",s:t,ss:r,m:n,mm:r,h:n,hh:r,d:n,dd:r,M:n,MM:r,y:n,yy:r},dayOfMonthOrdinalParse:/\d{1,2}-oji/,ordinal:function(e){return e+"-oji"},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n){return n?t%10==1&&t%100!=11?e[2]:e[3]:t%10==1&&t%100!=11?e[0]:e[1]}function n(e,n,i){return e+" "+t(r[i],e,n)}function i(e,n,i){return t(r[i],e,n)}function a(e,t){return t?"daas sekundes":"dam sekundm"}var r={ss:"sekundes_sekundm_sekunde_sekundes".split("_"),m:"mintes_mintm_minte_mintes".split("_"),mm:"mintes_mintm_minte_mintes".split("_"),h:"stundas_stundm_stunda_stundas".split("_"),hh:"stundas_stundm_stunda_stundas".split("_"),d:"dienas_dienm_diena_dienas".split("_"),dd:"dienas_dienm_diena_dienas".split("_"),M:"mnea_mneiem_mnesis_mnei".split("_"),MM:"mnea_mneiem_mnesis_mnei".split("_"),y:"gada_gadiem_gads_gadi".split("_"),yy:"gada_gadiem_gads_gadi".split("_")};return e.defineLocale("lv",{months:"janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),weekdays:"svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY.",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, HH:mm",LLLL:"YYYY. [gada] D. MMMM, dddd, HH:mm"},calendar:{sameDay:"[odien pulksten] LT",nextDay:"[Rt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagju] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"pc %s",past:"pirms %s",s:a,ss:n,m:i,mm:n,h:i,hh:n,d:i,dd:n,M:i,MM:n,y:i,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={words:{ss:["sekund","sekunda","sekundi"],m:["jedan minut","jednog minuta"],mm:["minut","minuta","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mjesec","mjeseca","mjeseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,i){var a=t.words[i];return 1===i.length?n?a[0]:a[1]:e+" "+t.correctGrammaticalCase(e,a)}};return e.defineLocale("me",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sjutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedjelje] [u] LT","[prolog] [ponedjeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srijede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mjesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("mi",{months:"Kohi-tte_Hui-tanguru_Pout-te-rangi_Paenga-whwh_Haratua_Pipiri_Hngoingoi_Here-turi-kk_Mahuru_Whiringa--nuku_Whiringa--rangi_Hakihea".split("_"),monthsShort:"Kohi_Hui_Pou_Pae_Hara_Pipi_Hngoi_Here_Mahu_Whi-nu_Whi-ra_Haki".split("_"),monthsRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,3}/i,monthsShortStrictRegex:/(?:['a-z\u0101\u014D\u016B]+\-?){1,2}/i,weekdays:"Rtapu_Mane_Trei_Wenerei_Tite_Paraire_Htarei".split("_"),weekdaysShort:"Ta_Ma_T_We_Ti_Pa_H".split("_"),weekdaysMin:"Ta_Ma_T_We_Ti_Pa_H".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [i] HH:mm",LLLL:"dddd, D MMMM YYYY [i] HH:mm"},calendar:{sameDay:"[i teie mahana, i] LT",nextDay:"[apopo i] LT",nextWeek:"dddd [i] LT",lastDay:"[inanahi i] LT",lastWeek:"dddd [whakamutunga i] LT",sameElse:"L"},relativeTime:{future:"i roto i %s",past:"%s i mua",s:"te hkona ruarua",ss:"%d hkona",m:"he meneti",mm:"%d meneti",h:"te haora",hh:"%d haora",d:"he ra",dd:"%d ra",M:"he marama",MM:"%d marama",y:"he tau",yy:"%d tau"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("mk",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"e_o_____a".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[ ] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[] dddd [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}-(|||||)/,ordinal:function(e){var t=e%10,n=e%100;return 0===e?e+"-":0===n?e+"-":n>10&&n<20?e+"-":1===t?e+"-":2===t?e+"-":7===t||8===t?e+"-":e+"-"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ml",{months:"___________".split("_"),monthsShort:"._._._.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm -",LTS:"A h:mm:ss -",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm -",LLLL:"dddd, D MMMM YYYY, A h:mm -"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|| ||/i,meridiemHour:function(e,t){return 12===e&&(e=0),""===t&&e>=4||" "===t||""===t?e+12:e},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?" ":e<20?"":""}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){switch(n){case"s":return t?" ":" ";case"ss":return e+(t?" ":" ");case"m":case"mm":return e+(t?" ":" ");case"h":case"hh":return e+(t?" ":" ");case"d":case"dd":return e+(t?" ":" ");case"M":case"MM":return e+(t?" ":" ");case"y":case"yy":return e+(t?" ":" ");default:return e}}return e.defineLocale("mn",{months:" _ _ _ _ _ _ _ _ _ _  _  ".split("_"),monthsShort:"1 _2 _3 _4 _5 _6 _7 _8 _9 _10 _11 _12 ".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY  MMMM D",LLL:"YYYY  MMMM D HH:mm",LLLL:"dddd, YYYY  MMMM D HH:mm"},meridiemParse:/|/i,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd LT",lastDay:"[] LT",lastWeek:"[] dddd LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+" ";default:return e}}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a="";if(t)switch(n){case"s":a=" ";break;case"ss":a="%d ";break;case"m":a=" ";break;case"mm":a="%d ";break;case"h":a=" ";break;case"hh":a="%d ";break;case"d":a=" ";break;case"dd":a="%d ";break;case"M":a=" ";break;case"MM":a="%d ";break;case"y":a=" ";break;case"yy":a="%d "}else switch(n){case"s":a=" ";break;case"ss":a="%d ";break;case"m":a=" ";break;case"mm":a="%d ";break;case"h":a=" ";break;case"hh":a="%d ";break;case"d":a=" ";break;case"dd":a="%d ";break;case"M":a=" ";break;case"MM":a="%d ";break;case"y":a=" ";break;case"yy":a="%d "}return a.replace(/%d/i,e)}var n={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},i={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("mr",{months:"___________".split("_"),monthsShort:"._._._._._._._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},preparse:function(e){return e.replace(/[]/g,function(e){return i[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return n[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ms",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|tengahari|petang|malam/,meridiemHour:function(e,t){return 12===e&&(e=0),"pagi"===t?e:"tengahari"===t?e>=11?e:e+12:"petang"===t||"malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?"pagi":e<15?"tengahari":e<19?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",ss:"%d saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("mt",{months:"Jannar_Frar_Marzu_April_Mejju_unju_Lulju_Awwissu_Settembru_Ottubru_Novembru_Diembru".split("_"),monthsShort:"Jan_Fra_Mar_Apr_Mej_un_Lul_Aww_Set_Ott_Nov_Di".split("_"),weekdays:"Il-add_It-Tnejn_It-Tlieta_L-Erbga_Il-amis_Il-imga_Is-Sibt".split("_"),weekdaysShort:"ad_Tne_Tli_Erb_am_im_Sib".split("_"),weekdaysMin:"a_Tn_Tl_Er_a_i_Si".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Illum fil-]LT",nextDay:"[Gada fil-]LT",nextWeek:"dddd [fil-]LT",lastDay:"[Il-biera fil-]LT",lastWeek:"dddd [li gadda] [fil-]LT",sameElse:"L"},relativeTime:{future:"f %s",past:"%s ilu",s:"ftit sekondi",ss:"%d sekondi",m:"minuta",mm:"%d minuti",h:"siega",hh:"%d siegat",d:"urnata",dd:"%d ranet",M:"xahar",MM:"%d xhur",y:"sena",yy:"%d sni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("my",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[.] LT []",nextDay:"[] LT []",nextWeek:"dddd LT []",lastDay:"[.] LT []",lastWeek:"[] dddd LT []",sameElse:"L"},relativeTime:{future:" %s ",past:" %s ",s:".",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d ",M:"",MM:"%d ",y:"",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),monthsParseExact:!0,weekdays:"sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"s._ma._ti._on._to._fr._l.".split("_"),weekdaysMin:"s_ma_ti_on_to_fr_l".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] HH:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i gr kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"noen sekunder",ss:"%d sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en mned",MM:"%d mneder",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("ne",{months:"___________".split("_"),monthsShort:"._.__.___._._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<3?"":e<12?"":e<16?"":e<20?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd[,] LT",lastDay:"[] LT",lastWeek:"[] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),i=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],a=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;return e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),i=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],a=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i;return e.defineLocale("nl-be",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(e,i){return e?/-MMM-/.test(i)?n[e.month()]:t[e.month()]:t},monthsRegex:a,monthsShortRegex:a,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:i,longMonthsParse:i,shortMonthsParse:i,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"n minuut",mm:"%d minuten",h:"n uur",hh:"%d uur",d:"n dag",dd:"%d dagen",M:"n maand",MM:"%d maanden",y:"n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(e){return e+(1===e||8===e||e>=20?"ste":"de")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_mndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mn_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_m_ty_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] H:mm",LLLL:"dddd D. MMMM YYYY [kl.] HH:mm"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I gr klokka] LT",lastWeek:"[Fregande] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s sidan",s:"nokre sekund",ss:"%d sekund",m:"eit minutt",mm:"%d minutt",h:"ein time",hh:"%d timar",d:"ein dag",dd:"%d dagar",M:"ein mnad",MM:"%d mnader",y:"eit r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("pa-in",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm ",LTS:"A h:mm:ss ",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm ",LLLL:"dddd, D MMMM YYYY, A h:mm "},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[] dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function n(e,n,i){var a=e+" ";switch(i){case"ss":return a+(t(e)?"sekundy":"sekund");case"m":return n?"minuta":"minut";case"mm":return a+(t(e)?"minuty":"minut");case"h":return n?"godzina":"godzin";case"hh":return a+(t(e)?"godziny":"godzin");case"MM":return a+(t(e)?"miesice":"miesicy");case"yy":return a+(t(e)?"lata":"lat")}}var i="stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"),a="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");return e.defineLocale("pl",{months:function(e,t){return e?""===t?"("+a[e.month()]+"|"+i[e.month()]+")":/D MMMM/.test(t)?a[e.month()]:i[e.month()]:i},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),weekdays:"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_r_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_r_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W rod o] LT";case 6:return"[W sobot o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz niedziel o] LT";case 3:return"[W zesz rod o] LT";case 6:return"[W zesz sobot o] LT";default:return"[W zeszy] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:n,m:n,mm:n,h:n,hh:n,d:"1 dzie",dd:"%d dni",M:"miesic",MM:n,y:"rok",yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("pt",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("pt-br",{months:"Janeiro_Fevereiro_Maro_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Tera-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sbado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sb".split("_"),weekdaysMin:"Do_2_3_4_5_6_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [s] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [s] HH:mm"},calendar:{sameDay:"[Hoje s] LT",nextDay:"[Amanh s] LT",nextWeek:"dddd [s] LT",lastDay:"[Ontem s] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[ltimo] dddd [s] LT":"[ltima] dddd [s] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"h %s",s:"poucos segundos",ss:"%d segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um ms",MM:"%d meses",y:"um ano",yy:"%d anos"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d"})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n){var i={ss:"secunde",mm:"minute",hh:"ore",dd:"zile",MM:"luni",yy:"ani"},a=" ";return(e%100>=20||e>=100&&e%100==0)&&(a=" de "),e+a+i[n]}return e.defineLocale("ro",{months:"ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),monthsShort:"ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s n urm",s:"cteva secunde",ss:t,m:"un minut",mm:t,h:"o or",hh:t,d:"o zi",dd:t,M:"o lun",MM:t,y:"un an",yy:t},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t){var n=e.split("_");return t%10==1&&t%100!=11?n[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?n[1]:n[2]}function n(e,n,i){var a={ss:n?"__":"__",mm:n?"__":"__",hh:"__",dd:"__",MM:"__",yy:"__"};return"m"===i?n?"":"":e+" "+t(a[i],+e)}var i=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i];return e.defineLocale("ru",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:{format:"._._._.____._._._._.".split("_"),standalone:"._.__.____._._._._.".split("_")},weekdays:{standalone:"______".split("_"),format:"______".split("_"),isFormat:/\[ ?[] ?(?:||)? ?\] ?dddd/},weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),monthsParse:i,longMonthsParse:i,shortMonthsParse:i,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., H:mm",LLLL:"dddd, D MMMM YYYY ., H:mm"},calendar:{sameDay:"[, ] LT",nextDay:"[, ] LT",lastDay:"[, ] LT",nextWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[] dddd, [] LT":"[] dddd, [] LT";switch(this.day()){case 0:return"[ ] dddd, [] LT";case 1:case 2:case 4:return"[ ] dddd, [] LT";case 3:case 5:case 6:return"[ ] dddd, [] LT"}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:n,m:n,mm:n,h:"",hh:n,d:"",dd:n,M:"",MM:n,y:"",yy:n},meridiemParse:/|||/i,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-";case"D":return e+"-";case"w":case"W":return e+"-";default:return e}},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t=["","","","","","","","","","","",""],n=["","","","","","",""];return e.defineLocale("sd",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd [  ] LT",lastDay:"[] LT",lastWeek:"[ ] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("se",{months:"oajagemnnu_guovvamnnu_njukamnnu_cuoomnnu_miessemnnu_geassemnnu_suoidnemnnu_borgemnnu_akamnnu_golggotmnnu_skbmamnnu_juovlamnnu".split("_"),monthsShort:"oj_guov_njuk_cuo_mies_geas_suoi_borg_ak_golg_skb_juov".split("_"),weekdays:"sotnabeaivi_vuossrga_maebrga_gaskavahkku_duorastat_bearjadat_lvvardat".split("_"),weekdaysShort:"sotn_vuos_ma_gask_duor_bear_lv".split("_"),weekdaysMin:"s_v_m_g_d_b_L".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"MMMM D. [b.] YYYY",LLL:"MMMM D. [b.] YYYY [ti.] HH:mm",LLLL:"dddd, MMMM D. [b.] YYYY [ti.] HH:mm"},calendar:{sameDay:"[otne ti] LT",nextDay:"[ihttin ti] LT",nextWeek:"dddd [ti] LT",lastDay:"[ikte ti] LT",lastWeek:"[ovddit] dddd [ti] LT",sameElse:"L"},relativeTime:{future:"%s geaes",past:"mait %s",s:"moadde sekunddat",ss:"%d sekunddat",m:"okta minuhta",mm:"%d minuhtat",h:"okta diimmu",hh:"%d diimmut",d:"okta beaivi",dd:"%d beaivvit",M:"okta mnnu",MM:"%d mnut",y:"okta jahki",yy:"%d jagit"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("si",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"a h:mm",LTS:"a h:mm:ss",L:"YYYY/MM/DD",LL:"YYYY MMMM D",LLL:"YYYY MMMM D, a h:mm",LLLL:"YYYY MMMM D [] dddd, a h:mm:ss"},calendar:{sameDay:"[] LT[]",nextDay:"[] LT[]",nextWeek:"dddd LT[]",lastDay:"[] LT[]",lastWeek:"[] dddd LT[]",sameElse:"L"},relativeTime:{future:"%s",past:"%s ",s:" ",ss:" %d",m:"",mm:" %d",h:"",hh:" %d",d:"",dd:" %d",M:"",MM:" %d",y:"",yy:" %d"},dayOfMonthOrdinalParse:/\d{1,2} /,ordinal:function(e){return e+" "},meridiemParse:/ | |.|../,isPM:function(e){return".."===e||" "===e},meridiem:function(e,t,n){return e>11?n?"..":" ":n?"..":" "}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e){return e>1&&e<5}function n(e,n,i,a){var r=e+" ";switch(i){case"s":return n||a?"pr seknd":"pr sekundami";case"ss":return n||a?r+(t(e)?"sekundy":"seknd"):r+"sekundami";case"m":return n?"minta":a?"mintu":"mintou";case"mm":return n||a?r+(t(e)?"minty":"mint"):r+"mintami";case"h":return n?"hodina":a?"hodinu":"hodinou";case"hh":return n||a?r+(t(e)?"hodiny":"hodn"):r+"hodinami";case"d":return n||a?"de":"dom";case"dd":return n||a?r+(t(e)?"dni":"dn"):r+"dami";case"M":return n||a?"mesiac":"mesiacom";case"MM":return n||a?r+(t(e)?"mesiace":"mesiacov"):r+"mesiacmi";case"y":return n||a?"rok":"rokom";case"yy":return n||a?r+(t(e)?"roky":"rokov"):r+"rokmi"}}var i="janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"),a="jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");return e.defineLocale("sk",{months:i,monthsShort:a,weekdays:"nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_t_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_t_pi_so".split("_"),longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd D. MMMM YYYY H:mm"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo tvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[vera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minul nedeu o] LT";case 1:case 2:return"[minul] dddd [o] LT";case 3:return"[minul stredu o] LT";case 4:case 5:return"[minul] dddd [o] LT";case 6:return"[minul sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:n,ss:n,m:n,mm:n,h:n,hh:n,d:n,dd:n,M:n,MM:n,y:n,yy:n},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a=e+" ";switch(n){case"s":return t||i?"nekaj sekund":"nekaj sekundami";case"ss":return a+=1===e?t?"sekundo":"sekundi":2===e?t||i?"sekundi":"sekundah":e<5?t||i?"sekunde":"sekundah":"sekund";case"m":return t?"ena minuta":"eno minuto";case"mm":return a+=1===e?t?"minuta":"minuto":2===e?t||i?"minuti":"minutama":e<5?t||i?"minute":"minutami":t||i?"minut":"minutami";case"h":return t?"ena ura":"eno uro";case"hh":return a+=1===e?t?"ura":"uro":2===e?t||i?"uri":"urama":e<5?t||i?"ure":"urami":t||i?"ur":"urami";case"d":return t||i?"en dan":"enim dnem";case"dd":return a+=1===e?t||i?"dan":"dnem":2===e?t||i?"dni":"dnevoma":t||i?"dni":"dnevi";case"M":return t||i?"en mesec":"enim mesecem";case"MM":return a+=1===e?t||i?"mesec":"mesecem":2===e?t||i?"meseca":"mesecema":e<5?t||i?"mesece":"meseci":t||i?"mesecev":"meseci";case"y":return t||i?"eno leto":"enim letom";case"yy":return a+=1===e?t||i?"leto":"letom":2===e?t||i?"leti":"letoma":e<5?t||i?"leta":"leti":t||i?"let":"leti"}}return e.defineLocale("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._et._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_e_pe_so".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[veraj ob] LT",lastWeek:function(){switch(this.day()){case 0:return"[prejnjo] [nedeljo] [ob] LT";case 3:return"[prejnjo] [sredo] [ob] LT";case 6:return"[prejnjo] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[prejnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"ez %s",past:"pred %s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nn_Dhj".split("_"),weekdays:"E Diel_E Hn_E Mart_E Mrkur_E Enjte_E Premte_E Shtun".split("_"),weekdaysShort:"Die_Hn_Mar_Mr_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_M_E_P_Sh".split("_"),weekdaysParseExact:!0,meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},meridiem:function(e,t,n){return e<12?"PD":"MD"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Sot n] LT",nextDay:"[Nesr n] LT",nextWeek:"dddd [n] LT",lastDay:"[Dje n] LT",lastWeek:"dddd [e kaluar n] LT",sameElse:"L"},relativeTime:{future:"n %s",past:"%s m par",s:"disa sekonda",ss:"%d sekonda",m:"nj minut",mm:"%d minuta",h:"nj or",hh:"%d or",d:"nj dit",dd:"%d dit",M:"nj muaj",MM:"%d muaj",y:"nj vit",yy:"%d vite"},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={words:{ss:["sekunda","sekunde","sekundi"],m:["jedan minut","jedne minute"],mm:["minut","minute","minuta"],h:["jedan sat","jednog sata"],hh:["sat","sata","sati"],dd:["dan","dana","dana"],MM:["mesec","meseca","meseci"],yy:["godina","godine","godina"]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,i){var a=t.words[i];return 1===i.length?n?a[0]:a[1]:e+" "+t.correctGrammaticalCase(e,a)}};return e.defineLocale("sr",{months:"januar_februar_mart_april_maj_jun_jul_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj_jun_jul_avg._sep._okt._nov._dec.".split("_"),monthsParseExact:!0,weekdays:"nedelja_ponedeljak_utorak_sreda_etvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sre._et._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_e_pe_su".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedelju] [u] LT";case 3:return"[u] [sredu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jue u] LT",lastWeek:function(){return["[prole] [nedelje] [u] LT","[prolog] [ponedeljka] [u] LT","[prolog] [utorka] [u] LT","[prole] [srede] [u] LT","[prolog] [etvrtka] [u] LT","[prolog] [petka] [u] LT","[prole] [subote] [u] LT"][this.day()]},sameElse:"L"},relativeTime:{future:"za %s",past:"pre %s",s:"nekoliko sekundi",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"dan",dd:t.translate,M:"mesec",MM:t.translate,y:"godinu",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={words:{ss:["","",""],m:[" "," "],mm:["","",""],h:[" "," "],hh:["","",""],dd:["","",""],MM:["","",""],yy:["","",""]},correctGrammaticalCase:function(e,t){return 1===e?t[0]:e>=2&&e<=4?t[1]:t[2]},translate:function(e,n,i){var a=t.words[i];return 1===i.length?n?a[0]:a[1]:e+" "+t.correctGrammaticalCase(e,a)}};return e.defineLocale("sr-cyrl",{months:"___________".split("_"),monthsShort:"._._._.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"._._._._._._.".split("_"),weekdaysMin:"______".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY H:mm",LLLL:"dddd, D. MMMM YYYY H:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:function(){switch(this.day()){case 0:return"[] [] [] LT";case 3:return"[] [] [] LT";case 6:return"[] [] [] LT";case 1:case 2:case 4:case 5:return"[] dddd [] LT"}},lastDay:"[ ] LT",lastWeek:function(){return["[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT","[] [] [] LT"][this.day()]},sameElse:"L"},relativeTime:{future:" %s",past:" %s",s:" ",ss:t.translate,m:t.translate,mm:t.translate,h:t.translate,hh:t.translate,d:"",dd:t.translate,M:"",MM:t.translate,y:"",yy:t.translate},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ss",{months:"Bhimbidvwane_Indlovana_Indlov'lenkhulu_Mabasa_Inkhwekhweti_Inhlaba_Kholwane_Ingci_Inyoni_Imphala_Lweti_Ingongoni".split("_"),monthsShort:"Bhi_Ina_Inu_Mab_Ink_Inh_Kho_Igc_Iny_Imp_Lwe_Igo".split("_"),weekdays:"Lisontfo_Umsombuluko_Lesibili_Lesitsatfu_Lesine_Lesihlanu_Umgcibelo".split("_"),weekdaysShort:"Lis_Umb_Lsb_Les_Lsi_Lsh_Umg".split("_"),weekdaysMin:"Li_Us_Lb_Lt_Ls_Lh_Ug".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Namuhla nga] LT",nextDay:"[Kusasa nga] LT",nextWeek:"dddd [nga] LT",lastDay:"[Itolo nga] LT",lastWeek:"dddd [leliphelile] [nga] LT",sameElse:"L"},relativeTime:{future:"nga %s",past:"wenteka nga %s",s:"emizuzwana lomcane",ss:"%d mzuzwana",m:"umzuzu",mm:"%d emizuzu",h:"lihora",hh:"%d emahora",d:"lilanga",dd:"%d emalanga",M:"inyanga",MM:"%d tinyanga",y:"umnyaka",yy:"%d iminyaka"},meridiemParse:/ekuseni|emini|entsambama|ebusuku/,meridiem:function(e,t,n){return e<11?"ekuseni":e<15?"emini":e<19?"entsambama":"ebusuku"},meridiemHour:function(e,t){return 12===e&&(e=0),"ekuseni"===t?e:"emini"===t?e>=11?e:e+12:"entsambama"===t||"ebusuku"===t?0===e?0:e+12:void 0},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),weekdaysShort:"sn_mn_tis_ons_tor_fre_lr".split("_"),weekdaysMin:"s_m_ti_on_to_fr_l".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [kl.] HH:mm",LLLL:"dddd D MMMM YYYY [kl.] HH:mm",lll:"D MMM YYYY HH:mm",llll:"ddd D MMM YYYY HH:mm"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igr] LT",nextWeek:"[P] dddd LT",lastWeek:"[I] dddd[s] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"fr %s sedan",s:"ngra sekunder",ss:"%d sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en mnad",MM:"%d mnader",y:"ett r",yy:"%d r"},dayOfMonthOrdinalParse:/\d{1,2}(e|a)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"e":1===t?"a":2===t?"a":"e")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("sw",{months:"Januari_Februari_Machi_Aprili_Mei_Juni_Julai_Agosti_Septemba_Oktoba_Novemba_Desemba".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ago_Sep_Okt_Nov_Des".split("_"),weekdays:"Jumapili_Jumatatu_Jumanne_Jumatano_Alhamisi_Ijumaa_Jumamosi".split("_"),weekdaysShort:"Jpl_Jtat_Jnne_Jtan_Alh_Ijm_Jmos".split("_"),weekdaysMin:"J2_J3_J4_J5_Al_Ij_J1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[leo saa] LT",nextDay:"[kesho saa] LT",nextWeek:"[wiki ijayo] dddd [saat] LT",lastDay:"[jana] LT",lastWeek:"[wiki iliyopita] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s baadaye",past:"tokea %s",s:"hivi punde",ss:"sekunde %d",m:"dakika moja",mm:"dakika %d",h:"saa limoja",hh:"masaa %d",d:"siku moja",dd:"masiku %d",M:"mwezi mmoja",MM:"miezi %d",y:"mwaka mmoja",yy:"miaka %d"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",0:""},n={"":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0"};return e.defineLocale("ta",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, HH:mm",LLLL:"dddd, D MMMM YYYY, HH:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[ ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:"  ",ss:"%d ",m:" ",mm:"%d ",h:"  ",hh:"%d  ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e+""},preparse:function(e){return e.replace(/[]/g,function(e){return n[e]})},postformat:function(e){return e.replace(/\d/g,function(e){return t[e]})},meridiemParse:/|||||/,meridiem:function(e,t,n){return e<2?" ":e<6?" ":e<10?" ":e<14?" ":e<18?" ":e<22?" ":" "},meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<2?e:e+12:""===t||""===t?e:""===t&&e>=10?e:e+12},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("te",{months:"___________".split("_"),monthsShort:"._.__.____._._._._.".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"A h:mm",LTS:"A h:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, A h:mm",LLLL:"dddd, D MMMM YYYY, A h:mm"},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"dddd, LT",lastDay:"[] LT",lastWeek:"[] dddd, LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d",meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=10?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<10?"":e<17?"":e<20?"":""},week:{dow:0,doy:6}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("tet",{months:"Janeiru_Fevereiru_Marsu_Abril_Maiu_Juu_Jullu_Agustu_Setembru_Outubru_Novembru_Dezembru".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingu_Segunda_Tersa_Kuarta_Kinta_Sesta_Sabadu".split("_"),weekdaysShort:"Dom_Seg_Ters_Kua_Kint_Sest_Sab".split("_"),weekdaysMin:"Do_Seg_Te_Ku_Ki_Ses_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Ohin iha] LT",nextDay:"[Aban iha] LT",nextWeek:"dddd [iha] LT",lastDay:"[Horiseik iha] LT",lastWeek:"dddd [semana kotuk] [iha] LT",sameElse:"L"},relativeTime:{future:"iha %s",past:"%s liuba",s:"minutu balun",ss:"minutu %d",m:"minutu ida",mm:"minutu %d",h:"oras ida",hh:"oras %d",d:"loron ida",dd:"loron %d",M:"fulan ida",MM:"fulan %d",y:"tinan ida",yy:"tinan %d"},dayOfMonthOrdinalParse:/\d{1,2}(st|nd|rd|th)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={0:"-",1:"-",2:"-",3:"-",4:"-",5:"-",6:"-",7:"-",8:"-",9:"-",10:"-",12:"-",13:"-",20:"-",30:"-",40:"-",50:"-",60:"-",70:"-",80:"-",90:"-",100:"-"};return e.defineLocale("tg",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",lastDay:"[ ] LT",nextWeek:"dddd[] [  ] LT",lastWeek:"dddd[] [  ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},meridiemParse:/|||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t?e<4?e:e+12:""===t?e:""===t?e>=11?e:e+12:""===t?e+12:void 0},meridiem:function(e,t,n){return e<4?"":e<11?"":e<16?"":e<19?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e){var n=e%10,i=e>=100?100:null;return e+(t[e]||t[n]||t[i])},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("th",{months:"___________".split("_"),monthsShort:".._.._.._.._.._.._.._.._.._.._.._..".split("_"),monthsParseExact:!0,weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"._._._._._._.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY  H:mm",LLLL:"dddd D MMMM YYYY  H:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd[ ] LT",lastDay:"[ ] LT",lastWeek:"[]dddd[ ] LT",sameElse:"L"},relativeTime:{future:" %s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd, MMMM DD, YYYY HH:mm"},calendar:{sameDay:"LT [ngayong araw]",nextDay:"[Bukas ng] LT",nextWeek:"LT [sa susunod na] dddd",lastDay:"LT [kahapon]",lastWeek:"LT [noong nakaraang] dddd",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",ss:"%d segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e){var t=e;return t=-1!==e.indexOf("jaj")?t.slice(0,-3)+"leS":-1!==e.indexOf("jar")?t.slice(0,-3)+"waQ":-1!==e.indexOf("DIS")?t.slice(0,-3)+"nem":t+" pIq"}function n(e){var t=e;return t=-1!==e.indexOf("jaj")?t.slice(0,-3)+"Hu":-1!==e.indexOf("jar")?t.slice(0,-3)+"wen":-1!==e.indexOf("DIS")?t.slice(0,-3)+"ben":t+" ret"}function i(e,t,n,i){var r=a(e);switch(n){case"ss":return r+" lup";case"mm":return r+" tup";case"hh":return r+" rep";case"dd":return r+" jaj";case"MM":return r+" jar";case"yy":return r+" DIS"}}function a(e){var t=Math.floor(e%1e3/100),n=Math.floor(e%100/10),i=e%10,a="";return t>0&&(a+=r[t]+"vatlh"),n>0&&(a+=(""!==a?" ":"")+r[n]+"maH"),i>0&&(a+=(""!==a?" ":"")+r[i]),""===a?"pagh":a}var r="pagh_wa_cha_wej_loS_vagh_jav_Soch_chorgh_Hut".split("_");return e.defineLocale("tlh",{months:"tera jar wa_tera jar cha_tera jar wej_tera jar loS_tera jar vagh_tera jar jav_tera jar Soch_tera jar chorgh_tera jar Hut_tera jar wamaH_tera jar wamaH wa_tera jar wamaH cha".split("_"),monthsShort:"jar wa_jar cha_jar wej_jar loS_jar vagh_jar jav_jar Soch_jar chorgh_jar Hut_jar wamaH_jar wamaH wa_jar wamaH cha".split("_"),monthsParseExact:!0,weekdays:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysShort:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),weekdaysMin:"lojmItjaj_DaSjaj_povjaj_ghItlhjaj_loghjaj_buqjaj_ghInjaj".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[DaHjaj] LT",nextDay:"[waleS] LT",nextWeek:"LLL",lastDay:"[waHu] LT",lastWeek:"LLL",sameElse:"L"},relativeTime:{future:t,past:n,s:"puS lup",ss:i,m:"wa tup",mm:i,h:"wa rep",hh:i,d:"wa jaj",dd:i,M:"wa jar",MM:i,y:"wa DIS",yy:i},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'nc",4:"'nc",100:"'nc",6:"'nc",9:"'uncu",10:"'uncu",30:"'uncu",60:"'nc",90:"'nc"};return e.defineLocale("tr",{months:"Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),monthsShort:"Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[bugn saat] LT",nextDay:"[yarn saat] LT",nextWeek:"[gelecek] dddd [saat] LT",lastDay:"[dn] LT",lastWeek:"[geen] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s nce",s:"birka saniye",ss:"%d saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gn",dd:"%d gn",M:"bir ay",MM:"%d ay",y:"bir yl",yy:"%d yl"},ordinal:function(e,n){switch(n){case"d":case"D":case"Do":case"DD":return e;default:if(0===e)return e+"'nc";var i=e%10,a=e%100-i,r=e>=100?100:null;return e+(t[i]||t[a]||t[r])}},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t,n,i){var a={s:["viensas secunds","'iensas secunds"],ss:[e+" secunds",e+" secunds"],m:["'n mut","'iens mut"],mm:[e+" muts",e+" muts"],h:["'n ora","'iensa ora"],hh:[e+" oras",e+" oras"],d:["'n ziua","'iensa ziua"],dd:[e+" ziuas",e+" ziuas"],M:["'n mes","'iens mes"],MM:[e+" mesen",e+" mesen"],y:["'n ar","'iens ar"],yy:[e+" ars",e+" ars"]};return i?a[n][0]:t?a[n][0]:a[n][1]}return e.defineLocale("tzl",{months:"Januar_Fevraglh_Mar_Avru_Mai_Gn_Julia_Guscht_Setemvar_Listopts_Noemvar_Zecemvar".split("_"),monthsShort:"Jan_Fev_Mar_Avr_Mai_Gn_Jul_Gus_Set_Lis_Noe_Zec".split("_"),weekdays:"Sladi_Lnei_Maitzi_Mrcuri_Xhadi_Vineri_Sturi".split("_"),weekdaysShort:"Sl_Ln_Mai_Mr_Xh_Vi_St".split("_"),weekdaysMin:"S_L_Ma_M_Xh_Vi_S".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"D. MMMM [dallas] YYYY",LLL:"D. MMMM [dallas] YYYY HH.mm",LLLL:"dddd, [li] D. MMMM [dallas] YYYY HH.mm"},meridiemParse:/d\'o|d\'a/i,isPM:function(e){return"d'o"===e.toLowerCase()},meridiem:function(e,t,n){return e>11?n?"d'o":"D'O":n?"d'a":"D'A"},calendar:{sameDay:"[oxhi ] LT",nextDay:"[dem ] LT",nextWeek:"dddd [] LT",lastDay:"[ieiri ] LT",lastWeek:"[sr el] dddd [lasteu ] LT",sameElse:"L"},relativeTime:{future:"osprei %s",past:"ja%s",s:t,ss:t,m:t,mm:t,h:t,hh:t,d:t,dd:t,M:t,MM:t,y:t,yy:t},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("tzm",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[ ] LT",lastWeek:"dddd [] LT",sameElse:"L"},relativeTime:{future:"   %s",past:" %s",s:"",ss:"%d ",m:"",mm:"%d ",h:"",hh:"%d ",d:"",dd:"%d o",M:"o",MM:"%d ",y:"",yy:"%d "},week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("tzm-latn",{months:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brayr_mars_ibrir_mayyw_ywnyw_ywlywz_wt_wtanbir_ktwbr_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiyas".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",ss:"%d imik",m:"minu",mm:"%d minu",h:"saa",hh:"%d tassain",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("ug-cn",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY-M-D-",LLL:"YYYY-M-D- HH:mm",LLLL:"dddd YYYY-M-D- HH:mm"},meridiemParse:/ || || |/,meridiemHour:function(e,t){return 12===e&&(e=0)," "===t||""===t||" "===t?e:" "===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var i=100*e+t;return i<600?" ":i<900?"":i<1130?" ":i<1230?"":i<1800?" ":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"[] dddd [] LT",lastDay:"[] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},dayOfMonthOrdinalParse:/\d{1,2}(-|-|-)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"-";case"w":case"W":return e+"-";default:return e}},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";function t(e,t){var n=e.split("_");return t%10==1&&t%100!=11?n[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?n[1]:n[2]}function n(e,n,i){var a={ss:n?"__":"__",mm:n?"__":"__",hh:n?"__":"__",dd:"__",MM:"__",yy:"__"};return"m"===i?n?"":"":"h"===i?n?"":"":e+" "+t(a[i],+e)}function i(e,t){var n={nominative:"______".split("_"),accusative:"______".split("_"),genitive:"______".split("_")};return!0===e?n.nominative.slice(1,7).concat(n.nominative.slice(0,1)):e?n[/(\[[]\]) ?dddd/.test(t)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(t)?"genitive":"nominative"][e.day()]:n.nominative}function a(e){return function(){return e+""+(11===this.hours()?"":"")+"] LT"}}return e.defineLocale("uk",{months:{format:"___________".split("_"),standalone:"___________".split("_")},monthsShort:"___________".split("_"),weekdays:i,weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY .",LLL:"D MMMM YYYY ., HH:mm",LLLL:"dddd, D MMMM YYYY ., HH:mm"},calendar:{sameDay:a("[ "),nextDay:a("[ "),lastDay:a("[ "),nextWeek:a("[] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return a("[] dddd [").call(this);case 1:case 2:case 4:return a("[] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:" %s",past:"%s ",s:" ",ss:n,m:n,mm:n,h:"",hh:n,d:"",dd:n,M:"",MM:n,y:"",yy:n},meridiemParse:/|||/,isPM:function(e){return/^(|)$/.test(e)},meridiem:function(e,t,n){return e<4?"":e<12?"":e<17?"":""},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":case"w":case"W":return e+"-";case"D":return e+"-";default:return e}},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";var t=["","","","","","","","","","","",""],n=["","","","","","",""];return e.defineLocale("ur",{months:t,monthsShort:t,weekdays:n,weekdaysShort:n,weekdaysMin:n,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},meridiemParse:/|/,isPM:function(e){return""===e},meridiem:function(e,t,n){return e<12?"":""},calendar:{sameDay:"[ ] LT",nextDay:"[ ] LT",nextWeek:"dddd [] LT",lastDay:"[  ] LT",lastWeek:"[] dddd [] LT",sameElse:"L"},relativeTime:{future:"%s ",past:"%s ",s:" ",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},preparse:function(e){return e.replace(//g,",")},postformat:function(e){return e.replace(/,/g,"")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("uz",{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[ ] LT []",nextDay:"[] LT []",nextWeek:"dddd [ ] LT []",lastDay:"[ ] LT []",lastWeek:"[] dddd [ ] LT []",sameElse:"L"},relativeTime:{future:" %s ",past:"  %s ",s:"",ss:"%d ",m:" ",mm:"%d ",h:" ",hh:"%d ",d:" ",dd:"%d ",M:" ",MM:"%d ",y:" ",yy:"%d "},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("uz-latn",{months:"Yanvar_Fevral_Mart_Aprel_May_Iyun_Iyul_Avgust_Sentabr_Oktabr_Noyabr_Dekabr".split("_"),monthsShort:"Yan_Fev_Mar_Apr_May_Iyun_Iyul_Avg_Sen_Okt_Noy_Dek".split("_"),weekdays:"Yakshanba_Dushanba_Seshanba_Chorshanba_Payshanba_Juma_Shanba".split("_"),weekdaysShort:"Yak_Dush_Sesh_Chor_Pay_Jum_Shan".split("_"),weekdaysMin:"Ya_Du_Se_Cho_Pa_Ju_Sha".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"D MMMM YYYY, dddd HH:mm"},calendar:{sameDay:"[Bugun soat] LT [da]",nextDay:"[Ertaga] LT [da]",nextWeek:"dddd [kuni soat] LT [da]",lastDay:"[Kecha soat] LT [da]",lastWeek:"[O'tgan] dddd [kuni soat] LT [da]",sameElse:"L"},relativeTime:{future:"Yaqin %s ichida",past:"Bir necha %s oldin",s:"soniya",ss:"%d soniya",m:"bir daqiqa",mm:"%d daqiqa",h:"bir soat",hh:"%d soat",d:"bir kun",dd:"%d kun",M:"bir oy",MM:"%d oy",y:"bir yil",yy:"%d yil"},week:{dow:1,doy:7}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("vi",{months:"thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),monthsParseExact:!0,weekdays:"ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysParseExact:!0,meridiemParse:/sa|ch/i,isPM:function(e){return/^ch$/i.test(e)},meridiem:function(e,t,n){return e<12?n?"sa":"SA":n?"ch":"CH"},longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [nm] YYYY",LLL:"D MMMM [nm] YYYY HH:mm",LLLL:"dddd, D MMMM [nm] YYYY HH:mm",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY HH:mm",llll:"ddd, D MMM YYYY HH:mm"},calendar:{sameDay:"[Hm nay lc] LT",nextDay:"[Ngy mai lc] LT",nextWeek:"dddd [tun ti lc] LT",lastDay:"[Hm qua lc] LT",lastWeek:"dddd [tun ri lc] LT",sameElse:"L"},relativeTime:{future:"%s ti",past:"%s trc",s:"vi giy",ss:"%d giy",m:"mt pht",mm:"%d pht",h:"mt gi",hh:"%d gi",d:"mt ngy",dd:"%d ngy",M:"mt thng",MM:"%d thng",y:"mt nm",yy:"%d nm"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(e){return e},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("x-pseudo",{months:"J~~r_F~br~r_~Mrc~h_p~rl_~M_~J~_Jl~_~gst~_Sp~tmb~r_~ctb~r_~vm~br_~Dc~mbr".split("_"),monthsShort:"J~_~Fb_~Mr_~pr_~M_~J_~Jl_~g_~Sp_~ct_~v_~Dc".split("_"),monthsParseExact:!0,weekdays:"S~d~_M~d~_T~sd~_Wd~sd~_T~hrs~d_~Frd~_S~tr~d".split("_"),weekdaysShort:"S~_~M_~T_~Wd_~Th_~Fr_~St".split("_"),weekdaysMin:"S~_M~_T_~W_T~h_Fr~_S".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[T~d~ t] LT",nextDay:"[T~m~rr~w t] LT",nextWeek:"dddd [t] LT",lastDay:"[~st~rd~ t] LT",lastWeek:"[L~st] dddd [t] LT",sameElse:"L"},relativeTime:{future:"~ %s",past:"%s ~g",s:" ~fw ~sc~ds",ss:"%d s~c~ds",m:" ~m~t",mm:"%d m~~ts",h:"~ h~r",hh:"%d h~rs",d:" ~d",dd:"%d d~s",M:" ~m~th",MM:"%d m~t~hs",y:" ~r",yy:"%d ~rs"},dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("yo",{months:"Sr_Erele_rna_Igbe_Ebibi_Okudu_Agmo_Ogun_Owewe_wara_Belu_p".split("_"),monthsShort:"Sr_Erl_rn_Igb_Ebi_Oku_Ag_Ogu_Owe_wa_Bel_p".split("_"),weekdays:"Aiku_Aje_Isgun_jru_jb_ti_Abamta".split("_"),weekdaysShort:"Aik_Aje_Is_jr_jb_ti_Aba".split("_"),weekdaysMin:"Ai_Aj_Is_r_b_t_Ab".split("_"),longDateFormat:{LT:"h:mm A",LTS:"h:mm:ss A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY h:mm A",LLLL:"dddd, D MMMM YYYY h:mm A"},calendar:{sameDay:"[Oni ni] LT",nextDay:"[la ni] LT",nextWeek:"dddd [s ton'b] [ni] LT",lastDay:"[Ana ni] LT",lastWeek:"dddd [s tol] [ni] LT",sameElse:"L"},relativeTime:{future:"ni %s",past:"%s kja",s:"isju aaya die",ss:"aaya %d",m:"isju kan",mm:"isju %d",h:"wakati kan",hh:"wakati %d",d:"j kan",dd:"j %d",M:"osu kan",MM:"osu %d",y:"dun kan",yy:"dun %d"},dayOfMonthOrdinalParse:/j\s\d{1,2}/,ordinal:"j %d",week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("zh-cn",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t||""===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1130?"":i<1230?"":i<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},week:{dow:1,doy:4}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("zh-hk",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1130?"":i<1230?"":i<1800?"":""},calendar:{sameDay:"[]LT",nextDay:"[]LT",nextWeek:"[]ddddLT",lastDay:"[]LT",lastWeek:"[]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})})},function(e,t,n){!function(e,t){t(n(8))}(0,function(e){"use strict";return e.defineLocale("zh-tw",{months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMD HH:mm",LLLL:"YYYYMDdddd HH:mm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},meridiemParse:/|||||/,meridiemHour:function(e,t){return 12===e&&(e=0),""===t||""===t||""===t?e:""===t?e>=11?e:e+12:""===t||""===t?e+12:void 0},meridiem:function(e,t,n){var i=100*e+t;return i<600?"":i<900?"":i<1130?"":i<1230?"":i<1800?"":""},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(||)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"";case"M":return e+"";case"w":case"W":return e+"";default:return e}},relativeTime:{future:"%s",past:"%s",s:"",ss:"%d ",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "}})})},function(e,t,n){var i,a,r=n(18),o=function(e){return e&&e.__esModule?e:{default:e}}(r);!function(r,s){"object"===(0,o.default)(t)?e.exports=s():(i=s,void 0!==(a="function"==typeof i?i.call(t,n,t,e):i)&&(e.exports=a))}(0,function(){function e(e,t){var n=document.createElement(e||"div"),i=void 0;for(i in t)n[i]=t[i];return n}function t(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var a=["opacity",t,~~(100*e),n,i].join("-"),r=.01+n/i*100,o=Math.max(1-(1-e)/t*(100-r),e),s=u.substring(0,u.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return c[a]||(d.insertRule("@"+l+"keyframes "+a+"{0%{opacity:"+o+"}"+r+"%{opacity:"+e+"}"+(r+.01)+"%{opacity:1}"+(r+t)%100+"%{opacity:"+e+"}100%{opacity:"+o+"}}",d.cssRules.length),c[a]=1),a}function i(e,t){var n=e.style,i=void 0,a=void 0;if(void 0!==n[t])return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),a=0;a<l.length;a++)if(i=l[a]+t,void 0!==n[i])return i}function a(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function o(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function s(e){if(void 0===this)return new s(e);this.opts=r(e||{},s.defaults,_)}var l=["webkit","Moz","ms","O"],c={},u=void 0,d=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),_={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};s.defaults={},r(s.prototype,{spin:function(t){this.stop();var n=this,i=n.opts,r=n.el=a(e(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),s=i.radius+i.length+i.width,l=void 0,c=void 0;if(t&&(t.insertBefore(r,t.firstChild||null),c=o(t),l=o(r),a(r,{left:("auto"==i.left?c.x-l.x+(t.offsetWidth>>1):parseInt(i.left,10)+s)+"px",top:("auto"==i.top?c.y-l.y+(t.offsetHeight>>1):parseInt(i.top,10)+s)+"px"})),r.setAttribute("role","progressbar"),n.lines(r,n.opts),!u){var d=0,_=(i.lines-1)*(1-i.direction)/2,h=void 0,f=i.fps,p=f/i.speed,m=(1-i.opacity)/(p*i.trail/100),v=p/i.lines;!function e(){d++;for(var t=0;t<i.lines;t++)h=Math.max(1-(d+(i.lines-t)*v)%p*m,i.opacity),n.opacity(r,t*i.direction+_,h,i);n.timeout=n.el&&setTimeout(e,~~(1e3/f))}()}return n},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,r){function o(t,n){return a(e(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*s+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var s=0,l=(r.lines-1)*(1-r.direction)/2,c=void 0;s<r.lines;s++)c=a(e(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:u&&n(r.opacity,r.trail,l+s*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&t(c,a(o("#000","0 0 4px #000"),{top:"2px"})),t(i,t(c,o(r.color,"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var h=a(e("group"),{behavior:"url(#default#VML)"});return!i(h,"transform")&&h.adj?function(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}d.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(e,i){function r(){return a(n("group",{coordsize:l+" "+l,coordorigin:-s+" "+-s}),{width:l,height:l})}function o(e,o,l){t(u,t(a(r(),{rotation:360/i.lines*e+"deg",left:~~o}),t(a(n("roundrect",{arcsize:i.corners}),{width:s,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),n("fill",{color:i.color,opacity:i.opacity}),n("stroke",{opacity:0}))))}var s=i.length+i.width,l=2*s,c=2*-(i.width+i.length)+"px",u=a(r(),{position:"absolute",top:c,left:c}),d=void 0;if(i.shadow)for(d=1;d<=i.lines;d++)o(d,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(d=1;d<=i.lines;d++)o(d);return t(e,u)},s.prototype.opacity=function(e,t,n,i){var a=e.firstChild;i=i.shadow&&i.lines||0,a&&t+i<a.childNodes.length&&(a=a.childNodes[t+i],a=a&&a.firstChild,(a=a&&a.firstChild)&&(a.opacity=n))}}():u=i(h,"animation"),s})},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m=n(5).SVMXObject,v=n(5).Event,g=n(5).EventDispatcher,y={name:"com.servicemax.client.sal.impl"};y.Module=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=f.getLoggingService().getLogger("SAL-SERVICE"),e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(p),y.RuntimeMode=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.appInstance="",e.url="/services/data/",e.apexRestUrl="/services/apexrest/",e.soapUrl="/services/Soap/u/",e.apexSoapUrl="/services/Soap/class/",e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"init",value:function(){}},{key:"getUrl",value:function(e,t){}},{key:"getApexRestUrl",value:function(e){}},{key:"adjustHeaders",value:function(e,t,n){}},{key:"adjustApexRestHeaders",value:function(e,t){}},{key:"adjustSoapHeaders",value:function(e,t,n){}},{key:"adjustApexSoapHeaders",value:function(e,t){}},{key:"getSoapUrl",value:function(e,t){}},{key:"getApexSoapUrl",value:function(e){}}]),t}(m),y.VFRuntimeMode=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.proxyUrl="/services/proxy/",e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"init",value:function(){var e=f.getClient().getApplicationParameter("svmx-base-url");e?0!=e.indexOf("/")&&(e="/"+e):e="",this.soapUrl=e+this.soapUrl,this.url=e+this.url,this.proxyUrl=e+this.proxyUrl,this.apexSoapUrl=e+this.apexSoapUrl,this.apexRestUrl=e+this.apexRestUrl;var t=location.hostname.split(".");this.appInstance=(3==t.length?t[0]:t[1])+(6==t.length?"."+t[3]:"")}},{key:"getUrl",value:function(e,t){return this.proxyUrl}},{key:"getApexRestUrl",value:function(e){return this.proxyUrl}},{key:"adjustHeaders",value:function(e,t,n){e["SalesforceProxy-Endpoint"]="https://"+this.appInstance+".salesforce.com"+this.url+n+"/"+t.url}},{key:"adjustApexRestHeaders",value:function(e,t){e["SalesforceProxy-Endpoint"]="https://"+this.appInstance+".salesforce.com"+this.apexRestUrl+t.url}},{key:"adjustSoapHeaders",value:function(e,t,n){}},{key:"adjustApexSoapHeaders",value:function(e,t){}},{key:"getSoapUrl",value:function(e,t){return this.soapUrl+t+"/"+e}},{key:"getApexSoapUrl",value:function(e){return this.apexSoapUrl+e}}]),t}(y.RuntimeMode),y.SARuntimeMode=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"init",value:function(){}},{key:"getUrl",value:function(e,t){return this.__getInstanceUrl()+this.url+e}},{key:"getApexRestUrl",value:function(e){return this.__getInstanceUrl()+this.apexRestUrl+e}},{key:"__getInstanceUrl",value:function(){return f.getClient().getApplicationParameter("api-instance-url")}},{key:"adjustSoapHeaders",value:function(e,t,n){}},{key:"adjustApexSoapHeaders",value:function(e,t){}},{key:"getSoapUrl",value:function(e,t){}},{key:"getApexSoapUrl",value:function(e){}}]),t}(y.RuntimeMode),y.RPRuntimeMode=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"init",value:function(){}},{key:"getUrl",value:function(e,t){return this.url+t+"/"+e}},{key:"getApexRestUrl",value:function(e){return this.apexRestUrl+e}},{key:"adjustHeaders",value:function(e,t,n){}},{key:"adjustApexRestHeaders",value:function(e,t){}},{key:"adjustSoapHeaders",value:function(e,t,n){}},{key:"adjustApexSoapHeaders",value:function(e,t){}},{key:"getSoapUrl",value:function(e,t){return this.soapUrl+t+"/"+e}},{key:"getApexSoapUrl",value:function(e){return this.apexSoapUrl+e}}]),t}(y.RuntimeMode),y.SAL=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,null,[{key:"init",value:function(){if(!y.SAL.initialized){y.SAL.initialized=!0;var e=f.getClient().getApplicationParameter("sal-service-runtime-mode"),t=null;if("VISUAL_FORCE"==e)t=new y.VFRuntimeMode;else if("STAND_ALONE"==e)t=new y.SARuntimeMode;else{if("REMOTE_PROXY"!=e)throw new Error("Please specify a runtime mode!");t=new y.RPRuntimeMode}t.init(),y.SAL.rtMode=t}}}]),t}(m),y.SAL.rtMode=null,y.SAL.initialized=!1,y.RestRequestEvent=function(e){function t(e,n,i){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i))}return(0,h.default)(t,e),t}(v),y.SoapRequestEvent=function(e){function t(e,n,i){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i))}return(0,h.default)(t,e),t}(v),y.RestRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n._options=e,n._baseURL="",n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callAsync",value:function(e){e||(e={}),e.headers||(e.headers={});var t=!0;void 0!=e.async&&(t=e.async),this._appendAuthToken(e.headers);var n=this._getUrl(e.url),i=e.method?e.method:"GET",a=e.responseType?e.responseType:"json";this._adjustEndpoint(e.headers,e);var r="";return e.data&&("string"==typeof e.data?r=e.data:(r=f.toJSON(e.data),"GET"==i&&(r="getParams="+r))),f.ajax({type:i,contentType:e.contentType?e.contentType:"application/json",dataType:a,data:r,url:n,context:this,async:t,headers:e.headers,success:function(e,t,n){var i=e;"json"==a&&(i=f.toObject(e)),this._callAsyncSuccess(i,t)},error:function(e,t,n){this._callAsyncError(e,t,n)}})}},{key:"_callAsyncSuccess",value:function(e,t,n){e=this._processDataOnLoad(e);var i=new y.RestRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(i)}},{key:"_appendAuthToken",value:function(e){e.Authorization="OAuth "+this._options.sessionId}},{key:"_adjustEndpoint",value:function(e,t){y.SAL.rtMode.adjustHeaders(t.headers,t,this._options.apiVersion)}},{key:"_getUrl",value:function(e){return y.SAL.rtMode.getUrl(e,this._options.apiVersion)}},{key:"_callAsyncError",value:function(e,t,n){var i=new y.RestRequestEvent("REQUEST_ERROR",this,{e:n,status:t,xhr:e});this.triggerEvent(i)}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(g),y.ApexRestRequest=function(e){function t(e){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"_adjustEndpoint",value:function(e,t){y.SAL.rtMode.adjustApexRestHeaders(t.headers,t)}},{key:"_getUrl",value:function(e){return y.SAL.rtMode.getApexRestUrl(e)}}]),t}(y.RestRequest),y.SoapRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n._options=e,n._requestTemplate='<se:Envelope xmlns:se="http://schemas.xmlsoap.org/soap/envelope/"><se:Header xmlns:sfns="urn:partner.soap.sforce.com"><sfns:SessionHeader><sessionId>{0}</sessionId></sfns:SessionHeader></se:Header><se:Body><{1} xmlns="urn:partner.soap.sforce.com" xmlns:ns1="sobject.partner.soap.sforce.com">{2}</{1}></se:Body></se:Envelope>',n._baseURL="",n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callAsync",value:function(e){e||(e={}),e.headers||(e.headers={});var t=!0;void 0!=e.async&&(t=e.async),this._setupHeaders(e.headers,e);var n=this._getUrl(e.url),i=this._getData(e.data,e);f.ajax({type:"POST",contentType:"text/xml",dataType:"xml",data:i,url:n,context:this,async:t,headers:e.headers,success:function(e,t,n){this._callAsyncSuccess(e,t)},error:function(e,t,n){this._callAsyncError(e,t,n)}})}},{key:"_callAsyncSuccess",value:function(e,t,n){e=this._processDataOnLoad(e);var i=new y.SoapRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(i)}},{key:"_getUrl",value:function(e){return y.SAL.rtMode.getSoapUrl(e,this._options.apiVersion)}},{key:"_getData",value:function(e,t){return e=f.toXML(e),e=this._format(this._requestTemplate,this._options.sessionId,t.methodName,e)}},{key:"_getOrgNamespace",value:function(e){return null!=e&&""!=e?e+"/":""}},{key:"_format",value:function(){return f.format(arguments)}},{key:"_callAsyncError",value:function(e,t,n){var i=new y.RestRequestEvent("REQUEST_ERROR",this,{e:n,status:t,xhr:e});this.triggerEvent(i)}},{key:"_setupHeaders",value:function(e,t){e.SOAPAction=t.methodName}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(g),y.AttachmentSoapRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n._options=e,n._requestTemplate="<s:Envelope xmlns:s='http://schemas.xmlsoap.org/soap/envelope/' xmlns='urn:partner.soap.sforce.com'><s:Header><SessionHeader><sessionId>{0}</sessionId></SessionHeader></s:Header><s:Body><create><sobject><type>{1}</type><isPrivate>{2}</isPrivate><ParentId>{3}</ParentId><Name>{4}</Name><Body>{5}</Body></sobject></create></s:Body></s:Envelope>",n._baseURL="",n._recordId=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callAsync",value:function(e){e||(e={}),e.headers||(e.headers={});var t=!0;void 0!=e.async&&(t=e.async),this._setupHeaders(e.headers,e);var n=this._getUrl(e.url),i=this._getData(e.data,e);this._recordId=e.questionId,f.ajax({type:"POST",contentType:"text/xml",dataType:"xml",data:i,url:n,context:this,async:t,headers:e.headers,success:function(e,t,n){this._callAsyncAttachmentSuccess(e,t,n)},error:function(e,t,n){this._callAsyncError(e,t,n)}})}},{key:"_callAsyncAttachmentSuccess",value:function(e,t,n){var i=new DOMParser,a=i.parseFromString(n.responseText,"text/xml"),r="";if(a.getElementsByTagName("id")&&a.getElementsByTagName("id").length>0){var o=a.getElementsByTagName("id")[0];o.childNodes&&o.childNodes.length>0&&(r=o.childNodes[0].nodeValue)}e=this._processDataOnLoad(e),e.attachmentId=r,e.questionId=this._recordId;var s=new y.SoapRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(s)}},{key:"_callAsyncSuccess",value:function(e,t,n){e=this._processDataOnLoad(e);var i=new y.SoapRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(i)}},{key:"_getUrl",value:function(e){return y.SAL.rtMode.getSoapUrl(e,this._options.apiVersion)}},{key:"_getData",value:function(e,t){return e=f.toXML(e),e=this._format(this._requestTemplate,this._options.sessionId,t.type,t.isPrivate,t.ParentId,t.name,t.body)}},{key:"_getOrgNamespace",value:function(e){return null!=e&&""!=e?e+"/":""}},{key:"_format",value:function(){return f.format(arguments)}},{key:"_callAsyncError",value:function(e,t,n){var i=new y.RestRequestEvent("REQUEST_ERROR",this,{e:n,status:t,xhr:e});this.triggerEvent(i)}},{key:"_setupHeaders",value:function(e,t){e.SOAPAction=t.methodName}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(g),y.FileSoapRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));n._options=e;var i=f.OrgNamespace+"__SM_Process_ID__c";return n._requestTemplate="<s:Envelope xmlns:s='http://schemas.xmlsoap.org/soap/envelope/' xmlns='urn:partner.soap.sforce.com'><s:Header><SessionHeader><sessionId>{0}</sessionId></SessionHeader></s:Header><s:Body><create><sobject><type>ContentVersion</type><Title>{4}</Title><PathOnClient>{4}</PathOnClient><VersionData>{5}</VersionData><"+i+">{6}</"+i+"></sobject></create></s:Body></s:Envelope>",n._baseURL="",n._recordId=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callAsync",value:function(e){e||(e={}),e.headers||(e.headers={});var t=!0;void 0!=e.async&&(t=e.async),this._setupHeaders(e.headers,e);var n=this._getUrl(e.url),i=this._getData(e.data,e);this._recordId=e.questionId,f.ajax({type:"POST",contentType:"text/xml",dataType:"xml",data:i,url:n,context:this,async:t,headers:e.headers,success:function(e,t,n){this._callAsyncAttachmentSuccess(e,t,n)},error:function(e,t,n){this._callAsyncError(e,t,n)}})}},{key:"_callAsyncAttachmentSuccess",value:function(e,t,n){var i=new DOMParser,a=i.parseFromString(n.responseText,"text/xml"),r="";if(a.getElementsByTagName("id")&&a.getElementsByTagName("id").length>0){var o=a.getElementsByTagName("id")[0];o.childNodes&&o.childNodes.length>0&&(r=o.childNodes[0].nodeValue)}e=this._processDataOnLoad(e),e.attachmentId=r,e.questionId=this._recordId;var s=new y.SoapRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(s)}},{key:"_callAsyncSuccess",value:function(e,t,n){e=this._processDataOnLoad(e);var i=new y.SoapRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(i)}},{key:"_getUrl",value:function(e){return y.SAL.rtMode.getSoapUrl(e,this._options.apiVersion)}},{key:"_getData",value:function(e,t){return e=f.toXML(e),e=this._format(this._requestTemplate,this._options.sessionId,t.type,t.isPrivate,t.ParentId,t.name,t.body,t.processID)}},{key:"_getOrgNamespace",value:function(e){return null!=e&&""!=e?e+"/":""}},{key:"_format",value:function(){return f.format(arguments)}},{key:"_callAsyncError",value:function(e,t,n){var i=new y.RestRequestEvent("REQUEST_ERROR",this,{e:n,status:t,xhr:e});this.triggerEvent(i)}},{key:"_setupHeaders",value:function(e,t){e.SOAPAction=t.methodName}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(g),y.ApexSoapRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n._requestTemplate='<se:Envelope xmlns:se="http://schemas.xmlsoap.org/soap/envelope/"><se:Header xmlns:sfns="http://soap.sforce.com/schemas/package/{0}{1}"><sfns:SessionHeader><sessionId>{2}</sessionId></sfns:SessionHeader></se:Header><se:Body><{3} xmlns="http://soap.sforce.com/schemas/package/{0}{1}"><request>{4}</request></{3}></se:Body></se:Envelope>',n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"_getUrl",value:function(e){return y.SAL.rtMode.getApexSoapUrl(e)}},{key:"_getData",value:function(e,t){return e=f.toXML(e),e=this._format(this._requestTemplate,this._getOrgNamespace(this._options.nameSpace),this._options.endPoint,this._options.sessionId,t.methodName,e)}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(y.SoapRequest),y.WSSoapRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n._requestTemplate='<se:Envelope xmlns:se="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sfns="http://soap.sforce.com/schemas/class/{0}"><se:Header><sfns:SessionHeader><sfns:sessionId>{1}</sfns:sessionId></sfns:SessionHeader></se:Header><se:Body><sfns:{2}><sfns:request>{3}</sfns:request></sfns:{2}></se:Body></se:Envelope>',n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"_getUrl",value:function(e){return y.SAL.rtMode.getApexSoapUrl(e)}},{key:"_getData",value:function(e,t){return data=this._format(this._requestTemplate,this._options.endPoint,this._options.sessionId,t.methodName,e),data}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(y.SoapRequest),y.FileUploadStatusSoapRequest=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n._options=e,n._requestTemplate='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns="urn:partner.soap.sforce.com"><s:Header><SessionHeader><sessionId>{0}</sessionId></SessionHeader></s:Header><s:Body><query><queryString>{1}</queryString></query></s:Body></s:Envelope>',n._baseURL="",n._recordId=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callAsync",value:function(e){e||(e={}),e.headers||(e.headers={});var t=!0;void 0!=e.async&&(t=e.async),this._setupHeaders(e.headers,e);var n=this._getUrl(e.url),i=this._getData(e.data,e);f.ajax({type:"POST",contentType:"text/xml",dataType:"xml",data:i,url:n,context:this,async:t,headers:e.headers,success:function(e,t,n){var i=new y.SoapRequestEvent("REQUEST_COMPLETED",this,e);this.triggerEvent(i)},error:function(e,t,n){var a=new y.SoapRequestEvent("REQUEST_COMPLETED",this,i);this.triggerEvent(a)}})}},{key:"_getUrl",value:function(e){return y.SAL.rtMode.getSoapUrl(e,this._options.apiVersion)}},{key:"_getData",value:function(e,t){return e=f.toXML(e),e=this._format(this._requestTemplate,this._options.sessionId,t.queryData)}},{key:"_getOrgNamespace",value:function(e){return null!=e&&""!=e?e+"/":""}},{key:"_format",value:function(){return f.format(arguments)}},{key:"_setupHeaders",value:function(e,t){}},{key:"_processDataOnLoad",value:function(e){return e}}]),t}(g),y.ServiceEvent=function(e){function t(e,n,i){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i))}return(0,h.default)(t,e),t}(v),y.ServiceBase=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n._parent=e,n._profiler=f.getProfilingService(),n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callMethod",value:function(e){}},{key:"callMethodAsync",value:function(e){}},{key:"callApiAsync",value:function(e){}}]),t}(g),y.RestService=function(e){function t(e){(0,s.default)(this,t),y.SAL.init();var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.apiVersion="v24.0",n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callApiAsync",value:function(e){var t=this._profiler,n=e.methodName,i=this.getClassName()+"APIAsync",a=new y.RestRequest({sessionId:this._parent.params.sessionId,apiVersion:this.apiVersion});a.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),a.bind("REQUEST_ERROR",this._callMethodAsyncError,this),t.begin(n,i,"fetch"),a.callAsync({url:e.url,method:"GET",data:e.data,responseType:e.responseType}).always(function(){t.end(n,i,"fetch")}).then(function(){t.raiseEvent("REFRESH_CONTENT")})}},{key:"callMethod",value:function(e){e.async=!1,this.callMethodAsync(e)}},{key:"callMethodAsync",value:function(e){var t=this._profiler,n=e.methodName,i=this.getClassName()+"MethodAsync",a=void 0!=this._parent.params.nameSpace?this._parent.params.nameSpace:"SVMXC",r=void 0!=this._parent.params.endPoint?this._parent.params.endPoint:"NO_END_POINT",o=e.methodName,s=this._parent.params.svmxServiceVersion,l=a+"/svmx/rest/"+r+"/"+o+"/"+s+"/",c=!0;void 0!=e.async&&(c=e.async);var u=new y.ApexRestRequest({sessionId:this._parent.params.sessionId,apiVersion:this.apiVersion});u.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),u.bind("REQUEST_ERROR",this._callMethodAsyncError,this),t.begin(n,i,"fetch"),u.callAsync({url:l,method:this.__getHttpMethodType(o),data:e.data,async:c}).always(function(){t.end(n,i,"fetch")}).then(function(){t.raiseEvent("REFRESH_CONTENT")})}},{key:"__getHttpMethodType",value:function(e){var t="";if(this.__findIn(e,["get","retrieve","obtain","query"],0))t="POST";else{if(!this.__findIn(e,["post","submit","create","modify","update","alter","save","add"],0))throw new Error("Unsupported method type");t="POST"}return t}},{key:"__findIn",value:function(e,t,n){for(var i=t.length,a=0;a<i;a++)if(e.indexOf(t[a])==n)return!0;return!1}},{key:"_callMethodAsyncSuccess",value:function(e){var t=new y.ServiceEvent("REQUEST_COMPLETED",this,e.data);this.triggerEvent(t)}},{key:"_callMethodAsyncError",value:function(e){var t=new y.ServiceEvent("REQUEST_ERROR",this,e.data);this.triggerEvent(t)}}]),t}(y.ServiceBase),y.LocalService=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),t}(y.ServiceBase),y.SoapService=function(e){function t(e){(0,s.default)(this,t),y.SAL.init();var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.apiVersion="20.0",n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"callMethodAsync",value:function(e){var t=void 0!==this._parent.params.nameSpace?this._parent.params.nameSpace:"SVMXC",n=void 0!=this._parent.params.endPoint?this._parent.params.endPoint:"NO_END_POINT",i=e.methodName,a=this.__getOrgNamespace(t)+n,r=void 0;"Attachment"===e.type?(r=new y.AttachmentSoapRequest({sessionId:this._parent.params.sessionId,apiVersion:this.apiVersion,endPoint:n,nameSpace:t}),r.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),r.bind("REQUEST_ERROR",this._callMethodAsyncError,this),r.callAsync(e)):"file"===e.type?(r=new y.FileSoapRequest({sessionId:this._parent.params.sessionId,apiVersion:"40.0",endPoint:n,nameSpace:t}),r.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),r.bind("REQUEST_ERROR",this._callMethodAsyncError,this),r.callAsync(e)):(r=new y.ApexSoapRequest({sessionId:this._parent.params.sessionId,apiVersion:this.apiVersion,endPoint:n,nameSpace:t}),r.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),r.bind("REQUEST_ERROR",this._callMethodAsyncError,this),r.callAsync({url:a,methodName:i,data:e.data}))}},{key:"callApiSync",value:function(e){var t=new y.SoapRequest({sessionId:this._parent.params.sessionId,apiVersion:"41"});t.bind("REQUEST_COMPLETED",this._callMethodAsyncSuccess,this),t.bind("REQUEST_ERROR",this._callMethodAsyncError,this),t.callAsync({url:"",methodName:e.methodName,data:e.data})}},{key:"__getOrgNamespace",value:function(e){return null!=e&&""!=e?e+"/":""}},{key:"_callMethodAsyncSuccess",value:function(e){var t=new y.ServiceEvent("REQUEST_COMPLETED",this,e.data);this.triggerEvent(t)}},{key:"_callMethodAsyncError",value:function(e){var t=new y.ServiceEvent("REQUEST_ERROR",this,e.data);this.triggerEvent(t)}}]),t}(y.ServiceBase),y.RestServiceManager=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.params=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"createService",value:function(){return f.create("com.servicemax.client.sal.impl.RestService",this)}}]),t}(m),y.SoapServiceManager=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.params=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"createService",value:function(){return new y.SoapService(this)}}]),t}(m),y.ServiceManagerFactory=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"createServiceManager",value:function(e){return e||(e={}),e.svmxServiceVersion=f.getClient().getApplicationParameter("svmx-api-version"),f.getClient().getApplicationParameter("svmx_is_jwt_token_enabled")?e.sessionId=f.getClient().getApplicationParameter("svmx_sfm_delivery_jwt_token"):e.sessionId=f.getClient().getApplicationParameter("session-id"),"SOAP"==e.type?new y.SoapServiceManager(e):new y.RestServiceManager(e)}}]),t}(m),f.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(16),s=i(o),l=n(50),c=i(l),u=n(1),d=i(u),_=n(2),h=i(_),f=n(6),p=i(f),m=n(3),v=i(m),g=n(4),y=i(g),S=n(10),E=n(0).utils,b=n(5).ModuleActivator,T=(n(375),n(377),n(7).Cache),M=n(5).EventDispatcher,I=n(5).SVMXObject,C=n(11).Facade,A=n(7).Data,D=n(7).Expressions,x=n(12).DatetimeUtil,R=n(7).MetaData,O=n(99).Record,L=n(244).Service,k=(n(381),n(7).Attachments),N={name:"com.servicemax.client.offline.sal.model.impl"};N.Module=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return e.__logger=E.getLoggingService().getLogger("OFFLINE-SAL-MODEL"),e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}},{key:"createServiceRequest",value:function(e,t){E.getClient().getServiceRegistry().getService("com.servicemax.client.offline.sal.service.factory").getInstanceAsync({handler:function(t){var n=e.options||{},i={type:n.type||"REST",endPoint:n.endPoint||"SFMDeliveryServiceIntf",nameSpace:null===n.namespace?null:E.OrgNamespace},a=t.createServiceManager(i),r=a.createService();e.handler.call(e.context,r)},context:this})}},{key:"checkResponseStatus",value:function(){var e=void 0,t=function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG112","Saved Succesfully"),n=E.getCurrentApplication();t&&"string"==typeof t&&(e=E.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_QUICK_MESSAGE",this,{request:{message:t,type:"SVMX_SUCCESS"},responder:{}}),n.triggerEvent(e))}}]),t}(b),N.Module.instance=null,N.AttachmentNotificationService=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),t}(M),N.StorageProvider=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"get",value:function(e){return T.readFromSynchronousDBCache("SVMX__DB__Cache",e)}},{key:"set",value:function(e,t){T.writeToSynchronousDBCache("SVMX__DB__Cache",e,t)}},{key:"clear",value:function(){}},{key:"getStorageObject",value:function(){}}]),t}(I),N.PlatformSpecifics=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return e.__logger=E.getLoggingService().getLogger("SFMDelivery : PlatformSpecifics"),e.__clientType=E.getClient().getApplicationParameter("client-type"),e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"checkConnectivity",value:function(){var e=E.Deferred(),t=this,n={type:"CONNECTIVITY",method:"CHECKCONNECTIVITY"},i=C.createConnectivityRequest();return i.bind("REQUEST_COMPLETED",function(t){e.resolve(t.data.data)},t),i.bind("REQUEST_ERROR",function(t){e.resolve("False")},t),i.execute(n),e}},{key:"isEventSupported",value:function(e){var t=!1;return"JAVASCRIPT"==e[E.OrgNamespace+"__Event_Call_Type__c"]&&(t=!0),t}},{key:"isActionButtonVisible",value:function(e){return!!e.buttonDetail[E.OrgNamespace+"__Show_In_iPad__c"]}},{key:"showRecordFrombubbleInfo",value:function(e){E.getClient().getServiceRegistry().getService("com.servicemax.client.sfmevent.platformspecifics").getInstance().showRecord(e)}},{key:"getProcessLMD",value:function(){return window.svmx_sfm_delivery_process_lmd}},{key:"getAttachmentsEnabled",value:function(){return!("svmx_sfm_delivery_attachments_enabled"in window)||window.svmx_sfm_delivery_attachments_enabled}},{key:"getRefDisplayValue",value:function(e,t,n){var i=function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SFMDELIVERY")},a=new S.Deferred,r=!0,o=n;if(o&&o.fieldDetail.SVMXC__Named_Search__r&&o.fieldDetail.SVMXC__Named_Search__r.SVMXC__Default_Lookup_Column__c&&o.fieldDetail.SVMXC__Related_Object_Name__c){r=!1;var s=t.fieldvalue.key,l=o.fieldDetail.SVMXC__Named_Search__r.SVMXC__Default_Lookup_Column__c,c=o.fieldDetail.SVMXC__Related_Object_Name__c,u=o.fieldDetail.SVMXC__Related_Object_Name_Field__c;A.getRefDisplayValue(s,l,c,u).always(E.proxy(this,function(e){if(e.length){var n=e[0].DisplayName,r=e[0].RefName||e[0].DefaultName||i().T("TAG031");t.fieldvalue.value=n||r,t.fieldvalue.isNameSyncData=!r}else t.fieldvalue.isNameSyncData=!0;a.resolve(t)}))}return r&&a.resolve(t),a}},{key:"getQualificationInfo",value:function(e,t,n,i,a){D.evaluate({recordId:e,data:t,processId:n,validateExtAppRec:i,returnMessage:!0,onSuccess:E.proxy(this,function(e){0==e[0].result&&E.getCurrentApplication().getRoot().hideLoading&&E.getCurrentApplication().getRoot().hideLoading();var t={isSFMProcess:!0,isQualified:e[0].result,errorMessage:!0===e[0].result?"":e[0].message||function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG113","This record does not meet the qualification criteria for this SFM Transaction")};a(t)}),onError:E.proxy(this,function(e){E.getLoggingService().getLogger("OFFLINE-SAL-MODEL-PlatformSpecifics").error("IGNORING ERROR: Failed to get expressions in GetObjectData"),a({isSFMProcess:!0,isQualified:!0})})})}},{key:"getBasicDisplayTags",value:function(){return{}}},{key:"performNewAfterSave",value:function(e,t){var n,i=e.data.processId,a=t,r=a.getRootContainerId(),o=a.nextStepId,s=a.returnUrl,l=a.onEngineReady,u=a.onEngineRendered,d=a.requestClose,_=(n={processId:i,returnUrl:"",nextStepId:"",container:r},(0,c.default)(n,"returnUrl",s),(0,c.default)(n,"nextStepId",o),(0,c.default)(n,"onEngineReady",l),(0,c.default)(n,"onEngineRendered",u),(0,c.default)(n,"requestClose",d),n);a.__loadInternal(_)}},{key:"navigateToTargetRecord",value:function(e,t,n,i){var a=n;e&&this.showRecordFrombubbleInfo({key:e});var r=function e(t){if(a){a.doClose.call(a);var n=E.getCurrentApplication();if(t.data&&t.data.getId()){var i=t.data.getId();n.findConsoleAppByWindowId(i).__opener=a.requestClose.context.getOpener()||null,n.showConsoleApp(i)}a=null,n.unbind("SFMDELIVERY.VIEW_LOADED",e,this)}};i&&this.__clientType&&"laptop"===this.__clientType.toLowerCase()?(a.unblockApplication(),E.getCurrentApplication().bind("SFMDELIVERY.VIEW_LOADED",r,this)):t(!0)}},{key:"getItemFromCache",value:function(e){return!1}},{key:"isEmailValid",value:function(e){return new RegExp('^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@(([\\[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$').test(e)}},{key:"getFormattedDateTimeValue",value:function(e,t){return e||(e=""),e}},{key:"getFormattedDateValue",value:function(e){return e||(e=""),e}},{key:"showRecord",value:function(e){var t=E.Deferred();this.__logger.info("Performing SFM action => ");var n=e.key,i=e.objectName;return i||(i=this.__getObjectName(n)),A.getRecord({Id:n,loadReferences:!0,convertPicklists:!0}).then(E.proxy(this,function(e){this.__getProcessId(e,i).done(function(a){var r=x,o=R,s=E.getCurrentApplication(),l=r.getCurrentDatetimeGMT(r.getSaveFormat("dateTime")),c=o.getNameField(i);if(a&&void 0!=a&&a.length>0){var u=E.create("com.servicemax.client.lib.api.Event","RECENTS.ADD_RECENTS",this,{request:{recordId:n,objectName:i,lastAccessed:l,nameField:c,type:"VIEW"},responder:{result:function(){E.getLoggingService().getLogger("sfmsearch").info("Added Record to Recents")}}});s.triggerEvent(u);var d={SVMX_processId:a,SVMX_recordId:n,SVMX_record:e};E.getCurrentApplication().launchConsoleApp("sfmdelivery",d),t.resolve()}else{var _=function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},h=_().T("FSA004_TAG021","View not configured for this record. Please contact your system administrator.");E.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:h,buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:function(e){t.reject()}})}}).fail(function(){t.reject()})})).fail(function(){t.reject()}),t}},{key:"createNavigation",value:function(e){var t=E.Deferred(),n=e.recordId,i=this.__getObjectName(n);return A.getRecord({Id:n,loadReferences:!0,convertPicklists:!0}).then(E.proxy(this,function(e){this.__getProcessId(e,i).done(function(i){if(i&&void 0!=i&&i.length>0){var a={SVMX_processId:i,SVMX_recordId:n,SVMX_record:e};E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").replaceState({app:"sfmdelivery",options:a})}else{var r=function(){return E.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},o=r().T("FSA004_TAG021","View not configured for this record. Please contact your system administrator.");E.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:o,buttons:[{text:r().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:function(e){t.reject()}})}}).fail(function(){t.reject()})})).fail(function(){t.reject()}),t}},{key:"__getProcessId",value:function(e,t,n,i){var a=E.Deferred();return R.getQualifiedProcessesForRecord({objectName:t,record:e,processType:"VIEW RECORD",considerDefaultView:!0}).then(E.proxy(this,function(e,t){if(e.length){var n=e[0].process_unique_id;a.resolve(n)}else i&&a.resolve(null);a.resolve()})),a}},{key:"__getObjectName",value:function(e,t){return R.getTableForId(e)}}]),t}(I),N.SFMDeliveryChecklistAttachmentData=function(e){function t(e){(0,h.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return n.__data=e,n.__deletedRecords=[],n.__localDeletedFiles=[],n.__records=e.response.records||[],n.__attachementDataHash=n.getAttachmentDataHash(e.response.records),n.__syncManager=E.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),n}return(0,y.default)(t,e),(0,p.default)(t,[{key:"getAttachmentDataHash",value:function(e){var t={};if(e)for(var n=e,i=0;i<n.length;i++)n&&n[i]&&n[i][E.OrgNamespace+"__SM_Internal_Question_ID__c"]&&(t[n[i][E.OrgNamespace+"__SM_Internal_Question_ID__c"]]=n[i]);return t}},{key:"getAttachementValuefromPath",value:function(e){return this.__attachementDataHash[e]}},{key:"setAttachementValueToPath",value:function(e,t){var n=t;if(Object.prototype.hasOwnProperty.call(this.__attachementDataHash,e)){var i=k.getAttachmentFieldNameInCATable(),a=t&&t.deletedAttachmentId,r=t&&t.deletedCdlId,o=t&&t[i],l=this.getRemoteId(t),c=this.getLocalId(t),u=this.__attachementDataHash[e][i];t&&(0,s.default)(t).length>0&&a&&a.length&&a===this.__attachementDataHash[e][E.OrgNamespace+"__SM_Attachment_ID__c"]?(0,s.default)(this.__attachementDataHash[e]).length>0&&this.__deletedRecords.push(this.__attachementDataHash[e]):t&&(0,s.default)(t).length>0&&r&&r.length&&r===this.__attachementDataHash[e][E.OrgNamespace+"__SM_ContentDocumentLink_ID__c"]?(0,s.default)(this.__attachementDataHash[e]).length>0&&this.__deletedRecords.push(this.__attachementDataHash[e]):t&&(0,s.default)(t).length>0&&o!==u&&c!==u&&l!==u?(0,s.default)(this.__attachementDataHash[e]).length>0&&this.__deletedRecords.push(this.__attachementDataHash[e]):(null===t&&this.__attachementDataHash[e]&&(0,s.default)(this.__attachementDataHash[e]).length>0||t.isDeleted)&&this.__deletedRecords.push(this.__attachementDataHash[e])}t&&t.deletedFiles&&t.deletedFiles.length>0&&(this.__localDeletedFiles=t.deletedFiles,n.deletedFiles=[]),t&&t.isDeleted&&(n={}),n&&(0,s.default)(t).length>0&&(this.__attachementDataHash[e]=n)}},{key:"getRemoteId",value:function(e){var t=this.__syncManager.__uploadedRecords,n="";if(e){var i=k.getAttachmentFieldNameInCATable(),a=e[i];a&&t&&t[a]&&(n=t[a])}return n}},{key:"getLocalId",value:function(e){var t=this.__syncManager.__uploadedRecords,n="";if(e){var i=k.getAttachmentFieldNameInCATable(),a=e[i];a&&t&&(n=(0,s.default)(t).find(function(e){return t[e]===a}))}return n}},{key:"getRawAttachmentData",value:function(){return this.__attachementDataHash}},{key:"getDeletedAttachmentRecords",value:function(){return this.__deletedRecords}},{key:"getAttachmentQuestionFields",value:function(){return(0,s.default)(this.__attachementDataHash)}}]),t}(M),N.SFMDeliveryData=function(e){function t(e){(0,h.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return n.__logger=E.getLoggingService().getLogger("SFMDELIVERY-SAL_DATA"),n.__data=e,n.__error=e.error,n.__deletedRecords=[],n._targetRecordId=null,n._sourceRecordId=null,n._initialize(),e.response&&e.response.records&&"CHECKLIST"===e.response.processType&&(n.__attachementData=new N.SFMDeliveryChecklistAttachmentData(e)),n}return(0,y.default)(t,e),(0,p.default)(t,[{key:"_initialize",value:function(){this._targetRecordId=this.__data.pageDataSet.sobjectinfo.Id,this._sourceRecordId=this.__data.pageDataSet.sourceRecordID,this._initialize2()}},{key:"_resolveRecordTypes",value:function(e,t){var n=e.RecordTypeId;if(e.RecordTypeId&&e.RecordTypeId.fieldvalue&&e.RecordTypeId.fieldvalue.key){var n=e.RecordTypeId.fieldvalue.key,i=T.readFromJSCache("SFMDELIVERY.RecordTypes",t),a=E.array.get(i,function(e){return e.recordTypeId==n}),r=a?a.name:null;r&&(e.RecordTypeId.fieldvalue.value=r)}}},{key:"_initialize2",value:function(){this.__data.sfmData=this.__extractData(this.__data.pageDataSet),this.headerAndDetailIds={},this.__data.sfmData.Id&&(this.headerAndDetailIds[this.__data.sfmData.Id]=null),this.__data.sfmData.attributes&&this._resolveRecordTypes(this.__data.sfmData,this.__data.sfmData.attributes.type),this.__data.sfmData.details={};var e=this.__data.detailDataSet;if(e){e instanceof Array||(e=[e]);var t=void 0,n=e.length;for(t=0;t<n;t++){var i=e[t].pageDataSet,a=e[t].aliasName,r={lines:[]};if(i&&(i instanceof Array||(i=[i]),i.length>0)){var o,s=i.length;for(o=0;o<s;o++)r.lines[o]=this.__extractData(i[o]),r.lines[o].Id&&(this.headerAndDetailIds[r.lines[o].Id]=null),this._resolveRecordTypes(r.lines[o],r.lines[o].attributes.type)}a&&(this.__data.sfmData.details[a]=r)}}}},{key:"__extractData",value:function(e){var t=e.sobjectinfo,n=e.bubbleInfo,i=void 0,a=0;for(n&&(n instanceof Array||(n=[n]),a=n.length),i=0;i<a;i++){var o=n[i],s=o.fieldapiname,l={};l.fieldapiname=s,l.fieldvalue={},"Id"==s?l=o.fieldvalue.value:o.fieldvalue&&(o.fieldvalue.value1?l.fieldvalue={key:o.fieldvalue.value,value:o.fieldvalue.value1}:l.fieldvalue={key:o.fieldvalue.key,value:o.fieldvalue.value},"isNameSyncData"in o.fieldvalue&&(l.fieldvalue.isNameSyncData=o.fieldvalue.isNameSyncData),"hasViewSFM"in o.fieldvalue&&(l.fieldvalue.hasViewSFM=o.fieldvalue.hasViewSFM)),t[s]=l}return e.sourceRecordID&&"string"==typeof e.sourceRecordID&&(t.sourceRecordID=e.sourceRecordID),t.Id&&"object"===(0,r.default)(t.Id)&&delete t.Id,t}},{key:"reset",value:function(e,t){if(this.__logger.info("Performing reset of sal-model"),this.__data=e,this._initialize2(),this.__logger.info("Notifying the listeners that the sal-model has been reset"),t){var n=E.create("com.servicemax.client.lib.api.Event","MODEL_UPDATED",this,{});this.triggerEvent(n)}}},{key:"updateFromEvent",value:function(e){this.reset(e,!0)}},{key:"copyFromTargetRecord",value:function(e){var t,n={pageDataSet:{sobjectinfo:{attributes:{type:e.headerRecord.objName,url:"TODO"}},bubbleInfo:[]},detailDataSet:[]},i=e.headerRecord.records[0].targetRecordAsKeyValue,a=i.length;for(t=0;t<a;t++)n.pageDataSet.bubbleInfo[t]={fieldapiname:i[t].key,fieldvalue:{key:i[t].value,value:i[t].value1}},null!==n.pageDataSet.bubbleInfo[t].fieldvalue.value&&void 0!==n.pageDataSet.bubbleInfo[t].fieldvalue.value||(n.pageDataSet.bubbleInfo[t].fieldvalue.value=n.pageDataSet.bubbleInfo[t].fieldvalue.key);var r=e.detailRecords,a=r.length;for(t=0;t<a;t++){var o,s=r[t],l=s.aliasName,c=s.records,u=c.length,d=null;for(d={aliasName:l,pageDataSet:[]},o=0;o<u;o++){var _,h,f=c[o].targetRecordAsKeyValue,p=f.length;d.pageDataSet[o]={sobjectinfo:{attributes:{type:s.objName,url:"TODO"}}};var m=d.pageDataSet[o].bubbleInfo=[];for(c[o].sourceRecordId&&(d.pageDataSet[o].sobjectinfo.sourceRecordID=c[o].sourceRecordId),_=0,h=0;_<p;_++)"Id"==f[_].key?d.pageDataSet[o].sobjectinfo.Id=f[_].value:(m[h]={fieldapiname:f[_].key,fieldvalue:{key:f[_].value,value:f[_].value1}},null!==m[h].fieldvalue.value&&void 0!==m[h].fieldvalue.value||(m[h].fieldvalue.value=m[h].fieldvalue.key),h++)}n.detailDataSet[n.detailDataSet.length]=d}this.updateFromEvent(n)}},{key:"getTargetRecordId",value:function(){return this._targetRecordId}},{key:"setTargetRecordId",value:function(e){this._targetRecordId=e}},{key:"getSourceRecordId",value:function(){return this._sourceRecordId}},{key:"getDeletedRecords",value:function(){return this.__deletedRecords}},{key:"getValueFromPath",value:function(e){if(e){var t=e.split("."),n=void 0,i=t.length,a=this.__data.sfmData;for(n=0;n<i&&(a=a[t[n]]);n++);return a}}},{key:"getRawData",value:function(){return this.__data}},{key:"getRawValues",value:function(e){if(!e)return this.__data.sfmData;var t={},n=void 0,i=e.data||this.__data.sfmData,a=e.referenceValue;for(n in i)if("details"==n?t.details=i.details:a&&i[n]&&"object"===(0,r.default)(i[n])&&"fieldvalue"in i[n]&&a in i[n].fieldvalue?t[n]=i[n].fieldvalue[a]:t[n]=i[n],void 0!==t[n]&&null!==t[n]&&"object"!==(0,r.default)(t[n])&&e.fieldTypes&&"attributes"in i){var o=i.attributes.type,s=e.fieldTypes[o],l=s?s[n]:"string";t[n]=this.__convertFieldValue(t[n],l)}return t}},{key:"getConvertedValue",value:function(e,t){return this.__convertFieldValue(e,t)}},{key:"__isDateObject",value:function(e){var t=x.isValidDate(e);return t||this.__logger.error("Invalid Date Object;",e),t}},{key:"__convertFieldValue",value:function(e,t){switch(t){case"date":if(!e)return e;var n=x.parseDate(e);return this.__isDateObject(n)&&n.setHours(0,0,0),n;case"datetime":if(!e)return e;var n=x.parseGMTDate(e);return this.__isDateObject(n),n;case"boolean":return"true"===e||!0===e;case"double":case"percent":case"currency":return"string"==typeof e?Number(e):e;default:return e}}},{key:"deleteDetailRecords",value:function(e,t){var n="details."+t,i=this.getValueFromPath(n),a=void 0,r=e.length,o=void 0,s=void 0,l=this._targetRecordId;for(a=0;a<r;a++){o=e[a].rowIndex,s=e[a].recordId;var c=void 0,u=void 0;if(s){for(var d=i.lines,_=d.length,h=0;h<_;h++)if(d[h].Id===s){c=d.splice(h,1),u=c[0].Id;break}}else c=i.lines.splice(o,1),u=c[0].Id;u&&this.__deletedRecords.push({alias:t,id:u,parentId:l})}var f=E.create("com.servicemax.client.lib.api.Event","DETAIL_RECORDS_DELETED",this,{lines:e,bindingPath:n});this.triggerEvent(f)}},{key:"addNewDetailRecords",value:function(e,t,n){var i="details."+t,a=this.getValueFromPath(i),r=void 0,o=e.length,s={lines:[]};for(r=0;r<o;r++){var l=e[r].sobjectinfo,c={};l instanceof O?(l.forEachField(function(e){void 0!==l.getValue(e)&&(c[e.name]=l.getValue(e))}),c.attributes={type:l.getTableName(),url:"TODO"},l.__new&&(c.__new=!0)):c=E.cloneObject(l);var u={bubbleInfo:E.cloneObject(e[r].bubbleInfo),sobjectinfo:c};s.lines[r]=a.lines[a.lines.length]=this.__extractData(u)}var d=E.create("com.servicemax.client.lib.api.Event","DETAIL_RECORDS_ADDED",this,{newRecords:E.toObject(E.toJSON(s)),bindingPath:i,onSuccess:n});this.triggerEvent(d)}},{key:"copyDetailRecords",value:function(e,t,n,i){var a="details."+t,r=this.getValueFromPath(a),o=void 0,s=e.length,l={lines:[]};for(o=0;o<s;o++){var c=e[o].sobjectinfo,u=(c.length,{});c.forEachField(function(e){n&&("Id"!==e.name&&"OwnerId"!==e.name&&"CreatedDate"!==e.name&&"CreatedById"!==e.name&&"LastModifiedDate"!==e.name&&"LastModifiedById"!==e.name&&"SystemModstamp"!==e.name&&(u[e.name]=n[e.name]),e.name+"__key"!="CreatedDate__key"&&e.name+"__key"!="CreatedById__key"&&e.name+"__key"!="LastModifiedDate__key"&&e.name+"__key"!="LastModifiedById__key"&&e.name+"__key"!="SystemModstamp__key"&&e.name+"__key"!="LastViewedDate__key"&&e.name+"__key"!="LastReferencedDate__key"&&(u[e.name+"__key"]=n[e.name+"__key"]),"currency"!=e.dataType&&"percent"!=e.dataType&&"double"!=e.dataType&&"int"!=e.dataType||delete u[e.name+"__key"])}),c&&c.Id&&c.Id.indexOf("local")>0&&(u.Id=c.Id),u.attributes={type:c.getTableName(),url:"TODO"},c.__copy&&(u.__copy=!0,u.__isCopied=!0);var d={bubbleInfo:E.cloneObject(e[o].bubbleInfo),sobjectinfo:u};l.lines[o]=r.lines[r.lines.length]=this.__extractData(d)}var _=E.create("com.servicemax.client.lib.api.Event","DETAIL_RECORDS_COPY",this,{newRecords:E.toObject(E.toJSON(l)),bindingPath:a,onSuccess:i});this.triggerEvent(_)}},{key:"setValueToPath",value:function(e,t){if(e){var n=e.split("."),i=void 0,a=n.length,r=this.__data.sfmData,o=void 0,s=void 0;for(i=0;i<a&&(o=r,s=n[i],r=r[s]);i++);o[s]=t}}},{key:"getError",value:function(){return this.__error}}]),t}(M),N.RestServiceManager=function(e){function t(e){(0,h.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return n.params=e,n}return(0,y.default)(t,e),(0,p.default)(t,[{key:"createService",value:function(){return E.create("com.servicemax.client.offline.sal.impl.Placeholder",this)}}]),t}(I),N.SoapServiceManager=function(e){function t(e){(0,h.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments));return n.params=e,n}return(0,y.default)(t,e),(0,p.default)(t,[{key:"createService",value:function(){return E.create("com.servicemax.client.offline.sal.model.impl.Placeholder",this)}}]),t}(I),N.Placeholder=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"bind",value:function(e,t,n){t.call(n,{data:"Not implemented"})}},{key:"callMethodAsync",value:function(){}}]),t}(L),N.ServiceManagerFactory=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"createServiceManager",value:function(e){return e||(e={}),e.svmxServiceVersion=E.getClient().getApplicationParameter("svmx-api-version"),e.sessionId=E.getClient().getApplicationParameter("session-id"),"SOAP"==e.type?new N.SoapServiceManager(e):new N.RestServiceManager(e)}}]),t}(I),E.defineGlobal(N.name,N),e.exports=N},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(7).MetaData,n(7).SystemData),m=(n(7).Data,n(12).DatetimeUtil,n(13).Operation),v={name:"com.servicemax.client.offline.sal.model.sfmsearchdelivery.operations"},g=p;f.getLoggingService().getLogger("svmxc-search-service");v.GetSearchInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.create("com.servicemax.client.offline.sal.model.sfmsearch.utils.impl.Utils").getSearchDefinition({clearCache:!0},function(e){var n=e.lstSearchInfo||[],i=void 0,a=n.length,r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0,_=void 0,h=void 0,p=void 0;for(i=0;i<a;i++)for(r=n[i],o=r.searchDetails||[],l=o.length,s=0;s<l;s++){for(c=o[s],u=c.fields||[],_=u.length,p=[],d=0;d<_;d++)h=u[d],"Result"==h[f.OrgNamespace+"__Search_Object_Field_Type__c"]&&p.push(h);c.fields=p}t.result(e)},this)}}]),t}(m),v.GetSearchResults=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.create("com.servicemax.client.offline.sal.model.sfmsearch.utils.impl.Utils").getSearchResults(e).always(function(e){t.result(e)})}}]),t}(m),v.GetSearchResultCount=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.create("com.servicemax.client.offline.sal.model.sfmsearch.utils.impl.Utils").getTotalCountForSearch(e).always(function(n){var i={searchDetailId:e.searchDetail.detailObjectId,totalCount:n};t.result(i)})}}]),t}(m),v.GetUserInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){t.result(g.getUserInfo())}}]),t}(m),v.GetOnlineResults=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().getOnlineSearchResults({data:e,callback:f.proxy(this,function(e){e.isSuccess?t.result(e.data):t.result()})})}}]),t}(m),v.DownloadRecordOnDemand=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=function(e){t.result(e)},i=function(e){t.fault(e)};f.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().downloadRecordOnDemand(e).then(f.proxy(this,n),f.proxy(this,i))}}]),t}(m),v.GetSearchResultLimitSettings=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getSettingValue",value:function(e){}},{key:"performAsync",value:function(e,t){f.create("com.servicemax.client.offline.sal.model.sfmsearch.utils.impl.Utils").executeQuery("SELECT * FROM MobileDeviceSettings WHERE setting_id IN('IPAD019_SET001')",function(e){for(var n={maxLimit:null,defaultLimit:25},i=0;i<e.length;i++){var a=e[0];"IPAD019_SET001"===a.setting_id&&(n.maxLimit=a.value)}t.result(n)},this)}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){e.exports={default:n(673),__esModule:!0}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(180),r=i(a),o=n(98),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=n(10),y=n(0).utils,S=n(7).MetaData,E=(n(7).SystemData,n(7).Cache),b=n(13).Operation,T=n(11).Facade,M=n(7).Data,I={name:"com.servicemax.client.offline.sal.model.mobileinventory.operations"},C=S,A=E;I.GetMetadata=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){this.__getConfigMetaData().done(function(e){t.result(e)})}},{key:"__getConfigMetaData",value:function(){var e=g.Deferred(),t=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});return C.describeObject({objectName:"Product2",onSuccess:y.proxy(this,function(n){t.__q=y.string.substitute("SELECT  {{column}} FROM `{{objectName}}` WHERE Type = '{{key}}' ",{column:"Content",objectName:"InventoryConfig",key:"TECHNICIAN"}),t.execute().done(function(t){var i={};t&&t.length>0&&t[0].Content.length>0&&(i=JSON.parse(t[0].Content));var a={metaData:i,objectInfo:n};e.resolve(a)})})}),e}}]),t}(b),I.GetTrunkStockSearchResults=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){var n=this;A.readFromDBCache("USER_INFO").done(function(i){if(i=i||{},i=y.toObject(i),i.UserTrunkDetail&&i.UserTrunkDetail.Id){var a=i.UserTrunkDetail.Id;n.__getSearchResults(e,a).done(function(e){var i=n.__handleResponse(e);t.result(i)})}else t.result([])})}},{key:"__getSearchResults",value:function(e,t){var n=g.Deferred(),i=this,a=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});return i.__getSearchExpressionsAndColumns(e,t).done(function(t,i){a.__q=y.string.substitute("SELECT DISTINCT {{columns}} \nFROM `{{objectName}}` AS MAIN \n{{joins}} \nWHERE {{search}} {{orderBy}} LIMIT {{limit}}",{columns:t.columns,joins:t.joins,objectName:t.objectName,search:t.search,limit:e.RecordLimit,orderBy:t.orderBy}),a.execute().done(function(e){n.resolve(e)})}),n}},{key:"__getSearchExpressionsAndColumns",value:function(e,t){var n=g.Deferred(),i=this,a=(y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{}),e.fields||[]),o=void 0,l=a.length,c=void 0,u=void 0,d=void 0,_=[],h=[],f=[];i.__sortFieldsBySequenceNumbers(a);var p="",m=e.KeyWord;"Exact Match"===e.Operator?p="=":(p="like","Contains"===e.Operator?m="%"+m+"%":"Starts With"===e.Operator?m+="%":m="%"+m);var v=y.getCustomObjectName("Product_Stock"),S=y.getCustomObjectName("Product_Serial"),E=["MAIN.Id","MAIN.Name"];for(h.push(y.string.substitute("LEFT JOIN `{{tableName}}` as {{alias}} ON {{alias}}.{{columnName}} = MAIN.Id",{tableName:v,alias:"ps",columnName:y.getCustomFieldName("Product")})),o=0;o<l;o++)c=a[o],u=c.fieldName,d=c.dataType,"REFERENCE"!==d.toUpperCase()&&this.__addPlainFieldToSearchQuery(e,p,m,c,o,h,_,E),"REFERENCE"===d.toUpperCase()&&this.__addReferenceFieldToSearchQuery(e,p,m,c,o,h,_,E);E.push("MAIN."+y.getCustomFieldName("Enable_Serialized_Tracking")),E.push("ps."+y.getCustomFieldName("Available_Qty")),E.push("ps."+y.getCustomFieldName("Status")),E.push("ps."+y.getCustomFieldName("Location")),E.push("ss.Id as stockSerialId"),E.push("ss.Name as stockSerialName"),E.push("ss.IsDeleted as isStockSerialDeleted"),E.push("ss."+y.getCustomFieldName("Product_Stock")),h.push(y.string.substitute("LEFT JOIN `{{tableName}}` as {{alias}} ON {{alias}}.{{columnName}} = ps.Id",{tableName:S,alias:"ss",columnName:y.getCustomFieldName("Product_Stock")})),e.KeyWord.length>0&&("="!==p?_.push(y.string.substitute("{{column}} {{clause}} '{{keyword}}' ESCAPE '/'",{column:"ss.Name",clause:p,keyword:m})):_.push(y.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"ss.Name",clause:p,keyword:m}))),c=a[0],u=c.fieldName,E=[].concat((0,s.default)(new r.default(E))),f.push("MAIN."+u+" COLLATE NOCASE "),f.push("ps."+y.getCustomFieldName("Available_Qty")),E=E.join(",\n"),_=_.join(" OR \n")||"1\n",h=h.join("\n"),f=f.length?"\nORDER BY "+f.join(","):"";var b=y.string.substitute(" {{column1}} {{clause1}} '{{keyword1}}' AND {{column2}} {{clause2}}  '{{keyword2}}' AND {{column3}} {{clause3}}  '{{keyword3}}'",{column1:"ps."+y.getCustomFieldName("Status"),clause1:" = ",keyword1:"Available",column2:"ps."+y.getCustomFieldName("Location"),clause2:" = ",keyword2:t,column3:"MAIN."+y.getCustomFieldName("Stockable"),clause3:" = ",keyword3:!0});_=_.length>0?"("+b+") AND ("+_+")":"("+b+")";var T={columns:E,joins:h,objectName:"Product2",search:_,orderBy:f};return n.resolve(T,a),n}},{key:"__addPlainFieldToSearchQuery",value:function(e,t,n,i,a,r,o,s){var l=i.fieldName;i.dataType;s.push("MAIN."+l),e.KeyWord.length>0&&("="!==t?o.push(y.string.substitute("{{column}} {{clause}} '{{keyword}}' ESCAPE '/'",{column:"MAIN."+l,clause:t,keyword:n})):o.push(y.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"MAIN."+l,clause:t,keyword:n})))}},{key:"__addReferenceFieldToSearchQuery",value:function(e,t,n,i,a,r,o,s){var l=!1,c=i.referenceTo[0],u=(i.relationshipName,i.fieldName),d=(i.dataType,void 0);i.displayLabel;C.isTableInDatabase(c,y.proxy(this,function(e){l=e})),l&&(C.getNameField(c,function(e){d=e}),d&&(r.push(y.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{alias}}.Id = MAIN.{{source_field_name}}",{table_name:c,alias:"tbl"+a,source_field_name:u})),e.KeyWord.length>0&&("="!==t?o.push(y.string.substitute("{{column}} {{clause}} '{{keyword}}' ESCAPE '/'",{column:"tbl"+a+"."+d,clause:t,keyword:n})):o.push(y.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"tbl"+a+"."+d,clause:t,keyword:n}))),s.push("tbl"+a+"."+d+" as "+u)))}},{key:"__sortFieldsBySequenceNumbers",value:function(e){if(e){e.length>1&&e.sort(function(e,t){return parseFloat(e.sequence)-parseFloat(t.sequence)})}}},{key:"__handleResponse",value:function(e){var t=y.create("com.servicemax.client.mobileinventory.inventorydata.InventoryData",e);return t.initialize(),t.__modifiedData}}]),t}(b),I.GetProductStock=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){A.readFromDBCache("USER_INFO").done(function(n){if(n=n||{},n=y.toObject(n),n.UserTrunkDetail&&n.UserTrunkDetail.Id){var i=n.UserTrunkDetail.Id,a=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});a.__q=y.string.substitute("SELECT * FROM `{{objectName}}` WHERE {{search}}",{objectName:y.getCustomFieldName("Product_Stock"),search:y.getCustomFieldName("Product")+' = "'+e.productId+'" AND '+y.getCustomFieldName("Status")+' IN ("'+e.status.join('","')+'")\n            AND '+y.getCustomFieldName("Location")+' = "'+i+'"'}),a.execute().done(function(e){t.result(e)})}else t.result([])})}}]),t}(b),I.GetProductImage=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i=e.product,a=e.engine,r=a.getMetaModel().attachmentFileNameField;if(r){var o=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});o.__q="SELECT name, file_path, content_type, file_type from SFAttachments WHERE parent_id = '"+i.Id+"' AND name LIKE '%"+i[r]+"%' ORDER BY last_modified_date DESC",o.execute().done(function(e){if(e&&e.length>0){if(t.result){var i=M.getSFilePathInfo(e[0]),a=T.createFileRequest();a.bind("REQUEST_COMPLETED",function(e){var n=e.data.data;n&&("jpg"===n.FileExtension||"jpeg"===n.FileExtension||"png"===n.FileExtension)&&t.result?t.result(n.FilePath):t.result&&t.result(null)},n),a.bind("REQUEST_ERROR",function(e){t.result&&t.result(null)},n),a.execute({operation:"INFO",file:i.file_path})}}else t.result&&t.result(null)})}else t.result&&t.result(null)}}]),t}(b),I.GetCatalogSearchResults=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){y.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().getOnlineCatalogSearchResults({data:e}).then(function(e){var n=y.create("com.servicemax.client.mobileinventory.inventorydata.InventoryData",e);n.initialize(),t.result(n.__modifiedData)})}}]),t}(b),I.GetTechnicianRecords=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){y.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().getTechnicianSearchResults({data:e,callback:y.proxy(this,function(e){e.isSuccess?t.result(e.data):t.result(e)})})}}]),t}(b),I.GetLocatePartSearchResults=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){y.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().getLocatePartSearchResults({data:e}).then(function(e){t.result(e)}).fail(function(e){y.getLoggingService().getLogger("mobileinventoryoperations").error("Error encountered in Locate Part Search:"+e),t.fail(e)})}}]),t}(b),I.StockTransfer=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i=y.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager"),a=e.serialNumbers;a&&(a=('"'+a+'"').replace(",",'","'));var r=e.productName,o=e.sourceLocation,s=e.quantity,l=e.context&&e.context.getDeliveryEngine?e.context.getDeliveryEngine():null;i.getInstance().initiateStockTransfer({data:e,callback:y.proxy(this,function(e){e.isSuccess?(t.result(e.data),a&&!e.data.data.success?n.revertDeletedSerialNumbers(r,a,o,s,l).done(function(){n.increaseStockCount(r,o,s,l)}):e.data.data.success||n.increaseStockCount(r,o,s,l)):e.data.data.success||(t.result(e),a?n.revertDeletedSerialNumbers(r,a,o,s,l).done(function(){n.increaseStockCount(r,o,s,l)}):n.increaseStockCount(r,o,s,l))})}),a?n.markSerialNumbersAsDeleted(r,a,o,s,l).done(function(){n.decreaseStockCount(r,o,s,l)}):n.decreaseStockCount(r,o,s,l)}},{key:"markSerialNumbersAsDeleted",value:function(e,t,n,i,a){var r=g.Deferred(),o=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});return o.__q="UPDATE "+y.getCustomObjectName("Product_Serial")+' SET IsDeleted = "true" WHERE NAME IN ('+t+")",o.execute().done(function(e){r.resolve()}),r}},{key:"revertDeletedSerialNumbers",value:function(e,t,n,i,a){var r=g.Deferred(),o=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});return o.__q="UPDATE "+y.getCustomObjectName("Product_Serial")+' SET IsDeleted = "false" WHERE NAME IN ('+t+")",o.execute().done(function(e){r.resolve()}),r}},{key:"decreaseStockCount",value:function(e,t,n,i){var a=this;a.updateQtyInProductStockCache(e,n,i,!1);var r=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});r.__q="UPDATE "+y.getCustomObjectName("Product_Stock")+" SET "+y.getCustomFieldName("Available_Qty")+" = "+y.getCustomFieldName("Available_Qty")+" - "+n+" , \n    "+y.getCustomFieldName("Quantity2")+" = "+y.getCustomFieldName("Quantity2")+" - "+n+"\n    WHERE "+y.getCustomFieldName("Location")+" = '"+t+"' AND "+y.getCustomFieldName("Product")+" = '"+e+"'",r.execute().done(function(e){a.sendUpdateStockEvent()})}},{key:"increaseStockCount",value:function(e,t,n,i){var a=this;a.updateQtyInProductStockCache(e,n,i,!0);var r=y.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});r.__q="UPDATE "+y.getCustomObjectName("Product_Stock")+" SET "+y.getCustomFieldName("Available_Qty")+" = "+y.getCustomFieldName("Available_Qty")+" + "+n+",\n    "+y.getCustomFieldName("Quantity2")+" = "+y.getCustomFieldName("Quantity2")+" + "+n+"\n    WHERE "+y.getCustomFieldName("Location")+" = '"+t+"' AND "+y.getCustomFieldName("Product")+" = '"+e+"'",r.execute().done(function(e){a.sendUpdateStockEvent()})}},{key:"updateQtyInProductStockCache",value:function(e,t,n,i){if(n){var a=n.getProductStockCache()||{},r=a[e];r&&r.length>0&&(i?(r[0].__data[y.getCustomFieldName("Available_Qty")]=r[0].__data[y.getCustomFieldName("Available_Qty")]+t,r[0].__data[y.getCustomFieldName("Quantity2")]=r[0].__data[y.getCustomFieldName("Quantity2")]+t):(r[0].__data[y.getCustomFieldName("Available_Qty")]=r[0].__data[y.getCustomFieldName("Available_Qty")]-t,r[0].__data[y.getCustomFieldName("Quantity2")]=r[0].__data[y.getCustomFieldName("Quantity2")]-t))}}},{key:"sendUpdateStockEvent",value:function(){y.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").__serviceInstance.dispatchEvent("UPDATE_STOCK")}}]),t}(b),y.defineGlobal(I.name,I),e.exports=I},function(e,t,n){var i=n(65);e.exports=function(e,t,n){for(var a in t)n&&e[a]?e[a]=t[a]:i(e,a,t[a]);return e}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(59);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(18),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=(n(10),n(5).SVMXObject),y=n(0).utils,S=n(7).Cache,E=n(12).DatetimeUtil,b=y.getLoggingService().getLogger("app-to-app-operations"),T=S,M=n(11).Facade,I=function(){return y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},C={name:"com.servicemax.client.offline.sal.model.apptoapp.operations"};C.triggerProcessDataFromExternalApp=function(e){(new C.ProcessDataFromExternalApp).trigger(e)},C.triggerSyncStatusEvent=function(){return!(!y.getCurrentApplication().getSyncImpl||!y.getCurrentApplication().getSyncImpl().isSyncRunning)&&y.getCurrentApplication().getSyncImpl().isSyncRunning()},C.ProcessDataFromExternalApp=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(e){if(!e)return b.error("No incoming data from external app"),void this.__validationFailed();e.token||this.__showInvalidTokenMsg(),this._validateKey(e.token).then(y.proxy(this,function(t){var n=this;return t?(this.editProcessId=e.processId,this.editProcessId?void this.__validateProcess().then(y.proxy(this,function(t){if(!t)return void n.__showInvalidProcessMsg();if(e.record){n.record={object:e.object,record:e.record,details:e.details||[]};try{var i=n.record.object;if(n.__validateHeaderRecord(i,n.record.record)){var a=n.record.details;if(a){for(var r=!0,o=0;o<a.length;o++){var s=a[o],l=s.object;if(!n.__validateDetailRecord(l,s)){r=!1,n.__validationFailed();break}}if(r){var c=void 0;c=e.source&&"string"==typeof e.source?y.toObject(e.source):e.source,n.__showSuccessMessageBox(c)}}}else b.error("invalid header record recieved for "+i),n.__validationFailed()}catch(e){n.__validationFailed()}}})):void this.__showInvalidProcessMsg()):void this.__showInvalidTokenMsg()}))}},{key:"__validateProcess",value:function(){var e=y.Deferred(),t="SELECT COUNT(*) AS totalRecords FROM SFProcess AS sfp LEFT JOIN SFProcessComponent AS sfpc ON sfpc.process_id = sfp.process_id WHERE sfp.process_unique_id = '"+this.editProcessId+"' AND sfp.process_type = 'STANDALONE EDIT'",n=M.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=!0;t.data.data[0]&&0===t.data.data[0].totalRecords&&(n=!1),e.resolve(n)}),n.bind("REQUEST_ERROR",function(t){e.resolve(!1)}),n.execute({query:t,queryArray:[],doRollBack:!1}),e}},{key:"__validateHeaderRecord",value:function(e,t){return e&&t?this.__isTableInDatabase(e)?!!this.__validateFields(e,t)||(b.error("invalid incoming fields recieved for "+e),!1):(b.error(e+" does not exist"),!1):(b.error("invalid incoming data"),!1)}},{key:"__validateDetailRecord",value:function(e,t){if(!e||!t)return b.error("invalid incoming data"),!1;if(!this.__isTableInDatabase(e))return b.error(e+" does not exist"),!1;for(var n=t.records,i=0;i<n.length;i++){var a=n[i];if(!this.__validateFields(e,a))return b.error("invalid incoming fields recieved for "+e),!1}return!0}},{key:"__validationFailed",value:function(){var e=I().T("FSA019_TAG002","Invalid inbound data. Data import unsuccessful."),t=I().T("FSA019_TAG006","Close");this.__showErrorMessageBox(e,t)}},{key:"__showInvalidProcessMsg",value:function(){b.error("Invalid processId from external app");var e=I().T("FSA008_TAG094","This process is not found. Please contact your ServiceMax administrator."),t=I().T("FSA019_TAG006","Close");this.__showErrorMessageBox(e,t)}},{key:"__showInvalidTokenMsg",value:function(){b.error("Invalid key from external app");var e=I().T("FSA019_TAG001","Invalid authorization key. Data import unsuccessful."),t=I().T("FSA019_TAG006","Close");this.__showErrorMessageBox(e,t)}},{key:"__showErrorMessageBox",value:function(e,t){y.getCurrentApplication().showMessage({type:"INFO",title:null,text:e,buttons:[{text:t}],handler:function(e){}})}},{key:"__showSuccessMessageBox",value:function(e){var t=this;y.getCurrentApplication().showMessage({type:"INFO",title:null,text:"",items:[{xtype:"svmx.label",text:I().T("FSA019_TAG005","Allow")+" "+(e&&e.name||"Third-Party App")+" "+I().T("FSA019_TAG003","to send data to your app?")},{xtype:"svmx.label",cls:"msgbox-description",text:e&&e.description||""}],buttons:[{text:I().T("FSA019_TAG005","Allow"),itemId:"Allow",handler:y.proxy(this,function(){t.editProcessId?function(){var e=void 0,n=void 0;e=[],n={};for(var i=0;i<t.record.details.length;i++)!function(i){var a=t.record.details[i],r=com.servicemax.client.offline.sal.model.utils.FieldSet.getFieldSet(a.object,function(e){n[a.object]=e});e.push(r)}(i);var a=y.when(e);a.done(y.proxy(t,function(){var e=t.__restructureData(n),i=y.getCurrentApplication().getCurrentView();i&&i.changeConsoleApp({app:"sfmdelivery",view:"edit",options:{SVMX_processId:t.editProcessId,SVMX_recordId:t.record.record.Id,SVMX_record:e,SVMX_action:"SFM",additionalInfo:{isDataFromExternalApp:!0}},subTitle:t.record.record.Name})})),a.fail(function(){b.error("Something went wrong while fetching field set for detail")})}():t.__validationFailed()})},{text:I().T("FSA019_TAG004","Don't Allow"),itemId:"Decline"}]})}},{key:"__restructureData",value:function(e){var t={};return this.__getHeaderRecord(t),t.details={},this.__getDetailRecord(t,e),t}},{key:"__getHeaderRecord",value:function(e){var t=this.record.record;for(var n in t)if("Id"!==n){e[n]={fieldapiname:n,fieldvalue:{}};var i=null===t[n]?"":t[n];"object"!==(void 0===i?"undefined":(0,s.default)(i))?e[n].fieldvalue={key:i,value:i}:e[n].fieldvalue=i}e.Id=t.Id,e.attributes={type:this.record.object,url:"TODO"}}},{key:"__getDetailRecord",value:function(e,t){for(var n=this.record.details,i={},a=0;a<n.length;a++)for(var r=void 0,o=0;o<n[a].records.length;o++)!function(e){var o={},l=n[a].records[e],c=t[n[a].object],u=[];c.forEach(function(e){u.push(e)});for(var d=c.getFieldsByType("reference"),_=c.getFieldsByType("picklist"),h=d.concat(_),f=0;f<h.length;f++){var p=h[f].name,m=l[p],v={fieldapiname:p,fieldvalue:{}},g=null===m?"":m;"object"===(void 0===g?"undefined":(0,s.default)(g))?v.fieldvalue=g:v.fieldvalue={key:g,value:g},o[p]=v}for(var y in l)o[y]||(o[y]=l[y]);i[n[a].object]?(r=i[n[a].object],r.push(o)):r=[o],i[n[a].object]=r}(o);e.details=i}},{key:"_validateKey",value:function(e){var t=!1,n=y.Deferred();return this._invalidateExpiredKeys().then(y.proxy(this,function(){this._getEncryptedKeyToken().then(y.proxy(this,function(){var i=T.readFromJSCache("app-to-app",e);i&&i.length>0&&(T.removeFromJSCache("app-to-app",e),T.writeObjectToDBCache("app-to-app-tokens",T.__getJSCacheItems("app-to-app")),t=!0),n.resolve(t)}))})),n}},{key:"_getEncryptedKeyToken",value:function(){var e=y.Deferred(),t=T.__getJSCacheItems("app-to-app");if(t&&0!=t.length)e.resolve();else{T.readObjectFromDBCache("app-to-app-tokens").then(y.proxy(this,function(t){if(t){var n=t.length;if(n){var i=void 0;for(i=0,T.registerJSCache("app-to-app",n);i<n;i++)T.writeToJSCache("app-to-app",t[i].name,t[i].value)}}e.resolve()}))}return e}},{key:"_invalidateExpiredKeys",value:function(){var e=y.Deferred(),t=E.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss");return this._getEncryptedKeyToken().then(y.proxy(this,function(){var n=T.__getJSCacheItems("app-to-app");n&&n.length>0&&y.array.filter(n,function(e){var n=E.getDurationBetween(e.value,t);Math.abs(n.days())>0&&(T.removeFromJSCache("app-to-app",e.name),T.writeObjectToDBCache("app-to-app-tokens",T.__getJSCacheItems("app-to-app")))}),e.resolve()})),e}},{key:"__isTableInDatabase",value:function(e){return com.servicemax.client.sync.api.Utils.MetaData.getTablesInDatabase()[e]}},{key:"__validateFields",value:function(e,t){for(var n=com.servicemax.client.sync.api.SQLSchema.getTableSchema(e),i=n&&n.fields&&(0,r.default)(n.fields),a=(0,r.default)(t),o=!0,s=0;s<a.length;s++)if(-1===i.indexOf(a[s])){o=!1;break}return o}}]),t}(g),y.defineGlobal(C.name,C),e.exports=C},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=T.Deferred(),n=X.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(n){t.resolve(n.data.data),e.onSuccess&&(e.state?M.proxy(e.context,e.onSuccess)(e.state,n):M.proxy(e.context,e.onSuccess)(n))}),n.bind("REQUEST_ERROR",function(n){Q.error("\n"+n.type+": "+n.data.data+"\nQUERY: "+n.data.parameters.query),t.reject(n.data.data),e.onError&&(e.state?M.proxy(e.context,e.onError)(e.state,n):M.proxy(e.context,e.onError)(n))}),n.execute({query:e.query,queryParams:e.queryParams}),t}var r=n(31),o=i(r),s=n(18),l=i(s),c=n(16),u=i(c),d=n(14),_=i(d),h=n(1),f=i(h),p=n(2),m=i(p),v=n(6),g=i(v),y=n(3),S=i(y),E=n(4),b=i(E),T=n(10),M=n(0).utils,I=n(11).Facade,C=n(11).File,A=n(383).Utilities,D=n(12).DatetimeUtil,x=n(7).Expressions,R=n(7).Data,O=n(7).MetaData,L=n(7).SystemData,k=n(7).SyncData,N=n(7).Cache,w=n(7).Attachments,F=n(7).Record,P=n(7).VirtualRecord,q=n(7).CheckListChunkUtils,V=(n(374).Module,n(5).SVMXObject),B=n(13).Operation,H=n(7).FieldSet,z=n(7).ServerInfo,U=n(384),Y=n(388),W=n(81).js_DAIErrorFactory,G={name:"com.servicemax.client.offline.sal.model.sfmdelivery.operations"},X=I,Q=M.getLoggingService().getLogger("sfm-offline-operations"),J=D,K=x,$=R,Z=O,ee=L,te=k,ne=N,ie=w,ae=F,re=P,oe=q,se=W,le=function(){return M.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},ce=function(e){return M.toObject(e.data.data)};G.Utilities=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).apply(this,arguments))}return(0,b.default)(t,e),(0,g.default)(t,null,[{key:"getProcessComponents",value:function(e){var t=void 0;t=e.salesforceProcessId?M.string.substitute("SELECT parent_column as parent_column, object_name as target_object_name, layout_id, object_mapping_id, value_mapping_id, expression_id, component_type, advanced_options, Id as processComponentId, parent_object, target_object_label FROM SFProcessComponent WHERE process_id = '{{process_id}}'",{process_id:e.salesforceProcessId}):M.string.substitute("SELECT parent_column as parent_column, object_name as target_object_name, layout_id, object_mapping_id, value_mapping_id, expression_id, component_type, advanced_options, SFProcessComponent.Id as processComponentId, parent_object, target_object_label FROM SFProcessComponent LEFT JOIN  SFProcess ON SFProcess.process_id = SFProcessComponent.process_id WHERE process_unique_id = '{{process_id}}'",{process_id:e.processId});var n=X.createSQLRequest();n.bind("REQUEST_ERROR",M.proxy(this,"__getProcessComponentsError",e,t)),n.bind("REQUEST_COMPLETED",M.proxy(this,"__getProcessComponentsSuccess",e,t)),n.execute({query:t})}},{key:"__getProcessComponentsSuccess",value:function(e,t,n){var i=ce(n),a=M.array.map(i,function(e){return{key:e.layout_id,value:e.parent_column,value1:e.advanced_options,fieldsToNull:null}});M.array.forEach(i,function(e){e.advanced_options&&(e.advanced_options=M.toObject(e.advanced_options))}),e.onSuccess&&e.onSuccess(a,i)}},{key:"__getProcessComponentsError",value:function(e,t,n){Q.error("_getProcessComponentsError: "+t+" returns "+n.data),e.onError&&e.onError(n)}}]),t}(V);var ue={};G.GetPageLayout=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){for(var e=["pageLayoutData"],n=e.length,i=n-1;i>=0;i--)this[e[i]]=null;return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n={responder:t,processId:e.processId,processType:null,recordId:e.recordId};ne.readObjectFromDBCache("PURGE_ON_CONFIG_SYNC.GetPageLayout_"+n.processId).then(M.proxy(this,function(e){if(e)return t.result(e),this.doCleanup();a({query:"SELECT SFProcess.process_type, SFProcess.process_name,  SFProcess.process_id, SFProcess.process_unique_id, SFProcessComponent.object_name, SFProcessComponent.enable_attachment, SFPageLayout.page_data FROM SFProcess LEFT JOIN SFProcessComponent ON SFProcess.process_id = SFProcessComponent.process_id LEFT JOIN SFPageLayout ON SFPageLayout.page_layout_id = SFProcess.page_layout_id WHERE process_unique_id = '{{process_id}}' AND component_type='TARGET'",queryParams:{process_id:n.processId}}).then(M.proxy(this,function(e){return this._onGetLayoutSuccess(n,e)}),M.proxy(this,function(e){Q.error("GetPageLayout Failed: "+e)}))}))}},{key:"_onGetLayoutError",value:function(e,t){Q.error(t)}},{key:"_onGetLayoutSuccess",value:function(e,t){var n=new T.Deferred;if(!(t=t[0]))return this._onGetLayoutError(e,"Layout not found");e.processType=t.process_type,e.salesforceProcessId=t.process_id;var i=M.toObject(t.page_data);return i.processTitle=t.process_name,i.header.headerLayout[M.OrgNamespace+"__Enable_Attachments__c"]="true"==t.enable_attachment,a({query:"Select label FROM SFObjectDescribe where object_name ='{{source}}'",queryParams:{source:i.header.headerLayout[M.OrgNamespace+"__Object_Name__c"]}}).then(M.proxy(this,function(n){try{i.header.headerLayout[M.OrgNamespace+"__Page_Layout_ID__c"]=n[0].label}catch(e){Q.error("Unexpected error in the object label THEN handler:"+e)}if(e.processName=t.process_name,e.tableName=t.object_name,!i.details)return Q.info("Page layout data missing for process "+t.process_id),this._onGetLayoutError(e,"No pageLayout.details found");M.array.forEach(i.details,function(e){e.linkedProcesses=[]}),this.__cacheChildRecordTemplates(e.salesforceProcessId,i),e.fullData={response:{},page:i}})).then(M.proxy(this,function(){var n=new T.Deferred;"CHECKLIST"===e.processType?n=this.__buildQuestionInfoJSON(e,t.page_data):n.resolve()})).then(M.proxy(this,function(){this.__buildFieldMapping(e,t.page_data)})).then(M.proxy(this,function(){G.Utilities.getProcessComponents({salesforceProcessId:e.salesforceProcessId,onSuccess:M.proxy(this,"_onGetProcessComponents",e),onError:M.proxy(this,function(e){Q.error("_onGetPageLayoutSuccess failed to get StringMap")})}),n.resolve()})),n}},{key:"__buildQuestionInfoJSON",value:function(e,t){var n=new T.Deferred,i={Short_Name:"shortname",Scale:"scale",Response_Type:"responseType",QuestionJSON:"questionJSON",QuestionID:"questionID",Question:"question",Precision:"precision",Length:"length",Help_URL:"helpURL",Description:"description",Id:"id",Name:"name",Response_Set_Values:"responseSetValues",Response_Set:"responseSet",CreatedBy:"createdBy",CurrencyIsoCode:"currencyIsoCode",LastModifiedBy:"lastModifiedBy",Show_In_SmartDoc:"ShowInSmartDoc",Description_Required:"DescriptionRequired"};try{var r=M.array.map(t.match(/"SVMX(?:DEV|C)__Question__c":".*?"/g)||[],function(e){return e.split(/":"/)[1].replace(/"/,"")});if(0===r.length)return n.resolve(),n;a({query:"Select MAIN.*, sfqbr.Response_Set_Values FROM SFQuestionBank AS MAIN LEFT JOIN SFQBResponseSet AS sfqbr ON MAIN.Response_Set = sfqbr.Id WHERE MAIN.Id IN ('{{question_ids}}') ",queryParams:{question_ids:r.join("','")}}).then(M.proxy(this,function(t){for(var t,r=[],o=0;o<t.length;o++)r.push(t[o].Id);a({query:"Select * from SFChecklistDefaultResponseSet where Question in ('{{question_ids}}')",queryParams:{question_ids:r.join("','")}}).then(M.proxy(this,function(a){for(var r={},o=0;o<t.length;o++){var s=t[o],l=[],c={},u={},d=s.Id;s.hasOwnProperty("Precision")&&(s.Precision=""===s.Precision?null:s.Precision),s.hasOwnProperty("Scale")&&(s.Scale=""===s.Scale?null:s.Scale),s.hasOwnProperty("Length")&&(s.Length=""===s.Length?null:s.Length),s.hasOwnProperty("Show_In_SmartDoc")&&(s.Show_In_SmartDoc="true"==s.Show_In_SmartDoc),s.hasOwnProperty("Description_Required")&&(s.Description_Required="true"==s.Description_Required);for(var _ in s)if(c[i[_]]=s[_],"Response_Set_Values"===_&&null!=c[i[_]])for(var h=c[i[_]].split(";"),f=0;f<h.length;f++)if(""!=h[f]){var p={questionID:c.id,response:h[f],sequence:f};l.push(p)}c.active="false"!==String(c.active);for(var m=a.length,v=0;v<m;v++)if(d==a[v].Question){u.Id=a[v].Id,u[M.OrgNamespace+"__SM_Default_Response__c"]=a[v].DefaultResponse,u[M.OrgNamespace+"__SM_Is_literal_Used__c"]=a[v].Is_literal_Used,u[M.OrgNamespace+"__SM_Question__c"]=a[v].Question;break}var g={question:c,questionResponses:l,defaultChecklistRes:u};g.question.id;r[c.id]=M.toJSON(g)}for(var o=0;o<e.fullData.page.header.sections.length;o++)for(var y=e.fullData.page.header.sections[o].fields,f=0;f<y.length;f++){var S=y[f].fieldDetail,E=S[M.OrgNamespace+"__Question__c"];S[M.OrgNamespace+"__QuestionInfoJSON__c"]=r[E]}n.resolve()}))}))}catch(e){return n.resolve(),n}return n}},{key:"__buildFieldMapping",value:function(e,t){var n=new T.Deferred;try{var i=M.getCustomFieldName("Field_Mapping"),r=new RegExp('"'+i+'":".*?"',"g"),o=M.array.map(t.match(r)||[],function(e){return e.split(/":"/)[1].replace(/"/,"")});if(0===o.length)return n.resolve(),n;for(var s=o.length-1;s>=0;s--){var l=M.array.indexOf(o,o[s]);l>-1&&l<s&&M.array.removeElementAt(o,s)}e.fullData.page.lstObjectMapInfo=M.array.map(o,function(e){return{mapId:e,objectMap:{fields:[]}}}),a({query:"Select object_mapping_id, source_field_name, target_field_name, mapping_value, preference_2, preference_3, object_mapping_id || source_field_name || target_field_name || mapping_value as myconcat FROM SFObjectMappingComponent WHERE object_mapping_id IN ('{{object_mapping_id}}') GROUP BY myconcat",queryParams:{object_mapping_id:o.join("','")}}).then(M.proxy(this,function(t){M.array.forEach(t,function(t){var n=M.array.indexOf(e.fullData.page.lstObjectMapInfo,function(e){return e.mapId==t.object_mapping_id}),i=e.fullData.page.lstObjectMapInfo[n].objectMap.fields,a={};a[M.getCustomFieldName("Source_Field_Name")]=t.source_field_name,a[M.getCustomFieldName("Target_Field_Name")]=t.target_field_name,a[M.getCustomFieldName("Display_Value")]=t.mapping_value,a[M.getCustomFieldName("Preference_2")]=t.preference_2,a[M.getCustomFieldName("Preference_3")]=t.preference_3,i.push({fieldMapRecord:a})},this),n.resolve()}))}catch(e){return n.resolve(),n}return n}},{key:"__cacheChildRecordTemplates",value:function(e,t){var n=t.details;if(n&&n.length>0){var i=void 0,a=n.length,r=void 0,o=void 0,s=void 0,l=void 0;for(i=0;i<a;i++)if(r=n[i].recordTemplate){o=n[i].dtlLayoutId,s=[{sobjectinfo:r,bubbleInfo:[]}];for(var c in r)"attributes"!=c&&"attributes__key"!=c&&s[0].bubbleInfo.push({fieldapiname:c,fieldvalue:{value:r[c],value1:r[c]}});l=e+"-"+o,ue[l]=s}}}},{key:"_onGetProcessComponents",value:function(e,t,n){if(n){var i=void 0,a=n.length;for(i=0;i<a;i++)if("TARGET"==n[i].component_type)try{e.fullData.page.header.headerLayout[M.OrgNamespace+"__Page_Layout_ID__c"]=n[i].target_object_label}catch(e){Q.error("Unexpected error while updating Header Page Layout Id with Header Alias Name")}}t.unshift({value1:null,value:e.processType,key:"PROCESSTYPE",fieldsToNull:null}),e.fullData.response.stringMap=t,e.fullData=this.__restructureData(e.fullData),this.pageLayoutData=e.fullData,"VIEW RECORD"===e.fullData.response.sfmProcessType?this.__onDone(e):(e.processComponentList=n,M.doLater(M.proxy(this,"getLinkedProcesses",e)))}},{key:"__onDone",value:function(e){var t=this;t.__validateReferenceObjectDefinitions(e.fullData).then(function(){t.__buildLookupDisplayFieldMap(e.fullData),e.fullData.processTitle=e.processName,ne.writeToDBCache("PURGE_ON_CONFIG_SYNC.GetPageLayout_"+e.processId,M.toJSON(e.fullData)),e.responder.result(e.fullData),t.doCleanup()})}},{key:"__validateReferenceObjectDefinitions",value:function(e){var t=new T.Deferred,n=[],i={};if((e.page.header.sections||[]).forEach(function(e){(e.fields||[]).forEach(function(e){if("reference"==e.fieldDetail[M.OrgNamespace+"__DataType__c"]&&"Question"!=e.fieldDetail[M.OrgNamespace+"__Detail_Type__c"]){var t=e.fieldDetail[M.OrgNamespace+"__Related_Object_Name__c"];t in i||(i[t]=[],n.push(t)),i[t].push(e.fieldDetail)}})}),(e.page.details||[]).forEach(function(e){(e.fields||[]).forEach(function(e){if("reference"==e.fieldDetail[M.OrgNamespace+"__DataType__c"]&&"Question"!=e.fieldDetail[M.OrgNamespace+"__Detail_Type__c"]){var t=e.fieldDetail[M.OrgNamespace+"__Related_Object_Name__c"];t in i||(i[t]=[],n.push(t)),i[t].push(e.fieldDetail)}})}),n.length){var a=X.createSQLRequest();a.bind("REQUEST_COMPLETED",M.proxy(this,function(e){var n={};(e?e.data.data:[]).forEach(function(e){n[e.object_name]=!0});for(var a in i)a in n||i[a].forEach(function(e){e[M.OrgNamespace+"__Readonly__c"]=!0});t.resolve()})),a.bind("REQUEST_ERROR",M.proxy(this,function(e){t.resolve()})),a.execute({query:"SELECT object_name FROM SFObjectDescribe WHERE object_name IN ('"+n.join("','")+"')"})}else t.resolve();return t}},{key:"__buildLookupDisplayFieldMap",value:function(e){var t={},n=M.getCustomRelationName("Named_Search");(e.page.header.sections||[]).forEach(function(e){(e.fields||[]).forEach(function(e){if("reference"==e.fieldDetail[M.getCustomFieldName("DataType")]){var i=e.fieldDetail[M.getCustomFieldName("Field_API_Name")];t[i]=e.fieldDetail[n]&&e.fieldDetail[n][M.getCustomFieldName("Default_Lookup_Column")]}})});var i={head:t},a=i.details={};(e.page.details||[]).forEach(function(e){t={},(e.fields||[]).forEach(function(e){if("reference"==e.fieldDetail[M.getCustomFieldName("DataType")]){var i=e.fieldDetail[M.getCustomFieldName("Field_API_Name")];t[i]=e.fieldDetail[n]&&e.fieldDetail[n][M.getCustomFieldName("Default_Lookup_Column")]}}),a[e.DetailLayout.Id]=t}),e.lookupDisplayFieldMap=i}},{key:"__restructureData",value:function(e){var t=e.response.stringMap,n=void 0,i=t.length;for(n=0;n<i;n++)if("PROCESSTYPE"==t[n].key){e.response.sfmProcessType=t[n].value;break}return e}},{key:"getLinkedProcesses",value:function(e){a({query:"Select * FROM SFLinkedProcess WHERE source_header = '{{source}}'",queryParams:{source:e.salesforceProcessId},state:e,context:this,onSuccess:"_getLinkedProcessesSuccess",onError:"_getLinkedProcessesError"})}},{key:"_getLinkedProcessesSuccess",value:function(e,t){var n=t.data.data,i=void 0,r=[];for(n=M.array.filter(n,function(e){return e.target_header}),i=0;i<n.length;i++)r.push(n[i].target_header);e.allLinkedProcess=n,a({query:"Select * FROM SFProcess WHERE process_id in ('{{pids}}')",queryParams:{pids:r.join("','")},state:e,context:this,onSuccess:"_getLinkedProcessesInfoSuccess",onError:"_getLinkedProcessesError"})}},{key:"_getLinkedProcessesInfoSuccess",value:function(e,t){var n=this,i=e.allLinkedProcess,a=void 0,r=i.length,o=void 0,s=void 0,l=void 0,c=1;for(a=0;a<r;a++)if(o=i[a],s=o.source_detail,l=function(t){var i=e.processComponentList||[],a=void 0,r=i.length,o=null,s=null;for(a=0;a<r;a++)if(i[a].processComponentId==t){s=i[a].layout_id;for(var l in n.pageLayoutData.page.details)if(n.pageLayoutData.page.details[l].dtlLayoutId==s){o=n.pageLayoutData.page.details[l];break}break}return o}(s)){var u=function(e){var n=t.data.data,i=void 0,a=n.length,r=null;for(i=0;i<a;i++)if(n[i].process_id==e){r=n[i];break}return r}(o.target_header);l.linkedProcesses=l.linkedProcesses||[],u&&l.linkedProcesses.push({title:u.process_name,processId:u.process_unique_id,sequence:c++})}M.doLater(M.proxy(this,"getBusinessRules",e))}},{key:"_getLinkedProcessesError",value:function(e,t){M.doLater(M.proxy(this,"getBusinessRules",e))}},{key:"getBusinessRules",value:function(e){var t=e.salesforceProcessId;e.bzInfo={},a({query:"Select * FROM SFProcessBusinessRule WHERE target_manager = '{{processId}}'",queryParams:{processId:t},state:e,context:this,onSuccess:"_getProcessBusinessRuleSuccess",onError:"_getBusinessRulesError"})}},{key:"_getProcessBusinessRuleSuccess",value:function(e,t){var n=e.bzInfo.pbz=t.data.data,i=void 0,r=n.length,o=[],s={};if(0===n.length)return void this.__onDone(e);for(i=0;i<r;i++)s[n[i].business_rule]=n[i].business_rule;for(var l in s)o.push(l);a({query:"Select * FROM SFBusinessRule WHERE Id in ('{{ids}}')",queryParams:{ids:o.join("','")},state:e,context:this,onSuccess:"_getBusinessRuleSuccess",onError:"_getBusinessRulesError"})}},{key:"_getBusinessRuleSuccess",value:function(e,t){var n=e.bzInfo.bz=t.data.data,i=void 0,r=n.length,o=[],s={};for(i=0;i<r;i++)s[n[i].Id]=n[i].Id;for(var l in s)o.push(l);a({query:"Select * FROM SFExpressionComponent WHERE expression_id in ('{{ids}}') and expression_type IN ('Business_Rule', 'Field_Update_Rule')",queryParams:{ids:o.join("','")},state:e,context:this,onSuccess:"_getBusinessRuleExpressionsSuccess",onError:"_getBusinessRulesError"})}},{key:"_getBusinessRuleExpressionsSuccess",value:function(e,t){function n(t){for(var n=t,i=e.bzInfo.pbz,a=e.bzInfo.pbz.length,r=void 0,o=0;o<a;o++)if(n===i[o].Id){r=i[o];break}return r}e.bzInfo.bzExp=t.data.data,function(){var t=e.bzInfo.bzExp||[],n=void 0,i=t.length,a={};for(n=0;n<i;n++)a[t[n].expression_id+"."+t[n].sequence]=t[n];t=e.bzInfo.bzExp=[];for(var r in a)t.push(a[r])}();var i=this.pageLayoutData.page.businessRules=[],a=this;for(var r in e.bzInfo.pbz){var o=e.bzInfo.pbz[r].process_node_object,s=function(t){var n=e.processComponentList||[],i=void 0,r=n.length,o=null;for(i=0;i<r;i++)if(n[i].processComponentId==t){var s=n[i].layout_id;for(var l in a.pageLayoutData.page.details)if(a.pageLayoutData.page.details[l].dtlLayoutId==s){o=a.pageLayoutData.page.details[l].DetailLayout[M.OrgNamespace+"__Page_Layout_ID__c"];break}break}return o}(o),l=e.bzInfo.pbz[r].business_rule,c=function(t,i){var a=e.bzInfo.bz||[],r=void 0,o=a.length,s={};for(r=0;r<o;r++)if(a[r].Id==t){var l=a[r];s={},"CHECKLIST"===e.processType&&(s.source_object_name=M.getCustomObjectName("Checklist"));var c=n(i);if(c){s.Name=l.name,s[M.OrgNamespace+"__ProcessID__c"]=l.process_ID,s[M.OrgNamespace+"__Description__c"]=l.description,s[M.OrgNamespace+"__Source_Object_Name__c"]=l.source_object_name,s[M.OrgNamespace+"__Parent_Error_Msg__c"]=l.error_msg,s[M.OrgNamespace+"__Advance_Expression__c"]=l.advanced_expression,s[M.OrgNamespace+"__Message_Type__c"]=l.message_type,s[M.OrgNamespace+"__Rule_Type__c"]=l.rule_type,s[M.OrgNamespace+"__SM_Section__c"]=c.section,s[M.OrgNamespace+"__SM_Target_Section__c"]=c.target_section,s[M.OrgNamespace+"__Sequence__c"]=c.sequence;break}}return s}(l,e.bzInfo.pbz[r].Id),u=function(t){var n=e.bzInfo.bzExp||[],i=void 0,a=n.length,r=[],o=void 0;for(i=0;i<a;i++)n[i].expression_id==t&&(o=n[i],r.push(o),o[M.OrgNamespace+"__Expression_Rule__c"]=o.expression_id,o[M.OrgNamespace+"__Field_Name__c"]=o.source_field_name,o[M.OrgNamespace+"__Operator__c"]=o.operator,o[M.OrgNamespace+"__Operand__c"]=o.value,o[M.OrgNamespace+"__Display_Type__c"]=o.field_type,o[M.OrgNamespace+"__Sequence__c"]=o.sequence,o[M.OrgNamespace+"__Parameter_Type__c"]=o.parameter_type,o[M.OrgNamespace+"__Expression_Type__c"]=o.expression_type,o[M.OrgNamespace+"__Formula__c"]=o.formula,o[M.OrgNamespace+"__Action_Type__c"]=o.action_type);return r}(l),d={aliasName:s,sequence:e.bzInfo.pbz[r].sequence,message:e.bzInfo.pbz[r].error_msg,ruleInfo:{bizRule:c,bizRuleDetails:u}};i.push(d)}this.__onDone(e)}},{key:"_getBusinessRulesError",value:function(e,t){this.__onDone(e)}}]),t}(B),G.RetrieveSettings=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){a({query:"SELECT setting_id, value FROM MobileDeviceSettings",state:t,context:this,onSuccess:"_onSuccess",onError:"_onError"})}},{key:"_onError",value:function(e,t){Q.error("RetrieveSettings failed: "+t.data)}},{key:"_onSuccess",value:function(e,t){var n=ce(t),i=[];M.array.forEach(n,function(e){i.push({value:e.value,key:e.setting_id})}),e.result({stringMap:i})}}]),t}(B);G.GetDetailMappedInfo=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=e.processId,i={mappedLiterals:[],mappedValues:[]};a({query:"SELECT process_id FROM SFProcess where process_unique_id='{{pid}}'",queryParams:{pid:n}}).then(M.proxy(this,function(n){if(!n||0==n.length){t.result(i);var r=new T.Deferred;return r.fail(),r}return n=n[0],a({query:"SELECT object_name, object_mapping_id, value_mapping_id FROM SFProcessComponent where process_id='{{processId}}' and layout_id='{{alias}}'",queryParams:{processId:n.process_id,alias:e.alias}})})).then(M.proxy(this,function(e){if(!e||0==e.length){t.result(i);var n=new T.Deferred;return n.fail(),n}var n=new T.Deferred;e=e[0];var r=new ae({},e.object_name);return r.onReady(function(){var t=[];e.value_mapping_id&&t.push(e.value_mapping_id),e.object_mapping_id&&t.push(e.object_mapping_id),a({query:"SELECT * FROM SFObjectMappingComponent WHERE object_mapping_id IN ('{{ids}}')",queryParams:{ids:t.join("', '")}}).then(function(e){try{n.resolve(e,r)}catch(e){Q.error(e),Q.error("Unexpected error in THEN handler for getDetailMappedInfo operation:"+e)}})}),n})).then(M.proxy(this,function(e,n){if(!e||0==e.length){t.result(i);var a=new T.Deferred;return a.fail(),a}var r=[];M.array.forEach(e,function(e){if(!e.source_field_name)if(e.mapping_value.match(/^SVMX\./)||-1!==M.array.indexOf(["Now","Today","Tomorrow","Yesterday"],e.mapping_value))i.mappedLiterals.push({key:e.target_field_name,value:e.mapping_value});else{var t=n.getFieldType(e.target_field_name);if(!t)return void console.error("User does not have permission to use: "+e.target_field_name);if("boolean"==t&&(e.mapping_value=String(e.mapping_value).toLowerCase()),"reference"==t&&"RecordTypeId"!=e.target_field_name){var a=e.mapping_value,o=new T.Deferred;$.getRecord({Id:a,loadReferences:!1,convertPicklists:!1}).then(function(t){i.mappedValues.push({key:e.target_field_name,value:t.getNameValue()}),o.resolve()},function(t){i.mappedValues.push({key:e.target_field_name,value:a}),o.resolve()}),r.push(o)}else i.mappedValues.push({key:e.target_field_name,value:e.mapping_value})}},this),M.when(r).then(function(){t.result(i)})}))}}]),t}(B),G.GetLookupConfig=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){for(var e=["__actualLookupAdvFilter","displayFields","searchFields"],n=e.length,i=n-1;i>=0;i--)this[e[i]]&&(this[e[i]].length=0,this[e[i]]=null);for(var a=["keyWord","searchOperator","contextValue","contextMatchField","callType","request","objectName","recordId","searchOnlineRecord","__queryWithAFC","__actualLookupPreFilter","currentRecordId","response","describeData","fieldDefs","afc","pfc","referenceFields"],r=a.length,o=r-1;o>=0;o--)this[a[o]]=null;return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n={};this.keyWord=null==e.KeyWord?"":e.KeyWord,this.searchOperator=e.SearchOperator,this.contextValue=e.LookupContext,void 0!==this.contextValue&&null!==this.contextValue||(this.contextValue=""),this.contextMatchField=e.LookupQueryField,this.callType=e.callType,this.request=e,this.objectName=e.ObjectName,this.recordId=e.RecordId,this.searchOnlineRecord=e.searchOnlineRecord,this.__queryWithAFC=null,this.__actualLookupPreFilter=null,this.__actualLookupAdvFilters=[],this.currentRecordId=e.currentRecordId,this.response={namesearchinfo:{namedSearch:[{namedSearchHdr:{},namedSearchDetails:[{fields:[]}]}]},data:[],advFilters:[]},t.__waitCounter={count:0,subRecordsStarted:!1},Z.describeObject({objectName:this.objectName,onSuccess:M.proxy(this,function(i){if(this.describeData=i,this.fieldDefs={},M.array.forEach(i.fields,function(e){this.fieldDefs[e.name]=e},this),e.LookupRecordId){var r=e.LookupRecordId;this.queryLookupData(t,r,n)}else a({query:"SELECT * FROM SFNamedSearch where object_name = '{{object_name}}' and is_default='true'",queryParams:{object_name:this.objectName}}).then(M.proxy(this,function(e){e&&e.length?(key=e[0].search_sfid,this.queryLookupData(t,key,n)):(Q.error("CONFIGURATION WARNING: There is neither a configured nor default LookupConfig for "+this.objectName),this.generateLookupData(this.objectName,t,n))})),key=this.objectName}),onError:M.proxy(this,function(e,n){t.fault(e,n)})})}},{key:"generateLookupData",value:function(e,t,n){t.__waitCounter.count++,t.__waitCounter.subRecordsStarted=!0;var i=Z.getNameField(this.objectName),a=[{expression_type:"SRCH_Object_Fields",field_name:i,search_object_field_type:"Search",field_type:"",field_relationship_name:"",sequence:"1.0000"},{expression_type:"SRCH_Object_Fields",field_name:i,search_object_field_type:"Result",field_type:"",field_relationship_name:"",sequence:"2.0000"}],r={bubbleFields:[],defaultLookupColumn:i,displayFields:[a[1]],numberOfRecs:10,preFilterCriteria:"",queryColumns:"Id, Name",searchFields:[a[0]]},o={key:e,advFilters:[],lookupDefDetail:r};this.__prepareSearchUsingLookupDef({responder:t,result:n},o)}},{key:"queryLookupData",value:function(e,t,n){e.__waitCounter.count++,a({query:"SELECT * FROM SFNamedSearchComponent WHERE named_search = '{{key}}'",queryParams:{key:t},state:{responder:e,result:n},context:this,onSuccess:"_onQueryLookupDataSuccess",onError:"_onQueryLookupDataError"})}},{key:"_onQueryLookupDataSuccess",value:function(e,t){e.responder.__waitCounter.subRecordsStarted=!0;var n=ce(t),i=n.length?n[0].named_search:null,a=void 0,r=n.length;if(0==n.length)return void this._onGetLookupDefError(e.responder,M.cloneObject(this.response),t);var o=this.describeData,s={};M.array.forEach(o.fields,function(e){s[e.name]=!0}),this.displayFields=[],this.searchFields=[];var l={},c={};for(a=0;a<r;a++){var u=n[a].field_name;s[u]?("Result"==n[a].search_object_field_type&&(l[n[a].field_name]||(this.displayFields.push(n[a]),l[n[a].field_name]=!0)),"Search"==n[a].search_object_field_type&&(c[n[a].field_name]||(this.searchFields.push(n[a]),c[n[a].field_name]=!0))):Q.error("Minor Error: Lookup Config uses field '"+u+"' which is not available to this user")}this.getLookupDef(e.responder,i,e.result,l)}},{key:"_onQueryLookupDataError",value:function(e,t){Q.info("No lookup data, NamedSearchComponent table might be empty"),responder.result(e.result),this.doCleanup()}},{key:"getLookupDef",value:function(e,t,n,i){a({query:"SELECT * FROM SFNamedSearch where search_sfid = '{{key}}'",queryParams:{key:t},state:{responder:e,result:n,key:t},context:this,onSuccess:"_onGetLookupDefSuccess",onError:"_onGetLookupDefError"})}},{key:"_onGetLookupDefSuccess",value:function(e,t){e.result.data=ce(t);var n=e.result.data[0].object_name,i=this,a=this.displayFields,r=this.searchFields,o=(e.result.data[0].no_of_lookup_records,this.getPreFilterCriteria(e.responder,e.key,e.result)),s=this.getAdvFilterCriteria(e.responder,e.key,e.result);M.when([o,s]).then(M.proxy(this,function(){i.pfc&&(i.pfc=i.__convertOnlineExpressionToSQL(i.pfc));for(var t=[],o=0;o<i.afc.length;o++){i.afc[o].filterCriteria.indexOf("RecordType.Name")>=0&&t.push(this.__getRecordTypeId(o))}M.when(t).then(M.proxy(this,function(){var t=n&&"case"===n.toLowerCase()?"Id":"Id, Name",o={bubbleFields:[],defaultLookupColumn:e.result.data[0].default_lookup_column,displayFields:a,numberOfRecs:e.result.data[0].no_of_lookup_records,preFilterCriteria:i.pfc,queryColumns:t,searchFields:r};if(null!=o.displayFields&&o.displayFields.length>0){var s=o.displayFields,l=0,c=s.length,u="",d={Id:!0,Name:!0};for(l=0;l<c;l++)d[s[l].field_name]||(u.length>0?u+=", "+s[l].field_name:u+=s[l].field_name),s[l].field_name&&s[l].field_type&&"REFERENCE"===s[l].field_type&&s[l].field_relationship_name&&s[l].field_relationship_name.length>0&&!d[s[l].field_relationship_name]&&(d[s[l].field_relationship_name]=!0,u.length>0?u+=", "+s[l].field_relationship_name+".Name":u+=s[l].field_relationship_name+".Name"),d[s[l].field_name]=!0;u.length>0&&(o.queryColumns+=", "+u)}var _={key:n,advFilters:i.afc,lookupDefDetail:o};return i.__prepareSearchUsingLookupDef(e,_)}))}))}},{key:"__getRecordTypeId",value:function(e){var t=new T.Deferred,n=this.afc[e].filterCriteria,i=n.match(/RecordType.Name=['].+?[']/g)[0];return a({query:"SELECT * FROM RecordType WHERE Name='{{recordTypeName}}' AND SobjectType='{{objectType}}'",queryParams:{recordTypeName:i.substring(i.indexOf("'")+1,i.length-1),objectType:this.afc[e].filterObject}}).then(M.proxy(this,function(i){var a=n.match(/RecordType.Name=['].+?[']/g)[0];this.afc[e].filterCriteria=n.replace(a,"RecordTypeId='"+i[0].Id+"'"),t.resolve()})),t}},{key:"__convertOnlineExpressionToSQL",value:function(e){var t=e.match(/(?:([A-z0-9_-]+ ?(?:<>|!=|=) ?[^ ()]+)(?: ?(?:AND|OR))?)+/gi);if(t)for(var n in t){var i=t[n].match(/([A-z0-9_-]+ ?!= ?(?:NULL)+)/gi),a=t[n].match(/([A-z0-9_-]+ ?= ?(?:NULL)+)/gi),r=t[n].match(/([A-z0-9_-]+ ?(?:<>|!=|=) ?(?:true)+)/gi),o=t[n].match(/([A-z0-9_-]+ ?(?:<>|!=|=) ?(?:false)+)/gi);if(null!=i){var s=i[0].match(/([A-z0-9_-]+)/gi);e=e.replace(i[0],"("+s[0]+" IS NOT NULL AND "+s[0]+" IS NOT '')")}if(null!=a){var l=a[0].match(/([A-z0-9_-]+)/gi);e=e.replace(a[0],"("+l[0]+" IS NULL OR "+l[0]+" IS '')")}if(null!=r){var c=r[0].match(/([A-z0-9_-]+ ?(?:<>|!=|=))/gi);e=e.replace(r[0],c[0]+"'true'")}if(null!=o){var u=o[0].match(/([A-z0-9_-]+ ?(?:<>|!=|=))/gi);e=e.replace(o[0],u[0]+"'false'")}}return e}},{key:"__prepareSearchUsingLookupDef",value:function(e,t){var n,i,a=this,r=a.response.namesearchinfo.namedSearch[0].namedSearchHdr,o=a.response.namesearchinfo.namedSearch[0].namedSearchDetails[0],s=o.fields;r[M.OrgNamespace+"__Default_Lookup_Column__c"]=t.lookupDefDetail.defaultLookupColumn;var l,c=t.lookupDefDetail.displayFields,i=c.length;for(n=0;n<i;n++)l={},l[M.OrgNamespace+"__Field_Name__c"]=c[n].field_name,l[M.OrgNamespace+"__Sequence__c"]=c[n].sequence,l[M.OrgNamespace+"__Search_Object_Field_Type__c"]="Result",l.nameField=null,l.dataType=c[n].field_type,l.relationshipName=c[n].field_relationship_name,s.push(l);var u={};"DATA"!=a.callType&&"BOTH"!=a.callType&&"META"!=a.callType&&"BUBBLE"!=a.callType||(u.lookupRequest={LookupDef:t,KeyWord:a.keyWord,Operator:a.searchOperator,ContextValue:a.contextValue,ContextMatchField:a.contextMatchField});this.keyWord,this.searchOperator,this.contextValue,this.contextMatchField;this.getLUPSearchResults(e.responder,e.result,u.lookupRequest,s,e.key,t.lookupDefDetail.numberOfRecs)}},{key:"getPreFilterCriteria",value:function(e,t,n){var i=new T.Deferred;return a({query:"SELECT * FROM SFNamedSearchCriteria WHERE named_search = '{{key}}' AND rule_type = 'SRCH_OBJECT'",queryParams:{key:t},context:this,state:{responder:e,key:t,result:n,d:i},onSuccess:"_onGetPFCSuccess",onError:"_onGetPFCError"}),i}},{key:"getAdvFilterCriteria",value:function(e,t,n){var i=new T.Deferred;return a({query:"SELECT * FROM SFNamedSearchCriteria WHERE named_search = '{{key}}' AND rule_type = 'SRCH_CRITERIA'",queryParams:{key:t},context:this,state:{responder:e,key:t,result:n,d:i},onSuccess:"_onGetAFCSuccess",onError:"_onGetAFCError"}),i}},{key:"_onGetAFCSuccess",value:function(e,t){this.afc=ce(t);for(var n=[],i=this.afc,a=i.length,r=!1,o=0;o<a;o++){if(n.length>0)for(var s=0;s<n.length;s++)n[s].key==this.afc[o].id&&(r=!0);r||this.__actualLookupAdvFilters.push({key:i[o].id,filterCriteria:i[o].parent_object_criteria}),n.push({allowOverride:i[o].allow_override,defaultOn:i[o].default_on,filterCriteria:this.__convertOnlineExpressionToSQL(this.sqlFixCriteria(i[o].parent_object_criteria)),filterCriteriaFields:[],filterName:i[o].name,filterObject:i[o].source_object_name,key:i[o].id,lookupField:i[o].field_name}),r=!1}this.afc=n,e.d.resolve()}},{key:"_onGetPFCSuccess",value:function(e,t){var n=ce(t);this.__actualLookupPreFilter=n[0].parent_object_criteria,this.pfc=this.sqlFixCriteria(n[0].parent_object_criteria),e.d.resolve()}},{key:"_onGetLookupDefError",value:function(e,t){Q.info("Could not fetch lookupdef, NamedSearch table might be empty"),this.afc=[],e.d.resolve()}},{key:"getLUPSearchResults",value:function(e,t,n,i,a,r){var o=X.createSQLRequest(),s=n.KeyWord,l=n.LookupDef,c=[],u=[],d=[],_=[],h=[],f=n.Operator;this.referenceFields={};var p,m=null,v=l.lookupDefDetail.preFilterCriteria||"",g={},y=l.lookupDefDetail.displayFields,S=y.length;for(p=0;p<S;p++){var E=this.fieldDefs[y[p].field_name];if("reference"==E.type){var b=M.array.get(E.referenceTo,function(e){return Z.isTableInDatabase(e)});!m&&b&&"RecordType"==b&&(m="tbl"+p),b&&(g[b]="tbl"+p),this._addReferenceToQuery({fieldDef:E,joinCols:_,displayCols:c,relatedDisplayCols:u,searchCols:null,alias:"tbl"+p}),h.push({key:E.relationshipName,value:"tbl"+p})}else c.push("MAIN."+y[p].field_name)}var p,T=l.lookupDefDetail.searchFields,S=T.length;for(p=0;p<S;p++){var E=this.fieldDefs[T[p].field_name];if("reference"==E.type){var b=M.array.get(E.referenceTo,function(e){return Z.isTableInDatabase(e)});!m&&b&&"RecordType"==b&&(m="tblsearch"+p),b&&(g[b]="tblsearch"+p),this._addReferenceToQuery({fieldDef:E,joinCols:_,displayCols:null,relatedDisplayCols:null,searchCols:d,alias:"tblsearch"+p})}else d.push("MAIN."+T[p].field_name+" qry")}if(!m&&v&&v.indexOf("RecordType.Name")>0){var E=this.fieldDefs.RecordTypeId;m="tblsearchRecordType",b&&(g.RecordType="tblsearchRecordType"),this._addReferenceToQuery({fieldDef:E,joinCols:_,displayCols:null,relatedDisplayCols:null,searchCols:d,alias:"tblsearchRecordType"})}s.match("_local_")&&(s=s.replace(/ /g,""),d.push("MAIN.Id qry"));var I=1;void 0!=n.ContextMatchField&&void 0!=n.ContextValue&&(I=this.stitchLUPContextToQuery(n,e));var C=this.stitchAdvFiltersToQuery(l,e,a),A="";if(this.__queryWithAFC=C,C.advFilters.length>0){for(var D=0;D<C.advFilters.length;D++){var x=C.advFilters[D];_.push(M.string.substitute("LEFT JOIN '{{advFilterObj}}' ON '{{advFilterObj}}'.'{{lupField}}' = MAIN.Id",{advFilterObj:x.filterObject,lupField:x.lookupField})),D>0&&(A+=" AND ");var R=x.filterCriteria;R=this.__prependAliasToField(R,x.filterObject),A+=R}A="("+A+")"}m&&(l.lookupDefDetail.preFilterCriteria&&(l.lookupDefDetail.preFilterCriteria=l.lookupDefDetail.preFilterCriteria.replace("RecordType.Name",m+".Name")),A&&(A=A.replace("RecordType.Name",m+".Name"))),A=this.sqlAliasPrepSub(A,y),l.lookupDefDetail.preFilterCriteria=this.sqlAliasPrepSub(l.lookupDefDetail.preFilterCriteria,y),A=M.string.substitute(A,g),l.lookupDefDetail.preFilterCriteria=M.string.substitute(l.lookupDefDetail.preFilterCriteria,g);var O=M.string.substitute("SELECT DISTINCT MAIN.* FROM `{{object_name}}` AS MAIN "+_.join("\n")+" WHERE (temp)",{object_name:this.objectName}),L=this.buildQuery(O,f,c,u,d,s,l,e,a,this.objectName,A,I,h);this.recordId?L+=" AND MAIN.Id='"+this.recordId+"'":L+=" LIMIT "+r,o.bind("REQUEST_COMPLETED",M.proxy(this,"_getLUPSearchResultsSuccess",e,t,n,i,L)),o.bind("REQUEST_ERROR",M.proxy(this,"_getLUPSearchResultsError",e,t,n,i)),o.execute({query:L})}},{key:"_addReferenceToQuery",value:function(e){var t=M.array.get(e.fieldDef.referenceTo,function(e){return Z.isTableInDatabase(e)});if(t){var n=Z.getNameField(t);n&&(this.referenceFields[e.fieldDef.name]=t,e.joinCols.push(M.string.substitute("LEFT JOIN `{{related_table_name}}` as {{alias}} ON {{alias}}.Id = {{table_alias}}.{{source_field_name}}",{table_name:this.objectName,alias:e.alias,source_field_name:e.fieldDef.name,related_table_name:t,table_alias:"MAIN"})),e.joinCols.push(M.string.substitute("LEFT JOIN `{{related_table_name}}` as {{alias}} ON {{alias}}.Id = {{table_alias}}.{{source_field_name}}",{alias:"SFRecord_"+e.alias,source_field_name:e.fieldDef.name,related_table_name:"SFRecordName",table_alias:"MAIN"})),e.displayCols&&e.displayCols.push("MAIN."+e.fieldDef.name),e.searchCols&&e.searchCols.push(M.string.substitute("`{{related_table_name}}`.{{field_name}} qry",{related_table_name:e.alias,field_name:n})),e.relatedDisplayCols&&(e.relatedDisplayCols.push(e.alias+"."+n+" as "+e.fieldDef.name.replace(/(__c)?$/,"__r")),e.relatedDisplayCols.push("SFRecord_"+e.alias+".Name as SFRecord_"+e.fieldDef.name.replace(/(__c)?$/,"__r"))))}}},{key:"_onGetPFCError",value:function(e,t){Q.info("Could not fetch lookupdef, NamedSearch table might be empty"),this.pfc=[],e.d.resolve()}},{key:"buildQuery",value:function(e,t,n,i,a,r,o,s,l,c,u,d,_){var h="",f=e,p=n.concat(i);"BUBBLE"==this.callType?f=e.replace("MAIN.*",p.join()):i.length&&(f=e.replace("*","*, "+i.join(","))),(h=a.join(" OR "))&&(h="("+h+")");var m=this.stitchPreFilterCriteriaToQuery(o,s,l);""!=m&&(m=this.__prependAliasToField(m,"MAIN")),""!=m&&void 0!=m||(m=1);var v=d+" AND "+m;if(null!==u&&void 0!=u&&""!=u&&(u=this.__prependAliasToField(u,"MAIN"),v=v+" AND "+u),_)for(var g in _)f.search(_[g].key)>-1&&v.search(_[g].key+"\\.")>-1&&(v=v.replace(_[g].key,_[g].value));if(""===r)return f.replace("temp",v);switch(t){case"contains":var y=" LIKE '%"+r+"%'",S=v+" AND "+h.split(" qry").join(y),E=f.replace("temp",S);return E;case"ew":var y=" LIKE '%"+r+"'",S=v+" AND "+h.split(" qry").join(y),E=f.replace("temp",S);return E;case"sw":var y=" LIKE '"+r+"%'",S=v+" AND "+h.split(" qry").join(y),E=f.replace("temp",S);return E;case"eq":var y=" = '"+r+"'",S=v+" AND "+h.split(" qry").join(y),E=f.replace("temp",S);return E}}},{key:"__prependAliasToField",value:function(e,t){var n=e.match(/(?:((?:cast\()?[A-z0-9._\-]+ ?(?:as (?:double|float)\))?(?:LIKE|IS NOT|IS |>|<|>?=|<?=|!?=) ?[^ ()]+))(?: ?(?:(^|\s)(AND|OR)(?=\s|$))?)+/gi),i=e.match(/(?:((?:cast\()?[A-z0-9._\-]+ ?(?:as (?:double|float)\))?(?:LIKE|IS NOT|IS |>|<|>?=|<?=|!?=) ?[^ ()]+))(?: ?(?:(^|\s)(AND|OR)(?=\s|$))?)+/gi),a=/(?:cast\()([A-z0-9._\-]+) as (?:double|float)\)((?:LIKE|IS NOT|IS|>|<|>?=|<?=|!?=) ?[^ ()]+)/gi;if(void 0!==n&&null!==n&&n.length>0)for(var r=0;r<n.length;r++){var o=null;o=a.exec(n[r]),a.lastIndex=0,null!=o&&o.length>0&&(n[r]=o[1])}if(void 0!==i&&null!==i&&i.length>0)for(var r=0;r<i.length;r++){var o=a.exec(i[r]);null!=o&&o.length>0&&(i[r]=o[1])}var s=void 0,l=[];if(void 0!==n&&void 0!==i&&null!==n&&null!==i){for(var r=0;r<i.length;r++){s=i[r];for(var c=0;c<n.length;c++)n[c]==s&&l.push(n[c])}var u={},d=[];for(var _ in l){_=l[_];var h=Math.max(_.indexOf("="),_.indexOf(">"),_.indexOf("<"));if(h>-1){if(_.substring(0,h).indexOf(".")>-1)continue}else if(_.indexOf(".")>-1)continue;"AND "==_.substring(0,4)&&(_=_.substring(4)),null==u[_]&&(u[_]=1,d.push(_))}l=d;for(var _ in l)e=e.replace(l[_],t+"."+l[_])}return e}},{key:"stitchPreFilterCriteriaToQuery",value:function(e,t,n){var i="";if(void 0!==t.__parent||null!=t.__parent){var i=e.lookupDefDetail.preFilterCriteria,a=t.__parent.getReferenceMetaModel();i=A.replaceLiteralsWithValue(i,a,n,!0),i=A.replaceBoolToString(i),this.__actualLookupPreFilter=A.replaceLiteralsWithValue(this.__actualLookupPreFilter,a,n,!0)}return i}},{key:"stitchLUPContextToQuery",value:function(e,t){var n=1;return void 0===t.__parent&&null==t.__parent||(n=" MAIN."+e.ContextMatchField+" LIKE '"+e.ContextValue+"'"),n}},{key:"stitchAdvFiltersToQuery",value:function(e,t,n){if(void 0!==t.__parent||null!=t.__parent){for(var i=M.cloneObject(e),a=t.__parent.getReferenceMetaModel(),r=A.extractDefWithFiltersToQuery(this.request,i),o=0;o<r.advFilters.length;o++){var s=A.replaceLiteralsWithValue(r.advFilters[o].filterCriteria,a,n,!0);r.advFilters[o].filterCriteria=s}var l=M.cloneObject(e),a=t.__parent.getReferenceMetaModel();if(l&&l.advFilters&&l.advFilters.length>0)for(var o=0;o<l.advFilters.length;o++)if(this.__actualLookupAdvFilters&&this.__actualLookupAdvFilters.length>0)for(var c=0;c<this.__actualLookupAdvFilters.length;c++)if(this.__actualLookupAdvFilters[c].key===l.advFilters[o].key){l.advFilters[o].filterCriteria=this.__actualLookupAdvFilters[c].filterCriteria;break}var u=A.extractDefWithFiltersToQuery(this.request,l);if(u&&u.advFilters&&u.advFilters.length>0)for(var o=0;o<u.advFilters.length;o++){var s=A.replaceLiteralsWithValue(u.advFilters[o].filterCriteria,a,n,!0);if(this.__actualLookupAdvFilters&&this.__actualLookupAdvFilters.length>0)for(var c=0;c<this.__actualLookupAdvFilters.length;c++)if(this.__actualLookupAdvFilters[c].key===u.advFilters[o].key){this.__actualLookupAdvFilters[c].filterCriteria=s;break}}}else var r={advFilters:[]};return r}},{key:"_processLUPSearchResults",value:function(e,t,n,i,a){e.TimezoneOffset;M.array.forEach(n.data,function(e){var t=new ae(n.data,i.LookupDef.key),r=t.getFieldsByType("datetime"),o={};M.array.forEach(r,function(e,t){o[e.name]=!0}),M.forEachProperty(e,M.proxy(this,function(t,n){if(o[t]&&(e[t]=n),t.match(/__r$/)){var i=t.replace(/__r$/,"__c");i in this.referenceFields||(i=i.replace(/__c$/,""));var r={attributes:{type:this.referenceFields[i],url:"TODO"},Name:n,Value:e[i]},s=M.array.get(a,function(e){return e[M.OrgNamespace+"__Field_Name__c"]==i});s&&(e[s.relationshipName]=r)}}))},this),this.response.data=this.__createDisplayRecords(n.data,a),this.response.advFilters=i.LookupDef.advFilters,this._onSearchCompleted(t,this.response)}},{key:"_getLUPSearchResultsSuccess",value:function(e,t,n,i,r,o){var s=this;t.data=ce(o);for(var l=0;l<t.data.length;l++)for(var c=t.data[l],d=0;d<i.length;d++){var _=i[d];if("REFERENCE"===_.dataType){var h=_.relationshipName;!c[h]&&c.hasOwnProperty("SFRecord_"+h)&&(c[h]=c["SFRecord_"+h],delete c["SFRecord_"+h]);var f=_[M.OrgNamespace+"__Field_Name__c"].replace(/(__c)?$/,"__r");!c[f]&&c.hasOwnProperty("SFRecord_"+f)&&(c[f]=c["SFRecord_"+f],delete c["SFRecord_"+f])}}var p=ee.getUserInfo(),m=t.data||[],v=parseInt(n.LookupDef.lookupDefDetail.numberOfRecs,10),g=n.LookupDef.key;this.__findServerRecords(n,this.searchOnlineRecord,this.__queryWithAFC,i).done(M.proxy(this,function(r){var o=s.__mergeRecords(m,[],r,v),l=o.map(function(e){return e.Id}),c=M.getCurrentApplication(),d=c.getCurrentView(),_=s.currentRecordId||d.getOption("SVMX_recordId");d.getDeliveryEngine();O.describeObject({objectName:g,onSuccess:function(r){var c=[],d=r.fields.filter(function(e){return!(!e||!e.type||"reference"!==e.type)});if(d){var h={};d.map(function(e){var t=e.name;h[t]={name:t,referenceTo:e.referenceTo?e.referenceTo.join(","):"::referenceTo is missing in Field Deinition"}}),a({query:"SELECT Id,"+(0,u.default)(h).join(",")+" FROM ["+g+"] WHERE Id IN ('"+l.join("','")+"')"}).then(function(a){for(var r=[],l=0;l<a.length;l++){var u=a[l],d=u.Id;for(var h in u)if(_){var f=u[h];f&&(f.match(/_local_/)||f.match(/^local_/))&&(_.match(/_local_/)||_.match(/^local_/))&&f===_&&c.lastIndexOf(f)<0&&c.push(d)}}for(var m=0;m<o.length;m++){for(var v=o[m],g=!1,y=0;y<c.length;y++){var S=c[y];v.Id&&v.Id===S&&(g=!0)}g||r.push(v)}t.data=r,s._processLUPSearchResults(p,e,t,n,i)})}else t.data=o,s._processLUPSearchResults(p,e,t,n,i)}})}))}},{key:"__findServerRecords",value:function(e,t,n,i){var a=M.Deferred(),r=this;return t?this.__checkConnectivity().done(function(t){if("false"===t.toLowerCase())return a.resolve([]),a;var o=M.cloneObject(e);if(n&&n.advFilters&&n.advFilters.length>0)for(var s=0;s<n.advFilters.length;s++)if(r.__actualLookupAdvFilters&&r.__actualLookupAdvFilters.length>0)for(var l=0;l<r.__actualLookupAdvFilters.length;l++)if(r.__actualLookupAdvFilters[l].key===n.advFilters[s].key){n.advFilters[s].filterCriteria=r.__convertSQLExpressionToOnline(r.__actualLookupAdvFilters[l].filterCriteria),Q.info("Online Advanced filter name: "+n.advFilters[s].filterName+" - "+n.advFilters[s].filterCriteria);break}null!==n&&(o.LookupDef=n),o&&o.LookupDef&&o.LookupDef.lookupDefDetail&&o.LookupDef.lookupDefDetail.preFilterCriteria&&r.__actualLookupPreFilter&&(o.LookupDef.lookupDefDetail.preFilterCriteria=r.__convertSQLExpressionToOnline(r.__actualLookupPreFilter),Q.info("Online Pre filter criteria: "+o.LookupDef.lookupDefDetail.preFilterCriteria)),r.__downloadRecords(o).done(function(e){var t=[];void 0!==e.message&&null!=e.message&&Q.error(e.message),void 0!==e.records&&e.records.length>0&&(t=e.records),r.__getReferenceForOnlineRecords(t,i).done(function(e){a.resolve(e)})})}):a.resolve([]),a}},{key:"__convertSQLExpressionToOnline",value:function(e){return e&&e.length&&(e=e.replace(/IS NOT NULL/g,"!= null"),e=e.replace(/IS NOT ''/g,"!= ''"),e=e.replace(/IS NULL/g,"= null"),e=e.replace(/IS ''/g,"= ''")),e}},{key:"__getReferenceForOnlineRecords",value:function(e,t){var n=M.Deferred(),i=[];if(t.forEach(function(e){"REFERENCE"===e.dataType&&(i.push(e[M.OrgNamespace+"__Field_Name__c"]),e.relationshipName&&e.relationshipName.length>0&&i.push(e.relationshipName))}),i.length>0){var r=[];e.forEach(function(e){for(var t in e)e[t]&&"object"!==(0,l.default)(e[t])&&i.includes(t)&&!r.includes(e[t])&&r.push(e[t])}),r.length>0?a({query:"SELECT Id,Name FROM SFRecordName WHERE Id IN ('"+r.join("','")+"')"}).then(function(t){var a={};t.forEach(function(e){a[e.Id]=e.Name}),e.forEach(function(e){i.forEach(function(t){var n=e[t];if(a[n])t.match(/__c$/)?t=t.replace(/__c$/,"__r"):t+="__r",e[t]=a[n];else if(e[t]&&"object"===(0,l.default)(e[t])){var i=e[t];i&&i.Name&&(t.match(/__r$/)||(t+="__r"),e[t]=i.Name)}})}),n.resolve(e)}):n.resolve(e)}else n.resolve(e);return n}},{key:"__checkConnectivity",value:function(){var e=M.Deferred(),t=this,n={type:"CONNECTIVITY",method:"CHECKCONNECTIVITY"},i=X.createConnectivityRequest();return i.bind("REQUEST_COMPLETED",function(t){e.resolve(t.data.data)},t),i.bind("REQUEST_ERROR",function(t){e.resolve("False")},t),i.execute(n),e}},{key:"__downloadRecords",value:function(e){var t=M.Deferred(),n=this,i=n.__buildLookupRequest(e),a=M.OrgNamespace,r="/services/apexrest/{{OrgNamespace}}/svmx/rest/SFMDeliveryServiceIntf/getLookupData/9.0/";r=M.string.substitute(r,{OrgNamespace:a});var o={url:r,method:"POST",data:{lookupRequest:i}},s=I,l=s.createHTTPRequest();return l.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)},this),l.bind("REQUEST_ERROR",function(e){Q.error(e.data.data),t.resolve([])},this),l.execute(o),t}},{key:"__buildLookupRequest",value:function(e){for(var t=e.LookupDef.lookupDefDetail.displayFields,n=e.LookupDef.lookupDefDetail.searchFields,i=e.LookupDef.advFilters,a=[],r=[],o={field_name:"apiName",field_relationship_name:"fieldRelationshipName",field_type:"dataType"},s=0;s<t.length;s++){var l=t[s],c={};for(var u in l){var d=o[u];d&&void 0!==d&&(c[o[u]]=l[u])}a.push(c)}for(var s=0;s<n.length;s++){var _=n[s],c={};for(var u in _){var d=o[u];d&&void 0!==d&&(c[o[u]]=_[u])}c.refObjectNameField="Name",r.push(c)}for(var s=0;s<i.length;s++)i[s].allowOverride=!1,"true"===i[s].allowOverride&&(i[s].allowOverride=!0),i[s].defaultOn=!1,"true"===i[s].defaultOn&&(i[s].defaultOn=!0);return e.LookupDef.lookupDefDetail.displayFields=a,e.LookupDef.lookupDefDetail.searchFields=r,e.LookupDef.advFilters=i,e.LookupDef.objectName=e.LookupDef.key,e}},{key:"__parseResults",value:function(e){e=M.toObject(e);var t=void 0,n=e.length,i={};for(t=0;t<n;t++)i[e[t].split(" : ")[0]]=e[t].split(" : ")[1];var a=[];return"1"===i["Response Code"]&&i.Output.length>0&&(a=this.__parseOutput(i.Output)),a}},{key:"__parseOutput",value:function(e){e&&"["===e[0]&&"]"!==e[e.length-1]&&(e+='"]]'),e=M.toObject(e);var t=void 0,n=e.length,i=[];for(t=0;t<n;t++){var a=0;jlength=e[t].length,obj={};var r=e[t];for(a=0;a<jlength;a++)obj[r[a].split(":")[0]]=r[a].split(":")[1];i.push(obj)}return i}},{key:"__mergeRecords",value:function(e,t,n,i){if(t.length||n.length){for(var a=[],r=0;r<e.length;r++)a.push(e[r].Id);for(var r=0;r<t.length;r++)-1===a.indexOf(t[r].Id)&&(e.push(t[r]),a.push(t[r].Id));for(var r=0;r<n.length;r++)-1===a.indexOf(n[r].Id)&&e.push(n[r])}var o=e;if(e.length>i){o=[];for(var r=0;r<i;r++)o.push(e[r])}var s=this.request&&"Case"===this.request.ObjectName?"CaseNumber":"Name";return M.sort(o,s)}},{key:"_getLUPSearchResultsError",value:function(e,t,n,i,a){Q.error("ERROR IN _getLUPSearchResultsError: "+a.data.data);var r=a.data.parameters.query||"";this._getLUPSearchResultsSuccess(e,t,n,i,r,{data:{data:[]}})}},{key:"_onSearchCompleted",value:function(e,t){0===--e.__waitCounter.count&&e.__waitCounter.subRecordsStarted&&(Q.info("Lookup results retrieved"),e.result(t),this.doCleanup())}},{key:"__createDisplayRecords",value:function(e,t){var n=[];if(e){var i=void 0,a=e.length,r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0;for(i=0;i<a;i++){r={FieldMap:[]},s=e[i];for(o in s)"attributes"!=o&&(l=s[o],t&&(c=this.__getFieldInfo(t,o))&&"REFERENCE"==c.dataType&&(u=c.relationshipName,s[u]?(r.FieldMap.push({ftype:"Reference",key:o+"__key",value:l}),l=s[u].Name):l=""),r.FieldMap.push({ftype:"Result",key:o,value:l}));n.push(r)}}return n}},{key:"__getFieldInfo",value:function(e,t){var n=void 0,i=e.length,a=null;for(n=0;n<i;n++)if(e[n][M.OrgNamespace+"__Field_Name__c"]==t){a=e[n];break}return a}},{key:"sqlFixCriteria",value:function(e){var t="",n=/\b([\w]+)(?=\s?(?:<>|>|>=|<|<=|=)\s?\d)/gi;return re_includes=/([\w.]+) INCLUDES \('(\[?[\w*#~.&\/,;@\- \w*#~.&\/,;@\-]*\]?)'\)/gi,re_excludes=/([\w.]+) EXCLUDES \('(\[?[\w*#~.&\/,;@\- \w*#~.&\/,;@\-]*\]?)'\)/gi,likePattern="($1 = '$2' OR $1 LIKE '$2;%' OR $1 LIKE '%;$2' OR $1 LIKE '%;$2;%')",t=String(e).replace(/["']?\b(TODAY|TOMORROW|YESTERDAY|NOW)\b["']?/gi,function(e){var t=e;switch(e.toUpperCase()){case"TODAY":t="'"+J.macroDrivenDatetime("Today","YYYY-MM-DD").split(" ")[0]+"'";break;case"TOMORROW":t="'"+J.macroDrivenDatetime("Tomorrow","YYYY-MM-DD").split(" ")[0]+"'";break;case"YESTERDAY":t="'"+J.macroDrivenDatetime("Yesterday","YYYY-MM-DD").split(" ")[0]+"'";break;case"NOW":t="'"+J.macroDrivenDatetime("Now","YYYY-MM-DD","HH:mm:ss")+"'"}return t}),t=t.replace(n,"cast($1 as double)"),t=t.replace(re_includes,likePattern),t=t.replace(re_excludes,"NOT "+likePattern),t?"("+t+")":t}},{key:"sqlAliasPrepSub",value:function(e,t){if(e&&t)for(var n=t.length,i=0;i<n;i++)if(t[i].field_type&&"REFERENCE"===t[i].field_type&&-1===t[i].field_relationship_name.indexOf("__r")){var a=t[i].field_relationship_name,r=new RegExp(a+".Name","g");e=e.replace(r,"{{"+a+"}}.Name")}return e}}]),t}(B),G.GetUserInfo=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){t.result(ee.getUserInfo())}}]),t}(B),G.DescribeObject=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){Z.describeObject({objectName:e.objectName,onSuccess:function(n){M.array.forEach(n.fields,function(e){e.picklistValues||(e.picklistValues=[]),e.picklistValues instanceof Array||(e.picklistValues=[e.picklistValues]),"boolean"==e.type&&(e.picklistValues=[{label:"false",value:"false"},{label:"true",value:"true"}])}),ne.registerJSCache("SFMDELIVERY.ParsedObjectDescribeLayout",10);var i=ne.readFromJSCache("SFMDELIVERY.ParsedObjectDescribeLayout",e.objectName);i?t.result(i,e.objectName):a({query:"SELECT object_layout_describe FROM SFObjectLayoutDescribe WHERE object_name = '{{object_name}}'",queryParams:{object_name:e.objectName}}).then(function(i){var a={recordTypeMappings:[]};i&&M.array.forEach(i,function(e){var t=M.toObject(e.object_layout_describe),n=t.recordTypeMappings;!n||n instanceof Array||(n=[n]),M.array.forEach(n,function(e){e.active&&e.available&&a.recordTypeMappings.push(e)})}),A.processDescribeResult(n,a),M.array.forEach(n.recordTypeInfos,function(e){e.fixedName=Z.getRecordTypeNameFromId(e.recordTypeId)},this),M.array.forEach(n.recordTypeMapping,function(e){e.fixedName=Z.getRecordTypeNameFromId(e.recordTypeId)},this),ne.registerJSCache("SFMDELIVERY.RecordTypes",10),ne.writeToJSCache("SFMDELIVERY.RecordTypes",e.objectName,n.recordTypeMapping),ne.writeToJSCache("SFMDELIVERY.ParsedObjectDescribeLayout",e.objectName,n),t.result(n,e.objectName)})},onError:function(t){Q.error("Describe Object Failed for "+e.objectName)}})}}]),t}(B),G.GetPageData=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=te.getOpenRecordRemoteId(e.recordId);n&&(e.recordId=n),t.__parent&&t.__parent.additionalInfo&&t.__parent.additionalInfo.isDataFromExternalApp&&(e.record=M.deepCloneObject(t.__parent.record));var i=e.recordId,a=e.targetId,r=e.processId,o={componentType:e.componentType||"TARGET",refreshData:e.refreshData,requesterId:e.requesterId,lookupDisplayFieldMap:e.lookupDisplayFieldMap,data:{response:{stringMap:[]},pageDataSet:{sobjectinfo:{},bubbleInfo:[]},detailDataSet:[]},expressionCounter:0,tableName:null,recordId:i,targetId:a,record:e.record,processId:r,responder:t,svmxConstants:[],quickSave:e.quickSave};this._getUserInfoSuccess(o,ee.getUserInfo())}},{key:"_getUserInfoSuccess",value:function(e,t){var n=t.UserTrunkDetail?t.UserTrunkDetail.Id:null;e.UserData=t,e.svmxConstants.push({fieldsToNull:null,key:"SVMX.USERTRUNK",value:n,value1:null}),e.data.svmxConstants=e.svmxConstants,Z.getProcess({processId:e.processId,componentType:e.componentType,onSuccess:M.proxy(this,"_getProcessSuccess",e),onError:M.proxy(this,function(t){Q.error(t.data.data),e.data.error=t.data.data,e.responder.result(M.create("com.servicemax.client.sfmdelivery.operationutils.SFMDeliveryData",e.data))}),state:e})}},{key:"_getUserInfoError",value:function(e){Q.error("User Info not found")}},{key:"_getSortStringKeys",value:function(e,t){var n=[];if(!e||!e.lstSortingRec)return n;var i=void 0;H.getFieldSet(t,function(e){i=e});for(var a=e.lstSortingRec,r=0;r<a.length;r++){var o=a[r].queryField||"";n.push({queryField:o,sortingOrder:a[r].sortingOrder})}return n}},{key:"_getProcessSuccess",value:function(e,t){var n=e.processData=t.data.data[0];if("SYNC"===e.requesterId&&(e.processData.process_type="VIEW RECORD"),e.processType=n.process_type,e.tableName=e.processData.target_object_name,"STANDALONE CREATE"===e.processData.process_type)e.data.pageDataSet.sobjectinfo=new ae({},e.tableName),this._onGetDataComplete(e);else{var i=e.record;M.when([function(){return i||$.getRecord({Id:e.targetId||e.recordId,loadReferences:!0,convertPicklists:!0,lookupDisplayFieldMap:e.lookupDisplayFieldMap&&e.lookupDisplayFieldMap.head})}()]).then(M.proxy(this,function(t){t.OwnerId?"string"==typeof t.OwnerId?t.OwnerId==e.UserData.UserId&&(t.OwnerId={fieldvalue:{key:e.UserData.UserId,value:e.UserData.UserName}}):t.OwnerId.fieldvalue.key===t.OwnerId.fieldvalue.value&&t.OwnerId.fieldvalue.key===e.UserData.UserId&&(t.OwnerId.fieldvalue.value=e.UserData.UserName):t.OwnerId={fieldvalue:{key:e.UserData.UserId,value:e.UserData.UserName}},e.data.pageDataSet.sobjectinfo=new ae(t,t.attributes.type),this._onGetDataComplete(e)}),M.proxy(this,function(n){Q.error(t.data.data),e.data.error=n,e.responder.result(M.create("com.servicemax.client.offline.sal.model.impl.SFMDeliveryData",e.data))}))}}},{key:"_onGetDataComplete",value:function(e){this.getProcessComponents(e)}},{key:"getProcessComponents",value:function(e){var t="SOURCE"===e.componentType?"STANDALONE EDIT":e.processType,n=t.toLowerCase().replace(/ /g,"_");n=M.string.capitalize(M.string.camelCase(n)),G.Utilities.getProcessComponents({processId:e.processId,onSuccess:M.proxy(this,function(t,i){this._cacheAllFieldSets(i).then(M.proxy(this,function(){this["_getProcessComponentsSuccess"+n](e,t,i)}))})})}},{key:"_cacheAllFieldSets",value:function(e){for(var t={},n=[],i=H,a=0;a<e.length;a++){var r=e[a],o=r.target_object_name;o&&!t[o]&&(t[o]=!0,n.push(i.getFieldSet(o)))}return M.when(n)}},{key:"_getProcessComponentsSetupProcessComponents",value:function(e,t,n){var i=[],a=[];M.array.forEach(n,function(r,o){if(r.component_type===e.componentType+"CHILD"){i.push(t[o]),a.push(n[o]);var s=r.layout_id;if("SOURCECHILD"===r.component_type){s=M.array.filter(n,function(e){return"TARGETCHILD"===e.component_type&&e.parent_object===r.processComponentId})[0].layout_id}e.data.detailDataSet.push({pageDataSet:[],aliasName:s})}}),e.data.response.stringMap=i,e.processComponents=a,e.allProcessComponents=n}},{key:"_getProcessComponentsSuccessStandaloneEdit",value:function(e,t,n){this._getProcessComponentsSetupProcessComponents(e,t,n),n=e.processComponents,e.data.response.processComponentForPage=n,this._getAllLineItemRecordsForProcessComponent(e,0)}},{key:"_getTotalCountOfLineItem",value:function(e,t){function n(){if(r<a.length){var o=a[r],s=e.processComponents[r],l=o.object_label,c=e.data.pageDataSet.sobjectinfo;!function(e,t,a,s,l){$.getExpr(t.target_object_name,t.expression_id,e).then(M.proxy(i,function(c){i._getLineItemRecords(e,t.target_object_name,t.parent_column,t.expression_id,a.Id,s.pageDataSet,t,s.object_label,c,!0).then(M.proxy(i,function(e){Q.info("Total "+l+" = ",e),o.totalCount=e,r++,n()}),M.proxy(i,function(e){Q.error("Something went wrong while fetching the lineItems")}))}))}(e,s,c,o,l)}else t&&t.call()}var i=this,a=e.data.detailDataSet,r=0;e.responder.__parent&&e.responder.__parent.additionalInfo&&e.responder.__parent.additionalInfo.isDataFromExternalApp?t&&t.call():n()}},{key:"_getAllLineItemRecordsForProcessComponent",value:function(e,t,n){var i=this;this[function(){return e.responder.__parent&&e.responder.__parent.additionalInfo&&e.responder.__parent.additionalInfo.isDataFromExternalApp?"__getLineItemsSentFromExternalApp":"_getAllLineItemRecords"}()](e,e.processComponents,e.data.pageDataSet.sobjectinfo,t,n).then(M.proxy(this,function(){if(e.responder.__parent&&e.responder.__parent.additionalInfo&&e.responder.__parent.additionalInfo.isDataFromExternalApp){var t=[];return M.array.forEach(e.data.detailDataSet,M.proxy(i,function(n,a){var r=e.processComponents[a],o=i._runExpressionOnLineItems(e,n.pageDataSet,r.target_object_name,r.expression_id,r);o.done(function(e){n.pageDataSet=e}),t.push(o)})),M.when(t)}})).then(M.proxy(this,function(){return this._onGetHeaderAndLineItemComplete(e)})).then(M.proxy(this,function(){return!("VIEW RECORD"!==e.processType&&!e.refreshData&&"SOURCE"!==e.componentType&&!0!==e.quickSave)||$.executeObjectMapping({targetData:[e.data.pageDataSet],sourceData:e.data.pageDataSet.sobjectinfo,objectMappingId:e.processData.object_mapping_id,valueMappingId:e.processData.value_mapping_id})})).then(M.proxy(this,function(){if(e.data&&e.data.detailDataSet&&e.data.detailDataSet.length>0&&e.responder.__parent&&e.responder.__parent.additionalInfo&&e.responder.__parent.additionalInfo.isDataFromExternalApp)for(var t=0;t<e.data.detailDataSet.length;t++)if(e.data.detailDataSet[t].pageDataSet&&e.data.detailDataSet[t].pageDataSet.length>0){var n=this.__getListSortCriteria(e.data.detailDataSet[t].aliasName,e.processComponents);e.data.detailDataSet[t].pageDataSet.sort(this.__pageDataSetSort(n))}this.__onDone(e)}))}},{key:"__getLineItemsSentFromExternalApp",value:function(e,t){var n=new T.Deferred,i=[];i=e.data.detailDataSet;var a=t.length;return M.array.forEach(t,M.proxy(this,function(t,r){var o=i[r],s=e.record.details&&e.record.details[t.target_object_name]||[];if(a--,0===s.length&&0===a)n.resolve();else for(var l=0;l<s.length;l++){var c=new ae(s[l],t.target_object_name);c.messupData(),o.pageDataSet.push({sobjectinfo:c,bubbleInfo:[]}),0===a&&l===s.length-1&&n.resolve()}})),0===t.length&&n.resolve(),n}},{key:"__pageDataSetSort",value:function(e){var t=function(t,n){var i="";if(n[t]){"string"==typeof n[t]||n[t]instanceof String?i=n[t]:n[t].fieldvalue&&(i=n[t].fieldvalue.value);var a="";if(e[0]&&(a=e[0].dataType.toUpperCase()),"DOUBLE"===a||"PERCENT"===a||"CURRENCY"===a){var r=Number(i);isNaN(r)||(i=r)}}return i||""};return function(n,i){for(var a=void 0,r=void 0,o=0;o<e.length;o++){var s=e[o].fieldAPIName;if("ASC"==e[o].sortingOrder?(a=t(s,n.sobjectinfo),r=t(s,i.sobjectinfo)):(r=t(s,n.sobjectinfo),a=t(s,i.sobjectinfo)),a!=r)return a<r?-1:a>r?1:0}return 0}}},{key:"__getListSortCriteria",value:function(e,t){for(var n=[],i=0;i<t.length;i++)if(t[i].layout_id==e&&t[i].advanced_options&&t[i].advanced_options.lstSortingRec){n=t[i].advanced_options.lstSortingRec;break}return n}},{key:"_processDateToUserTimezone",value:function(e,t,n){var i=t.getFieldsByType("datetime"),a={};M.array.forEach(i,function(e,t){a[e.name]=!0}),M.forEachProperty(t,function(e,i){if(a[e]&&i.fieldvalue){var r=i.fieldvalue.key,o=i.fieldvalue.value,s={key:r?J.convertToTimezone(r,n,!1):r,value:o?J.convertToTimezone(o,n,!1):o};t[e].fieldvalue=s}})}},{key:"_processDetailsDate",value:function(e,t,n){M.array.forEach(t,M.proxy(this,function(t,i){M.array.forEach(t.pageDataSet,M.proxy(this,function(t,i){this._processDateToUserTimezone(e,t.sobjectinfo,n)}))}))}},{key:"_getProcessComponentsSuccessStandaloneCreate",value:function(e,t,n){this._getProcessComponentsSetupProcessComponents(e,t,n),e.data.pageDataSet.sobjectinfo.getFieldDef("OwnerId")&&(e.data.pageDataSet.sobjectinfo.OwnerId={fieldvalue:{key:e.UserData.UserId,value:e.UserData.UserName}}),e.data.pageDataSet.sobjectinfo.Id=$.__generateId(e.processData.target_object_name),e.data.pageDataSet.sobjectinfo.__new=!0,$.executeObjectMapping({targetData:[e.data.pageDataSet],sourceData:e.data.pageDataSet.sobjectinfo,objectMappingId:e.processData.object_mapping_id,valueMappingId:e.processData.value_mapping_id}).then(M.proxy(this,function(){this.__onDone(e)}))}},{key:"_getProcessComponentsSuccessViewRecord",value:function(e,t,n){this._getProcessComponentsSuccessStandaloneEdit(e,t,n)}},{key:"_getProcessComponentsSuccessSourceToTargetChild",value:function(e,t,n){e.sourceRecord=e.data.pageDataSet.sobjectinfo,this._getProcessComponentsSetupProcessComponents(e,t,n),$.executeObjectMapping({targetData:[e.data.pageDataSet],sourceData:e.data.pageDataSet.sobjectinfo,objectMappingId:e.processData.object_mapping_id,valueMappingId:e.processData.value_mapping_id}).then(M.proxy(this,function(){return this._generateTargetChildrenFromSourceChildren(e,n)})).then(M.proxy(this,function(){return this._onGetHeaderAndLineItemComplete(e)})).then(M.proxy(this,function(){this.__onDone(e)}))}},{key:"_getProcessComponentsSuccessSourceToTargetAll",value:function(e,t,n){if(e.sourceRecord=e.data.pageDataSet.sobjectinfo,e.data.pageDataSet={sobjectinfo:new ae({sourceRecordId:e.sourceRecord.Id},e.tableName),bubbleInfo:[]},e.responder&&e.responder.__parent&&e.responder.__parent.additionalInfo&&e.responder.__parent.additionalInfo.isDataFromExternalApp){var i=e.sourceRecord.details[e.tableName];if(i.length>1)console.log("error");else{var a=i[0];for(var r in a)"Id"!==r&&(e.data.pageDataSet.sobjectinfo[r]=a[r])}}else e.data.pageDataSet.sobjectinfo.getFieldDef("OwnerId")&&(e.data.pageDataSet.sobjectinfo.OwnerId={fieldvalue:{key:e.UserData.UserId,value:e.UserData.UserName}});e.data.pageDataSet.sobjectinfo.Id=$.__generateId(e.processData.target_object_name),e.data.pageDataSet.sobjectinfo.__new=!0,this._getProcessComponentsSetupProcessComponents(e,t,n),$.executeObjectMapping({targetData:[e.data.pageDataSet],sourceData:e.sourceRecord,valueMappingId:null,objectMappingId:e.processData.object_mapping_id}).then(M.proxy(this,function(){return this._generateTargetChildrenFromSourceChildren(e,n)})).then(M.proxy(this,function(){return this._onGetHeaderAndLineItemComplete(e)})).then(M.proxy(this,function(){this.__onDone(e)}))}},{key:"_pairSourceAndTargetChildren",value:function(e){var t=M.array.filter(e,function(e){return"TARGETCHILD"===e.component_type}),n=M.array.filter(e,function(e){return"SOURCECHILD"===e.component_type}),i=M.array.map(t,function(e){var t=M.array.get(n,function(t){return"SOURCECHILD"===t.component_type&&e.node_source_object_api==t.object_name});return t?(M.array.remove(n,t),{source:t,target:e,data:[]}):null});return i=M.array.filter(i,function(e){return e})}},{key:"_generateTargetChildrenFromSourceChildren",value:function(e,t){var n=new T.Deferred,i=M.array.get(t,function(e){return"SOURCE"===e.component_type}),a=this._pairSourceAndTargetChildren(t),r=M.proxy(this,function(e){var t=M.array.indexOf(a,function(t){return t.target.layout_id===e.layout_id});e=a[t],e._isDone=!0,M.array.every(a,function(e,t){return e._isDone})&&n.resolve()});e.processComponents;return 0===a.length&&n.resolve(),M.array.forEach(a,M.proxy(this,function(t){var n=t.source,a=t.target,o=void 0;n.target_object_name==i.target_object_name?(o=new T.Deferred,o.resolve([e.sourceRecord])):o=this.__queryLineItemRecords(n.target_object_name,n.parent_column,e.recordId,a.advanced_options),o.then(M.proxy(this,function(t){return t=M.array.map(t,function(e){var t=void 0;return e instanceof ae==0?(t=new ae(e,n.target_object_name),t.messupData()):t=e,{sobjectinfo:t,bubbleInfo:[]}}),this._runExpressionOnLineItems(e,t,n.target_object_name,a.expression_id,n)})).then(M.proxy(this,function(n){var i=t.source,a=t.target,o=M.array.filter(e.data.detailDataSet,function(e){return e.aliasName===t.target.layout_id})[0],s=o.pageDataSet=t.data;if(0===n.length||!a.object_mapping_id)return r(a);var l={type:i.object_name,url:"TODO"},c=M.array.map(n,function(t,n){return t.attributes=l,s.push({sobjectinfo:new ae({sourceRecordId:t.sobjectinfo.Id},a.target_object_name),bubbleInfo:[]}),$.executeObjectMapping({targetData:s[n],sourceData:t.sobjectinfo,headSourceData:e.data.pageDataSet.sobjectinfo,valueMappingId:"",objectMappingId:a.object_mapping_id})});M.when(c).then(M.proxy(this,function(){r(a)}),M.proxy(this,function(){r(a)}))}),M.proxy(this,function(e){Q.error("ERROR: Failed to load source child: "+e),r(t.target)}))})),n}},{key:"_getAllLineItemRecords",value:function(e,t,n,i,a){var r=new T.Deferred;e.expressionCounter=t.length;var o=e.data.detailDataSet,s=[],l=[];if(a)for(var c=0;c<o.length;c++)o[c].object_label===a&&(s[0]=o[c],l[0]=t[c]);else s=e.data.detailDataSet,l=t;var u=l.length;return M.array.forEach(l,M.proxy(this,function(t,i){var a=s[i],o=this;!function(e,n,i,a,s,l){$.getExpr(t.target_object_name,t.expression_id,e).then(M.proxy(o,function(n){o._getLineItemRecords(e,t.target_object_name,t.parent_column,t.expression_id,i.Id,a.pageDataSet,t,a.object_label,n).then(M.proxy(o,function(e){var t=new T.Deferred;return t.resolve(e),t}),M.proxy(o,function(e){var t=new T.Deferred;return t.resolve(e),t})).then(M.proxy(o,function(e){u--,0===e.length&&0===u?r.resolve():M.array.forEach(e,function(n,i){var o=new ae(n,t.target_object_name);o.messupData(),a.pageDataSet.push({sobjectinfo:o,bubbleInfo:[]}),0===u&&i===e.length-1&&r.resolve()},o)}))}),M.proxy(o,function(e){Q.error("Something went wrong while fetching the lineItems")}))}(e,0,n,a)})),0===t.length&&r.resolve(),r}},{key:"_getLineItemRecords",value:function(e,t,n,i,a,r,o,s,l,c){e.getLineItemsCounter++;var u=e.lookupDisplayFieldMap&&e.lookupDisplayFieldMap.details[o.layout_id];return this.__queryLineItemRecords(t,n,a,o.advanced_options,u,s,l,c)}},{key:"__queryLineItemRecords",value:function(e,t,n,i,r,o,s,l){var c=new T.Deferred,u=void 0,d=[],_=void 0,h=void 0;H.getFieldSet(e,function(e){u=e}),u.forEach(function(e){d.push(e)}),_=u.getFieldsByType("reference"),h=u.getFieldsByType("picklist");var f=$._getSortString(i,e),p=$.buildQuery("MAIN."+t+" = '"+n+"'",e,d,null,r,s,l);return p+=f&&0!==f.length?f:" ORDER BY IFNULL(DATETIME(MAIN.LastModifiedDate),DATETIME('NOW')) DESC",l&&(p="SELECT COUNT(*) AS count FROM ( "+p+" )"),a({query:p}).then(M.proxy(this,function(t){l&&c.resolve(t[0].count);for(var n=[],i=0;i<t.length;i++){var a=t[i];a.attributes={type:e,url:"TODO"};for(var r in a){var o=a[r];-1===r.indexOf("__r",r.length-"__r".length)&&null===o&&(a[r]="")}for(var s=0;s<_.length;s++){var u=_[s];!a[u.relationshipName]&&a[u.name]&&n.push(a[u.name])}this.__assembleRelatedData(a,_)}$.getFromRecordNameTable(n).then(M.proxy(this,function(e){var n={};M.array.forEach(e,function(e){n[e.Id]=e.Name});for(var i=0;i<t.length;i++){var a=t[i];this.__assembleNameFieldDataNameMap(a,_,n);for(var r=0;r<_.length;r++){var o=_[r];a[o.name]={fieldvalue:a[o.name],fieldapiname:o.name}}for(r=0;r<h.length;r++){var o=h[r];a[o.name]={fieldvalue:{value:a[o.name],key:a[o.name]},fieldapiname:o.name}}}c.resolve(t)}))}),M.proxy(this,function(e){Q.error("ERROR IN _getLineItemRecords: "+e),c.resolve([])})),c}},{key:"__assembleRelatedData",value:function(e,t){for(var n=0;n<t.length;n++){var i=t[n],a=e[i.name];e[i.name]={key:a,value:e[i.relationshipName||"field"+n],hasViewSFM:!!a&&Z.doesObjectHaveViewProcess(Z.getTableForId(a))},delete e[i.relationshipName||"field"+n]}}},{key:"__assembleNameFieldDataNameMap",value:function(e,t,n){for(var i=0;i<t.length;i++){var a=t[i];e[a.name]&&!e[a.name].value&&(e[a.name].value=n[e[a.name].key]||e[a.name].key&&e[a.name].key+" ",e[a.name].isNameSyncData=!0,e[a.name].hasViewSFM=!!e[a.name].key&&Z.doesObjectHaveViewProcess(Z.getTableForId(e[a.name].key)))}}},{key:"_runExpressionOnLineItems",value:function(e,t,n,i,a){var r=new T.Deferred;return i&&t.length?K.evaluate({expressionId:i,data:M.array.map(t,function(e){return e.sobjectinfo}),onSuccess:M.proxy(this,function(n){e.expressionCounter--;for(var i=[],a=0;a<n.length;a++)n[a]&&i.push(t[a]);r.resolve(i)}),onError:M.proxy(this,function(n){Q.error("ERROR in _runExpressionOnLineItems: "+n),e.expressionCounter--,r.resolve(t)})}):(e.expressionCounter--,r.resolve(t)),r}},{key:"_getProcessComponentsSuccessChecklist",value:function(e,t,n){null==e.targetId?this._getProcessComponentsSuccessSourceToTargetAll(e,t,n):this._getProcessComponentsSuccessChecklistInProgress(e,t,n)}},{key:"_getProcessComponentsSuccessChecklistInProgress",value:function(e,t,n){var i=void 0;$.getRecord({Id:e.recordId,loadReferences:!0,convertPicklists:!0,lookupDisplayFieldMap:e.lookupDisplayFieldMap&&e.lookupDisplayFieldMap.head}).then(M.proxy(this,function(t){t.OwnerId?"string"==typeof t.OwnerId?t.OwnerId==e.UserData.UserId&&(t.OwnerId={fieldvalue:{key:e.UserData.UserId,value:e.UserData.UserName}}):t.OwnerId.fieldvalue.key===t.OwnerId.fieldvalue.value&&t.OwnerId.fieldvalue.key===e.UserData.UserId&&(t.OwnerId.fieldvalue.value=e.UserData.UserName):t.OwnerId={fieldvalue:{key:e.UserData.UserId,value:e.UserData.UserName}},i=new ae(t,t.attributes.type),$.executeObjectMapping({targetData:[e.data.pageDataSet],sourceData:i,valueMappingId:null,objectMappingId:e.processData.object_mapping_id}).then(M.proxy(this,function(){return this.__onDone(e)}))}))}},{key:"_getProcessComponentsSuccessChecklistList",value:function(e,t,n){this._getProcessComponentsSuccessStandaloneEdit(e,t,n)}},{key:"_onGetHeaderAndLineItemComplete",value:function(e){var t=T.Deferred();return t.resolve(),t}},{key:"_flagOpenRecords",value:function(e){if(e.requesterId&&"VIEW RECORD"!==e.processType&&"STANDALONE CREATE"!==e.processType&&"SOURCE TO TARGET ALL"!==e.processType){var t=[],n=e.data.pageDataSet.sobjectinfo.getValue("Id");n&&t.push(n);var i=e.data.detailDataSet;M.array.forEach(i,function(e){M.array.forEach(e.pageDataSet,function(e){var n=e.sobjectinfo;n.getValue("Id")&&t.push(n.getValue("Id"))})}),te.setOwnerId(e.requesterId),te.addOpenRecords(e.requesterId,t)}else!te.getOwnerId()&&e.requesterId&&te.setOwnerId(e.requesterId)}},{key:"getChecklistAttachmentRecords",value:function(e,t){var n=M.OrgNamespace+"__SM_Checklist_Attachment__c",i=M.OrgNamespace+"__SM_ContentDocumentLink_ID__c",r=M.OrgNamespace+"__SM_Attachment_ID__c",o=M.OrgNamespace+"__SM_Checklist__c",s="";s=z.getMultiServerVersionRequest().isSalesForceFilesEnabled()?"SELECT c.*, sf.file_path AS file_path from "+n+" c\n        LEFT JOIN ContentDocumentLink cdl ON c."+i+" = cdl.Id\n        LEFT JOIN ContentDocument cd ON cdl.ContentDocumentId = cd.Id\n        LEFT JOIN ContentVersion cv ON cd.LatestPublishedVersionId = cv.Id\n        LEFT JOIN SFAttachments sf ON (cv.Id = sf.Id OR sf.Id = c."+i+" OR c."+r+" = sf.Id)\n        WHERE c."+o+" = '"+e+"'":"Select ca.*,sf.file_path FROM "+n+" ca LEFT JOIN SFAttachments sf ON ca."+r+" =  sf.Id WHERE ca."+o+" = '"+e+"'",a({query:s}).then(function(e){var n=e;t.data.response.records=n,t.data.response.processType=t.processType,t.responder.result(M.create("com.servicemax.client.offline.sal.model.impl.SFMDeliveryData",t.data))})}},{key:"__onDone",value:function(e){var t=z.getMultiServerVersionRequest(),n=t.isChecklistAttachementsEnabled();if(e.data.multiVersionRequest=t,"SYNC"!==e.requesterId&&this._flagOpenRecords(e),e.processData&&e.processData.value_mapping_id&&(e.data.valueMapping=!0),n&&"TARGET"===e.componentType&&"CHECKLIST"===e.processType){var i=e.data.pageDataSet.sobjectinfo.Id||null;this.getChecklistAttachmentRecords(i,e)}else e.responder.result(M.create("com.servicemax.client.offline.sal.model.impl.SFMDeliveryData",e.data))}}]),t}(B),G.GetTemplateData=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){e=e||{};var n={templateType:e.templateType||"CHECKLIST",componentType:e.componentType||"TARGET",refreshData:e.refreshData,requesterId:e.requesterId,templates:[],virtualFieldName:e.virtualFiledName||"LIST_SECTION_FIELD_ID",data:{response:{stringMap:[]},pageDataSet:{sobjectinfo:{},bubbleInfo:[]},detailDataSet:[]},expressionCounter:0,tableName:e.virtualTableName||"Virtual__c",recordId:e.recordId,responder:t,svmxConstants:[]},i=this._getUserInfo(n);i=i.then(M.proxy(this,this._getTemplates)),i=i.then(M.proxy(this,this._getExistingTemplates)),i=i.then(M.proxy(this,this._populateSObjectInfo)),i.done(M.proxy(this,this.__onDone)),i.fail(M.proxy(this,this.__onError))}},{key:"_getUserInfo",value:function(e){var t=M.Deferred(),n=ee.getUserInfo(),i=n.UserTrunkDetail?n.UserTrunkDetail.Id:null;return e.UserData=n,e.svmxConstants.push({fieldsToNull:null,key:"SVMX.USERTRUNK",value:i,value1:null}),e.data.svmxConstants=e.svmxConstants,t.resolve(e),t}},{key:"_getTemplates",value:function(e){e=e||{};return a({query:"SELECT     p.process_id, p.process_unique_id, p.process_type,     p.process_name, p.process_description,     pc.expression_id FROM SFProcess AS p JOIN SFProcessComponent AS pc     ON p.process_id = pc.process_id  AND     pc.component_type = 'TARGET' WHERE    p.process_type = 'CHECKLIST' AND     p.process_id IN (                        SELECT                            p2.process_id                        FROM SFProcess AS p2                        JOIN SFObjectDescribe AS d2                            ON d2.object_name = pc2.object_name                        AND                            d2.key_prefix = '{{object_prefix}}'                        JOIN SFProcessComponent AS pc2                            ON p2.process_id = pc2.process_id                        AND                            pc2.component_type = 'SOURCE'                        WHERE                            p2.process_type = 'CHECKLIST'                    )",queryParams:{object_prefix:e.recordId&&e.recordId.length>3?e.recordId.substring(0,3):""}}).then(M.proxy(this,this.__populateTemplates,e))}},{key:"_getExistingTemplates",value:function(e){return e=e||{},a({query:z.getMultiServerVersionRequest().getChecklistExistingTemplateQuery(),queryParams:{record_id:e.recordId}}).then(M.proxy(this,this.__populateExistingTemplates,e))}},{key:"_populateSObjectInfo",value:function(e){var t=M.Deferred();e=e||{},e.data=e.data||{};var n={activateable:!1,childRelationships:[],createable:!0,custom:!0,customSetting:!1,deletable:!0,deprecatedAndHidden:!1,feedEnabled:!1,fields:[{autoNumber:!1,byteLength:393216,calculated:!1,calculatedFormula:null,caseSensitive:!1,controllerName:null,createable:!0,custom:!0,defaultValue:null,defaultValueFormula:null,defaultedOnCreate:!1,dependentPicklist:!1,deprecatedAndHidden:!1,digits:0,externalId:!1,filterable:!1,groupable:!1,htmlFormatted:!1,idLookup:!1,inlineHelpText:null,label:"Checklist",length:131072,name:e.virtualFiledName,nameField:!0,namePointing:!1,nillable:!0,permissionable:!0,picklistValues:[],precision:0,referenceTo:[],relationshipName:null,relationshipOrder:null,restrictedPicklist:!1,scale:0,soapType:"xsd:string",sortable:!1,type:"textarea",unique:!1,updateable:!0,writeRequiresMasterRead:!1}],keyPrefix:"---",label:"Checklist",labelPlural:"Checklists",layoutable:!0,listviewable:null,lookupLayoutable:null,mergeable:!1,name:e.tableName,queryable:!0,recordTypeInfos:[],replicateable:!0,retrieveable:!0,searchLayoutable:null,searchable:!0,triggerable:!0,undeletable:!0,updateable:!0,urls:{}};return e.data.pageDataSet={sobjectinfo:new re({sourceRecordId:e.recordId,Id:e.recordId,LIST_SECTION_FIELD_ID:{fieldvalue:{key:"templates",value:e.templates}},objectDescribe:n},e.tableName),bubbleInfo:[]},t.resolve(e),t}},{key:"__populateTemplates",value:function(e,t){var n=M.Deferred();return e=e||{},t=t||[],e.templates=e.templates||[],Z.validateProcessesQualificationForRecord({record:e.record,recordId:e.recordId},t).then(M.proxy(this,function(t){if(t&&t.length>0){console.info("Qualified checklist processes: "+t.length);for(var i=0;i<t.length;i++)e.templates.push({status:"Qualified",recordId:e.recordId,processName:t[i].process_name,processId:t[i].process_unique_id,sfProcessId:t[i].process_id,description:t[i].process_description})}n.resolve(e)})),n}},{key:"__populateExistingTemplates",value:function(e,t){var n=M.Deferred();return e=e||{},t=t||[],e.templates=e.templates||[],Z.validateProcessesQualificationForRecord({record:e.record,recordId:e.recordId},t).then(M.proxy(this,function(t){if(t&&t.length>0){console.info("Qualified existing checklist processes: "+t.length);for(var i=0;i<t.length;i++)e.templates.push({status:t[i][M.OrgNamespace+"__Status__c"]||"In Progress",recordId:e.recordId,processName:t[i].process_name,processId:t[i].process_unique_id,sfProcessId:t[i].process_id,description:t[i].process_description,completionDate:t[i][M.OrgNamespace+"__Completed_On__c"],targetId:t[i].targetId})}n.resolve(e)})),n}},{key:"__onError",value:function(e){e=e||{},e.data=e.data||{},e.data.error=e.data.error||{},Q.error(e.data.error),e&&e.responder&&e.responder.result(M.create("com.servicemax.client.sfmdelivery.operationutils.SFMDeliveryData",e.data))}},{key:"__onDone",value:function(e){e&&e.responder&&e.responder.result(M.create("com.servicemax.client.offline.sal.model.impl.SFMDeliveryData",e.data))}}]),t}(B),G.CloseProcess=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).apply(this,arguments))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){te.removeOpenRecords(e.requesterId),te.setOwnerId(null)}}]),t}(B),G.GetNextStepInfo=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){}}]),t}(B),G.InvokeEvent=function(e){function t(){(0,m.default)(this,t);var e=(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return e.__responder=null,e}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){for(var e=["__responder"],n=e.length,i=n-1;i>=0;i--)this[e[i]]=null;return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){e.additionalInfo.eventType=e.event.eventType,this.__responder=t;var n=e.data.getTargetRecordId(),i=k.getOpenRecordRemoteIds();n in i&&e.data.setTargetRecordId(i[n]);var a=e.event;"WEBSERVICE"==a.callType?(t.result(),this.doCleanup()):"JAVASCRIPT"==a.callType?this.__invokeJavaScriptEvent(e,t):(a.callType,t.result(),this.doCleanup())}},{key:"__invokeJavaScriptEvent",value:function(e,t){var n=this,i=e.event.eventRawData;z.getMultiServerVersionRequest().isCustomSnippetSupported()?a({query:"SELECT "+M.OrgNamespace+"__SM_Snippet_Version__c as version FROM "+M.OrgNamespace+"__Code_Snippet__c WHERE Id = '"+i[M.OrgNamespace+"__Code_Snippet__c"]+"'"}).then(M.proxy(this,function(t){t&&t.length?"1.0"===t[0].version?this.__executeCustomSnippetData(i,e):this.__executeStandardSnippetData(i,e):(this.__responder.result(),this.doCleanup())})).catch(function(e){n.__responder.result(),n.doCleanup()}):this.__executeStandardSnippetData(i,e)}},{key:"__invokeSnippet",value:function(e,t){e="try { (function(){"+e+"})(); } catch(e) {$EXPR.Logger.error('JS Snippet Error: ' + e); $RETURN(context);}";var n=M.create("com.servicemax.client.sfmdelivery.operationutils.SFMTargetRecord",t.data,t.metadata,t.additionalInfo),i=n.getRequest();U.initialize(),$EXPR.SVMXEvalExpression(e,i,function(e){t.data.copyFromTargetRecord(e),this.__responder.result(),this.doCleanup(),U.doCleanup()},this)}},{key:"__getCodeSnippet",value:function(e){var t=M.Deferred();return a({query:"Select main.{{ns}}__Referenced_Code_Snippet__c, snippetTable.{{ns}}__Data__c as snippetData from {{ns}}__Code_Snippet_Manifest__c AS main LEFT JOIN {{ns}}__Code_Snippet__c AS snippetTable ON snippetTable.Id = main.{{ns}}__Referenced_Code_Snippet__c where {{ns}}__Code_Snippet__c = '{{sid}}'",queryParams:{ns:M.OrgNamespace,sid:e[M.OrgNamespace+"__Code_Snippet__c"]}}).then(M.proxy(this,function(n){a({query:"Select {{ns}}__Data__c as snippet from {{ns}}__Code_Snippet__c where Id = '{{sid}}'",queryParams:{ns:M.OrgNamespace,sid:e[M.OrgNamespace+"__Code_Snippet__c"]}}).then(M.proxy(this,function(e){var i=e[0]&&e[0].snippet;i&&(i=i.replace(new RegExp("&#10;","g"),"\n"));for(var a=i||"",r=void 0,o=0;o<n.length;o++)r=n[o].snippetData,r=r.replace(new RegExp("&#10;","g"),"\n"),a+=r;t.resolve(a)})).catch(function(e){t.reject(e)})})).catch(function(e){t.reject(e)}),t}},{key:"__executeStandardSnippetData",value:function(e,t){var n=this;this.__getCodeSnippet(e).then(M.proxy(this,function(e){e&&e.length>0?this.__invokeSnippet(e,t):(this.__responder.result(),this.doCleanup())})).catch(function(e){n.__responder.result(),n.doCleanup()})}},{key:"__executeCustomSnippetData",value:function(e,t){a({query:"SELECT "+M.OrgNamespace+"__Type__c AS callType, Id ,"+M.OrgNamespace+"__Data__c as snippetData FROM "+M.OrgNamespace+"__Code_Snippet__c WHERE Id = '"+e[M.OrgNamespace+"__Code_Snippet__c"]+"'"}).then(M.proxy(this,function(e){if(e&&e.length){var t=e[0],n=t.callType&&t.callType.toLowerCase(),i=(t.Id,t.snippetData);"javascript"===n?this.__invokeCustomSnippet(i):this.__customSnippetError("Not a javascript snippet")}}))}},{key:"__invokeCustomSnippet",value:function(e){var t=this;if(e){var n=e.replace(new RegExp("&#10;","g"),"\n"),i="try { (function(){"+n+"})(); } catch(e) {$CUSTEXPR.Logger.error('JS Snippet Error: ' + e); $response(context);}";Y.initialize(),$CUSTEXPR.SVMXEvalCustomExpression(i,this,function(e){t.__responder&&t.__responder.__responder&&t.__responder.__responder.result(e,!0),Y.doCleanup(),t.doCleanup()})}else this.__customSnippetError("Snippet Not found"),this.doCleanup()}},{key:"__customSnippetError",value:function(e){me.__responder&&me.__responder.__responder&&me.__responder.__responder.result(result,!0)}}]),t}(B),G.SaveTargetRecord=function(e){function t(){(0,m.default)(this,t);var e=(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return e.lineBatchCount=50,e}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return this.lineBatchCount=null,(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){Q.info("start process header save "+new Date),this.optimizeSaveData(e);var n=e.data.__data.sfmData,i={},r=[];M.forEachProperty(n.details,function(e,t){r.push(e)}),a({query:"SELECT layout_id, object_name FROM SFProcessComponent where layout_id IN ('{{ids}}')",queryParams:{ids:r.join("','")}}).then(M.proxy(this,function(a){for(var r=0;r<a.length;r++){var o=a[r];i[o.layout_id]=o.object_name}var s={responder:t,processId:e.additionalInfo.processId,processData:null,componentType:e.componentType||"TARGET",objectName:n.attributes.type,sourceRecordId:e.sourceRecordId,data:M.deepCloneObject(n),deletedRecords:e.data.__deletedRecords,detailMap:i,deleteCounter:0,itemsDoneHash:{header:!1},sourceObjectUpdateDone:!0,syncInsertRecords:[],syncUpdateRecords:[],syncDeleteRecords:[],isFieldMergeEnabled:!1,wsInfo:null,skipAggressiveSync:e.skipAggressiveSync,skipStatusMsg:e.skipStatusMsg,doSourceObjectUpdate:e.doSourceObjectUpdate};if(e.metadata&&e.metadata.page&&e.metadata.page.header){var l=this.getWebServiceActions(e.metadata.page.header.pageEvents);l&&l.length&&(s.wsInfo={actionTime:(new Date).getTime(),processType:e.metadata.response.sfmProcessType,processId:s.processId,actions:l})}Z.getProcess({processId:s.processId}).then(M.proxy(this,function(t){s.processData=t[0],s.sfProcessId=t[0].process_id,t[0].run_targeted_sync&&(s.runTargetedSync=t[0].run_targeted_sync),s.processType=s.processData.process_type,"TARGET"===s.componentType&&("SOURCE TO TARGET ALL"===s.processType||"SOURCE TO TARGET CHILD"===s.processType||"CHECKLIST"===s.processType&&s.doSourceObjectUpdate)&&this.executeSourceObjectUpdate(s),Z.describeObject({objectName:s.objectName,onSuccess:M.proxy(this,function(e){var t=this,n=[];this.__replaceRefs(s,s.data,e.fields,n),n.length>0&&$.bulkInsertUpdateIntoRecordNameTable(n),M.forEachProperty(s.data.details,M.proxy(this,function(e,n){for(var i=0;i<s.data.details[e].lines.length;i+=t.lineBatchCount)s.itemsDoneHash[e+"_"+i]=!1})),this.__modifyDataForSpecificUseCases(s.objectName,s.data),this.getIsFieldMergeEnabled(function(n){s.isFieldMergeEnabled=n;var i=z.getMultiServerVersionRequest(),a=i.isChecklistMultiRowSequencingEnabled();if(s.objectName===M.getCustomObjectName("Checklist")&&a){var r=oe.getCheckListChunkRows(s.data,s.sfProcessId,s.processType,s.processData),o=M.getCustomObjectName("What_Id"),l=s.data[o];s.data[o]=this.__getMappedRemoteIdIfExists(l),r.then(function(n){s.chunkRows=n,t.writeChecklistItem(s,s.objectName,n[0],e.fields,null,"header");var i=s.responder&&s.responder.__request&&s.responder.__request.data&&s.responder.__request.data.__attachementData;if(i&&i.__attachementDataHash&&(0,u.default)(i.__attachementDataHash).length>0&&(t.writeChecklistAttachmentData(i,M.toObject(s.data[M.OrgNamespace+"__ChecklistJSON__c"])),i&&i.__deletedRecords&&i.__deletedRecords.length>0&&t.deleteChecklistAttachmentData(i),i&&i.__localDeletedFiles&&i.__localDeletedFiles.length>0))for(var a=0;a<i.__localDeletedFiles.length;a++)if(i.__localDeletedFiles[a]){var r=new C(i.__localDeletedFiles[a]);r.deleteFile()}})}else this.__writeItem(s,s.objectName,s.data,e.fields,null,"header");M.forEachProperty(s.data.details,M.proxy(this,function(e,t){Q.info("start process line save "+new Date),this.__processBulkLineItem(s.data.details[e].lines,e,s)}))})}),onError:function(t){Q.error("Describe Object Failed for "+e.objectName),s.error="Describe Object Failed for SaveTargetRecord while requesting "+s.objectName,t.data.data&&(s.error+="; "+t.data.data),s.responder.result(s)}})}))}))}},{key:"optimizeSaveData",value:function(e){var t=e.data.__data.sfmData;if(e.data.__originalData&&t&&t.details){var n=M.create("com.servicemax.client.sfmdelivery.operationutils.SFMTargetRecord",e.data,e.metadata,e.additionalInfo);"STANDALONE EDIT"===n.getProcessType()&&(e.data.__data.sfmData=n.getOptimizedSfmData())}}},{key:"getWebServiceActions",value:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var a=e[n],r=a[M.OrgNamespace+"__Event_Call_Type__c"],o=a[M.OrgNamespace+"__Event_Type__c"],s=a[M.OrgNamespace+"__Target_Call__c"];if(r&&o&&"WEBSERVICE"===r&&"Before Save/Insert"!==o){var l={callType:r,eventType:o,methodName:s};t.push(l)}}return t}},{key:"__replaceRefs",value:function(e,t,n,i){for(var a=T.isArray(t)?t:[t],r=0;r<a.length;r++)for(var o=a[r],s=0;s<n.length;s++){var c=n[s];("reference"==c.type||"picklist"==c.type)&&o[c.name]&&"object"===(0,l.default)(o[c.name])&&"fieldvalue"in o[c.name]&&("reference"==c.type&&o[c.name].fieldvalue.key&&o[c.name].fieldvalue&&i.push({key:o[c.name].fieldvalue.key,value:o[c.name].fieldvalue}),o[c.name]=o[c.name].fieldvalue.key)}return i}},{key:"__modifyDataForSpecificUseCases",value:function(e,t){if(e===M.OrgNamespace+"__SVMX_Event__c"){var n=ee.getUserInfo();t[M.OrgNamespace+"__Technician__c"]=n.UserTechId}}},{key:"__writeItem",value:function(e,t,n,i,a,r,o){"header"!=r&&"TARGET"===e.componentType?G.Utilities.getProcessComponents({processId:e.processId,onSuccess:M.proxy(this,function(s,l){for(var c=0;c<l.length;c++){var u=l[c];if(u.layout_id===a){var d=u.parent_column;return void this.__writeItem2(e,t,n,i,a,d,r,o)}}})}):this.__writeItem2(e,t,n,i,a,null,r,o)}},{key:"getIsFieldMergeEnabled",value:function(e){a({query:"SELECT * FROM MobileDeviceSettings WHERE setting_id = '{{settingId}}'",queryParams:{settingId:"IPAD018_SET016"}}).then(M.proxy(this,function(t){var n=!1;t&&t.length&&t[0].value&&(n="true"===t[0].value.toLowerCase()),e&&e.call(this,n)}))}},{key:"writeChecklistAttachmentData",value:function(e,t){var n=this,i=e.__attachementDataHash,r=(0,u.default)(i),o="",s=z.getMultiServerVersionRequest(),l=s.isSalesForceFilesEnabled();l&&(o="SFILE");for(var c=0;c<r.length;c++){var d=i[r[c]];(0,u.default)(d).length>0&&d.saveRequired&&function(){var t=ee.getUserInfo(),i=(t.TimezoneOffset,D.getTimestampWithSaveFormat()),s=M.OrgNamespace+"__SM_Attachment_ID__c";l&&(s=M.OrgNamespace+"__SM_ContentDocumentLink_ID__c");var u=d[s],_=d[M.OrgNamespace+"__SM_Checklist__c"];_=n.__getMappedRemoteIdIfExists(_),e.__attachementDataHash[r[c]].saveRequired=!1,a({query:"INSERT INTO SFAttachments (Id, parent_id, created_by_id, file_path, downloaded, name, last_modified_date, content_length, file_type) VALUES('{{id}}', '{{record_id}}', '{{created_by_id}}', '{{file_path}}', 'true', '{{name}}', '{{last_modified}}', '{{content_length}}', '{{file_type}}')",queryParams:{id:u,record_id:_,created_by_id:t.UserId,file_path:d.file_path,name:d[M.OrgNamespace+"__SM_Attachment_Name__c"],content_length:d[M.OrgNamespace+"__SM_File_Size__c"],file_type:o}}).then(M.proxy(n,function(){te.insertAttachment({Id:u,isAttachment:!0,parentId:_})}));var h="INSERT INTO {{table_name}} (Id, OwnerId, CreatedDate, CreatedById, LastModifiedDate, {{ns}}__SM_Question__c, {{ns}}__SM_Attachment_ID__c, {{ns}}__SM_Attachment_Name__c, {{ns}}__SM_File_Type__c, {{ns}}__SM_File_Size__c, {{ns}}__SM_Checklist__c, {{ns}}__SM_Internal_Question_ID__c, LastModifiedById";h+=l?", {{cdlColumn}} ) ":") ",h+="VALUES('{{id}}', '{{OwnerId}}', '{{CreatedDate}}', '{{CreatedById}}', '{{LastModifiedDate}}', '{{SmQuestion}}', '{{SmAttachmentId}}', '{{SmAttachmentName}}', '{{FileType}}', '{{FileSize}}', '{{SmChecklist}}', '{{SmInternalQuestionId}}', '{{LastModifiedById}}'",h+=l?", '{{contentDocumentLinkId}}')":")",a({query:h,queryParams:{table_name:M.OrgNamespace+"__SM_Checklist_Attachment__c",ns:M.OrgNamespace,cdlColumn:l?M.OrgNamespace+"__SM_ContentDocumentLink_ID__c":"",id:d.Id,OwnerId:t.UserId,CreatedDate:i,CreatedById:t.UserId,LastModifiedById:t.UserId,LastModifiedDate:i,SmQuestion:d[M.OrgNamespace+"__SM_Question__c"],SmAttachmentId:l?"":d[M.OrgNamespace+"__SM_Attachment_ID__c"],SmAttachmentName:d[M.OrgNamespace+"__SM_Attachment_Name__c"],FileType:d[M.OrgNamespace+"__SM_File_Type__c"],FileSize:d[M.OrgNamespace+"__SM_File_Size__c"],SmChecklist:_,SmInternalQuestionId:d[M.OrgNamespace+"__SM_Internal_Question_ID__c"],contentDocumentLinkId:l?d[M.OrgNamespace+"__SM_ContentDocumentLink_ID__c"]:""}})}()}}},{key:"__getMappedRemoteIdIfExists",value:function(e){var t=e,n=k.getOpenRecordRemoteIds();return"string"==typeof e&&e.indexOf("_local")>0&&n&&n[e]&&(t=n[e]),t}},{key:"deleteChecklistAttachmentData",value:function(e){for(var t=e,n=t.__deletedRecords,i=[],r=[],o=[],s=M.OrgNamespace+"__SM_Attachment_ID__c",l=M.OrgNamespace+"__SM_Checklist__c",c=M.OrgNamespace+"__SM_ContentDocumentLink_ID__c",u=[],d={},_=0;_<n.length;_++){var h=n[_][s],f=n[_].Id,p=n[_][c];h&&h.indexOf("_local")>0&&u.push(h),h&&h.length&&(h=this.__getMappedRemoteIdIfExists(h),n[_][s]=h,i.push(h),d[h]=n[_][l]),f.indexOf("_local")>0&&u.push(f),f=this.__getMappedRemoteIdIfExists(f),n[_].Id=f,r.push(f),d[f]=n[_][l],p&&p.indexOf("_local")>0&&u.push(p),p&&p.length&&(p=this.__getMappedRemoteIdIfExists(p),n[_][c]=p,i.push(p),o.push(p),d[p]=n[_][l])}if(i.length>0&&a({query:"SELECT Id, parent_id, file_path as __path FROM SFAttachments WHERE Id IN ('{{Ids}}')",queryParams:{Ids:i.join("','")}}).then(M.proxy(this,function(e){for(var t=this,n=0;n<e.length;n++)!function(n){var i=e[n].__path,a=e[n].Id,r=e[n].parent_id;if(i){var o=new C(i);o.info().then(t,function(e){o.deleteFile()})}$.deleteRecord({Id:a,tableName:"SFAttachments",parentId:d[a],onSuccess:M.proxy(t,function(e){e.recordType="attachment",e.objectName="Attachment",e.parentId=r,$.writeSyncRecords([],[],[e],function(){})}),onError:M.proxy(t,function(){Q.error("Error in deleteChecklistAttachmentData for Attachments")})})}(n)})),r.length>0)for(var m=0;m<r.length;m++)$.deleteRecord({Id:r[m],parentId:d[r[m]],onSuccess:M.proxy(this,function(e){e.recordType="master",$.writeSyncRecords([],[],[e],function(){})}),onError:M.proxy(this,function(){Q.error("Error in deleteChecklistAttachmentData for Checklist_Attachments")})});if(o.length>0&&$.deleteSfFileRelatedTables(o,d,!0),u.length>0){a({query:"DELETE FROM ClientSyncLog WHERE Id in ('{{Ids}}')",queryParams:{ns:M.OrgNamespace,Ids:u.join("','")}}),a({query:"DELETE FROM ClientSuccSyncLog WHERE Id in ('{{Ids}}')",queryParams:{ns:M.OrgNamespace,Ids:u.join("','")}})}}},{key:"writeChecklistItem",value:function(e,t,n,i,a,r,o,s){function l(a,s){r&&(n[r]=e.data.Id),$.writeRecord({data:d[a],type:t,fields:i,parentId:null,isFieldMergeEnabled:e.isFieldMergeEnabled,onSuccess:M.proxy(this,function(t,n){n&&(0===a&&e.wsInfo&&!e.wsInfo.recordId&&(n.parentId?e.wsInfo.recordId=n.parentId:e.wsInfo.recordId=n.Id),t?(a>0&&(n.parentId=d[0].Id),e.syncInsertRecords.push(n)):e.syncUpdateRecords.push(n),e.itemsDoneHash[n.Id]=!0),e.itemsDoneHash[a]=!0,s&&s.handler&&s.handler.call(s.context),0===a&&(e.itemsDoneHash.header=!0),a+1==d.length&&u.__isDone(e)}),onError:M.proxy(this,function(t){s&&s.handler&&s.handler.call(s.context),Q.error("writeItem2 FAILED: "+t),e.itemsDoneHash[o]=!0,this.__isDone(e)})})}function c(e){l(e,f)}for(var u=this,d=e.chunkRows||[],_=0;_<d.length;_++)e.itemsDoneHash[_]=!1;var h=0,f={handler:function(){++h<d.length&&c(h)},context:u};d.length?c(h):s&&s.handler&&s.handler.call(s.context)}},{key:"__writeItem2",value:function(e,t,n,i,a,r,o,s){r&&(n[r]=e.data.Id),$.writeRecord({data:n,type:t,fields:i,parentId:r?e.data.Id:null,isFieldMergeEnabled:e.isFieldMergeEnabled,onSuccess:M.proxy(this,function(t,n){if(n)e.wsInfo&&!e.wsInfo.recordId&&(n.parentId?e.wsInfo.recordId=n.parentId:e.wsInfo.recordId=n.Id),t?e.syncInsertRecords.push(n):e.syncUpdateRecords.push(n);else if(e.wsInfo&&!e.wsInfo.recordId){var i=e.data;i.parentId?e.wsInfo.recordId=i.parentId:e.wsInfo.recordId=i.Id}s&&s.handler&&s.handler.call(s.context),e.itemsDoneHash[o]=!0,this.__isDone(e)}),onError:M.proxy(this,function(t){s&&s.handler&&s.handler.call(s.context),Q.error("writeItem2 FAILED: "+t),e.itemsDoneHash[o]=!0,this.__isDone(e)})})}},{key:"__writeBulkItem",value:function(e,t,n,i,a,r,o,s){$.writeBulkRecord({data:n,type:t,fields:i,parentId:r?e.data.Id:null,isFieldMergeEnabled:e.isFieldMergeEnabled,onSuccess:M.proxy(this,function(t){for(var n=0;n<t.length;n++){var i=t[n];i&&(e.wsInfo&&!e.wsInfo.recordId&&(i.parentId?e.wsInfo.recordId=i.parentId:e.wsInfo.recordId=i.Id),i.isInsert?e.syncInsertRecords.push(i):e.syncUpdateRecords.push(i))}s&&s.handler&&s.handler.call(s.context),e.itemsDoneHash[o]=!0,this.__isDone(e)}),onError:M.proxy(this,function(t){s&&s.handler&&s.handler.call(s.context),Q.error("writeItem2 FAILED: "+t),e.itemsDoneHash[o]=!0,this.__isDone(e)})})}},{key:"__processLineItem",value:function(e,t,n){if(0!=e.length||M.array.contains(n.deletedRecords,function(e){return e.alias===t})){var i=e.length?e[0].attributes.type:n.detailMap[t];Z.describeObject({objectName:i,onSuccess:M.proxy(this,function(a){function r(r){s.__writeItem(n,i,e[r],a.fields,t,t+"_"+r,u)}var o=void 0,s=this,l=0,c=[];for(o=0;o<e.length;o++)this.__replaceRefs(n,e,a.fields,c);c.length>0&&$.bulkInsertUpdateIntoRecordNameTable(c);var u={handler:function(){++l<e.length&&r(l)},context:s};e.length&&r(l);var d=M.cloneObject(n.deletedRecords);n.deletedRecords.length=0,M.array.forEach(d,function(e){e.alias===t?(n.deleteCounter++,$.deleteRecord({Id:e.id,isHeader:!1,onSuccess:M.proxy(this,function(e){n.deleteCounter--,e&&n.syncDeleteRecords.push(e),this.__isDone(n)}),onError:M.proxy(this,function(){n.deleteCounter--,Q.error("Failed to delete record"),this.__isDone(n)})})):n.deletedRecords.push(e)},this)}),onError:function(e){Q.error("Describe Object Failed for "+n.objectName),n.error="Describe Object Failed for SaveTargetRecord while requesting "+i,e.data.data&&(n.error+="; "+e.data.data),n.responder.result(n)}})}}},{key:"__processBulkLineItem",value:function(e,t,n){function i(e,t){Z.describeObject({objectName:r,onSuccess:M.proxy(e,function(n){a(e,n,t)}),onError:function(t){Q.error("Describe Object Failed for "+n.objectName),n.error="Describe Object Failed for SaveTargetRecord while requesting "+r,t.data.data&&(n.error+="; "+t.data.data),n.responder.result(n),e.doCleanup()}})}function a(i,a,o){function s(e,i){c.__writeBulkItem(n,r,i,a.fields,t,o,t+"_"+e,_)}var l=void 0,c=i,u=0,d=[];for(l=0;l<e.length;l++)o&&(e[l][o]=n.data.Id),i.__replaceRefs(n,e[l],a.fields,d);d.length>0&&$.bulkInsertUpdateIntoRecordNameTable(d);var _={handler:function(){if(u<e.length){var t=null,n=u;if(u+c.lineBatchCount<e.length)t=e.slice(u,u+c.lineBatchCount),u+=c.lineBatchCount;else{var i=e.length-u;t=e.slice(u,u+i),u+=i}s(n,t)}},context:c};if(e.length){var h=u,f=null;if(u+c.lineBatchCount<e.length)f=e.slice(u,c.lineBatchCount),u+=c.lineBatchCount;else{var p=e.length-u;f=e.slice(u,p),u+=p}s(h,f)}var m=M.cloneObject(n.deletedRecords);n.deletedRecords.length=0,M.array.forEach(m,function(e){e.alias===t?(n.deleteCounter++,$.deleteRecord({Id:e.id,isHeader:!1,parentId:e.parentId,onSuccess:M.proxy(i,function(e){n.deleteCounter--,e&&n.syncDeleteRecords.push(e),i.__isDone(n)}),onError:M.proxy(i,function(){n.deleteCounter--,Q.error("Failed to delete record"),i.__isDone(n)})})):n.deletedRecords.push(e)},i)}if(0!=e.length||M.array.contains(n.deletedRecords,function(e){return e.alias===t})){var r=e.length?e[0].attributes.type:n.detailMap[t];!function(e){G.Utilities.getProcessComponents({processId:n.processId,onSuccess:M.proxy(e,function(n,a){for(var r=null,o=0;o<a.length;o++){var s=a[o];if(s.layout_id===t){r=s.parent_column;break}}i(e,r)}),onError:M.proxy(e,function(t){Q.error("getLineParentColumn for "+n.processId),n.error="getLineParentColumn for SaveTargetRecord while requesting "+r,t.data.data&&(n.error+="; "+t.data.data),n.responder.result(n),e.doCleanup()})})}(this)}}},{key:"executeSourceObjectUpdate",value:function(e){e.sourceObjectUpdateDone=!1;var t=void 0,n={},i=M.getCurrentApplication().getSyncImpl().getAggressiveSyncType(e.runTargetedSync),r=[];a({query:"select * from SFSourceUpdate LEFT JOIN SFProcessComponent ON SFProcessComponent.Id = SFSourceUpdate.target_process_node where SFProcessComponent.process_id='{{process_id}}' AND configuration_type='Source Update'",queryParams:{process_id:e.sfProcessId}}).then(M.proxy(this,function(i){if(t=i,0===t.length)return void(e.sourceObjectUpdateDone=!0);var r={};if("CHECKLIST"!==e.processType||null==e.sourceRecordId||e.data.hasOwnProperty("sourceRecordId")||(e.data.sourceRecordId=e.sourceRecordId),e.data.sourceRecordId){var o=e.data.sourceRecordId;"object"===(void 0===o?"undefined":(0,l.default)(o))&&o.fieldvalue&&o.fieldvalue.value&&(o=o.fieldvalue.value),e.data.sourceRecordId=o,r[Z.getTableForId(e.data.sourceRecordId)]=[e.data.sourceRecordId]}M.forEachProperty(e.data.details,function(e,t){M.array.forEach(t.lines,function(e){if(e.sourceRecordId){var t=e.sourceRecordId;"object"===(void 0===t?"undefined":(0,l.default)(t))&&t.fieldvalue&&t.fieldvalue.value&&(t=t.fieldvalue.value),e.sourceRecordId=t;var n=Z.getTableForId(e.sourceRecordId);r[n]||(r[n]=[]),r[n].push(e.sourceRecordId)}})});var s=[];return M.forEachProperty(r,M.proxy(this,function(e,t){var i=new T.Deferred;s.push(i),a({query:"SELECT * FROM '{{table_name}}' WHERE Id IN ('{{ids}}')",queryParams:{table_name:e,ids:t.join("','")}}).then(M.proxy(this,function(t){for(var a=0;a<t.length;a++)n[t[a].Id]=new ae(t[a],e);i.resolve()}))})),M.when(s)})).then(M.proxy(this,function(){var i=[];return M.array.forEach(t,function(t){var r=this,o=new T.Deferred;i.push(o);t.layout_id;if("TARGET"===t.component_type){var s=e.data,l=n[s.sourceRecordId];if(l)if("CHECKLIST"===e.processType&&t.question){var c=t.question;a({query:"select * from SFQuestionBank where Id = '{{questionId}}'",queryParams:{questionId:c}}).then(M.proxy(this,function(e){if(e&&e.length>0){var n=e[0].QuestionID;if(n){t.target_field_name=n;var i=M.getCustomFieldName("ChecklistJSON"),a=s[i];(a=a&&M.toObject(a))&&r.executeOneSourceObjectUpdate(a,l,t)}}o.resolve()}))}else this.executeOneSourceObjectUpdate(s,l,t),o.resolve();else o.resolve()}else{var u=e.data.details;if(t.layout_id){var d=u[t.layout_id],_=d.lines;_&&_.length>0&&M.array.forEach(_,function(e){var i=n[e.sourceRecordId];i&&this.executeOneSourceObjectUpdate(e,i,t)},this)}else M.forEachProperty(u,M.proxy(this,function(e,i){var a=i.lines;M.array.forEach(a,function(e){var i=n[e.sourceRecordId];i&&this.executeOneSourceObjectUpdate(e,i,t)},this)}));o.resolve()}},this),M.when(i)})).then(M.proxy(this,function(){var t=[];return M.forEachProperty(n,M.proxy(this,function(n,a){var o=new T.Deferred;t.push(o),a.writeRecord(function(t,a){a&&(t?e.syncInsertRecords.push(a):e.syncUpdateRecords.push(a)),"smart sync"===i&&r.push(n),o.resolve()},function(e){Q.error("Failed to write sourceObjectUpdate record "+n+": "+e.message+"; "+e.stack),o.resolve()})})),M.when(t)})).then(M.proxy(this,function(){"smart sync"===i&&r.length>0&&ne.writeToDBCache("TARGETED_SYNC_SOU",M.toJSON(r)),e.sourceObjectUpdateDone=!0,this.__isDone(e)}),M.proxy(this,function(t){Q.error("ERROR IN executeSourceToTargetMappings: "+t),e.sourceObjectUpdateDone=!0,this.__isDone(e)}))}},{key:"executeOneSourceObjectUpdate",value:function(e,t,n){n.source_field_name&&"id"===n.source_field_name.toLowerCase()&&M.getLoggingService().getLogger().error("Source Update: Cannot mapping into id field. Please remove the mapping!");var i=void 0;if(n.target_field_name)i=e[n.target_field_name];else switch(i=n.display_value){case"Now":i=D.macroDrivenDatetime(i,"YYYY-MM-DD","HH:mm:ss");break;case"Yesterday":case"Today":case"Tomorrow":i=D.macroDrivenDatetime(i,"YYYY-MM-DD","HH:mm:ss"),t.getFieldType(n.source_field_name)&&"datetime"===t.getFieldType(n.source_field_name)&&(i=D.convertToTimezone(i,void 0,!0))}var a=t.getValue(n.source_field_name);switch(n.action){case"Set":break;case"Increase":i=Number(a)+Number(i);break;case"Decrease":i=Number(a)-Number(i)}t.setValue(n.source_field_name,i)}},{key:"saveSourceRecordData",value:function(e,t){var n=new T.Deferred,i=t.__data.sfmData;return(new G.SaveTargetRecord).performAsync({data:{__data:{sfmData:i},__deletedRecords:[]},additionalInfo:{processId:e.processId},componentType:"SOURCE"},{result:M.proxy(this,function(){e.sourceObjectUpdateDone=!0,n.resolve()})}),n}},{key:"checkResponseStatus",value:function(){var e=void 0,t=function(){return M.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA008_TAG112","Saved Succesfully"),n=M.getCurrentApplication();t&&"string"==typeof t&&(e=M.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_QUICK_MESSAGE",this,{request:{message:t,type:"SVMX_SUCCESS"},responder:{}}),n.triggerEvent(e))}},{key:"updateSuccSyncRecords",value:function(e){function t(e){if(e&&e.length){for(var t={},i=0;i<e.length;i++){var a=te.parseSyncRecord(e[i]),r=te.parseSyncRecord(e[i]);r.Id in t&&("client"!==r.changeType||"server"!==t[r.Id].changeType)||(t[r.Id]=r)}for(var o in t){var a=t[o],s=n[a.Id];if(s){var l={};for(var c in s.oldValues)l[c]={client:{oldValue:s.oldValues[c],newValue:s.newValues[c]}};for(var c in a.oldValues){var u={oldValue:a.oldValues[c],newValue:a.newValues[c]};c in l?l[c].server=u:l[c]={server:u}}s.oldValues={},s.newValues={};for(var c in l){var r=l[c];r.client&&(r.server&&r.client.newValue===r.server.oldValue?(s.newValues[c]=r.server.newValue,s.oldValues[c]=r.server.oldValue):(s.newValues[c]=r.client.newValue,s.oldValues[c]=r.client.oldValue))}}}}}for(var n={},i=te.getOpenRecordRemoteIds(),r=0;r<e.length;r++){var o=e[r];o.Id in i&&(o.Id=i[o.Id]),n[o.Id]=o}return a({query:"SELECT * FROM ClientSuccSyncLog WHERE Id in ('"+(0,u.default)(n).join("','")+"')"}).always(t)}},{key:"__isDone",value:function(e){var t=!0,n=this;if(M.forEachProperty(e.itemsDoneHash,function(e,n){n||(t=!1)}),t&&!e.deleteCounter&&e.sourceObjectUpdateDone){var i=function(){var t={insertRecords:e.syncInsertRecords,updateRecords:e.syncUpdateRecords,deleteRecords:e.syncDeleteRecords,isSuccessive:o,callback:function(){if(e.wsInfo&&e.wsInfo.recordId){var t={wsInfo:e.wsInfo,isSuccessive:o,callback:s};te.writeSyncWebServiceRecords(t)}else s()}};te.writeSyncRecords(t)};Q.info("end process line save "+new Date);var a=M.getCurrentApplication().getSyncImpl().getAggressiveSyncType(e.runTargetedSync);e.skipStatusMsg||"smart sync"===a||this.checkResponseStatus();var r=M.getCurrentApplication().getSyncImpl(),o=r.isSuccessiveSyncEnabled(),s=function(){e.responder.result(e);var t=z.getMultiServerVersionRequest();if("smart sync"!==a||"CHECKLIST"!==e.processType||t.runTargetedSyncForChecklistAndOpdoc()||(a="full sync"),"smart sync"!==a||e.skipAggressiveSync)"full sync"===a&&(e.skipAggressiveSync||r.performAggressiveSync());else if(!1===e.isFieldMergeEnabled||!0===e.isFieldMergeEnabled&&(e.syncInsertRecords.length>0||e.syncUpdateRecords.length>0||e.syncDeleteRecords.length>0)){var i=e.data.Id.includes("local");i||o||ne.writeToDBCache("TARGETED_SYNC_REFERENCE."+e.data.Id,e.sfProcessId+"."+e.objectName),ne.registerJSCache("TARGETEDSYNC",1),ne.writeToJSCache("TARGETEDSYNC","recordId",e.data.Id),r.performTargetedSync(!1)}n.doCleanup()};o&&e.syncUpdateRecords.length?this.updateSuccSyncRecords(e.syncUpdateRecords).always(i):i()}}}]),t}(B),G.AddRecords=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=e.processId+"-"+e.alias,i=ue[n];this.__getProcessInfo(e.processId,e.alias,M.proxy(this,function(n,a){i=i?M.cloneObject(i):[{sobjectinfo:new ae({},a),bubbleInfo:[]}],(new G.DescribeObject).performAsync({objectName:e.objectName},{result:M.proxy(this,function(a){$.executeObjectMapping({targetData:i,sourceData:{},valueMappingId:n.valueMap}).then(M.proxy(this,function(){var n=this;e.multiAddFieldRecordIds||M.array.forEach(i,function(e,t){e.sobjectinfo.__new=!0},this);var r=void 0;e.multiAddFieldRecordIds?r=M.array.map(e.multiAddFieldRecordIds,function(e){return $.__generateId(i[0].sobjectinfo.getTableName())},this):i[0].sobjectinfo.Id=$.__generateId(i[0].sobjectinfo.getTableName());var o=i[0].sobjectinfo,s=i[0].bubbleInfo;for(var l in o)if(o[l]&&o.hasOwnProperty(l)&&o[l].fieldapiname){var c=M.array.filter(s,function(e){return e.fieldapiname===o[l].fieldapiname});0==c.length&&i[0].bubbleInfo.push(o[l])}A.addRecords_processData({request:e,responder:t,data:i,objectInfo:M.cloneObject(a),operation:this,cacheKey:"",optionalNewIds:r,onSuccess:M.proxy(this,function(e){t.result(e),n.doCleanup()})})}))})})}))}},{key:"__getProcessInfo",value:function(e,t,n){a({query:"SELECT SFPC.* FROM SFProcessComponent as SFPC LEFT JOIN SFProcess AS SFP ON SFPC.process_id=SFP.process_id where process_unique_id='{{process_unique_id}}' AND layout_id = '{{layout_id}}'",queryParams:{layout_id:t,process_unique_id:e},onSuccess:function(e){var t=e.data.data[0];n({objectMap:t.object_mapping_id,valueMap:t.value_mapping_id},t.object_name)}})}}]),t}(B),G.DeleteRecords=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){e.data.deleteDetailRecords(e.records,e.alias),t.result({}),this.doCleanup()}}]),t}(B),G.CopyRecords=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).apply(this,arguments))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=(e.sourceRecord,e.processId+"-"+e.alias),i=ue[n];i=i?M.cloneObject(i):[{sobjectinfo:new ae({},e.objectName),bubbleInfo:[]}],(new G.DescribeObject).performAsync({objectName:e.objectName},{result:M.proxy(this,function(n){var a=this;if(e.multiAddFieldRecordIds)t.result([]),this.doCleanup();else{var r;!function(){M.array.forEach(i,function(e,t){e.sobjectinfo.__copy=!0},a),i[0].sobjectinfo.Id=$.__generateId(i[0].sobjectinfo.getTableName());var o=i[0].sobjectinfo,s=i[0].bubbleInfo;for(r in o)if(o[r]&&o.hasOwnProperty(r)&&o[r].fieldapiname){var l=M.array.filter(s,function(e){return e.fieldapiname===o[r].fieldapiname});0==l.length&&i[0].bubbleInfo.push(o[r])}A.addRecords_processData({request:e,responder:t,data:i,objectInfo:M.cloneObject(n),operation:a,cacheKey:"",copyRecord:!0,onSuccess:M.proxy(a,function(e){t.result(e),a.doCleanup()})})}()}})})}}]),t}(B),G.GetBubbleData=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=this;e.callType="BUBBLE",e.KeyWord="",(new G.GetLookupConfig).performAsync(e,{result:M.proxy(this,function(e){var e={bubbleinfo:e.data.length?e.data[0].FieldMap:[{key:"",value:le().T("FSA008_TAG014","Info not available")}]};e.bubbleinfo=M.array.filter(e.bubbleinfo,function(e){return!e.key.match(/__r$/)&&!e.key.match(/__key$/)&&(!e.value||"string"==typeof e.value||e.value instanceof String)}),t.result(e),n.doCleanup()})})}}]),t}(B),G.GetRecordTypes=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=this,i=ne.readFromJSCache("SFMDELIVERY.RecordTypes",e.objectName);i=i||[],i=M.array.filter(i,function(e){return"Master"!=e.name&&e.fixedName}),M.doLater(function(){t.result(i),n.doCleanup()})}}]),t}(B),G.ListAttachments=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=this;a({query:this.getQueryForAttachments(e.attachmentActionName,e.recordId)}).then(function(e){var i=ee.getUserInfo(),a=i.TimezoneOffset,r=M.array.map(e,function(e){var t=e.author1;t||e.created_by_id!=i.UserId||(t=i.UserName);var n=J.convertToTimezone(e.last_modified_date,a,!1);return e=$.getSFilePathInfo(e),{name:e.name,file:new C(e.file_path),last_modified:n,Id:e.Id,description:e.description,downloaded:e.downloaded,type:e.fileExtName,size:e.content_length,author:t,fileType:e.file_type,contentDocumentId:e.content_document_id,parentId:e.parent_id}});t.result(r),n.doCleanup()})}},{key:"getQueryForAttachments",value:function(e,t){var n="SELECT SFAttachments.*, SFRecordName.name as author1 FROM SFAttachments LEFT JOIN SFRecordName ON SFRecordName.Id = SFAttachments.created_by_id WHERE parent_id='{{record_id}}' ";if("cancelAttachments"===e){var i=N.readFromJSCache("attachedFileDetails","filesAttached");n+=ie.getSubQueryForAttachmentsToIgnore(i,"SFAttachments"),N.clearJSCache("attachedFileDetails")}else if("deleteAttachment"===e||"addAttachment"===e||"refreshAllAttachments"===e){var a=N.readFromJSCache("attachedFileDetails","deletedAttachments"),r=N.readFromJSCache("attachedFileDetails","deletedContentVersions");r&&r.cVIds&&(a=a||[],a=a.concat(r.cVIds)),n+=ie.getSubQueryForAttachmentsToIgnore(a,"SFAttachments")}return n+="GROUP BY COALESCE ( NULLIF (SFAttachments.content_document_id,''), SFAttachments.Id) ",n+="ORDER BY last_modified_date DESC",n=M.string.substitute(n,{record_id:t})}}]),t}(B),G.ListOutputDocAttachments=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=this;a({query:"SELECT datetime(substr(sd.id, 11)/1000.0, 'unixepoch') AS last_modified_date, sd.*, p.process_name AS document_name FROM SmartDocHTML AS sd LEFT JOIN SFProcess AS p ON sd.process_id = p.process_unique_id WHERE submitted IS NULL AND sd.record_id = '{{record_id}}' ORDER BY last_modified_date DESC",queryParams:{record_id:e.recordId}}).then(function(e){var i=ee.getUserInfo(),a=i.TimezoneOffset,r=i.UserName,o=M.array.map(e,function(e){var t=J.convertToTimezone(e.last_modified_date,a,!1);return{name:e.document_name,file:new C("{UploadDirectory}/"+e.name),last_modified:t,Id:e.Id,downloaded:"true",type:"html",size:0,author:r}});t.result(o),n.doCleanup()})}}]),t}(B),G.EditAttachment=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=this,i=e.data.Id,a=e.data.name,r=e.data.description;R.getRecord({Id:i}).fail(M.proxy(this,function(){this.__logger.error("Cannot update name and description on attachment record. Record not found for: "+i),this.__failedUpdate(t)})).done(M.proxy(this,function(e){e.Name=a,e.Description=r,e.writeRecord(M.proxy(n,n.__sync,t),M.proxy(n,n.__failedUpdate,t))}))}},{key:"__sync",value:function(e,t,n){M.getCurrentApplication().getSyncImpl()&&M.getCurrentApplication().getSyncImpl().onSaveStarted(),t?$.writeSyncRecords([n],null,null,M.proxy(this,this.__updateSFTable,e)):$.writeSyncRecords(null,[n],null,M.proxy(this,this.__updateSFTable,e))}},{key:"__updateSFTable",value:function(e){var t=e.getEventObj().data.request.data;a({query:"UPDATE SFAttachments SET name = '{{name}}', description = '{{description}}' WHERE Id = '{{id}}'",queryParams:{id:t.Id,name:t.name,description:t.description||""}}).fail(M.proxy(this,function(){this.__logger.error("Failed to update SFAttachments for record: "+recordId),this.__failedUpdate(e)})).done(M.proxy(this,this.__finish,e))}},{key:"__finish",value:function(e){M.getCurrentApplication().getSyncImpl()&&M.getCurrentApplication().getSyncImpl().onSaveCompleted(),e&&e.result(!0),this.doCleanup()}},{key:"__failedUpdate",value:function(e){e&&e.result(!1),this.doCleanup()}}]),t}(B),G.DeleteAttachments=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"doCleanup",value:function(){return(0,_.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"doCleanup",this).call(this)}},{key:"performAsync",value:function(e,t){var n=M.array.map(e.data,function(e){return e.file}),i=(M.array.map(n,function(e){return e.getPath?e.getPath():e.__path}),M.array.map(e.data,function(e){return e.Id})),r=e.data||[];a({query:"DELETE FROM SFAttachments WHERE Id IN ('{{ids}}')",queryParams:{ids:i.join("','")}}).then(M.proxy(this,function(a){this.getSmartDocFilesToDelete(n,i).done(function(n){var i=M.array.map(n,function(e){if(!e.deleteFile)var e=new C(e.__path);return e.deleteFile()});M.when(i).then(function(){for(var n=r.length,i=0;i<n;i++)te.deleteRecord({Id:r[i].Id,recordType:"attachment",parentId:r[i].parentId});t.result(!0);var a=M.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),o=M.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{recordId:e.recordId}});a.triggerEvent(o),this.doCleanup()})})}))}},{key:"getSmartDocFilesToDelete",value:function(e,t){var n=M.Deferred();return a({query:"SELECT name FROM SmartDocHTML WHERE Id IN ('{{ids}}')",queryParams:{ids:t.join("','")}}).then(M.proxy(this,function(i){if(i){a({query:"DELETE FROM SmartDocHTML WHERE Id IN ('{{ids}}')",queryParams:{ids:t.join("','")}});var r=M.array.map(i,function(e){return e.name});this.deleteHTMLSignatures(r,e).done(function(e){n.resolve(e)})}else n.resolve(e)})),n}},{key:"deleteHTMLSignatures",value:function(e,t){var n=M.Deferred();return a({query:"SELECT name FROM SmartDocSignature WHERE html_name IN ('{{htmlFilesName}}')",queryParams:{htmlFilesName:e.join("','")}}).then(M.proxy(this,function(i){if(console.log("7. deleting signature."),i){for(var r=0;r<i.length;r++){var o=new C("{UploadDirectory}/"+i[r].name);t.push(o)}a({query:"DELETE FROM SmartDocSignature WHERE html_name IN ('{{htmlFilesName}}')",queryParams:{htmlFilesName:e.join("','")}}),n.resolve(t)}else n.resolve(t)})),n}}]),t}(B),G.ShareAttachments=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){e=e||{},e.attachments=e.attachments||[];var n=I,i=M.getClient().getApplicationParameter("device-info"),a=i["device-platform"]||"";if("ios"===a.toLowerCase()||"android"===a.toLowerCase()){var r=n.createShareRequest();r.bind("REQUEST_COMPLETED",function(e){t.result(!0)},this),r.bind("REQUEST_ERROR",function(e){t.result(!0)},this),r.execute({operation:"SHARE",files:e.attachments})}else{var r=n.createEmailRequest();r.bind("REQUEST_COMPLETED",function(e){t.result(!0)},this),r.bind("REQUEST_ERROR",function(e){t.result(!0)},this),r.execute({operation:"EMAIL",attachmentFiles:e.attachments})}t.result(!0)}}]),t}(B),G.AttachFile=function(e){function t(){(0,m.default)(this,t);var e=(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return e.isSalesForceFilesEnabled=!1,e.attachmentFileType="",e.fileSizeLimitName="25MB",e.fileSizeLimitBytes=26214400,e.checklistFileSizeLimitName="20MB",e.checklistFileSizeLimitBytes=20971520,e}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=this;z.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(n.isSalesForceFilesEnabled=!0,n.attachmentFileType="SFILE",n.fileSizeLimitName="25MB",n.fileSizeLimitBytes=26214400,n.checklistFileSizeLimitName="25MB",n.checklistFileSizeLimitBytes=26214400),n.performAttachFile(e,t)}},{key:"performAttachFile",value:function(e,t){if("WOATTACHMENT"===e.process){var n=e.data,i={data:{data:[{FilePath:"{UploadDirectory}/"+n.name,OriginalFileName:n.name}]}};this.onFileSelect(e,t,i)}else{var a=X.createFileRequest();a.bind("REQUEST_COMPLETED",M.proxy(this,"onFileSelect",e,t)),a.bind("REQUEST_ERROR",function(e){Q.error(e),t.fault(e)},this),a.execute({operation:"SELECT",multiSelect:!1,targetPath:"{UploadDirectory}",imageCompression:e.imageCompression})}}},{key:"onFileSelect",value:function(e,t,n){M.array.forEach(n.data.data,function(n){var i=X.createFileRequest();i.bind("REQUEST_COMPLETED",M.proxy(this,"onFileInfo",e,t,n)),i.bind("REQUEST_ERROR",function(e){Q.error(e),t.fault(e)},this),i.execute({operation:"INFO",file:n.FilePath})},this)}},{key:"onFileInfo",value:function(e,t,n,i){var a=i.data.data,r=this.validateFileInfo(a,n.FilePath,e);if(r)return t.fault(r);this.onFileSelected(e,t,n,a)}},{key:"validateFileInfo",value:function(e,t,n){var i=e.FileSizeInBytes;if(i>this.fileSizeLimitBytes||n&&n.checklistUpload&&n.record&&i>this.checklistFileSizeLimitBytes){return new C(t).deleteFile(),{fileInfo:e,fileSizeExceeded:!0,fileSizeLimitName:n.checklistUpload&&n.record?this.checklistFileSizeLimitName:this.fileSizeLimitName}}}},{key:"onFileSelected",value:function(e,t,n,i){var r=n.OriginalFileName;r=r.replace(/'/g,"''");var o=n.FilePath;o=o.replace(/'/g,"''");var s=ee.getUserInfo(),l=(s.TimezoneOffset,D.getTimestampWithSaveFormat(),"attach_local_"+(new Date).getTime()),c={Id:l,file:{__path:o}},u={};if(e.checklistUpload&&e.record)t.result({fileDataToStore:c,fileInfo:i,request:e});else{this.storeAttachmentInfoInJSCache(c);var d=["Id","parent_id","created_by_id","file_path","downloaded","name","last_modified_date","content_length"],_={Id:l,parent_id:e.recordId,created_by_id:s.UserId,file_path:o,downloaded:"true",name:r,content_length:i&&i.FileSizeInBytes};this.isSalesForceFilesEnabled&&(d.push("file_type"),_.file_type=this.attachmentFileType),u={query:"INSERT INTO  SFAttachments('"+d.join("','")+"') VALUES ('{{"+d.join("}}', '{{")+"}}')",queryParams:_},a(u).then(M.proxy(this,function(){te.insertAttachment({Id:l,isAttachment:!0,parentId:e.recordId||""});try{var n=M.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),i=M.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{recordId:e.recordId,attachmentActionName:"addAttachment"}});n.triggerEvent(i)}catch(e){Q.error("Error thrown in onFileInfo:"+e)}t.result(!1)}))}}},{key:"storeAttachmentInfoInJSCache",value:function(e){ne.registerJSCache("attachedFileDetails",10);var t=ne.readFromJSCache("attachedFileDetails","filesAttached");t?t.push(e):t=[e],ne.writeToJSCache("attachedFileDetails","filesAttached",t)}}]),t}(B),G.OpenFile=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){e.file.execute()}}]),t}(B),G.GetRecordConflicted=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){te.isRecordInConflict(e.recordId).then(function(e){t.result(e)})}}]),t}(B),G.GetViewProcesses=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){Z.getQualifiedProcessesForRecord({objectName:Z.getTableForId(e.record.Id),record:e.record,processType:"VIEW RECORD"}).then(M.proxy(this,function(e){t.result(e)}))}}]),t}(B),G.GetRecordAlreadyOpen=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=e.additionalInfo&&e.additionalInfo.targetId?e.additionalInfo.targetId:e.recordId;t.result(te.isRecordOpen(n))}}]),t}(B),G.OpenBrowser=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){X.createBrowserRequest().execute({link:e.link})}}]),t}(B),G.GetUrlAndParameters=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){M.when([a({query:"SELECT customUrl, class_name, method_name FROM SFWizardComponent WHERE process_id = '{{processId}}'",queryParams:{processId:e.processId}}),a({query:"SELECT ParameterName, ParameterValue, ParameterType FROM CustomActionParams WHERE DispatchProcessId = '{{processId}}'",queryParams:{processId:e.processId}})]).then(function(e,n){var i={customUrl:e[0].customUrl,class_name:e[0].class_name,method_name:e[0].method_name},a=[];n.length>0&&M.array.forEach(n,function(e){a.push({name:e.ParameterName,value:e.ParameterValue,type:e.ParameterType})}),t.result({urlData:i,customUrlParams:a})})}},{key:"_onGetUrlError",value:function(e,t){Q.error("GetUrlAndParameters failed to get custom url: "+t.data)}}]),t}(B),G.OpenTelephone=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){X.createTELRequest().execute({phone:e.phone})}}]),t}(B),G.OpenSMS=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){X.createSMSRequest().execute({phone:e.phone})}}]),t}(B),G.OpenEmail=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){X.createEmailRequest().execute({address:e.address})}}]),t}(B),G.CheckIfConflict=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){a({query:"SELECT * FROM ClientSyncConflict WHERE Id = '{{recordId}}' OR parent_id = '{{parentId}}' ",queryParams:{recordId:e.recordId,parentId:e.recordId}}).then(function(e){t.result(e)})}}]),t}(B),G.GetProductHistory=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=[],i=e.woRecord,r=M.OrgNamespace+"__Problem_Description__c",o=M.OrgNamespace+"__Component__c",s=M.OrgNamespace+"__Order_Status__c",l=M.OrgNamespace+"__Service_Order__c",c=i.CreatedDate.fieldvalue.key,u=i[o];if(c&&u&&u.fieldvalue.key){var d=u.fieldvalue.key;a({query:"SELECT  c.Id,  c."+r+",  c.Name,  c.CreatedDate  FROM "+l+" AS c  WHERE  c."+o+" = '{{component}}' AND  c."+s+" = 'Closed' AND  c.CreatedDate < '{{createdDate}}'",queryParams:{component:d,createdDate:c}}).then(M.proxy(this,function(e){if(e&&0!=e.length){for(var i=0;i<e.length;i++)n.push({Id:e[i].Id,name:e[i].Name,productDesc:e[i][r],createdDate:e[i].CreatedDate});t.result(n)}else t.result(n)}))}else t.result(n)}}]),t}(B),G.GetOnlineProductHistory=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=[],i=e.woRecord,a=M.OrgNamespace+"__Problem_Description__c",r=M.OrgNamespace+"__Component__c",o=M.OrgNamespace+"__Order_Status__c",s=M.OrgNamespace+"__Service_Order__c",l=i.CreatedDate.fieldvalue.key;l&&(l=J.parseGMTDate(l).toISOString());var c=i[r];if(l&&c&&c.fieldvalue.key){var u=c.fieldvalue.key,d=M.string.substitute("SELECT Id, "+a+", Name, CreatedDate FROM "+s+" WHERE "+r+" = '{{component}}' AND "+o+" = 'Closed' AND CreatedDate < {{createdDate}} Limit 50",{component:u,createdDate:l}),_=M.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),h=function(e,n){e=e||{},e.isSuccess=!1,e.isConnectivityError=!!n,t.result(e)},f=function(e){if(e.data.done){var i=e.data.records;n=(i||[]).map(function(e){return{Id:e.Id,name:e.Name,productDesc:e[a],createdDate:e.CreatedDate,online:"true"}})}t.result(n)};_.checkConnectivity().then(function(){_.getServerRecords({data:e,query:d}).then(f,h)},function(e){h(e,!0)})}else t.result(n)}}]),t}(B),G.DownloadRecordOnDemand=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=function(e){t&&t.result(e)},i=function(e){t&&t.fault(e)};M.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().downloadRecordOnDemand(e).then(M.proxy(this,n),M.proxy(this,i))}}]),t}(B),G.GetAccountHistory=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=[],i=e.woRecord,r=M.OrgNamespace+"__Problem_Description__c",o=M.OrgNamespace+"__Company__c",s=M.OrgNamespace+"__Order_Status__c",l=M.OrgNamespace+"__Service_Order__c",c=i.CreatedDate.fieldvalue.key,u=i[o];if(c&&u&&u.fieldvalue.key){var d=u.fieldvalue.key;a({query:"SELECT  c.Id,  c."+r+",  c.Name,  c.CreatedDate  FROM "+l+" AS c  WHERE  c."+o+" = '{{account}}' AND  c."+s+" = 'Closed' AND  c.CreatedDate < '{{createdDate}}'",queryParams:{account:d,createdDate:c}}).then(M.proxy(this,function(e){if(e&&0!=e.length){for(var i=0;i<e.length;i++)n.push({Id:e[i].Id,name:e[i].Name,productDesc:e[i][r],createdDate:e[i].CreatedDate});t.result(n)}else t.result(n)}))}else t.result(n)}}]),t}(B),G.GetOnlineAccountHistory=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=[],i=e.woRecord,a=M.OrgNamespace+"__Problem_Description__c",r=M.OrgNamespace+"__Company__c",o=M.OrgNamespace+"__Order_Status__c",s=M.OrgNamespace+"__Service_Order__c",l=i.CreatedDate.fieldvalue.key;l&&(l=J.parseGMTDate(l).toISOString());var c=i[r];if(l&&c&&c.fieldvalue.key){var u=c.fieldvalue.key,d=M.string.substitute("SELECT Id, "+a+", Name, CreatedDate FROM "+s+" WHERE "+r+" = '{{account}}' AND "+o+" = 'Closed' AND CreatedDate < {{createdDate}} Limit 50",{account:u,createdDate:l}),_=M.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),h=function(e,n){e=e||{},e.isSuccess=!1,e.isConnectivityError=!!n,t.result(e)},f=function(e){if(e.data.done){var i=e.data.records;n=(i||[]).map(function(e){return{Id:e.Id,name:e.Name,productDesc:e[a],createdDate:e.CreatedDate,online:"true"}})}t.result(n)};_.checkConnectivity().then(function(){_.getServerRecords({data:e,query:d}).then(f,h)},function(e){h(e,!0)})}else t.result(n)}}]),t}(B),G.IsDodRecord=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){a({query:"SELECT * FROM ClientDataOnDemand WHERE Id = '{{recordId}}'",queryParams:{recordId:e.recordId}}).then(function(e){t(e)})}}]),t}(B),G.ChecklistFileAttachment=function(e){function t(){(0,m.default)(this,t);var e=(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return e.fileSizeLimitName="20MB",e.fileSizeLimitBytes=20971520,e}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=this;z.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(n.isSalesForceFilesEnabled=!0,n.attachmentFileType="SFILE",n.fileSizeLimitName="20MB",n.fileSizeLimitBytes=20971520),n.performChecklistFileAttachment(e,t)}},{key:"performChecklistFileAttachment",value:function(e,t){var n=e.data,i=X.createFileRequest();i.bind("REQUEST_COMPLETED",M.proxy(this,"onFileInfoCompleted",e,t)),i.bind("REQUEST_ERROR",function(e){Q.error(e),t.fault(e)},this),i.execute({operation:"INFO",file:"{UploadDirectory}/"+n.name,additionalInfo:{fileInfo:n}})}},{key:"validateFileInfo",value:function(e,t){if(e.FileSizeInBytes>this.fileSizeLimitBytes)return new C(t).deleteFile(),{fileInfo:e,fileSizeExceeded:!0,fileSizeLimitName:this.fileSizeLimitName}}},{key:"onFileInfoCompleted",value:function(e,t,n){var i=n.data.data,a=n.data.parameters,r=a.additionalInfo.fileInfo.name,o="{UploadDirectory}/"+r,s=this.validateFileInfo(i,o);if(s)return t.fault(s);var l={file:{__path:o}},c=n;t.result({data:c,fileDataToStore:l,request:e,fileInfo:i})}}]),t}(B),G.GetChecklistAttachmentFilePath=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=e.questionId,i=e.checklistId,r=AttachmentInfo.getAttachmentFieldNameInCATable();a({query:"SELECT file_path FROM SFAttachments where id IN (SELECT {{attachmentId}} FROM {{tableName}} WHERE {{checklist}} = '{{checklistId}}' AND {{question}} = '{{questionId}}')",queryParams:{tableName:M.OrgNamespace+"__SM_Checklist_Attachment__c",checklist:M.OrgNamespace+"__SM_Checklist__c",attachmentId:r,question:M.OrgNamespace+"__SM_Internal_Question_ID__c",questionId:n,checklistId:i}}).then(function(e){var n="";e.length>0&&(n=e[0].file_path),t.result({file_path:n})})}}]),t}(B),G.GetDataForQueryObject=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=this;this.__responder=t;var i=e.query_object,a=void 0;if(i){var r=i.object;if(!Z.isTableInDatabase(r))return void this.inValidSnippet(i,"Table doesnt exist");H.getFieldSet(r).then(M.proxy(this,function(e){a=e;var t=n.__getQuery(i,a);if(t){var r=X.createSQLRequest();r.bind("REQUEST_ERROR",M.proxy(n,"__getDataError",i)),r.bind("REQUEST_COMPLETED",M.proxy(n,"__getDataSuccess",i)),r.execute({query:t})}else n.inValidSnippet(i,"Failed to form the query")}))}else this.inValidSnippet(i,"query object doesnt exists")}},{key:"__getDataSuccess",value:function(e,t){var n=t.data.data,i={status:"success",results:n,error:"",error_message:""};this.__responder&&this.__responder.result&&this.__responder.result.call(this,e,i)}},{key:"__getDataError",value:function(e,t){var n=t.data.data,i={status:"error",results:[],error:"Validation_Error",error_message:n};this.__responder&&this.__responder.result&&this.__responder.result.call(this,e,i)}},{key:"__getQuery",value:function(e,t){var n=e.object,i=this,a={exprRecords:[],advancedExpression:e.AdvancedExpression},r=[],o=[],s=e.fields;if(!s&&!s.length)return void this.inValidSnippet(e,"No fields to query");for(var l=0;l<s.length;l++){var c=s[l];if(!t.fields[c])return void this.inValidSnippet(e,"Invalid Field");"reference"===t.getFieldType(c)?r.push(t.getField(c)):o.push("MAIN."+c)}var u=[],d=e.filter;if(!d||!d.length)return void this.inValidSnippet(e,"No Filter queries");for(var _=0;_<d.length;_++){var h=function(n){if(!t.fields[n])return void i.inValidSnippet(e,"Invalid filter");var a=t.getFieldType(n);return"reference"===a&&r.push(t.getField(n)),a},f=d[_],p=f.left_operand,m=f.operator;if(!f.sequence)return void this.inValidSnippet(e,"Filter sequence doesnt exists");if(!f.right_operand_type)return void this.inValidSnippet(e,"Invalid OperandType");var v=f.right_operand_type.toLowerCase();if(!p||"field"!==v&&"value"!==v||!m)return void this.inValidSnippet(e,"Invalid filter");var g=h(p);if(!g)return;if(!f.right_operand||!f.right_operand.length)return void this.inValidSnippet(e,"Invalid right operand");if("field"===v)if("in"!=m&&"between"!=m){var y=f.right_operand[0];h(y)}else{var S=f.right_operand.length;if(S)for(var E=0;E<S;E++){var b=f.right_operand[E];h(b)}}var T={source_object_name:n,field_type:g,operator:"",source_field_name:p,value:"",advance_expression:e.AdvancedExpression,sequence:f.sequence,operatorType:v};switch(m){case"=":T.operator="EQ",T.value=f.right_operand[0];break;case"!=":T.operator="NE",T.value=f.right_operand[0];break;case"<":T.operator="LT",T.value=f.right_operand[0];break;case">":T.operator="GT",T.value=f.right_operand[0];break;case"<=":T.operator="LE",T.value=f.right_operand[0];break;case">=":T.operator="GE",T.value=f.right_operand[0];break;case"in":T.operator="EQ",T.value=f.right_operand.join("','");break;case"between":T.operator="GE",T.value=f.right_operand[0];var M={source_object_name:n,field_type:g,operator:"LE",source_field_name:p,value:f.right_operand[1],advance_expression:e.AdvancedExpression,sequence:f.sequence,operatorType:v};u.push(M);break;default:return void this.inValidSnippet(e,"Invalid operator")}u.push(T)}return a.exprRecords=u,this.buildQuery(n,a,r,o,e.Order)}},{key:"inValidSnippet",value:function(e,t){var n={status:"error",error:"Validation_Error",error_message:t};this.__responder&&this.__responder.result&&this.__responder.result.call(this,e,n)}},{key:"buildQuery",value:function(e,t,n,i,a){for(var r=[],o={},s={},l="",c=$._getSortString(a,e),u=0;u<n.length;u++){var d=n[u],_=(d.name,d.referenceTo[d.referenceTo.length-1]);if(O.isTableInDatabase(_)){var h=d.relationshipName?d.relationshipName+"Table":"table"+u,f=M.string.substitute("LEFT JOIN `{{referenceTo}}` AS {{alias}} ON MAIN.{{fieldName}} = `{{alias}}`.Id",{referenceTo:_,fieldName:d.name,alias:h});s[d.name]={tableName:h,refTo:_},r.push(f);var p=O.getNameField(_);i.push(M.string.substitute("IFNULL(`{{tableName}}`.{{nameField}}, '') AS {{relationshipName}}",{referenceTo:_,nameField:p,tableName:h,relationshipName:d.relationshipName||"field"+u})),o[d.name]=d.relationshipName||"field"+u}}$.buildExpressionOnOperatorType(t,o,s),t&&t.advancedExpression&&(l="("+t.advancedExpression+")");var m=M.string.substitute("SELECT {{fieldList}}\n FROM `{{tableName}}` AS MAIN\n {{joins}}\n WHERE {{whereClause}}",{fieldList:i,tableName:e,joins:r.join("\n"),whereClause:l});return c&&c.length&&(m+=c),m}}]),t}(B),G.getClientType=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n="FSA_"+M.getClientTypeForUnifiedApp();t&&t.result&&t.result.call(this,n)}}]),t}(B),G.getUserLanguage=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=M.getCurrentApplication().getUserInfo().Language||"en_US";t&&t.result&&t.result.call(this,n)}}]),t}(B),G.getEventInfoForCustomSnippet=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=M.getCurrentApplication(),i=n&&n.getCurrentView(),a=i&&i.getDeliveryEngine(),r=a&&a.customSnippetSource,s=N.readFromJSCache("customSnippet","currentRecord");if(!s){var l=a&&a.getTargetData(),c=l&&l.getData(),u=c&&c.getRawData(),d=u&&u.sfmData;s=d?M.cloneObject(d):""}var _={source:r,currentRec:s},h=(0,o.default)(_);t&&t.result&&t.result.call(this,h)}}]),t}(B),G.getSfmRecordForCustomSnippet=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=M.getCurrentApplication(),i=n&&n.getCurrentView(),a=i&&i.getDeliveryEngine(),r=a&&a.getTargetData(),s=r&&r.getData(),l=s&&s.getRawData(),c=l&&l.sfmData;if(c){var u=M.cloneObject(c),d=u.details,_=[];for(var h in d){var f=d[h].lines;_=_.concat(f)}delete u.details;var p={header:u,details:_};t&&t.result&&t.result.call(this,(0,o.default)(p))}else t&&t.result&&t.result.call(this,"")}}]),t}(B),G.GetPicklistValuesForCustomSnippet=function(e){function t(){return(0,m.default)(this,t),(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this))}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i=e&&e.recordId,a=e&&e.fieldApiName;if(!i)return n.__sendCustomSnippetResults(t,null,se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_001,"RecordId"));if(!a)return n.__sendCustomSnippetResults(t,null,se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_001,"Field API Name"));var r=i.substring(0,3);n.__describeObjectByKeyPrefix(r).done(function(e,i){if(i&&i.fields&&i.fields.length>0){var r=i.fields.filter(function(e){return e.name===a}),o=[];if(r&&r.length>0){for(var s=r.length,l=0;l<s;l++)if(r[l].picklistValues&&r[l].picklistValues.length>0)for(var c=r[l].picklistValues,u=0;u<c.length;u++)o[u]={label:c[u].label,value:c[u].value};n.__sendCustomSnippetResults(t,o)}else n.__sendCustomSnippetResults(t,[],se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_002,a))}else n.__sendCustomSnippetResults(t,[],se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_002,a))}).fail(function(){n.__sendCustomSnippetResults(t,[],se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_001,a))})}},{key:"__describeObjectByKeyPrefix",value:function(e){var t=M.Deferred();return Z.getObjectNameFromKeyPrefix({key_prefix:e}).done(function(n){if(!n)return void t.reject(e);Z.describeObject({objectName:n}).done(function(n){n=n||{},t.resolve(e,n)}).fail(function(){t.reject(e)})}).fail(function(){t.reject(e)}),t}},{key:"__sendCustomSnippetResults",value:function(e,t,n){var i=this,a={};t&&t.length>0?(a.data=t,a.status="success",a.error="",e&&e.result&&e.result.call(i,(0,o.default)(a))):(a.data="",a.status="error",a.error=n,e&&e.result&&e.result.call(i,(0,o.default)(a)))}}]),t}(B),G.SetFieldValueForCustomSnippet=function(e){function t(){(0,m.default)(this,t);var e=(0,S.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return e.__allRefernceFieldsDetails={},e}return(0,b.default)(t,e),(0,g.default)(t,[{key:"performAsync",value:function(e,t){var n=this;this.updateHeaderDetailsValues(e,t).done(function(e){t&&t.result&&t.result.call(n,(0,o.default)(e))}).fail(function(e){t&&t.result&&t.result.call(n,(0,o.default)(e))})}},{key:"updateHeaderDetailsValues",value:function(e,t){var n=M.Deferred(),i=this,a=e&&e.fieldsObject;a=a||{};var r=(0,u.default)(a);if(r&&0===r.length)return void n.reject(a);var o=M.getCurrentApplication(),s=o&&o.getCurrentView(),l=s&&s.getDeliveryEngine(),c=l&&l.getTargetData();if(c){var d=c&&c.getData(),_=d&&d.getRawData(),h=_&&_.sfmData;h?i.getAllReferenceFieldsValue(a,l,h,c).done(function(){n.resolve(a)}).fail(function(){n.reject(a)}):n.reject(a)}else n.reject(a);return n}},{key:"validateAndUpdateHeaderFields",value:function(e,t,n){var i=this;if(e&&e.header){for(var a=e.header.fields||[],r=a.length,o=[],s=!0,l=0;l<r;l++){var c=a[l]||{};i.validatedSFMField(t,n,c,o)}if(o.length>0&&(s=!1),s){for(var u=0;u<r;u++){var d=a[u]||{};i.updateSFMHeaderRecord(t,n,d)}i.updateFieldResponse(e.header,"success","","")}else i.updateFieldResponse(e.header,"fail",se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_002,o.join(",")),"");delete e.header.fields}}},{key:"getAllReferenceFieldsValue",value:function(e,t,n,i){var a=M.Deferred(),r=this,o=[],s=[];if(e&&e.header)for(var l=e.header.fields||[],c=l.length,d=0;d<c;d++){var _=l[d]||{},h=r.getReferenceFieldDetails(t,n,_);h&&s.push(h)}if(e&&e.details)for(var f=(0,u.default)(e.details),p=f.length,m=0;m<p;m++)for(var v=f[m],g=e.details[v]||[],y=g.length,S=0;S<y;S++){var E=g[S],b=E.fields,T=b.length;invalidateFields=[];for(var I=0;I<T;I++){var C=b[I]||{},A=r.getReferenceFieldDetails(t,n,C,v);A&&s.push(A)}}if(s&&s.length>0)for(var D=s.length,x=[],R=0;R<D;R++){var L=s[R],k=L.referenceTo&&L.referenceTo.length>0&&L.referenceTo[0];if(k&&O.isTableInDatabase(k)){var N=O.getNameField(k),w="SELECT Id,"+N+" FROM "+k+" WHERE Id = '"+L.refernceValue+"'";L.refFieldName=N,x.push(r.executeAllReferenceFieldValues(w,L))}}return M.when(o).then(function(){r.validateAndUpdateHeaderFields(e,t,i),r.validatedAndUpdateDetailSectionFields(e.details,t,i,n),a.resolve()}),a}},{key:"getReferenceFieldDetails",value:function(e,t,n,i){var a=this,r=n.name,o=(n.value,t.getFieldDef(r));return i&&(o=a.getDetailRecordField(e,i,r)),o&&"reference"===o.dataType&&n&&n.value?(o=M.cloneObject(o),o.refernceValue=n.value,o):null}},{key:"executeAllReferenceFieldValues",value:function(e,t,n,i){var a=M.Deferred(),r=this,o=X.createSQLRequest();return o.bind("REQUEST_COMPLETED",M.proxy(this,function(e){if(e&&e.data&&e.data.data.length>0){var n=e.data.data[0];r.__allRefernceFieldsDetails[n.Id]={key:n[t.refFieldName],value:n.Id}}a.resolve()})),o.bind("REQUEST_ERROR",M.proxy(this,function(e){a.resolve()})),o.execute({query:e}),a}},{key:"validatedAndUpdateDetailSectionFields",value:function(e,t,n,i){var a=this,r=e&&(0,u.default)(e)||[],o=r.length;if(0!==o)for(var s=0;s<o;s++)for(var c=r[s],d=e[c]||[],_=d.length,h=0;h<_;h++){var f=d[h],p=parseInt(f.index);if("number"!==!(void 0===p?"undefined":(0,l.default)(p))){for(var m=f.fields,v=m.length,g=[],y=0;y<v;y++){var S=m[y]||{};a.validatedSFMField(t,n,S,g,c)}g&&g.length>0?a.updateFieldResponse(f,"fail",se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_002,g.join(",")),""):v>0&&(a.updateDetailRecord(i,t,n,f,c,p),a.updateFieldResponse(f,"success","","")),delete f.fields}else a.updateFieldResponse(f,"fail",se.GetErrorResponseString(se.ErrorCodes.CS.SVMX_CS_002,p),""),delete f.fields}}},{key:"validatedSFMField",value:function(e,t,n,i,a){var r=this,o=n.name,s=n.value,l=t&&t.getData(),c=l&&l.getRawData(),u=c&&c.sfmData,d=u.getFieldDef(o);if(a&&(d=r.getDetailRecordField(e,a,o)),!d||!o||!s)return void i.push(o);switch(d.dataType){case"string":break;case"textarea":case"textareaextended":break;case"picklist":case"multipicklist":r.validatePicklistField(d,n)?n.value={key:n.value,value:n.value}:i.push(o);break;case"reference":r.validateReferenceField(d,n)||i.push(o);break;case"date":case"datetime":r.validateDateField(s)||i.push(o);break;case"currency":case"percent":case"double":case"int":r.validateNumberField(s)||i.push(o);break;case"boolean":case"booleanmobile":r.validateBooleanField(s)||i.push(o)}}},{key:"updateSFMHeaderRecord",value:function(e,t,n){var i=this,a=n.name,r=n.value,o=t&&t.getData(),s=o&&o.getRawData(),l=s&&s.sfmData,c=l.getFieldDef(a),u=t.__allBindingsHash[a],d=u&&u.getValue();switch(c.dataType){case"picklist":i.updateSFMPagePicklistField(d,r,a,t,o,n);break;case"multipicklist":i.updateSFMPageMultiPicklistField(d,r,a,t,o,n);break;case"reference":i.updateSFMPageRefenceField(d,r,a,t,o,n);break;default:i.updateSFMPageField(d,r,a,t,o,n)}}},{key:"updateDetailRecord",value:function(e,t,n,i,a,r){var o=this,s=(0,u.default)(e.details),l=(s.length,null),c=[],d="details."+a,_=n.__allBindingsHash[d];if(_){var h=_.getValue();if(c=h.lines,linesLength=c.length,linesLength>r&&(l=c&&c[r]),!l)return;for(var f=i.fields,p=f.length,m=0;m<p;m++){var v=f[m],g=v.name,y=v.value;switch(o.getDetailRecordField(t,a,g).dataType){case"picklist":o.updateDetailRecordPicklistField(g,y,l,n,h,d,t,v);break;case"multipicklist":o.updateDetailRecordMultiPicklistField(g,y,l,n,h,d,t,v);break;case"reference":o.updateDetailRecordRefenceField(g,y,l,n,h,d,t,v);break;default:o.updateDetailRecordField(g,y,l,n,h,d,t,v)}}}}},{key:"getDetailRecordField",value:function(e,t,n){var i=null;if(e.getPageMetaData()&&e.getPageMetaData().getDataModel()&&e.getPageMetaData().getDataModel().__data&&e.getPageMetaData().getDataModel().__data.__data&&e.getPageMetaData().getDataModel().__data.__data.detailDataSet){var a=e.getPageMetaData().getDataModel().__data.__data.detailDataSet||[],r=M.array.filter(a,function(e){if(e.aliasName===t)return e.pageDataSet});if(r&&r.length>0&&r[0].pageDataSet&&r[0].pageDataSet.length>0&&r[0].pageDataSet[0].sobjectinfo){var o=r[0].pageDataSet[0].sobjectinfo;if(o&&o._fields&&o._fields.fields){i=o._fields.fields[n]}}}return i}},{key:"updateDetailRecordField",value:function(e,t,n,i,a,r,o,s){var c=this,u=n[e];if(void 0!==u){"object"===(void 0===u?"undefined":(0,l.default)(u))&&null!==u?(n[e].key=t,n[e].value=t):n[e]=t;var d=n[e+"__key"];d&&"object"===(void 0===d?"undefined":(0,l.default)(d))&&(n[e+"__key"].key=t,n[e+"__key"].value=t),i.__allBindingsHash[r].setValue(a);var _=c.getSectionModel(o,r);if(_&&_.__allColumnDataBindingsHash[e]){if(_.__allColumnDataBindingsHash[e].getContext()){var h=_.__allColumnDataBindingsHash[e];if(void 0!==h||null!==h){var f=h.getValue();void 0!==f&&("object"===(void 0===f?"undefined":(0,l.default)(f))&&null!==f?(f.key=t,f.value=t):f=t,h.setValue(f))}}}else{var p=c.getDetailPageModelForSelectedField(r,i,e);p&&"object"===(void 0===p?"undefined":(0,l.default)(p))?(p.fieldvalue.key=t,p.fieldvalue.value=t):p=t}}}},{key:"updateDetailRecordPicklistField",value:function(e,t,n,i,a,r,o,s){var c=this,u=n[e];if(void 0!==u){"object"===(void 0===u?"undefined":(0,l.default)(u))&&null!==u&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(n[e].key=t.value,n[e].value=t.value):t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(n[e]=t.value);var d=n[e+"__key"];d&&"object"===(void 0===d?"undefined":(0,l.default)(d))&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(n[e+"__key"].key=t.value,n[e+"__key"].value=t.value),i.__allBindingsHash[r].setValue(a);var _=c.getSectionModel(o,r);if(_&&_.__allColumnDataBindingsHash[e]){if(_.__allColumnDataBindingsHash[e].getContext()){var h=_.__allColumnDataBindingsHash[e];if(void 0!==h||null!==h){var f=h.getValue();void 0!==f&&("object"===(void 0===f?"undefined":(0,l.default)(f))&&null!==f&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(f.key=t.label,f.value=t.value):t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(f=t.value),h.setValue(f))}}}else{var p=c.getDetailPageModelForSelectedField(r,i,e);p&&"object"===(void 0===p?"undefined":(0,l.default)(p))&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(p.fieldvalue.key=t.value,p.fieldvalue.value=t.value)}}}},{key:"updateDetailRecordMultiPicklistField",value:function(e,t,n,i,a,r,o,s){var c=this,u=n[e];if(void 0!==u){"object"===(void 0===u?"undefined":(0,l.default)(u))&&null!==u&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(n[e].key=t.value,n[e].value=t.value):t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(n[e]=t.value);var d=n[e+"__key"];d&&"object"===(void 0===d?"undefined":(0,l.default)(d))&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(n[e+"__key"].key=t.value,n[e+"__key"].value=t.value),i.__allBindingsHash[r].setValue(a);var _=c.getSectionModel(o,r);if(_&&_.__allColumnDataBindingsHash[e]){if(_.__allColumnDataBindingsHash[e].getContext()){var h=(_.__allColumnDataBindingsHash[e],[]);if(t&&"object"===(void 0===t?"undefined":(0,l.default)(t))){var f=_.__allColumnDataBindingsHash[e].bindingContext,p=t.value&&t.value.split(";"),m=p.length;if(f)for(var v=f.getStore()&&f.getStore().getData().items||[],g=v.length,y=0;y<m;y++){var S=p[y];for(j=0;j<g;j++){var E=v[j].data.value||v[j].raw.value;if(S===E){h.push(v[j]);break}}}}h&&h.length>0&&_.__allColumnDataBindingsHash[e].setValue(h)}}else{var b=c.getDetailPageModelForSelectedField(r,i,e);b&&"object"===(void 0===b?"undefined":(0,l.default)(b))&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(b.fieldvalue.key=t.value,b.fieldvalue.value=t.value):b=t.value}}}},{key:"updateDetailRecordRefenceField",value:function(e,t,n,i,a,r,o,s){var c=this,u=n[e];if(void 0!==u){"object"===(void 0===u?"undefined":(0,l.default)(u))&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(n[e].key=t.key,n[e].value=t.value):"object"===(void 0===t?"undefined":(0,l.default)(t))&&(n[e]=t.value);var d=n[e+"__key"];d&&"object"===(void 0===d?"undefined":(0,l.default)(d))&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(n[e+"__key"].key=t.key,n[e+"__key"].value=t.value),i.__allBindingsHash[r].setValue(a);var _=c.getSectionModel(o,r);if(_&&_.__allColumnDataBindingsHash[e]){if(_.__allColumnDataBindingsHash[e].getContext()){var h=_.__allColumnDataBindingsHash[e];if(void 0!==h||null!==h){var f=h.getValue();void 0!==f&&("object"===(void 0===f?"undefined":(0,l.default)(f))&&null!==f&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(f.key=t.key,f.value=t.value):"object"===(void 0===t?"undefined":(0,l.default)(t))&&(f={key:t.key,value:t.value}),h.setValue(f))}}}else{var p=c.getDetailPageModelForSelectedField(r,i,e);p&&"object"===(0,l.default)(p.fieldvalue)&&(p.fieldvalue.key=t.key,p.fieldvalue.value=t.value)}}}},{key:"updateSFMPageField",value:function(e,t,n,i,a,r){var o=this.getHeaderPageModelForSelectedField(a,n);void 0!==e?("object"===(void 0===e?"undefined":(0,l.default)(e))&&null!==e?(e.key=t,e.value=t):e=t,i.__allBindingsHash[n].setValue(e)):void 0!==o&&(o&&"object"===(void 0===o?"undefined":(0,l.default)(o))?(o.fieldvalue.key=t,o.fieldvalue.value=t):o=t)}},{key:"updateSFMPagePicklistField",value:function(e,t,n,i,a,r){var o=this.getHeaderPageModelForSelectedField(a,n);void 0!==e?("object"===(void 0===e?"undefined":(0,l.default)(e))&&null!==e&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(e.key=t.value,e.value=t.value):t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(e=t.value),i.__allBindingsHash[n].setValue(e)):void 0!==o&&o&&"object"===(void 0===o?"undefined":(0,l.default)(o))&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))&&(o.fieldvalue.key=t.value,o.fieldvalue.value=t.value)}},{key:"updateSFMPageMultiPicklistField",value:function(e,t,n,i,a,r){var o=this.getHeaderPageModelForSelectedField(a,n);if(void 0!==e){var s=[];if("object"===(void 0===e?"undefined":(0,l.default)(e))&&null!==e&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))){var c=i.__allBindingsHash[n].__context,u=t.value&&t.value.split(";"),d=u.length;if(c)for(var _=c.getStore()&&c.getStore().getData().items||[],h=_.length,f=0;f<d;f++){var p=u[f];for(j=0;j<h;j++){var m=_[j].data.value||_[j].raw.value;if(p===m){s.push(_[j]);break}}}}s&&s.length>0&&i.__allBindingsHash[n].setValue(s)}else void 0!==o&&(o&&"object"===(void 0===o?"undefined":(0,l.default)(o))&&t&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(o.fieldvalue.key=t.value,o.fieldvalue.value=t.value):o=t.value)}},{key:"updateSFMPageRefenceField",value:function(e,t,n,i,a,r){if(e)"object"===(void 0===e?"undefined":(0,l.default)(e))&&"object"===(void 0===t?"undefined":(0,l.default)(t))?(e.key=t.key,e.value=t.value):e={key:t.key,value:t.value},i.__allBindingsHash[n].setValue(e);else if("object"===(void 0===t?"undefined":(0,l.default)(t))){var o=this.getHeaderPageModelForSelectedField(a,n);o&&o&&"object"===(0,l.default)(o.fieldvalue)&&(o.fieldvalue.key=t.key,o.fieldvalue.value=t.value)}}},{key:"getHeaderPageModelForSelectedField",value:function(e,t){var n=void 0;return e&&e.__data&&e.__data.pageDataSet&&e.__data.pageDataSet.sobjectinfo&&e.__data.pageDataSet.sobjectinfo[t]&&(n=e.__data.pageDataSet.sobjectinfo[t]),n}},{key:"getDetailPageModelForSelectedField",value:function(e,t,n){var i=e&&e.split("."),a=void 0;if(i&&i.length>0&&t.getData()&&t.getData().__data&&t.getData().__data.detailDataSet){var r=t.getData().__data.detailDataSet||[],o=M.array.filter(r,function(e){if(e.aliasName===i[1])return e.pageDataSet});o&&o.length>0&&o[0].pageDataSet.length>0&&o[0].pageDataSet[0].sobjectinfo&&(a=o[0].pageDataSet[0].sobjectinfo[n])}return a}},{key:"getSectionModel",value:function(e,t){var n=e&&e.getMetaModel(),i=n&&n.getChildNode("details");return i&&i.getDetail(t)}},{key:"updateFieldResponse",value:function(e,t,n,i,a){e.response={status:t||"",error:n||"",data:i||""}}},{key:"validateNumberField",value:function(e){var t=!1;return"string"==typeof e?(e=Number(e),isNaN(e)||(t=!0)):"number"==typeof e&&(t=!0),t}},{key:"validateDateField",value:function(e){var t=!1;return J.isValidDate(e)&&(t=!0),t}},{key:"validateBooleanField",value:function(e){var t=!1;return e&&"boolean"==typeof e?t=!0:!e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(t=!0),t}},{key:"validateReferenceField",value:function(e,t){var n=this,i=!1;return t&&t.value&&n.__allRefernceFieldsDetails[t.value]&&(i=!0,t.value={value:n.__allRefernceFieldsDetails[t.value].key,key:n.__allRefernceFieldsDetails[t.value].value}),i}},{key:"validatePicklistField",value:function(e,t){function n(e,t){return M.array.filter(e,function(e){if(e&&e.value===t)return e})}var i=!1;if("object"===(void 0===t?"undefined":(0,l.default)(t))&&e&&e.picklistValues&&e.picklistValues.length>0)if("multipicklist"===e.type)for(var a=t.value&&t.value.split(";")||[],r=a.length,o=0;o<r;o++){var s=n(e.picklistValues,a[o]);i=!(!s||!s.length)}else{var c=n(e.picklistValues,t.value);c&&c.length>0&&(i=!0)}return i}}]),t}(B),M.defineGlobal(G.name,G),e.exports=G},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(18),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=n(0).utils,y=n(60).Constants,S=n(5).SVMXObject,E=n(12).DatetimeUtil,b=E,T={name:"com.servicemax.client.sfmdelivery.operationutils"},M=y;T.Utilities=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,null,[{key:"addRecords_processData",value:function(e){if(e.cacheKey){e.request.additionalInfo.module.instance.setItemToCache(e.cacheKey,e.data),g.getLoggingService().getLogger("SFM-SAL-MODEL-AddRecords").info("Adding record template for <"+e.request.alias+"> to cache")}if(e.copyRecord)e.request.data.copyDetailRecords(e.data,e.request.alias,e.request.sourceRecord,function(){e.onSuccess(e.data),g.destroy(e)});else{var t=void 0,n=void 0,i=e.objectInfo.fields,a=i.length;for(t=0;t<a;t++)if(n=i[t],"boolean"==n.dataType){var r=function(e,t){var n=e[0].bubbleInfo,i=void 0,a=n.length,r=void 0,o=null;for(i=0;i<a;i++)if(r=n[i],r.fieldapiname==t){o=r;break}return o}(e.data,n.name);r||(e.data[0].bubbleInfo[e.data[0].bubbleInfo.length]={fieldapiname:n.name,fieldvalue:{key:"false",value:"false"}})}e.data=this.addRecord_doMultiAdd(e.request,e.data,e.optionalNewIds),e.request.data.addNewDetailRecords(e.data,e.request.alias,function(){e.onSuccess(e.data),g.destroy(e)})}}},{key:"cloneRecords_processData",value:function(e){e.request.data.cloneDetailRecordRow(e.data,e.request.alias,function(){e.onSuccess(e.data),g.destroy(e)})}},{key:"addRecord_doMultiAdd",value:function(e,t,n){var i=t;if(e.multiAddFieldRecordIds&&e.multiAddFieldRecordIds.length>0){var a=e.multiAddFieldRecordIds,r=[],o=e.multiAddFieldRecordValues,s=void 0,l=a.length,c=e.multiAddFieldApiName;for(s=0;s<l;s++)r[s]=this.addRecord_mergeFieldToRecordTemplate(g.cloneObject(t[0]),{apiName:c,key:a[s],value:o[s]}),n&&(r[s].sobjectinfo.Id=n[s]);i=r}return i}},{key:"addRecord_mergeFieldToRecordTemplate",value:function(e,t){var n=e.bubbleInfo,i=void 0,a=n.length,r=void 0,o=null;for(i=0;i<a;i++)if(r=n[i],r.fieldapiname==t.apiName){o=r;break}return o||(o={fieldapiname:t.apiName,fieldvalue:{}},n[n.length]=o),o.fieldvalue={key:t.key,value:t.value},e}},{key:"replaceLiteralsWithValue",value:function(e,t,n,i){var a=e;if(null!=a&&void 0!=a&&""!=a){var r="[SVMX.CURRENTRECORD.",o="[SVMX.CURRENTRECORDHEADER.";(a.indexOf("'"+r)>0||a.indexOf("'"+o)>0)&&(i=!1);for(var s=0;s<a.length;s++){var l,c=a.indexOf(r);if(c>-1){a=a.replace(r,"*");var u=a.indexOf("*"),d="]",_=a.indexOf(d,u);if(u>-1){l=a.substring(u,_),fieldName1=l.replace("*",""),l+=d;var h=t.getDataBinding().getRelatedBindingValue(fieldName1,"CURRENTRECORD");h=h===M.NO_VALUE||null===h?"":h,i&&(h="'"+h+"'"),a=a.replace(l,h)}}}for(var s=0;s<a.length;s++){var l,c=a.indexOf(o);if(c>-1){a=a.replace(o,"*");var u=a.indexOf("*"),d="]",_=a.indexOf(d,u);if(u>-1){l=a.substring(u,_),fieldName1=l.replace("*",""),l+=d;var h=t.getDataBinding().getRelatedBindingValue(fieldName1,"CURRENTRECORDHEADER");h=h===M.NO_VALUE||null===h?"":h,i&&(h="'"+h+"'"),a=a.replace(l,h)}}}}return a}},{key:"replaceBoolToString",value:function(e){return e.indexOf("=true")>-1&&(e=e.replace(/=true/g,"='true'")),e.indexOf("=false")>-1&&(e=e.replace(/=false/g,"='false'")),e}},{key:"extractDefWithFiltersToQuery",value:function(e,t){var n=void 0,i=void 0,a=void 0,r=void 0,o=t.advFilters.length,s=e.filtersToQuery,l=!1,c=[];if(void 0!=s)for(n=0;n<o;n++){for(l=!1,i=0;i<s.length;i++)if(t.advFilters[n].key==s[i]){l=!0;var u="SVMX.USERTRUNK",d=e.userTrunk;t.advFilters[n].filterCriteria.indexOf(u)>-1&&(t.advFilters[n].filterCriteria=t.advFilters[n].filterCriteria.replace(u,d))}l||c.push(n)}else for(n=0;n<o;n++){if(1==t.advFilters[n].defaultOn||"true"==t.advFilters[n].defaultOn){l=!0;var u="SVMX.USERTRUNK",d=e.userTrunk;t.advFilters[n].filterCriteria.indexOf(u)>-1&&(t.advFilters[n].filterCriteria=t.advFilters[n].filterCriteria.replace(u,d))}else l=!1;l||c.push(n)}for(a=0;a<c.length;a++)delete t.advFilters[c[a]];var _=[];for(r=0;r<o;r++)t.advFilters[r]&&_.push(t.advFilters[r]);return t.advFilters=_,t}},{key:"processDescribeResult",value:function(e,t){function n(e,t){var n=6*e.length,i=[],a=void 0,r=void 0,o=void 0,s=void 0,l=void 0;for(a=0;a<n;a++){var c=a%6,u=(a-c)/6;o=u<0?Math.ceil(u):Math.floor(u),r=5-a%6,s=e[o],l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(s),i.push(l>>r&1)}return 1==i[t]}function i(e,t,n){var i=a(e,n),r=0,o=void 0,s=void 0,l=void 0;if(i)for(o=i.picklistValues,l=o.length,s=0;s<l;s++)if(o[s].value==t){r=s;break}return r}function a(e,t){var n=null,i=t.fields,a=void 0,r=i.length;for(a=0;a<r;a++)if(i[a].name==e){n=i[a];break}return n}if(e.recordTypeMapping=[],t){t.recordTypeMappings instanceof Array||(t.recordTypeMappings=[t.recordTypeMappings]);var r,o,s,l=t.recordTypeMappings,c=l.length;for(r=0;r<c;r++)o=l[r],s=o.picklistsForRecordType,s||(s=[]),s instanceof Array||(s=[s]),o.picklistsForRecordType=function(e,t){var n=void 0,a=e.length,r=void 0,o=void 0,s=void 0,l=void 0;for(n=0;n<a;n++){r=e[n];var c=r.picklistName,u=r.picklistValues;for(u instanceof Array||(u=void 0===u?[]:[u]),s=u.length,l="",o=0;o<s;o++)l+=i(c,u[o].value,t)+";";l.length>0&&(l=l.substring(0,l.length-1)),r.picklistValues=[{value:l}]}return e}(s,e),e.recordTypeMapping.push(o)}var r,u,d,_,h=e.fields,c=h.length;for(r=0;r<c;r++)u=h[r],u.dependentPicklist&&(d=u.controllerName,(_=a(d,e))&&function(e,t){var i=e.picklistValues,a=void 0,r=i.length,o=void 0,s=void 0,l=t.picklistValues,c=l.length,u=void 0,d=void 0,_=void 0,h=void 0;for(a=0;a<r;a++){for(i[a].dependendPicklist||(i[a].dependendPicklist=[]),u=i[a].dependendPicklist,s=0;s<c;s++)if(o=l[s].validFor,n(o,a)){for(d=null,h=u.length,_=0;_<h;_++)if(u[_].fieldAPIName==t.name){d=u[_];break}d||(d={fieldAPIName:t.name,value:""},u.push(d)),d.value+=s+";"}for(s=0;s<u.length;s++){var f=u[s].value;f.length>0&&(g.stringEndsWith(f,";")&&(f=f.substring(0,f.length-1)),u[s].value=f)}}}(_,u))}}]),t}(S),T.SFMTargetRecord=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return a.__data=e,a.__metadata=n,a.__additionalInfo=i,a.__ignoreFields=["CreatedDate","LastActivityDate","LastModifiedDate","LastReferencedDate","LastViewedDate","SystemModstamp"],a}return(0,v.default)(t,e),(0,h.default)(t,[{key:"getParentObjectName",value:function(){return this.__metadata.page.header.headerLayout[g.OrgNamespace+"__Object_Name__c"]}},{key:"getHeaderLayoutId",value:function(){return this.__metadata.page.header.hdrLayoutId}},{key:"getProcessType",value:function(){return this.__metadata.response.sfmProcessType}},{key:"getHeaderRecords",value:function(){var e=[],t=this.__data.getRawData().sfmData,n=[];if("CHECKLIST"==this.getProcessType()&&t)if(t[g.OrgNamespace+"__Status__c"],t.hasOwnProperty("Id")&&void 0!=t.Id||!t.hasOwnProperty([g.OrgNamespace+"__ChecklistMetaJSON__c"]))if(t.hasOwnProperty("Id")&&this.__additionalInfo&&this.__additionalInfo.hasOwnProperty("lstSobjectinfo")&&"Completed"==t[g.OrgNamespace+"__Status__c"]){var i=this.__additionalInfo.lstSobjectinfo;i.length>0&&(delete t[g.OrgNamespace+"__ChecklistMetaJSON__c"],n.push(t));for(var a=1;a<i.length;a++){var r=i[a],o=g.cloneObject(t);delete o.Id,delete o[g.OrgNamespace+"__ChecklistMetaJSON__c"],delete o[g.OrgNamespace+"__ChecklistJSON__c"],delete o[g.OrgNamespace+"__SM_Sequence__c"],delete o[g.OrgNamespace+"__SM_Checklist_Group_Id__c"],o.Id=r.Id,o.Name=r.Name,o[g.OrgNamespace+"__SM_Checklist_Group_Id__c"]=r[g.OrgNamespace+"__SM_Checklist_Group_Id__c"],o[g.OrgNamespace+"__SM_Sequence__c"]=r[g.OrgNamespace+"__SM_Sequence__c"],n.push(o)}}else delete t[g.OrgNamespace+"__ChecklistMetaJSON__c"];else{var l=t[g.OrgNamespace+"__ChecklistMetaJSON__c"],c=(new Date).getTime(),u=1;if(l.length>12e4)for(var d=g.splitLongStringToChunkArray(l,12e4),_=0;_<d.length;_++){var o=g.cloneObject(t);o[g.OrgNamespace+"__ChecklistMetaJSON__c"]=d[_],_>0&&delete o[g.OrgNamespace+"__ChecklistJSON__c"],o[g.OrgNamespace+"__SM_Sequence__c"]=u,o[g.OrgNamespace+"__SM_Checklist_Group_Id__c"]=c,n.push(o),u++}else t[g.OrgNamespace+"__SM_Sequence__c"]=u,t[g.OrgNamespace+"__SM_Checklist_Group_Id__c"]=c}return 0==n.length&&n.push(t),g.array.forEach(n,function(t){var n={targetRecordAsKeyValue:[]},i=null;e.push(n),g.forEachProperty(t,function(e,a){if("attributes"!=e&&0!==e.indexOf("_")&&"function"!=typeof a&&(!a||"object"!==(void 0===a?"undefined":(0,s.default)(a))||"fieldvalue"in a)&&"sourceRecordID"!=e){var r=t[e];i=null,"object"===(void 0===r?"undefined":(0,s.default)(r))&&void 0!==r&&null!==r?i={key:e,value:r.fieldvalue.key,value1:r.fieldvalue.value}:("RecordTypeId"!=e||void 0!==r&&r)&&(i={key:e,value:r}),i&&(n.targetRecordAsKeyValue[n.targetRecordAsKeyValue.length]=i)}})}),e}},{key:"getModifiedHeaderRecords",value:function(){var e=[],t=this.__data.getRawData().sfmData,n=[],i=this.getProcessType(),a={};if(this.__getHeaderFields(this.__metadata,a),"CHECKLIST"==i&&t){t[g.OrgNamespace+"__Status__c"];if(t.hasOwnProperty("Id")&&void 0!=t.Id||!t.hasOwnProperty([g.OrgNamespace+"__ChecklistMetaJSON__c"]))if(t.hasOwnProperty("Id")&&this.__additionalInfo&&this.__additionalInfo.hasOwnProperty("lstSobjectinfo")&&"Completed"==t[g.OrgNamespace+"__Status__c"]){var r=this.__additionalInfo.lstSobjectinfo;r.length>0&&(delete t[g.OrgNamespace+"__ChecklistMetaJSON__c"],n.push(t));for(var o=1;o<r.length;o++){var l=r[o],c=g.cloneObject(t);delete c.Id,delete c[g.OrgNamespace+"__ChecklistMetaJSON__c"],delete c[g.OrgNamespace+"__ChecklistJSON__c"],delete c[g.OrgNamespace+"__SM_Sequence__c"],delete c[g.OrgNamespace+"__SM_Checklist_Group_Id__c"],c.Id=l.Id,c.Name=l.Name,n.push(c)}}else delete t[g.OrgNamespace+"__ChecklistMetaJSON__c"];else{var u=t[g.OrgNamespace+"__ChecklistMetaJSON__c"],d=(new Date).getTime(),_=1;if(u.length>12e4)for(var h=g.splitLongStringToChunkArray(u,12e4),f=0;f<h.length;f++){var p=g.cloneObject(t);p[g.OrgNamespace+"__ChecklistMetaJSON__c"]=h[f],f>0&&delete p[g.OrgNamespace+"__ChecklistJSON__c"],p[g.OrgNamespace+"__SM_Sequence__c"]=_,p[g.OrgNamespace+"__SM_Checklist_Group_Id__c"]=d,n.push(p),_++}else t[g.OrgNamespace+"__SM_Sequence__c"]=_,t[g.OrgNamespace+"__SM_Checklist_Group_Id__c"]=d}}0==n.length&&n.push(t);var m={sObjectRecord:{}},v=null;e.push(m);for(var y=0;y<n.length;y++)for(var S in n[y]){var E=t[S];if(0!==S.indexOf("_")&&"function"!=typeof E&&(!E||"object"!==(void 0===E?"undefined":(0,s.default)(E))||"attributes"===S||"fieldvalue"in E)&&("sourceRecordID"!=S&&(null===t.Id||void 0===t.Id||void 0!==this.__data.__originalData[S]))){var T=this.__data.__originalData[S],M=null===T?null:void 0,I=null!==this.__data.__originalData.mappedFields&&void 0!==this.__data.__originalData.mappedFields&&this.__data.__originalData.mappedFields.indexOf(S)>-1;v=null,"attributes"===S?v={key:S,value:E}:"object"===(void 0===E?"undefined":(0,s.default)(E))&&void 0!==E&&null!==E?(v={key:S,value:E.fieldvalue.key,value1:E.fieldvalue.value},null!==T&&void 0!==T&&(M="object"===(void 0===T?"undefined":(0,s.default)(T))?T.fieldvalue.key:T)):("RecordTypeId"!=S||void 0!==E&&E)&&(v={key:S,value:E},null!==T&&void 0!==T&&(M="object"===(void 0===T?"undefined":(0,s.default)(T))?T.fieldvalue.key:T)),v&&(M&&""!==M&&("datetime"===a[v.key]&&v.value&&-1===v.value.indexOf("T")?M=b.getFormattedDatetime(M,"YYYY-MM-DD HH:mm:00"):"date"===a[v.key]&&(M=b.getFormattedDatetime(M,"YYYY-MM-DD"))),("STANDALONE EDIT"!==i&&"SOURCE TO TARGET CHILD"!==i||"Id"===v.key||"attributes"===v.key||I||!this.__compareValues(M,v.value,v.key))&&(m.sObjectRecord[v.key]=v.value))}}return void 0!==e[0].sObjectRecord.attributes&&null!==e[0].sObjectRecord.attributes||(e[0].sObjectRecord.attributes={type:this.__data.__objectNameMap.header}),e}},{key:"__getHeaderFields",value:function(e,t){var n=void 0,i=void 0,a=void 0;for(n in e.page.header.sections)for(i in e.page.header.sections[n].fields)void 0!==(a=e.page.header.sections[n].fields[i].fieldDetail)&&null!==a&&g.OrgNamespace+"__DataType__c"in a&&g.OrgNamespace+"__Field_API_Name__c"in a&&("datetime"!=a[g.OrgNamespace+"__DataType__c"]&&"date"!=a[g.OrgNamespace+"__DataType__c"]||(t[a[g.OrgNamespace+"__Field_API_Name__c"]]=a[g.OrgNamespace+"__DataType__c"]))}},{key:"getDetailRecords",value:function(){var e=[],t=this.__data.getRawData().sfmData.details,n=null,i=null;for(i in t)e[e.length]={};for(i in t){var a,r=this.getDetailMetadata(i),o=null,l=null,c=null,u=t[i].lines,d=u.length,_=null,h=null;n={},n.aliasName=r.dtlLayoutId,n.pageLayoutId=r.dtlLayoutId,n.objName=r.DetailLayout[g.OrgNamespace+"__Object_Name__c"],n.parentColumnName=this.getDetailParentColumnName(r),n.records=[],n.deleteRecID=this.getDetailDeletedRecords(i),e[r.DetailLayout[g.OrgNamespace+"__Sequence__c"]-1]=n;for(var a=0;a<d;a++){_=u[a],h={},l=_.Id,l&&(h.targetRecordId=l),c=_.sourceRecordID,c&&(h.sourceRecordId=c),h.targetRecordAsKeyValue=[];var f=!1;for(var p in _)if(f=!1,"attributes"!=p&&"sourceRecordID"!=p&&0!==p.indexOf("_")&&-1===p.indexOf("__key",p.length-"__key".length))if("rowIndex"==p&&_[p])h[p]=_[p];else{var m=_[p];_[p+"__key"]&&(m=_[p+"__key"],f=!0),o=null,"object"===(void 0===m?"undefined":(0,s.default)(m))&&void 0!==m&&null!==m?o=f?{key:p,value:m.key,value1:m.value}:{key:p,value:m.fieldvalue.key,value1:m.fieldvalue.value}:("RecordTypeId"!=p||void 0!==m&&m)&&(o={key:p,value:m}),o&&(h.targetRecordAsKeyValue[h.targetRecordAsKeyValue.length]=o)}n.records[n.records.length]=h}}return e}},{key:"getModifiedDetailRecords",value:function(){var e=[],t=this.__data.getRawData().sfmData.details,n=null,i=null;for(i in t)e[e.length]={};var a={};this.__getDetailFields(this.__metadata,a);for(i in t){var o=this.getDetailMetadata(i),l=null,c=null,u=null,d=t[i].lines,_=d.length,h=null,f=null,p=this.__data.__originalData.details[i].lines;n={},n.aliasName=o.dtlLayoutId,n.pageLayoutId=o.dtlLayoutId,n.objName=o.DetailLayout[g.OrgNamespace+"__Object_Name__c"],n.parentColumnName=this.getDetailParentColumnName(o),n.records=[],n.deleteRecID=this.getDetailDeletedRecords(i),e[o.DetailLayout[g.OrgNamespace+"__Sequence__c"]-1]=n;for(var m=0;m<_;m++){h=d[m],f={},c=h.Id;var v=void 0;if(c){f.targetRecordId=c;for(var y=0;y<p.length;y++)if(p[y].Id===c){v=p[y];break}}u=h.sourceRecordID,u&&(f.sourceRecordId=u),f.sObjectRecord={};var S=!1;for(var E in h)if(S=!1,"undefined"!==E&&"sourceRecordID"!=E&&0!==E.indexOf("_")&&-1===E.indexOf("__key",E.length-"__key".length))if("rowIndex"!=E){if(void 0===v||void 0!==v[E]){var T=h[E],M=void 0;h[E+"__key"]&&(T=h[E+"__key"],S=!0),l=null,"object"===(void 0===T?"undefined":(0,s.default)(T))&&void 0!==T&&null!==T?"attributes"===E?l={key:E,value:h[E]}:S?(l={key:E,value:T.key,value1:T.value},v&&null!==v&&null!==v[E]&&(M="object"===(0,s.default)(v[E])?v[E].fieldvalue.key:v[E])):(l={key:E,value:T.fieldvalue.key,value1:T.fieldvalue.value},v&&null!==v&&null!==v[E]&&(M="object"===(0,s.default)(v[E])?v[E].fieldvalue.key:v[E])):("RecordTypeId"!=E||void 0!==T&&T)&&(l={key:E,value:T},v&&null!==v&&null!==v[E]&&(M="object"===(0,s.default)(v[E])?v[E].fieldvalue.key:v[E])),l&&(M&&""!==M&&("datetime"===a[l.key]&&l.value&&-1===l.value.indexOf("T")?M=b.getFormattedDatetime(M,"YYYY-MM-DD HH:mm:00"):"date"===a[l.key]&&(M=b.getFormattedDatetime(M,"YYYY-MM-DD"))),null!==h.Id&&void 0!==h.Id&&"Id"!==l.key&&"attributes"!==l.key&&this.__compareValues(M,l.value,l.key)||(f.sObjectRecord[l.key]=l.value),null!==M&&void 0!==M||""===l.value||void 0===l.value||null===l.value||"Id"!==l.key||!l.value.match("_local_")||(f.sObjectRecord[l.key]=void 0))}}else f[E]=h[E];void 0!==f.sObjectRecord.attributes&&null!==f.sObjectRecord.attributes||(f.sObjectRecord.attributes={type:n.objName}),((0,r.default)(f.sObjectRecord).length>2||void 0===f.sObjectRecord.Id||null===f.sObjectRecord.Id)&&(n.records[n.records.length]=f)}}return e}},{key:"__getDetailFields",value:function(e,t){var n=void 0,i=void 0,a=void 0;for(n in e.page.details)for(i in e.page.details[n].fields)void 0!==(a=e.page.details[n].fields[i].fieldDetail)&&null!==a&&g.OrgNamespace+"__DataType__c"in a&&g.OrgNamespace+"__Field_API_Name__c"in a&&("datetime"!=a[g.OrgNamespace+"__DataType__c"]&&"date"!=a[g.OrgNamespace+"__DataType__c"]||(t[a[g.OrgNamespace+"__Field_API_Name__c"]]=a[g.OrgNamespace+"__DataType__c"]))}},{key:"__compareValues",value:function(e,t,n){var i=!0;return this.__ignoreFields.indexOf(n)>-1||void 0===e||(null!==e&&""!==e||""!==t&&void 0!==t&&null!==t)&&(null===e&&""!==t&&void 0!==t&&null!==t?i=!1:("object"!==(void 0===e?"undefined":(0,s.default)(e))||void 0!==e.fieldvalue.value&&null!==e.fieldvalue.value&&""!==e.fieldvalue.value||""!==t&&null!==t&&void 0!==t)&&(i="object"===(void 0===e?"undefined":(0,s.default)(e))&&void 0!==e.fieldvalue.value&&null!==e.fieldvalue.value?e.fieldvalue.value===t:e===t)),i}},{key:"getDetailDeletedRecords",value:function(e){var t=[],n=this.__data.getDeletedRecords(),i=void 0,a=n.length,r=void 0;for(i=0;i<a;i++)r=n[i],r.alias==e&&t.push(r.id);return t}},{key:"getDetailMetadata",value:function(e){var t=null,n=this.__metadata.page.details,i=void 0,a=n.length;for(i=0;i<a;i++)if(n[i].dtlLayoutId==e){t=n[i];break}return t}},{key:"getDetailParentColumnName",value:function(e){var t=null,n=e.dtlLayoutId,i=this.__metadata.response.stringMap,a=void 0,r=i.length;for(a=0;a<r;a++)if("PROCESSTYPE"!=i[a].key&&i[a].key==n){t=i[a].value;break}return t}},{key:"getRequest",value:function(){var e={headerRecord:{}};e.sfmProcessId=this.__additionalInfo.sfmProcessId||this.__additionalInfo.processId,e.eventType=this.__additionalInfo.eventType,"Field Exit"!==this.__additionalInfo.eventType&&"Field Change"!==this.__additionalInfo.eventType||(e.fieldData=this.__additionalInfo.fieldData),e.headerRecord.objName=this.getParentObjectName(),e.headerRecord.pageLayoutId=this.getHeaderLayoutId();var t=this.getProcessType();if("save"!==e.eventType&&"quick save"!==e.eventType||!0!==g.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr")?(e.headerRecord.records=this.getHeaderRecords(),e.detailRecords=this.getDetailRecords()):(e.headerRecord.records=this.getModifiedHeaderRecords(),e.detailRecords=this.getModifiedDetailRecords()),"STANDALONE EDIT"==t||"STANDALONE CREATE"==t)e.headerRecord.records[0].targetRecordId=this.__data.getTargetRecordId();else if("SOURCE TO TARGET ALL"==t){var n=this.__data.getTargetRecordId();if(n)if(e.headerRecord.records[0].targetRecordId=n,"save"!==e.eventType&&"quick save"!==e.eventType||!0!==g.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr")){var i=e.headerRecord.records[0].targetRecordAsKeyValue;i[i.length]={key:"Id",value:n}}else{var a=e.headerRecord.records[0].sObjectRecord;a.Id=n}e.headerRecord.records[0].sourceRecordId=this.__data.getSourceRecordId()}else if("SOURCE TO TARGET CHILD"==t)e.headerRecord.records[0].targetRecordId=this.__data.getTargetRecordId(),e.headerRecord.records[0].sourceRecordId=this.__data.getTargetRecordId();else if("VIEW RECORD"==t);else if("CHECKLIST"==t){var r=this;"validated save"===e.eventType&&(e.eventType="save checklist"),g.array.forEach(e.headerRecord.records,function(e){e.sourceRecordId=r.__data.getSourceRecordId()})}return e}},{key:"getOptimizedSfmData",value:function(){var e=this.__data&&this.__data.__data&&this.__data.__data.sfmData;if(e)for(var t=this.getModifiedDetailRecords(),n=t.length,i=0;i<n;i++){var a=t[i],r=a&&a.aliasName,o=r&&e.details[r];a&&o&&function(){var e=g.array.map(a.records,function(e){return e.targetRecordId});e&&e.length>0?o.lines=g.array.filter(o.lines,function(t){return-1!==e.indexOf(t.Id)}):o.lines=[]}()}return e}}]),t}(S),T.SFMTargetAttachmentRecord=function(e){function t(e,n,i){(0,d.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return a.__data=e.data,a.__additionalInfo=e.additionalInfo,a.__deletedId=[],a.__metadata=n,a.__attachmentData=e.data.__attachementData,a._sourceRecordId=e.data._sourceRecordId,a}return(0,v.default)(t,e),(0,h.default)(t,[{key:"getParentObjectName",value:function(){return g.OrgNamespace+"__SM_Checklist_Attachment__c"}},{key:"getHeaderLayoutId",value:function(){return this.__metadata.page.header.hdrLayoutId}},{key:"getProcessType",value:function(){return this.__metadata.response.sfmProcessType}},{key:"getHeaderRecords",value:function(){var e=[];if(this.__attachmentData){var t=this.__attachmentData.unSyncedRecord;if(t&&t.length>0)for(var n=t.length,i=0;i<n;i++){var a=t[i];a.hasOwnProperty(g.OrgNamespace+"__SM_Internal_Question_ID__c")&&e.push(this.getChecklistAttachment(a))}}return e}},{key:"getChecklistAttachment",value:function(e){for(var t=[],n={targetRecordAsKeyValue:t,sourceRecordId:this._sourceRecordId},i=(0,r.default)(e),a=i.length,o=0;o<a;o++)t.push(this.getfieldObject(i[o],e[i[o]]));return n}},{key:"getfieldObject",value:function(e,t){return{key:e,value:t}}},{key:"getDeleteAttachmentID",value:function(){var e=[];if(this.__attachmentData){var t=this.__attachmentData.__deletedRecords;if(t)for(var n=(0,r.default)(t),i=n.length,a=0;a<i;a++){var o=t[n[a]];o&&e.push(o.Id)}}return e}},{key:"getRequest",value:function(){var e={headerRecord:{}};return e.sfmProcessId=this.__additionalInfo.sfProcessId||this.__additionalInfo.processId,e.eventType=this.__additionalInfo.eventType,e.headerRecord.objName=this.getParentObjectName(),e.headerRecord.pageLayoutId=this.getHeaderLayoutId(),e.headerRecord.records=this.getHeaderRecords(),e.detailRecords=[],e.headerRecord.deleteRecID=this.getDeleteAttachmentID(),e}}]),t}(S),g.defineGlobal(T.name,T),e.exports=T},function(e,t,n){var i=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=n(11).Facade,s=n(385),l={name:"com.servicemax.client.offline.sfm.app.utils.pricingdefinition"};l.initialize=function(){function e(e,t){-1!==e.indexOf("__c",e.length-"__c".length)&&(e=n+"__"+e);var i=t.length,a=void 0,r="";for(a=0;a<i;a++){var o=t[a];if(o.key==e){r=o;break}}return r}function t(e){return null!=e&&""!=e?e+"/":""}s.initialize();var n=r.OrgNamespace,i=r.getLoggingService().getLogger("GET-PRICE"),l={},c=[],u="",d=null,_=null,h=[],f=[],p=[],m=null,v={},g={},y={},S="",E="",b=null,T="",M={},I={},C={},A={},D={},x={},R={},O={},L={},k="",N=[],w=[],F="";if(!window.$EXPR)throw new Error("Pricing Definition requires window.$EXPR to be defined (usually means load com.servicemax.client.runtime first!)");window.$EXPR.getPricingDefinition=function(t,n){c=[],l={},c=[],u="",d=null,_=null,h=[],f=[],p=[],m=null,v={},g={},y={},S="",E="",b=null,T="",M={},I={},C={},A={},D={},x={},R={},O={},L={},k="",N=[],w=[],F="";for(var i=t.detailRecords,a=i.length,o=0;o<a;o++){var s=i[o].records,q=s.length,V=void 0;for(V=0;V<q;V++){var B=s[V].targetRecordAsKeyValue,j=e("Line_Type__c",B);if(null!=j&&null!=j.value)if("Parts"==j.value){var H=e("Product__c",B);h.push(H.value)}else if("Labor"==j.value){var z=e("Activity_Type__c",B);f.push(z.value);var U=e("Product__c",B);if(t.headerRecord&&t.headerRecord.records[0]&&t.headerRecord.records[0].targetRecordAsKeyValue)for(var Y=t.headerRecord.records[0].targetRecordAsKeyValue,W=0;W<Y.length;W++)Y[W].key===r.getCustomFieldName("Product")&&Y[W].value&&p.push(Y[W].value);U&&p.push(U.value)}}}var G=t.headerRecord.records[0].targetRecordId;d=G;var X=e("CurrencyIsoCode",t.headerRecord.records[0].targetRecordAsKeyValue);""!=X&&(_=X.value),b=n,P()};var P=function(){var e=r.string.substitute("select Id, Name from RecordType where SobjectType = '{{ns}}__Service_Order_Line__c'",{ns:n}),t=r.string.substitute("Select value From MobileDeviceSettings where setting_id = 'WORD005_SET020'",{ns:n});ce([{type:"RECORDTYPE_IDS",query:e},{type:"PRICEBOOK_SETTINGS",query:"select setting_id, value from MobileDeviceSettings where setting_id in ('WORD005_SET006','WORD005_SET018','WORD005_SET004','WORD005_SET017', 'WORD005_SET019')"},{type:"ENTITLEMENT_CHECK",query:t}],q,this)},q=function(e){var t={},a={},o=0,s=0;settingsLength=e.PRICEBOOK_SETTINGS.length;var u="";for(isPartsLaborExists=!1,partsPBInfo={},laborPBInfo={},pbQueryColl=[],o=0;o<settingsLength;o++)t[e.PRICEBOOK_SETTINGS[o].setting_id]=e.PRICEBOOK_SETTINGS[o].value;k=e.ENTITLEMENT_CHECK[0]?e.ENTITLEMENT_CHECK[0].value:"",i.info("WORD005_SET020 is set to "+k);var d=e.RECORDTYPE_IDS,_=r.toObject(d),v=_.length;for(s=0;s<v;s++)a[_[s].Name]=_[s].Id;if(m=a,!0===le(t.WORD005_SET006)&&(u="'"+t.WORD005_SET006+"', ",l["PARTS_ESTIMATES_"+t.WORD005_SET006]=a.Estimate),!0===le(t.WORD005_SET018)&&(u=u+"'"+t.WORD005_SET018+"', ",l["LABOR_ESTIMATES_"+t.WORD005_SET018]=a.Estimate),!0===le(t.WORD005_SET004)&&(u=u+"'"+t.WORD005_SET004+"', ",l["PARTS_USAGE_"+t.WORD005_SET004]=a["Usage/Consumption"]),!0===le(t.WORD005_SET017)&&(u=u+"'"+t.WORD005_SET017+"', ",l["LABOR_USAGE_"+t.WORD005_SET017]=a["Usage/Consumption"]),!0===le(t.WORD005_SET019)&&"Product price book"===t.WORD005_SET019&&(h=h.concat(p)),c.push({key:"SETTINGS",valueMap:[{key:"WORD005_SET019",value:t.WORD005_SET019},{key:"WORD005_SET020",value:k}]}),estRectype={},estRectype.key="Estimate",estRectype.value=a.Estimate,usgRectype={},usgRectype.key="Usage/Consumption",usgRectype.value=a["Usage/Consumption"],recTypeInfo=[],recTypeInfo.push(estRectype),recTypeInfo.push(usgRectype),recTypes={},recTypes.key="RECORDTYPEDEFINITION",recTypes.valueMap=recTypeInfo,c.push(recTypes),null!=u&&u.length>0&&(u=u.substring(0,u.length-2)),null!=h&&h.length>0&&null!=u&&u.length>0){isPartsLaborExists=!0;var g=r.string.substitute("Select Id, Name from Pricebook2 where name in ({{pbNames}}) and IsActive = 'true'",{pbNames:u});partsPBInfo.type="PARTS_PRICEBOOK",partsPBInfo.query=g,pbQueryColl.push(partsPBInfo)}if(null!=f&&f.length>0&&null!=u&&u.length>0){isPartsLaborExists=!0;var y=r.string.substitute("Select Id, Name from {{ns}}__Service_Pricebook__c where Name in ({{pbNames}}) and {{ns}}__Active__c = 'true'",{ns:n,pbNames:u});laborPBInfo.type="LABOR_PRICEBOOK",laborPBInfo.query=y,pbQueryColl.push(laborPBInfo)}!0===isPartsLaborExists?ce(pbQueryColl,X,this):G()},V=function(){for(var e=[],t={key:"LINEWARRANTYENTITLED",valueMap:[]},a={key:"LINESCONTRACTENTITLED",valueMap:[]},o=0;o<__psLines.length;o++){var s=__psLines[o].Id;e[o]=s;var l="false",u="false";D[s]&&(l="true",i.info(s+" has Warranty")),C[s]&&(u="true",i.info(s+" is entitled by ServiceContract")),t.valueMap.push({key:s,value:l}),a.valueMap.push({key:s,value:u})}c.push(t),c.push(a);var d=r.string.substitute("select Id, {{ns}}__Entitled_By_Service__c, {{ns}}__Entitled_Within_Threshold__c, {{ns}}__Service_Order__c, {{ns}}__Start_Date__c, {{ns}}__End_Date__c, {{ns}}__Warranty__c, {{ns}}__Service_Contract__c from {{ns}}__Entitlement_History__c where {{ns}}__Work_Detail__c = '{{psId}}' and {{ns}}__Inactive_Date__c = ''",{ns:n,psId:e});de(d,B)},B=function(e){var t=[],o=e[0];if(!0===le(o)&&!0===le(o[n+"__Service_Contract__c"])&&o[n+"__Service_Contract__c"].length>0){i.info("Obtain Entitlement History");var s=o[n+"__Service_Contract__c"];if(!0===le(s)){var l=r.string.substitute("Select {{ns}}__Default_Travel_Price__c, {{ns}}__Default_Travel_Unit__c, {{ns}}__Zone__c, {{ns}}__Service_Pricebook__c, {{ns}}__Default_Parts_Price_Book__c, {{ns}}__Minimum_Labor__c, {{ns}}__Minimum_Travel__c, {{ns}}__Labor_Rounding_Type__c, {{ns}}__Travel_Rounding_Type__c, {{ns}}__Round_Labor_To_Nearest__c, {{ns}}__Round_Travel_To_Nearest__c, Id From {{ns}}__Service_Contract__c where Id = '{{scid}}'",{ns:n,scid:s});de(l,U)}}else if("false"===k){i.info("Entitlement history not present, obtain details directly from service contract");for(var c=(0,a.default)(R),u=0;u<c.length;u++){var d=r.string.substitute("Select {{ns}}__Default_Travel_Price__c, {{ns}}__Default_Travel_Unit__c, {{ns}}__Zone__c, {{ns}}__Service_Pricebook__c, {{ns}}__Default_Parts_Price_Book__c, {{ns}}__Minimum_Labor__c, {{ns}}__Minimum_Travel__c, {{ns}}__Labor_Rounding_Type__c, {{ns}}__Travel_Rounding_Type__c, {{ns}}__Round_Labor_To_Nearest__c, {{ns}}__Round_Travel_To_Nearest__c, Id From {{ns}}__Service_Contract__c where Id = '{{scid}}'",{ns:n,scid:c[u]});t.push({type:c[u]+"PSSCON_REC",query:d})}ce(t,H,this)}else i.warn("can not obtain PSLine entitlement details");z()},j=function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(M[e[n]]);return t},H=function(e){for(var t={key:"LINECONTRACTDEFINITION",valueMap:[]},n=(0,a.default)(R),r=0;r<n.length;r++){var o=e[n[r]+"PSSCON_REC"][0];if(o){var s={values:j(R[n[r]]),record:o};t.valueMap.push(s)}else i.warn(n[r]+" - record not found")}c.push(t)},z=function(){for(var e=(0,a.default)(A),t=[],n=[],i=[],r=[],o=0;o<e.length;o++){for(var s=e[o],l=R[s],u=A[s][0].PARTS_PRICING,d=A[s][1].PARTS_DISCOUNT,_=A[s][2].LABOR_PRICING,h=A[s][3].EXPENSE_PRICING,f=0;f<u.length;f++)t.push({values:j(l),record:u[f]});for(var p=0;p<d.length;p++)n.push({values:j(l),record:d[p]});for(var m=0;m<_.length;m++)i.push({values:j(l),record:_[m]});for(var v=0;v<h.length;v++)r.push({values:j(l),record:h[v]})}var g={valueMap:t,key:"LINEPARTSPRICING"},y={valueMap:n,key:"LINEPARTSDISCOUNTPRICING"},S={valueMap:i,key:"LINELABORPRICING"},E={valueMap:r,key:"LINEEXPENSEPRICING"};c.push(g,y,S,E),Y()},U=function(e){var t={key:"LINECONTRACTDEFINITION",valueMap:[]},n=e[0];if(n){var a={values:j([R[n.Id]]),record:n};t.valueMap.push(a)}else i.warn("PSLine contact defination not found");c.push(t)},Y=function(){var e=[],t="",i="";if(null!=h&&h.length>0){var o=0;for(o=0;o<h.length;o++)t+=t.length>0?", ":"",t=t+"'"+h[o]+"'"}if(null!=f&&f.length>0){var s=0;for(s=0;s<f.length;s++)i+=i.length>0?", ":"",i=i+"'"+f[s]+"'"}for(var l=(0,a.default)(O),c=0;c<l.length;c++){var u=l[c],d=O[u],_=L[u],p=r.string.substitute("SELECT Id,Name,UnitPrice,UseStandardPrice,Product2Id,Pricebook2Id FROM PricebookEntry WHERE Pricebook2Id = '{{partsPBs}}' AND Product2Id In ({{prds}}) AND IsActive = 'true'",{partsPBs:d,prds:t}),m=r.string.substitute("SELECT Id, Name, {{ns}}__Unit__c, {{ns}}__Unit__c, {{ns}}__Regular_Rate__c, {{ns}}__Price_Book__c, {{ns}}__Activity_Type__c, {{ns}}__Activity__c, {{ns}}__Activity_Product__c, {{ns}}__Product__c, {{ns}}__Product_Family__c, {{ns}}__Product_Line__c FROM {{ns}}__Service_Pricebook_Entry__c WHERE {{ns}}__Price_Book__c = '{{laborPBs}}' AND {{ns}}__Activity_Type__c In ({{lbr}})",{laborPBs:_,lbr:i,ns:n});null!=F&&F.length>0&&(p+=" AND CurrencyIsoCode = '"+F+"'",m+=" AND CurrencyIsoCode = '"+F+"'"),e.push({type:u+"_PARTSPB",query:p}),e.push({type:u+"_LABORPB",query:m})}ce(e,W,this)},W=function(e){for(var t=(0,a.default)(O),n=[],i=[],r=0;r<t.length;r++){for(var o=t[r],s=R[o],l=e[o+"_PARTSPB"],u=0;u<l.length;u++)n.push({values:j(s),record:l[u]});for(var d=e[o+"_LABORPB"],_=0;_<d.length;_++)i.push({values:j(s),record:d[_]})}var h={valueMap:n,key:"LINEPARTPRICEBOOK"},f={valueMap:i,key:"LINELABORPRICEBOOK"};c.push(h,f)},G=function(){entitlementHistoryQuery=r.string.substitute("select Id, {{ns}}__Entitled_By_Service__c, {{ns}}__Entitled_Within_Threshold__c, {{ns}}__Service_Order__c, {{ns}}__Start_Date__c, {{ns}}__End_Date__c, {{ns}}__Warranty__c, {{ns}}__Service_Contract__c from {{ns}}__Entitlement_History__c where {{ns}}__Service_Order__c = '{{woId}}' and {{ns}}__Inactive_Date__c = ''",{ns:n,woId:d}),de(entitlementHistoryQuery,Q)},X=function(e){var t=e,n=[],i=[],a={},r={};if(void 0!==t.PARTS_PRICEBOOK&&t.PARTS_PRICEBOOK.length>0){var o=t.PARTS_PRICEBOOK,s=void 0;for(s=0;s<o.length;s++){N[s]=o[s].Id,E=E+(E.length>0?", ":"")+"'"+o[s].Id+"'";for(var u in l)if(u==="PARTS_ESTIMATES_"+o[s].Name){var d={};d.key=l[u],d.value=o[s].Id,n.push(d)}else if(u==="PARTS_USAGE_"+o[s].Name){var _={};_.key=l[u],_.value=o[s].Id,n.push(_)}}}if(void 0!==t.LABOR_PRICEBOOK&&t.LABOR_PRICEBOOK.length>0){var h=t.LABOR_PRICEBOOK,f=void 0;for(f=0;f<h.length;f++){w[f]=h[f].Id,S="'"+h[f].Id+"'";for(var p in l)if(p==="LABOR_ESTIMATES_"+h[f].Name){var m={};m.key=l[p],m.value=h[f].Id,i.push(m)}else if(p==="LABOR_USAGE_"+h[f].Name){var v={};v.key=l[p],v.value=h[f].Id,i.push(v)}}}a.key="RECORDTYPEINFO_PARTS",r.key="RECORDTYPEINFO_LABOR",a.valueMap=n,r.valueMap=i,c.push(a),c.push(r),G()},Q=function(e){var t=[],i=e[0],a=void 0,o=void 0,s=void 0;if(!0===le(i)&&!0===le(i[n+"__Entitled_By_Service__c"])&&(u=i[n+"__Entitled_By_Service__c"],"true"==i[n+"__Entitled_Within_Threshold__c"]&&(s="COVERED",T=s)),!0===le(i)&&!0===le(i[n+"__Warranty__c"])&&i[n+"__Warranty__c"].length>0?("WARRANTY",a=i[n+"__Warranty__c"]):!0===le(i)&&!0===le(i[n+"__Service_Contract__c"])&&i[n+"__Service_Contract__c"].length>0&&("SERVICECONTRACT",o=i[n+"__Service_Contract__c"]),!0===le(a)){var l=r.string.substitute("Select Id, {{ns}}__Travel_Covered__c, {{ns}}__Time_Covered__c,{{ns}}__Material_Covered__c, {{ns}}__Expenses_Covered__c from {{ns}}__Warranty__c where Id = '{{warrantyid}}'",{ns:n,warrantyid:a});t.push({query:l,type:"WARRANTYDEFINITION"})}else if(!0===le(o)){var c=r.string.substitute("Select {{ns}}__Default_Travel_Price__c, {{ns}}__Default_Travel_Unit__c, {{ns}}__Zone__c, {{ns}}__Service_Pricebook__c, {{ns}}__Default_Parts_Price_Book__c, {{ns}}__Minimum_Labor__c, {{ns}}__Minimum_Travel__c, {{ns}}__Labor_Rounding_Type__c, {{ns}}__Travel_Rounding_Type__c, {{ns}}__Round_Labor_To_Nearest__c, {{ns}}__Round_Travel_To_Nearest__c, Id From {{ns}}__Service_Contract__c where Id = '{{scid}}'",{ns:n,scid:o});t.push({query:c,type:"CONTRACT_DEFINITION"})}t.length>0?ce(t,J,this):(t.push($()),t.push(K()),ce(t,Z,this))},J=function(e){var t=[],i=_,a=null;if(!0===le(e.WARRANTYDEFINITION)?c.push({key:"WARRANTYDEFINITION",data:e.WARRANTYDEFINITION}):!0===le(e.CONTRACT_DEFINITION)&&(c.push({key:"CONTRACT_DEFINITION",data:e.CONTRACT_DEFINITION}),a=e.CONTRACT_DEFINITION),null!=a&&1==a.length){var o=a[0],s=o.Id,l=o[n+"__Default_Parts_Price_Book__c"],d=o[n+"__Service_Pricebook__c"];if(!0===le(l)&&l.length>0){var h=r.string.substitute("Select Id, Name from Pricebook2 where (Id in ('{{pbNames}}') or name in ('{{pbNames}}')) and IsActive = 'true'",{pbNames:l});t.push({type:"RECORDTYPEINFO_PARTS_CONTRACT",query:h})}if(!0===le(d)&&d.length>0){var f=r.string.substitute("Select Id, Name from {{ns}}__Service_Pricebook__c where (Id in ('{{pbNames}}') or name in ('{{pbNames}}')) and {{ns}}__Active__c = 'true'",{ns:n,pbNames:d});t.push({type:"RECORDTYPEINFO_LABOR_CONTRACT",query:f})}var p=r.string.substitute("Select {{ns}}__Named_Expression__c,{{ns}}__Rate_Type__c, {{ns}}__Rate__c From {{ns}}__Pricing_Rule__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),m=r.string.substitute("Select {{ns}}__Product__c, {{ns}}__Price_Per_Unit__c From {{ns}}__Parts_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}' and {{ns}}__Active__c = 'true'",{ns:n,SCId:s}),v=r.string.substitute("Select {{ns}}__Discount_Percentage__c, {{ns}}__Product__c, {{ns}}__Product_Family__c, {{ns}}__Product_Line__c From {{ns}}__Parts_Discount__c where {{ns}}__Active__c = 'true' and {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),g=r.string.substitute("Select {{ns}}__Activity_Type__c, {{ns}}__Product__c,{{ns}}__Product_Family__c,{{ns}}__Product_Line__c,{{ns}}__Unit__c, {{ns}}__Regular_Rate__c, {{ns}}__Activity__c,{{ns}}__Activity_Product__c, {{ns}}__Minimum_Labor__c From {{ns}}__Labor_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),y=r.string.substitute("Select {{ns}}__Rate__c, {{ns}}__Rate_Type__c, {{ns}}__Expense_Type__c From {{ns}}__Expense_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),S=r.string.substitute("Select {{ns}}__Named_Expression__c,{{ns}}__Unit__c, {{ns}}__Service__c, {{ns}}__Rate__c From {{ns}}__Travel_Policy__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),E=r.string.substitute("Select {{ns}}__Unit__c, {{ns}}__Rate__c, {{ns}}__Minimum__c, {{ns}}__Maximum__c From {{ns}}__Mileage_Tiers__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),b=r.string.substitute("Select {{ns}}__Zone__c, {{ns}}__Rate__c, OwnerId From {{ns}}__Zone_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:s}),T=r.string.substitute("Select {{ns}}__Travel_Discount_Not_Covered__c, {{ns}}__Travel_Discount_Covered__c, {{ns}}__Parts_Discount_Not_Covered__c, {{ns}}__Parts_Discount_Covered__c, {{ns}}__Labor_Discount_Not_Covered__c, {{ns}}__Labor_Discount_Covered__c, {{ns}}__Expense_Discount_Not_Covered__c, {{ns}}__Expense_Discount_Covered__c From {{ns}}__Service_Contract_Services__c where Id = '{{SVCOff}}'",{ns:n,SVCOff:u}),M=r.string.substitute("Select Id, {{ns}}__Parts_Discount_Not_Covered__c, {{ns}}__Parts_Discount_Covered__c, {{ns}}__Product_Type__c From {{ns}}__Custom_Coverage__c where {{ns}}__Included_Service__c = '{{SVCOff}}'",{ns:n,SVCOff:u});null!=i&&i.length>0&&(p+=" AND CurrencyIsoCode = '"+_+"'",m+=" AND CurrencyIsoCode = '"+_+"'",v+=" AND CurrencyIsoCode = '"+_+"'",g+=" AND CurrencyIsoCode = '"+_+"'",y+=" AND CurrencyIsoCode = '"+_+"'",S+=" AND CurrencyIsoCode = '"+_+"'",E+=" AND CurrencyIsoCode = '"+_+"'",b+=" AND CurrencyIsoCode = '"+_+"'",T+=" AND CurrencyIsoCode = '"+_+"'"),t.push({type:"CONTRACT_PRICINGRULES",query:p}),t.push({type:"CONTRACT_SPECIALPARTSPRICING",query:m}),t.push({type:"CONTRACT_PARTSDISCOUNT",query:v}),t.push({type:"CONTRACT_SPECIALLABORPRICING",query:g}),t.push({type:"CONTRACT_EXPENSE",query:y}),t.push({type:"CONTRACT_TRAVELPOLICY",query:S}),t.push({type:"CONTRACT_MILEAGETIERS",query:E}),t.push({type:"CONTRACT_ZONEPRICING",query:b}),t.push({type:"CONTRACT_SERVICEOFFERING",query:T}),t.push({type:"CONTRACT_CUSTOMCOVERAGE",query:M})}t.push($()),t.push(K()),ce(t,Z,this)},K=function(){var e=m["Products Serviced"];return{type:"PS_LINES",query:r.string.substitute("Select Id, {{ns}}__Product_Warranty__c, {{ns}}__Service_Maintenance_Contract__c from {{ns}}__Service_Order_Line__c where RecordTypeId = '{{recId}}' AND {{ns}}__Service_Order__c = '{{woId}}' ",{ns:n,recId:e,woId:d})}},$=function(){var e="",t=void 0,i=void 0;for(t=0;t<h.length;t++)e+=e.length>0?", ":"",e+="'"+h[t]+"'";for(i=0;i<p.length;i++)e+=e.length>0?", ":"",e+="'"+p[i]+"'";return{type:"PRODUCT_DEFINITION",query:r.string.substitute("Select Id, {{ns}}__Product_Line__c, {{ns}}__Product_Type__c, Family From Product2 where Id IN ({{parts}})",{ns:n,parts:e})}},Z=function(e){function t(e){var t=new RegExp("'","gi");return e=e.replace(t,"''")}var a=e.CONTRACT_PRICINGRULES;!0===le(a)&&a.length>0&&c.push({key:"CONTRACT_PRICINGRULES",data:a});var o=e.CONTRACT_SPECIALPARTSPRICING;!0===le(o)&&o.length>0&&c.push({key:"CONTRACT_SPECIALPARTSPRICING",data:o});var s=e.CONTRACT_PARTSDISCOUNT;!0===le(s)&&s.length>0&&c.push({key:"CONTRACT_PARTSDISCOUNT",data:s});var l=e.CONTRACT_SPECIALLABORPRICING;!0===le(l)&&l.length>0&&c.push({key:"CONTRACT_SPECIALLABORPRICING",data:l});var u=e.CONTRACT_EXPENSE;!0===le(u)&&u.length>0&&c.push({key:"CONTRACT_EXPENSE",data:u});var p=e.CONTRACT_TRAVELPOLICY;!0===le(p)&&p.length>0&&c.push({key:"CONTRACT_TRAVELPOLICY",data:p});var v=e.CONTRACT_MILEAGETIERS;!0===le(v)&&v.length>0&&c.push({key:"CONTRACT_MILEAGETIERS",data:v});var g=e.CONTRACT_ZONEPRICING;!0===le(g)&&g.length>0&&c.push({key:"CONTRACT_ZONEPRICING",data:g});var y=e.CONTRACT_SERVICEOFFERING;!0===le(y)&&y.length>0&&c.push({key:"CONTRACT_SERVICEOFFERING",data:y,value:T});var b=e.CONTRACT_CUSTOMCOVERAGE;!0===le(b)&&b.length>0&&c.push({key:"CONTRACT_CUSTOMCOVERAGE",data:b,value:T});var M={};contractLaborRTPB={},M.key="RECORDTYPEINFO_PARTS_CONTRACT",contractLaborRTPB.key="RECORDTYPEINFO_LABOR_CONTRACT";var I=e.RECORDTYPEINFO_PARTS_CONTRACT;if(le(I)&&I.length>0){var C=[];C.push({key:m.Estimate,value:I[0].Id}),C.push({key:m["Usage/Consumption"],value:I[0].Id}),M.valueMap=C,E=E+(E.length>0?", ":"")+"'"+I[0].Id+"'",c.push(M)}var A=e.RECORDTYPEINFO_LABOR_CONTRACT;if(le(A)&&A.length>0){var D=[];D.push({key:m.Estimate,value:A[0].Id}),D.push({key:m["Usage/Consumption"],value:A[0].Id}),contractLaborRTPB.valueMap=D,S=S+(S.length>0?", ":"")+"'"+A[0].Id+"'",c.push(contractLaborRTPB)}var x=[],R="";if(!0===le(p)&&p.length>0){var O=0;for(O=0;O<p.length;O++)void 0!==p[O][n+"__Named_Expression__c"]&&(R+=R.length>0?" Or ":"",R=R+"{{Id}} Like '"+p[O][n+"__Named_Expression__c"]+"%'")}if(!0===le(a)&&a.length>0){var L=0;for(L=0;L<a.length;L++)void 0!==a[L][n+"__Named_Expression__c"]&&(R+=R.length>0?" Or ":"",R=R+"{{Id}} Like '"+a[L][n+"__Named_Expression__c"]+"%'")}if(null!=R&&R.length>0){var k=r.string.substitute(R,{Id:"Id"}),N=r.string.substitute(R,{Id:n+"__Expression_Rule__c"});sfExprQuery=r.string.substitute("Select {{ns}}__Advance_Expression__c, Id from {{ns}}__ServiceMax_Processes__c where {{exprIds}}",{ns:n,exprIds:k}),sfExprCompQuery=r.string.substitute("Select {{ns}}__Field_Name__c, {{ns}}__Operator__c, {{ns}}__Operand__c, {{ns}}__Sequence__c, {{ns}}__Expression_Type__c, {{ns}}__Expression_Rule__c from {{ns}}__ServiceMax_Config_Data__c where {{exprIds}}",{ns:n,exprIds:N}),x.push({type:"SFEXPRESSION",query:sfExprQuery}),x.push({type:"SFEXPRESSIONCOMP",query:sfExprCompQuery})}c.push({key:"PRODUCT_DEFINITION",data:e.PRODUCT_DEFINITION});var w="",F="";if(null!=h&&h.length>0){var P=0;for(P=0;P<h.length;P++){if(h[P]){w+=w.length>0?", ":"";w=w+"'"+t(h[P])+"'"}}}if(null!=f&&f.length>0){var q=0;for(q=0;q<f.length;q++){if(f[q]){F+=F.length>0?", ":"";F=F+"'"+t(f[q])+"'"}}}var V=r.string.substitute("select * from {{ns}}__Service_Order__c where Id = '{{woId}}'",{ns:n,woId:d});x.push({type:"WORKORDER_DATA",query:V});var B=r.string.substitute("Select object_name, object_describe from SFObjectDescribe where object_name='{{object_name}}'",{object_name:n+"__Service_Order__c"});if(x.push({query:B,type:"WO_REF_FIELDS"}),h.length>0&&E.length>0){var j=r.string.substitute("SELECT Name,UnitPrice,UseStandardPrice,Product2Id,Pricebook2Id FROM PricebookEntry WHERE Pricebook2Id In ({{partsPBs}}) AND Product2Id In ({{prds}}) AND IsActive = 'true'",{partsPBs:E,prds:w});null!=_&&_.length>0&&(j+=" AND CurrencyIsoCode = '"+_+"'"),x.push({query:j,type:"PARTSPRICING"})}if(f.length>0&&S.length>0){var H=r.string.substitute("SELECT Name, {{ns}}__Unit__c, {{ns}}__Unit__c, {{ns}}__Regular_Rate__c, {{ns}}__Price_Book__c, {{ns}}__Activity_Type__c, {{ns}}__Activity__c, {{ns}}__Activity_Product__c, {{ns}}__Product__c, {{ns}}__Product_Family__c, {{ns}}__Product_Line__c FROM {{ns}}__Service_Pricebook_Entry__c WHERE {{ns}}__Price_Book__c In ({{laborPBs}}) AND {{ns}}__Activity_Type__c In ({{lbr}})",{laborPBs:S,lbr:F,ns:n});null!=_&&_.length>0&&(H+=" AND CurrencyIsoCode = '"+_+"'"),x.push({query:H,type:"LABORPRICING"})}x.push({query:"SELECT tag_id, value from MobileDeviceTags where tag_id='EVER005_TAG087'",type:"TAGS"});var z=e.PS_LINES;__psLines=z;for(var U=0;U<__psLines.length;U++)x.push({type:__psLines[U].Id,query:r.string.substitute("Select * From {{ns}}__Service_Order_Line__c where Id = '{{psid}}'",{ns:n,psid:__psLines[U].Id})});if(!0===le(z)&&z.length>0){var Y=void 0,W=z.length,G="";for(Y=0;Y<W;Y++)G.length>0&&(G+=", "),G=G+"'"+z[Y].Id+"'";var X=r.string.substitute("Select Id, {{ns}}__Work_Detail__c from {{ns}}__Service_Order_Line__c where {{ns}}__Work_Detail__c In ({{psIds}}) AND {{ns}}__Service_Order__c = '{{woId}}' ",{ns:n,psIds:G,woId:d});x.push({type:"WD_PS_LINES",query:X})}else i.info(d+" doesnt contain any PSlines");ce(x,ee,this)},ee=function(t){var i=t.SFEXPRESSION,o=t.SFEXPRESSIONCOMP,s={};if(!0===le(i)&&!0===le(o)){var l=0,u=0,d={};for(l=0;l<i.length;l++)d[i[l].Id]=i[l];for(u=0;u<o.length;u++){var h=o[u][n+"__Expression_Rule__c"];if(!1===le(s[h])&&!0===le(d[h])){var f={};f.data=[],f.value=d[h][n+"__Advance_Expression__c"],f.key=d[h].Id,s[h]=f}s[h].data.push(o[u])}var p=[];for(var m in s)p.push(s[m]);c.push({key:"RULES",valueMap:p})}c.push({key:"PARTSPRICING",data:t.PARTSPRICING}),c.push({key:"LABORPRICING",data:t.LABORPRICING}),c.push({key:"WORKORDER_DATA",data:t.WORKORDER_DATA});for(var y=void 0,S=[],E=0;E<__psLines.length;E++){var b=n+"__Service_Maintenance_Contract__c",T=n+"__Product_Warranty__c";y=__psLines[E];var A=y.Id;if(t[A]&&(I[A]=t[A]),y[b].length){C[A]=y[b];var x=y[b],O=r.string.substitute("Select Id, {{ns}}__Service_Contract__c, {{ns}}__Product__c, {{ns}}__Price_Per_Unit__c From {{ns}}__Parts_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}' and {{ns}}__Active__c = 'true'",{ns:n,SCId:x}),L=r.string.substitute("Select Id, {{ns}}__Service_Contract__c, {{ns}}__Discount_Percentage__c, {{ns}}__Product__c From {{ns}}__Parts_Discount__c where {{ns}}__Active__c = 'true' and {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:x}),k=r.string.substitute("Select Id, {{ns}}__Activity_Type__c, {{ns}}__Service_Contract__c, {{ns}}__Product__c,{{ns}}__Product_Family__c,{{ns}}__Product_Line__c,{{ns}}__Unit__c, {{ns}}__Regular_Rate__c, {{ns}}__Activity__c,{{ns}}__Activity_Product__c, {{ns}}__Minimum_Labor__c From {{ns}}__Labor_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:x}),N=r.string.substitute("Select Id, {{ns}}__Service_Contract__c, {{ns}}__Rate__c, {{ns}}__Rate_Type__c, {{ns}}__Expense_Type__c From {{ns}}__Expense_Pricing__c where {{ns}}__Service_Contract__c = '{{SCId}}'",{ns:n,SCId:x}),w=r.string.substitute("Select {{ns}}__Default_Parts_Price_Book__c, {{ns}}__Service_Pricebook__c From {{ns}}__Service_Contract__c where Id = '{{SCId}}'",{ns:n,SCId:x}),P=e("CurrencyIsoCode",I[A]);""!=P?F=P.value:""!=_&&(F=_),null!=F&&F.length>0&&(O+=" AND CurrencyIsoCode = '"+F+"'",L+=" AND CurrencyIsoCode = '"+F+"'",k+=" AND CurrencyIsoCode = '"+F+"'",N+=" AND CurrencyIsoCode = '"+F+"'"),S.push({type:x+"_PARTS_PRICING",query:O}),S.push({type:x+"_PARTS_DISCOUNT",query:L}),S.push({type:x+"_LABOR_PRICING",query:k}),S.push({type:x+"_EXPENSE_PRICING",query:N}),S.push({type:x+"_PRICEBOOK",query:w})}else if(y[T].length){D[A]=y[T];var q=r.string.substitute("Select Id, {{ns}}__Travel_Covered__c, {{ns}}__Time_Covered__c, {{ns}}__Material_Covered__c, {{ns}}__Expenses_Covered__c from {{ns}}__Warranty__c where Id = '{{wrtyIds}}'",{ns:n,wrtyIds:y[T]});S.push({type:y[T]+"_WRTY_LINES",query:q})}}for(var V=(0,a.default)(C),B=0;B<V.length;B++){var j=V[B],H=C[j];R[H]?R[H].push(j):R[H]=[j]}ce(S,te,this);var z=ne(t.WO_REF_FIELDS),U=t.WORKORDER_DATA[0],Y=0,W=z.length,G={},X="";for(Y=0;Y<W;Y++){var Q=z[Y].reference_to,J=z[Y].api_name,K=U[J];!0===le(K)&&K.length>0&&(!1===le(G[Q])&&(G[Q]="",X+=X.length>0?", ":"",X+="'"+Q+"'"),G[Q]=G[Q]+(G[Q].length>0?", ":""),G[Q]=G[Q]+"'"+K+"'",!1===le(v[K])&&(v[K]=[]),v[K].push(J))}g=G;for(var $=[],Z=t.WD_PS_LINES||[],ee=n+"__Work_Detail__c",ae=0;ae<Z.length;ae++){var re=Z[ae],oe=re[ee];M[oe]?M[oe].push(re.Id):M[oe]=[re.Id]}if(!0===le(Z)&&Z.length>0){var ue={},de=void 0,_e=Z.length;for(de=0;de<_e;de++){var he=Z[de][n+"__Work_Detail__c"];void 0!=ue[he]&&null!=ue[he]||(ue[he]=[]),ue[he].push(Z[de].Id)}var fe=void 0,pe=__psLines.length;__mapWorkDetailsWarranty={};var me="";for(fe=0;fe<pe;fe++){var ve=__psLines[fe][n+"__Product_Warranty__c"],ge=__psLines[fe].Id;void 0!==ve&&null!==ve&&void 0!==ue[ge]&&null!==ue[ge]&&(me.length>0&&(me+=", "),me=me+"'"+ve+"'",__mapWorkDetailsWarranty[ve]=ue[ge])}var ye=r.string.substitute("Select Id, {{ns}}__Travel_Covered__c, {{ns}}__Time_Covered__c, {{ns}}__Material_Covered__c, {{ns}}__Expenses_Covered__c from {{ns}}__Warranty__c where Id IN ({{wrtyIds}})",{ns:n,wrtyIds:me});$.push({type:"WRTY_LINES",query:ye})}if(X.length>0){var Se=r.string.substitute("SELECT object_name, object_describe FROM SFObjectDescribe where object_name in ({{obNS}})",{obNS:X});$.push({type:"NAME_FLDS",query:Se}),ce($,ie,this)}else se()},te=function(e){for(var t=(0,a.default)(C),i=0;i<t.length;i++){var r=C[t[i]],o=e[r+"_PARTS_PRICING"],s=e[r+"_PARTS_DISCOUNT"],l=e[r+"_LABOR_PRICING"],c=e[r+"_EXPENSE_PRICING"];A[r]=function(e,t,n,i){return[{PARTS_PRICING:e},{PARTS_DISCOUNT:t},{LABOR_PRICING:n},{EXPENSE_PRICING:i}]}(o,s,l,c);var u=e[r+"_PRICEBOOK"][0];O[r]=u[n+"__Default_Parts_Price_Book__c"],L[r]=u[n+"__Service_Pricebook__c"]}for(var d=(0,a.default)(D),_=0;_<d.length;_++){var h=D[d[_]],f=e[h+"_WRTY_LINES"];x[h]=f}V()},ne=function(e){var t=r.toObject(e[0].object_describe),n=t.fields,i=n.length,a=0,o=[];for(a=0;a<i;a++){var s=n[a];if(!0===le(s.type)&&"reference"===s.type){var l={},c=s.referenceTo[0];"OwnerId"===s.name&&(c="User"),l.reference_to=c,l.api_name=s.name,o.push(l)}}return o},ie=function(e){var t=e.NAME_FLDS;nfData=ae(t);var n=0,i=nfData.length,a=[];for(n=0;n<i;n++){var o=nfData[n],s=o.object_api_name,l=g[s];if(null!=o.api_name&&!0===le(l)){var u=r.string.substitute("Select Id, {{fieldName}} from {{objName}} where Id in ({{recIds}})",{fieldName:o.api_name,objName:s,recIds:l});a.push({type:s,query:u})}y[s]=o.api_name}var d=e.WRTY_LINES;if(1==le(d)&&d.length>0){warrantyDetails=[];var _=void 0,h=d.length;for(_=0;_<h;_++){var f=d[_].Id;if(le(!0===__mapWorkDetailsWarranty[f])){var p={};p.values=__mapWorkDetailsWarranty[f],p.record=d[_],warrantyDetails.push(p)}}c.push({key:"IBWARRANTY",valueMap:warrantyDetails})}ce(a,oe,this)},ae=function(e){var t=e,n=void 0,i=t.length,a=[];for(n=0;n<i;n++){var o=r.toObject(t[n].object_describe);a.push(re(o.fields,t[n].object_name))}return a},re=function(e,t){var n=void 0,i=e.length,a={};for(n=0;n<i;n++){var r=e[n].nameField;if(void 0!=r&&!0===r){a.object_api_name=t,a.api_name=e[n].name;break}}return a},oe=function(e){var t=[];for(var n in e){var i=e[n],a=0,r=i.length,o=y[n];for(a=0;a<r;a++){var s=i[a],l=s.Id,c=v[l];if(!0===le(c)){var u=0,d=c.length,_={};for(u=0;u<d;u++)_.key=c[u],_.value=s[o],t.push(_)}}}se(t)},se=function(e){c.push({key:"LOOKUP_DEFINITION",valueMap:e});var t=r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA"),n=t.getTagArray(),i=void 0,a=n.length,o=[];for(i=0;i<a;i++)"EVER005_TAG087"===n[i].Key&&o.push({key:n[i].Key,value:n[i].Value});c.push({key:"TAGS",valueMap:o}),b(c)},le=function(e){var t=!1;return void 0!==e&&null!==e&&(t=!0),t},ce=function(e,t,n){var i=void 0,a=e.length,r={},o=a;for(i=0;i<a;i++)ue(e[i].query,e[i].type,function(e,i){r[e]=i,0==--o&&t.call(n,r)},n)},ue=function(e,t,n,i){de(e,function(e){n.call(i,t,e)})},de=function(e,t){var n=o,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){t(r.toObject(e.data.data))},this),i.bind("REQUEST_ERROR",function(e){r.getLoggingService().getLogger(e.data),t(!1)},this),i.execute({query:e,async:!0})};$EXPR.getOrgNamespace=function(){var e=t(n);return""!=e&&(e=e.substring(0,e.length-1)),e}},l.doCleanup=function(){s.doCleanup()},r.defineGlobal(l.name,l),e.exports=l},function(e,t,n){var i=n(0).utils,a=n(81).jsee.api,r={name:"com.servicemax.client.sfmconsole.expressionbridge"};r.initialize=function(){void 0!=window.$EXPR&&null!=window.$EXPR||(window.$EXPR={}),$EXPR.SVMXEvalExpression=function(e,t,n,i){setTimeout(function(){var a={callbackHandler:n,callBackContext:i,handler:function(e){this.callbackHandler.call(this.callBackContext,e)}};try{$EXPR.executeExpression(e,t,a.handler,a,!0)}catch(e){$EXPR.Logger.error("Error while performing EVAL! Please check for syntax error in the JS snippet! =>"+e),a.handler(t)}},0)},$EXPR.showMessage=function(e){i.getCurrentApplication().getApplicationMessageUIHandler().showMessage(e)},a.initialize()},r.doCleanup=function(){delete window.$EXPR},i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(4),d=i(u),_=n(0).utils,h=n(5).SVMXObject,f={name:"com.servicemax.client.runtime.constants"};f.Constants=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),t}(h),f.Constants.PREF_KEY_THEME="CURRENT-THEME",_.defineGlobal(f.name,f),e.exports=f},function(module,exports,__webpack_require__){var SVMX=__webpack_require__(0).utils,SVMXObject=__webpack_require__(5).SVMXObject,logger=SVMX.getLoggingService().getLogger("SVMX-JSDataAccessLayer"),JSDAEApi={name:"com.servicemax.client.runtime.jsee.JSDataAccessInterfaceApi"};JSDAEApi.initialize=function(){void 0!=window.$CUSTEXPR&&null!=window.$CUSTEXPR||(window.$CUSTEXPR={});var JSDataAccessInterface=function JSDataAccessInterface(){this.dataAccessInterfaceForSnippet=function(expr,context,callback,callbackContext,async){var result=null,bReturned=!1;return function(expr,context,callback,callbackContext,async){function $response(e){callback&&callback.call(callbackContext,e)}var $db={},$env={},$sfm_records={},$event={};$db.get=function(e,t){if(!e)return void(t&&t.call(this,query,{}));logger.info(">> dataAccessInterfaceForSnnippet <<");var n=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.GET_DATA_FOR_QUERY_OBJECT",this,{request:{query_object:e},responder:{result:function(e,n){logger.info("successfully obtained data. Return to the snippet"),t&&t.call(this,e,n)}}});SVMX.getCurrentApplication().triggerEvent(n)},$env.get=function(e){var t=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.GET_CLIENT_TYPE",this,{request:{},responder:{result:function(t){logger.info("successfully obtained clientType. Return to the snippet"),e&&e.call(this,t)}}});SVMX.getCurrentApplication().triggerEvent(t)},$env.userLanguage=function(e){var t=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.GET_USER_LANGUAGE",this,{request:{},responder:{result:function(t){logger.info("successfully obtained userLanguage. Return to the snippet"),e&&e.call(this,t)}}});SVMX.getCurrentApplication().triggerEvent(t)},$sfm_records.get=function(e){var t=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_RECORD",this,{request:{},responder:{result:function(t){logger.info("successfully obtained SFM record. Return to the snippet"),e&&e.call(this,t)}}});SVMX.getCurrentApplication().triggerEvent(t)},$sfm_records.getPicklistValues=function(e,t,n){var i=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_PICKLIST_VALUES",this,{request:{recordId:e,fieldApiName:t},responder:{result:function(e){logger.info("successfully obtained SFM record. Return to the snippet"),n&&n.call(this,e)}}});SVMX.getCurrentApplication().triggerEvent(i)},$sfm_records.setFieldValue=function(e,t){var n=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.SET_SFM_FIELD_VALUE",this,{request:{fieldsObject:e},responder:{result:function(e){logger.info("Executed setting field value. Return to the snippet"),t&&t.call(this,e)}}});SVMX.getCurrentApplication().triggerEvent(n)},$event.get=function(e){var t=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CUSTOMSNIPPET.GET_CUSTOM_EVT_INFO",this,{request:{},responder:{result:function(t){logger.info("successfully obtained cutom event data. Return to the snippet"),e&&e.call(this,t)}}});SVMX.getCurrentApplication().triggerEvent(t)},context=window.$CUSTEXPR.toObject(context),result=eval(expr)}(expr,context,callback,callbackContext,async),async||callback.call(callbackContext,result),result}};window.$CUSTEXPR.executeCustomExpression=function(e,t,n,i,a){return(new JSDataAccessInterface).dataAccessInterfaceForSnippet(e,t,n,i,a)},window.$CUSTEXPR.toObject=function(e){return SVMX.toObject(e)},window.$CUSTEXPR.Logger=SVMX.getLoggingService().getLogger("JSDAE")},SVMX.defineGlobal(JSDAEApi.name,JSDAEApi),module.exports=JSDAEApi},function(e,t,n){var i=n(0).utils,a=n(387),r={name:"com.servicemax.client.sfmconsole.customExpressionbridge"};r.initialize=function(){void 0!=window.$CUSTEXPR&&null!=window.$CUSTEXPR||(window.$CUSTEXPR={}),$CUSTEXPR.SVMXEvalCustomExpression=function(e,t,n,i){setTimeout(function(){var a={callbackHandler:n,callBackContext:i,handler:function(e){this.callbackHandler.call(this.callBackContext,e)}};try{$CUSTEXPR.executeCustomExpression(e,t,a.handler,a,!0)}catch(e){$CUSTEXPR.Logger.error("Please check for syntax error in the JS snippet! =>"+e),a.handler(t)}},0)},$CUSTEXPR.showMessage=function(e){i.getCurrentApplication().getApplicationMessageUIHandler().showMessage(e)},a.initialize()},r.doCleanup=function(){delete window.$CUSTEXPR},i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(7).MetaData,v=n(7).Data,g=n(7).Cache,y=n(7).SystemData,S=n(12).DatetimeUtil,E=n(5).SVMXObject,b=n(11).Facade,T=(n(7).Expressions,{name:"com.servicemax.client.offline.sal.model.sfmsearch.utils.impl"}),M=m,I=v,C=g,A=y,D=S,x=p.getLoggingService().getLogger("svmxc-search-service"),R=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};T.Utils=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getSearchDefinitionFor",value:function(e,t,n){this.getSearchDefinition({},function(i){var a=(e.ProcessId,e.ObjectId),r=void 0,o=i.lstSearchInfo||[],s=void 0,l=o.length,c=void 0,u=void 0,d=void 0,_=void 0,h=void 0;for(s=0;s<l;s++)for(c=o[s],u=c.searchDetails||[],_=u.length,d=0;d<_;d++)if(h=u[d],h.objectDetails.Id==a){r=p.cloneObject(h);break}t.call(n,r)},n)}},{key:"__getAllSearchProcesses",value:function(e){var t=p.string.substitute("select * from {{ns}}__ServiceMax_Processes__c where {{ns}}__Rule_Type__c ='{{type}}' ORDER BY {{ns}}__Name__c",{ns:p.OrgNamespace,type:"SRCH_NAMED_SEARCH"});this.__executeQuery(t,function(t){e(t)})}},{key:"__getAllSearchObjects",value:function(e,t){var n,e=e||[],i=e.length,a=[];for(n=0;n<i;n++)a.push(e[n].Id);var r=p.string.substitute("select * from {{ns}}__ServiceMax_Processes__c where {{ns}}__Module__c in ('{{processes}}')",{ns:p.OrgNamespace,processes:a.join("' , '")});this.__executeQuery(r,function(e){t(e)})}},{key:"__getAllSearchFields",value:function(e,t){var n,e=e||[],i=e.length,a=[];for(n=0;n<i;n++)a.push(e[n].Id);var r=p.string.substitute("select * from {{ns}}__ServiceMax_Config_Data__c where {{ns}}__Expression_Rule__c in ('{{oids}}')",{ns:p.OrgNamespace,oids:a.join("' , '")});this.__executeQuery(r,function(e){t(e)})}},{key:"getSearchDefinition",value:function(e,t,n){var i=this;C.registerJSCache("SearchDefinition",1),i.__getSearchDefinitionFromCache({},function(a){a?(p.getLoggingService().getLogger("sfmsearch").info("Search information found in cache"),t.call(n,p.cloneObject(a))):i.createSearchDefinition(e,t,n)})}},{key:"__getSearchDefinitionFromCache",value:function(e,t){var n=C.readFromJSCache("SearchDefinition","F1-SFMSEARCH-INFO");t&&t.call(this,n)}},{key:"__createSearchDefinitionInCache",value:function(e,t){C.writeToJSCache("SearchDefinition","F1-SFMSEARCH-INFO",e),t&&t.call(this)}},{key:"createSearchDefinition",value:function(e,t,n){var i=this;i.__getAllSearchProcesses(function(e){i.__getAllSearchObjects(e,function(a){i.__getAllSearchFields(a,function(r){i.__getAllSFDCObjectsDescribe(r,function(o){var s=i.__createDefinitionResponse({allProcesses:e,allObjects:a,allFields:r,allDescribes:o});i.__createSearchDefinitionInCache(s,function(){t.call(n,p.cloneObject(s))})})})})})}},{key:"__getAllSFDCObjectsDescribe",value:function(e,t){function n(e){--o,e&&(i.push(e),l.info("Describing complete => "+e.name+", stack => "+o)),0===o&&t(i)}var i=[],a=void 0,r=void 0,o=0,s=this,l=p.getLoggingService().getLogger("sfmsearch"),c=void 0,u={};if(!1!==e&&e.length>0)for(r=e.length,a=0;a<r;a++)c=e[a][p.OrgNamespace+"__Object_Name2__c"],c&&0!=c.length||(c=e[a][p.OrgNamespace+"__Object_Name__c"]),c&&!u[c]&&(o++,u[c]=c,function(e){l.info("Describing => "+e),s.describeObject(e,function(e){n(e)},{})}(c));else t(i)}},{key:"describeObject",value:function(e,t,n){M.describeObject({objectName:e,onSuccess:p.proxy(this,"__describeObjectSuccess",t,n),onError:p.proxy(this,"__describeObjectError",t,n)})}},{key:"__describeObjectError",value:function(e,t,n){e.call(t,null)}},{key:"__describeObjectSuccess",value:function(e,t,n){var i=n.fields,a=void 0,r=i.length;for(n.fieldMap={},a=0;a<r;a++)n.fieldMap[i[a].name]=i[a],!0===i[a].nameField&&(n.objectNameField=i[a].name);e.call(t,n)}},{key:"executeQuery",value:function(e,t,n){this.__executeQuery(e,function(e){t.call(n,e)})}},{key:"__executeQuery",value:function(e,t){var n=b,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){t(p.toObject(e.data.data))},this),i.bind("REQUEST_ERROR",function(e){t(!1)},this),i.execute({query:e,async:!0})}},{key:"__createDefinitionResponse",value:function(e){function t(e,t,i){var a=[],r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,d=void 0,_=void 0;if(!1!==u)for(o=u.length,r=0;r<o;r++)if(s=u[r],s[p.OrgNamespace+"__Expression_Rule__c"]==t.Id){if(c=s[p.OrgNamespace+"__Field_Name__c"],d=s[p.OrgNamespace+"__Lookup_Field_API_Name__c"],!(l=d?null:i.fieldMap[c]))try{if(_=n(s[p.OrgNamespace+"__Object_Name2__c"]),!(l=_?_.fieldMap[c]:null)&&!s[p.OrgNamespace+"__Operator__c"]){p.getLoggingService().getLogger("sfmsearch").error("Minor Error in Search: '"+t[p.OrgNamespace+"__Name__c"]+"' Uses the field '"+c+"' which is not available to this user.");continue}if(!l)return p.getLoggingService().getLogger("sfmsearch").error("Major Error in Search: '"+t[p.OrgNamespace+"__Name__c"]+"' Uses the field '"+c+"' which is not available to this user; search skipped."),[];l.label=l.label}catch(e){}l&&(s.fldDescribe=l,e.fieldsLable.push({key:l.name,value:l.label,value1:s.Id}),a.push(s))}return a}function n(e){var t=void 0,n=void 0,i=null;if(!1!==c)for(n=c.length,t=0;t<n;t++)if(c[t].name==e){i=c[t];break}return i}var i={lstSearchInfo:[],stringMap:[]},a=void 0,r=void 0,o=e.allProcesses,s=e.allObjects,l=null,c=e.allDescribes,u=e.allFields;if(!1!==o)for(r=o.length,a=0;a<r;a++){l=o[a];var d=function(e){var i={searchDef:e,searchDetails:[]},a=void 0,r=void 0,o=null;if(!1!==s)for(r=s.length,a=0;a<r;a++){var l=s[a];if(l[p.OrgNamespace+"__Module__c"]==e.Id){var c=n(l[p.OrgNamespace+"__Target_Object_Name__c"]);c&&(o={objectDetails:l,fields:null,fieldsLable:[]},o.objectLable=l[p.OrgNamespace+"__Name__c"],l.objectApiName=c.name,l.objectNameField=c.objectNameField,o.fields=t(o,l,c),o.fields.length&&i.searchDetails.push(o))}}return i}(l);d.searchDetails.length?i.lstSearchInfo.push(d):p.getLoggingService().getLogger("sfmsearch").error("Major Error in Search: '"+l[p.OrgNamespace+"__Name__c"]+"' had no valid search tabs and will be left out of UI")}return i}},{key:"getTotalCountForSearch",value:function(e){var t=f.Deferred(),n=this,i=n.__getSearchExpressionsAndColumns(e);return i.then(function(e,i,a){var r=p.string.substitute("SELECT count(*) as count  FROM (SELECT DISTINCT {{columns}} FROM `{{objectName}}` AS MAIN \n{{joins}} \nWHERE {{search}})",{columns:e.columns,joins:e.joins,objectName:e.objectName,search:e.search});n.executeQuery(r,function(n){var r=n&&n[0]&&n[0].count?parseInt(n[0].count):0;t.resolve(r,e,i,a)})}),i.fail(function(e){t.reject(0)}),t}},{key:"getSearchResults",value:function(e){var t=f.Deferred(),n=this,i=n.getTotalCountForSearch(e);return i.then(function(a,r,o,s){var l=p.string.substitute("SELECT DISTINCT {{columns}} \nFROM `{{objectName}}` AS MAIN \n{{joins}} \nWHERE {{search}} {{orderBy}} LIMIT {{limit}}",{columns:r.columns,joins:r.joins,objectName:r.objectName,search:r.search+n.__iBSForSelectedAccount(e.accountID,"MAIN",p.OrgNamespace+"__Company__c"),limit:e.RecordLimit,orderBy:r.orderBy});n.executeQuery(l,function(r){i=n.__handleResponse(e,r,o,s,a),i.then(function(e){t.resolve(e)})})}),i.fail(function(){var e={MapStringMap:[],stringMap:[],totalCount:0};t.reject(e)}),t}},{key:"specialCharactersHandling",value:function(e,t){if(e){if("string"==typeof e){var n=new RegExp("'","gi");if(e=e.replace(n,"''"),e=e.replace("/","//"),"Exact Match"!==t){var i=new RegExp("%","g");e=e.replace(i,"/%")}}}else e="";return e}},{key:"__getSearchExpressionsAndColumns",value:function(e,t){var n=f.Deferred(),i=this,a=void 0,r=void 0,o=A.getUserInfo();e.KeyWord=i.specialCharactersHandling(e.KeyWord,e.Operator);var s=function(t){var s=t.recordTypeInfos,l={};p.array.forEach(s,function(e){l[e.name]=e.recordTypeId}),this.sortFieldsBySequenceNumbers(r.fields);var c=r.fields||[],u=void 0,d=c.length,_=void 0,h=void 0,f=void 0,m=void 0,v=void 0,g=void 0,y=void 0,S=void 0,E=void 0,b=void 0,T=void 0,M=[],I=[],C=[],A=r.objectDetails[p.OrgNamespace+"__Parent_Object_Criteria__c"],D=[],R=1,O={},L=[a];for(u=0;u<d;u++)_=c[u],g=_[p.OrgNamespace+"__Object_Name__c"],y=_[p.OrgNamespace+"__Object_Name2__c"],g&&(L.push(g),O[g]={}),y&&(L.push(y),O[y]={});var k=p.string.substitute("SELECT api_name, object_api_name from SFObjectField WHERE object_api_name IN ('{{object_names}}')",{object_names:L.join("','")});i.executeQuery(k,p.proxy(this,function(t){p.array.forEach(t,function(e){O[e.object_api_name][e.api_name]=e});var i=r.objectDetails.objectApiName,a="",s=e.KeyWord||"";"Exact Match"===e.Operator?a="=":(a="like","Contains"===e.Operator?s="%"+s+"%":"Starts With"===e.Operator?s+="%":s="%"+s),I.push("LEFT JOIN `ClientSyncConflict` ON ClientSyncConflict.Id = MAIN.Id");var L=["MAIN.Id","ClientSyncConflict.error_type as isRecordInConflict"];for(u=0;u<d;u++){_=c[u],h=_[p.OrgNamespace+"__Search_Object_Field_Type__c"],f=_[p.OrgNamespace+"__Field_Name__c"],m=_[p.OrgNamespace+"__Lookup_Field_API_Name__c"].replace(/__r$/,"__c"),g=_[p.OrgNamespace+"__Object_Name__c"],y=_[p.OrgNamespace+"__Object_Name2__c"],S=_[p.OrgNamespace+"__Display_Type__c"],E=_[p.OrgNamespace+"__Operator__c"],b=_[p.OrgNamespace+"__Operand__c"],T=parseInt(_[p.OrgNamespace+"__Sequence__c"]),v=null;try{E?(this.__addExpressionToSearchQuery(_,u,I,M,L,D,T||R,o,l,O),R++):("REFERENCE"===S||m?"REFERENCE"!==S||m?"REFERENCE"!==S&&m?this.__addReferenceFieldWithCustomDisplayToSearchQuery(a,s,_,u,I,M,L,O):"REFERENCE"===S&&m&&this.__addReferenceToReferenceToSearchQuery(a,s,_,u,I,M,L,O):this.__addReferenceFieldToSearchQuery(a,s,_,u,I,M,L,O):this.__addPlainFieldToSearchQuery(a,s,_,u,I,M,L,O),"OrderBy"==h&&("DATETIME"===S.toUpperCase()?C.push("datetime(fld"+u+") "+("Ascending"===_[p.OrgNamespace+"__Sort_Order__c"]?"ASC":"DESC")):"DATE"===S.toUpperCase()?C.push("date(fld"+u+") "+("Ascending"===_[p.OrgNamespace+"__Sort_Order__c"]?"ASC":"DESC")):C.push("fld"+u+" "+("Ascending"===_[p.OrgNamespace+"__Sort_Order__c"]?"ASC":"DESC"))))}catch(e){x.error("Major Error: "+e),n.reject()}}L=L.join(",\n"),M=M.join(" OR \n")||"1\n",I=I.join("\n"),C=C.length?"\nORDER BY "+C.join(","):"",D.length&&(M=A?"("+M+") AND ("+A.replace(/\d+/g,function(e){return D[e]})+")":"("+M+") AND ("+p.array.filter(D,function(e){return e}).join(" AND ")+")");var k={columns:L,joins:I,objectName:i,search:M,orderBy:C};n.resolve(k,r,l)}))},l=function(e){r=e,a=r.objectDetails.objectApiName,M.describeObject({sync:!0,objectName:a,onSuccess:p.proxy(this,s)})};return this.getSearchDefinitionFor(e,p.proxy(this,l)),n}},{key:"getDateTimeAsFormat",value:function(e,t){var n=void 0;return"datetime"==e?n=D.macroDrivenDatetime(t,"YYYY-MM-DD","HH:mm:ss"):"date"==e&&(n=D.macroDrivenDatetime(t,"YYYY-MM-DD","","date")),n}},{key:"sortFieldsBySequenceNumbers",value:function(e){if(e){e.length>1&&e.sort(function(e,t){var n=p.getCustomFieldName("Sequence");return parseFloat(e[n])-parseFloat(t[n])})}}},{key:"__addExpressionToSearchQuery",value:function(e,t,n,i,a,r,o,s,l,c){var u=e[p.OrgNamespace+"__Field_Name__c"],d="fld"+t,_=String(e[p.OrgNamespace+"__Display_Type__c"]).toLowerCase(),h=e[p.OrgNamespace+"__Operator__c"].toLowerCase(),f=e[p.OrgNamespace+"__Operand__c"],m=(e[p.OrgNamespace+"__Object_Name__c"],e[p.OrgNamespace+"__Object_Name2__c"]),v=!1,g=void 0,y=void 0,S=!1,E=!0;if(!c[m][u])throw u+" does not exist; this search can not be performed without fixing either permission, search configurations, or other types of errors";switch("RecordTypeId"===u?(l[f]&&(f=l[f]),a.push("MAIN."+u+" as fld"+t)):"reference"==_?(S=!0,this.__addReferenceFieldToSearchQuery(null,null,e,t,n,i,a,c)):"double"==_||"int"==_||"currency"==_||"percent"==_?a.push("ifnull(nullif(MAIN."+u+", ''), 0) as fld"+t):a.push("MAIN."+u+" as fld"+t),f.toLowerCase()){case"svmx.currentuser":f=s.UserName;break;case"svmx.currentuserid":f=s.UserId;break;case"svmx.usertrunk":f=s.UserTrunk?s.UserTrunk:"";break;case"yesterday":case"svmx.yesterday":f=this.getDateTimeAsFormat(_,"Yesterday"),"datetime"==_&&(f=D.macroDrivenDatetimeLiteralsInGMT("Yesterday","YYYY-MM-DD","HH:mm:ss",!1),v=!0,"gt"===h||"le"===h?f=D.macroDrivenDatetimeLiteralsInGMT("Yesterday","YYYY-MM-DD","HH:mm:ss",!0):"eq"!==h&&"ne"!==h||(g=D.macroDrivenDatetimeLiteralsInGMT("Yesterday","YYYY-MM-DD","HH:mm:ss",!1),f=D.macroDrivenDatetimeLiteralsInGMT("Yesterday","YYYY-MM-DD","HH:mm:ss",!0),y=f));break;case"today":case"svmx.today":f=this.getDateTimeAsFormat(_,"Today"),"datetime"==_&&(f=D.macroDrivenDatetimeLiteralsInGMT("Today","YYYY-MM-DD","HH:mm:ss",!1),v=!0,"gt"===h||"le"===h?f=D.macroDrivenDatetimeLiteralsInGMT("Today","YYYY-MM-DD","HH:mm:ss",!0):"eq"!==h&&"ne"!==h||(g=D.macroDrivenDatetimeLiteralsInGMT("Today","YYYY-MM-DD","HH:mm:ss",!1),f=D.macroDrivenDatetimeLiteralsInGMT("Today","YYYY-MM-DD","HH:mm:ss",!0),y=f));break;case"tomorrow":case"svmx.tomorrow":f=this.getDateTimeAsFormat(_,"Tomorrow"),"datetime"==_&&(f=D.macroDrivenDatetimeLiteralsInGMT("Tomorrow","YYYY-MM-DD","HH:mm:ss",!1),v=!0,"gt"===h||"le"===h?f=D.macroDrivenDatetimeLiteralsInGMT("Tomorrow","YYYY-MM-DD","HH:mm:ss",!0):"eq"!==h&&"ne"!==h||(g=D.macroDrivenDatetimeLiteralsInGMT("Tomorrow","YYYY-MM-DD","HH:mm:ss",!1),f=D.macroDrivenDatetimeLiteralsInGMT("Tomorrow","YYYY-MM-DD","HH:mm:ss",!0),y=f));break;case"now":case"svmx.now":f=this.getDateTimeAsFormat(_,"Now")}p.array.get(["eq","ne","gt","ge","lt","le"],h)&&!p.array.get(["double","int","percent","currency"],_)&&(f="'"+f+"'",g="'"+g+"'",y="'"+y+"'");var b=void 0;switch(h){case"eq":S&&"''"===f?(b="( MAIN."+u+" is null OR MAIN."+u+" = '')",E=!1):b=d+" = "+f,v&&(b="("+d+" >= "+g+" AND "+d+" <= "+y+")");break;case"ne":f?S&&"''"===f?(b="( MAIN."+u+" != "+f+" OR MAIN."+u+" IS NULL )",E=!1):b="("+d+" != "+f+" OR "+d+" IS NULL)":b=d+" != "+f;break;case"lt":b=d+" < "+f;break;case"le":b=d+" <= "+f;break;case"gt":b=d+" > "+f;break;case"ge":b=d+" >= "+f;break;case"isnull":S?(b="( MAIN."+u+" is null OR MAIN."+u+" = '')",E=!1):b="double"==_||"int"==_||"currency"==_||"percent"==_?"("+d+" is null OR "+d+" = 0)":"("+d+" is null OR "+d+" = '')";break;case"isnotnull":S?(b="(MAIN."+u+" is not null AND MAIN."+u+" != '')",E=!1):b="double"==_||"int"==_||"currency"==_||"percent"==_?"("+d+" is not null AND "+d+" != 0 )":"("+d+" is not null AND "+d+" != '')";break;case"contains":b=d+"  like '%"+f+"%'";break;case"notcontain":b=f?"("+d+" not like '%"+f+"%' OR "+d+" IS NULL)":d+" not like '%"+f+"%'";break;case"starts":b=d+"  like '"+f+"%'";break;case"in":case"notin":var T=[d+" = '"+f+"'",d+" like '"+f+",%'",d+" like '%,"+f+"'",d+" like '%,"+f+",%'"];b="in"==h?"("+T.join(" OR ")+")":"NOT ("+T.join(" OR ")+")"}S&&E&&(b=this.__addSFRecordNameTableWithTheExpression(b,n,a,u,t)),r[o]=b}},{key:"__addSFRecordNameTableWithTheExpression",value:function(e,t,n,i,a){if(e){var r="fld"+a,o="tbl"+a+"_sf_rec_name_table",s=r+"_sf_rec_name_field",l=new RegExp(r,"g");e="("+e+" OR "+e.replace(l,s)+")",t.push(p.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{alias}}.Id = MAIN.{{source_field_name}}",{table_name:"SFRecordName",alias:o,source_field_name:i})),n.push(o+".Name as "+s)}return e}},{key:"__addPlainFieldToSearchQuery",value:function(e,t,n,i,a,r,o,s){var l=n[p.OrgNamespace+"__Search_Object_Field_Type__c"],c=n[p.OrgNamespace+"__Field_Name__c"];n[p.OrgNamespace+"__Object_Name__c"];if(!s[n[p.OrgNamespace+"__Object_Name2__c"]][c])return void x.error("Minor Error: Search field "+c+" does not exist");o.push("MAIN."+c+" as fld"+i),"Search"==l&&"%%"!==t&&("="!==e?r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ESCAPE '/'",{column:"MAIN."+c,clause:e,keyword:t})):r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"MAIN."+c,clause:e,keyword:t})))}},{key:"__addReferenceFieldToSearchQuery",value:function(e,t,n,i,a,r,o,s){var l=!1,c=n[p.OrgNamespace+"__Object_Name__c"],u=n[p.OrgNamespace+"__Object_Name2__c"],d=n[p.OrgNamespace+"__Field_Name__c"],_=n[p.OrgNamespace+"__Search_Object_Field_Type__c"],h=void 0;if(!s[u][d])return void x.error("Minor Error: Search field "+d+" does not exist");M.isTableInDatabase(c,p.proxy(this,function(e){l=e})),l&&(M.getNameField(n[p.OrgNamespace+"__Object_Name__c"],function(e){h=e}),h&&(a.push(p.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{alias}}.Id = MAIN.{{source_field_name}}",{table_name:c,alias:"tbl"+i,source_field_name:d})),"Search"==_&&null!==t&&"%%"!==t&&("="!==e?r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}'  ESCAPE '/'",{column:"tbl"+i+"."+h,clause:e,keyword:t})):r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"tbl"+i+"."+h,clause:e,keyword:t}))),o.push("tbl"+i+"."+h+" as fld"+i),o.push("MAIN."+d+" as fld"+i+"_ref"),this.__addSFRecordNameTableWithTheSearchQuery(e,t,n,i,a,r,"MAIN."+d)))}},{key:"__addReferenceFieldWithCustomDisplayToSearchQuery",value:function(e,t,n,i,a,r,o,s){var l=!1,c=(n[p.OrgNamespace+"__Object_Name__c"],n[p.OrgNamespace+"__Object_Name2__c"]),u=n[p.OrgNamespace+"__Field_Name__c"],d=n[p.OrgNamespace+"__Search_Object_Field_Type__c"],_=n[p.OrgNamespace+"__Lookup_Field_API_Name__c"].replace(/__r$/,"__c");if(_.match(/__c$/)||_.match(/Id$/)||(_+="Id"),!s[c][u])return void x.error("Minor Error: Search field "+u+" does not exist");M.isTableInDatabase(c,p.proxy(this,function(e){l=e})),l&&(a.push(p.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{alias}}.Id = MAIN.{{source_field_name}}",{table_name:c,alias:"tbl"+i,source_field_name:_})),"Search"==d&&"%%"!==t&&("="!==e?r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}'  ESCAPE '/'",{column:"tbl"+i+"."+u,clause:e,keyword:t})):r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"tbl"+i+"."+u,clause:e,keyword:t}))),o.push("tbl"+i+"."+u+" as fld"+i),o.push("MAIN."+_+" as fld"+i+"_ref"),this.__addSFRecordNameTableWithTheSearchQuery(e,t,n,i,a,r,"MAIN."+_))}},{key:"__addReferenceToReferenceToSearchQuery",value:function(e,t,n,i,a,r,o,s){var l=!1,c=n[p.OrgNamespace+"__Object_Name__c"],u=n[p.OrgNamespace+"__Object_Name2__c"],d=n[p.OrgNamespace+"__Field_Name__c"],_=n[p.OrgNamespace+"__Search_Object_Field_Type__c"],h=n[p.OrgNamespace+"__Lookup_Field_API_Name__c"].replace(/__r$/,"__c"),f=void 0;if(!d.match(/Id$/)||h.match(/__c$/)||h.match(/Id$/)||(h+="Id"),!s[u][d])return void x.error("Minor Error: Search field "+d+" does not exist");M.isTableInDatabase(c,p.proxy(this,function(e){l=e})),l&&(M.isTableInDatabase(u,p.proxy(this,function(e){l=e})),l&&(M.getNameField(c,function(e){f=e}),f&&(a.push(p.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{alias}}.Id = MAIN.{{source_field_name}}",{table_name:u,alias:"tbl"+i,source_field_name:h})),a.push(p.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{old_alias}}.{{source_field_name}} = {{alias}}.Id",{table_name:c,alias:"tbl"+i+"_2",old_alias:"tbl"+i,source_field_name:d})),"Search"==_&&"%%"!==t&&("="!==e?r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ESCAPE '/'",{column:"tbl"+i+"_2."+f,clause:e,keyword:t})):r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:"tbl"+i+"_2."+f,clause:e,keyword:t}))),o.push("tbl"+i+"_2."+f+" as fld"+i),o.push("tbl"+i+"."+d+" as fld"+i+"_ref"),this.__addSFRecordNameTableWithTheSearchQuery(e,t,n,i,a,r,"tbl"+i+"."+d))))}},{key:"__addSFRecordNameTableWithTheSearchQuery",value:function(e,t,n,i,a,r,o){if("Search"==n[p.OrgNamespace+"__Search_Object_Field_Type__c"]){var s="tbl"+i+"_sf_rec_name_table";a.push(p.string.substitute("LEFT JOIN `{{table_name}}` as {{alias}} ON {{alias}}.Id = {{source_field_name}}",{table_name:"SFRecordName",alias:s,source_field_name:o})),"%%"!==t&&("="!==e?r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ESCAPE '/'",{column:s+".Name",clause:e,keyword:t})):r.push(p.string.substitute("{{column}} {{clause}} '{{keyword}}' ",{column:s+".Name",clause:e,keyword:t})))}}},{key:"__iBSForSelectedAccount",value:function(e,t,n){var i="";return void 0!==e&&e.length>1&&(i=" AND (("+t+"."+n+" = '"+e+"')"+this.__fetchIBsFromLocationForThisAccount(e,t,n)+")"),i}},{key:"__fetchIBsFromLocationForThisAccount",value:function(e,t,n){return" OR ("+t+"."+p.getCustomFieldName("Site")+" IN ( SELECT Id FROM "+p.getCustomFieldName("Site")+" where "+p.getCustomFieldName("Account")+" = '"+e+"'))"}},{key:"__handleResponse",value:function(e,t,n,i,a){var r=f.Deferred(),o=[],s=void 0,l=n.fields,c=n.objectDetails[p.OrgNamespace+"__Target_Object_Name__c"],u=[];o.push({key:"SEARCH_OBJECT_ID",value:e.ObjectId}),x.info("DATA COUNT: "+t.length);var d={MapStringMap:[],stringMap:o,totalCount:a},_=t.length,h=void 0,m=A.getUserInfo();m.TimezoneOffset;for(s=0;s<_;s++){h=t[s];var v={valueMap:[]};v.valueMap.push({key:"Id",value:h.Id}),v.id=h.Id;var g=0,y=l.length;for(g;g<y;g++){var S=l[g],E=g,b=S[p.OrgNamespace+"__Field_Name__c"],T=S[p.OrgNamespace+"__Object_Name2__c"],M=S[p.OrgNamespace+"__Lookup_Field_API_Name__c"];T&&T!=c&&(b=M+"-"+b);if("Result"==S[p.OrgNamespace+"__Search_Object_Field_Type__c"]){if("REFERENCE"===S[p.OrgNamespace+"__Display_Type__c"])D={key:b,type:"REFERENCE",value:h["fld"+E],value1:h["fld"+E+"_ref"]};else var C=S[p.getCustomFieldName("Display_Type")],D={key:b,type:C,value:h["fld"+E],value1:""};!D.value&&h["fld"+E+"_ref"]&&this.__lookupRecordName(S)&&u.push(h["fld"+E+"_ref"]),v.valueMap.push(D)}}v.valueMap.push({key:"isRecordInConflict",value:"conflict"===h.isRecordInConflict||"error"===h.isRecordInConflict}),d.MapStringMap.push(v)}return I.getFromRecordNameTable(u).then(p.proxy(this,function(e){var t={};p.array.forEach(e,function(e){t[e.Id]=e.Name}),p.array.forEach(d.MapStringMap,function(e){p.array.forEach(e.valueMap,function(e){e.value1&&t[e.value1]&&(e.value=t[e.value1],delete e.value1)},this)},this),this.__refactorNameFields(d,n),r.resolve(d)})),r}},{key:"__lookupRecordName",value:function(e){var t=e[p.OrgNamespace+"__Display_Type__c"],n=e[p.OrgNamespace+"__Lookup_Field_API_Name__c"].replace(/__r$/,"__c");if("REFERENCE"!==t&&!n)return!1;if("REFERENCE"===t&&!n)return!0;if("REFERENCE"!==t&&n){var i=e[p.OrgNamespace+"__Object_Name2__c"],a=M.getNameField(i);return e[p.OrgNamespace+"__Field_Name__c"]==a}return!("REFERENCE"!==t||!n)||void 0}},{key:"__refactorNameFields",value:function(e,t){var n=t.objectDetails.objectNameField,i=void 0,a=e.MapStringMap,r=a.length,o=void 0,s=void 0;for(i=0;i<r;i++){o=a[i],s=o.valueMap;var l,c=s.length;for(l=0;l<c;l++)s[l].key==n&&(s[l].value1=o.id)}}}]),t}(E),T.PlatformSpecifics=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__logger=p.getLoggingService().getLogger("SFMSearch : PlatformSpecifics"),e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"showRecord",value:function(e){p.getClient().getApplicationParameter("enable-sfm-profiling-logs")&&(window.viewProcessStart=performance.now());var t=p.Deferred();this.__logger.info("Performing SFM action => ");var n=e.key,i=e.objectName;return i||(i=this.__getObjectName(n)),I.getRecord({Id:n,loadReferences:!0,convertPicklists:!0}).then(p.proxy(this,function(e){this.__getProcessId(e,i).done(function(a){var r=D.getCurrentDatetimeGMT(D.getSaveFormat("dateTime")),o=M.getNameField(i),s=p.create("com.servicemax.client.lib.api.Event","RECENTS.ADD_RECENTS",this,{request:{recordId:n,objectName:i,lastAccessed:r,nameField:o,type:"VIEW"},responder:{result:function(){p.getLoggingService().getLogger("sfmsearch").info("Added Record to Recents")}}});p.getCurrentApplication().triggerEvent(s);var l={SVMX_processId:a,SVMX_recordId:n,SVMX_record:e};p.getCurrentApplication().launchConsoleApp("sfmdelivery",l),t.resolve()}).fail(function(){t.reject()})})).fail(function(){t.reject()}),t}},{key:"__getProcessId",value:function(e,t,n,i){var a=p.Deferred();return M.getQualifiedProcessesForRecord({objectName:t,record:e,processType:"VIEW RECORD",considerDefaultView:!0}).then(p.proxy(this,function(e,t){if(e.length){var n=e[0].process_unique_id;a.resolve(n)}else if(i)a.resolve(null);else{var r=R().T("FSA004_TAG021","View not configured for this record. Please contact your system administrator");p.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:r,buttons:[{text:R().T("FSA016_TAG003","OK"),itemId:"OK"}]}),a.reject()}a.resolve()})),a}},{key:"__getObjectName",value:function(e,t){return M.getTableForId(e)}}]),t}(E),p.defineGlobal(T.name,T),e.exports=T},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(30),v=i(m),g=(n(10),n(0).utils),y=n(5).ExtensionRunner,S=n(56),E=n(7).Data,b=n(7).ServerInfo,T={name:"com.servicemax.client.sync.syncchecklist"},M=T,I=b;(0,v.default)(M,S),M.SyncGetChecklistData=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return e.__checklistData={},e.__deletedCheckistData={},e.__checklistTableName=g.getCustomObjectName("Checklist"),e.__checklistAttachmentTableName=g.OrgNamespace+"__SM_Checklist_Attachment__c",e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(){this._syncGetChecklistData()}},{key:"_getRequest",value:function(){return{methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_CHECKLIST_DATA",valueMap:[]}}}},{key:"_triggerCallBack",value:function(e,t){var n=this._getRequest();e&&e.callbackValues&&(n.data.values=e.callbackValues),e&&e.valueMap&&(n.data.valueMap=e.valueMap),e&&e.lastSyncTime&&n.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime}),this._initChecklistDataRequest(n,t)}},{key:"__processChecklistRecordIds",value:function(e,t){var n=e;n=g.toObject(n);for(var i in n){this.__checklistData[t]||(this.__checklistData[t]={value:t,values:[]});this.__isRecordInsertedInCurrentSync(n[i].Id)||this.__checklistData[t].values.push(n[i].Id)}}},{key:"__isRecordInsertedInCurrentSync",value:function(e){for(var t=!1,n=this._getState("MAP_REMOTE_IDS")||{},i=(0,r.default)(n),a=0;a<i.length;a++){if(n[i[a]]===e){t=!0;break}}return t}},{key:"__processChecklistRelatedRecords",value:function(e,t){this.__processDataAndStoreInObjectCache(this.__checklistData,e,t)}},{key:"__processDeletedRecords",value:function(e,t){this.__processDataAndStoreInObjectCache(this.__deletedCheckistData,e,t)}},{key:"__processDataAndStoreInObjectCache",value:function(e,t,n){var i=g.toObject(t)||[],a=i.slice(0);a.length>0&&(e[n]||(e[n]={value:n,values:[]}),e[n].values.push.apply(e[n].values,a))}},{key:"_handleChecklistData",value:function(e,t){var n=this.__checklistTableName,i=this.__checklistAttachmentTableName,a=e.values,r=[],o={Checklist_Attachment_Ids:i,Attachment_Record_Ids:"Attachment",Deleted_Checklist_Ids:n,Deleted_Checklist_Attachment_Ids:i,Deleted_Attachment_Ids:"Attachment"},s=I.getMultiServerVersionRequest();s.isSalesForceFilesEnabled()&&(o.CDL_IDS="ContentDocumentLink",o.Deleted_CDL_Ids="ContentDocumentLink");for(var l in e.valueMap){var c=e.valueMap[l],u=c.key;"PARTIAL_EXECUTED_OBJECT"===u||"PARTIAL_EXECUTED_CHECKLIST"===u||"PARTIAL_EXECUTED_CHK_ATTACHMENT"===u||"LEVEL"===u?r.push(c):u===n?this.__processChecklistRecordIds(c.value,n):"Checklist_Attachment_Ids"===u||"Attachment_Record_Ids"===u||"CDL_IDS"===u&&s.isSalesForceFilesEnabled()?this.__processChecklistRelatedRecords(c.value,o[u]):this._isDataSync()&&("Deleted_Checklist_Ids"===u||"Deleted_Checklist_Attachment_Ids"===u||"Deleted_Attachment_Ids"===u||"Deleted_CDL_Ids"===u&&s.isSalesForceFilesEnabled())&&this.__processDeletedRecords(c.value,o[u])}t.call(this,{callbackValues:a,valueMap:r})}},{key:"_performTXFetch",value:function(e){var t=this,n=[],i="insert";for(var a in this.__checklistData){var r=this.__checklistData[a];r&&r.values&&r.values.length>0&&n.push(r)}if(n.length>0){e&&e.action&&(i=e.action?e.action:"insert");var o=[],s=[];this.__serviceRequestCount++,s.push(this.__getConflictRecordIds([],o)),g.when(s).then(function(){t.__serviceRequestCount--,n.forEach(function(e){e.values=e.values.filter(function(e){return-1===o.indexOf(e)})}),t.__serviceRequestCount++,t._commonSyncObjectRecords(n,i,function(e){t.__serviceRequestCount--})})}}},{key:"__getConflictRecordIds",value:function(e,t){function n(e){if(e&&e.length)for(var n=0,i=e.length;n<i;n++)t.indexOf(e[n].Id)<0&&t.push(e[n].Id)}var i="SELECT Id FROM ClientSyncLog",a=[];return e.indexOf("BeforeUpdate")>=0&&(i+=" WHERE operation != 'update'"),a.push(this._initSQLServiceRequest({query:i}).then(n)),a.push(this._initSQLServiceRequest({query:"SELECT Id FROM ClientSyncConflict"}).then(n)),g.when(a)}},{key:"_initChecklistDataRequest",value:function(e,t){this._initHTTPServiceRequest(e,{handler:function(e){var n=void 0,i=void 0;this._handleChecklistData(e,function(e){n=e.callbackValues,i=e.valueMap});var a=this._serviceDataToObject(e);if(!a[this.__checklistTableName]||a.PARTIAL_EXECUTED_OBJECT||a.PARTIAL_EXECUTED_CHECKLIST||a.PARTIAL_EXECUTED_CHK_ATTACHMENT||(this._performTXFetch(t),this.__handleDeletedRecords()),a&&(a.PARTIAL_EXECUTED_OBJECT||a.PARTIAL_EXECUTED_CHECKLIST||a.PARTIAL_EXECUTED_CHK_ATTACHMENT)){var r={valueMap:i,callbackValues:n};t&&t.lastSyncTime&&this._getLastSyncTime("UPDATE",function(e){e&&(r.lastSyncTime=e)}),this._triggerCallBack(r,t)}}})}},{key:"_syncGetChecklistData",value:function(e){var t=this.__checklistTableName;if(e||this._tempTableCreated(t)){var n=this._getRequest();e&&e.lastSyncTime&&n.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime}),this._initChecklistDataRequest(n,e)}}},{key:"__handleDeletedRecords",value:function(){for(var e=this,t=this.__deletedCheckistData,n=(0,r.default)(t),i=0;i<n.length;i++){var a=n[i],o=t[a];if(e.__doesDataContainIds(o)){var s=o.values.slice(0);"Attachment"===a?e.__handleAttachmentsDelete(s):"ContentDocumentLink"===a&&s&&s.length>0?E.deleteSfFileRelatedTables(s,null,!1):e.__deleteRecordAndClearSyncEntries(a,s)}}}},{key:"__deleteRecordAndClearSyncEntries",value:function(e,t){this._deleteRecord(e,t),this._deleteSyncRecord(t),this._deleteSyncConflict(t),this._deleteRecentItems(t)}},{key:"__doesDataContainIds",value:function(e){return!!(e&&e.values&&e.values.length>0)}},{key:"__handleAttachmentsDelete",value:function(e){var t=this;t.__getAttachmentsFilePath(e).always(g.proxy(t,function(e){t.__deleteRecordAndClearSyncEntries("SFAttachments",t.__attachmentsToDelete),t._deleteRecord("Attachment",t.__attachmentsToDelete),t.__deleteFiles(e)}))}},{key:"__getAttachmentsFilePath",value:function(e){this.__attachmentsToDelete=e.slice(0);var t=new g.Deferred;if(e&&e.length>0){var n=this.__attachmentsToDelete.join("','"),i="SELECT Id, file_path as __path FROM SFAttachments WHERE Id IN ('"+n+"')";t=this._initSQLServiceRequest({query:i})}else t.resolve([]);return t}},{key:"__deleteFiles",value:function(e){var t=[];if(e.length>0){for(var n=0;n<e.length;n++){var i=e[n].__path;t.push(E.deleteLocalFile(i))}E.deleteFiles(t)}}}]),t}(M.SyncEvent),M.SyncChecklistIncremental=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(){this.getSyncManager().isChecklistEnabled()&&this._getLastSyncTime("UPDATE",function(e){e&&this._syncGetChecklistData({lastSyncTime:e,action:"update.incremental"})})}}]),t}(M.SyncGetChecklistData),M.PopulateServicemaxProcessForChecklist=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(){function e(e){return t._tempTableCreated(e)&&(e=g.getTempTableName(e)),e}var t=this,n=[e("SFProcess"),e(g.getCustomObjectName("ServiceMax_Processes"))];new y.run(t.getSyncManager(),"com.servicemax.client.sync.extensions",{tables:n,extensionClassName:"com.servicemax.client.offline.sal.model.sync.extensions.ServicemaxProcessForChecklistExtension"}).then(function(){console.log("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.ServicemaxProcessForChecklistExtension")})}}]),t}(M.SyncEvent),g.defineGlobal(T.name,T),e.exports=T},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(180),s=i(o),l=n(177),c=i(l),u=n(16),d=i(u),_=n(2),h=i(_),f=n(3),p=i(f),m=n(6),v=i(m),g=n(4),y=i(g),S=n(30),E=i(S),b=n(10),T=n(0).utils,M=n(5).ExtensionRunner,I=n(11).Facade,C=n(56),A=n(103),D=n(392),x=n(181),R=n(7).Data,O=n(7).ServerInfo,L={name:"com.servicemax.client.sync.syncdatapurgeapi"},k=L;(0,E.default)(k,A,D,x,C),k.DataPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG145","Purging Data"],e.__tempIdTableName="TEMP__NotPurgeIds",e.__checkListTable=T.getCustomObjectName("Checklist"),e.__purgeDays=null,e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){this.__serviceRequestCount++;var e=this._initSQLServiceRequest({query:"SELECT value FROM MobileDeviceSettings WHERE setting_id = 'PURGE_REC_OLDER_THAN'"});e=e.then(T.proxy(this,function(e){var t=T.Deferred(),n=0;return e&&e.length>0&&e[0].value&&(n=e[0].value,isNaN(n)||(n=parseInt(n))),this.__purgeDays=n,this.__purgeDays>0?t.resolve():t.reject(),t})),e=e.then(T.proxy(this,this.__getPurgeTables)),e=e.then(T.proxy(this,this.__purgeTables)),O.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(e=e.then(T.proxy(this,this.__getPIQPurgeFiles)),e=e.then(T.proxy(this,this.__getDocTemplatePurgeFiles)),e=e.then(T.proxy(this,this.__purgeSFFiles))),e=e.then(T.proxy(this,this.__purgeAttachmentTables)),e=e.then(T.proxy(this,this.__purgeAttachments)),e=e.then(T.proxy(this,this.__purgeSFAttachments)),e=e.then(T.proxy(this,this.__purgeSFAttachmentsValidateClientSyncLog)),e=e.then(T.proxy(this,this.__purgeClientSyncLogValidateSFAttachments)),e=e.then(T.proxy(this,this.__purgeFiles)),e=e.then(T.proxy(this,this.__purgeTroubleshootingDocumentFiles)),e=e.then(T.proxy(this,this.__purgeChecklistRecords)),e=e.then(T.proxy(this,this._purgePiqTechnicalAttributeRecords)),e=e.then(T.proxy(this,this.__purgeIBRelatedRecords)),e=e.then(T.proxy(this,this.__purgePIQCachedRecords)),e=e.then(T.proxy(this,this.__deleteTempIdTable)),e.always(T.proxy(this,this._complete))}},{key:"__purgeTroubleshootingDocumentFiles",value:function(){var e=this,t=T.Deferred();return this._initSQLServiceRequest({query:" SELECT pd.Id,pd.Name,pd.parentId,pd.online  FROM Product_Troubleshoot_Documents pd WHERE pd.parentId  NOT IN (SELECT ID from Product2) and pd.online='false' "},{handler:function(n){for(var i=0;i<n.length;i++){var a=n[i],r="{TroubleshootDocumentDirectory}/"+a.Id+"_"+a.Name;e.__deleteFile(r);var o="DELETE from Product_Troubleshoot_Documents WHERE Id='"+a.Id+"'";this._initSQLServiceRequest({query:o},{handler:function(e){}})}t.resolve()}}),t}},{key:"__getIBIdsToDelete",value:function(e,t,n){var i=T.Deferred(),a=this.getIBTableName("SM_Installed_Product_Id"),r="SELECT DISTINCT "+e+" FROM "+t+" WHERE "+e+" NOT IN (SELECT Id FROM "+n+")";return this._initSQLServiceRequest({query:r},{handler:function(e){var t=0,n=e.length,r=[];for(t;t<n;t++){var o=e[t][a];r.push(o)}i.resolve(r)}}),i}},{key:"__getCDLIdsToIgnore",value:function(e){var t=T.Deferred(),n="SELECT Id FROM ContentDocumentLink WHERE LinkedEntityId IN (SELECT Id FROM "+e+")";return this._initSQLServiceRequest({query:n},{handler:function(e){var n=0,i=e.length,a=[];for(n;n<i;n++){var r=e[n].Id;a.push(r)}t.resolve(a)}}),t}},{key:"getIBTableName",value:function(e){return T.getCustomObjectName(e)}},{key:"__purgeIBRelatedRecords",value:function(){var e=this,t=T.Deferred(),n=e.getIBTableName("Installed_Product"),i=e.getIBTableName("SM_IB_Attributes_History"),a=e.getIBTableName("SM_Installed_Product_Id"),r=e.getIBTableName("SM_IB_Attributes_Template_Instance");this.__logger.info("deleting IB related records from SM_IB_Attributes_History Table");var o=e.__getIBIdsToDelete(a,i,n),s=e.__getIBIdsToDelete(a,r,n);return b.when(o,s).then(function(n,i){var a=n.concat(i),r=[];if(b.each(a,function(e,t){-1===b.inArray(t,r)&&r.push(t)}),r.length>0){new M.run(e.getSyncManager(),"com.servicemax.client.sync.extensions",{extensionClassName:"com.servicemax.client.offline.sal.model.sync.extensions.PurgeIBRelatedRecords",ibRecordIds:r,context:e}).then(function(){t.resolve(),e.__logger.info("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.PurgeIBRelatedRecords")})}else t.resolve()}),t}},{key:"__purgePIQCachedRecords",value:function(){for(var e=T.Deferred(),t=["Sync_PiqExisting_Ibs","Sync_Records_Heap","Sync_PiqExisting_Sites"],n=[],i=0;i<t.length;i++){var a=t[i],r="DELETE FROM "+a;n.push(r)}return this._initSQLServiceRequest({queryArray:n},{handler:function(t){this.__logger.info("Piq purged cached data"),e.resolve()}}),e}},{key:"__purgeChecklistRecords",value:function(){var e=this,t=this,n=T.Deferred();return this.getSyncManager().isChecklistEnabled()?(n=t.__getUniqueObjectPrefixForChecklist(),n.then(function(i){i.length>0?(n=t.__getTableNameUsingPrefix(i),n.then(function(i){n=t.__getChecklistIdsToDelete(i),n.then(function(i){if(i.length>0){var a=t.__checkListTable,r=[a,"ClientSyncLog","ClientSyncConflict","ClientSuccSyncLog","ClientDataOnDemand"],o=0,s=r.length,l=i.join("','"),c=[];for(o;o<s;o++){var u="DELETE FROM ["+r[o]+"] WHERE Id IN ('"+l+"')";c.push(u)}var d=t._initSQLServiceRequest({queryArray:c}),_=t.__purgeChecklistRelatedRecords(i);T.when([d,_]).then(T.proxy(e,function(){n.resolve()}))}else n.resolve()})})):n.resolve()})):n.resolve(),n}},{key:"__getUniqueObjectPrefixForChecklist",value:function(){var e=this.__checkListTable,t=T.getCustomFieldName("What_Id"),n=T.Deferred(),i="SELECT substr("+t+", 1, 3) AS obj_keyprefix FROM "+e+" GROUP BY substr("+t+", 1, 3)";return this._initSQLServiceRequest({query:i},{handler:function(e){var t=0,i=e.length,a=[];for(t;t<i;t++)a.push(e[t].obj_keyprefix);n.resolve(a)}}),n}},{key:"__getTableNameUsingPrefix",value:function(e){var t=T.Deferred();return this._initSQLServiceRequest({query:"SELECT object_name AS Name FROM SFObjectDescribe WHERE key_prefix IN ('{{prefix}}')",queryParams:{prefix:e.join("','")}},{handler:function(e){var n=0,i=e.length,a=[];for(n;n<i;n++)a.push(e[n].Name);t.resolve(a)}}),t}},{key:"__purgeChecklistRelatedRecords",value:function(e){var t=T.Deferred(),n=e.join("','"),i=T.OrgNamespace+"__SM_Checklist_Attachment__c",a=T.OrgNamespace+"__SM_Checklist__c",r="SELECT Id, file_path as __path FROM [SFAttachments] WHERE parent_id IN ('"+n+"')",o="SELECT Id FROM ["+i+"] WHERE "+a+" IN ('"+n+"')",s=this,l=["ClientSyncLog","ClientSyncConflict","ClientSuccSyncLog","ClientDataOnDemand"],c=this._initSQLServiceRequest({query:r},{handler:function(e){if(e.length>0){var t=[],n=[],i=l.slice(0);i.push("SFAttachments"),i.push("Attachment");for(var a=0;a<e.length;a++){var r=e[a];t.push(r.Id),n.push(R.deleteLocalFile(r.__path))}R.deleteFiles(n),s.__deleteRecordsFromTables(t,i)}}}),u=this._initSQLServiceRequest({query:o},{handler:function(e){if(e.length>0&&"undefined"!==e){var t=[],n=l.slice(0);n.push(i);for(var a=0;a<e.length;a++){var r=e[a];t.push(r.Id)}s.__deleteRecordsFromTables(t,n)}}});return T.when([c,u]).then(T.proxy(this,function(){t.resolve()})),t}},{key:"__deleteRecordsFromTables",value:function(e,t){if(e.length>0&&t.length>0){for(var n=e.join("','"),i=[],a=0;a<t.length;a++){var r="DELETE FROM ["+t[a]+"] WHERE Id IN ('"+n+"')";i.push(r)}this._initSQLServiceRequest({queryArray:i})}}},{key:"__getChecklistIdsToDelete",value:function(e){var t=T.Deferred(),n=0,i=e.length,a=[],r=this;if(e.length>0){for(n;n<i;n++){var o="SELECT Id FROM ["+e[n]+"]";a.push(o)}var s=a.join(" UNION ");this._initSQLServiceRequest({query:s},{handler:function(e){var n=void 0,i=r.__checkListTable,a=T.getCustomFieldName("What_Id"),o=0,s=e.length,l=[];for(o;o<s;o++)l.push(e[o].Id);n="SELECT Id FROM ["+i+"] WHERE "+a+" NOT IN ('{{ids}}')",r._initSQLServiceRequest({query:n,queryParams:{ids:l.join("','")}},{handler:function(e){var n=0,i=e.length,a=[];for(n;n<i;n++)a.push(e[n].Id);t.resolve(a)}})}})}else t.resolve([]);return t}},{key:"_purgePiqTechnicalAttributeRecords",value:function(){var e=this;new M.run(e.getSyncManager(),"com.servicemax.client.sync.extensions",{syncEvent:e,extensionClassName:"com.servicemax.client.offline.sal.model.sync.extensions.PurgePiqTechnicalAttributeRelatedRecords"}).then(function(){console.log("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.PurgePiqTechnicalAttributeRelatedRecords")})}},{key:"__createTempIdTable",value:function(){var e=T.Deferred(),t=k.SQLSchema.getCreateQuery("InstallBaseLock",this.__tempIdTableName);return t="DROP TABLE IF EXISTS '"+this.__tempIdTableName+"'; "+t,this._initSQLServiceRequest({query:t},{handler:function(t){e.resolve()}}),e}},{key:"__fillTempIdTable",value:function(e){var t=T.Deferred(),n=this.__createTempIdTable(),i=[],a=0;for(var r in e)void 0===i[a]&&(i[a]=[]),i[a].push(r),i[a].length>=100&&a++;for(a=0;a<i.length;a++)n=n.then(T.proxy(this,this.__insertIdBatch,i[a]));return n=n.then(function(){t.resolve()}),t}},{key:"__insertIdBatch",value:function(e){var t=T.Deferred();if(e){var n=e.join("'),('"),i="INSERT INTO '"+this.__tempIdTableName+"' (id) VALUES ('"+n+"')";this._initSQLServiceRequest({query:i},{handler:function(e){t.resolve()}})}else t.resolve();return t}},{key:"__purgeTables",value:function(e){var t=T.Deferred(),n=this._getState("DO_NOT_PURGE_IDS")||{},i=this.__createTempIdTable();i.resolve();for(var a=0;a<e.length;a++){var r=e[a].object_name;r in n&&(i=i.then(T.proxy(this,this.__fillTempIdTable,n[r]))),i=i.then(T.proxy(this,this.__purgeRecords,r))}return i=i.then(function(){t.resolve()}),t}},{key:"__purgeAttachmentTables",value:function(){var e=T.Deferred(),t=this._getState("DO_NOT_PURGE_IDS")||{},n=t.Attachment;n||e.resolve();var i=this.__fillTempIdTable(n);i=i.then(function(){e.resolve()})}},{key:"__getPurgeTables",value:function(){var e=["Attachment","BusinessHours","Document","Pricebook2","RecordType",T.getCustomObjectName("Code_Snippet_Manifest"),T.getCustomObjectName("Code_Snippet"),T.getCustomObjectName("ServiceMax_Config_Data"),T.getCustomObjectName("ServiceMax_Processes"),T.getCustomObjectName("Service_Pricebook_Entry"),T.getCustomObjectName("Doc_Template"),T.getCustomObjectName("Checklist"),T.getCustomObjectName("SM_Product_Attributes"),T.getCustomObjectName("SM_Attributes_Template"),T.getCustomObjectName("SM_IB_Attributes_History"),T.getCustomObjectName("SM_IB_Attributes_Template_Instance"),"Tasks","User_GPS_Log__c","User"];O.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(e=e.concat(["ContentDocument","ContentDocumentLink","ContentVersion"]));var t="SELECT object_name FROM 'SFObjectDescribe' WHERE object_name NOT IN ('"+e.join("','")+"')";return this._initSQLServiceRequest({query:t})}},{key:"__purgeRecords",value:function(e){var t=T.Deferred(),n="DELETE FROM '"+e+"' WHERE Id IN (SELECT main.Id FROM '"+e+"' AS main LEFT JOIN "+this.__tempIdTableName+" AS purge ON main.Id = purge.Id LEFT JOIN ClientSyncConflict AS conflict ON main.Id = conflict.Id LEFT JOIN ClientSyncLog AS synclog ON main.Id = synclog.Id OR main.Id = synclog.parent_id WHERE purge.Id IS NULL AND conflict.Id IS NULL AND synclog.Id IS NULL AND synclog.parent_id IS NULL AND datetime(main.LastModifiedDate) < datetime('now', '-"+this.__purgeDays+" days') AND main.Id NOT LIKE 'local_%' AND main.Id NOT LIKE 'attach_local_%')",i="DELETE FROM 'InstallBaseLock' WHERE Id IN (SELECT main.Id FROM 'InstallBaseLock' AS main LEFT JOIN "+this.__tempIdTableName+" AS purge ON main.Id = purge.Id WHERE purge.Id IS NULL AND main.Object_Name = '"+e+"' AND main.Id NOT LIKE 'local_%' AND main.Id NOT LIKE 'attach_local_%')",a="DELETE FROM '"+this.__tempIdTableName+"'",r=this._initSQLServiceRequest({query:n});return r=r.then(T.proxy(this,this._initSQLServiceRequest,{query:i},null)),r=r.then(T.proxy(this,this._initSQLServiceRequest,{query:a},null)),r=r.then(function(){t.resolve()}),t}},{key:"__getPIQPurgeFiles",value:function(){var e=this,t=T.Deferred(),n=this.__getCDLIdsToIgnore(T.getCustomObjectName("Site")),i=this.__getCDLIdsToIgnore(T.getCustomObjectName("Installed_Product"));return b.when(n,i).then(function(n,i){var a=n.concat(i);e._commonSaveRecordIds([{value:"ContentDocumentLink",values:a}]),t.resolve()}),t}},{key:"__getDocTemplatePurgeFiles",value:function(){var e=this,t=T.Deferred(),n=this.__getCDLIdsToIgnore("SFDocTemplate");return b.when(n).then(function(n){e._commonSaveRecordIds([{value:"ContentDocumentLink",values:n}]),t.resolve()}),t}},{key:"__purgeSFFiles",value:function(){var e=this,t=T.Deferred(),n=this._getState("DO_NOT_PURGE_IDS")||{};if(void 0!==n.ContentDocumentLink){var i=(0,d.default)(n.ContentDocumentLink),a="SELECT cdl.Id,cdl.ContentDocumentId FROM ContentDocumentLink AS cdl LEFT JOIN ContentDocument AS cd ON cdl.ContentDocumentId = cd.Id WHERE cdl.Id NOT IN ('"+i.join("','")+"') AND cdl.Id NOT LIKE 'local_%'";i.length>0&&(a+=" AND datetime(cd.LastModifiedDate) < datetime('now','-"+this.__purgeDays+" days')"),this._initSQLServiceRequest({query:a}).then(T.proxy(this,function(n){var i=(0,c.default)(new s.default(n.map(function(e){return e.Id})));e._commonSaveRecordIds([{value:"ContentDocumentLink",values:[]}]),i.length>0?R.deleteSfFileRelatedTables(i,null,!1).always(function(){t.resolve()}):t.resolve()})).fail(function(){t.resolve()})}else t.resolve();return t}},{key:"__purgeAttachments",value:function(){var e=(this._getState("DO_NOT_PURGE_IDS"),this._initSQLServiceRequest({query:"SELECT key_prefix, object_name  FROM 'SFObjectDescribe' od WHERE key_prefix IN (SELECT DISTINCT substr(a.parentId, 0, 4) FROM 'Attachment' a )"}));return e=e.then(T.proxy(this,function(e){var t=T.Deferred();t.resolve();var n=void 0,i=void 0,a=void 0,r={};for(i=e.length,n=0;n<i;n++)r[e[n].key_prefix]=e[n].object_name==T.OrgNamespace+"__Doc_Template__c"?"SFDocTemplate":e[n].object_name;for(a in r)t=t.then(T.proxy(this,this.__purgeObjectAttachments,a,r[a]));return t}))}},{key:"__purgeObjectAttachments",value:function(e,t){var n=T.Deferred(),i="DELETE FROM 'Attachment' WHERE Id IN (   SELECT a.Id FROM 'Attachment' a   LEFT JOIN '"+t+"' o ON a.ParentId = o.Id   WHERE substr(a.ParentId, 0, 4) = '"+e+"'   AND o.ID IS NULL )",a="DELETE FROM 'Attachment' WHERE Id IN ( SELECT a.Id FROM 'Attachment' a LEFT JOIN '"+t+"' o ON a.ParentId = o.Id LEFT JOIN "+this.__tempIdTableName+" AS purge on a.Id = purge.Id WHERE purge.Id is NULL AND substr(a.ParentId, 0, 4) = '"+e+"'  AND datetime(a.CreatedDate) < datetime('now', '-"+this.__purgeDays+" days') AND a.Id NOT LIKE 'local_%' AND a.Id NOT LIKE 'attach_local_%' )",r=this._initSQLServiceRequest({query:i});return"SFDocTemplate"!=t&&(r=r.then(T.proxy(this,this._initSQLServiceRequest,{query:a},null))),r=r.then(function(){n.resolve()}),n}},{key:"__purgeSFAttachments",value:function(){var e=T.Deferred(),t="DELETE FROM 'SFAttachments' WHERE Id IN (SELECT main.Id FROM 'SFAttachments' AS main LEFT JOIN Attachment AS purge ON main.Id = purge.Id WHERE purge.Id IS NULL AND main.Id NOT LIKE 'local_%' AND main.Id NOT LIKE 'attach_local_%')";return O.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(t="DELETE FROM 'SFAttachments' WHERE Id IN (SELECT main.Id FROM 'SFAttachments' AS main LEFT JOIN Attachment AS purge ON main.Id = purge.Id LEFT JOIN ContentVersion as cvpurge on main.Id = cvpurge.Id  WHERE (purge.Id IS NULL AND cvpurge.Id IS NULL) AND main.Id NOT LIKE 'local_%' AND main.Id NOT LIKE 'attach_local_%')"),this._initSQLServiceRequest({query:t},{handler:function(t){e.resolve()}}),e}},{key:"__purgeSFAttachmentsValidateClientSyncLog",value:function(){var e=T.Deferred(),t=this._initSQLServiceRequest({query:"SELECT sf.file_path FROM 'SFAttachments' as sf LEFT JOIN 'ClientSyncLog' as cl on sf.Id = cl.Id where cl.Id IS NULL and sf.Id IS NOT NULL and sf.ID LIKE 'attach_local_%';"}),n=this._initSQLServiceRequest({query:"DELETE FROM 'SFAttachments' WHERE Id IN (SELECT sf.Id FROM 'SFAttachments' as sf LEFT JOIN 'ClientSyncLog' as cl on sf.Id = cl.Id where cl.Id IS NULL and sf.Id IS NOT NULL and sf.ID LIKE 'attach_local_%');"});return T.when([t,n]).then(T.proxy(this,function(t){for(var n in t)this.__deleteFile(n);e.resolve()})),e}},{key:"__purgeClientSyncLogValidateSFAttachments",value:function(){var e=T.Deferred();return this._initSQLServiceRequest({query:"DELETE FROM 'ClientSyncLog' WHERE Id IN (SELECT cl.Id FROM 'ClientSyncLog' as cl LEFT JOIN 'SFAttachments' as sf on sf.Id = cl.Id where cl.Id IS NOT NULL and sf.Id IS NULL and cl.Id LIKE 'attach_local_%');"},{handler:function(){e.resolve()}}),e}},{key:"__purgeFiles",value:function(){var e=T.Deferred(),t=(this._getState("DO_NOT_PURGE_DOCUMENTS"),this._initSQLServiceRequest({query:"SELECT file_path FROM SFAttachments"})),n=this._initSQLServiceRequest({query:"SELECT Id, DeveloperName, Type FROM Document"}),i="SELECT process_unique_id FROM SFProcess WHERE process_type = 'OUTPUT DOCUMENT'",a=this._initSQLServiceRequest({query:i}),r=this._initSQLServiceRequest({query:i}),o=this._initSQLServiceRequest({query:i}),s=this.__getFilesystemFiles("{DownloadDirectory}"),l=this.__getFilesystemFiles("{UploadDirectory}");return T.when([t,n,a,r,o,s,l]).then(T.proxy(this,function(t,n,i,a,r,o,s){var l=void 0,c=void 0,u=[],d=[];for(c=t.length,l=0;l<c;l++)u.push(t[l].file_path);for(c=n.length,l=0;l<c;l++)u.push("{DownloadDirectory}/"+n[l].Id+"_"+n[l].DeveloperName+"."+n[l].Type);for(c=i.length,l=0;l<c;l++)u.push("{DownloadDirectory}/"+i[l].process_unique_id+".zip");for(c=a.length,l=0;l<c;l++)u.push(a[l].html_name);for(c=r.length,l=0;l<c;l++)u.push(r[l].name);for(c=o.length,l=0;l<c;l++)-1==u.indexOf(o[l])&&d.push(o[l]);for(c=s.length,l=0;l<c;l++)-1==u.indexOf(s[l])&&d.push(s[l]);var _=[];for(c=d.length,l=0;l<c;l++)_.push(this.__deleteFile(d[l]));_?T.when(_).then(function(){e.resolve()}):e.resolve()})),e}},{key:"__getFilesystemFiles",value:function(e){var t=T.Deferred(),n=k.Utils.nativeService.createFileRequest();return n.bind("REQUEST_COMPLETED",function(e){var n=[];if(e.data.success){n=T.toObject(e.data.data).FileList||[]}t.resolve(n)},this),n.bind("REQUEST_ERROR",function(e){t.resolve([])},this),n.execute({operation:"LIST",file:e}),t}},{key:"__deleteFile",value:function(e){var t=new T.Deferred,n=I;if(e){var i=n.createFileRequest();i.bind("REQUEST_COMPLETED",function(e){t.resolve()},this),i.bind("REQUEST_ERROR",function(e){t.resolve()},this),i.execute({operation:"DELETE",file:e})}else t.resolve();return t}},{key:"__deleteTempIdTable",value:function(){var e=T.Deferred(),t="DROP TABLE IF EXISTS '"+this.__tempIdTableName+"';";return this._initSQLServiceRequest({query:t},{handler:function(t){e.resolve()}}),e}}]),t}(k.SyncEvent),k.SyncGetEventsPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG146","Determining Purge Records"],e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){this._syncGetEvents({eventName:"EVENT_SYNC",handler:function(e){var t=this._resultToObjectReqs(e);this._commonSaveRecordIds(t)}})}}]),t}(k.SyncGetEvents),k.SyncGetPriceDataPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG146","Determining Purge Records"],e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){this._syncGetPriceCalcData({lastIndex:0}),this._syncGetPriceCalcData({lastIndex:1}),this._getWorkDetailActivityTypeValues(function(e){this._syncGetPriceCalcData({lastIndex:2,activityTypes:e})})}},{key:"_commonSyncObjectRecords",value:function(e,t){this._commonSaveRecordIds(e)}}]),t}(k.SyncGetPriceData),k.SyncGetDownloadCriteriaPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG146","Determining Purge Records"],e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){this._syncGetDownloadCriteria({eventName:"SYNC_DOWNLOAD_CRITERIA",handler:function(e){this._commonSaveRecordIds(e)}})}}]),t}(k.SyncGetDownloadCriteria),k.SyncGetAdvDownloadCriteriaPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG146","Determining Purge Records"],e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){this._syncGetAdvDownloadCriteria({insertHandler:function(e){this._commonSaveRecordIds(e)},updateHandler:function(e){this._commonSaveRecordIds(e)},deleteHandler:function(e){}})}}]),t}(k.SyncGetAdvDownloadCriteria),k.SyncGetDownloadSalesforceFilesPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG146","Determining Purge Records"],e._commonSaveRecordIds([{value:"ContentDocumentLink",values:[]}]),e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){var e=this;O.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&e._syncGetDownloadEventFiles({insertHandler:function(e,t,n){0==e.length&&e.push({value:"ContentDocumentLink",values:[]}),this._commonSaveRecordIds(e)}})}}]),t}(k.SyncGetDownloadSalesforceFiles),k.SyncMobileInventoryDataPurge=function(e){function t(){(0,h.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG146","Determining Purge Records"],e}return(0,y.default)(t,e),(0,v.default)(t,[{key:"trigger",value:function(){var e=this;e.getMobileInventoryBasicSettings(function(){var t=e.getMobielInventorySetting(),n=e.isTrunkStockLocationAvailable();t&&n&&e.__getMobileInventoryData({eventName:"TRUNK_STOCK",handler:function(e){var t=[];for(var n in e){var i=e[n].values;i.length>0&&t.push({value:n,values:i})}this._commonSaveRecordIds(t)}})})}}]),t}(k.MobileInventoryData),k.SyncPiqDataPurge=function(e){function t(){return(0,h.default)(this,t),(0,p.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,v.default)(t,[{key:"_processRecords",value:function(e,t){var n=[],i=["Account","Product2",T.getCustomObjectName("Site"),T.getCustomObjectName("Installed_Product")],a=this;if(e.length){for(var r=0;r<e.length;r++)for(var o=e[r],s=0;s<i.length;s++){var l=i[s],c=o[l];if(c){n.push({value:l,values:c});break}}this._commonSaveRecordIds(n),a._triggerCallBack(!0,t)}else a._triggerCallBack(!1,t)}}]),t}(k.PiqDataSync),T.defineGlobal(L.name,L),e.exports=L},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(31),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(30),v=i(m),g=n(0).utils,y=n(7).SystemData,S=n(5).ExtensionRunner,E=(n(101).SQLSchema,n(56)),b={name:"com.servicemax.client.sync.syncmobileinventory"},T=b;(0,v.default)(T,E),b.SyncMobileInventoryBase=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"getMobileInventoryBasicSettings",value:function(e){e&&this.__getMobileInventorySettingValue(function(t){this.__getMobileInventoryLastDataSyncTime(function(n){this._setState("MOBIEL_INVENTORY_ENABLED_FOR_INITIAL_SYNC",t),this._setState("MOBILE_INVENTORY_LAST_SYNC_TIME",n),e.call(this)})})}},{key:"__getMobileInventorySettingValue",value:function(e){if(e){var t=this,n=!1,i="MobileDeviceSettings";t._tempTableCreated(i)&&(i=g.getTempTableName(i));var a="SELECT setting_id, value FROM "+i+" WHERE setting_id IN ('INVT002_SET001')";t._initSQLServiceRequest({query:a},{handler:function(t){if(t&&t.length){var i=t[0];n=!(!i.value||"true"!==i.value.toLowerCase())}e.call(this,n)},context:t})}}},{key:"__getMobileInventoryLastDataSyncTime",value:function(e,t){if(e){var n=this,i="ClientCache";n._tempTableCreated(i)&&(i=g.getTempTableName(i));var a="SELECT value FROM "+i+" WHERE key = 'LAST_SYNC_TIME'";n._initSQLServiceRequest({query:a},{handler:function(i){var a=i.length?i[0].value:"";e.call(t||n,a)},context:n})}}},{key:"getMobielInventorySetting",value:function(){return this._getState("MOBIEL_INVENTORY_ENABLED_FOR_INITIAL_SYNC")}},{key:"getMobileInventoryLastSyncTime",value:function(){return this._getState("MOBILE_INVENTORY_LAST_SYNC_TIME")}},{key:"getMobileInventoryTableName",value:function(e){return this._tempTableCreated(e)&&(e=g.getTempTableName(e)),e}},{key:"isTrunkStockLocationAvailable",value:function(){var e=y,t=this._getState("USER_INFO")||e.getUserInfo(),n=!1;return t.UserTrunkDetail&&t.UserTrunkDetail.Id&&(n=!0),n}}]),t}(T.SyncEvent),b.MobileInventoryConfigData=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(){var e=this;e.getMobileInventoryBasicSettings(function(){var t=this.getMobielInventorySetting();if(t){var n=(g.getCurrentApplication().getUserInfo().UserSessionId,{type:"POST",methodName:"MetaSyncRequest",data:{eventType:"META_SYNC",eventName:"MOBILE_INVENTORY_CONFIG",values:[]},headers:[]});this._initHTTPServiceRequest(n,{handler:function(e){var t="InventoryConfig";if(this._tempTableCreated(t)&&(t=g.getTempTableName(t)),e.valueMap&&e.valueMap.length>0){this._setState("MOBILE_INEVENTORY_TABLES_TO_DESCRIBE",e.valueMap[0].values);(0,r.default)(e.valueMap[0].value);this._insertMetadata(t,[{Type:"TECHNICIAN",Content:e.valueMap[0].value}]),this.__performDescribe(e.valueMap[0].values)}}})}else e.__logger.error("Mobile Inventory is not enabled to perform ObjectDescribe -Setting mobileInventoryEnabled value is :"+t)})}},{key:"__performDescribe",value:function(e){var t=this;for(var n in e){var i=e[n];this._getState("DESCRIBED."+i)&&e.splice(n,1)}e.length>0?(t._setState("MOBILE_INEVENTORY_TABLES_DESCRIBED",e),t.__getMobileInventoryObjectDescribe(e)):this.__logger.error("No objects availble to perform ObjectDescribe")}},{key:"__getMobileInventoryObjectDescribe",value:function(e){function t(){var e=n._getState("MOBILE_INEVENTORY_TABLES_DESCRIBED");if(e&&e.length>0){new S.run(n.getSyncManager(),"com.servicemax.client.sync.extensions",{tables:e,extensionClassName:"com.servicemax.client.offline.sal.model.sync.extensions.SFObjectFieldPopulateExtension"}).then(function(){n.__logger.info("Completed Extension com.servicemax.client.offline.sal.model.sync.extensions.SFObjectFieldPopulateExtension for Mobiel Inventory to populate SObjectField Table")})}}for(var n=this,i=0;i<e.length;i++){var a=e[i];this._ensureSObjectTableExists(a,!0,function(n){i===e.length-1&&t()})}}}]),t}(T.SyncMobileInventoryBase),b.MobileInventoryData=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(){var e=this;e.getMobileInventoryBasicSettings(function(){var t=e.getMobielInventorySetting(),n=e.isTrunkStockLocationAvailable(),i=e.getMobileInventoryLastSyncTime();t&&n&&e.__getMobileInventoryData({eventName:"TRUNK_STOCK",lastSyncTime:i,handler:function(t,n){e.__formatResultAndCallTXFetch(t,n)}})})}},{key:"__formatResultAndCallTXFetch",value:function(e,t){var n=[],i=g.deepCloneObject(e);t&&delete i.CALL_BACK;for(var a in i){var r=i[a].values;r.length>0&&n.push({value:a,values:r})}if(n.length>0){var o=this._isInitialSync()?"insert":"update.incremental";this._commonSyncObjectRecords(n,o)}else!t&&n.length}},{key:"__parseResponse",value:function(e){if(!(e&&e.valueMap&&e.valueMap.length))return{};for(var t={},n=0;n<e.valueMap.length;n++){var i=e.valueMap[n];if(i){t[i.key]=i}}return t}},{key:"__getMobileInventoryData",value:function(e){var t=this,n={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:e.eventName,valueMap:[]}};!t._isInitialSync()&&e.lastSyncTime&&e.lastSyncTime.length>0&&n.data.valueMap.push({key:"LAST_SYNC_TIME",value:e.lastSyncTime}),e.addCallBackKey&&n.data.valueMap.push(e.callBackResult),this._initHTTPServiceRequest(n,{handler:function(n){var i=t.__parseResponse(n)||{},a=!1;if(i.CALL_BACK&&i.CALL_BACK.value&&"true"===i.CALL_BACK.value.toLowerCase()){a=!0;var r=t.getMobileInventoryLastSyncTime();t.__getMobileInventoryData({eventName:e.eventName,addCallBackKey:!0,lastSyncTime:r,callBackResult:i.CALL_BACK,handler:e.handler})}e.handler.call(t,i,a)}})}}]),t}(T.SyncMobileInventoryBase),g.defineGlobal(b.name,b),e.exports=b},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(16),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(3),h=i(_),f=n(6),p=i(f),m=n(4),v=i(m),g=n(30),y=i(g),S=n(0).utils,E=n(56),b=n(7).ServerInfo,T={name:"com.servicemax.client.sync.syncconfigapi"},M=T,I=b;(0,y.default)(M,E),T.SyncLocalMetadata=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG070","Downloading Mobile Configuration"],e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this.getSyncManager().beforeFirstRunCompleted()||(this._createAlwaysPresentMetaTables(),this._cacheUserInfo())}},{key:"_cacheUserInfo",value:function(){this.getUserInfo(function(e){e?(this.setUserInfo(e),this._setTempCache("USER_INFO",S.toJSON(e))):this.__onInfo("User Info not set :"+e)})}},{key:"_getAlwaysPresentMetaTables",value:function(){var e=M.SQLSchema.tables,t=M.Utils.MetaData.getTablesInDatabase(),n={};for(var i in e)if(e[i].createIfMissing&&!t[i])n[i]=e[i];else{if(!e[i].createAlways)continue;n[i]=e[i]}return n}},{key:"_createAlwaysPresentMetaTables",value:function(){var e=this._getAlwaysPresentMetaTables();for(var t in e){var n=e[t].table,i=this._getTempTableName(n),a=M.SQLSchema.getCreateQuery(n,i);a="DROP TABLE IF EXISTS `"+i+"`; "+a,function(e,t){this._initSQLServiceRequest({query:t},{handler:function(t){this._tempTableCreated(e,!0),this._registerTableInDatabase(e)}})}.call(this,n,a)}}},{key:"_setLastSyncTimeValue",value:function(){var e=this.__logger.getTimestamp();this._setLastSyncTime(e)}},{key:"validateSchema",value:function(e){this._forEachSFObjectDescribe(this._ensureSObjectTableExists);var t=0,n=S.proxy(this,function(){0==--t&&this._convertTempTables(function(){this._isTableDataValid(function(t){return e&&e(t)})})}),i=this._getAlwaysPresentMetaTables();for(var a in i){var r=i[a];t++,this._isSchemaValid(r,function(e,t){if(e)return n();this._upgradeSchemaTable(t,function(){return n()})})}}},{key:"_isTableDataValid",value:function(e){for(var t=this._isMetadataValid(),n=["SFObjectDescribe","SFObjectField"],i=0,a=0;a<n.length;a++){var r=n[a],o="SELECT COUNT(*) FROM '"+r+"';";i++,function(n){this._unSyncronizedSQLServiceRequest({query:o},{handler:function(n){(n[0]&&n[0]["COUNT(*)"])<1&&(t=!1),0==--i&&e&&e.call(this,t)}})}.call(this,r)}}},{key:"_isSchemaValid",value:function(e,t){var n="PRAGMA table_info("+e.table+")";this._initSQLServiceRequest({query:n},{handler:function(n){for(var i=!0,a=S.toObject(n),r={},o=0;o<a.length;o++){var s=a[o].name;r[s]=!0}for(var s in e.fields)!i||s in r||(this.__logger.info("Metadata table requires upgrade: "+e.table),i=!1);return t.call(this,i,e.table)}})}},{key:"_isMetadataValid",value:function(){for(var e=["ClientCache","SFObjectDescribe","SFAttachments","MobileDeviceTags","MobileDeviceSettings","SFDocTemplate","SFDocTemplateDetail","SFSourceUpdate","SmartDocHTML","SmartDocSignature"],t=!0,n=M.Utils.MetaData.getTablesInDatabase(),i=0;i<e.length;i++){n[e[i]]||(t=!1)}return t}}]),t}(M.SyncEvent),T.SyncConfigDataInitial=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__configTableMap={SFM_TARGET_MANAGER:"SFProcess",SFM_PROCESS_NODE_OBJECT:"SFProcessComponent",SFM_EXPRESSION:"SFExpression",SFM_EXPRESSION_DETAILS:"SFExpressionComponent",SFM_PROCESS_BUSINESS_RULE:"SFProcessBusinessRule",SFM_BUSINESS_RULE:"SFBusinessRule",OBJECT_MAPPING:"SFObjectMapping",OBJECT_MAPPING_DETAILS:"SFObjectMappingComponent",SOURCE_UPDATE:"SFSourceUpdate",NAMED_SEARCH:"SFNamedSearch",SEARCH_OBJECT:"SFNamedSearchCriteria",SEARCH_OBJECT_DETAIL:"SFNamedSearchComponent",LINKED_SFM_PROCESS:"SFLinkedProcess",DOC_TEMPLATE:"SFDocTemplate",DOC_TEMPLATE_DETAIL:"SFDocTemplateDetail",CHECKLIST_SMART_DOC:"SFChecklistOPDOC",SFM_WIZARD:"SFWizard",SFM_WIZARD_STEP:"SFWizardComponent",SFM_WIZARD_CUSTOM_ACTIONS:"SFWizardCustomAction",SFM_EVENT:"SFEvent",SFM_WIZARD_CUSTOM_ACTIONS_PARAMS:"CustomActionParams",SFM_WIZARD_LAYOUT:"SFWizardLayout",SFM_SEARCH_PROCESS_OBJECTS:"SFSearchProcessObject",SFM_SEARCH_PROCESS:"SFSearchProcess",SFM_SEARCH_DETAILS:"SFSearchDetail",ATTACHMENTS:"SFAttachments",MOBILE_DEVICE_SETTINGS:"MobileDeviceSettings",MOBILE_CONFIG:"MobileDeviceSettings",QUESTION_BANK:"SFQuestionBank",QB_RESPONSE_SET:"SFQBResponseSet",CALL_BACK:"CALL_BACK",CHECKLIST_DEFAULT_RESPONSE:"SFChecklistDefaultResponseSet",TEMPLATE_FILES:"SFAttachmentsForFiles"},e.__configColumnMap={SFM_TARGET_MANAGER:{Id:"process_id",NS__Purpose__c:"process_type",NS__Name__c:"process_name",NS__Page_Layout__c:"page_layout_id",NS__Description__c:"process_description",NS__ProcessID__c:"process_unique_id",NS__Doc_Template__c:"doc_template_id",NS__SM_Include_Skipped_Sections__c:"include_skipped_sections",NS__SM_Run_Targeted_Sync__c:"run_targeted_sync",NS__SM_Enable_Version_Control__c:"file_version_enabled"},SFM_PROCESS_NODE_OBJECT:{Id:"Id",NS__Process__c:"process_id",NS__Type__c:"component_type",NS__Page_Layout__c:"layout_id",NS__Source_Object_Name__c:"object_name",NS__Target_Object_label__c:"target_object_label",NS__Submodule__c:"expression_id",NS__Module__c:"object_mapping_id",NS__Final_Exception_Process__c:"value_mapping_id",NS__Sequence__c:"sequence",NS__Node_Parent_API__c:"node_parent_api",NS__Node_Source_Object_API__c:"node_source_object_api",NS__Node_Parent__c:"node_parent",NS__Parent_Object__c:"parent_object",NS__Parent_Column_Name__c:"parent_column",NS__Values__c:"advanced_options",NS__Doc_Template_Details__c:"doc_template_detail_id",NS__Enable_Attachment__c:"enable_attachment"},SFM_EXPRESSION:{Id:"expression_id",NS__ProcessID__c:"expression_name",NS__Source_Object_Name__c:"source_object_name",NS__Values__c:"failure_reason",NS__Sequence__c:"sequence",NS__Advance_Expression__c:"advance_expression",NS__Parent_Error_Msg__c:"error_message"},SFM_EXPRESSION_DETAILS:{NS__Expression_Rule__c:"expression_id",NS__Field_Name__c:"source_field_name",NS__Operator__c:"operator",NS__Operand__c:"value",NS__Display_Type__c:"field_type",NS__Sequence__c:"sequence",NS__Parameter_Type__c:"parameter_type",NS__Expression_Type__c:"expression_type",NS__Formula__c:"formula",NS__Action_Type__c:"action_type",NS__Description__c:"description"},SFM_PROCESS_BUSINESS_RULE:{Id:"Id",Name:"name",NS__Process1__c:"target_manager",NS__Process2__c:"process_node_object",NS__Process3__c:"business_rule",NS__Description__c:"description",NS__Parent_Error_Msg__c:"error_msg",NS__Sequence__c:"sequence",NS__Source_Object_Name__c:"source_object_name",NS__SM_Section__c:"section",NS__Rule_Type__c:"rule_type",NS__SM_Target_Section__c:"target_section"},SFM_BUSINESS_RULE:{Id:"Id",Name:"name",NS__ProcessID__c:"process_ID",NS__Description__c:"description",NS__Source_Object_Name__c:"source_object_name",NS__Parent_Error_Msg__c:"error_msg",NS__Advance_Expression__c:"advanced_expression",NS__Message_Type__c:"message_type",NS__Rule_Type__c:"rule_type"},OBJECT_MAPPING:{Id:"object_mapping_id",NS__MapID__c:"object_mapping_name",NS__Source_Object_Name__c:"source_object_name",NS__Target_Object_Name__c:"target_object_name"},OBJECT_MAPPING_DETAILS:{NS__MapID__c:"object_mapping_id",NS__Source_Field_Name__c:"source_field_name",NS__Target_Field_Name__c:"target_field_name",NS__Preference_2__c:"preference_2",NS__Preference_3__c:"preference_3",NS__Display_Value__c:"mapping_value"},SOURCE_UPDATE:{Id:"Id",NS__Setting_ID__c:"target_process_node",NS__Action__c:"action",NS__Display_Value__c:"display_value",NS__Configuration_Type__c:"configuration_type",NS__Target_Field_Name__c:"target_field_name",NS__Source_Field_Name__c:"source_field_name",NS__Dispatch_Process__c:"process",NS__SM_Question__c:"question"},NAMED_SEARCH:{Id:"search_sfid",NS__Name__c:"search_name",NS__IsStandard__c:"is_standard",NS__IsDefault__c:"is_default",NS__Number_of_Lookup_Records__c:"no_of_lookup_records",NS__Default_Lookup_Column__c:"default_lookup_column",NS__Source_Object_Name__c:"object_name",NS__Rule_Type__c:"search_type",NS__ProcessID__c:"named_search_id",NS__Sequence__c:"sequence",NS__Process__c:"filter_criteria"},SEARCH_OBJECT:{Id:"id",NS__Name__c:"name",NS__Default_On__c:"default_on",NS__Field_Name__c:"field_name",NS__Allow_Override__c:"allow_override",NS__Advance_Expression__c:"advanced_exp",NS__Rule_Type__c:"rule_type",NS__Parent_Object_Criteria__c:"parent_object_criteria",NS__Source_Object_Name__c:"source_object_name",NS__Sequence__c:"sequence",NS__Module__c:"named_search"},SEARCH_OBJECT_DETAIL:{NS__Internal_Value__c:"named_search",NS__Field_Name__c:"field_name",NS__Search_Object_Field_Type__c:"search_object_field_type",NS__Sequence__c:"sequence",NS__Field_Relationship_Name__c:"field_relationship_name",NS__Display_Type__c:"field_type",NS__Expression_Type__c:"expression_type",NS__Parameter_Type__c:"parameter_type",NS__Operator__c:"operator",NS__Operand__c:"operand",NS__Object_Name__c:"object_name",NS__FKey_Name_Field__c:"fkey_name_field",NS__Expression_Rule__c:"exp_rule"},LINKED_SFM_PROCESS:{Id:"Id",NS__Process1__c:"source_header",NS__Process2__c:"source_detail",NS__Process3__c:"target_header"},DOC_TEMPLATE:{Id:"Id",NS__Name__c:"doc_template_name",NS__Template_Id__c:"doc_template_id",NS__Media_Resources__c:"media_resources",NS__IsStandard__c:"is_standard",NS__Detail_Object_Count__c:"detail_object_count"},DOC_TEMPLATE_DETAIL:{Id:"Id",NS__Doc_Template__c:"doc_template",NS__Doc_Template_Detail_Unique_Id__c:"doc_template_detail_unique_id",NS__Alias__c:"alias",NS__Doc_Template_Detail_Id__c:"doc_template_detail_id",NS__Fields__c:"fields",NS__Header_Reference_Field__c:"header_ref_fld",NS__Object_Name__c:"object_name",NS__SOQL__c:"soql",NS__Type__c:"type"},CHECKLIST_SMART_DOC:{Id:"Id",Name:"Name",RecordTypeId:"RecordTypeId",NS__Process1__c:"OPDOCProcessId",NS__Process2__c:"ChecklistProcessId",NS__SM_Checklist_Version__c:"ChecklistVersion"},SFM_WIZARD:{Id:"wizard_id",NS__Name__c:"wizard_name",NS__Description__c:"wizard_description",NS__Active__c:"is_active",NS__Submodule__c:"expression_id",NS__Source_Object_Name__c:"object_name"},SFM_WIZARD_STEP:{Id:"action_id",NS__Module__c:"wizard_id",NS__Submodule__c:"expression_id",NS__Name__c:"action_name",NS__Description__c:"action_description",NS__Sequence__c:"sequence",NS__Process__c:"process_id",NS__Expertise_Match_Enabled__c:"perform_sync",NS__Action_Type__c:"action_type",NS__Mode_Of_Execution__c:"mode_of_execution"},SFM_WIZARD_CUSTOM_ACTIONS:{Id:"Id",NS__Name__c:"wizard_step_name",NS__Description__c:"wizard_step_description",NS__Service_Class_Name__c:"class_name",NS__Service_Method_Name__c:"method_name",NS__Sequence__c:"sequence",NS__Target_URL__c:"target_url",NS__Custom_Action_Type__c:"custom_action_type",NS__SM_Schema_Name__c:"schema_name",NS__SM_Path__c:"path",NS__SM_Include_Object_Data_Set__c:"include_object_data_set"},SFM_EVENT:{Id:"Id",NS__Sequence__c:"sequence",NS__ServiceMax_Process__c:"wizard_step_id",NS__Target_Call__c:"service_name",NS__Event_Call_Type__c:"type"},SFM_WIZARD_CUSTOM_ACTIONS_PARAMS:{Id:"Id",Name:"Name",NS__Action_Type__c:"action_type",NS__Dispatch_Process__c:"DispatchProcessId",NS__Parameter_Name__c:"ParameterName",NS__Parameter_Type__c:"ParameterType",NS__Parameter_Value__c:"ParameterValue"},MOBILE_DEVICE_SETTINGS:{NS__Setting_Unique_ID__c:"setting_id",NS__Internal_Value__c:"value"},MOBILE_CONFIG:{NS__Display_Type__c:"setting_id",NS__Internal_Value__c:"value"},QUESTION_BANK:{Id:"Id",Name:"Name",LastModifiedBy:"LastModifiedBy",CurrencyIsoCode:"CurrencyIsoCode",CreatedBy:"CreatedBy",NS__Help_URL__c:"Help_URL",NS__Length__c:"Length",NS__Precision__c:"Precision",NS__Question__c:"Question",NS__QuestionID__c:"QuestionID",NS__QuestionJSON__c:"QuestionJSON",NS__Response_Set__c:"Response_Set",NS__Response_Type__c:"Response_Type",NS__Scale__c:"Scale",NS__Short_Name__c:"Short_Name",NS__SM_Show_In_Smart_Doc__c:"Show_In_SmartDoc",NS__SM_Description_Required__c:"Description_Required"},QB_RESPONSE_SET:{Id:"Id",Name:"Name",LastModifiedBy:"LastModifiedBy",CurrencyIsoCode:"CurrencyIsoCode",CreatedBy:"CreatedBy",NS__Response_Set_Values__c:"Response_Set_Values"},CHECKLIST_DEFAULT_RESPONSE:{Id:"Id",NS__SM_Default_Response__c:"DefaultResponse",NS__SM_Is_literal_Used__c:"Is_literal_Used",NS__SM_Question__c:"Question"}},e.isSearchConfigAvailable=null,e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._ensureSpecificObjectsExists(),this.__getRequest(function(e){this._initHTTPServiceRequest(e,{handler:this.responseHandler,context:this})})}},{key:"__triggerCallBack",value:function(e){if(!(e&&e.valueMap&&e.valueMap.length&&"CALL_BACK_CONTEXT"===e.valueMap[0].key))return this.isSearchConfigAvailable&&(this._ensureSObjectTempTableExists(S.OrgNamespace+"__ServiceMax_Processes__c",null),this._ensureSObjectTempTableExists(S.OrgNamespace+"__ServiceMax_Config_Data__c",null)),void this._ensureSalesforceFilesObjectsExist();this.__getRequest(function(t){t.data.valueMap=[e],this._initHTTPServiceRequest(t,{handler:this.responseHandler,context:this})})}},{key:"__getRequest",value:function(e){var t={methodName:"MetaSyncRequest",data:{eventType:"META_SYNC",eventName:"ONE_CALL_SYNC",value:this._getClientId(),valueMap:[]}};if(!0===I.getMultiServerVersionRequest().sendTargetedSyncKeyinOneCallMetaSync()){var n={key:"TARGETED_SYNC_ENABLED",value:!0};t.data.valueMap.push(n)}e.call(this,t)}},{key:"_ensureSpecificObjectsExists",value:function(){this._ensureSObjectTableExists("Attachment",!0),this._ensureSObjectTableExists("Document",!0),this._ensureSObjectTableExists("User",!0),this._ensureSObjectTableExists("Task",!0),this._ensureSObjectTableExists("BusinessHours",!0)}},{key:"_ensureSalesforceFilesObjectsExist",value:function(){I.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(this._ensureSObjectTableExists("ContentVersion",!0),this._ensureSObjectTableExists("ContentDocument",!0),this._ensureSObjectTableExists("ContentDocumentLink",!0))}},{key:"responseHandler",value:function(e){var t=this.__parseResponse(e);if(t){var n=void 0,i=void 0;for(n in t)switch(i=t[n],n){case"SFSearchProcessObject":case"SFSearchProcess":this.isSearchConfigAvailable=!0,this.__insertSearchConfigData(i,!0);break;case"SFSearchDetail":this.isSearchConfigAvailable=!0,this.__insertSearchConfigData(i,!1);break;case"SFAttachments":this._syncDocTemplateAttachments(i);break;case"SFDocTemplate":this.__syncDocTemplateMediaResources(i),this._insertMetadata(n,i);break;case"CALL_BACK":break;case"SFProcess":this.__syncPageLayoutsAndSFMObjects(i),this._insertMetadata(n,i);break;case"MobileDeviceSettings":S.getCurrentApplication().getSyncImpl().addSettingValues(i),this._insertMetadata(n,i);break;case"SFAttachmentsForFiles":this._syncDocTemplateFiles(i);break;default:this._insertMetadata(n,i)}this.__fetchCROutputDocTemplates(),this.__triggerCallBack(t.CALL_BACK)}}},{key:"__parseResponse",value:function(e){if(e&&e.valueMap&&e.valueMap.length){var t=void 0,n=e.valueMap.length,i=void 0,a=void 0,r={};for(t=0;t<n;t++)if(i=e.valueMap[t])try{if(a="CALL_BACK"==i.key?i:this.__applyColumnMapping(S.toObject(i.value),this.__configColumnMap[i.key]),"MOBILE_DEVICE_SETTINGS"===i.key&&i.valueMap&&i.valueMap.length){var o=i.valueMap[0].key,s=i.valueMap[0].value;o&&s&&a.push({setting_id:o,value:s})}a&&(r[i.key]=a)}catch(e){this.__logger.error("Error while parsing: "+i.key)}return this.__mapNamedSearchCriteria(r.SEARCH_OBJECT),this.__mapSFMEvents(r.SFM_WIZARD,r.SFM_EVENT),this.__mapWizardActions(r.SFM_WIZARD_STEP,r.SFM_WIZARD_CUSTOM_ACTIONS),this.__calculateWizardSequenceFromLayout(r.SFM_WIZARD,r.SFM_WIZARD_LAYOUT),this.__applyTableMapping(r)}}},{key:"__applyColumnMapping",value:function(e,t){if(e&&e.length){var n=void 0,i=e.length,a=void 0,r=[];for(n=0;n<i;n++)(a=this.__parseRecord(e[n],t))&&r.push(a);return r}}},{key:"__parseRecord",value:function(e,t){if(!e||!t)return e;var n={},i=void 0,a=void 0;for(i in e)(a=t[i.replace(S.OrgNamespace,"NS")])&&(n[a]=e[i]);return n}},{key:"__applyTableMapping",value:function(e){var t=void 0,n=void 0,i=void 0,a={};for(t in e)(n=this.__configTableMap[t])&&"SFM_WIZARD_LAYOUT"!=t&&"SFM_WIZARD_CUSTOM_ACTIONS"!=t&&"SFM_EVENT"!=t&&(i=e[t]||[],n in a&&a[n].forEach(function(e){i.push(e)}),a[n]=i);return a}},{key:"__mapNamedSearchCriteria",value:function(e){if(e&&e.length){var t=void 0,n=e.length,i=void 0;for(t=0;t<n;t++)if(i=e[t],i.parent_object_criteria){var a=i.parent_object_criteria.match(/(?:([.A-z0-9_-]+ ?!?= ?[^ ()]+)(?: ?(?:AND|OR))?)+/gi);for(var r in a){var o=a[r].match(/([.A-z0-9_-]+ ?!= ?(?:NULL)+)/gi),s=a[r].match(/([.A-z0-9_-]+ ?= ?(?:NULL)+)/gi);if(null!=o){var l=o[0].match(/([.A-z0-9_-]+)/gi);l[0]=this.__replaceRelatedObectField(l[0]),i.parent_object_criteria=i.parent_object_criteria.replace(o[0],"("+l[0]+" IS NOT NULL AND "+l[0]+" IS NOT '')")}if(null!=s){var c=s[0].match(/([.A-z0-9_-]+)/gi);c[0]=this.__replaceRelatedObectField(c[0]),i.parent_object_criteria=i.parent_object_criteria.replace(s[0],"("+c[0]+" IS NULL OR "+c[0]+" IS '')")}}}}}},{key:"__replaceRelatedObectField",value:function(e){var t=void 0,n=e.indexOf(".");return n>=0?(t=e.substr(0,n),t=t.replace(/__r$/,"__c"),t.match(/__c$/)||t.match(/Id$/)||(t+="Id")):t=e,t}},{key:"__mapWizardActions",value:function(e,t){if(e&&t){var n=void 0,i=void 0,a=void 0,r=void 0;for(n in t){r=t[n];for(i in e)a=e[i],r.Id==a.process_id&&(a.customUrl=r.target_url||a.customUrl,a.customActionType=r.custom_action_type,a.action_description=a.action_description||r.wizard_step_description,a.action_name=a.action_name||r.wizard_step_name,a.class_name=r.class_name||a.class_name,a.method_name=r.method_name||a.method_name,a.schema_name=r.schema_name,a.path=r.path,a.include_object_data_set=r.include_object_data_set)}}}},{key:"__mapSFMEvents",value:function(e,t){if(e&&t){var n,i,a,r;for(n in t){r=t[n];for(var i in e)a=e[i],r.wizard_step_id==r.action_id&&(a.sequence=r.sequence||a.sequence,a.class_name=r.service_name||a.class_name,a.action_type=r.type||a.action_type)}}}},{key:"__calculateWizardSequenceFromLayout",value:function(e,t){if(e&&t){var n=S.OrgNamespace+"__Wizard_Layout_Row__c",i=S.OrgNamespace+"__Wizard_Layout_Column__c",a=S.OrgNamespace+"__Dispatch_Process__c",r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0;for(r in t)if(s=t[r],c=parseInt(s[n],10),u=parseInt(s[i],10),c&&u){d=100*u+c;for(o in e)(l=e[o])&&l.wizard_id==s[a]&&(l.sequence=d)}}}},{key:"__syncPageLayoutsAndSFMObjects",value:function(e){if(e&&e.length){var t=this._getState("SFM_PROCESS_IDS")||[],n=this._getState("PAGE_LAYOUT_IDS")||[],i=void 0,a=e.length,r=void 0;for(i=0;i<a;i++)r=e[i],t.indexOf(r.process_id)<0&&t.push(r.process_id),n.indexOf(r.page_layout_id)<0&&n.push(r.page_layout_id);t.length&&this._setState("SFM_PROCESS_IDS",t),n.length&&this._setState("PAGE_LAYOUT_IDS",n),this.__syncBatchSFMPagedata(n,0),this.__syncSFMObjects(t)}}},{key:"__insertSearchConfigData",value:function(e,t){var n="__ServiceMax_Config_Data__c";if(t){n="__ServiceMax_Processes__c";var i=void 0,a=e.length,r=void 0,o=void 0;for(i=0;i<a;i++)r=e[i],o=r[S.OrgNamespace+"__Parent_Object_Criteria__c"],r[S.OrgNamespace+"__Parent_Object_Criteria__c"]=r[S.OrgNamespace+"__Advance_Expression__c"],r[S.OrgNamespace+"__Advance_Expression__c"]=o}this._insertReplaceRecord(S.OrgNamespace+n,e,!0)}},{key:"__syncBatchSFMPagedata",value:function(e,t){if(e&&0!=e.length)for(;e.length>0;){var n=e.splice(0,9),i={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"SFM_PAGEDATA",values:n},subDesc:"x"+n.length};(function(e){this._initHTTPServiceRequest(i,{handler:function(t){var n=this._serviceDataToObject(t);this.__storeSnippetIds(t.valueMap);var i=t&&t.values&&t.values.length?t.values:null;i&&this.__syncBatchSFMPagedata(i,e+1),this.__processSFMPagedataResult(n)}})}).call(this,t),t++}}},{key:"__storeSnippetIds",value:function(e){for(var t=this,n=this,i=0;i<e.length;i++)!function(i){var a=e[i],r=a.values;"CODE_SNIPPET_IDS"===a.key&&r.length&&t._ensureTempTableExists("codeSnippetIdConfig",function(e){var t=r.map(function(e){return"('"+e+"')"}),i="INSERT INTO "+e+" (snippetId) VALUES "+t.join(",");n._initSQLServiceRequest({query:i})})}(i)}},{key:"__processSFMPagedataResult",value:function(e){var t=[];for(var n in e.pageUI)e.pageUI.hasOwnProperty(n)&&t.push({page_layout_id:e.pageUI[n].page.header.hdrLayoutId,page_data:S.toJSON(e.pageUI[n].page)});this._insertMetadata("SFPageLayout",t)}},{key:"__syncSFMObjects",value:function(e){if(e&&0!=e.length){var t={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"SFM_OBJECT_NAMES",values:e}};this._initHTTPServiceRequest(t,{handler:function(t){var n=this._serviceDataToObject(t);n&&n.length?this._processSFMObjectNames(n):this.__syncSFMObjectDefinitions(e)}})}}},{key:"__syncSFMObjectDefinitions",value:function(e){if(e&&0!=e.length){var t={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"SFM_OBJECT_DEFINITIONS",values:e}};this._initHTTPServiceRequest(t,{handler:function(e){var t=this._serviceDataToObject(e),n=e&&e.values&&e.values.length?e.values:null;n&&this.__syncBatchSFMObjectDefinitions(n,0);var i=(0,s.default)(t);this._processSFMObjectNames(i)}})}}},{key:"__syncBatchSFMObjectDefinitions",value:function(e,t){if(e&&0!=e.length){var n={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"SFM_BATCH_OBJECT_DEFINITIONS",values:e}};this._initHTTPServiceRequest(n,{handler:function(e){var n=this._serviceDataToObject(e),i=e&&e.values&&e.values.length?e.values:null;i&&this.__syncBatchSFMObjectDefinitions(i,t+1);var a=(0,s.default)(n);this._processSFMObjectNames(a)}})}}},{key:"_processSFMObjectNames",value:function(e){if(e)for(var t=0;t<e.length;t++)this._ensureSObjectTableExists(e[t],!0)}},{key:"_syncDocTemplateAttachments",value:function(e){this._syncDocTemplateAttachmentsInsert(e,!0)}},{key:"_syncDocTemplateAttachmentsInsert",value:function(e,t){var n={value:"Attachment",values:[]},i=[];for(var a in e)n.values.push(e[a].Id),i.push(e[a].Id);var r=t?"insert":"insert.incremental";this._commonSyncObjectRecords([n],r,function(){this.__fetchDocTemplateAttachmentRecords(i,t,function(e){this.getSyncManager().__stopped=!1,this._downloadAttachmentsArray(e,!0)})})}},{key:"__fetchDocTemplateAttachmentRecords",value:function(e,t,n){var i="Attachment";t&&(i=this._getTempTableName("Attachment")),this._getRecordsByIds(i,e,function(e){n&&n.call(this,e)})}},{key:"_syncDocTemplateFiles",value:function(e){this._syncDocTemplateFilesInsert(e,!0)}},{key:"_syncDocTemplateFilesInsert",value:function(e,t){for(var n=[],i=[],a=0;a<e.length;a++){var r=e[a],o=r.Id;if(r.ContentDocument&&r.ContentDocument.LatestPublishedVersionId){var s=r.ContentDocument.LatestPublishedVersionId;s&&o&&(n.push(s),i.push(o))}}if(i.length>0){var l=[{value:"ContentDocumentLink",values:i}],c=t?"insert":"insert.incremental";this._commonSyncObjectRecords(l,c,function(){var e=this;this.__fetchDocTemplateContentVersionRecords(n,t,function(t){e.getSyncManager().__stopped=!1,e._downloadAttachmentsArray(t,!0,null,!0)})})}}},{key:"__fetchDocTemplateContentVersionRecords",value:function(e,t,n){var i=t?this._getTempTableName("ContentVersion"):"ContentVersion",a=t?this._getTempTableName("ContentDocumentLink"):"ContentDocumentLink",r=e.join("','");selectQuery="SELECT cv.Id, cv.Title as Name, cdl.LinkedEntityId as ParentId, cv.CreatedById, cv.Description, cv.FileType as ContentType, cv.ContentSize as BodyLength, cv.LastModifiedDate FROM '"+i+"' cv LEFT JOIN '"+a+"' cdl ON cdl.ContentDocumentId = cv.ContentDocumentId WHERE cv.Id IN ('"+r+"')";var o={query:selectQuery};this._initSQLServiceRequest(o,{handler:n})}},{key:"__syncDocTemplateMediaResources",value:function(e){if(e){var t=[];for(var n in e)if(e[n].media_resources)for(var i=e[n].media_resources.split(/[;,]/),a=0;a<i.length;a++)-1===t.indexOf(i[a])&&t.push(i[a]);if(t.length){var r="SELECT Id, Name, DeveloperName, NamespacePrefix, ContentType, Type, IsPublic, BodyLength, Body, Url, Description, Keywords, IsInternalUseOnly, AuthorId, CreatedDate, CreatedById, LastModifiedDate, LastModifiedById, SystemModstamp, isBodySearchable FROM Document WHERE DeveloperName IN('"+t.join("','")+"')",o={protocol:"REST",restUrl:"query?q="+encodeURIComponent(r),methodName:"SOQL",data:{eventType:"Query",eventName:"MediaResources"}};this._initHTTPServiceRequest(o,{handler:function(e){if(e&&e.records&&e.records.length){this._insertReplaceRecord("Document",e.records,!0);for(var t=0;t<e.records.length;t++){var n=e.records[t],i=n.Id+"_"+n.DeveloperName+"."+n.Type;this._initNativeServiceRequest("Download",{sourceObject:"Document",recordId:n.Id,file:i,fieldName:"Body"},{handler:function(e){}})}}}})}}}},{key:"__fetchCROutputDocTemplates",value:function(){this.__getOutputDocProcessIds(function(e){var t={methodName:"getCRTemplatesInfo",data:{eventName:"CRTemplatesInfo",eventType:"SFDC",ProcessIds:e}};this._initHTTPServiceRequest(t,{handler:function(e){this.__processTemplateInfoResult(e)}})})}},{key:"__getOutputDocProcessIds",value:function(e){var t={query:"SELECT process_unique_id FROM TEMP__SFProcess as p LEFT JOIN TEMP__SFWizardComponent as w ON p.process_id = w.process_id WHERE w.action_type = 'OUTPUT_DOCUMENT'"};this._initSQLServiceRequest(t,{handler:function(t){for(var n=[],i=0;i<t.length;i++)n.push(t[i].process_unique_id);return e.call(this,n)}})}},{key:"__processTemplateInfoResult",value:function(e){if(e.TemplatesInfo)for(var t=0;t<e.TemplatesInfo.length;t++){var n=e.TemplatesInfo[t],i=n.DeveloperName+"."+n.Type;this.__onInfo("(HTTP) Download CR Template: "+i+" ("+n.Id+")"),this._initNativeServiceRequest("Download",{sourceObject:"Document",recordId:n.Id,file:i,fieldName:"Body"},{handler:function(e){}})}}}]),t}(M.SyncEvent),T.SyncConfigData=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this)}},{key:"_ensureSpecificObjectsExists",value:function(){this._ensureSObjectDescribeExists("Attachment"),this._ensureSObjectDescribeExists("Document"),this._ensureSObjectDescribeExists("User"),this._ensureSObjectDescribeExists("Product2"),this._ensureSObjectDescribeExists("Contact"),this._ensureSObjectTableExists("BusinessHours",!0)}},{key:"_ensureSalesforceFilesObjectsExist",value:function(){I.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(this._ensureSObjectDescribeExists("ContentVersion",!0),this._ensureSObjectDescribeExists("ContentDocument",!0),this._ensureSObjectDescribeExists("ContentDocumentLink",!0))}},{key:"_processSFMObjectNames",value:function(e){if(e)for(var t=0;t<e.length;t++)this._ensureSObjectDescribeExists(e[t])}},{key:"_syncDocTemplateAttachments",value:function(e){this._syncDocTemplateAttachmentsInsert(e,!1)}},{key:"_syncDocTemplateFiles",value:function(e){this._syncDocTemplateFilesInsert(e,!1)}}]),t}(M.SyncConfigDataInitial),T.SyncSettings=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG088","Now downloading configuration settings"],e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){if(this.getSyncManager().beforeFirstRunCompleted())return void this.getSyncManager().beforeFirstRunCompleted(!1);this.__syncMobileDeviceTags()}},{key:"__syncMobileDeviceTags",value:function(){var e={methodName:"MetaSyncRequest",data:{eventType:"META_SYNC",eventName:"FSA_TAGS"}};this._initHTTPServiceRequest(e,{handler:function(e){var t=this._serviceDataToObject(e),n=[];for(var i in t){var a=t[i];for(var r in a)n.push({module_id:i,tag_id:r,value:a[r]})}S.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").setData(S.cloneObject(n)),this._insertMetadata("MobileDeviceTags",n)}})}}]),t}(M.SyncEvent),T.SyncSettingsConfig=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this)}}]),t}(M.SyncSettings),T.SyncRecordTypes=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e={protocol:"REST",restUrl:"query?q="+encodeURIComponent("SELECT Id, Name, DeveloperName, SobjectType FROM RecordType"),methodName:"SOQL",data:{eventType:"Query",eventName:"RecordTypes"}};this._initHTTPServiceRequest(e,{handler:function(e){e&&e.records&&e.records.length&&this._insertReplaceRecord("RecordType",e.records,!0)}})}}]),t}(M.SyncEvent),T.SyncLocalData=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG068","Downloading records"],e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this._forEachSFObjectDescribe(!0,this._ensureSObjectTableExists),this._dropInvalidDataTables()}},{key:"_dropInvalidDataTables",value:function(e){if(this._isTableInDatabase("SFObjectDescribe")){var t=[],n=["codeSnippetIdConfig"];if(this._forEachSFObjectDescribe(!0,function(e){t.push(e)}),this._forEachSFObjectDescribe(!1,function(e){-1===t.indexOf(e)&&this._isTableInDatabase(e)&&n.push(e)}),n.length){for(var i="",a=0;a<n.length;a++)i+="DROP TABLE IF EXISTS "+n[a]+";";this._initSQLServiceRequest({query:i},{handler:function(){e&&e.call(this)}})}else e&&e.call(this)}}}]),t}(M.SyncEvent),T.SyncLocalMetadataConfig=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"_getAlwaysPresentMetaTables",value:function(){for(var e=(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"_getAlwaysPresentMetaTables",this).call(this),n=["ClientCache","ClientSyncLog","ClientSyncConflict","SFObjectDescribe","SFRecordName","SFAttachments","RecentItems","ClientDataOnDemand","SmartSyncTimeStamp"],i=0;i<n.length;i++){var a=n[i];this._isTableInDatabase(a)&&delete e[a]}return e}},{key:"_cacheUserInfo",value:function(){}}]),t}(M.SyncLocalMetadata),T.SyncGetPriceMetadata=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__description=["FSA010_TAG089","Now downloading object definitions"],e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this.getSyncManager().isGetPriceEnabled()&&(this.__syncPriceCalcObjects(),this.__syncPriceCalcCodeSnippets())}},{key:"__syncPriceCalcObjects",value:function(){var e={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"PRICE_CALC_OBJECTS"}};this._initHTTPServiceRequest(e,{handler:function(e){var t=this._serviceDataToObject(e),n=t&&t.Required_Objects;this._processSFMObjectNames(n)}})}},{key:"_processSFMObjectNames",value:function(e){if(e)for(var t=0;t<e.length;t++)this._ensureSObjectTableExists(e[t],!0)}},{key:"__syncPriceCalcCodeSnippets",value:function(){var e={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"PRICE_CALC_CODE_SNIPPET",valueMap:[{key:"TYPE",value:"JavaScript"}]}};this._initHTTPServiceRequest(e,{handler:function(e){var t=this._serviceDataToObject(e);for(var n in t){var i=S.toObject(t[n]),a=i.attributes.type;delete i.attributes,this._insertReplaceRecord(a,i)}}})}}]),t}(M.SyncEvent),T.SyncGetCustomSnippetConfig=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){b.getMultiServerVersionRequest().isCustomSnippetSupported()&&this.__getSnipppetIds(function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n].snippetId;t.length&&this.__syncCodeSnippet(t)})}},{key:"__syncCodeSnippet",value:function(e){var t={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"CODE_SNIPPET",valueMap:[{key:"TYPE",value:"JavaScript"}],values:e}};this._initHTTPServiceRequest(t,{handler:function(e){var t=this._serviceDataToObject(e);for(var n in t){var i=S.toObject(t[n]),a=i.attributes.type;delete i.attributes,this._insertReplaceRecord(a,i)}}})}},{key:"__getSnipppetIds",value:function(e){var t="codeSnippetIdConfig";this._tempTableCreated(t)&&(t=S.getTempTableName(t));var n="SELECT DISTINCT snippetId FROM "+t,i=this;this._initSQLServiceRequest({query:n},{handler:function(t){e&&e.call(i,t)}})}}]),t}(M.SyncEvent),T.SyncGetPriceMetadataConfig=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){(0,r.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"trigger",this).call(this)}},{key:"_processSFMObjectNames",value:function(e){if(e)for(var t=0;t<e.length;t++)this._ensureSObjectDescribeExists(e[t])}}]),t}(M.SyncGetPriceMetadata),T.SyncMergeTempSFObjectConfig=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__description=null,e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){this.__fetchSFObjectsForUpdate(function(e){for(var t=0;t<e.length;t++)this.__describeObjectAndLayouts(e[t])})}},{key:"__describeObjectAndLayouts",value:function(e){this._describeObject(e,function(e){e&&(this._insertMetadata("SFObjectDescribe",[{object_name:e.name,object_describe:S.toJSON(e),key_prefix:e.keyPrefix,label:e.label}]),this._describeLayoutsBatch(e))})}},{key:"__fetchSFObjectsForUpdate",value:function(e){var t={query:"SELECT object_name FROM SFObjectDescribe"};this._initSQLServiceRequest(t,{handler:function(t){var n=[],i=[];if(t)for(var a=0;a<t.length;a++)i.push(t[a].object_name);var r={query:"SELECT object_name FROM TEMP__SFObjectDescribe"};this._initSQLServiceRequest(r,{handler:function(t){var a=[];if(t)for(var r=0;r<t.length;r++)a.push(t[r].object_name);for(var r=0;r<i.length;r++)-1===a.indexOf(i[r])&&-1===n.indexOf(i[r])&&n.push(i[r]);e.call(this,n)}})}})}}]),t}(M.SyncEvent),T.ConfigUpgradeTableDefinition=function(e){function t(){(0,d.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments));return e.__description=null,e}return(0,v.default)(t,e),(0,p.default)(t,[{key:"trigger",value:function(){var e={query:"SELECT object_name FROM SFObjectDescribe"},t=[],n=this;this._initSQLServiceRequest(e,{handler:function(e){for(var i=0;i<e.length;i++){var a=e[i].object_name;t.push(a)}n._oneCallUpgradeSchemaTable(t,function(){console.log("ConfigUpgradeTableDefinition completed ")})}})}}]),t}(M.SyncEvent),S.defineGlobal(T.name,T),e.exports=T},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(16),s=i(o),l=n(2),c=i(l),u=n(3),d=i(u),_=n(6),h=i(_),f=n(4),p=i(f),m=n(30),v=i(m),g=(n(10),n(0).utils),y=n(697),S=n(103),E=n(7).Cache,b=n(12).DatetimeUtil,T=n(7).Data,M={name:"com.servicemax.client.sync.targetedsyncdataapi"},I=M,C=b,A=void 0;(0,v.default)(I,S,y),M.TargetedSync=function(e){function t(){(0,c.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e._getValueFromClientCache("TARGETED_SYNC_AFTERUPDATE",function(t){t?(A=g.toObject(t),e.__eventTypes=[]):e.__eventTypes=[{PUT_DELETE:"TargetedSyncPutDelete"},{PUT_INSERT:"TargetedSyncPutInsert"},{PUT_UPDATE:"TargetedSyncPutUpdate"},{REFERENCE_DATA:"TargetedSyncReferenceData"}]}),e}return(0,p.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this._getLastSyncTime("UPDATE",function(t){e._getSmartSyncTimeStamps(function(n){e.getTargetedSyncRequest(t,n,function(t){e._request=t,t=g.cloneObject(t),e.__logger.info("TS Log: request : "+g.toJSON(t)),t.data.valueMap.length>2||A?e._initHTTPServiceRequest(t,{handler:e.responseHandler,context:e}):(e._complete(),e.__logger.info("TS Log: no data to send, cancelling request"),e.complete())})})})}},{key:"getTargetedSyncRequest",value:function(e,t,n){var i=this._getClientId(),a=g.toJSON(t),r="TARGETED_SYNC",o={methodName:"DataSyncRequest",data:{eventType:"SYNC",eventName:r,value:i,values:[],valueMap:[{key:"LAST_SYNC_TIME",value:e},{key:"TS_KEYS",value:a}]}};if(this.__syncEvents={},A)E.deleteFromDBCache("TARGETED_SYNC_AFTERUPDATE"),o.data.valueMap.push(A),n.call(this,o);else{var s=this._getRequest("PUT_DELETE",e,i,r);s&&o.data.valueMap.push(s);var l=this._getRequest("PUT_INSERT",e,i,r);l&&o.data.valueMap.push(l);var c=this._getRequest("PUT_UPDATE",e,i,r);c&&o.data.valueMap.push(c);var u=this._getRequest("CLIENT_OVERRIDES",e,i,r);if(u)if(c)for(var d=u.lstInternal_Request[0].valueMap,_=0,h=d.length;_<h;_++){var f=d[_];c.lstInternal_Request[0].valueMap.push(f)}else this.__syncEvents.PUT_UPDATE=this.__syncEvents.CLIENT_OVERRIDES,u.key="PUT_UPDATE",o.data.valueMap.push(u);var p=this._getState("TARGETED_SYNC.SERVER_OVERRIDES");if(p){var m={};m.key="SERVER_OVERRIDE",m.valueMap=p,o.data.valueMap.push(m)}var v=this._getState("TARGETED_SYNC_REF");v&&o.data.valueMap.push(v),l?this.isSyncBreakRequired(g.proxy(this,function(e){e&&(this._syncBreak=!0,l.lstInternal_Request[0].valueMap.push({key:"After_Insert_Web_Service",value:"true"})),n.call(this,o)})):c?this._triggerWebserviceActions(["BeforeUpdate"],function(){n.call(this,o)}):n.call(this,o)}}},{key:"responseHandler",value:function(e){if(this.__logger.info("TS Log: responseHandler : "+g.toJSON(e)),null===e||e&&null===e.success||e&&!1===e.success)this._clearAllCache(this),this._complete(),this.__logger.info("TS Log: no response"),this.complete();else{var t=this;t.__response=this._parseResponse(e),t.__eventConfig=g.cloneObject(this.__eventTypes);var n=function(){var e=[];if(t.__response){var n=void 0;if(t.__response.PUT_INSERT&&t.__response.PUT_INSERT.valueMap){n=t.__response.PUT_INSERT.valueMap;for(var i=0;i<n.length;i++){"ERROR"===n[i].key&&(e=e.concat(n[i].valueMap))}}if(t.__response.PUT_UPDATE&&t.__response.PUT_UPDATE.valueMap){n=t.__response.PUT_UPDATE.valueMap;for(var a=0;a<n.length;a++){var r=n[a].key;"CONFLICT"!==r&&"ERROR"!==r||(e=e.concat(n[a].valueMap)),"DELETED_IDS"===r&&t._handleDeletedIds(n[a].valueMap)}}}return e}();if(t.__response&&t.__response.CONFLICT&&t.__response.CONFLICT.valueMap&&t._handleConflicts(t.__response.CONFLICT.valueMap),t.__response&&n&&n.length&&t._handleConflicts(n),t.__response&&t.__response.DELETED_IDS&&t._handleDeletedIds(t.__response.DELETED_IDS.valueMap),t.__response&&t.__response.PUT_DELETE){var i=t.__response.PUT_DELETE.valueMap,a=[],r=[];if(i)for(var o=0;o<i.length;o++)"DELETED_IDS"===i[o].key&&(a=i[o].valueMap),"CONFLICT"!==i[o].key&&"ERROR"!==i[o].key||(r=i[o].valueMap);t._handleDeletedIds(a),t._handleConflicts(r,!0)}if(t.__response&&t.__response.INSERTED_IDS&&t._handleInsertedIds(t.__response.INSERTED_IDS.valueMap),t.__response&&t.__response.PUT_INSERT){var s=t.__response.PUT_INSERT.valueMap,l=void 0;if(s)for(var c=0;c<s.length;c++)if("INSERTED_IDS"===s[c].key){l=s[c].valueMap;break}t._handleInsertedIds(l)}if(t.__response.ATTACHMENTS&&t.__response.ATTACHMENTS.valueMap){var u=t.__response.ATTACHMENTS.valueMap;u.length&&"DELETED_ATTACHMENT_IDS"===u[0].key&&t._handleDeletedIds([u[0]],"Attachment")}if(t.__response.DELETED_FILES&&t.__response.DELETED_FILES.key&&"DELETED_FILES"===t.__response.DELETED_FILES.key&&t.__response.DELETED_FILES.valueMap){for(var d=t.__response.DELETED_FILES.valueMap,_=d.length,h=0;h<_;h++)if(d[h].key&&"ContentDocumentLink"===d[h].key&&t.__response.DELETED_FILES.valueMap[h].value){var f=t.__response.DELETED_FILES.valueMap[h].value,p=g.toObject(f);p&&p.length>0&&T.deleteSfFileRelatedTables(p,null,!1)}d.length&&"DELETED_ATTACHMENT_IDS"===d[0].key&&t._handleDeletedIds([d[0]],"Attachment")}if(t.__response.CHECKLIST&&t.__response.CHECKLIST.valueMap)for(var m=t.__response.CHECKLIST.valueMap,v=0;v<m.length;v++){var y=void 0;switch(m[v].key){case"DELETED_CHECKLIST_IDS":y=g.getCustomObjectName("CHECKLIST");break;case"DELETED_CHECKLIST_ATTACHMENT_IDS":y=g.getCustomObjectName("SM_Checklist_Attachment");break;case"DELETED_ATTACHMENT_IDS":y="Attachment";break;case"DELETED_CDL_IDS":y="ContentDocumentLink"}if("ContentDocumentLink"===y&&"DELETED_CDL_IDS"===m[v].key&&m[v].value){var S=m[v].value,E=g.toObject(S);E&&E.length>0&&T.deleteSfFileRelatedTables(E,null,!1)}else t._handleDeletedIds([m[v]],y)}t.__response&&t.__response.TX_FETCH?t._handleTXFetchResponse(t):t._deleteCurrentTargetedSyncLogRecords(t)}}},{key:"_handleConflicts",value:function(e,t){this._complete();for(var n=this,i=e,a=[],r="conflict",o=n._getState("TargetedSyncLogRecords")||[],s=0;s<i.length;s++){var l=i[s];if(l&&l.value&&l.valueMap){var c=l.value;"FIELD_CUSTOM_VALIDATION_EXCEPTION"===c.slice(0,33)&&(r="error",c=c.slice(34,c.length),c="Error: ".concat(c));for(var u=l.valueMap,d=0;d<u.length;d++){var _=u[d];if(_.value){n.conflictedIds=n.conflictedIds||[],n.conflictedIds.push(_.value);var h=o.indexOf(_.value);-1!==h&&o.splice(h,1);var f=t?"delete":"update";_.value.indexOf("local")>0&&(f="insert"),a.push({Id:_.value,operation:f,error_type:r,error_message:c,override_flag:""})}}}}n._setState("TargetedSyncLogRecords",o),a.length>0?function(){for(var e=0,t=0;t<a.length;t++)!function(t){e++,n.__getParentIdForConflictRecord(a[t].Id,function(i){var r=a[t];r.parent_id=i,n.__insertUpdateSyncConflictForTargetedSync(r,function(){0===--e&&(n.__logger.info("TS Log: conflict occured"),n.complete())})})}(t)}():(n.__logger.info("TS Log: conflict occured but not data"),n.complete())}},{key:"_handleDeletedIds",value:function(e,t){if(this._complete(),e)for(var n=0;n<e.length;n++){var i=e[n];if(i&&i.value){var a=i.value,r=g.toObject(a);t&&(this._deleteRecord(t,r),"Attachment"===t&&this._deleteAttachmentFile(r));for(var o=0;o<r.length;o++){var s=r[o];t||this._deleteRecordById(s),this._deleteSyncConflict(s),this._deleteSyncRecord(s)}this._deleteRecentItems(r),this._deleteWebserviceActionsLog(r)}}}},{key:"_handleInsertedIds",value:function(e){var t=[],n={},i=[];if(e)for(var a=0;a<e.length;a++){var r=e[a];if(r&&r.key&&r.value){var o=r.key;t.push(o);var s=r.value,l=g.toObject(s);n[o]=n[o]||{};var c=this._getState("TargetedSyncLogRecords")||[];for(var u in l){var d=l[u];n[o][u]=d,this._updateSFIDForInsertedRecords(u,d,o),this.__updateParentIDInClientSyncTable(u,d);var _=c.indexOf(u);-1!==_&&(i.push(c[_]),c[_]=d);var h=E.readFromJSCache("TARGETEDSYNC","recordId");h&&h===u&&E.writeToJSCache("TARGETEDSYNC","recordId",d)}this._setState("TargetedSyncLogRecords",c),this._setState("TargetedSyncInsertedRecords",i)}}this.__processResult(n,"TARGETED_SYNC",t)}},{key:"__updateParentIDInClientSyncTable",value:function(e,t){var n="UPDATE ClientSyncLog set parent_id = '"+t+"' where parent_id = '"+e+"'",i={query:n};this._initSQLServiceRequest(i,{handler:function(e){}})}},{key:"_handleTXFetchResponse",value:function(e){var t=this;this.updatedAttachmentIds=[],this.updatedSFileCVIds=[];var n=e.__response.TX_FETCH.valueMap,i={};if(n)for(var a=0;a<n.length;a++){var r=n[a];if(r&&r.key)if("DELETED_IDS"===r.key)this._handleDeletedIds(r.valueMap);else if("ContentDocumentLink"===r.key&&r.value){var o=g.toObject(r.value);e._handleTxFetchForSFiles(i,o)}else if(r.value){var l=g.toObject(r.value);if(l&&(0,s.default)(l).length>0){var c=r.key,u=i[c];u||(u=[]),u.push(l),i[c]=u}}}var d=0;if((0,s.default)(i).length>0)for(var _ in i)d++,e._processTargetSyncTXFetchResult(_,i[_],e,function(){0===--d&&(t.updatedAttachmentIds.length&&e._updateLocalAttachments(t.updatedAttachmentIds),t.updatedSFileCVIds.length>0?(t.__serviceRequestCount++,e._updateLocalSFiles(t.updatedSFileCVIds).done(function(){t.__serviceRequestCount--,e._deleteCurrentTargetedSyncLogRecords(e)})):e._deleteCurrentTargetedSyncLogRecords(e))});else this.__logger.info("TS Log: txfetch key exists but not data"),e._deleteCurrentTargetedSyncLogRecords(e)}},{key:"_handleTxFetchForSFiles",value:function(e,t){if(t&&t.length>0){for(var n=[],i=[],a=t.length,r=0;r<a;r++){var o=t[r];if(o&&o.ContentDocument){var s=o.ContentDocument;s&&s.LatestPublishedVersion&&(n.push(s.LatestPublishedVersion),i.push(s))}}e.ContentVersion=[n],e.ContentDocument=[i],e.ContentDocumentLink=[t]}}},{key:"_processTargetSyncTXFetchResult",value:function(e,t,n,i){t&&t[0]||i&&i.call(n),t=t[0],this.conflictedIds=this.conflictedIds||[];var a=[],r={},o=[];for(var s in t){var l=g.toObject(t[s]);if(l&&-1===this.conflictedIds.indexOf(l.Id)){l.attributes.type;delete l.attributes,a.push(l),r[l.Id]=l,o.push(l.Id)}}"Attachment"===e&&(this.updatedAttachmentIds=this.updatedAttachmentIds.concat(o)),"ContentVersion"===e&&(this.updatedSFileCVIds=this.updatedSFileCVIds.concat(o)),n._insertReplaceRecordIncremental(e,a,!0,i)}},{key:"_deleteCurrentTargetedSyncLogRecords",value:function(e){if(e.__response.LAST_SYNC_TIME&&e.__response.TS_RECORD_IDS){var t=e.__response.LAST_SYNC_TIME.value;if(t){t=C.getDatetimeInServerFormat(t);var n=[];n=e.__response.TS_RECORD_IDS.values,n&&n.length>0&&e._saveTargetSyncRecordTimeStamps(n,t)}}var i=e._getState("TargetedSyncLogRecords");e._deleteTargetedSyncRecords(i),e._checkIfAfterUpdateExists(i,function(t){t?e._triggerWebserviceActions(["AfterInsert","AfterUpdate"],function(){setTimeout(function(){var t=e._getState("TARGETED_SYNC_REF");if(t){E.writeToDBCache("TARGETED_SYNC_AFTERUPDATE",g.toJSON(t)),e.complete();g.getCurrentApplication().getSyncImpl().performTargetedSync(!0)}else e._completeTargetedSync(e)},2e3)}):e._completeTargetedSync(e)})}},{key:"_completeTargetedSync",value:function(e){var t=this;e._clearAllCache(e),e._getState("RECURSIVE_DATA_SYNC")?(this.__logger.info("TS Log: recursive data sync triggered"),e.getSyncManager().triggerRecursiveDataSync(function(){e._setState("RECURSIVE_DATA_SYNC",!1),t.__logger.info("TS Log: current call complete"),e.complete()})):(this.__logger.info("TS Log: current call complete"),e.complete())}},{key:"_clearAllCache",value:function(e){A=null,e._setState("TargetedSyncLogRecords",null),e._setState("TargetedSyncInsertedRecords",null),e._setState("TARGETED_SYNC_REF",null)}}]),t}(I.TargetedSyncEvent),M.TargetedSyncPutInsert=function(e){function t(){return(0,c.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this._getTargetedSyncHeaderId(function(t){e._getTargetedSyncRecords("insert",t,null,function(t){e._saveCurrentSynclogRecords(t.ids),e.__syncRecords=t,function e(){var n=t.byOrder.shift();n&&this._syncPutInsert(t,n,"TARGETED_SYNC",function(){e.call(this)})}.call(e)})})}}]),t}(I.TargetedSyncEvent),M.TargetedSyncPutUpdate=function(e){function t(){return(0,c.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this._getValueFromClientCache("TARGETED_SYNC_SOU",function(t){E.deleteFromDBCache("TARGETED_SYNC_SOU");e._getLastSyncTime("UPDATE",function(n){e._getSyncConflicts("update",function(i){e.getIsFieldMergeEnabled(function(a){e._setState("IsFieldMergeEnabled",a),e._getTargetedSyncHeaderId(function(r){e._getTargetedSyncRecords("update",r,t,function(t){e._saveCurrentSynclogRecords(t.ids),e._filterUnsyncableRecords(t)&&e._setState("RECURSIVE_DATA_SYNC",!0),e._syncPutUpdate(t,i,n,a,"TARGETED_SYNC")}),e._syncResolveConflicts(i,n,a,"TARGETED_SYNC")})})})})})}}]),t}(I.TargetedSyncEvent),M.TargetedSyncPutDelete=function(e){function t(){return(0,c.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this._getSyncConflicts("delete",function(t){e._syncResolveConflictsForDelete(t,function(){e._getTargetedSyncHeaderId(function(t){e._getTargetedSyncRecordsByObjectOrder("delete",t,e._syncPutDelete)})})})}}]),t}(I.TargetedSyncEvent),M.TargetedSyncReferenceData=function(e){function t(){return(0,c.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,h.default)(t,[{key:"trigger",value:function(){var e=this;this._getTargetedSyncHeaderId(function(t){t.includes("local")||e._getTargetedSyncReferenceData(t,function(t){e._setState("TARGETED_SYNC_REF",t)})})}},{key:"_getTargetedSyncReferenceData",value:function(e,t){var n=this,i="TARGETED_SYNC_REFERENCE."+e;this._getValueFromClientCache(i,function(a){if(a){var r=a.split(".");if(2===r.length){var o=r[0],s=r[1];n._getProcessComponentObjects(o,function(a){n._getExcludedIds(function(r){var o={};o.key=s,o.value=e,o.values=a,E.deleteFromDBCache(i);var l={};l.key="EXCLUDED_IDS",l.valueMap=r;var c={};c.key="REFERENCE_DATA",c.valueMap=[],c.valueMap.push(o),c.valueMap.push(l),t&&t.call(n,c)})})}else t&&t.call(n,null)}else t&&t.call(n,null)})}}]),t}(I.TargetedSyncEvent),g.defineGlobal(M.name,M),e.exports=M},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(7).SystemData,n(13).Operation),m=n(11).Facade,v=n(5).SVMXObject,g=n(7).Expressions,y=n(7).ServerInfo,S={name:"com.servicemax.client.offline.sal.model.sfmopdocdelivery.operations"},E=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};S.GetUserInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils");t.result(n.getUserInfo())}}]),t}(p),S.GetTemplate=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils"),i={ProcessId:e.processId},a={ProcessId:i.ProcessId};n.getTemplate(a,function(e){t.result(e)})}}]),t}(p),S.GetDocumentMetadata=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils"),i={ProcessId:e.processId},a={ProcessId:i.ProcessId};n.getDocumentMetaData(a,function(e){t.result(e)})}}]),t}(p),S.CreatePDF=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e.documentId,e.recordId}}]),t}(p),S.DescribeObject=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils").describeObject(e,t).always(f.proxy(this,function(e){t.result(e)}))}}]),t}(p),S.GetDocumentData=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils"),i={ProcessId:e.processId,RecordId:e.recordId},a={ProcessId:i.ProcessId,RecordId:i.RecordId};setTimeout(function(){n.getDocumentData(a,function(e){t.result(e)})},100)}}]),t}(p),S.CaptureSignature=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.getClient().getApplicationParameter("svmx-sfm-opdoc-sig-capture"),i=m,a=i.createSignatureDeviceCheckRequest(),r=void 0;a.bind("REQUEST_COMPLETED",function(e){r=e.data.data},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger("deviceCheckRequest Failed: "+e.data),console.warn("error"+e.data)}),a.execute({async:!1});var o=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils"),s={recordId:e.recordId,processId:e.processId,uniqueName:e.uniqueName,captureSignature:e.captureSignature,imgHeight:e.imgHeight,imgWidth:e.imgWidth,signatureTitle:e.signatureTitle};setTimeout(function(){!n||"html"!==n||void 0!==r&&"False"!==r?o.captureDeviceSignature(s,function(e){t.result(e)}):o.captureHtmlSignature(s,function(e){t.result(e)})},100)}}]),t}(p),S.Finalize=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n={ProcessId:e.processId,RecordId:e.recordId,HTMLContent:e.htmlContent,SourceRecord:e.sourceRecord,MappedRecordIds:e.mappedRecordIds},i=this,a=e.requestClose,r=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils"),o=f.getClient().getApplicationParameter("svmx-mobile"),s=function(){var t=f.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.NOTIFY_DATA_CHANGE",i,{request:{processId:e.processId,recordId:e.recordId}});f.getCurrentApplication().triggerEvent(t),a.handler.apply(a.context)};if(o&&"true"==o&&!1===f.getClient().isLaptop()){r.finalizeRemote(n,function(e,t){f.getLoggingService().getLogger("OFFLINE-SAL-MODEL-PlatformSpecifics").info("PDF Generated Successfully!"),s(),i._performAggressiveSync(t)},i)}else{r.finalizeLocal(n,function(e,t){f.getLoggingService().getLogger("OFFLINE-SAL-MODEL-PlatformSpecifics").info("PDF Generated Successfully!"),s(),i._performAggressiveSync(t)},i)}}},{key:"_performAggressiveSync",value:function(e){var t=f.getCurrentApplication().getSyncImpl(),n=t.getAggressiveSyncType(e);y.getMultiServerVersionRequest().runTargetedSyncForChecklistAndOpdoc()||(n="full sync"),"smart sync"===n?t.performTargetedSync(!1):t.performAggressiveSync()}}]),t}(p),S.SubmitQuery=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"_performInternal",value:function(e,t,n){var i=f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils"),a=e.queryConfig,r="SELECT "+a.fields+" FROM "+a.api;a.condition&&""!=a.condition&&(r+=" WHERE "+a.condition);var o={Query:r};i.submitQuery(o,function(e){t.call(n,e)})}},{key:"performAsync",value:function(e,t){}}]),t}(p),S.GetDisplayTags=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};t.result({SFM004_TAG003:n().T("FSA005_TAG006","This record does not meet the qualification criteria for this Output Document"),SFM004_TAG006:n().T("FSA005_TAG007","Finalize"),SFM004_TAG009:n().T("FSA005_TAG008","Checklist result for"),SFM004_TAG010:n().T("FSA005_TAG009","Section"),SFM004_TAG011:n().T("FSA005_TAG010","Question"),SFM004_TAG012:n().T("FSA005_TAG011","Answer"),FSA005_TAG017:n().T("FSA005_TAG017","This report may exceed the maximum allowed size and continuing this operation will remove some images in the report.\nDo you wish to continue or cancel?"),FSA005_TAG018:n().T("FSA005_TAG018","NO PREVIEW AVAILABLE")})}}]),t}(p),S.PlatformSpecifics=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getQualificationInfo",value:function(e,t,n,i){g.evaluate({recordId:e,processId:t,returnMessage:!0,onSuccess:f.proxy(this,function(e){0==e[0].result&&f.getCurrentApplication().getRoot().hideLoading();var t={isSFMProcess:!0,isQualified:e[0].result,errorMessage:!0===e[0].result?"":e[0].message||function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA005_TAG006","This record does not meet the qualification criteria for this Output Document")};n.call(i,t)}),onError:f.proxy(this,function(e){f.getLoggingService().getLogger("OFFLINE-SAL-MODEL-PlatformSpecifics").error("IGNORING ERROR: Failed to get expressions in GetObjectData"),n.call(i,{isSFMProcess:!0,isQualified:!0})})})}},{key:"alert",value:function(e,t){f.getCurrentApplication().showMessage({type:"INFO",title:" ",text:e,buttons:[{text:E().T("FSA016_TAG003","OK"),itemId:"OK",handler:function(e){t.handler.apply(t.context)}}]})}},{key:"confirm",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){if(!t||"function"!=typeof t)return confirm(e);f.getCurrentApplication().showMessage({type:"INFO",title:" ",text:e,buttons:[{text:E().T("FSA010_TAG141","Continue"),itemId:"OK",handler:function(e){t(!0)}},{text:E().T("FSA016_TAG004","Cancel"),itemId:"Cancel",handler:function(e){t(!1)}}]})})},{key:"navigateBack",value:function(e){}},{key:"getSettingsInfo",value:function(){return{}}}]),t}(v),f.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m={name:"com.servicemax.client.offline.sal.model.sfchatterfeedutils"};m.FeedInfoParser=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,null,[{key:"parse",value:function(e){if(e&&e.feedItems){var t={feedItems:[]};return this._validateStructure(e),e.feedItems.forEach(function(e){var n={id:e.id,message:{text:e.body.text,segments:e.body.messageSegments},user:{id:e.actor.id,displayName:e.actor.displayName},timestamps:{createdDate:e.createdDate,modifiedDate:e.modifiedDate,relativeCreatedDate:e.relativeCreatedDate,editedDate:e.capabilities.edit.lastEditedDate,relativeLastEditedDate:e.capabilities.edit.relativeLastEditedDate},comments:[]};e.capabilities.comments.page.items.forEach(function(e){n.comments.push({id:e.id,message:{text:e.body.text,segments:e.body.messageSegments},user:{id:e.user.id,displayName:e.user.displayName},timestamps:{createdDate:e.createdDate,relativeCreatedDate:e.relativeCreatedDate,editedDate:e.capabilities.edit.lastEditedDate,relativeLastEditedDate:e.capabilities.edit.relativeLastEditedDate}})}),t.feedItems.push(n)}),t}}},{key:"addComment",value:function(e,t){if(e&&e.feedItems&&t&&t.feedElement){this._validateStructure(e);for(var n=0,i=e.feedItems.length;n<i;n++)if(e.feedItems[n].id==t.feedElement.id){e.feedItems[n].capabilities.comments.page.items.push(t);break}}}},{key:"_validateStructure",value:function(e){e.feedItems.forEach(function(e){e.body||(e.body={}),e.actor||(e.actor={}),e.capabilities||(e.capabilities={}),e.capabilities.edit||(e.capabilities.edit={}),e.capabilities.comments||(e.capabilities.comments={}),e.capabilities.comments.page||(e.capabilities.comments.page={}),e.capabilities.comments.page.items||(e.capabilities.comments.page.items=[]),e.capabilities.comments.page.items.forEach(function(e){e.body||(e.body={}),e.user||(e.user={}),e.capabilities||(e.capabilities={}),e.capabilities.edit||(e.capabilities.edit={})})})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=(n(10),n(0).utils),v=n(5).ModuleActivator,g=n(398).PREF_LOGGING,y=n(5).AbstractApplication,S=n(12).DatetimeUtil,E=n(5).SVMXObject,b={name:"com.servicemax.client.sfmconsole.impl"},T=void 0;b.Module=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e._logger=m.getLoggingService().getLogger("CONSOLE-IMPL"),b.Module.instance=e,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){b.init(),b.init(),b.init(),b.init(),b.init()}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){m.getClient().getServiceRegistry().getService("com.servicemax.client.preferences").getInstance().addPreferenceKey(g)}}]),t}(v);var M=m.getClient().getApplicationParameter("org-name-space");M&&""!==M||(M="SVMXDEV"),m.OrgNamespace=M,m.navigateToCheckExternal=function(e,t){e&&!e.startsWith("/")&&(e="/home/home.jsp"),navigateTo?navigateTo(e,t):m.navigateTo(e)},m.getCustomFieldName=function(e){return m.OrgNamespace+"__"+e+"__c"},m.getCustomObjectName=function(e){return m.OrgNamespace+"__"+e+"__c"},m.getCustomRelationName=function(e){return m.OrgNamespace+"__"+e+"__r"},m.getTempTableName=function(e){return"TEMP__"+e},b.Module.instance=null,b.Application=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return e.__parent=b.Module.instance,e.__logger=m.getLoggingService().getLogger("CONSOLE-IMPL"),e.__notificationService=m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.notifications"),e.__consoleAppConfigs={},e.__runningConsoleAppsByAppId={},e.__runningConsoleAppsByWindowId={},e.__launchingConsoleAppsById={},e.__namedInstanceService=null,e.__stateHandlers={applicationStateHandler:null,applicationErrorHandler:null,applicationMessageUIHandler:null,applicationQuickMessageHandler:null},e.__userInfo=null,e.__view=null,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFMConsoleApplication").warn("SFMConsole event triggered: "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}},{key:"beforeRun",value:function(e){var t=m.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("SFMCONSOLE.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{}})},context:this})},context:this,additionalParams:{eventBus:this}})}},{key:"run",value:function(){}},{key:"__runConsole",value:function(){}},{key:"__loadTags",value:function(e){var t=m.getClient(),n=t.getDeclaration("com.servicemax.client.sfmconsole.translation-tags"),i=t.getDefinitionsFor(n)||[],a=m.array.map(i,function(e){return e.config}),r=m.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.RETRIEVE_DISPLAY_TAGS",this,{request:{moduleIds:a},responder:m.create("com.servicemax.client.sfmconsole.commands.RetrieveDisplayTagsResponder",this,e)});this.triggerEvent(r)}},{key:"onRetrieveDisplayTags",value:function(e,t,n){T=e.getDictionary("FSA");var i=m.create("com.servicemax.client.lib.api.Event","DISPLAY_TAGS_LOADED",this);m.getClient().triggerEvent(i),n.call()}},{key:"getAppConfig",value:function(e){return this.__consoleAppConfigs[e]}},{key:"getRoot",value:function(){return this.__root}},{key:"forEachConsoleApp",value:function(e){m.forEachProperty(this.__runningConsoleAppsByWindowId,function(t,n){e(n)})}},{key:"getCurrentConsoleApp",value:function(){throw"Application subclass must implement getCurrentConsoleApp"}},{key:"findConsoleAppByAppId",value:function(e){return this.__runningConsoleAppsByAppId[e]}},{key:"findConsoleAppByWindowId",value:function(e){return this.__runningConsoleAppsByWindowId[e]}},{key:"showConsoleApp",value:function(e){throw"Subclass must implement showConsoleApp"}},{key:"launchConsoleApp",value:function(e,t){if(this.consoleAppLaunching(e))return!1;t=t||{};var n=void 0,i=this.getAppConfig(e),a=!!i&&!i.multiple;a&&(n=this.findConsoleAppByAppId(e)),a&&n?(t.context=this,n.show()):(n=this.createConsoleApp(e,t))&&(t.context=this,n.show(),n.__start(t)),this.consoleAppLaunched(e)}},{key:"createConsoleApp",value:function(e,t){var n=void 0,i=this.getAppConfig(e),a=!!i&&!i.multiple;if(i){t.isClosable=!a;try{n=this.__createConsoleAppInternal(e,t),this.__runningConsoleAppsByAppId[n.getAppTypeId()]=n,this.__runningConsoleAppsByWindowId[n.getId()]=n}catch(e){return this.__logger.error(e),!1}}else this.__logger.error("Console App Not Defined: "+e);return n}},{key:"consoleAppLaunching",value:function(e){if(!this.__launchingConsoleAppsById[e]){var t=this;return setTimeout(function(){t.__launchingConsoleAppsById[e]=null},1e3),!1}return!0}},{key:"consoleAppLaunched",value:function(e){this.__launchingConsoleAppsById[e]=!0}},{key:"__createConsoleAppInternal",value:function(e,t){return m.create(this.getAppConfig(e).app["class-name"],{parent:this,rootContainer:this.__root,appConfig:this.getAppConfig(e),options:t})}},{key:"closeClosableApps",value:function(){m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").clearCachedStates(),this.forEachConsoleApp(m.proxy(this,function(e){e.__appConfig.multiple&&this.destroyConsoleApp(e)}))}},{key:"applyAppInfo",value:function(e,t){}},{key:"__getSyncImpl",value:function(){if(!this.__syncImpl){var e=m.getClient().getDeclaration("com.servicemax.client.sfmconsole.synchronizer"),t=m.getClient().getDefinitionsFor(e);if(0===t.length)return void this.__logger.error("Unable to load console synchronizer");var n=t[0].config.impl["class-name"];this.__syncImpl=m.create(n,this)}return this.__syncImpl}},{key:"getSyncImpl",value:function(){return this.__syncImpl}},{key:"changeApplicationState",value:function(e){switch(e.state){case"BLOCK":this.showSpinner();break;case"UNBLOCK":this.hideSpinner()}}},{key:"showSpinner",value:function(e,t){this.__notificationService?this.__notificationService.waitingMessage(e,t):this.__logger.error("showSpinner failed because there is no notification service")}},{key:"hideSpinner",value:function(e){this.__notificationService&&this.__notificationService.endWaitingMessage(e)}},{key:"runManualSyncBackground",value:function(){this.__getSyncImpl().performSync("ONECALLSYNC")}},{key:"getUserInfo",value:function(){return m.cloneObject(this.__userInfo)||{}}},{key:"setUserInfo",value:function(e){if(e){var t=e&&!this.__userInfo||e&&this.__userInfo&&this.__userInfo.UserSessionId!=e.UserSessionId;this.__userInfo=e,void 0===this.__userInfo.TimezoneOffset&&(this.__userInfo.TimezoneOffset=S.getLocalUTCOffsetString());var n=S;if(n.setDateFormat(e.DateFormat),n.setTimeFormat(e.TimeFormat),n.setTimezoneOffset(e.TimezoneOffset),e.Timezone?n.setTimezone(e.Timezone):n.setTimezoneOffset(e.TimezoneOffset),t){var i=m.create("com.servicemax.client.lib.api.Event","GLOBAL.HANDLE_USER_INFO",this,e);m.getClient().triggerEvent(i)}}}},{key:"closeConsoleApp",value:function(e){e&&e.onCanClose(m.proxy(this,function(t){!0===t&&this.destroyConsoleApp(e)}))}},{key:"destroyConsoleApp",value:function(e){e&&(e.onClose(),this.__root.manageConsoleAppContainerClose(e),delete this.__runningConsoleAppsByWindowId[e.getId()],this.__runningConsoleAppsByAppId[e.getAppTypeId()]==e&&delete this.__runningConsoleAppsByAppId[e.getAppTypeId()],e.doCleanup())}},{key:"goToHome",value:function(){this.__openFirstConsoleApp(!0)}},{key:"__getFirstConsoleApp",value:function(){var e=m.getClient().getApplicationParameter("sfmconsole-runtime-start")||null;return e&&""!==e?e:(this.__logger.error("sfmconsole-runtime-start is not set in application config."),!1)}},{key:"__openFirstConsoleApp",value:function(){var e=this.__getFirstConsoleApp();e&&this.launchConsoleApp(e,{})}},{key:"__startIncrementalReSync",value:function(){!window.cordova&&this.__userInfo&&this.__userInfo.reSync&&this.runManualSyncBackground()}},{key:"setApplicationStateHandler",value:function(e){this.__stateHandlers.applicationStateHandler=e}},{key:"getApplicationStateHandler",value:function(){return this.__stateHandlers.applicationStateHandler||this}},{key:"setApplicationErrorHandler",value:function(e){this.__stateHandlers.applicationErrorHandler=e}},{key:"getApplicationErrorHandler",value:function(){return this.__stateHandlers.applicationErrorHandler||this}},{key:"setApplicationMessageUIHandler",value:function(e){this.__stateHandlers.applicationMessageUIHandler=e}},{key:"getApplicationMessageUIHandler",value:function(){return this.__stateHandlers.applicationMessageUIHandler||this}},{key:"setApplicationQuickMessageHandler",value:function(e){this.__stateHandlers.applicationQuickMessageHandler=e}},{key:"getApplicationQuickMessageHandler",value:function(){return this.__stateHandlers.applicationQuickMessageHandler||this}},{key:"showQuickMessage",value:function(e,t,n){this.__notificationService?this.__notificationService.quickMessage(e,t,n):this.__logger.error("showQuickMessage failed because there is no notification service")}},{key:"notifyApplicationError",value:function(e){if(this.__notificationService){var t=T.T("FSA007_TAG005","Error Message");this.__notificationService.errorMessage(e,t)}else this.__logger.error("notifyApplicationError failed because there is no notification service")}},{key:"showMessage",value:function(e){var t=void 0;return this.__notificationService?(e.title||(e.title=T.T("FSA007_TAG006","Information")),t=this.__notificationService.showMessage(e)):this.__logger.error("showMessage failed because there is no notification service"),t}},{key:"checkForMessageId",value:function(e){return!(!this.__notificationService||!this.__notificationService.checkForMessageId(e))}}]),t}(y),b.CompositionEngine=function(e){function t(e,n){(0,c.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return i.__metamodel=e,i.__parent=n,i}return(0,p.default)(t,e),(0,d.default)(t,[{key:"compose",value:function(){var e=this.__parent.__self.composition;return this.__composeInternal(this.__metamodel,e,this.__parent)}},{key:"__composeInternal",value:function(e,t,n){var i=t.length,a=void 0;for(a=0;a<i;a++){var r=t[a],o=e.getChildNode(r.name);if(o){var s=null,l=r.className;o instanceof Array==!1&&(o=[o]);var c,u,d=o.length;for(c=0;c<d;c++)u=o[c],u.title&&(u.title=Ext.String.htmlEncode(u.title)),s=m.create(l,{compositionMetamodel:u}),void 0!==s.__self.composition&&this.__composeInternal(u,s.__self.composition,s),n.onCompositionChildCreate(s,r.name)}}}}]),t}(E),m.defineGlobal(b.name,b),e.exports=b},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(4),d=i(u),_=n(0).utils,h=n(5).SVMXObject,f={name:"com.servicemax.client.sfmconsole.constants"};f.Constants=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),t}(h),f.Constants.PREF_LOGGING="LOGGING",_.defineGlobal(f.name,f),e.exports=f},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(10),v=n(0).utils,g=n(5).SVMXObject,y=n(13).Responder,S=n(5).EventDispatcher,E=n(0).api,b={name:"com.servicemax.client.sfmconsole.utils"};b.Translation=function(e){function t(e,n){(0,c.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return i.__data={},i.__data=i.__convertData(e),i.__parent=n,i}return(0,p.default)(t,e),(0,d.default)(t,[{key:"__convertData",value:function(e){var t={};if(m.isArray(e)){var n=void 0,i=e.length;for(n=0;n<i;n++)t[e[n].Key]=e[n].Value}else t=e;return t}},{key:"replaceData",value:function(e){e=this.__convertData(e),m.extend(this.__data,e)}},{key:"getTagArray",value:function(){var e=[];return v.forEachProperty(this.__data,function(t,n){e.push({Key:t,Value:n})}),e}},{key:"isEmpty",value:function(){for(var e in this.__data)return!1;return!0}},{key:"T",value:function(e,t){return e.match(/\./)?this.__parent.T(e,t):e in this.__data?this.__data[e]:t||""}}]),t}(g),b.TranslationService=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return e.__data={},e.__hasData=!1,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"addData",value:function(e,t){this.__hasData=!0,this.__data[t]?this.__data[t].replaceData(e):this.__data[t]=new b.Translation(e,this)}},{key:"setData",value:function(e){var t={};v.array.forEach(e,function(e){t[e.module_id]||(t[e.module_id]={}),t[e.module_id][e.tag_id]=e.value});var n=t.COMMON||{};v.forEachProperty(t,v.proxy(this,function(e,t){m.extend(t,n),this.addData(t,e)}))}},{key:"isEmpty",value:function(){return!this.__hasData}},{key:"getDictionary",value:function(e){return this.__data[e]||(this.__data[e]=new b.Translation({},this)),this.__data[e]}},{key:"T",value:function(e,t){var n=e.indexOf("."),i=e.substring(0,n);e=e.substring(n+1);var a=this.getDictionary(i);return a?a.T(e,t):t}}]),t}(g),b.EventCollection=function(e){function t(e,n){(0,c.default)(this,t);var i=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));i.__eventBus=e,i.__eventItems=[],i.__stackIndex=0;for(var a=0;a<n.length;a++){var r=v.create("com.servicemax.client.sfmconsole.utils.EventCollectionItem",n[a]);i.__eventItems[a]=r,i.__eventItems[a].itemParent=i}return i.__handler=null,i.__context=null,i}return(0,p.default)(t,e),(0,d.default)(t,[{key:"doCleanup",value:function(){return this.setPropertyForCleanup("__eventItems"),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"doCleanup",this).call(this)}},{key:"addEvent",value:function(e){var t=v.create("com.servicemax.client.sfmconsole.utils.EventCollectionItem",e);this.__eventItems[this.__eventItems.length]=t,this.__eventItems[this.__eventItems.length-1].itemParent=this}},{key:"triggerAll",value:function(e,t){this.__handler=e,this.__context=t,this.__stackIndex=this.__stackIndex+this.__eventItems.length;for(var n=0;n<this.__eventItems.length;n++)this.__eventItems[n].trigger()}},{key:"handleResponse",value:function(e){if(0==--this.__stackIndex){this.__handler.call(this.__context,this);var t=this;v.doLater(function(){t.doCleanup()})}}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"items",value:function(){return this.__eventItems}}]),t}(g),b.EventCollectionItem=function(e){function t(e){(0,c.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return n.__event=e,n.__event.data.responder=n,n.response=null,n.itemParent=null,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"doCleanup",value:function(){return this.__event&&(this.__event.data.responder=null),this.setPropertyForCleanup("__event"),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"doCleanup",this).call(this)}},{key:"trigger",value:function(){var e=this.itemParent&&this.itemParent.getEventBus();e&&e.triggerEvent(this.__event)}},{key:"type",value:function(){return this.__event.type}},{key:"getEventObj",value:function(){return this.__event}},{key:"result",value:function(e){this.response=e,this.itemParent.handleResponse(this)}},{key:"fault",value:function(e){var t="Error during event <"+this.__event.type+">";throw v.getLoggingService().getLogger().error(t),new Error(t)}}]),t}(y),b.StateService=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return e.__state=[],e.__cachedStateObjs={},e.__index=0,e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"pushState",value:function(e){var t=e.stateParameters||{};delete e.stateParameters,e.index=this.__index,this.__state[this.__index]&&this.__index++;var n=this.getState();return this.__state[this.__index]=e,n&&!t.noEvent&&this.triggerStateDestroyed(n),this.triggerStateChange(),this.getState()}},{key:"replaceState",value:function(e){var t=e.stateParameters||{};delete e.stateParameters;var n=this.getState();return e.index=this.__index,this.__state[this.__index]=e,n&&!t.noEvent&&this.triggerStateDestroyed(n),t.noEvent||this.triggerStateChange(),this.getState()}},{key:"modifyState",value:function(e){var t=e.stateParameters||{};delete e.stateParameters;for(var n in e)this.__state[this.__index][n]=e[n];return t.noEvent||this.triggerStateChange("STATE_MODIFIED"),this.getState()}},{key:"getState",value:function(e){var t=void 0===e?this.__index:e;return this.__state[t]}},{key:"getPriorState",value:function(){return this.__index>0?this.getState(this.__index-1):null}},{key:"getIndex",value:function(){return this.__index}},{key:"back",value:function(){var e=this.__index;if(this.__index>0&&this.__index--,this.__index>=0&&this.triggerStateChange(null,!0),e+1<=this.__state.length){var t=this.__state.pop();t&&this.triggerStateDestroyed(t)}}},{key:"forward",value:function(){this.__index++,this.triggerStateChange()}},{key:"go",value:function(e){this.__index+=e,this.triggerStateChange()}},{key:"reset",value:function(){this.__index=0;var e=this.__state;this.__state=[],this.__destroyState(e)}},{key:"__destroyState",value:function(e){v.array.forEach(e,this.triggerStateDestroyed,this)}},{key:"findByField",value:function(e,t){for(var n=this.__state.length-1;n>=0;n--){var i=this.__state[n];if(i[e]==t)return i}return!1}},{key:"triggerStateChange",value:function(e,t){var n=this.getState(),i=new E.Event(e||"STATE_CHANGE",this,n);return i.isBack=t,this.triggerEvent(i)}},{key:"triggerStateDestroyed",value:function(e){var t=new E.Event("STATE_DESTROYED",this,e);return this.triggerEvent(t)}},{key:"clearCachedStates",value:function(){}}]),t}(S),v.defineGlobal(b.name,b),e.exports=b},function(e,t,n){var i=n(401),a=n(88),r=n(717),o=n(56),s=n(101),l=n(130),c=n(103),u=n(393),d=n(391),_=n(718),h=n(402),f=n(181),p=n(390),m=n(719),v=n(392),g=n(0).utils,y=n(394);g.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sync.extension"}')),g.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.sync.errormgmt"}')),g.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.synchronizer","config":{"impl":{"class-name":"com.servicemax.client.sync.impl.SyncImpl"}}}')),g.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SYNC.GET_SYNC_STATUS","command":"com.servicemax.client.sync.commands.GetSyncStatus"}]}}}')),g.registerService(JSON.parse('{"id":"com.servicemax.client.syncmanager","class-name":"com.servicemax.client.sync.impl.syncservice.SyncService"}')),g.registerService(JSON.parse('{"id":"com.servicemax.client.integration","class-name":"com.servicemax.client.sync.integration.IntegrationService"}')),e.exports={impl:i,api:a,commands:r,syncevent:o,sqlschema:s,syncutils:l,syncdataapi:c,syncconfigapi:u,syncdatapurgeapi:d,syncservice:_,syncserviceplugin:h,syncpiq:f,syncchecklist:p,integration:m,syncmobileinventory:v,targetedsyncdataapi:y}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(6),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(10),v=n(0).utils,g=n(5).ModuleActivator,y=n(5).EventDispatcher,S=n(5).Event,E=n(33).AbstractSync,b=n(11).Facade,T=n(7),M=n(12).DatetimeUtil,I=n(7).ServerInfo,C=n(7).Cache,A=n(8),D={name:"com.servicemax.client.sync.impl"},x=function(){return v.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};D.Module=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,p.default)(t,e),t}(g),D.SyncEventDispatcher=function(e){function t(){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),t}(y),D.SyncEvent=function(e){function t(e,n,i){return(0,d.default)(this,t),(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n,i))}return(0,p.default)(t,e),t}(S),D.SyncImpl=function(e){function t(e){(0,d.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return n.__logger=v.getLoggingService().getLogger("CONSOLE-SYNC-IMPL"),n.__console=e,n.__nativeService=b,n.__offlineUtils=T,n.__dateTimeUtils=M,n.__options=null,n.__syncType=null,n.__syncNotificationImpl=null,n.__runningInitial=!1,n.__runningAttachments=!1,n.__scheduledSyncTimer=null,n.__syncSettings={ENABLE_AGGRESSIVE:"IPAD018_SET019",ENABLE_LOCATION:"Enable Location Tracking",SCHEDULE_ONECALLSYNC:"Frequency of Master Data",SCHEDULE_LOCATION:"Location Tracking Frequency",SCHEDULE_CONFIG_SYNC_REMINDER:"Frequency of Application Changes",SCHEDULE_PURGE:"PURGE_FREQ",ENABLE_PRODUCTIQ:"PRODIQ002_SET001",ENABLE_MOBILE_INVENTORY:"INVT002_SET001",ENABLE_FIELD_MERGE:"IPAD018_SET016",GET_PRICE_ENABLED:"IPAD018_SET009",GET_PRICE_ENBABLED_DURING_AGGRESSIVE_SYNC:"IPAD018_SET022",ENABLE_SSL_CERTIFICATE_PINNING:"IPAD018_SET023",CHECKLIST_ENABLED:"Enable Checklist",SFILES_ENABLED:"GLOB001_GBL037",SFILE_SUPPORTED:"FILE_SUPPORTED",PREVENT_CHOOSE_FROM_LIBRARY:"IPAD007_SET007"},n.__syncSettingValues={},n.__scheduledSyncTypes=["ONECALLSYNC","LOCATION","CONFIG_SYNC_REMINDER","PURGE"],n.__scheduledSyncTimes={},n.__skipConnectivitySyncEvents=["LOCATION","CONFIG_SYNC_REMINDER"],n.__allowSyncPopUp=!0,n}return(0,p.default)(t,e),(0,s.default)(t,[{key:"run",value:function(e){this.setOptions(e),this.validateSyncState(),this.bindPopUpEvents()}},{key:"setOptions",value:function(e){this.__options=e||{},this.__options.context=this.__options.context||this,this.__options.handler=v.proxy(this,function(e){var t={syncType:this.__syncType,lastSync:e,runningInitial:this.__runningInitial},n=new D.SyncEvent("SYNC_FINISHED_INITIALIZING",this,t);this.triggerEvent(n),this.refreshSyncSettingValues(function(){this.refreshScheduledSyncTimes(function(){this.scheduleBackgroundSync()})},!0)})}},{key:"loadServerVersionFromDB",value:function(){this.getCacheValue({multiple:!1,cacheKey:"SERVER_INFO",callback:function(e){if(e){var e=v.toObject(e),t=e.server_version;I.setServerVersion(t)}},context:this})}},{key:"validateSyncState",value:function(e){this.__logger.info("Verifying current user, please wait..."),this.getInitialUserInfoFromServer({context:this,callback:function(e,t){if(e&&"SvmxProfileId"in e&&!e.SvmxProfileId)return this.showProfileError();this.loadServerVersionFromDB(),this.getLastSync({context:this,callback:function(e){this.getSyncManager().validateLocalMetadata(v.proxy(this,function(n){if(this.__logger.info("Current user: "+v.toJSON(e.user)),this.__logger.info("Last sync time: "+v.toJSON(e.time)),this.__logger.info("Metadata validity: "+(n?"true":"false")),this.__logger.info("Connectivity status: "+(t?"true":"false")),e.time&&e.user)if(n){var i=this;this.getSyncManager().loadInstallBaseTable().always(function(){i.refreshUserInfo(e.user,function(){i.__options.handler(e)})})}else this.setRunningInital(!0),this.performSync("CONFIG");else t?this.getSyncManager().beforeFirstRun(v.proxy(this,function(){this.setRunningInital(!0),this.performSync("INITIAL")})):this.showConnectionError("INITIAL",!0)}))}})}})}},{key:"refreshUserInfo",value:function(e,t,n){t||(t=function(){});var i=this.__nativeService.createLocaleFormatRequest();i.bind("REQUEST_COMPLETED",function(i){var a=i.data.data;if(!a)return t();Ext.util.Format.decimalSeparator=a.number_decimal_separator,Ext.util.Format.thousandSeparator=a.number_group_separator;var r=this.__dateTimeUtils.convertFormatToJSFormat(a.date),o=this.__dateTimeUtils.convertFormatToJSFormat(a.time),s=this.__dateTimeUtils.convertFormatToJSFormat(a.long_date);(this.__dateTimeUtils.setLocale(a.locale),r=r.replace(/[Yy]+/g,"YYYY"),this.__dateTimeUtils.setDateFormat(r),this.__dateTimeUtils.setTimeFormat(o),this.__dateTimeUtils.setLongDateFormat(s),e.LongDateFormat=s,e.TimeFormat=this.__dateTimeUtils.getDefaultTimeFormat(),e.DateFormat=this.__dateTimeUtils.getDefaultDateFormat(),e.TimezoneOffset=this.__dateTimeUtils.getTimezoneOffset(),this.__dateTimeUtils.getTimezone()&&(e.Timezone=this.__dateTimeUtils.getTimezone()),e.DecimalSeparator=a.number_decimal_separator,e.ThousandSeparator=a.number_group_separator,e.CurrencyDecimalSeparator=a.currency_decimal_separator,e.CurrencyThousandSeparator=a.currency_group_separator,this.__offlineUtils.Cache.writeObjectToDBCache("USER_INFO",e,t,n),this.__nativeService.createSQLRequest().execute({query:"INSERT OR IGNORE INTO User (Id,Name) VALUES('"+e.UserId+"','"+e.UserName+"'); UPDATE User SET Name='"+e.UserName+"' WHERE Id = '"+e.UserId+"'",async:!0}),e.UserTrunkDetail&&e.UserTrunkDetail.Id&&e.UserTrunkDetail.Name)&&this.__nativeService.createSQLRequest().execute({query:"INSERT OR IGNORE INTO "+v.OrgNamespace+"__Site__c (Id,Name) VALUES('"+e.UserTrunkDetail.Id+"','"+e.UserTrunkDetail.Name+"'); UPDATE "+v.OrgNamespace+"__Site__c SET Name='"+e.UserTrunkDetail.Name+"' WHERE Id = '"+e.UserTrunkDetail.Id+"'",async:!0});v.getCurrentApplication().setUserInfo(e)},this),i.bind("REQUEST_ERROR",function(e){this.__logger.warn("Unable to update user info during sync"),t.call(n)},this),i.execute()}},{key:"bindPopUpEvents",value:function(){var e=this;this.bind("EDITMODE_IN",function(){e.__allowSyncPopUp=!1}),this.bind("EDITMODE_OUT",function(){e.__allowSyncPopUp=!0})}},{key:"performPreInitialSync",value:function(){v.getCurrentApplication().checkForMessageId("connectionErrorDialog")&&Ext.destroy(Ext.ComponentQuery.query("#connectionErrorDialog")[0]),this.checkConnectivity({context:this,callback:function(e){e?this.getSyncManager().beforeFirstRun(v.proxy(this,function(){this.setRunningInital(!0),this.performSync("INITIAL")})):this.showConnectionError("INITIAL",!0)}})}},{key:"getSyncManager",value:function(){if(!this.__syncManager){var e=v.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance()}return this.__syncManager}},{key:"getSyncType",value:function(){return this.getSyncManager().getSyncType()}},{key:"getAggressiveSyncType",value:function(e){var t=this.getSyncSettingValue("ENABLE_AGGRESSIVE");return t?(t=t.toString().toLowerCase(),t="true"===e?"smart sync":"smart sync"===t?"smart sync":"full sync"===t||"true"==t?"full sync":"none"):t="none",t}},{key:"isSyncRunning",value:function(){return this.getSyncManager().getIsRunning()}},{key:"isDataPurgeRunning",value:function(){return this.getSyncManager().isDataPurge(this.getSyncType())}},{key:"isDataSyncRunning",value:function(){return this.getSyncManager().isDataSync(this.getSyncType())}},{key:"isConfigSyncRunning",value:function(){return this.getSyncManager().isConfigSync(this.getSyncType())}},{key:"isInitialSyncRunning",value:function(){return this.getSyncManager().isInitialSync(this.getSyncType())}},{key:"isLocationSyncRunning",value:function(){return!!this.getSyncManager().__syncLocationEventCol}},{key:"setRunningInital",value:function(e){this.__runningInitial=e}},{key:"isSuccessiveSyncEnabled",value:function(){return this.isSyncRunning()}},{key:"getLastSync",value:function(e){var t=this,n=0,i={},a=function(){2==++n&&e.callback.call(e.context,i)};this.getLastSyncTime({context:t,callback:function(e){i.time=e,a.call(this)}}),this.getSyncUserInfo({context:t,callback:function(e){i.user=e,a.call(this)}})}},{key:"getLastSyncTime",value:function(e){this.getCacheValue({context:e.context,callback:e.callback,cacheKey:"LAST_SYNC_TIME"})}},{key:"getLastSyncUser",value:function(e){this.getCacheValue({context:this,cacheKey:"USER_INFO",callback:function(t){e.callback.call(e.context,!!t&&v.toObject(t))}})}},{key:"getSyncUserInfo",value:function(e){this.getLastSyncUser({context:this,callback:function(t){if(!t)return e.callback.call(e.context,!1);this.getLoginInfo({context:this,callback:function(n){n?(v.getClient().ClientVersion=n.AppVersion||v.getClient().getApplicationParameter("app-version"),this.__logger.info("Current App Version: "+v.getClient().ClientVersion),n.UserName===t.UserLogin?(n.IsSyncOnLogin=n.IsSyncOnLogin.toString().toLowerCase(),t.Timezone=n.TimeZone,t.TimezoneOffset=n.TimeZoneOffSet,"true"===n.IsSyncOnLogin||"1"===n.IsSyncOnLogin?t.reSync=!0:t.reSync=!1,e.callback.call(e.context,t)):e.callback.call(e.context,!1)):this.__logger.error("Unable to retrieve login info from native client")}})}})}},{key:"getCacheValue",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",function(t){var n,i=t.data.data;if(e.multiple){var n={};if(i&&i.length)for(var a=0,r=i.length;a<r;a++){var o=i[a];n[o.key]=o.value}}else n=!1,i&&i.length&&(n=i[0].value);e.callback.call(e.context,n)},this),t.bind("REQUEST_ERROR",function(t){var n=!!e.multiple&&{};e.callback.call(e.context,n)},this),e.multiple&&m.isArray(e.cacheKey)&&(e.cacheKey=e.cacheKey.join("','")),t.execute({query:"SELECT key, value FROM ClientCache WHERE key IN ('"+e.cacheKey+"')",async:!0})}},{key:"getSettingValue",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",function(t){var n,i=t.data.data;if(e.multiple){var n={};if(i&&i.length)for(var a=0,r=i.length;a<r;a++){var o=i[a];n[o.setting_id]=o.value}}else n=!1,i&&i.length&&(n=i[0].value);e.callback.call(e.context,n)},this),t.bind("REQUEST_ERROR",function(t){var n=!!e.multiple&&{};e.callback.call(e.context,n)},this),e.multiple&&m.isArray(e.settingKey)&&(e.settingKey=e.settingKey.join("','")),t.execute({query:"SELECT setting_id, value FROM MobileDeviceSettings WHERE setting_id IN ('"+e.settingKey+"')",async:!0})}},{key:"getLoginInfo",value:function(e){var t=new v.Deferred,n=this.__nativeService.createLoginInfoRequest();return n.bind("REQUEST_COMPLETED",function(n){var i=n.data.data;e.callback.call(e.context,i||!1),t.resolve()},this),n.bind("REQUEST_ERROR",function(n){e.callback.call(e.context,!1),t.reject()},this),n.execute(),t}},{key:"getInitialUserInfoFromServer",value:function(e){this.checkConnectivity({context:this,callback:function(t){t?this.getSyncUserInfo({context:this,callback:v.proxy(this,function(t){e.callback.call(e.context,t,!0)})}):e.callback.call(e.context,null,!1)}})}},{key:"checkConnectivity",value:function(e){var t=this.__nativeService.createConnectivityRequest();e=e||{},t.bind("REQUEST_COMPLETED",function(t){var n=t.data.data&&t.data.data.toLowerCase(),i="true"===n;e.callback&&e.callback.call(e.context,i)},this),t.bind("REQUEST_ERROR",function(t){e.callback&&e.callback.call(e.context,!1)},this),t.execute(e)}},{key:"refreshSyncSettingValues",value:function(e,t){var n={};for(var i in this.__syncSettings)n[this.__syncSettings[i]]=i;this.getSettingValue({multiple:!0,settingKey:(0,r.default)(n),callback:function(i){if(i){this.__syncSettingValues={};for(var a in n)if(a in i){var r=i[a];m.isNumeric(r)?(r=6e4*parseInt(i[a],10),"SCHEDULE_PURGE"===n[a]&&(r*=60)):r&&"ENABLE_AGGRESSIVE"!==n[a]&&(r="true"===r.toString().toLowerCase()),this.__syncSettingValues[n[a]]=r}else this.__syncSettingValues[n[a]]=0;if(t){var o=new D.SyncEvent("REFRESH_SSL_PINNING",this,this.__syncSettingValues);this.triggerEvent(o)}}e&&e.call(this)},context:this})}},{key:"addSettingValues",value:function(e){var t=this,n={};for(var i in this.__syncSettings)n[this.__syncSettings[i]]=i;var a=(0,r.default)(n);e.filter(function(e){return a.includes(e.setting_id)}).forEach(function(e){var i=e.setting_id,a=e.value;m.isNumeric(a)?a=6e4*parseInt(a,10):a&&(a="true"===a.toString().toLowerCase()),t.__syncSettingValues[n[i]]=a})}},{key:"refreshScheduledSyncTimes",value:function(e){for(var t=[],n=0,i=this.__scheduledSyncTypes.length;n<i;n++)t.push("SCHEDULED_SYNC_TIME."+this.__scheduledSyncTypes[n]);this.getCacheValue({multiple:!0,cacheKey:t,callback:function(n){if(n){this.__scheduledSyncTimes={};for(var i=0,a=t.length;i<a;i++){var r=t[i];r in n?this.__scheduledSyncTimes[r]=new Date(n[r]):this.resetScheduledSyncTime({syncType:r.replace("SCHEDULED_SYNC_TIME.","")})}}e&&e.call(this)},context:this})}},{key:"getSyncSettingValue",value:function(e){return e in this.__syncSettingValues&&this.__syncSettingValues[e]}},{key:"getScheduledSyncTime",value:function(e){if((e="SCHEDULED_SYNC_TIME."+e)in this.__scheduledSyncTimes)return this.__scheduledSyncTimes[e]}},{key:"resetScheduledSyncTimes",value:function(){for(var e=0,t=this.__scheduledSyncTypes.length;e<t;e++)this.resetScheduledSyncTime({syncType:this.__scheduledSyncTypes[e]})}},{key:"resetScheduledSyncTime",value:function(e){var t=this.getSyncSettingValue("SCHEDULE_"+e.syncType)||0,n="SCHEDULED_SYNC_TIME."+e.syncType;if(t<=0)return this.__offlineUtils.Cache.deleteFromDBCache(n,e.callback,this),void delete this.__scheduledSyncTimes[n];var i=new Date((new Date).getTime()+t);this.__scheduledSyncTimes[n]=i,this.__offlineUtils.Cache.writeToDBCache(n,i,e.callback,this)}},{key:"scheduleBackgroundSync",value:function(){var e=this;e.getSyncManager().getConflicts(function(t){for(var n=0,i=e.__scheduledSyncTypes.length;n<i;n++){var a=e.__scheduledSyncTypes[n];"ONECALLSYNC"===a&&t||e.triggerScheduledBackgroundSync(a)}}),setTimeout(function(){e.scheduleBackgroundSync()},6e4)}},{key:"triggerScheduledBackgroundSync",value:function(e){var t=this;if(!this.isInitialSyncRunning()&&!this.isConfigSyncRunning()){var n=this.getScheduledSyncTime(e);if(n){if(n<new Date){var i={syncType:e,scheduledTime:n};switch(e){case"PURGE":t.__allowSyncPopUp?this.isDataPurgeRunning()||this.__triggerDataPurge(e,i):t.__offlineUtils.Cache.writeToDBCache("IS_DATA_PURGE_DUE","true",function(){t.updateBadgeToolsNavIcon()},t);break;case"CONFIG_SYNC_REMINDER":t.__allowSyncPopUp?this.isConfigSyncRunning()||this.__triggerConfigSyncReminder(e,i):t.__offlineUtils.Cache.writeToDBCache("IS_CONFIG_SYNC_DUE","true",function(){t.updateBadgeToolsNavIcon()},t);break;case"ONECALLSYNC":this.isDataSyncRunning()||this.performSync(e,i);break;case"LOCATION":this.isLocationSyncRunning()||this.getSyncManager().startLocationSync()}this.resetScheduledSyncTime({syncType:e})}}}}},{key:"isPopUpDisplayed",value:function(e){return!(!v.getCurrentApplication().checkForMessageId("toolsSyncWindow")&&!v.getCurrentApplication().checkForMessageId(e))}},{key:"__triggerConfigSyncReminder",value:function(){if(this.__offlineUtils.Cache.writeToDBCache("IS_CONFIG_SYNC_DUE","true"),!this.isPopUpDisplayed("configReminderWindow")){var e=this;v.getCurrentApplication().showMessage({type:"INFO",title:x().T("FSA010_TAG117","Configuration sync is due"),text:x().T("FSA010_TAG002","ServiceMax needs to sync forms, rules and other configuration items. If you choose to sync later, this action can be found in Tools."),buttons:[{text:x().T("FSA016_TAG003","OK"),itemId:"OK"}],itemId:"configReminderWindow",handler:function(t){"OK"===t&&e.updateBadgeToolsNavIcon()}})}}},{key:"__triggerDataPurge",value:function(e,t){function n(n,a,r){var o=void 0,s=void 0,l=void 0;o=a?A(a,"YYYY-MM-DD HH:mm:ss").toDate():A(n,"YYYY-MM-DD HH:mm:ss").toDate(),s=A(r.data.valueMap[0].value,"YYYY-MM-DD HH:mm:ss").toDate(),s.getTime()>o.getTime()&&(l=!0),v.Msg.alert({title:null,itemId:"purgeReminderWindow",text:x().T("FSA010_TAG064","ServiceMax needs to clean up its database to keep things running at top speed. You will not be able to use the application while this operation is running, but it will only take a minute or two, depending on the speed of your connection and the size of the database. If your connection is slow or intermittent, select Clean Up Later."),buttons:[{text:x().T("FSA010_TAG065","Clean Up Later"),itemId:"Clean Up Later",ui:"svmx-button-square"},{text:x().T("FSA010_TAG066","Clean Up Now"),itemId:"Clean Up Now",ui:"svmx-button-square"}]}).then(function(n){if("Clean Up Now"===n){if(i.isDataSyncRunning())return void v.Msg.alert({title:null,itemId:"dataSyncRunningWhilePurge",text:"",items:[{xtype:"svmx.label",text:x().T("FSA010_TAG067","Failed to Clean up, Data Sync is in progress. Purge will be rescheduled")}],buttons:[{text:x().T("FSA016_TAG003","OK"),itemId:"purgeLater",ui:"svmx-button-square"}]}).then(function(){i.__offlineUtils.Cache.writeToDBCache("IS_DATA_PURGE_DUE","true",function(){i.updateBadgeToolsNavIcon()},i)});l?v.Msg.alert({title:null,itemId:"configOutOfDateWindow",text:"",items:[{xtype:"svmx.label",text:x().T("FSA010_TAG044","Configuration must be updated before you can purge data")}],buttons:[{text:x().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"svmx-button-square"},{text:x().T("FSA010_TAG045","Update"),itemId:"Update",ui:"svmx-button-square-highlight"}]}).then(function(e){"Update"===e?i.__performConfigSync("CONFIG"):i.__offlineUtils.Cache.writeToDBCache("IS_CONFIG_SYNC_DUE","true",function(){i.updateBadgeToolsNavIcon()},i)}):(i.msgbox=v.create("com.servicemax.client.ui.components.modern.popups.SVMXMessageBox",{title:x().T("FSA010_TAG118","Purge Data in Progress"),ui:"svmx-default",buttons:[{xtype:"svmx.button",id:"purgeCancel",cls:"tools-cancel-button",text:x().T("FSA016_TAG004","Cancel"),handler:v.proxy(i,"onCancel"),disabled:!0}],items:[{xtype:"svmx.progressbar",id:"toolssyncprogressbar",message:"",showSubProgress:!1,containerCls:"container-sfm-tools-small-progressbar",barCls:"sfm-tools-small-progressbar-bar",width:"100%"},{xtype:"svmx.panel",items:[{xtype:"svmx.label",text:x().T("FSA010_TAG119","Please do not switch to another application or press the home button during this process.<br></br>Doing so will cancel or interrupt the purge.")}]}]}),i.msgbox.show(),i.performSync(e,t))}else l?i.__offlineUtils.Cache.writeToDBCache("IS_CONFIG_SYNC_DUE","true",function(){i.__offlineUtils.Cache.writeToDBCache("IS_DATA_PURGE_DUE","true",function(){i.updateBadgeToolsNavIcon()},i)},i):i.__offlineUtils.Cache.writeToDBCache("IS_DATA_PURGE_DUE","true",function(){i.updateBadgeToolsNavIcon()},i)})}if(!this.isPopUpDisplayed("purgeReminderWindow")){var i=this,a=[];a.push(this.__offlineUtils.Cache.readFromDBCache("LAST_SYNC_TIME.INITIAL")),a.push(this.__offlineUtils.Cache.readFromDBCache("LAST_SYNC_TIME.CONFIG_SUCCESS")),a.push(i.getSyncManager().getLastConfigModified()),v.when(a).then(n)}}},{key:"__performConfigSync",value:function(e){if("mobile"==v.getClient().getApplicationParameter("client-type").toLowerCase())var t="FSA010_TAG144",n="Please do not switch to another application or press the home button while sync is in progress.<br></br>Doing so will cancel or interrupt the synchronization.";else var t="FSA010_TAG049",n="You will be notified when the sync is complete.";this.__configCancelButton=Ext.create({xtype:"svmx.button",id:"configCancel",text:x().T("FSA016_TAG004","Cancel"),cls:"tools-cancel-button",handler:v.proxy(this,"onCancel"),disabled:!0}),this.msgbox=v.create("com.servicemax.client.ui.components.modern.popups.SVMXMessageBox",{id:"tools-sync-msgbox",title:x().T("FSA010_TAG120","Config Sync in Progress"),ui:"svmx-default",buttons:[this.__configCancelButton],items:[{xtype:"svmx.progressbar",id:"toolssyncprogressbar",message:"",showSubProgress:!1,containerCls:"container-sfm-tools-small-progressbar",barCls:"sfm-tools-small-progressbar-bar",width:"100%"},{xtype:"svmx.panel",items:[{xtype:"svmx.label",text:x().T(t,n)}]}]}),this.msgbox.show(),this.performSync(e)}},{key:"updateBadgeToolsNavIcon",value:function(){var e=this,t=Ext.ComponentQuery.query("svmx\\.button[consoleAppId=toolspages-largemodern]")[0],n=this,i=null,a={isConfigSyncInPending:!1,isPurgeInPending:!1};n.getSyncManager().getConflictCount(v.proxy(this,function(e){e&&e.count&&(i=parseInt(e.count),t.setBadgeText(i))}));var r=this.__offlineUtils.Cache.readFromDBCache("IS_CONFIG_SYNC_DUE"),o=this.__offlineUtils.Cache.readFromDBCache("IS_DATA_PURGE_DUE");m.when(r,o).then(v.proxy(this,function(n,r){n&&"true"===n&&(i++,a.isConfigSyncInPending=!0),r&&"true"===r&&(i++,a.isPurgeInPending=!0),t.setBadgeText(i),e.getSyncManager().dispatchEvent("REFRESH_CONFLICT_BADGE",a)}))}},{key:"onCancel",value:function(){var e=v.getCurrentApplication().getSyncImpl(),t=v.getCurrentApplication().getSyncImpl().getSyncType();if(this.msgbox&&(this.msgbox.destroy(),this.msgbox=null),"PURGE"==t){C.writeToDBCache("SYNC_STATUS."+t,"Canceled");var n=M.getTimestampWithSaveFormat();C.writeToDBCache("LAST_SYNC_TIME."+t,n)}e.stopSync()}},{key:"performSync",value:function(e,t,n){this.__syncType=e,this.__scheduleInfo=t,this.__syncState=n,this.checkConnectivity({context:this,callback:function(i){if(i||-1!=this.__skipConnectivitySyncEvents.indexOf(e)){this.startConnectivityMonitor(!!t);var a=this.getSyncManager().startSync({type:e,state:n,scheduleInfo:t});return"LOCATION"!==this.__syncType||this.__syncManager.__locationTrackingEnabled||(this.__syncType=null),a&&(a.bind("SYNC_INFO",this.__onInfo,this),a.bind("SYNC_ERROR",this.__onError,this),a.bind("SYNC_FAILED",this.__onFailed,this),a.bind("SYNC_STARTED",this.__onStarted,this),a.bind("SYNC_PROGRESS",this.__onProgress,this),a.bind("SYNC_COMPLETED",this.__onCompleted,this),a.bind("SYNC_GROUP_STARTED",this.__onGroupStarted,this),a.bind("SYNC_GROUP_COMPLETED",this.__onGroupCompleted,this),a.bind("SYNC_EVENT_STARTED",this.__onEventStarted,this),a.bind("SYNC_EVENT_COMPLETED",this.__onEventCompleted,this),a.bind("SYNC_EVENT_REQUEST_STARTED",this.__onEventRequestStarted,this),a.bind("SYNC_EVENT_REQUEST_COMPLETED",this.__onEventRequestCompleted,this),a.bind("SYNC_EVENT_CONNECTION_WARNING",this.__onEventConnectionWarning,this),a.bind("SYNC_ATTACHMENTS_STARTED",this.__onAttachmentsStarted,this),a.bind("SYNC_ATTACHMENTS_STOPPED",this.__onAttachmentsStopped,this),a.bind("SYNC_ATTACHMENTS_COMPLETED",this.__onAttachmentsCompleted,this),a.bind("SYNC_CONNECTION_LOSS",this.__onConnectionLoss,this)),a}if("AGGRESSIVE"!==e&&"TARGETEDSYNC"!==e&&"LOCATION"!==e&&"CONFIG_SYNC_REMINDER"!==e)if(t){this.__logger.info("Scheduled Sync: No connectivity"),this.__syncType=null,"ONECALLSYNC"==e&&(e="DATA"),this.__offlineUtils.Cache.writeToDBCache("SYNC_STATUS."+e,"No Connectivity");var r=this.__dateTimeUtils.getTimestampWithSaveFormat();this.__offlineUtils.Cache.writeToDBCache("LAST_SYNC_TIME."+e,r),this.getSyncManager().dispatchEvent("SYNC_STOPPED")}else this.showConnectionError(e)}})}},{key:"onSaveStarted",value:function(){}},{key:"onSaveCompleted",value:function(){this.performAggressiveSync()}},{key:"performAggressiveSync",value:function(){this.isSyncRunning()||this.__performAggressiveSync()}},{key:"__performAggressiveSync",value:function(){var e=this.getSyncSettingValue("ENABLE_AGGRESSIVE");"true"!==(e=e.toString().toLowerCase())&&"full sync"!==e||this.performSync("AGGRESSIVE")}},{key:"performTargetedSync",value:function(e){this.isSyncRunning()&&!e||this.performSync("TARGETEDSYNC")}},{key:"processExternalRequest",value:function(e){this.performSync("INSERT_LOCAL_RECORDS",null,{INSERT_RECORD_IDS:e.recordIds})}},{key:"handleExternalResponse",value:function(e){this.getSyncManager().dispatchEvent("INSERT_LOCAL_RECORDS_RESPONSE",e)}},{key:"stopSync",value:function(){this.getSyncManager().stopSync(),this.__finalCleanup()}},{key:"resumeSync",value:function(){this.checkConnectivity({context:this,callback:function(e){if(e){this.__syncType&&this.startConnectivityMonitor();var t=this.getSyncManager();t.getIsRunning()?t.resumeSync():this.performSync(this.__syncType,this.__scheduleInfo,this.__syncState)}else this.showConnectionError()}})}},{key:"startConnectivityMonitor",value:function(e){var t=this;this.__notConnectedEarlier=!1,this.__connectionDisconnectedCounter=0,this.__connectivityInterval||(this.__connectivityInterval=setInterval(function(){t.checkConnectivity({context:t,callback:function(n){var i=t.getSyncManager();if(n)t.__notConnectedEarlier&&(t.__logger.info("Connection status: Re-connected"),t.__notConnectedEarlier=!1,t.__connectionDisconnectedCounter=0,i.__totalAttachmentCount&&!i.__attachmentInProgress?(t.__logger.info("ReStart Attachment sync to download all pending attachments"),i.startAttachmentSync({syncType:t.__syncType})):i.resumeSync());else if(t.__notConnectedEarlier){t.__logger.info("Connection status: Still disconnected"),t.__connectionDisconnectedCounter++;var a=v.getCurrentApplication().getSyncImpl().isDataSyncRunning();if(i.__totalAttachmentCount&&i.__attachmentInProgress)t.__logger.info("Stop Attachment Sync which is in progress as thier is no connectivity"),t.__notConnectedEarlier=!1,i.stopAttachmentSync(),t.__connectionDisconnectedCounter=0;else if(e&&"PURGE"!=this.__syncType)t.connectionErrorCancel();else if(i.__totalAttachmentCount){if(t.__connectionDisconnectedCounter>=10&&("INITIAL"===t.__syncType||"ONECALLSYNC"===t.__syncType||"AGGRESSIVE"===t.__syncType||"TARGETEDSYNC"===t.__syncType||a)){t.__notConnectedEarlier=!1,t.showConnectionError(),t.stopConnectivityMonitor();i.pauseSync(!0),t.__connectionDisconnectedCounter=0}}else{t.__notConnectedEarlier=!1,t.showConnectionError(),t.stopConnectivityMonitor();i.pauseSync(!0),t.__connectionDisconnectedCounter=0}}else t.__logger.info("Connection status: Disconnected"),t.__notConnectedEarlier=!0}})},5e3))}},{key:"stopConnectivityMonitor",value:function(){this.__connectivityInterval&&(clearInterval(this.__connectivityInterval),this.__connectivityInterval=null)}},{key:"connectionErrorRetry",value:function(e){var t=this;setTimeout(function(){t.__syncType||t.__runningAttachments?t.resumeSync():e&&t.performSync(e)},1e3)}},{key:"connectionErrorCancel",value:function(){if(this.__syncType){this.stopConnectivityMonitor(),this.getSyncManager().stopSync(!0);var e=void 0;e="ONECALLSYNC"==this.__syncType||"AGGRESSIVE"==this.__syncType||"TARGETEDSYNC"==this.__syncType?"DATA":this.__syncType,this.__offlineUtils.Cache.writeToDBCache("SYNC_STATUS."+e,"No Connectivity");var t=this.__dateTimeUtils.getTimestampWithSaveFormat();this.__offlineUtils.Cache.writeToDBCache("LAST_SYNC_TIME."+e,t),this.__finalCleanup();var n=new D.SyncEvent("SYNC_CONNECTION_ERROR_DIALOG_CANCEL",this);this.triggerEvent(n)}else this.stopConnectivityMonitor()}},{key:"showConnectionWarning",value:function(e){var t={syncType:this.__syncType||e,runningInitial:this.__runningInitial,msgbox:this.msgbox};this.stopConnectivityMonitor();var n=new D.SyncEvent("SYNC_CONNECTION_WARNING_DIALOG",this,t);this.triggerEvent(n)}},{key:"showConnectionError",value:function(e,t){var n={syncType:this.__syncType||e,runningInitial:this.__runningInitial,msgbox:this.msgbox,initialConn:t};this.stopConnectivityMonitor();var i=new D.SyncEvent("SYNC_CONNECTION_ERROR_DIALOG",this,n);this.triggerEvent(i)}},{key:"failedErrorRetry",value:function(){this.__runningInitial?this.__finalCleanup(!0):this.stopSync()}},{key:"failedErrorContinue",value:function(){this.stopSync()}},{key:"showOnFailedError",value:function(e,t,n){n=n||{},n.data=n.data||{};var i=[],a=[],r=void 0,o=void 0;if(n.data.allFailures&&n.data.allFailures.length>0)for(r=0;r<n.data.allFailures.length;r++){var s=n.data.allFailures[r],l=!1;if(s.errorData&&s.errorData.length>0)for(o=0;o<s.errorData.length;o++)s.errorData[o].errorMsg&&(l=!0,a.push(s.errorData[o].errorMsg));s.errorMessage&&(0==l&&a.push(s.errorMessage),i.push(s.errorMessage))}n.data.errorMessage&&a.push(n.data.errorMessage);var c={syncType:this.__syncType,runningInitial:this.__runningInitial,errorMessages:a,errorDetails:i,allowRetry:e,allowContinue:t},u=new D.SyncEvent("SYNC_FAILED_DIALOG",this,c);this.triggerEvent(u)}},{key:"showProfileError",value:function(){var e={syncType:this.__syncType,runningInitial:this.__runningInitial},t=new D.SyncEvent("SYNC_PROFILE_ERROR_DIALOG",this,e);this.triggerEvent(t)}},{key:"__broadcastEvent",value:function(e){var t=new D.SyncEvent(e.type+"_IMPL",this,e.data);this.triggerEvent(t)}},{key:"__onInfo",value:function(e){this.__broadcastEvent(e)}},{key:"__onConnectionLoss",value:function(e){this.__notConnectedEarlier=!0}},{key:"__onStarted",value:function(e){e.data.runningInitial=this.__runningInitial,this.__broadcastEvent(e)}},{key:"__onProgress",value:function(e){if("PURGE"==this.__syncType||"CONFIG"==this.__syncType){if("CONFIG"!==this.__syncType){var t=Ext.getCmp("purgeCancel"),n=["SyncGetEventsPurge","SyncGetDownloadCriteriaPurge","SyncGetAdvDownloadCriteriaPurge","SyncGetPriceDataPurge","SyncMobileInventoryDataPurge","SyncPiqDataPurge","SyncCleanUpSelect","DataPurge"];t&&(n.indexOf(e.data.eventName)>-1?t.disable():t.enable())}this.__progressTotal=e.data.totalCount||this.__progressTotal,this.__progressStep=e.data.currentStep||this.__progressStep,this.__updateProgressBar()}this.__broadcastEvent(e)}},{key:"__updateProgressBar",value:function(){var e=Ext.getCmp("toolssyncprogressbar"),t=Math.round(this.__progressStep/this.__progressTotal*100);e&&e.updateProgress(t)}},{key:"__onFailed",value:function(e){this.stopConnectivityMonitor(),this.__runningInitial?this.showOnFailedError(!0,!1,e):this.showOnFailedError(!1,!0,e),this.__broadcastEvent(e)}},{key:"__onError",value:function(e){this.__broadcastEvent(e)}},{key:"__onCompleted",value:function(e){if(this.msgbox&&(this.msgbox.destroy(),this.msgbox=null),this.__finalCleanup(),"PURGE"==e.data.syncType&&this.__offlineUtils.Cache.writeToDBCache("IS_DATA_PURGE_DUE","false"),"CONFIG"==e.data.syncType){this.__offlineUtils.Cache.writeToDBCache("IS_CONFIG_SYNC_DUE","false");var t=v.create("com.servicemax.client.lib.api.Event","DISPLAY_TAGS_LOADED",this);v.getClient().triggerEvent(t);var n=v.getCurrentApplication().getCurrentConsoleApp().getAppConfig(),i=void 0;n&&n.app&&n.app.id&&(i=n.app.id),this.__resetStateManager(i)}"INITIAL"==e.data.syncType&&(this.__offlineUtils.Cache.writeToDBCache("IS_DATA_PURGE_DUE","false"),this.__offlineUtils.Cache.writeToDBCache("IS_CONFIG_SYNC_DUE","false")),this.getSyncManager().resetLastFailedSyncTypesStatus(),this.__broadcastEvent(e),this.getSyncManager().initiateInventoryTransfer()}},{key:"__resetStateManager",value:function(e){var t=v.create("com.servicemax.client.lib.api.Event","RESET_STATE_MANAGER",this,{request:{consoleAppId:e}});v.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").triggerEvent(t)}},{key:"__finalCleanup",value:function(e){this.stopConnectivityMonitor(),this.__runningInitial&&(this.setRunningInital(!1),e||this.getLastSyncUser({context:this,callback:function(e){e?this.__options.handler({user:e}):this.__logger.error("Unable to retrieve user info after initial sync")}})),this.__syncType=null,this.__root=null,e&&setTimeout(v.proxy(this,function(){this.__retryInitialAfterFailure()}),500)}},{key:"__retryInitialAfterFailure",value:function(e){this.setRunningInital(!0),this.performSync("INITIAL")}},{key:"__onGroupStarted",value:function(e){this.__broadcastEvent(e)}},{key:"__onGroupCompleted",value:function(e){this.__broadcastEvent(e)}},{key:"__onEventStarted",value:function(e){this.__broadcastEvent(e)}},{key:"__onEventCompleted",value:function(e){this.__broadcastEvent(e)}},{key:"__onEventRequestStarted",value:function(e){this.__broadcastEvent(e)}},{key:"__onEventRequestCompleted",value:function(e){if(e&&e.data&&e.data.error){var t=this.getSyncManager().getState("HTTP_FAILURES");t||(t=[]),t.push(e.data),this.getSyncManager().setState("HTTP_FAILURES",t),this.getSyncManager().setState("FAILED",!0),this.getSyncManager().pauseSync(),this.getSyncManager().__finalizeSync()}this.__broadcastEvent(e)}},{key:"__onEventConnectionWarning",value:function(e){this.stopConnectivityMonitor(),this.__notConnectedEarlier=!1,this.getSyncManager().pauseSync(),this.showConnectionWarning(),this.__broadcastEvent(e)}},{key:"__onAttachmentsStarted",value:function(e){this.__runningAttachments=!0,this.__broadcastEvent(e)}},{key:"__onAttachmentsStopped",value:function(e){this.__runningAttachments=!1,this.__broadcastEvent(e)}},{key:"__onAttachmentsCompleted",value:function(e){this.__broadcastEvent(e)}}]),t}(E),v.defineGlobal(D.name,D),e.exports=D},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(10),v=n(0).utils,g=n(11).Facade,y=n(88).SQLSchema,S=n(7).MetaData,E=n(12).DatetimeUtil,b=n(7).ServerInfo,T=n(5).SVMXObject,M={name:"com.servicemax.client.sync.syncserviceplugin"},I=g,C=y,A=v.getLoggingService().getLogger("syncserviceplugin"),D=S,x=E,R=b;M.RequestBase=function(e){function t(e){(0,c.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return n._callback=e||function(e){},n._deferred=m.Deferred(),n.responseHandler=v.proxy(n,n.responseHandler),n.errorHandler=v.proxy(n,n.errorHandler),n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"responseHandler",value:function(e,t){e={isSuccess:!0,data:e||{},refreshAttachments:t||!1},this._callback(e),this._deferred.resolve(e)}},{key:"errorHandler",value:function(e){e={isSuccess:!1,error:e||{}},this._callback(e),this._deferred.reject(e)}},{key:"getClientId",value:function(){return"Sync_"+Math.floor((new Date).getTime())+"_"+Math.floor(1e3*Math.random())}}]),t}(T),M.ServerRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){try{this._initHTTPServiceRequest(e)}catch(e){this.errorHandler(e)}return this._deferred}},{key:"_initHTTPServiceRequest",value:function(e){var t={protocol:e.protocol||"APEXREST",uri:e.uri||"/services/apexrest/"+v.OrgNamespace+"/svmx/MobServiceIntf/"+e.methodName,method:e.method||"POST",data:e.data||{},allowPost:e.allowPost||!1,event:this},n=this;n._createHTTPServiceRequest(t,function(e,t){e.bind("REQUEST_COMPLETED",function(e){n.responseHandler(e.data.data)}),e.bind("REQUEST_ERROR",function(e){n.errorHandler(e.data.data)}),e.execute(t)})}},{key:"_createHTTPServiceRequest",value:function(e,t){var n=I.createHTTPRequest();switch(e.protocol){case"SOAP":this.getUserInfo(function(i){var a=new window.com.servicemax.client.sal.impl.SoapRequest({sessionId:i.UserSessionId,apiVersion:v.getClient().getApplicationParameter("salesforce-api-version")}),r=new window.com.servicemax.client.sal.impl.RPRuntimeMode;e.uri=r.getSoapUrl("",a._options.apiVersion),e.data=a._getData(e.soapData,e),e.headers={SOAPAction:e.methodName,"Content-Type":"text/xml"},t(n,e)});break;case"REST":this.getUserInfo(function(i){var a=new window.com.servicemax.client.sal.impl.RestRequest({sessionId:i.UserSessionId,apiVersion:"v24.0"}),r=new window.com.servicemax.client.sal.impl.RPRuntimeMode;e.method="GET",e.uri=r.getUrl(e.restUrl,a._options.apiVersion),e.data="",e.headers={"Content-Type":"application/json"},t(n,e)});break;case"APEXREST":default:t(n,e)}}}]),t}(M.RequestBase),M.SQLRequest=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"execute",value:function(e){try{this._initHTTPServiceRequest(e)}catch(e){this.errorHandler(e)}return this._deferred}},{key:"_initHTTPServiceRequest",value:function(e){var t=this,n=I.createRequest((e.type||"SQL")+"Request");n.bind("REQUEST_COMPLETED",function(e){t.responseHandler(e.data.data)}),n.bind("REQUEST_ERROR",function(e){t.errorHandler(e.data.data)}),n.execute(e)}}]),t}(M.RequestBase),M.SearchResult=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){this.searchDetail=e.searchDetail||{};var t={methodName:"DataSyncRequest",data:{eventName:"SFM_SEARCH",eventType:"SEARCH_RESULTS",value:this.getClientId(),valueMap:[{key:"SearchProcessId",value:e.ProcessId},{key:"ObjectId",value:e.ObjectId},{key:"SEARCH_OPERATOR",value:e.Operator},{key:"KeyWord",value:e.KeyWord},{key:"RecordLimit",value:e.OnlineRecordLimit}]}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){var t=this._parseResult(e.data||{});this._filterOfflineRecords(this.searchDetail.targetObjectName,t).then(this.responseHandler,this.errorHandler)}},{key:"_parseResult",value:function(e){for(var t={MapStringMap:[],stringMap:[],totalCount:0},n=S,i={},a={},r=0,o=this.searchDetail.fields.length;r<o;r++){var s,l,c=this.searchDetail.fields[r];s=l=c.fieldName,c.parentReferenceName&&(s=c.parentReferenceName+"-"+c.fieldName,l=c.parentName+"_"+c.fieldName),i[s]=c,a[l]=s}return v.array.forEach(e.valueMap||[],function(e){var r={valueMap:[]},o={};(e.valueMap||[]).forEach(function(t){t.valueMap.length&&"NotApplicable"!==t.valueMap[0].value&&(t.reference=t.valueMap[0].value),"Name"===t.key&&t.reference===e.value&&(r.Id=t.reference||"",r.valueMap.push({key:"Id",value:t.reference||""})),t.reference&&(l=n.getTableForId(t.reference)+"_"+t.key)in a&&(t.key1=a[l]),t.key1||(t.key1=t.key),o[t.key1]||(o[t.key1]={key:t.key1,value:t.value,value1:t.reference||""}),delete t.key1});for(var s in i){var c=s,u=i[s].displayType.toLowerCase();if(s.indexOf("-")>0&&("picklist"===u||"multipicklist"===u)){c=s.split("-").reverse()[0]}var d=o[c];d&&(d.key=s,d.type=u,r.valueMap.push(d))}r.Id||(r.Id=e.value),r.valueMap.push({key:"online",value:!0}),t.MapStringMap.push(r)},this),t.stringMap.push({key:"SEARCH_OBJECT_ID",value:this.searchDetail.detailObjectId}),t.totalCount=t.MapStringMap.length,t}},{key:"_filterOfflineRecords",value:function(e,t){var n=m.Deferred(),i=[];if((t.MapStringMap||[]).forEach(function(e){i.push(e.Id)}),i.length&&e){var a=function(e){if(e&&e.data){var i=[],a=e.data.map(function(e){return e.Id});t.MapStringMap.forEach(function(e){a.indexOf(e.Id)<0&&i.push(e)}),t.MapStringMap=i}n.resolve(t)},r="SELECT Id FROM '"+e+"' WHERE Id IN ('"+i.join("','")+"')";v.create(M.name+".SQLRequest").execute({query:r}).then(a,n.reject)}else n.resolve();return n}}]),t}(M.RequestBase),M.DownloadOnDemand=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t=this,n={methodName:"DataSyncRequest",data:{eventType:"GET_DATA",eventName:"DATA_ON_DEMAND",value:this.getClientId(),valueMap:[{key:"Object_Name",value:e.objectName,valueMap:[{key:"Id",value:e.recordId}]}]}};return this._requestDetailLines(e,n).done(v.proxy(this,function(){v.create(M.name+".ServerRequest").execute(n).then(v.proxy(t,t._processResult),t.errorHandler)})),this._deferred}},{key:"_requestDetailLines",value:function(e,t){var n=new m.Deferred;return e.objectName===v.getCustomObjectName("Service_Order")?D.getDetailLineNamesForObject(v.getCustomObjectName("Service_Order")).done(v.proxy(this,function(i){var a=S.getTablesInDatabase();for(var r in i)"Event"===r||r===v.getCustomObjectName("SVMX_Event")||r.indexOf("__History")>-1||!a[r]||t.data.valueMap.push({key:"Object_Name",value:r,valueMap:[{key:"Id",value:e.recordId},{key:"Parent_Reference_Field",value:i[r]}]});n.resolve()})):n.resolve(),n}},{key:"_processResult",value:function(e){if(!this._done){var t=this,n=!1;if(this._result=this._parseResult(e.data||{}),void 0===this._result.parent)this.errorHandler("This item is either missing, damaged, or you do not have permission to download it. Try refreshing the search to make sure you have the latest information");else{var i=[],a=this._result.parsedRelatedRecordNames;if(this._result.parent&&(i.push(this._insertUpdateRecords(this._result.parent)),i.push(this._indexDataOnDemand(v.cloneObject(this._result.parent)))),this._result.child)for(var r=0;r<this._result.child.length;r++)i.push(this._insertUpdateRecords(this._result.child[r])),i.push(this._indexDataOnDemand(v.cloneObject(this._result.child[r])));if(t._result.priceData&&(t._result.priceData||[]).forEach(function(e){i.push(t._insertUpdateRecords(e)),i.push(t._indexDataOnDemand(v.cloneObject(e)))}),t._result.deferred&&t._result.sfiledeferred&&(A.info("wait for _processAttachmentRecords to complete"),A.info("wait for _processSFilesRecords to complete"),m.when(t._result.deferred,t._result.sfiledeferred).then(function(){if(A.info("Insert processed attachment records"),A.info("Insert processed Salesforce files records"),t._result.dodAttachment){n=!0;var e=t._result.dodAttachment;e.attachmentResult&&i.push(t._executeQuery(e.attachmentResult)),e.sfAttachmentResult&&i.push(t._executeQuery(e.sfAttachmentResult)),e.clientDataOnDemandResult&&i.push(t._executeQuery(e.clientDataOnDemandResult))}if(t._result.dodSFile){n=!0;var a=t._result.dodSFile;a.cvResult&&i.push(t._executeQuery(a.cvResult)),a.cdResult&&i.push(t._executeQuery(a.cdResult)),a.cdlResult&&i.push(t._executeQuery(a.cdlResult)),a.sfAttachmentResult&&i.push(t._executeQuery(a.sfAttachmentResult)),a.clientDataOnDemandResult&&i.push(t._executeQuery(a.clientDataOnDemandResult))}})),a&&a.length){var o=this._insertUpdateRecordNames(a);i.push(o)}v.when(i).then(v.proxy(this,function(){if(this._done=!0,this.responseHandler(this._result.parent,n),n){var e=v.create("com.servicemax.client.sync.api.SyncAttachments"),t=[],i=[];this._result&&this._result.dodAttachment&&this._result.dodAttachment.attachmentRecs&&this._result.dodAttachment.attachmentRecs.length>0&&(t=this._result.dodAttachment.attachmentRecs),this._result&&this._result.dodSFile&&this._result.dodSFile.sfilesRecs&&this._result.dodSFile.sfilesRecs.length>0&&(i=this._result.dodSFile.sfilesRecs),t.length>0?e._downloadAttachmentBody({attachmentRec:t||[],isSalesforceFile:!1},function(){i.length>0&&e._downloadAttachmentBody({attachmentRec:i||[],isSalesforceFile:!0},function(){A.info("Salesforce Files download (DOD) done")})}):i.length>0&&e._downloadAttachmentBody({attachmentRec:i||[],isSalesforceFile:!0},function(){A.info("Salesforce Files download (DOD) done")})}}),this.errorHandler)}}}},{key:"_cancelDownload",value:function(e){this._result&&this._done?this._rollback(e||function(e){}):this._done=!0}},{key:"_rollback",value:function(e){var t=this,n=[];if(this._result.parent&&(n.push(this._deleteUpdateRecords(this._result.parent)),n.push(this._deleteIndexDataOnDemand(this._result.parent))),this._result.child&&(n.push(this._deleteUpdateRecords(this._result.child)),n.push(this._deleteIndexDataOnDemand(this._result.child))),t._result.priceData&&(t._result.priceData||[]).forEach(function(e){n.push(t._deleteUpdateRecords(e)),n.push(t._deleteIndexDataOnDemand(v.cloneObject(e)))}),t._result.dodAttachment){for(var i=t._result.dodAttachment.attachmentRecs,a=[],r=0;r<i.length;r++)a[r]=i[r].Id;if(a){var o=t._getDeleteQuery("Attachment",a);n.push(t._executeQuery(o));var s=t._getDeleteQuery("SFAttachments",a);n.push(t._executeQuery(s));var l=t._getDeleteQuery("ClientDataOnDemand",a);n.push(t._executeQuery(l))}}if(t._result.dodSFile){for(var c=t._result.dodSFile.sfilesRecs,u=t._result.dodSFile.cdRecords,d=t._result.dodSFile.cdlRecords,_=c.length,h=u.length,f=d.length,p=[],g=[],y=[],S=0;S<_;S++)p[S]=c[S].Id;for(var E=0;E<h;E++)g[E]=u[E].Id;for(var b=0;b<f;b++)y[b]=d[b].Id;if(p){var T=t._getDeleteQuery("ContentVersion",p);n.push(t._executeQuery(T));var M=t._getDeleteQuery("SFAttachments",p);n.push(t._executeQuery(M));var I=t._getDeleteQuery("ClientDataOnDemand",p);n.push(t._executeQuery(I))}if(g.length>0){var C=t._getDeleteQuery("ContentDocument",g);n.push(t._executeQuery(C))}if(y.length>0){var A=t._getDeleteQuery("ContentDocument",y);n.push(t._executeQuery(A))}}m.when(n).then(function(){e&&e({success:!0})},function(){e&&e({success:!1})})}},{key:"_parseResult",value:function(e){var t={},n=void 0,i=[],a=[],o=[],s=function(e,s){switch(e.key){case"Parent_Record":t.parent=t.parent||{name:s,records:{}},n=this._parseRecord(s,e.value),this._parseRelatedRecordNames(e.value,o),n&&(t.parent.records[n.Id]={new:n});break;case"Child_Record":var l,c;t.child=t.child||[];for(var u=0;u<t.child.length;u++)t.child[u].name===s&&(l=t.child[u]);l?c=l:(c={name:s,records:{}},t.child.push(c)),n=this._parseRecord(s,e.value),this._parseRelatedRecordNames(e.value,o),n&&(c.records[n.Id]={new:n});break;case"PRICING_DATA":var d=this;t.priceData=t.priceData||[],(e.valueMap||[]).forEach(function(e){var i={};(e.valueMap||[]).forEach(function(t){(n=d._parseRecord(e.key,t.value))&&(i[n.Id]={new:n})}),(0,r.default)(i).length>0&&t.priceData.push({name:e.key,records:i})});break;case"Attachment":i=e.valueMap;break;case"Files":a=e.valueMap}};if(v.array.forEach(e.valueMap||[],function(e){v.array.forEach(e.valueMap||[],function(t){s.call(this,t,e.value)},this)},this),i){var l=this._processAttachmentRecords(i,t);t.deferred=l}if(a){var c=this._processSFilesRecords(a,t);t.sfiledeferred=c}return t.parsedRelatedRecordNames=o,t}},{key:"_filterAttachments",value:function(e,t){for(var n=[],i=0;i<t.length;i++){for(var a=t[i],r=!1,o=!1,s=0;s<e.length;s++){var l=e[s];if(l.Id===a.Id){r=!0;x.parseGMTDate(a.LastModifiedDate)-x.parseGMTDate(l.LastModifiedDate)&&(o=!0);break}}r&&!o||n.push(a)}return n}},{key:"_processAttachmentRecords",value:function(e,t){var n=this,i=v.Deferred();return(e||[]).forEach(function(e){var a=e&&e.value&&JSON.parse(e.value),r=e&&e.key;if(!a||r!==v.OrgNamespace+"__Installed_Product__c"&&r!==v.OrgNamespace+"__Site__c")"SAFE_TO_DELETE"===r||i.resolve();else{var o=void 0;if(a.length>0&&(o=a[0].ParentId),o){var s="SELECT Id, LastModifiedDate FROM Attachment WHERE ParentId = '"+o+"'";n._executeQuery(s).then(function(e){var r=a;e&&e.data.length&&(r=n._filterAttachments(e.data,a));var o=C.getInsertReplaceQuery("Attachment",r,!0,"Attachment"),s=[],l=[],c=r.map(function(e){return s.push({Id:e.Id,last_modified_date:e.LastModifiedDate}),l.push(e.Id),{Id:e.Id,parent_id:e.ParentId,created_by_id:e.CreatedById,name:e.Name,description:e.Description,content_type:e.ContentType,last_modified_date:e.LastModifiedDate}}),u=C.getInsertReplaceQuery("SFAttachments",c,!0,"SFAttachments"),d=C.getInsertReplaceQuery("ClientDataOnDemand",s,!0,"ClientDataOnDemand");t.dodAttachment={attachmentResult:o||"",sfAttachmentResult:u||"",clientDataOnDemandResult:d||"",attachmentRecs:r},i.resolve()})}else i.resolve()}}),i}},{key:"_filterSFileRecords",value:function(e,t,n,i){for(var a=[],r={},o=0;o<t.length;o++){for(var s=t[o],l=!1,c=!1,u=null,d=0;d<e.length;d++)if(u=e[d],u.CVId===s.Id){if(l=!0,s.LastModifiedDate&&u.LastModifiedDate){var _=s.LastModifiedDate,h=u.LastModifiedDate,f=x.parseGMTDate(_),p=x.parseGMTDate(h),m=f-p;m&&(c=!0)}break}l&&!c||a.push(s)}return a&&a.length>0&&(r.ContentVersion=a,n&&n.length>0&&(r.ContentDocument=n),i&&i.length>0&&(r.ContentDocumentLink=i)),r}},{key:"_processSFilesRecords",value:function(e,t){var n=this,i=v.Deferred();if(e&&e.length>0){for(var a=e.length,r=[],o=[],s=[],l=0;l<a;l++){var c=e[l];if(c&&c.key&&"ContentDocumentLink"===c.key&&c.value){r=JSON.parse(c.value)||[];for(var u=0;u<r.length;u++){var d=r[u];if(d&&d.ContentDocument){var _=d.ContentDocument;if(_.LatestPublishedVersion){var h=n._parseRecord("ContentVersion",_.LatestPublishedVersion);_=n._parseRecord("ContentDocument",_),s.push(_),o.push(h)}}}}}if(r&&r.length>0){var f=null;if(r.length>0&&(f=r[0].LinkedEntityId),f){var p=v.string.substitute("SELECT cv.Id as CVId, cv.ContentDocumentId as CDId, cv.LastModifiedDate as LastModifiedDate, cdl.Id as CDLId FROM {{content_version}} as cv LEFT JOIN {{content_document}} as cd ON cv.ContentDocumentId = cd.Id LEFT JOIN {{content_document_link}} as cdl ON cd.Id = cdl.ContentDocumentId WHERE cdl.LinkedEntityId = '"+f+"' ",{content_version:"ContentVersion",content_document:"ContentDocument",content_document_link:"ContentDocumentLink"});n._executeQuery(p).then(function(e){var a={};if(a.ContentVersion=o,a.ContentDocument=s,a.ContentDocumentLink=r,e&&e.data.length&&(a=n._filterSFileRecords(e.data,o,s,r)),a&&a.ContentVersion&&a.ContentDocument&&a.ContentDocumentLink){var l=C.getInsertReplaceQuery("ContentVersion",a.ContentVersion,!0,"ContentVersion"),c=C.getInsertReplaceQuery("ContentDocument",a.ContentDocument,!0,"ContentDocument"),u=C.getInsertReplaceQuery("ContentDocumentLink",a.ContentDocumentLink,!0,"ContentDocumentLink"),d=[],_=[],h=a.ContentVersion.map(function(e){d.push({Id:e.Id,last_modified_date:e.LastModifiedDate});var t={Id:e.Id,parent_id:f,created_by_id:e.CreatedById,name:e.Title,description:e.Description,content_type:e.FileExtension,last_modified_date:e.LastModifiedDate,file_type:"SFILE",process_id:e[v.OrgNamespace+"__SM_Process_ID__c"],content_document_id:e.ContentDocumentId},n={Id:e.Id,ParentId:f,CreatedById:e.CreatedById,Name:e.Title,Description:e.Description,ContentType:e.FileExtension,BodyLength:e.ContentSize,LastModifiedDate:e.LastModifiedDate};return _.push(n),t}),p=C.getInsertReplaceQuery("SFAttachments",h,!0,"SFAttachments");C.getInsertReplaceQuery("ClientDataOnDemand",d,!0,"ClientDataOnDemand");t.dodSFile={cvResult:l||"",cdResult:c||"",cdlResult:u||"",sfAttachmentResult:p||"",sfilesRecs:_||"",cdRecords:a.ContentDocument||"",cdlRecords:a.ContentDocumentLink||""},i.resolve()}else i.resolve()})}else i.resolve()}else i.resolve()}else i.resolve();return i}},{key:"_executeQuery",value:function(e,t){var n=v.Deferred();return v.create(M.name+".SQLRequest").execute({query:e}).then(function(e){A.info("DOD Attachment: Query executed successfully"),n.resolve(e)},function(){A.info("DOD Attachment : Query failed"),n.reject()}),n}},{key:"_getDeleteQuery",value:function(e,t){return"DELETE FROM "+e+" WHERE Id IN('"+t.join("','")+"')"}},{key:"_parseRecord",value:function(e,t){if(t){t="string"==typeof t?JSON.parse(t):t;var n=C.getTableSchema(e),i=void 0,a=void 0,r=void 0,o={};for(i in t)if(r=n.fields[i]){switch(a=t[i],r.sftype){case"datetime":a=this._parseDateTimeValue(a);break;case"boolean":a=a&&"false"!==a?"true":"false"}o[i]=a}return o}}},{key:"_parseDateTimeValue",value:function(e){var t=e;if("string"==typeof e&&e.match(/T/)){var n=e.split("T"),i=n[0].split("-"),a=n[1].split("."),r=a[0].split(":");t=[i[0],i[1],i[2]].join("-")+" "+[r[0],r[1],r[2]].join(":")}return t}},{key:"_insertUpdateRecordNames",value:function(e){var t=m.Deferred();if(e.length>0){var n=C.getInsertReplaceQuery("SFRecordName",e,!0,"SFRecordName");v.create(M.name+".SQLRequest").execute({query:n}).then(t.resolve,t.reject)}else t.resolve();return t}},{key:"_insertUpdateRecords",value:function(e){var t=m.Deferred(),n=function(n){if(!this._done){v.array.forEach(n.data||[],function(t){var n=this._parseRecord(e.name,t);n&&(e.records[t.Id].old=n)},this);var i=v.array.map(e.records,function(e){return e.new}),a=C.getInsertReplaceQuery(e.name,i,!0,e.name);v.create(M.name+".SQLRequest").execute({query:a}).then(t.resolve,t.reject)}},i=(0,r.default)(e.records);if(i.length){var a="SELECT * FROM '"+e.name+"' WHERE Id IN ('"+i.join("','")+"')";v.create(M.name+".SQLRequest").execute({query:a}).then(v.proxy(this,n),t.reject)}else t.resolve();return t}},{key:"_parseRelatedRecordNames",value:function(e,t){var n=JSON.parse(e);for(var i in n)if(i&&i.endsWith("__r")){var a=n[i];if(a.attributes&&a.attributes.type){var r=a.attributes.type,o=a.Id,s=D.getNameField(r);t.push({Id:o,Name:a[s]})}}}},{key:"_deleteUpdateRecords",value:function(e){var t=m.Deferred(),n=void 0,i=void 0,a=[],r=[];for(n in e.records)i=e.records[n],i.old?a.push(i.old):r.push(n);var o=[];if(r.length){var s=C.getDeleteQuery(e.name,r);o.push(v.create(M.name+".SQLRequest").execute({query:s}))}return a.length&&a.forEach(function(t){var n=C.getUpdateQuery(e.name,t);o.push(v.create(M.name+".SQLRequest").execute({query:n}))}),m.when(o).then(t.resolve,t.reject),t}},{key:"_indexDataOnDemand",value:function(e){if(!this._done){var t=void 0,n=void 0;for(t in e.records)n=e.records[t].new,e.records[t].new={Id:n.Id,last_modified_date:n.LastModifiedDate};return e.name="ClientDataOnDemand",this._insertUpdateRecords(e)}}},{key:"_deleteIndexDataOnDemand",value:function(e){var t=void 0,n=[];for(t in e.records)n.push(e.records[t].new.Id);var i=C.getDeleteQuery("ClientDataOnDemand",n);return v.create(M.name+".SQLRequest").execute({query:i})}}]),t}(M.RequestBase),M.GetFeedInfo=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t="/services/data/v35.0/chatter/feeds/record/"+e.recordId+"/feed-elements",n=v.proxy(this,function(e){e&&e.data&&e.data.length&&(this._feedItemsLimit=e.data[0].value,this._feedItemsLimit&&(t+="?pageSize="+(this._feedItemsLimit>100?100:this._feedItemsLimit))),this._trigger(t,this._processResult)});return v.create(M.name+".SQLRequest").execute({query:"SELECT setting_id, value FROM MobileDeviceSettings WHERE setting_id = 'Chatter Threads'"}).then(n,n),this._deferred}},{key:"_trigger",value:function(e,t){var n={method:"GET",data:{},uri:e};v.create(M.name+".ServerRequest").execute(n).then(v.proxy(this,t),this.errorHandler)}},{key:"_processResult",value:function(e){var t=this,n=m.Deferred();n.then(function(){t.getCommentsForFeedItems(e.data.elements).then(function(){t.responseHandler({feedItems:e.data.elements})})}),this.getNextFeedItems(e.data,n)}},{key:"getNextFeedItems",value:function(e,t){e.nextPageUrl&&this._feedItemsLimit&&e.elements.length<this._feedItemsLimit?this._trigger(e.nextPageUrl,function(n){e.nextPageUrl=n.data.nextPageUrl,e.elements=e.elements.concat(n.data.elements),this.getNextFeedItems(e,t)}):t.resolve()}},{key:"getCommentsForFeedItems",value:function(e){var t=this,n=[],i=void 0;return(e||[]).forEach(function(e){var a=e.capabilities.comments.page;a.nextPageUrl&&(a.items=[],n.push(i=m.Deferred()),t.getCommentsForFeedItem({nextPageUrl:"/services/data/v35.0/chatter/feed-elements/"+e.id+"/capabilities/comments/items?pageSize=100",page:e.capabilities.comments.page,deferred:i}))}),v.when(n)}},{key:"getCommentsForFeedItem",value:function(e){this._trigger(e.nextPageUrl,v.proxy(this,function(t){e.page.items=e.page.items.concat(t.data.items||[]),t.data.nextPageUrl?(e.nextPageUrl=t.data.nextPageUrl,this.getCommentsForFeedItem(e)):(e.page.length=e.page.items.length,e.deferred.resolve())}))}}]),t}(M.RequestBase),M.SaveFeedInfo=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t={method:"POST",allowPost:!0,uri:"/services/data/v35.0/chatter",data:{body:{messageSegments:[{type:"Text",text:e.text}]}}};return"comment"===e.type?t.uri+="/feed-elements/"+e.feedItemId+"/capabilities/comments/items":(t.uri+="/feed-elements",t.data.feedElementType="FeedItem",t.data.subjectId=e.recordId),v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){this.responseHandler(e.data)}}]),t}(M.RequestBase),M.GetProductDocuments=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t={method:"GET",uri:"/services/data/v35.0/query?q="+encodeURI("SELECT Id,Name,Description,Keywords,Type,BodyLength FROM Document WHERE Keywords LIKE '%"+e.productName+"%'"),data:{}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){this.responseHandler(e.data)}}]),t}(M.RequestBase),M.GetProductManual=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){this.__parentId=e.parentId,this.__searchString=e.searchText,this.__attachmentData=null;var t="/services/data/v35.0/query?q="+encodeURI("SELECT BodyLength,Description,Id,Name,ParentId FROM Attachment WHERE ParentId ='"+this.__parentId+"' AND Name LIKE '%"+this.__searchString+"%'");return this._initiateGetProductManualRequest(t,v.proxy(this,this._processAttachmentResult)),this._deferred}},{key:"_initiateGetProductManualRequest",value:function(e,t){var n={method:"GET",uri:e,data:{}};v.create(M.name+".ServerRequest").execute(n).then(t,this.errorHandler)}},{key:"_processAttachmentResult",value:function(e){if(R.getMultiServerVersionRequest().isSalesForceFilesEnabled()){this.__attachmentData=e;var t="/services/data/v38.0/query?q="+encodeURI("Select Id, ContentDocumentId, LinkedEntityId, ContentDocument.LatestPublishedVersionId,ContentDocument.LatestPublishedVersion.FileExtension,ContentDocument.LatestPublishedVersion.Title, ContentDocument.LatestPublishedVersion.Description, ContentDocument.LatestPublishedVersion.ContentSize FROM ContentDocumentLink  WHERE LinkedEntityID ='"+this.__parentId+"' AND ContentDocument.LatestPublishedVersion.Title LIKE '%"+this.__searchString+"%'");this._initiateGetProductManualRequest(t,v.proxy(this,this._processResult))}else this.responseHandler(e.data)}},{key:"_processResult",value:function(e){this._parseSFileResponse(e),this.responseHandler(this.__attachmentData.data)}},{key:"_parseSFileResponse",value:function(e){if(e&&e.isSuccess&&e.data&&e.data.records&&e.data.records.length>0){for(var t=e.data.records,n=t.length,i=[],a=0;a<n;a++)if(t[a].ContentDocument&&t[a].LinkedEntityId&&t[a].ContentDocument.LatestPublishedVersionId&&t[a].ContentDocument.LatestPublishedVersion&&t[a].ContentDocument.LatestPublishedVersion.Title){var r={};r.Id=t[a].ContentDocument.LatestPublishedVersionId,r.Name=t[a].ContentDocument.LatestPublishedVersion.Title||"",t[a].ContentDocument.LatestPublishedVersion.FileExtension&&(r.Name=r.Name+"."+t[a].ContentDocument.LatestPublishedVersion.FileExtension),r.Description=t[a].ContentDocument.LatestPublishedVersion.Description||"",r.BodyLength=t[a].ContentDocument.LatestPublishedVersion.ContentSize||"",r.ParentId=t[a].LinkedEntityId,r.attributes=t[a].ContentDocument.LatestPublishedVersion.attributes,i.push(r)}i.length>0&&this.__attachmentData&&this.__attachmentData.isSuccess&&this.__attachmentData.data&&this.__attachmentData.data.records?this.__attachmentData.data.records=this.__attachmentData.data.records.concat(i):i.length>0&&(this.__attachmentData.data.records=i)}}}]),t}(M.RequestBase),M.DownloadDocumentOnDemand=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){this.__recordId=e.Id;var t={type:"Download",sourceObject:e.docType,recordId:e.Id,file:e.Id+"_"+e.Name,fieldName:"ContentVersion"===e.docType?"VersionData":"Body",isTroubleshootDocumentDownload:!0};return v.create(M.name+".SQLRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){var t="UPDATE product_Troubleshoot_Documents SET online = 'false' WHERE Id = '"+this.__recordId+"'";v.create(M.name+".SQLRequest").execute({query:t}).then(this.responseHandler,this.errorHandler)}}]),t}(M.RequestBase),M.GetLastConfigModified=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t={methodName:"MetaSyncRequest",data:{eventType:"SYNC",eventName:"SYNC_CONFIG_LMD"}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){this.responseHandler(e.data)}}]),t}(M.RequestBase),M.GetServerRecords=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t={method:"GET",uri:"/services/data/v35.0/query?q="+encodeURI(e.query),data:{}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){this.responseHandler(e.data)}}]),t}(M.RequestBase),M.TechnicianSearchResult=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t={methodName:"DataSyncRequest",data:{eventName:"TECHNICIAN_SEARCH",eventType:"SYNC",value:this.getClientId(),Values:[e.searchText],valueMap:[]}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){var t=[];if(e&&e.data&&e.data.valueMap&&e.data.valueMap.length>0){var n=e.data.valueMap[0];n&&n.valueMap&&n.valueMap.length>0&&(t=JSON.parse(n.valueMap[0].value))}this.responseHandler(t)}}]),t}(M.RequestBase),M.StockTransfer=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){var t=this,n={methodName:"DataSyncRequest",data:{eventName:"STOCK_TRANSFER",eventType:"SYNC",value:this.getClientId(),Values:[],valueMap:t.__getValueMap(e)}};return v.create(M.name+".ServerRequest").execute(n).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){this.responseHandler(e)}},{key:"__getValueMap",value:function(e){var t=[];return t.push(this.__getStockTransferHeader(e)),t.push(this.__getStockTransferLine(e)),t}},{key:"__getStockTransferHeader",value:function(e){var t={},n=[];return n.push({key:"SOURCE",value:e.sourceLocation}),n.push({key:"TARGET",value:e.destinationLocation}),n.push({key:"INVENTORY_PROCESS",value:e.inventoryProcess}),t.key="STOCK_HEADER",t.valueMap=n,t}},{key:"__getStockTransferLine",value:function(e){var t={},n=[],i=e.serialNumbers?e.serialNumbers:"";return n.push({key:"PART",value:e.productName}),n.push({key:"QUANTITY",value:e.quantity}),n.push({key:"SERIAL_NUMBERS",value:i}),t.key="STOCK_LINE",t.valueMap=n,t}}]),t}(M.RequestBase),M.CatalogOnlineSearchResult=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){this.searchDetail=e.searchDetail||{};var t={methodName:"DataSyncRequest",data:{eventName:"CATALOG_SEARCH",eventType:"SYNC",value:this.getClientId(),Values:e.KeyWord?[e.KeyWord]:[""],valueMap:[{key:"Last_Id",value:e.lastId?e.lastId:""},{key:"Operator",value:e.Operator?e.Operator:""},{key:"Search_Fields",valuemap:e.searchFields}]}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this._processResult),this.errorHandler),this._deferred}},{key:"_processResult",value:function(e){var t=this._parseResult(e.data||{});this._deferred&&this._deferred.resolve(t)}},{key:"_parseResult",value:function(e){var t=[];if(e.valueMap&&"[object Array]"===Object.prototype.toString.call(e.valueMap))for(var n=e.valueMap.length,i=0;i<n;i++){var a=e.valueMap[i];if(a.key&&"Object_Name"===a.key&&a.value&&"Product2"===a.value)for(var r=a.valueMap,o=r.length,s=0;s<o;s++)if("Last_Id"!=r[s].key&&r[s].value&&"[object Array]"===Object.prototype.toString.call(JSON.parse(r[s].value)))for(var l=JSON.parse(r[s].value),c=l.length,u=0;u<c;u++){var d=l[u];d.hasOwnProperty("attributes")&&delete d.attributes,t.push(d)}}return t}}]),t}(M.RequestBase),M.LocatePartSearchResult=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"trigger",value:function(e){this.searchDetail=e.searchDetail||{};var t={methodName:"DataSyncRequest",data:{eventName:"LOCATE_PART",eventType:"SYNC",value:this.getClientId(),Values:e.productId?[e.productId]:[],valueMap:[{key:"LATITUDE",value:e.latitude},{key:"LONGITUDE",value:e.longitude}]}};return v.create(M.name+".ServerRequest").execute(t).then(v.proxy(this,this.__processResult),this.errorHandler),this._deferred}},{key:"__processResult",value:function(e){if(e.data.errors&&"[object Array]"===Object.prototype.toString.call(e.data.errors)&&e.data.errors.length>0){var t=e.data.errors[0];if(t&&t.errorMsg&&this._deferred)return this._deferred.reject(new Error(t.errorMsg))}var n=this.__parseResult(e.data||[]);this._deferred&&this._deferred.resolve(n)}},{key:"__parseResult",value:function(e){var t={technician:[],warehouse:[]};if(e.valueMap&&"[object Array]"===Object.prototype.toString.call(e.valueMap))for(var n=e.valueMap.length,i=0;i<n;i++){var a=e.valueMap[i];a.key&&"Technician"===a.key&&a.value&&"[object Array]"===Object.prototype.toString.call(JSON.parse(a.value))?t.technician=JSON.parse(a.value):a.key&&"Warehouse"===a.key&&a.value&&"[object Array]"===Object.prototype.toString.call(JSON.parse(a.value))&&(t.warehouse=JSON.parse(a.value))}return t}}]),t}(M.RequestBase),M.pluginMethods={getOnlineSearchResults:function(e){return e=e||{},v.create(M.name+".SearchResult",e.callback).trigger(e.data||{})},downloadRecordOnDemand:function(e){e=e||{};var t=v.create(M.name+".DownloadOnDemand",e.callback);return e.dodDefer&&e.dodDefer.fail(v.proxy(t,t._cancelDownload)),t.trigger(e.data||{})},getFeedInfo:function(e){return e=e||{},v.create(M.name+".GetFeedInfo",e.callback).trigger(e.data||{})},saveFeedInfo:function(e){return e=e||{},v.create(M.name+".SaveFeedInfo",e.callback).trigger(e.data||{})},getProductDocuments:function(e){return e=e||{},v.create(M.name+".GetProductDocuments",e.callback).trigger(e.data||{})},getServerRecords:function(e){return e=e||{},v.create(M.name+".GetServerRecords",e.callback).trigger(e||{})},downloadDocumentOnDemand:function(e){return e=e||{},v.create(M.name+".DownloadDocumentOnDemand",e.callback).trigger(e.data||{})},getProductManual:function(e){return e=e||{},v.create(M.name+".GetProductManual",e.callback).trigger(e.data||{})},getLastConfigModified:function(e){return e=e||{},v.create(M.name+".GetLastConfigModified",e.callback).trigger(e.data||{})},getTechnicianSearchResults:function(e){return e=e||{},v.create(M.name+".TechnicianSearchResult",e.callback).trigger(e.data||{})},initiateStockTransfer:function(e){return e=e||{},v.create(M.name+".StockTransfer",e.callback).trigger(e.data||{})},getOnlineCatalogSearchResults:function(e){return e=e||{},v.create(M.name+".CatalogOnlineSearchResult",e.callback).trigger(e.data||{})},getLocatePartSearchResults:function(e){return e=e||{},v.create(M.name+".LocatePartSearchResult",e.callback).trigger(e.data||{})}},v.defineGlobal(M.name,M),e.exports=M},function(e,t,n){n(24);var i=n(728),a=n(22),r=n(729),o=n(730),s=n(0).utils,l=n(89),c=n(731);s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.application","config":{"application":{"id":"console","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.impl.Application"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"SFMCONSOLE.VIEW","data":[{"component-id":"ROOTCONTAINER","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.api.SFMConsoleRootContainer"}]}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"MODEL","data":[{"operationId":"SFMCONSOLE.SIGNOUT","operation":"com.servicemax.client.sfmconsole.ui.largemodern.operations.SignOutUser"}]}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.uitheme","config":{"theme-defs":[]}}')),s.registerService(JSON.parse('{"id":"com.servicemax.client.transientstatemanager","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.api.TransientStateService"}')),s.registerService(JSON.parse('{"id":"com.servicemax.client.statemanager","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.utils.LargeModernStateService"}')),e.exports={impl:i,console:a,api:r,operations:o,utils:l,external:c}},function(e,t,n){var i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=n(12).DatetimeUtil,s=n(104).SVMXModel,l=n(8);n(405);var c={name:"com.servicemax.client.ui.components.modern.controls.form"},u=o,d=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};c.SVMXFormPanel=Ext.define(c.name+".SVMXFormPanel",{extend:"Ext.Container",alias:"widget.svmx.form",config:{editors:null,isDirty:!1,labelAlign:"left"},__data:null,__originalData:null,initConfig:function(e){this.__data=e.data,this.callParent([e])},__initializing:!0,initialize:function(){var e=[],t=this.getData();t.getModel().getFields().each(function(n){if(!n.config.hidden&&"id"!=n.getName()){var i="svmx.field.text";switch(n.getType().type){case"double":case"float":i="svmx.field.double";break;case"reference":i="svmx.field.lookup";break;case"datetime":i="svmx.field.datetime";break;case"date":i="svmx.field.date";break;case"picklist":i="svmx.field.picklist";break;case"boolean":i="svmx.field.checkbox";break;case"textarea":i="svmx.field.textarea";break;case"hidden":i="";break;case"currency":i="svmx.field.currency";break;case"email":i="svmx.field.email";break;case"phone":i="svmx.field.phone";break;case"percent":i="svmx.field.percent";break;case"url":i="svmx.field.url";break;case"multipicklist":i="svmx.field.multipicklist";break;case"recordtype":i="svmx.field.recordtype";break;case"int":i="svmx.field.number"}var a=Ext.widget(i,{fieldDef:n,value:t.get(n.getName())||n.getDefaultValue(),required:n.config.required,readOnly:n.config.readOnly,label:n.config.label,name:n.getName(),labelAlign:this.getLabelAlign(),listeners:{action:r.proxy(this,this.__onEditorAction),change:r.proxy(this,this.__onEditorChange),keyup:r.proxy(this,this.__onEditorChange)}});this.add(a),e.push(a)}},this),this.setEditors(e),this.__initializing=!1},forEachEditor:function(e,t){r.array.forEach(this.getEditors(),e,t)},getData:function(){var e=this.__data;return this.getEditors()&&this.forEachEditor(function(t){e.set(t.getName(),t.getValue())},this),e},applyData:function(e){if(this.__originalData=e,this.getEditors())return this.forEachEditor(function(t){t.setValue(e.get(t.getName()))},this),this.resetOriginalValues(),e},reset:function(){this.forEachEditor(function(e){e.reset()},this)},commitChanges:function(){var e=this.getData();this.__originalData.setData(e.getData()),this.resetOriginalValues(),this.fireEvent("commited",this)},resetOriginalValues:function(){this.forEachEditor(function(e){e.resetOriginalValue()})},__onEditorAction:function(){this.commitChanges()},__onEditorChange:function(){r.timer.job(this.getId()+".onchange",50,this,function(){var e=this.getEditors(),t=Boolean(r.array.get(e,function(e){return e.isDirty()}));t!=this.getIsDirty()&&this.setIsDirty(t)})},applyIsDirty:function(e){return this.__initializing||this.fireEvent("isdirty",this,e),e}}),c.SVMXFieldSet=Ext.define(c.name+".SVMXFieldSet",{extend:"Ext.form.FieldSet",alias:"widget.svmx.fieldset",config:{labelAlign:"left",readOnly:null,overrideFieldLabelAlign:!0},width:"100%",doAdd:function(e){e instanceof Ext.field.Field&&(this.getLabelAlign()&&(!this.getOverrideFieldLabelAlign()&&e.getLabelAlign()||e.setLabelAlign(this.getLabelAlign())),null!==this.getReadOnly()&&e.setReadOnly(this.getReadOnly())),this.callParent([e])}}),Ext.field.Field.prototype.emptyReadonlyTag="",Ext.field.Field.prototype.__emptyReadonlyTag="",delete Ext.field.Text.prototype.updateReadOnly,Ext.field.Field.prototype.updateReadOnly=function(e,t){if(t!=e){this.generateReadOnlyLabel();var n=this.getComponent();e?((!r.getClient().isLaptop()||!n.getType||"checkbox"!=n.getType()&&"radio"!=n.getType()||this.getUseReadOnlyLabel()&&"checkbox"!=n.getType())&&(!n.getType||"checkbox"!=n.getType()&&"radio"!=n.getType()||this.getUseReadOnlyLabel())?(n.hide(),this.__readOnlyLabel.show()):(this.__readOnlyLabel.hide(),n.show()),this.addCls("svmx-readonly-editor"),this.removeCls("svmx-editable-editor")):(this.__readOnlyLabel.hide(),n.show(),this.removeCls("svmx-readonly-editor"),this.addCls("svmx-editable-editor"))}e&&this.setReadOnlyValue(this.__getReadOnlyValue(this.getValue()))},Ext.override(Ext.field.Field,{doDestroy:function(){this.__readOnlyLabel&&(this.__readOnlyLabel.destroy(),delete this.__readOnlyLabel),this.barcodeHandler=null,this._defaultPhonePickerConfig=null,this._defaultTabletPickerConfig=null,this._compositionMetamodel=null,this.callParent()}}),Ext.field.Field.prototype.generateReadOnlyLabel=function(){if(!this.__readOnlyLabel){var e=Ext.widget("svmx.label",{html:this.__getReadOnlyValue(this.getValue()),cls:"sfm-readonly-label"});this.onreadonlytap&&e.element.on("singletap",r.proxy(this,"onreadonlytap")),e.setLayoutSizeFlags(this.getSizeFlags()),this.innerElement.dom.appendChild(e.renderElement.dom),this.__readOnlyLabel=e}},Ext.field.Field.prototype.updateReadOnlyValue=function(e,t,n){this.__readOnlyLabel&&this.getReadOnly()&&this.setReadOnlyValue(this.__getReadOnlyValue(t))},Ext.field.Field.prototype.setReadOnlyValue=function(e,t){""!==e&&null!==e&&void 0!==e||(e=this.emptyReadonlyTag);var n=this.__allowHtmlValue?e:Ext.String.htmlEncode(e);n=n||"&nbsp;",this.__readOnlyLabel.setHtml(n);var i=e||this.getReadOnlyValue(this.getValue());null===i||void 0===i||""===i?this.__readOnlyLabel.addCls("svmx-empty-editor"):this.__readOnlyLabel.removeCls("svmx-empty-editor")},Ext.field.Field.prototype.__getReadOnlyValue=function(e){var t=this.getReadOnlyValue(e);return null!==t&&void 0!==t&&""!==t||(t=this.emptyReadonlyTag),t},Ext.field.Field.prototype.getReadOnlyValue=function(e){return e},Ext.field.Field.prototype.onChange=function(e,t,n){e.fireEvent("change",this,t,n)},Ext.form.FieldSet.prototype.getIsInvalid=Ext.field.Field.prototype.getIsInvalid=function(){return!1},Ext.form.FieldSet.prototype.isValid=Ext.field.Field.prototype.isValid=function(){var e={isInvalid:this.getIsInvalid(),isRequired:!1};if(this.getRequired&&this.getRequired()){var t=this.getValue();(null===t||void 0===t||""===t||Ext.isArray(t)&&0===t.length)&&(e.isRequired=!0)}return e};var _=function(e){e.getEnableBarcode()&&(e.showBarcode=function(){!this.getEnableBarcode()||this.getReadOnly()||this.getDisabled()||(this.addCls("svmx-field-scannable-active"),this.getComponent().barcodeIcon&&this.getComponent().barcodeIcon.show())},e.hideBarcode=function(){this.getEnableBarcode()&&!this.getAlwaysShowBarcode()&&(this.getComponent().barcodeIcon&&this.getComponent().barcodeIcon.hide(),this.removeCls("svmx-field-scannable-active"))},e.scanBarcode=function(){r.proxy(this,function(){var e=r.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SCAN_BARCODE",this,{request:{context:this,onSuccess:function(e){var t=void 0,n=this.getValue();if(t=this.isBarCodeAppendEnabled&&n&&n.length>0?n+"\n"+e:e,this.setValue(t),this.getBarcodeHandler){this.getComponent().focus();var i=this.getBarcodeHandler();i&&i(this,t)}}}});r.getCurrentApplication().triggerEvent(e)})()},e.addCls("svmx-field-scannable"),e.getComponent().barcodeIcon&&e.getComponent().barcodeIcon.addCls("svmx-barcode-icon"),e.getEnableBarcode()&&(e.getComponent().barcodeIcon&&e.getComponent().barcodeIcon.on({scope:e,tap:e.scanBarcode}),e.getAlwaysShowBarcode()&&e.showBarcode(),e.on("focus",e.showBarcode,e),e.on("blur",e.hideBarcode,e)))};Ext.field.Input.prototype.focusOnClearIconTap=!0,Ext.field.Input.prototype.onClearIconTap=function(e){this.fireEvent("clearicontap",this,e),this.focusOnClearIconTap&&Ext.os.is.Android&&this.focus()},c.SVMXFileUpload=Ext.define(c.name+".SVMXFileUpload",{extend:"Ext.field.File",alias:"widget.svmx.fileupload"}),c.Text=Ext.define(c.name+".override.Text",{override:"Ext.field.Text",onClearIconTap:function(e,t){this.fireAction("clearicontap",[this,e,t],"doClearIconTapWrap")},doClearIconTapWrap:function(e,t){this.hideUndo||(this.__undoShowing?(this.restoreCurrentValue(),this.showClearIcon()):(this.saveCurrentValue(),this.showUndoIcon(),this.doClearIconTap(e,t)))},onInput:function(){this.__undoShowing&&(this.hideUndoIcon(),this.showClearIcon()),this.callParent(arguments)},saveCurrentValue:function(){this.__oldValue=this.getValue()},restoreCurrentValue:function(){this.setValue(this.__oldValue),this.__oldValue=null},showUndoIcon:function(){this.addCls("svmx-input-show-undo"),this.__undoShowing=!0},hideUndoIcon:function(){this.removeCls("svmx-input-show-undo"),this.__undoShowing=!1},showClearIcon:function(){this.hideUndoIcon()}}),c.Number=Ext.define(c.name+".override.Number",{override:"Ext.field.Number",doClearIconTap:function(e,t){e.__isInvalid&&(e.__input.value=""),e.setValue("")}}),c.SVMXSearchField=Ext.define(c.name+".SVMXSearchField",{extend:"Ext.field.Text",alias:"widget.svmx.field.search",config:{enableBarcode:!0,alwaysShowBarcode:!0,barcodeHandler:null},listeners:{focus:function(e,t,n){e.showClearTrigger()},blur:function(e,t,n){if(e.mousedown){var i=function i(){e.fireEvent("blur",e,t,n),document.removeEventListener("mouseup",i)};document.addEventListener("mouseup",i)}else e.hideClearTrigger()},clearicontap:function(e,t,n,i){t.setValue(""),e.searchAction&&e.searchAction()},action:function(e,t,n){e.searchAction&&e.searchAction()},initialize:function(){var e=this,t=function(){e.mousedown=!1},n=function(){e.mousedown=!0};this.getEnableBarcode()&&this.showBarcode(),document.addEventListener("mouseup",t),document.addEventListener("mousedown",n),this.on("destroy",function(){document.removeEventListener("mouseup",t),document.removeEventListener("mousedown",n)})}},initialize:function(){this.searchAction=this.config.searchAction,this.callParent(),this.getEnableBarcode()&&(_(this),this.showBarcode()),this.hideUndo=!0},__showSearchIcon:function(){this.getComponent().searchIcon.show()},__hideSearchIcon:function(){this.getComponent().searchIcon.hide()}}),c.SVMXTextField=Ext.define(c.name+".SVMXTextField",{extend:"Ext.field.Text",alias:"widget.svmx.field.text",config:{enableBarcode:!0,alwaysShowBarcode:!0,barcodeHandler:null,reformat:null,changeOnKey:!1,enableSearch:!1,moreLink:null,showReadOnlyLabel:!0},initialize:function(){this.callParent(),_(this),this.getShowReadOnlyLabel()&&this.generateReadOnlyLabel(),this.on("keyup",this.__onKeyUp,this),this.attachMoreIcon?this.addListener("change",this.updateReadOnlyValueWithMoreLink,this):this.addListener("change",this.updateReadOnlyValue,this)},__onKeyUp:function(){this.getChangeOnKey()&&this.onChange(this,this.getValue())},onChange:function(e,t,n){var i=this.__fixValue(t);i!=t&&this.setValue(i),this.callParent([this,i,n])},__fixValue:function(e){return this.reformat&&(e=this.reformat(e)),e},onreadonlytap:function(e,t){this.fireEvent("onreadonlytap",this)},updateReadOnlyValueWithMoreLink:function(e,t,n){this.__setExtendedMoreLink(this.__getReadOnlyValue(t))},__setExtendedMoreLink:function(e){if(!Ext.isEmpty(e,!0)&&this.__readOnlyLabel){var t=!!(this.attachMoreIcon&&e.length>35);e=Ext.String.htmlEncode(e),e=e.replace(/(\S{30}\b.?)/g,"$1");var n=r.string.substitute("<div style='float:left;width: 100%;position: relative;'><div class='sfm-delivery-textField-value'>{{value}}</div> <div class='svmx-editor-link sfm-delivery-textField-more-link' style='display:{{display}};'>{{linkText}}</div></div>",{display:"none",linkText:(this.getReadOnly()||this.getDisabled())&&t?d().T("FSA008_TAG063","more"):"",value:e||"&nbsp;"});this.__readOnlyLabel.setHtml(n);var i=this.getReadOnlyValue(this.getValue());null===i||void 0===i||""===i?this.__readOnlyLabel.addCls("svmx-empty-editor"):this.__readOnlyLabel.removeCls("svmx-empty-editor"),this.__updateLink()}},__updateLink:function(){var e=Ext.query(".svmx-editor-link",!0,this.__readOnlyLabel.element.dom)[0];this.__readOnlyLabel.element.dom;e&&(e.style.display="inline")}}),c.SVMXTextAreaField=Ext.define(c.name+".SVMXTextAreaField",{extend:"Ext.field.TextArea",alias:"widget.svmx.field.textarea",config:{enableBarcode:!0,alwaysShowBarcode:!0,barcodeHandler:null,changeOnKey:!1,clearIcon:!0,bodyAlign:"start"},initialize:function(){this.callParent(),_(this),!this._readOnly&&this.expandible&&(this.labelElement&&this.labelElement.addCls("form-icon-textareafield"),this.labelElement&&this.labelElement.on("singletap",r.proxy(this,"onreadonlytap"))),this.addListener("change",this.updateReadOnlyValue,this),this.on("keyup",this.__onKeyUp,this),this.addListener("resize",this.__onWidthChange,this),this.addListener("painted",this.__onWidthChange,this),this.setAutoCorrect(!0),this.setAutoComplete(!0),this.setAutoCapitalize(!0)},__onKeyUp:function(){var e=this.getComponent().inputElement;this.getChangeOnKey()&&this.onChange(this,this.getValue());var t=e&&e.dom&&e.dom.scrollHeight;t>e.getHeight()&&t<218&&e.setHeight(e.getHeight()+22)},__onWidthChange:function(){var e=this.element;if(!this.getReadOnly()&&"left"==this.getLabelAlign()){this.hideBarcode&&this.hideBarcode(),this.addCls("sfm-full-height-textarea");this.getComponent().element.setHeight(e.getHeight()-e.getMargin().top-e.getMargin().bottom-e.getPadding("t")-e.getPadding("b")-e.getBorderWidth("t")-e.getBorderWidth("b"))}}}),c.SVMXTextAreaFieldExtended=Ext.define(c.name+".SVMXTextAreaFieldExtended",{extend:c.name+".SVMXTextAreaField",alias:"widget.svmx.field.textareaextended",config:{moreLink:"...",editLink:"...",growMaxHeight:null,cls:["x-field-textarea-extended"]},initialize:function(){this.callParent(),this.addListener("change",this.updateReadOnlyValue,this),this.generateReadOnlyLabel(),this.setReadOnlyValue(this.__getReadOnlyValue(this.getValue())),this.__readOnlyLabel.setDisabled(this.getDisabled()),this._readOnly?(this.__readOnlyLabel.show(),this.getComponent().hide()):this.__readOnlyLabel.hide()},updateReadOnlyValue:function(e,t,n){this.setReadOnlyValue(this.__getReadOnlyValue(t))},updateReadOnly:function(e,t){this.updateReadonlyUI()},updateReadonlyUI:function(){this.setReadOnlyValue(this.getValue())},setReadOnlyValue:function(e){if(this.__readOnlyLabel&&e.length>0){var t=Ext.String.htmlEncode(e);t=t.replace(/(\S{30}\b.?)/g,"$1 ");var n=this.getReadOnly()||this.getDisabled()?this.getMoreLink():this.getEditLink(),i="<p>"+t.trim()+"</p>";this.__readOnlyLabel.setHtml(i);var a=this.__readOnlyLabel.element.dom;if(a.scrollHeight>a.clientHeight){var r=(Ext.isiOS||Ext.isAndroid)&&"portrait"===Ext.Viewport.getOrientation()?"truncatedStringReadMore svmx-portrait":"truncatedStringReadMore";i="<p>"+this.getTruncatedString(t,a).trim()+'<span class="'+r+'">... '+n+"</span></p>",this.__readOnlyLabel.setHtml(i)}}},getTruncatedString:function(e,t){var n=document.createElement("canvas"),i=n.getContext("2d");i.font=window.getComputedStyle(t,null).getPropertyValue("font");var a=i.measureText(e),r=parseInt(a.width/e.length),o=parseInt((t.clientWidth-10)/r),s=4*o;return e.substring(0,Ext.isiOS?s-20:s-10)},__updateLink:function(){var e=Ext.query(".svmx-editor-link",!0,this.__readOnlyLabel.element.dom)[0],t=this.__readOnlyLabel.element.dom;t.clientHeight<t.scrollHeight?e.style.display="block":e.style.display="none"},onBoxReady:function(){this.__updateLink()},afterComponentLayout:function(){this.__updateLink()},onreadonlytap:function(e,t){this.fireEvent("onreadonlytap",this)}}),c.SVMXEmailField=Ext.define(c.name+".SVMXEmailField",{extend:c.name+".SVMXTextField",alias:"widget.svmx.field.email",config:{component:{type:"email"},autoCapitalize:!1},__allowHtmlValue:!0,getReadOnlyValue:function(e){return r.string.substitute("<a href='#'>{{value}}</a>",{value:Ext.String.htmlEncode(e)})},onreadonlytap:function(){this.fireEvent("onreadonlytap",this)}}),c.SVMXUrlField=Ext.define(c.name+".SVMXUrlField",{extend:c.name+".SVMXTextField",alias:"widget.svmx.field.url",config:{autoCapitalize:!1,component:{type:"url"}},__allowHtmlValue:!0,getReadOnlyValue:function(e){return r.string.substitute("<a href='#'>{{value}}</a>",{value:Ext.String.htmlEncode(e)})},onreadonlytap:function(){this.fireEvent("onreadonlytap",this)}}),c.SVMXPasswordField=Ext.define(c.name+".SVMXPasswordField",{extend:c.name+".SVMXTextField",alias:"widget.svmx.field.password",config:{autoCapitalize:!1,component:{type:"password"}}}),c.SVMXNumberField=Ext.define(c.name+".SVMXNumberField",{extend:"Ext.field.Number",alias:"widget.svmx.field.number",config:{enableBarcode:!0,alwaysShowBarcode:!0,barcodeHandler:null,emptyValue:"",len:0,precision:0},__isInvalid:!1,initialize:function(){this.callParent(),_(this),this.addListener("change",this.updateReadOnlyValue,this),this.addListener("focus",function(e,t,n){if("0"===e.getValue()){var i=Number("0");e.setValue(i)}},this),this.__input=this.element.query("input")[0]},onChange:function(e,t,n){var i=this.__fixValue(t);i!==t&&this.setValue(i),this.callParent([this,i,n])},__formatNumber:function(e,t){var n="0,000";if(t>0){n+=".";for(var i=0;i<t;i++)n+="0"}return e=Ext.util.Format.number(e,n)},getReadOnlyValue:function(e){var t=this.getPrecision();return this.__formatNumber(e,t)},__fixValue:function(e){if(this.__isInvalid)return e;var t=void 0;if(""===e||null===e||void 0===e)return t=this.getEmptyValue();var n=String(e).split("."),i=n[0]||"0";if(this.getLen()>0){var a="",r=i.charAt(0);"-"!=r&&"+"!=r||(a=r,i=i.substring(1)),i.length>this.getLen()&&(i=i.substring(0,this.getLen())),t=a+i}else t=i;if(n.length>1&&this.getPrecision()>0){var o=n[1];o.length>this.getPrecision()&&(o=o.substr(0,this.getPrecision())),t=t+"."+o}return t},applyValue:function(e){return e&&(e=this.__fixValue(e)),e},getIsInvalid:function(){return this.__isInvalid},isNotNumber:function(e){var t=Number(e);return!!isNaN(t)},setValue:function(e){if(""!==e&&null!=e||(e=this.getEmptyValue()),e&&this.__input&&this.isNotNumber(e)&&"number"==this.__input.type&&(e=this.getRawValue()),!this.__input||(this.__isInvalid=!this.__input.checkValidity(),!this.__isInvalid)){var t=this.getRawValue();if(String(t)!=String(e)){this.callParent([e]);var n=this.getRawValue();String(n)!=String(e)&&this.__input&&(this.getComponent().setValue(n),this.__input.value=n)}}},getRawValue:function(){return this._value}}),c.SVMXDoubleField=Ext.define(c.name+".SVMXDoubleField",{extend:c.name+".SVMXNumberField",alias:"widget.svmx.field.double"}),c.SVMXCurrencyField=Ext.define(c.name+".SVMXCurrencyField",{extend:c.SVMXDoubleField,alias:"widget.svmx.field.currency",config:{precision:2}}),c.SVMXPercentField=Ext.define(c.name+".SVMXPercentField",{extend:c.SVMXDoubleField,alias:"widget.svmx.field.percent"}),c.SVMXPhoneField=Ext.define(c.name+".SVMXPhoneField",{extend:c.name+".SVMXTextField",alias:"widget.svmx.field.phone",config:{ui:"number"},__allowHtmlValue:!0,onChange:function(e,t,n){if(""!==t){var i=this.__fixValue(t);i!==t&&this.setValue(i),this.callParent([this,i,n])}else this.callParent([this,t,n])},__fixValue:function(e){return e=String(e)},applyValue:function(e){return e&&""!==e&&(e=this.__fixValue(e)),e},getReadOnlyValue:function(e){return r.string.substitute("<a href='#'>{{value}}</a>",{value:Ext.String.htmlEncode(e)})},onreadonlytap:function(){this.fireEvent("onreadonlytap",this)}}),c.SVMXNumberSpinnerField=Ext.define(c.name+".SVMXNumberSpinnerField",{extend:"Ext.field.Spinner",alias:"widget.svmx.field.numberspinner"}),c.SVMXHiddenField=Ext.define(c.name+".SVMXHiddenField",{extend:"Ext.field.Hidden",alias:"widget.svmx.field.hidden"}),c.SVMXCheckboxField=Ext.define(c.name+".SVMXCheckboxField",{extend:"Ext.field.Checkbox",alias:"widget.svmx.field.checkbox",labelWidth:"100%",config:{readOnly:!1,useReadOnlyLabel:!1},constructor:function(e){e||(e={}),Ext.apply(e,{labelAlign:e.labelAlign||"top"}),this.callParent([e])},initialize:function(){this.callParent(),this.addListener("change",this.updateReadOnlyValue,this)},onMaskTap:function(e,t){this.getReadOnly()||this.callParent(arguments)},setLabelAlign:function(e){var t=null;t=this.getReadOnly()||"top"==e?"top":"bottom"==e?"left":e,this.callParent([t])}}),c.SVMXRadioField=Ext.define(c.name+".SVMXRadioField",{extend:"Ext.field.Radio",alias:"widget.svmx.field.radio",config:{readOnly:!1,useReadOnlyLabel:!1},onMaskTap:function(e,t){this.getReadOnly()||this.callParent(arguments)},initialize:function(){this.callParent(),this.addListener("change",this.updateReadOnlyValue,this)}}),c.SVMXCheckboxGroup=Ext.define(c.name+".SVMXCheckboxGroup",{extend:c.name+".SVMXFieldSet",alias:"widget.svmx.field.checkboxgroup",config:{name:"defaultGroup",delimiter:";",value:"",required:!1,defaults:{xtype:"svmx.field.checkbox"}},cls:"svmx-checkbox-group",layout:"default",statics:{nextId:0},initConfig:function(e){e.name||(e.name="defaultGroup"+c.SVMXCheckboxGroup.nextId++),r.array.forEach(e.items||[],function(t){t.xtype&&"svmx.field.radio"!=t.xtype&&"svmx.field.checkbox"!=t.xtype||(t.name=e.name||this.config.name)},this),this.callParent([e])},initialize:function(){this.__originalValue=this.value,this.items.each(function(e){e.addListener("check",this.onChange,this),e.addListener("uncheck",this.onChange,this)},this)},onChange:function(){var e=this.getValue();e!==this.__originalValue&&this.fireEvent("change",this,e)},applyValue:function(e){return e?Ext.isArray(e)||(e=e.split(this.getDelimiter())):e=[],this.items.each(function(t){if(t instanceof c.SVMXCheckboxField){var n=t.getValue(),i=t.getChecked(),a=Boolean(r.array.get(e,n));i!=a&&t.setChecked(a)}},this),this.getValue()},getValue:function(){return this.getAt(0).getGroupValues()},reset:function(){this.setValue(this.__originalValue)},resetOriginalValue:function(){this.__originalValue=this.getValue()}}),c.SVMXRadioGroup=Ext.define(c.name+".SVMXRadioGroup",{extend:c.name+".SVMXCheckboxGroup",alias:"widget.svmx.field.radiogroup",config:{value:"",defaults:{xtype:"svmx.field.radio"}},initialize:function(){this.__originalValue=this.value,this.items.each(function(e){e.addListener("check",this.onChange,this)},this)},applyValue:function(e){return this.items.each(function(t){if(t instanceof c.SVMXRadioField){var n=t.getValue(),i=t.getChecked();n!==e||i?n!==e&&i&&t.setChecked(!1):t.setChecked(!0)}},this),this.getValue()},getValue:function(){var e=this.getAt(0).getGroupValues();return e.length?e[0]:""}}),c.SVMXPicklistModel=Ext.define(c.name+".SVMXPicklistModel",{extend:s,alias:"widget.svmx.picklist.model",fields:[{name:"label"},{name:"value"}]}),c.SVMXSelect=Ext.define(c.name+".SVMXSelect",{extend:"Ext.field.Select",alias:"widget.svmx.field.select",triggers:{expand:{ui:"trigger-select"}}}),c.SVMXPicklistField=Ext.define(c.name+".SVMXPicklistField",{extend:c.name+".SVMXSelect",alias:"widget.svmx.field.picklist",config:{valueField:"value",displayField:"label",emptyValue:"",cls:"svmx-picklist-field",hideOnMaskTap:!0,scrollerActualOffset:0,usePicker:!1,defaultTabletPickerConfig:{bubbleEvents:"transientState",cls:Ext.baseCSSPrefix+"select-overlay svmx-picklist-overlay",height:"auto",listeners:{show:function(e,t){},painted:function(e,t){var n=this.tabletPicker;if(Ext.isWindows&&n&&n._anchorPosition&&"top"===n._anchorPosition.side)if(n._y+n.element.dom.clientHeight>Ext.getBody().getViewSize().height){var i=n._y-n.element.dom.scrollHeight-49;n.translatableBehavior.translatable.doTranslate(n._x,i),n.tipElement.removeCls("x-anchor-top"),n.tipElement.addCls("x-anchor-bottom")}else"top"===n._anchorPosition.side&&n.tipElement.hasCls("x-anchor-bottom")&&n.tipElement.removeCls("x-anchor-bottom")},beforeShow:function(e,t){var n=this;if(window.plugins&&window.plugins.listpicker&&!e.isShowing){if("IPAD"===r.getClientTypeForUnifiedApp()&&this.parent&&this.parent.parent){var i=this.parent.parent.getScrollable();if(i){var a=i.getElement();a&&(a.dom.scrollTop=this.config.scrollerActualOffset)}}e.isShowing=!0;for(var o=this.getStore(),s=o.data.length,l=[],c=0;c<s;c++){var u=o.getAt(c);l.push({text:u.data.label||u.data.opLabel,value:u.data.value||u.data.opValue})}var _=this.getLabel(),h={title:_,items:l,selectedValue:this.getValue(),doneButtonLabel:d().T("FSA016_TAG047","Done"),cancelButtonLabel:d().T("FSA016_TAG004","Cancel")};return window.plugins.listpicker.showPicker(h,function(t){e.isShowing=!1,n.selectedFromNativePicker(t)},function(){e.isShowing=!1}),!1}}}},defaultPhonePickerConfig:{bubbleEvents:"transientState",listeners:{show:function(){this.fireEvent("transientState",{state:this,type:"open",handler:function(){this.fireEvent("cancel",this),this.hide(),Ext.util.InputBlocker.unblockInputs()},scope:this})},hide:function(){this.fireEvent("transientState",{state:this,type:"close"})}}}},selectedFromNativePicker:function(e){this.setValueHandler(e)},initialize:function(){this.callParent(),this.addListener("change",this.updateReadOnlyValue,this),this.addListener("focus",this.onGetScrollerActualOffset,this)},setValueHandler:function(e){this.emptyReadonlyTag=this.__emptyReadonlyTag,this.__addMissingValueToRecords(e),this.setValue(e&&"object"===(void 0===e?"undefined":(0,a.default)(e))?e.value:e)},__addMissingValueToRecords:function(e){var t=this.getValueField();if(e){var n=this.getStore();if(Ext.isString(e)){var i=n.findRecord(t,e);i||(i={},i[this.getValueField()]=e,i[this.getDisplayField()]=e,n.add(i))}}},getReadOnlyValue:function(e){var t=this.getSelection();return t&&"noValue"!==t.get("value")?t.get("label"):""},onGetScrollerActualOffset:function(){if("IPAD"===r.getClientTypeForUnifiedApp()&&this.parent&&this.parent.parent&&this.parent.parent.getScrollable){var e=this.parent.parent.getScrollable();if(e){var t=e.getElement();t&&t.dom&&(this.config.scrollerActualOffset=t.dom.scrollTop)}}}}),c.SVMXMultiPicklistField=Ext.define(c.name+".SVMXMultiPicklistField",{extend:c.name+".SVMXSelect",alias:"widget.svmx.field.multipicklist",__scrollerActualOffset:null,config:{delimiter:";",mode:"MULTI",doneButton:!0,clearButton:!1,cls:"svmx-picklist-field",valueField:"value",displayField:"label",emptyValue:"",placeHolder:"",listeners:{focus:function(e,t,n){if("IPAD"===r.getClientTypeForUnifiedApp()&&this.parent&&this.parent.parent){var i=this.parent.parent.getScrollable();if(i){var a=i.getElement();a&&(this.__scrollerActualOffset=a.dom.scrollTop)}}}}},initialize:function(){this.callParent(),this.addListener("change",this.updateReadOnlyValue,this)},applyDoneButton:function(e){return e&&(Ext.isBoolean(e)&&(e={}),"string"==typeof e&&(e={text:e}),Ext.applyIf(e,{text:d().T("FSA014_TAG001","Apply"),cls:"svmx-multipick-apply-button",listeners:{tap:this.onDoneButtonTap,scope:this}})),Ext.factory(e,"Ext.Button",this.getDoneButton())},applyClearButton:function(e){return e&&(Ext.isBoolean(e)&&(e={}),"string"==typeof e&&(e={text:e}),Ext.applyIf(e,{text:d().T("FSA014_TAG002","Clear"),cls:"svmx-multipick-clear-button",listeners:{tap:this.onClearButtonTap,scope:this}})),Ext.factory(e,"Ext.Button",this.getClearButton())},getTabletPicker:function(){var e=this,t=e.getDefaultTabletPickerConfig(),n=e.getMode(),i=void 0;return e.listPanel||(e.listPanel=Ext.widget("svmx.panel",Ext.apply({left:0,top:0,modal:!0,cls:Ext.baseCSSPrefix+"select-overlay svmx-multipicklist-overlay",layout:"fit",hideOnMaskTap:!0,width:Ext.os.is.Phone?"14em":"18em",height:Ext.os.is.BlackBerry&&10===Ext.os.version.getMajor()?"12em":Ext.os.is.Phone?"12.5em":"22em",items:[{xtype:"list",mode:n,store:e.getStore(),itemTpl:'<span class="x-list-label">{'+e.getDisplayField()+":htmlEncode}</span>"},{xtype:"toolbar",docked:"bottom",layout:{pack:"center",type:"hbox"}}]},t)),"SINGLE"===n?e.listPanel.down("list").on("itemtap",e.onListTap,e):(i=e.listPanel.down("toolbar"),t=this.getClearButton(),t&&i.add(t),i.add(this.getDoneButton()))),e.listPanel},onListTap:function(e,t,n,i){this.setValue(i),this.callParent()},onDoneButtonTap:function(){var e=this.listPanel.down("list").getSelections();this.setValue(e),this.getTabletPicker().hide()},onClearButtonTap:function(){this.listPanel.down("list").deselectAll(),this.setValue(null),this.getTabletPicker().hide()},applyValue:function(e){return this.getValueFromRecords(e,this.getValueField())},updateValue:function(e,t){this.callParent([e,t]);var n=this,i=n.convertValue(e,n.getValueField(),n.getDisplayField());i=i.join(n.getDelimiter()),n.getComponent().updateValue([i])},getThisBaseClass:function(){for(var e=this,t=e;t.getClassName()!==c.name+".SVMXMultiPicklistField";)t=t.superclass;return t},convertValue:function(e,t,n){var i=this.getDelimiter(),a=this.getStore(),r=0,o=[],s=void 0,l=void 0;if(e)for(i&&Ext.isString(e)?e=e.split(i):Ext.isArray(e)||(e=[e]),s=e.length;r<s;++r)(l=a.findRecord(t,e[r]))&&o.push(l.get(n));return o},getValueFromRecords:function(e){var t=this.getDelimiter(),n=this.getValueField(),i=0,a=[],r=void 0,o=void 0;if(e){for(t&&Ext.isString(e)?e=e.split(t):Ext.isArray(e)||(e=[e]),r=e.length;i<r;++i)(o=e[i])&&o.isModel&&a.push(o.get(n));a=Ext.Array.unique(a),a.length>0&&a.sort()}return a.length>0?a:e},getRecordsFromValue:function(e){var t=[],n=this.getStore().getRange(),i=this.getValueField(),a=0,r=n.length,o=void 0,s=void 0,l=void 0;if(e)for(l=e.length;a<l;++a)for(s=0;s<r;++s)if(o=n[s],o.get(i)==e[a]){t.push(o);break}return t},getSelection:function(){return this.listPanel.down("list").getSelections()},getValue:function(){return this._value},setValue:function(e){this.__addMissingValueToRecords(e),this.callParent([e])},__addMissingValueToRecords:function(e){var t=this.getDelimiter(),n=this.getValueField(),i=0,a=void 0,r=void 0;if(e){t&&Ext.isString(e)?e=e.split(t):Ext.isArray(e)||(e=[e]);var o=this.getStore();for(a=e.length;i<a;++i)if(r=e[i],Ext.isString(r)&&"noValue"!==r){var s=o.findRecord(n,r);s||(s={},s[this.getValueField()]=r,s[this.getDisplayField()]=r,o.add(s))}}},onChange:function(e,t,n){var i=this,a=i.convertValue(n,i.getDisplayField(),i.getValueField());i.fireEvent("change",i,i.getValue(),a)},showPicker:function(){var e=this,t=this.getStore();if(t&&0!==t.getCount()&&!e.getReadOnly()){e.isFocused=!0;var n=e.getTabletPicker(),i=n.down("list"),a=void 0,o=e.getValue();if(o?(a=e.getRecordsFromValue(o),i.select(a,null,!0)):i.deselectAll(),n.showBy(e.getComponent(),null),"IPAD"===r.getClientTypeForUnifiedApp()&&this.parent&&this.parent.parent){var s=this.parent.parent.getScrollable();if(s){var l=s.getElement();l&&(l.dom.scrollTop=this.__scrollerActualOffset)}}}},onStoreDataChanged:function(e){var t=this,n=t.getInitialConfig(),i=t.getValue();(i||0===i)&&t.updateValue(t.applyValue(i)),null===t.getValue()&&(n.hasOwnProperty("value")&&t.setValue(n.value),null===t.getValue()&&t.getAutoSelect()&&e.getCount()>0&&t.setValue(e.getAt(0)))},getReadOnlyValue:function(e){var t=this;return value=t.convertValue(e,t.getValueField(),t.getDisplayField()),value=value.join(t.getDelimiter()),value}}),c.SVMXLookupField=Ext.define(c.name+".SVMXLookupField",{extend:c.name+".SVMXTextField",alias:"widget.svmx.field.lookup",config:{enableBarcode:!1,fullValue:null,cls:["svmx-lookup","svmx-lookup-icon"]},component:{useMask:!0},showUndoIcon:function(){this.addCls("svmx-lookup-icon"),this.addCls("svmx-input-show-undo"),this.__undoShowing=!0},hideUndoIcon:function(){this.removeCls("svmx-lookup-icon"),this.removeCls("svmx-input-show-undo"),this.__undoShowing=!1},initialize:function(){this.callParent(),this.element.on("singletap",this.onTapHandler,this),this.element.on("doubletap",this.onTapHandler,this),this.getComponent().setReadOnly("true")},setValueHandler:function(e){this.emptyReadonlyTag=this.__emptyReadonlyTag,this.setFullValue(e||{key:e,value:e}),this.setValue(e&&"object"===(void 0===e?"undefined":(0,a.default)(e))?e.value:e),e||this.updateReadOnlyValue(this,"",null),this.showClearTrigger(!0)},getValueHandler:function(){return this.getFullValue()},onTapHandler:function(e,t){if(!this.getDisabled()){var n=t.parentNode;if(n){var i=n.classList;for(key in i)if("x-cleartrigger"===i[key])return}"x-clear-icon"!=t.className&&this.fireEvent("ontap",this,this.getFullValue())}},doClearIconTap:function(e,t){this.setValueHandler("")},saveCurrentValue:function(){this.__oldValue=this.getValueHandler()},restoreCurrentValue:function(){this.setValueHandler(this.__oldValue),this.__oldValue=null},__allowHtmlValue:!0,getReadOnlyValue:function(e){return r.string.substitute("<a href='#'>{{value}}</a>",{value:Ext.String.htmlEncode(e)})}}),c.SVMXPicker=Ext.define(c.name+".SVMXPicker",{extend:"Ext.picker.Picker",alias:"widget.svmx.picker"}),Ext.field.Text.prototype.scrollIntoView=function(){return Ext.Component.prototype.scrollIntoView.apply(this),this.focus()},Ext.field.Text.prototype.scrollableIntoViewByFocus=!0,Ext.field.Picker.prototype.scrollableIntoViewByFocus=!1,Ext.field.Picker.prototype.scrollIntoView=Ext.Component.prototype.scrollIntoView=function(e){var t=this;if(void 0===e&&(e=!1),t)for(var n=t.parent,i=void 0;n;){if(void 0!==(i=n.getScrollable())&&null!==i&&!1!==i){if(void 0!==n.config.scrollReferenceFromParent&&!0===n.config.scrollReferenceFromParent){n=n.parent;continue}var a=t.element.getX()-n.element.getX(),r=t.element.getY()-n.element.getY()-50;(t.scrollOffset||t.config.scrollOffset)&&(r+=t.scrollOffset||t.config.scrollOffset),i.scrollBy(a,r,e);break}n=n.parent}},c.SVMXPickerField=Ext.define(c.name+".SVMXPickerField",{extend:"Ext.field.Picker",alias:"widget.svmx.field.picker",initialize:function(e){this.callParent(arguments)}}),c.SVMXDateTimeField=Ext.define(c.name+".SVMXDateTimeField",{extend:c.name+".SVMXPickerField",alias:"widget.svmx.field.datetime",_value:null,config:{returnType:"string",cls:"svmx-datetime-down-arrow",useTitles:!0,hideOnReadOnly:!1,minuteInterval:0,dateOnly:!1,value:null,format:void 0,clearIcon:!0},initConfig:function(e){this._value=e.value,this.__initialConfig=e,e.format=e.format||u.getDefaultDatetimeFormat(),this.callParent([e])},initialize:function(){this.callParent();var e=this.getComponent();e&&(e.focusOnClearIconTap=!1),this.updateValue(this._value,this._value),this.enableBubble("transientState");var t=this.getTriggers();t.expand&&t.expand.hide()},onPickerOpen:function(e,t,n){this._picker&&this.fireEvent("transientState",{state:this,type:"open",handler:this.closePicker,scope:this})},onPickerClose:function(e){this._picker&&this.fireEvent("transientState",{state:this,type:"close"})},closePicker:function(){this._picker&&!this._picker.isHidden()&&this._picker.onCancelButtonTap()},getPicker:function(){if(!this._picker||!this._picker.isPicker){if(window.datePicker)return this.getNativeDatePicker();var e={value:this._value,dateOnly:this.getDateOnly(),useTitles:this.getUseTitles(),minuteInterval:this.getMinuteInterval(),format:this.getFormat(),doneButton:d().T("FSA016_TAG047","Done"),cancelButton:d().T("FSA016_TAG004","Cancel"),listeners:{scope:this,hide:this.onPickerClose,show:this.onPickerOpen,change:this.handlePickerResponse}};this.__initialConfig.doneButton&&(e.doneButton=this.__initialConfig.doneButton),this.__initialConfig.cancelButton&&(e.cancelButton=this.__initialConfig.cancelButton),this._picker=Ext.widget("svmx.datetimepicker",e)}return this._picker},getNativeDatePicker:function(){var e=this,t=24==u.isFormat24HourTime(this.getFormat()),n=this.getDateOnly()?"date":"datetime",i=o.getSaveFormat("datetime"),a=this._value||u.parseGMTDate(u.getCurrentDatetimeGMT(i));a=u.parseDate(u.convertToTimezone(a));var r={date:new Date(a),mode:n,okText:d().T("FSA016_TAG047","Done"),cancelText:d().T("FSA016_TAG004","Cancel"),todayText:d().T("FSA001_TAG054","Today"),nowText:"",is24Hour:t,androidTheme:"THEME_HOLO_LIGHT",title:this.getLabel()||"",allowOldDates:!0,allowFutureDates:!0,doneButtonLabel:d().T("FSA016_TAG047","Done"),cancelButtonLabel:d().T("FSA016_TAG004","Cancel"),minuteInterval:this.getMinuteInterval(),locale:u.getLocale()};return{show:function(){window.datePicker.show(r,e.nativeDatePickerOnSuccess.bind(e),e.nativeDatePickerOnCancel.bind(e))}}},nativeDatePickerOnSuccess:function(e){e&&this.setValue(e)},nativeDatePickerOnCancel:function(e){},handlePickerResponse:function(e,t){this.updateValue(t,this._value)},getValue:function(){var e=this.callParent();return"number"==typeof e&&(e=u.parseGMTDate(e)),e&&"[object Date]"===Object.prototype.toString.call(e)&&e.setSeconds(0),"string"==this.getReturnType()&&e&&null!==e.toJSON()?this.getDateOnly()?u.getFormattedDatetime(e.toISOString(),u.getSaveFormat("date")):u.getFormattedUTCDatetime(e.toISOString(),u.getSaveFormat("datetime")):e},setValue:function(e){""===e&&(e=null),"string"==typeof e&&(e=this.getDateOnly()?u.parseDateOnly(e):u.parseGMTDate(e)),e&&"function"==typeof e.setSeconds&&e.setSeconds(0),this.callParent([e])},updateValue:function(e,t){if(this._picker&&this._picker.isPicker&&this._picker.setValue(e),e&&0!==e){var n=u.convertToTimezone(e),i=u.getFormattedDatetime(n,this.getFormat());this.__readOnlyLabel&&this.setReadOnlyValue(i),this.getComponent().setValue(i)}else this.__readOnlyLabel&&this.setReadOnlyValue(""),this.getComponent().setValue("");e!==t&&(this.fireEvent("change",this,e,t),this._value=e),this.showClearTrigger(!0)},showUndoIcon:function(){this.addCls("svmx-datetime-down-arrow"),this.addCls("svmx-input-show-undo"),this.__undoShowing=!0},hideUndoIcon:function(){this.removeCls("svmx-datetime-down-arrow"),this.removeCls("svmx-input-show-undo"),this.__undoShowing=!1},getFormattedValue:function(e){var t=u.convertToTimezone(this._value);return u.getFormattedDatetime(t,this.getFormat())},applyDateFormat:function(e){return e||this.getFormat()},updateDateFormat:function(e){var t=this._value;this.getComponent().setValue(u.getFormattedDatetime(t,this.getFormat()))},getReadOnlyValue:function(e){var t="";return e&&(t=u.getFormattedDatetime(e,this.getFormat())),t},onFocus:function(e){var t=this.__getScrollerActualOffset(),n=this.getComponent();if(this.fireEvent("focus",this,e),Ext.os.is.Android4&&n.inputElement.dom.focus(),n.inputElement.dom.blur(),this.getReadOnly())return!1;this.isFocused=!0,this.getPicker().show(),this.__setScrollerActualOffset(t)},__getScrollerActualOffset:function(){var e=0;if("IPAD"===r.getClientTypeForUnifiedApp()&&this.parent&&this.parent.parent){var t=this.parent.parent.getScrollable();if(t){var n=t.getElement();n&&(e=n.el.dom.scrollTop)}}return e},__setScrollerActualOffset:function(e){if("IPAD"===r.getClientTypeForUnifiedApp()&&this.parent&&this.parent.parent){var t=this.parent.parent.getScrollable();if(t){var n=t.getElement();n&&(n.el.dom.scrollTop=e)}}}}),c.SVMXDateField=Ext.define(c.name+".SVMXDateField",{extend:c.name+".SVMXDateTimeField",alias:"widget.svmx.field.date",config:{returnType:"string",cls:"svmx-datetime-down-arrow",useTitles:!0,dateOnly:!0,format:void 0},initConfig:function(e){e.format=e.format||u.getDefaultDateFormat(),this.callParent([e])}}),c.SVMXCalendarPanel=Ext.define(c.name+".SVMXCalendarPanel",{extend:"Ext.Component",alias:"widget.svmx.field.calendar",cls:"svmx-datepicker-calendar",days:null,months:null,maxDate:null,minDate:null,weekstart:0,_value:null,_displayMonth:null,constructor:function(e){e=e||{},this._value=e.value||new Date,this.months=l.months(),this.days=l.weekdaysMin(),"string"!=typeof this._value&&"number"!=typeof this._value||(console.warn("SVMXCalendar was passed a string or number, unexpected date may be displayed."),this._value=u.parseDateOnly(this._value)),this.callParent(arguments),this.minDate=this.minDate?this.minDate.clearTime(!0):null,this.maxDate=this.maxDate?this.maxDate.clearTime(!0):null},initialize:function(){this.el.on("click",function(e,t){if(t=Ext.fly(t),!t.hasCls("unselectable")){var n=this.getCellDate(t),i=n.toISOString(),a=this._value;this.setValue(u.parseGMTDate(i)),this.fireEvent("change",this,a,this._value)}},this,{delegate:"td"}),this.el.on("click",function(e,t){t=Ext.fly(t),t.hasCls("goto-prevmonth")&&this.loadMonthDelta(-1),t.hasCls("goto-nextmonth")&&this.loadMonthDelta(1)},this,{delegate:"th"});var e=this.createCalendarHtml(this._value.getMonth(),this._value.getFullYear());this.setHtml(e),this.setToday(),this.setValue(this._value),this.callParent(arguments)},removeSelectedCell:function(){this.el.select(".selected").removeCls("selected")},setToday:function(){var e=new Date;this.el.select('td[datetime="'+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+'"]').addCls("today")},setSelected:function(e,t){this.removeSelectedCell(),this.el.select("td").each(function(n){var i=this.getCellDate(n);if(n.hasCls("prevmonth")||n.hasCls("nextmonth")||!this.sameDay(e,i)){if((n.hasCls("prevmonth")||n.hasCls("nextmonth"))&&this.sameDay(e,i)&&!t){this._displayMonth=e;var a=this.createCalendarHtml(e.getMonth(),e.getFullYear());this.setHtml(a),this.setSelected(e)}}else n.addCls("selected")},this),this.setToday()},setValue:function(e){this._value=e,"string"!=typeof this._value&&"number"!=typeof this._value||(console.warn("SVMXCalendar was passed a string or number, unexpected date may be displayed."),this._value=u.parseDateOnly(this._value)),this.loadMonth(this._value)},getValue:function(){return this._value},getCellDate:function(e){var t=e.dom.getAttribute("datetime");return t=u.parseDateOnly(t,"YYYY-MM-DD")},sameDay:function(e,t){return e.getDate&&t.getDate&&e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},createCalendarHtml:function(e,t){var n=new Date;n.setDate(1),n.setMonth(e),n.setFullYear(t);var i=parseInt(this.weekstart,10),a=(n.getDay()-i)%7;a<0&&(a+=7);var r=this.monthLength(e,t),o='<table class="month-header" cellspacing="0"><thead class="header"><tr>';o+='<th class="goto-prevmonth"></th>',o+="<th><span>"+this.months[e]+" "+t+"</span></th>",o+='<th class="goto-nextmonth"></th>',o+='</tr></table><table class="month-body" cellspacing="0"><thead class="day-names"><tr>',o+="<th>"+this.days[(0+i)%7]+"</th>",o+="<th>"+this.days[(1+i)%7]+"</th>",o+="<th>"+this.days[(2+i)%7]+"</th>",o+="<th>"+this.days[(3+i)%7]+"</th>",o+="<th>"+this.days[(4+i)%7]+"</th>",o+="<th>"+this.days[(5+i)%7]+"</th>",o+="<th>"+this.days[(6+i)%7]+"</th>",o+="</tr>",o+="</thead>",o+="<tbody>",o+="<tr>";for(var s=a;s>0;s--){var l=e-1<0?t-1:t;o+=this.dayMarkup(0,r-s+1,(e+11)%12,l,(a-s+i)%7)}for(r=this.monthLength(e+1,t),s=1;s<=r;s++)a%7==0&&(o+="</tr>",o+="<tr>",a=0),o+=this.dayMarkup(1,s,e,t,(a+i)%7),a++;var c=1;for(s=a;s<7;s++){var u=e+1>11?t+1:t;o+=this.dayMarkup(9,c,(e+1)%12,u,(s+i)%7),c++}return o+="</tr>",o+="</tbody>",o+="</table>"},monthLength:function(e,t){return new Date(t,e,0).getDate()},dayMarkup:function(e,t,n,i,a){var r=["day"];0===e?r.push("prevmonth"):9==e&&r.push("nextmonth"),0!==a&&6!=a||r.push("weekend");var o=i+"-"+(n+1)+"-"+t,s=new Date(i,n,t);(this.minDate&&s<this.minDate||this.maxDate&&s>this.maxDate)&&r.push("unselectable");var l='<td class="'+r.join(" ")+'" datetime="'+o+'"><span>';return l+=t,l+="</span></td>"},loadMonthDelta:function(e){this._displayMonth=this._displayMonth||this._value;var t=this._displayMonth.getMonth()+e,n=this._displayMonth.getFullYear();this._displayMonth=new Date(n,t,1),this.loadMonth(this._displayMonth)},loadMonth:function(e){var t=this.createCalendarHtml(e.getMonth(),e.getFullYear());this.setHtml(t),this.setSelected(this._value,!0)}}),c.SVMXDateTimePicker=Ext.define(c.name+".SVMXDateTimePicker",{alias:"widget.svmx.datetimepicker",extend:"com.servicemax.client.ui.components.modern.popups.SVMXSheet",height:null,floating:!0,modal:!0,centered:!0,layout:{type:"vbox",align:"start"},items:[],_is24Hr:!0,hideOnMaskTap:!1,_hoursField:null,_minutesField:null,_sliderField:null,_timeComponent:null,_calendarLabel:null,_calendarComponent:null,value:null,_value:null,cls:"svmx-date-picker",config:{doneButton:!0,minuteInterval:0,value:new Date,dateOnly:!1,format:u.getDefaultDatetimeFormat()},constructor:function(){this.callParent(arguments);var e={xtype:"svmx.button",ui:"svmx-toolbar-btn",cls:"datetime-cancel-button",text:d().T("FSA016_TAG004","Cancel"),handler:r.proxy(this,function(){this.destroy()})},t={xtype:"svmx.button",ui:"svmx-toolbar-btn",cls:"datetime-done-button",text:d().T("FSA008_TAG028","Done"),handler:r.proxy(this,"onDoneButtonTap")},n={xtype:"svmx.toolbar",ui:"svmx-toolbar-grey",cls:"sfmevent-edit-dialog-toolbar",items:[e,{xtype:"spacer"},t]};this.add(n),this._is24Hr=24==u.isFormat24HourTime(this.getFormat());var i=this.value||u.parseGMTDate(u.getCurrentDatetimeGMT());i=this._value=u.parseDate(u.convertToTimezone(i)),this.getDateOnly()?(this._dateComponent=this.getDateComponent(),this.add(this._dateComponent),this.setValue(this.value),this._dateComponent.add(this._calendarLabel)):(this._timeComponent=this.getTimeComponent(),this.add(this._timeComponent))},setValue:function(e,t,n){if(e=e||new Date,this.value=u.parseGMTDate(e),this.callParent(arguments),this._value=u.parseDate(u.convertToTimezone(this.value)),this._dateComponent&&this._dateComponent.setValue(this._value),!this.getDateOnly()){if(this._sliderField){this._sliderField.suspendEvents();var i=60*this._value.getHours()+this._value.getMinutes();this._sliderField.setValue(i),this._sliderField.resumeEvents(!1)}if(this._hoursField){this._hoursField.suspendEvents();var a=void 0;this._is24Hr?a=this._value.getHours():(a=this._value.getHours()%12,a=0===a?12:a),this._hoursField.setValue(a),this._hoursField.resumeEvents(!1)}this._minutesField&&(this._minutesField.suspendEvents(),this._minutesField.setValue(this._value.getMinutes()),this._minutesField.resumeEvents(!1)),this._ampmField&&!this._is24Hr&&(this._ampmField.suspendEvents(),this._ampmField.setText(u.getFormattedDatetime(this._value,"A")),this._ampmField.resumeEvents(!1))}},getValue:function(e){return this.callParent(arguments),this._value&&(this.value=u.parseGMTDate(this._value.toISOString())),this.value&&"[object Date]"===Object.prototype.toString.call(this.value)?new Date(this.value.setSeconds(0)):this.value},getDateComponent:function(){if(this._dateComponent)return this._dateComponent;var e=this;return this._calendarLabel=this.getCalendarLabel(),this._calendarComponent=this.getCalendarComponent(),this._calendarComponent.on({change:function(e,t,n){var i=this.getValue(),a=this._calendarComponent.getValue();i.setFullYear(a.getFullYear()),i.setMonth(a.getMonth()),i.setMonth(a.getMonth()),i.setDate(a.getDate()),this.setValue(i)},scope:e}),Ext.widget("svmx.panel",{layout:"vbox",items:[this._calendarComponent],setValue:function(t){e._calendarLabel.setValue(t),e._calendarComponent.setValue(t)}})},__formatDateForDayTitle:function(e){return"en"==u.getLocale()?u.getFormattedDatetime(e,"MMM D, YYYY"):u.getFormattedDatetime(e,"LL")},getTimeComponent:function(){this._dateComponent=this.getDateComponent(),this._dateComponent.setValue(this._value),this._hoursField=this.getHoursField(),this._hoursField.setValue(this._value.getHours()),this._minutesField=this.getMinutesField(),this._minutesField.setValue(this._value.getMinutes()),this._ampmField=this.getAmPmField(),this._is24Hr||this._ampmField.setText(u.getFormattedDatetime(this._value,"A"));var e=60*this._value.getHours()+this._value.getMinutes();this._sliderField=this.getSlider(),this._sliderField.setValue(e);var t=function(e){this._value.setHours(Math.floor(e.getValue()/60)),this._value.setMinutes(e.getValue()%60);var t=this._value.toISOString();return this.setValue(u.parseGMTDate(t)),!1},n=function(){if(this.getHoursField().isValid()&&this.getMinutesField().isValid()){var e=this._is24Hr?this._hoursField.getValue():this._hoursField.getValue()+(this._ampmField.getValue()?12:0);this._is24Hr||this._ampmField.getValue()||12!==e?!this._is24Hr&&this._ampmField.getValue()&&24===e&&(e=12):e=0,("PM"===this._ampmField.getText()&&12!==e||this._hoursField.isPM)&&(e+=12),this._value.setHours(e),this._value.setMinutes(this._minutesField.getValue());var t=this._value.toISOString();return this.setValue(u.parseGMTDate(t)),!1}};this._sliderField.on({dragchange:t,drag:t,scope:this}),this._hoursField.on({change:n,scope:this}),this._minutesField.on({change:n,scope:this}),this._calendarLabel.setFlex(2),this._hoursField.setFlex(1),this._ampmField.setFlex(1),this._minutesField.setFlex(1);var i=Ext.widget("svmx.panel",{layout:{type:"hbox",pack:"center",align:"center"},items:[this._calendarLabel,this._hoursField,{xtype:"svmx.label",text:":"},this._minutesField,this._ampmField]});return{xtype:"svmx.panel",layout:"fit",items:[this._dateComponent,i,this._sliderField],width:"100%"}},getAmPmField:function(){if(this._ampmField)return this._ampmField;var e=this;return Ext.widget("svmx.button",{cls:"svmx-datetime-picker-ampm-field",text:"",value:!1,handler:function(){if(!e._is24Hr){var t=e.value;e._value.getHours()>=12?(t.setHours(t.getHours()-12),this.value=!0):(t.setHours(t.getHours()+12),this.value=!1),e.setValue(t),this.setText(u.getFormattedDatetime(e._value,"A"))}},privates:{getValue:function(){return this.value},setValue:function(t){e._is24Hr||(t.getHours()>=12?this.value=!0:this.value=!1,this.setText(u.getFormattedDatetime(t,"A")))}}})},getMinutesField:function(){return this._minutesField?this._minutesField:Ext.widget("svmx.field.paddednumber",{clearIcon:!1,hideTrigger:!0,zeroPadding:2,allowBlank:!1,cls:"svmx-datetime-picker-minutes-field",value:0,minValue:0,maxValue:59})},getHoursField:function(){return this._hoursField?this._hoursField:Ext.widget("svmx.field.paddedhour",{clearIcon:!1,hideTrigger:!0,zeroPadding:1,allowBlank:!1,cls:"svmx-datetime-picker-hours-field",value:0,is24Hr:this._is24Hr,minValue:this._is24Hr?0:1,maxValue:this._is24Hr?23:12})},getSlider:function(){return this._sliderField?this._sliderField:Ext.widget("svmx.field.slider",{value:0,minValue:0,maxValue:1425,increment:15,liveUpdate:!0})},getCalendarComponent:function(){return this._calendarComponent?this._calendarComponent:Ext.widget("svmx.field.calendar",{xtype:"svmx.field.calendar",value:this._value})},getCalendarLabel:function(){if(this._calendarLabel)return this._calendarLabel;var e=this,t=this.getDateOnly()?"svmx-datetime-selected-date-label-no-time":"svmx-datetime-selected-date-label",n=Ext.widget("svmx.label",{html:"{date}",cls:t,setValue:function(t){this.el.update(e.__formatDateForDayTitle(t))}});return Ext.widget("svmx.panel",{items:[n],setValue:function(e){n.setValue(e)}})},onDoneButtonTap:function(){if(!(this.getDateOnly()||this.getHoursField().isValid()&&this.getMinutesField().isValid()))return void r.Msg.alert({text:d().T("FSA014_TAG003","Hours/minutes field is invalid, please ensure values are populated."),buttons:[{text:d().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]});this.fireEvent("change",this,this.getValue()),this.hide(),Ext.util.InputBlocker.unblockInputs()}}),c.SVMXAutocompleteField=Ext.define(c.name+".SVMXAutocompleteField",{extend:c.name+".SVMXTextField",xtype:"svmx.field.autocompletefield",component:{xtype:"input",type:"text"},config:{keyField:"Id",labelField:"name",resultsHeight:300,searchFunc:null,searchFuncContext:null},currentSelectedValue:null,currentShownValue:"",isSelectedItem:!1,setValue:function(e,t){this.currentShownValue=e,this.getComponent().setValue(e),this.currentSelectedValue=t;var n={};n[this.getKeyField()]=t,n[this.getLabelField()]=e,this.fireEvent("selected",n)},getValue:function(e){return e||!isSelectedItem?this.getComponent().getValue():this.currentSelectedValue},initialize:function(){var e=this;this.resultsStore=Ext.widget("svmx.store",{fields:[e.getKeyField(),e.getLabelField()],config:{autoLoad:!1}}),this.resultsList=Ext.widget("svmx.list",{renderTo:this.getComponent().element.dom,store:e.resultsStore,margin:2,itemTpl:"{name}"});var t=!1,n=!1,i=function(){return t&&clearTimeout(t),n&&clearTimeout(n),e.getSearchFunc()&&e.getSearchFuncContext()?e.isSelectedItem||""===e.getComponent().getValue()?void e.resultsStore.setData([]):void(n=setTimeout(function(){e.getSearchFunc().call(e.getSearchFuncContext(),e.getValue(!0),function(t){e.resultsStore.setData(t)});var t=e.getResultsHeight()||200;e.resultsList.setHeight(t)},300)):void console.warn("No search func/context")};this.resultsList.on("itemtouchend",function(){t&&clearTimeout(t)}),this.resultsList.onScroll=function(){},this.resultsList.on("itemtap",function(n,i,a,r){e.setValue(r.get(e.getLabelField()),r.get(e.getKeyField())),e.isSelectedItem=!0,t=setTimeout(function(){e.resultsList.setHeight(0)},500)}),this.getComponent().on("focus",i),this.getComponent().on("keyup",function(){e.isSelectedItem=!1,i()}),this.getComponent().on("blur",function(i){n&&clearTimeout(n),t=setTimeout(function(){e.resultsList.setHeight(0)},500)})}}),c.SVMXToggleField=Ext.define(c.name+".SVMXToggleField",{extend:"Ext.field.Toggle",alias:"widget.svmx.field.toggle",labelWidth:"100%",constructor:function(e){e||(e={});var t=!1;e&&e.readOnly&&(t=!0),Ext.apply(e,{useReadOnlyLabel:!0,disabled:t,labelAlign:"top",labelTextAlign:"top"}),this.callParent([e])},initialize:function(){this.callParent(),this.addListener("change",this.updateReadOnlyValue,this)},onMaskTap:function(e,t){this.getReadOnly()||this.callParent(arguments)},setLabelAlign:function(e){this.callParent(["top"])},setDisabled:function(e){var t=null;t=!!this.getReadOnly(),this.callParent([t])},setValue:function(e){var t=!0;!1!==e&&"false"!==e&&0!==e||(t=!1),this.callParent([t])},getCompositionMetamodel:function(){return this.compositionMetamodel}}),c.SVMXSliderField=Ext.define(c.name+".SVMXSliderField",{extend:"Ext.field.Slider",alias:"widget.svmx.field.slider"}),c.SVMXPaddedNumberField=Ext.define(c.name+".SVMXPaddedNumberField",{extend:"Ext.field.Number",alias:"widget.svmx.field.paddednumber",__isValid:!1,__lastValue:null,config:{zeroPadding:2},isValid:function(){return this.__isValid},applyValue:function(e){return""===this.getComponent().getValue()&&""===e||e<this.getMinValue()&&""===this.__lastValue?(this.getComponent().setValue(""),this.__isValid=!1,this.__lastValue="",""):(this.__isValid=!0,e=e>this.getMaxValue()?this.getValue():e,e=e<this.getMinValue()?this.getValue():e,e=this.callParent(arguments),e=String(e).length<this.getZeroPadding()?Ext.String.leftPad(e,this.getZeroPadding(),"0"):e,this.getComponent().setValue(e),this.__lastValue=e,e)},setValue:function(e){if(""===this.getComponent().getValue()&&""===e)return this.callParent([""]);var t=String(e).length<this.getZeroPadding()?Ext.String.leftPad(e,this.getZeroPadding(),"0"):e;return this.callParent([t])}}),c.SVMXPaddedTimeHoursField=Ext.define(c.name+".SVMXPaddedTimeHoursField",{extend:c.name+".SVMXPaddedNumberField",alias:"widget.svmx.field.paddedhour",isPM:!1,is24Hr:!1,setValue:function(e){if(this.isPM=!1,""===this.getComponent().getValue()&&""===e)return this.callParent([""]);var t=e;return e>this.getMaxValue()&&24!==Number(e)&&!this.is24Hr?(t-=this.getMaxValue(),this.isPM=!0,13===Number(e)&&this.fireEvent("change",[e,this.getValue()])):e<this.getMinValue()&&(t=this.getValue()),this.callParent([t])}}),r.defineGlobal(c.name,c),e.exports=c},function(e,t,n){var i=n(30),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10),o=n(0).utils,s={name:"com.servicemax.client.ui.components.modern.popups"};Ext.define(s.name+".SVMXMenu",{extend:"Ext.Menu",alias:"widget.svmx.menu",ui:"svmx-default",config:{side:"",cover:!0,stretchY:!0,scrollable:"vertical",layout:{type:"vbox",align:"stretch"},autoWidth:!0},initialize:function(){this.callParent(),this.enableBubble("transientState"),this.addListener("show",this.onMenuOpen,this),this.addListener("hide",this.onMenuClose,this)},onMenuOpen:function(){this.fireEvent("transientState",{state:this,type:"open",handler:this.closeMenu,scope:this})},onMenuClose:function(e){this.fireEvent("transientState",{state:this,type:"close"})},closeMenu:function(){this.isHidden()||this.hideMenu()},showMenu:function(){if(Ext.Viewport.setMenu(this,{side:this.getSide(),cover:this.getCover()}),Ext.Viewport.showMenu(this.getSide()),this.getAutoWidth()){var e=[],t=r("#"+this.getId()+" > .x-scroll-view")[0];t&&(t.style.width="auto"),this.getItems().each(function(t){var n=t.element.getWidth();-1!==t.element.dom.className.indexOf("x-hasbadge")&&(n+=50),e.push(n)});var n=Math.max.apply(null,e)+50,i=Math.floor(.9*Ext.Viewport.element.getWidth());t&&(t.style.width=Math.min(n,i)+"px")}if(!this.getStretchY()){var a=0;this.getItems().each(function(e){a+=e.element.getHeight()}),a&&this.setHeight(Math.min(a+20,Ext.Viewport.element.getHeight()-40))}this.addListener({delegate:"button",tap:this.hideMenu,scope:this})},hideMenu:function(){this.hide()}}),Ext.define(s.name+".SVMXContextMenu",{extend:s.name+".SVMXMenu",alias:"widget.svmx.contextmenu",minWidth:220,maxWidth:"60%",config:{side:"right",cover:!0,stretchY:!0}}),Ext.define(s.name+".SVMXNavMenu",{extend:s.name+".SVMXMenu",alias:"widget.svmx.navmenu",config:{autoWidth:!1,side:"left",scrollable:!1,width:"120px",cover:!0,stretchY:!0}}),s.SVMXInfoDropDown=Ext.define(s.name+".SVMXInfoDropDown",{extend:s.name+".SVMXMenu",alias:"widget.svmx.infodropdown",config:{modal:!1,side:"top",cover:!0,dismissOnTap:!0,cls:["svmx-info-dropdown"]},initialize:function(){this.callParent(),this.addListener("tap",this.__onTap,this,{element:"element"})},__onTap:function(e){this.getDismissOnTap()&&this.hideMenu()},showDropDown:function(){this.showMenu()}}),Ext.define(s.name+".SVMXToast",{extend:s.name+".SVMXInfoDropDown",alias:"widget.svmx.toast",config:{duration:5e3,scrollable:!1},showMenu:function(e){e||(e=this.getDuration()),o.timer.job(this.getId()+".showMenu",e,this,"hideMenu"),this.callParent()}}),Ext.define(s.name+".SVMXMessageBox",{extend:Ext.MessageBox,alias:"widget.svmx.messagebox",ui:"svmx-default",showAnimation:{type:"fade",duration:250},updateTitle:function(e){if(void 0===e||""===e||null===e)return void this.setHeader(null);this.callParent(arguments)}}),Ext.define(s.name+".SVMXSheet",{extend:Ext.Sheet,alias:"widget.svmx.sheet",ui:"svmx-default",showAnimation:{type:"fade",duration:100,easing:"easeOut"},hideAnimation:null}),o.showDialog=function(e,t){var n=Ext.apply({xtype:"svmx.sheet",centered:!0,height:"80%",width:"80%",alwaysOnTop:-1,hideOnMaskTap:!0,layout:"fit",items:[e],listeners:{beforeHide:function(e,t){return!!e.destroying||(e.maskTapHandler(),!1)}}},t),i=Ext.create(n),a=function(){t.maskTapHandler?t.maskTapHandler(i):i.destroy()};return i.maskTapHandler=function(){i.needToProcessTransientState=!1,a()},i.on("destroy",function(){i.needToProcessTransientState&&Ext.Viewport.fireEvent("transientState",{state:i,type:"close"})}),i.needToProcessTransientState=!0,Ext.Viewport.fireEvent("transientState",{state:i,type:"open",handler:i.maskTapHandler,scope:i}),Ext.Viewport.add(i).show(),i},o.Msg={defaultButtons:{OK:{text:"OK",itemId:"OK",ui:"svmx-button-square"},CANCEL:{text:"Cancel",itemId:"CANCEL",ui:"svmx-button-square"},YES:{text:"Yes",itemId:"YES",ui:"svmx-button-square"},NO:{text:"No",itemId:"NO",ui:"svmx-button-square"},ALLOW:{text:"Allow",itemId:"ALLOW",ui:"svmx-button-square"},DONTALLOW:{text:"Don't Allow",itemId:"DONTALLOW",ui:"svmx-button-square"}},defaultTitles:{ALERT:null,CONFIRM:null,PROMPT:null},__setupButtons:function(e){return o.array.map(e,function(t,n){return"string"==typeof t?o.Msg.defaultButtons[t]?o.Msg.defaultButtons[t]:{text:t,itemId:"button"+n,ui:n===e.length-1?"button-tools-msgbox button-highlight":"button-tools-msgbox"}:(0,a.default)(t,{ui:n===e.length-1?"button-tools-msgbox button-highlight":"button-tools-msgbox"})})},alert:function(e){return o.Msg.__showMessageBox(e,o.Msg.defaultTitles.ALERT,["OK"],!1)},confirm:function(e){return o.Msg.__showMessageBox(e,o.Msg.defaultTitles.CONFIRM,["NO","YES"],!1)},prompt:function(e){return o.Msg.__showMessageBox(e,o.Msg.defaultTitles.PROMPT,["OK","CANCEL"],!0)},__showMessageBox:function(e,t,n,i){var a=new o.Deferred,r=null;e=e||{};var s=void 0;e.buttons||(e.buttons=n),void 0===e.title&&(e.title=t);for(var l=o.Msg.__setupButtons(e.buttons),c=0;c<l.length;c++)l[c].listeners={tap:function(e,t,n){"pending"===a.state()&&u(e.getItemId())}};var u=function(t,n){s.fireEvent("transientState",{state:r,type:"close"}),s.hide(),setTimeout(function(){s.destroy(),e.handler&&e.handler(t,n),a.resolve(t,n)},1)};return null!=e.multiLine&&(i={multiLine:e.multiLine}),s=Ext.create({xtype:"svmx.messagebox",itemId:e.itemId,title:e.title||"",message:e.text,buttons:l,prompt:i,hideAnimation:null,value:e.defaultValue,fn:e.handler?e.handler:u,scope:this,items:e.items,cls:e.cls,ui:"messagebox"}),r=s.show(),r.enableBubble("transientState"),r.fireEvent("transientState",{state:r,type:"open",handler:function(){u("",e.defaultValue)},scope:r}),a.promise()},toast:function(e){o.Msg.__toast||(o.Msg.__toast=o.create("svmx.toast",{height:40,items:[{itemId:"message",xtype:"svmx.label",html:"howdy World"}]})),o.Msg.__toast.query("#message")[0].setHtml(e.text),o.Msg.__toast.showMenu(e.duration)}},Ext.define(s.name+".ProductIQWindow",{extend:"com.servicemax.client.ui.components.modern.popups.SVMXSheet",alias:"widget.svmx.productiqwindow",ui:"svmx-default",constructor:function(e){this.callParent(arguments)},centered:!0,modal:!0,fullscreen:!0,width:"100%",height:"100%",cls:"svmx-productiqwindow",scrollable:!0,hideOnMaskTap:!1,initialize:function(){var e=this,t=Ext.id(),n=Ext.create({docked:"top",xtype:"svmx.toolbar",flex:1,height:50,style:"background:red !important;",cls:"piq-console-titlebar",items:[{xtype:"button",text:this.tags.back,cls:"piq-luma-console-back-button",id:"piqComBackbtn",handler:function(){if(window.cordova){var t="PORTRAIT";window.isTablet&&(t="BOTH"),SVMXPlugin.setOrientation(t)}e.hide(),e.destroy()}},{xtype:"spacer",cls:"piq-console-spacer"},{xtype:"container",cls:"piq-console-title",html:""},{xtype:"spacer",cls:"piq-console-spacer"}]});this.add(n);var i=Ext.create({xtype:"component",flex:2,cls:"piq-app-container",tpl:'<iframe src="{src}"data-ref="iframeEl" name="{frameName}" width="100%" height="100%" frameborder="0" style="min-height:100% !important;min-width:100% !important;"></iframe>',data:{frameName:"ProductIQWindow",src:this.src||"installigence-index.html",id:t,message:this.message}});this.pIQPage=i,e.add(i)},destroy:function(){var e=this;e.pIQPage.destroy(),e.destroying=!0,e.callParent(),e.destroying=!1}}),o.defineGlobal(s.name,s),e.exports=s},function(e,t,n){var i=n(10),a=n(0).utils;n(184);var r={name:"com.servicemax.client.ui.components.modern.controls.impl"},o=n(185).SignaturePad;r.SVMXContainer=Ext.define(r.name+".SVMXContainer",{extend:"Ext.Container",alias:"widget.svmx.container"}),Ext.Container.prototype.removeAllDelayDestroy=function(){for(var e=this.removeAll(!1,!0),t=e.length,n=0;n<t;n++){e[n].hide()}setTimeout(function(){for(var n=0;n<t;n++){e[n].destroy()}},100)},r.SVMXPanel=Ext.define(r.name+".SVMXPanel",{extend:"Ext.Panel",alias:"widget.svmx.panel"}),r.SVMXHorizPanel=Ext.define(r.name+".SVMXHorizPanel",{extend:r.name+".SVMXContainer",alias:"widget.svmx.horizontalpanel",config:{valign:"start",halign:"start"},initConfig:function(e){e=e||{};var t=e.valign||this.config.valign,n=e.halign||this.config.halign;"full"==t&&(t="stretch"),"full"==n&&(n="justify"),"middle"==t&&(t="center"),"middle"==n&&(n="center"),e.layout={type:"hbox",align:t,pack:n},this.callParent([e])}}),r.SVMXVertPanel=Ext.define(r.name+".SVMXVertPanel",{extend:r.name+".SVMXContainer",alias:"widget.svmx.verticalpanel",config:{halign:"start",valign:"start"},initConfig:function(e){var t=e.valign||this.config.valign,n=e.halign||this.config.halign;"full"==t&&(t="justify"),"full"==n&&(n="stretch"),"middle"==t&&(t="center"),"middle"==n&&(n="center"),e.layout={type:"vbox",align:n,pack:t},this.callParent([e])}}),r.SVMXAccordionPanel=Ext.define(r.name+".SVMXAccordionPanel",{extend:r.name+".SVMXContainer",alias:"widget.svmx.accordionpanel",config:{title:"Header",expanded:!1,innerXtype:"svmx.verticalpanel",baseCls:["svmx-accordion"]},initConfig:function(e){var t=e.items;e.items=[{xtype:"svmx.horizontalpanel",halign:"full",itemId:"header",items:[{xtype:"svmx.label",html:Ext.String.htmlEncode(this.getTitle()),itemId:"label",baseCls:["svmx-accordion-header"]},{xtype:"svmx.iconbutton",iconName:"arrow_down",margin:"0px 10px 0px 0px",docked:"right",itemId:"disclosureBtn",transparent:!0}]},{xtype:e.innerXtype||this.config.innerXtype,baseCls:["svmx-accordion-container"],items:t,itemId:"innerPanel",layout:{halign:"stretch"}}],this.callParent([e]),this.add=this.postInitAdd,this.getHeader().element.on("tap",this.toggleExpanded,this)},getHeader:function(){return this.__header||(this.__header=this.query("#header")[0]),this.__header},getLabel:function(){return this.__label||(this.__label=this.query("#label")[0]),this.__label},getDisclosure:function(){return this.__disclosure||(this.__disclosure=this.query("#disclosureBtn")[0]),this.__disclosure},getPanel:function(){return this.getAt(1)},removeInnerItems:function(){this.getPanel().removeAll()},toggleExpanded:function(){this.setExpanded(!this.getExpanded())},updateExpanded:function(e){e?(this.getPanel().show(),this.addCls("svmx-accordion-expanded"),this.getDisclosure().setIconName("arrow_up")):(this.getPanel().hide(),this.removeCls("svmx-accordion-expanded"),this.getDisclosure().setIconName("arrow_down"))},updateTitle:function(e){this.getLabel().setHtml(Ext.String.htmlEncode(e))},postInitAdd:function(e){this.getPanel().add(e)},getInnerItems:function(){return this.getPanel()?this.getPanel().items:[]}}),r.SVMXToolbar=Ext.define(r.name+".SVMXToolbar",{extend:"Ext.Toolbar",alias:"widget.svmx.toolbar",ui:"svmx-default",defaults:{xtype:"svmx.button"}}),r.SVMXGrid=Ext.define(r.name+".SVMXGrid",{extend:"Ext.grid.Grid",alias:"widget.svmx.grid",ui:"svmx-default",config:{autoHeight:!1},itemHeight:50,beforeInitialize:function(){var e=this,t=e.container;e.getBaseCls();Ext.apply(e,{listItems:[],headerItems:[],updatedItems:[],headerMap:[],recordMap:{},scrollDockItems:{top:[],bottom:[]}}),e.translationMethod="csstransform",t||(t=e.container=e.createContainer()),e.add(t),e.scrollViewElement=t.bodyElement,e.scrollElement=t.innerElement;var n=t.getScrollable();n&&n.on({scroll:"onScroll",refresh:"onScrollerRefresh",scope:e})},createContainer:function(){var e=Ext.merge({scrollable:{autoRefresh:!this.getInfinite()||null}},this.getContainer());return this.getAutoHeight()&&(e.scrollable=!1),Ext.create(e)},initialize:function(){this.callParent(arguments),this.on("itemswipe",this.doItemSwipe,this),this.getAutoHeight()&&this.on("refresh",this.doSVMXRefresh)},doSVMXRefresh:function(){var e=this,t=e.getStore(),n=t.getCount(),i=this.getItemHeight()*n;Ext.get(this.el).down(".x-grid-inner").setHeight(i)},onStoreClear:function(){var e=this,t=e.container.getScrollable(),n=e.getInfinite();e.pinnedHeader&&e.pinnedHeader.translate(0,-1e4),e.getItemMap().populate(0,0),n?(e.topRenderedIndex=0,e.topVisibleIndex=0,e.updateAllListItems()):e.setItemsCount(0),t&&t.scrollTo(null,0),e.refreshScroller()},refreshScroller:function(e){if(this.getAutoHeight())return void this.handleItemTransforms();this.callParent(arguments)},updateColumnWidth:function(){var e=this,t=e.getScrollable(),n=this.getTotalColumnWidth(),i=e.getHeaderContainer();e.scrollElement.setWidth(n),i.setTotalWidth(n),i.updateSpacer(),t&&t.setSize({x:n,y:t.getSize().y})},doItemSwipe:function(e,t,n,i,a,r){if(this.hasListener("deleterow")){var o=this;if(!n.getCls().includes("svmx-grid-row-swiped")&&"left"==a.direction){var s=Ext.widget("svmx.button",{text:"",cls:"svmx-grid-swipe-delete-button",iconCls:"icon-trashcan",listeners:{tap:function(a,r){r.stopEvent(),o.fireEvent("deleterow",e,t,n,i)}}}),l=function(){Ext.Anim.run(s,"fade",{after:function(){s.destroy(),n.removeCls("svmx-grid-row-swiped")},out:!0})};s.renderTo(n.element.dom),e.on({single:!0,buffer:250,itemtouchstart:l}),Ext.Viewport.element.on({single:!0,buffer:250,touchstart:l}),n.addCls("svmx-grid-row-swiped")}}}}),r.SVMXLoadMask=Ext.define(r.name+".SVMXLoadMask",{extend:"Ext.LoadMask",alias:"widget.svmx.loadmask",ui:"svmx-default"}),r.SVMXProgressBarNew=Ext.define(r.name+".SVMXProgressBarNew",{extend:"Ext.Progress",alias:"widget.svmx.progressbarnew",ui:"svmx-default"}),r.SVMXButton=Ext.define(r.name+".SVMXButton",{extend:"com.servicemax.client.ui.components.modern.controls.svmxbasebutton.SVMXBaseButton",alias:"widget.svmx.button",ui:"svmx-default",config:{ui:"svmx-default",tapMask:!1}}),r.SVMXTabButton=Ext.define(r.name+".SVMXTabButton",{extend:r.name+".SVMXButton",alias:"widget.svmx.tabbutton",__tabBar:null,constructor:function(e){this.__tabBar=e.tabBar,this.callParent([e])},activate:function(){this.__tabBar.setPressedButtons([this])}}),r.SVMXIconButton=Ext.define(r.name+".SVMXIconButton",{extend:r.name+".SVMXButton",alias:"widget.svmx.iconbutton",config:{transparent:!1,ui:"svmx-icon"},initConfig:function(e){e.iconCls=e.iconName||this.config.iconName,e.transparent=e.transparent||this.config.transparent,e.transparent&&(e.cls?i.isArray(e.cls)||(e.cls=[e.cls]):e.cls=[],e.cls.push("transparent-button")),this.callParent([e])},setIconName:function(e){this.setIconCls(e)}}),r.SVMXMenuButton=Ext.define(r.name+".SVMXMenuButton",{extend:r.name+".SVMXIconButton",alias:"widget.svmx.menubutton",config:{iconName:"menu",transparent:!0,ui:"svmx-menu",menuType:"svmx.contextmenu",menuOptions:{}},__menu:null,initConfig:function(e){e.menuItems||(e.menuItems=[]),this.items&&(e.menuItems=e.menuItems.concat(this.items)),this.callParent([e])},initialize:function(){this.setMenuItems(this.config.menuItems),this.addListener("tap",this.__onTap,this),this.callParent()},setMenuItems:function(e){return this.__menu?(this.__menu.removeAllDelayDestroy(),this.__menu.setItems(e)):e&&e.length&&(this.__menu=Ext.widget(this.getMenuType(),i.extend({cls:"svmx-actions-menu",items:e},this.getMenuOptions()))),this.setDisabled(!e||0===e.length),e},getMenuItems:function(){return this.__menu.getInnerItems()},addMenuItem:function(e,t){this.__menu?void 0===t?this.__menu.add(e):this.__menu.insert(t,e):this.setMenuItems([e])},__onTap:function(){this.getMenuItems()&&this.__menu.showMenu()},doDestroy:function(){this.__menu&&this.__menu.destroy(),this.callParent()}}),r.SVMXContextMenuButton=Ext.define(r.name+".SVMXContextMenuButton",{extend:r.name+".SVMXMenuButton",alias:"widget.svmx.contextmenubutton",config:{transparent:!0,iconName:null,text:"Actions",ui:"svmx-contextmenu",menuOptions:{stretchY:!0,autoWidth:!1}}}),r.SVMXButtonSet=Ext.define(r.name+".SVMXButtonSet",{extend:"Ext.SegmentedButton",alias:"widget.svmx.buttonset",ui:"svmx-default",config:{pressedIndices:null},initialize:function(){this.addListener("toggle",this.__onToggle,this),this.callParent()},__onToggle:function(e,t,n,i){var a=this.getPressedButtons();n?this.fireEvent("selected",t,a):this.fireEvent("deselected",t,a)},getPressedIndices:function(){var e=this.getPressedButtons();return a.array.map(e,function(e){return this.items.indexOf(e)},this)},applyPressedIndices:function(e){var t=a.array.map(e,function(e){return this.getAt(e)},this);this.setPressedButtons(t)}}),r.Progressbar=Ext.define(r.name+".Progressbar",{extend:"Ext.Component",alias:"widget.svmx.progressbar",template:[{cls:"container-svmx-progressbar",reference:"progressbar",tag:"div",children:[{reference:"span",tag:"span",cls:"container-svmx-progressbar"}]}],initConfig:function(e){var t=this;e.containerCls&&t.progressbar.swapCls(e.containerCls,"container-svmx-progressbar"),e.barCls&&t.span.swapCls(e.barCls,"container-svmx-progressbar"),this.callParent([e]),t.updateProgress(0)},updateProgress:function(e){this.span.setWidth(e+"%")}}),r.SVMXImage=Ext.define("com.servicemax.client.ui.components.modern.controls.impl.SVMXImage",{extend:"Ext.Img",alias:"widget.svmx.image",ui:"svmx-default"}),r.SVMXLabel=Ext.define("com.servicemax.client.ui.components.modern.controls.impl.SVMXLabel",{extend:"Ext.Label",alias:"widget.svmx.label",ui:"svmx-default",initConfig:function(e){e.text&&!e.html&&(e.html=e.text),this.callParent([e])}}),r.SVMXSpacer=Ext.define("com.servicemax.client.ui.components.modern.controls.impl.SVMXSpacer",{extend:"Ext.Spacer",alias:"widget.svmx.spacer"}),r.Carousel=Ext.define("com.servicemax.client.ui.components.modern.controls.impl.Carousel",{extend:"Ext.Carousel",alias:"widget.svmx.carousel",ui:"svmx-default",config:{interval:1e4},__timer:null,__interval:1e4,initialize:function(){var e=this;e.__interval=e.config.interval,e.__timer=setInterval(function(){var t=e.getItems().length-1,n=e.getActiveIndex(),i=n+1>=t?0:n+1;e.setActiveItem(i)},e.__interval)},doDestroy:function(){var e=this;e.__timer&&clearInterval(e.__timer),this.callParent()}}),r.Signature=Ext.define("com.servicemax.client.ui.components.modern.controls.impl.Signature",{extend:r.name+".SVMXContainer",alias:"widget.svmx.signature",config:{height:"100%",width:"100%",waterMarkText:""},__canvas:null,__context:null,__watermark:null,__signature:null,__addWatermark:function(e){if(e){var t=this.__context,n=new Image;n.src=e,n.onload=function(){t.drawImage(n,0,0)}}},__createWatermark:function(e){var t=this.__context.globalAlpha,n=this.__context,i=this.__canvas;n.globalAlpha=.3;for(var a=n.measureText(e),r=a.width,o=i.width,s=i.height,l=0,c=25,u=0,d=1;c<=s;){for(u=0,l=0;l<=o;)n.fillText(e,l,c),l=r*++u;c=25*++d}return this.__context.globalAlpha=t,i.toDataURL()},initConfig:function(e){this.config.height=e.height||this.config.height,this.config.width=e.width||this.config.width,this.config.waterMarkText=e.waterMarkText||this.config.waterMarkText,this.callParent([e])},initialize:function(){this.on("painted",this.doPainted),this.callParent()},doPainted:function(){var e=this.element.getWidth(),t=this.element.getHeight(),n=e-42;t-=2;var i='<div class="svmx-signature-pad" style="width:'+e+"px; height:"+t+'px;"><div class="svmx-signature-pad-body" style="width:'+n+"px; height:"+t+'px;"><canvas width="'+n+'" height="'+t+'" style="background-color: white; width:100%; height:100%;" ></canvas></div></div>';this.setHtml(i);var a=Ext.get(this.element.dom).select("div.svmx-signature-pad").elements[0],r=a.querySelector("canvas"),s=r.getContext("2d");this.__canvas=r,this.__context=s,s.globalAlpha=1,this.__watermark=this.config.waterMarkText?this.__createWatermark(this.config.waterMarkText):null,this.__signature=new o(r),this.__addWatermark(this.__watermark)},clearSignature:function(){this.__signature.clear(),this.__addWatermark(this.__createWatermark(this._waterMarkText))},getSignature:function(){return this.__signature.isEmpty()?null:this.__signature.toDataURL()}}),r.CollapsibleTitleBar=Ext.define(r.name+".CollapsibleTitleBar",{extend:"Ext.TitleBar",alias:"widget.svmx.collapsibletitlebar",boundComponentStateExpandedCls:"comp-state-expanded",boundComponentStateCollapsedCls:"comp-state-collapsed",cls:"svmx-collapsible-title-bar",boundComp:null,titleAlign:"left",setStateCollapsed:function(){var e=this;e.boundComp.addCls(e.boundComponentStateCollapsedCls),e.boundComp.removeCls(e.boundComponentStateExpandedCls)},setStateExpanded:function(){var e=this;e.boundComp.addCls(e.boundComponentStateExpandedCls),e.boundComp.removeCls(e.boundComponentStateCollapsedCls)},setCollapsedState:function(e){var t=this,n=t.boundComp||null;n&&(n.collapsed?e?(n.collapsed=!1,t.setStateExpanded()):t.setStateCollapsed():e?(n.collapsed=!0,t.setStateCollapsed()):t.setStateExpanded())},listeners:{initialize:function(e){if(e.boundComp){if(e.boundComp&&e.boundComp.collapsible){Ext.get(e.el).on("tap",e.setCollapsedState.bind(e,!0),e),e.setCollapsedState(!1)}}else logger.error("boundComp is not specified so could not apply collapsible functionality.")}}}),r.CollapsibleGrid=Ext.define(r.name+".CollapsibleGrid",{extend:r.name+".SVMXGrid",alias:"widget.svmx.collapsiblegrid",autoHeight:!0,bufferSize:50,cls:"svmx-collapsible-grid",collapsible:!1,collapsed:!1,constructor:function(e){var t=this;e=e||{},e.collapsible&&(e.titleBar={xtype:"svmx.collapsibletitlebar",boundComp:t}),this.callParent([e])},ui:"svmx-default",doDestroy:function(){this.store&&this.store.destroy(),this.config&&this.config.store&&(this.config.store.destroy(),this.config=null),this.callParent()}}),r.TutorialPopover=Ext.define(r+".TutorialPopover",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.svmx.tutorialpopover",ui:"svmx-default",cls:"tutorial-popover",left:0,modal:!0,minHeight:90,hideOnMaskTap:!0,arraowCls:"tutorial-popover-arrow",initialize:function(){var e=this;e.containerCls&&e.addCls(e.containerCls),e.add({xtype:"component",centered:!0,cls:e.arraowCls?e.arraowCls:"tutorial-popover-arrow"})}}),a.defineGlobal(r.name,r),e.exports=r},function(e,t,n){n(19);var i=n(10),a=n(0).utils,r={name:"com.servicemax.client.ui.components.modern.navigation"},o={name:"com.servicemax.client.ui.components.modern.controls.impl"};Ext.define(r.name+".SVMXTree",{extend:"Ext.list.Tree",alias:"widget.svmx.tree",constructor:function(e){this.callParent([e])}}),Ext.define(r.name+".SVMXTabPanel",{extend:"Ext.TabPanel",alias:"widget.svmx.tabs",config:{flex:1,width:"100%",ui:"svmx-default",tabBarPosition:"top"},setIndex:function(e){this.setActiveItem(e)},getIndex:function(){var e=this.getActiveItem();return a.array.indexOf(e.parent.getInnerItems(),e)},push:function(e,t){e instanceof Ext.Base==0&&(e=a.create(e.xtype||"svmx.verticalpanel",e)),e.isInner=!0,this.add(e),t||this.setActiveItem(e)},pop:function(){var e=this.getInnerItems(),t=e[e.length-1],n=e.length>1?e[e.length-2]:null,i=this.getActiveItem(),a=this.indexOf(t);this.removeAt(a),i==t&&n&&this.setActiveItem(n)},doResetActiveItem:function(e){var t=this.getInnerItems();t.length>1&&e>=t.length-1?this.setActiveItem(t.length-2):0===e?this.setActiveItem(0):this.setActiveItem(e-1)}}),Ext.define(r.name+".SVMXSlidingCardPanel",{extend:r.name+".SVMXTabPanel",alias:"widget.svmx.slidingcards",config:{ui:"svmx-hiddentab"},doTabChange:function(){},doResetActiveItem:function(e){}}),Ext.define(r.name+".SVMXCardPanel",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXContainer",alias:"widget.svmx.cards",config:{flex:1,width:"100%",ui:"svmx-cards",animation:null},initConfig:function(e){e.layout||(e.layout={type:"card",animation:e.animation||this.config.animation}),this.callParent([e])},setIndex:function(e){this.setActiveItem(e)}}),Ext.define(r.name+".SVMXCard",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXVertPanel",alias:"widget.svmx.card",cls:"app-card",initialize:function(){this.callParent();var e=this;this.onBefore("show",function(){console.log("SVMXCard: beforeShow START - "+e.id);try{e.onShow()}finally{console.log("SVMXCard: beforeShow END - "+e.id)}},this),this.onBefore("hide",function(){console.log("SVMXCard: beforeHide START - "+e.id);try{e.onHide()}finally{console.log("SVMXCard: beforeHide END - "+e.id)}},this)},activate:function(){this.getParent().setActiveItem(this)},onShow:function(){},onHide:function(){}}),Ext.define(o.name+".SVMXHeaderBar",{extend:o.name+".SVMXPanel",alias:"widget.svmx.headerbar",layout:{type:"hbox",align:"stretch",pack:"justify"},config:{leftItem:[],centerItem:[],rightItem:[]},beforeInitialize:function(){this.__leftContainer=Ext.create({xtype:"svmx.horizontalpanel",itemId:"leftHeaderWrapper",cls:"svmx-headerBar-left-container",flex:1,halign:"left",valign:"center"}),this.__centerContainer=Ext.create({xtype:"svmx.verticalpanel",itemId:"centerHeader",cls:"svmx-headerBar-center-container",flex:3,halign:"center",valign:"center"}),this.__rightContainer=Ext.create({xtype:"svmx.horizontalpanel",itemId:"rightHeaderWrapper",cls:"svmx-headerBar-right-container",flex:1,halign:"right",valign:"center"}),this.add([this.__leftContainer,this.__centerContainer,this.__rightContainer]),this.callParent()},setLeftItem:function(e){this.__leftContainer.removeAllDelayDestroy(),this.__leftContainer.add(e)},setCenterItem:function(e){this.__centerContainer.removeAllDelayDestroy(),"string"==typeof e?this.__centerContainer.add({xtype:"svmx.label",html:e}):this.__centerContainer.add(e)},setRightItem:function(e){this.__rightContainer.removeAllDelayDestroy(),this.__rightContainer.add(e)}}),Ext.define(r.name+".SVMXNavContainer",{extend:o.name+".SVMXContainer",alias:"widget.svmx.navcontainer",layout:"hbox",width:"100%",height:"100%",_headerPanel:null,_contentPanel:null,initConfig:function(e){var t=i.extend(!0,{},e),n=[];this._contentPanel?(this._contentPanel.getItems().items=t.items,this._contentPanel.flex=t.flex||4):this._contentPanel=Ext.create({xtype:"svmx.container",layout:"vbox",items:t.items,scrollable:t.contentScrollable||"vertical",cls:"svmx-navcontainer-content",flex:t.flexRight||4,itemId:"navcontainer"}),this._headerPanel||(this._headerPanel=Ext.create({xtype:"svmx.container",layout:"vbox",items:n,cls:"svmx-navcontainer-header",flex:t.flexLeft||1,scrollable:"vertical"}));for(var a in t.items){var r=this._checkSectionForHeader(t.items[a],a);r&&this._headerPanel.add(r)}t.hideHeaderPanel?t.items=[this._contentPanel]:t.items=[this._headerPanel,this._contentPanel],this.callParent([t])},_checkSectionForHeader:function(e,t){var n=this,i=e.title||e.getTitle&&e.getTitle();return i?{xtype:"svmx.button",ui:"button-nav-sidebar",html:i,idx:t,labelCls:"tools-sync-button-label-largemodern",handler:function(){var e=n._contentPanel.getItems().items[this.idx];n.scrollToItem(e)}}:void 0!==e.spacer&&!1!==e.spacer?{xtype:"label",cls:"svmx-sidebar-nav-spacer",idx:t}:void 0},scrollToItem:function(e){var t=this._contentPanel,n=t.getScrollable();if(void 0!==n&&null!==n&&!1!==n){var i=e.element.getX()-t.element.getX(),a=e.element.getY()-t.element.getY();n.scrollBy(i,a)}},addPanel:function(e){var t=this._contentPanel.getItems().length,n=this._checkSectionForHeader(e,t);n&&this._headerPanel.add(n),this._contentPanel.add(e)},insertPanel:function(e,t){var n=this._checkSectionForHeader(t,e),i=0;for(i=e;i<this._headerPanel.getItems().length;i++){var a=this._headerPanel.getInnerItems()[i];a&&(a.idx+=1)}for(i=e;i<this._contentPanel.getItems().length;i++){var r=this._contentPanel.getInnerItems()[i];r&&(r.idx+=1)}n&&this._headerPanel.insert(e,n),this._contentPanel.insert(e,t)},addPanels:function(e){var t=this._contentPanel.getItems().length;for(var n in e){var i=this._checkSectionForHeader(e[n],parseInt(n)+parseInt(t));i&&this._headerPanel.add(i),this._contentPanel.add(e[n])}},getHeaderPanel:function(){return this._headerPanel}}),a.defineGlobal(r.name,r),e.exports=r},function(e,t,n){(function(t){var i=n(732),a=n(0).utils;a.requireStyleSheet(t+"/resources/theme-orange/theme-orange-all.css",function(){},null,{}),a.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.uitheme","config":{"theme-defs":[{"type":"CLASSIC","path":"theme-orange/theme-orange-all.css"}]}}')),e.exports={impl:i}}).call(t,"modules/com.servicemax.client.ui.modern.themes.orange")},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events.model"};Ext.define("Event",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",config:{fields:[{name:"event",type:"string"},{name:"title",type:"string"},{name:"location",type:"string"},{name:"start",type:"date",dateFormat:"c"},{name:"end",type:"date",dateFormat:"c"},{name:"css",type:"string"},{name:"priority",type:"string"}]}}),Ext.define("EventModel",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",config:{fields:[{name:"id",type:"string"},{name:"start_date",type:"date",dateFormat:"c"},{name:"end_date",type:"date",dateFormat:"c"},{name:"text",type:"string"},{name:"details",type:"string"},{name:"location",type:"string"},{name:"color",type:"string"},{name:"what_id",type:"string"},{name:"who_id",type:"string"}]}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events.base"};Ext.define("Ext.ux.TouchCalendarEventsBase",{extend:"Ext.Base",config:{calendar:null,plugin:null,eventsPerTimeSlot:{},eventsSlotPerDay:{},maxEventBarPos:0,eventSortDirection:"DESC"},_startEventField:null,_endEventField:null,_dayTimeSlotSizeMillis:null,_calendarEventFilterFn:null,__filteredEventStore:null,__renderedEvents:[],constructor:function(e){this.initConfig(e),this.callParent(arguments);var t=this.getPlugin();this._startEventField=t.getStartEventField(),this._endEventField=t.getEndEventField(),this._dayTimeSlotSizeMillis=6e4*this.getCalendar().getDayTimeSlotSize(),this._calendarEventFilterFn=this.getCalendar().eventFilterFn},reset:function(){var e=this.getCalendar().eventStore;e.isSorted()||e.sort(this.getPlugin().getStartEventField(),this.getEventSortDirection()),this.__filteredEventStore=null,this.eventBarStore=null,this.__renderedEvents=[]},createFilteredEventStore:function(){var e=this.getCalendar(),t=Ext.create("Ext.data.Store",{model:"Event",autoLoad:!1});return this.getCalendar().eventStore.each(function(n){if(!this.getCalendar().eventFilterFn.call(e,n.data[this._startEventField],n.data[this._endEventField]))return!0;t.add(n)},this),t},generateEventBars:function(){if(null==this.eventBarStore){this.setEventsPerTimeSlot({}),this.setEventsSlotPerDay({});var e=this.getCalendar().getStore();if(this.__filteredEventStore||(this.__filteredEventStore=this.createFilteredEventStore()),this.__filteredEventStore&&0!=this.__filteredEventStore.data.length){var t=this.__filteredEventStore,n=null,i=0;this.eventBarStore=Ext.create("Ext.data.Store",{model:"Ext.ux.CalendarEventBarModel",data:[]}),e.each(function(e){var a=e.get("date"),r=a.getTime(),o=[];if(t.each(function(e){var t=e.internalId;if(!this.eventFilterFn.call(this,e,null,r))return!0;i+=1;var s=this.eventBarStore.findBy(function(e){return e.data.EventID===t},this);if(s>-1)if(n=this.eventBarStore.getAt(s),a.getDay()===this.getCalendar().getWeekStart()){o.push(n.get("BarPosition"));Ext.create("Ext.ux.CalendarEventBarModel",{EventID:t,Date:a,BarLength:1,BarWidth:1,BarPosition:n.get("BarPosition"),Colour:n.get("Colour"),Record:e})}else o.push(n.get("BarPosition")),n.set("BarLength",n.get("BarLength")+1);else{var l=this.getNextFreePosition(o);l>this.getMaxEventBarPos()&&this.setMaxEventBarPos(l),o.push(l),n=Ext.create("Ext.ux.CalendarEventBarModel",{EventID:t,Date:a,BarLength:1,BarWidth:1,BarPosition:l,Colour:e.css,Record:e}),this.eventBarStore.add(n)}},this),i>0){this.getEventsPerTimeSlot()[a.getTime()]=i;var s=this.getEventsSlotPerDay()[a.toLocaleDateString()]||1;i>=s&&(this.getEventsSlotPerDay()[a.toLocaleDateString()]=i)}i=0},this)}}},eventBarDoesWrap:function(e){var t=Ext.Date.add(e.get("Date"),Ext.Date.DAY,e.get("BarLength")-1);return Ext.Date.clearTime(t,!0).getTime()!==Ext.Date.clearTime(e.get("Record").get(this.getPlugin().getEndEventField()),!0).getTime()},eventBarHasWrapped:function(e){return Ext.Date.clearTime(e.get("Date"),!0).getTime()!==Ext.Date.clearTime(e.get("Record").get(this.getPlugin().getStartEventField()),!0).getTime()},getNextFreePosition:function(e){for(var t=0;e.indexOf(t)>-1;)t++;return t},createEventBar:function(e,t){this.__renderedEvents=this.__renderedEvents||[];var n=this.eventBarDoesWrap(e),i=this.eventBarHasWrapped(e),a=[this.getPlugin().getEventBarCls(),"e-"+e.get("EventID"),n?" wrap-end":"",i?" wrap-start":"",t.get(this.getPlugin().getCssClassField())],r=Ext.DomHelper.append(this.getPlugin().getEventWrapperEl(),{tag:"div",html:this.getPlugin().getEventBarTpl().apply(t.data),eventID:e.get("EventID"),cls:a.join(" ")},!0);return this.__renderedEvents.push(r),r},removeEvents:function(){if(this.__renderedEvents&&this.__renderedEvents.length>0)for(var e=0;e<this.__renderedEvents.length;e++){var t=this.__renderedEvents[e];t&&(t.dom&&t.dom.childNodes&&(Ext.each(t.dom.childNodes,function(e,t){var n=Ext.get(e);n&&n.destroy()}),t.dom.innerHTML=""),t.draggable&&t.draggable.destroy&&t.draggable.destroy(),t.draggable=null,t.destroy())}this.__renderedEvents=null},getRandomColour:function(){return"#"+(16777215*Math.random()<<0).toString(16)}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events.day"};Ext.define("Ext.ux.TouchCalendarDayEvents",{extend:"Ext.ux.TouchCalendarEventsBase",config:{eventSortDirection:"ASC",minEventHeight:50,orderedEventsPerTimeSlot:{}},generateEventBars:function(){if(null==this.eventBarStore&&(this.setEventsPerTimeSlot({}),this.setEventsSlotPerDay({}),this.setOrderedEventsPerTimeSlot({}),this.__filteredEventStore||(this.__filteredEventStore=this.createFilteredEventStore()),this.__filteredEventStore&&0!=this.__filteredEventStore.data.length)){var e=this.__filteredEventStore,t=null,n=0,i=[];e.each(function(e){var t=e.data.start.getTime();-1==i.indexOf(t)&&i.push(t)}),this.eventBarStore=Ext.create("Ext.data.Store",{model:"Ext.ux.CalendarEventBarModel",data:[]}),i.forEach(function(i){var a=new Date(i),r=i,o=[];if(e.each(function(e){var i=e.internalId;if(!this.eventFilterFn.call(this,e,null,r))return!0;n+=1;var s=this.eventBarStore.findBy(function(e){return e.data.EventID===i},this);if(s>-1)t=this.eventBarStore.getAt(s),o.push(t.get("BarPosition")),t.set("BarLength",t.get("BarLength")+1),this.getOrderedEventsPerTimeSlot()[a.getTime()]||(this.getOrderedEventsPerTimeSlot()[a.getTime()]=[]),this.getOrderedEventsPerTimeSlot()[a.getTime()][t.get("BarPosition")]=i;else{var l=this.getNextFreePosition(o);l>this.getMaxEventBarPos()&&this.setMaxEventBarPos(l),o.push(l),t=Ext.create("Ext.ux.CalendarEventBarModel",{EventID:i,Date:a,BarLength:1,BarWidth:1,BarPosition:l,Colour:e.css,Record:e}),this.eventBarStore.add(t),this.getOrderedEventsPerTimeSlot()[a.getTime()]||(this.getOrderedEventsPerTimeSlot()[a.getTime()]=[]),this.getOrderedEventsPerTimeSlot()[a.getTime()][l]=i}},this),n>0){this.getEventsPerTimeSlot()[a.getTime()]=n;var s=this.getEventsSlotPerDay()[a.toLocaleDateString()]||1;n>=s&&(this.getEventsSlotPerDay()[a.toLocaleDateString()]=n)}n=0},this),this.eventBarStore.each(function(e){var t=e.get("EventID"),n=0,i=this.getEventsSlotPerDay()[e.get("Date").toLocaleDateString()]||1,a=i;for(var r in this.getOrderedEventsPerTimeSlot()){var o=(new Date(Number(r)),this.getOrderedEventsPerTimeSlot()[r]),s=o.indexOf(t);if(s>-1){n=s;for(var l=n+1;l<o.length;l++)void 0!=o[l]&&l<a&&(a=l)}}e.set("BarWidth",a-n)},this)}},eventFilterFn:function(e,t,n){var i=this.getRoundedTimeMillis(e.data[this._startEventField]),a=e.data[this._endEventField].getTime();return i<=n&&a>=n},renderEventBars:function(e){for(var t=e.getCount(),n=0,i=void 0;n<t;n++){i=e.getAt(n);var a=i.data.Record,r=this.createEventBar(i,a);this.enableDragAndDrop(r,a);var o=this.getEventBarWidth(i,60),s=this.getColumnWidth(i,60),l=this.getVerticalDayPosition(i),c=this.getHorizontalDayPosition(i,s),u=this.getEventBarHeight(i),d=this.getMinEventHeight();u=u>d?u:d,r.setLeft(c),r.setTop(l-this.getCalendar().element.getY()),r.setHeight(u),r.setWidth(o)}},enableDragAndDrop:function(e,t){var n=this,i=e.draggable=new Ext.util.Draggable({element:e,constraint:null,direction:"vertical",translatable:new Ext.util.translatable.CssTransform,disabled:!0});i.eventRecord=t,i.undoMove=function(){this.oldTop&&(this.getElement().setTop(this.oldTop),this.setOffset(0,0),this.oldTop=null)},i.on({dragend:n.onDragEnd,drag:n.onDrag,scope:n}),i.onBefore({dragstart:n.onDragStart,drag:n.beforeDrag,scope:n}),e.on("longpress",function(t){n.onLongPress(t,e,i)})},onLongPress:function(e,t,n){var i=this;console.log("Event long pressed, enable dragging."),n.oldTop=t.getTop(!0),n.eventTop=n.oldTop,console.log("event bar top, height="+t.getTop()+", "+t.getHeight()),console.log("old calendar Y="+n.oldCalendarY),n.minOffsetY=-n.oldTop,console.log("minOffsetY="+n.minOffsetY),n.maxOffsetY=2400-n.oldTop-t.getHeight(),console.log("maxOffsetY="+n.maxOffsetY),n.setConstraint({min:{x:-1/0,y:n.minOffsetY},max:{x:1/0,y:n.maxOffsetY}}),n.draggableCancelTimer=setTimeout(function(){i.longPressTimeout(n)},2e3),i.enableDrag(n)},onCalendarScroll:function(e,t,n){console.log("calendar scrolling, y="+n),e.getElement().setTop(n),e.setOffset(0,0)},longPressTimeout:function(e){console.log("Drag and drop timed out, disable dragging."),this.disableDrag(e)},enableDrag:function(e){this.getCalendar().parent.eventDragEnabled=!0,this.getCalendar().setScrollable(!0),e.setDisabled(!1)},disableDrag:function(e){this.getCalendar().parent.eventDragEnabled=!1,e.setDisabled(!0)},onDragStart:function(e,t,n,i){console.log("Event dragging started--");var a=this,r=e.eventRecord;return a.getCalendar().fireEvent("eventdragstart",r,e),!e.getDisabled()&&(a.stopCancelTimer(e.draggableCancelTimer),a.updateDragContext(),!0)},stopCancelTimer:function(e){console.log("Stopping draggable timeout timer."),window.clearTimeout(e)},beforeDrag:function(e,t,n,i){return!e.getDisabled()},onDrag:function(e,t,n,i){console.debug("Event dragging, offsetX, offsetY="+n+", "+i);var a=this,r=a.getCalendar(),o=e.getElement(),s=o.getTop(),l=r.element.getTop();if(console.debug("eventBarLocalTop, calendarLocalTop="+s+", "+l),o.getTop()<=l+5)console.debug("Dragged near top, scroll down calendar!!!"),a.increaseScrollTimes(e),r.getScrollable().scrollBy(0,-5*e.scrollTimes),e.eventTop-=5*e.scrollTimes;else{var c=o.getTop()+o.getHeight(),u=r.element.getTop()+r.element.getHeight();console.debug("eventBarLocalBottom, calendarLocalBottom="+c+", "+u),c>=u-5?(console.debug("Dragged near bottom, scroll up calendar!!!"),a.increaseScrollTimes(e),r.getScrollable().scrollBy(0,5*e.scrollTimes),e.eventTop+=5*e.scrollTimes):(console.debug("Normal drag, reset scroll times!!!"),e.scrollTimes=0)}console.debug("scrollTimes="+e.scrollTimes);var d=e.getOffset().y;e.eventTop=a.adjustEventTopToRange(e.eventTop+d,o.getHeight())-d,console.debug("new eventTop="+e.eventTop),o.setTop(e.eventTop),this.updateDragContext()},adjustEventTopToRange:function(e,t){return e<0?e=0:e>2400-t&&(e=2400-t),e},increaseScrollTimes:function(e){var t=e.scrollTimes||0;++t,t>20&&(t=20),e.scrollTimes=t},updateDragContext:function(){console.log("Update drag context!")},onDragEnd:function(e,t,n,i){if(console.log("Event dragged, disable dragging!"),!e.getDisabled()){var a=this,r=a.getCalendar();e.onCalendarScroll=null,a.disableDrag(e);var o=e.getElement(),s=e.eventRecord,l=r.element.select("table.time-slot-table td",r.element.dom).first(),c=l.getHeight(),u=a.adjustEventTopToRange(e.eventTop+i,o.getHeight());o.setTop(u),e.setOffset(0,0);var d=o.getTop(!0)-e.oldTop,_=d/c*r.getDayTimeSlotSize();_|=0,r.fireEvent("eventdragend",s,_,e)}},getColumnWidth:function(e,t){var n=this.getEventsSlotPerDay()[e.get("Date").toLocaleDateString()],i=this.getCalendar().element.getWidth(),a=this.getPlugin().getEventBarSpacing();return n=n||1,t=t||0,Math.floor((i-t)/n-a)},getEventBarWidth:function(e,t){var n=this.getEventsSlotPerDay()[e.get("Date").toLocaleDateString()],i=e.get("BarWidth"),a=this.getCalendar().element.getWidth();n=n||1,t=t||0,i=i||1;var r=this.getPlugin().getEventBarSpacing();return Math.floor((a-t)/n*i-r)},getEventBarHeight:function(e){var t=this.getPlugin().getEventHeight();return Ext.isNumeric(t)?t:"duration"===t?this.getEventBarHeightDuration(e):"auto"},getEventBarHeightDuration:function(e){var t=e.data.Record.get(this.getPlugin().getStartEventField()),n=e.data.Record.get(this.getPlugin().getEndEventField()),i=this.getRoundedTime(t);n.getTimezoneOffset()!=t.getTimezoneOffset()&&(n=n.getTimezoneOffset()>t.getTimezoneOffset()==1?new Date(n.getTime()-36e5):new Date(n.getTime()+36e5));var a=(n.getTime()-t.getTime())/1e3/60,r=this.getCalendar().getDateCell(i),o=r.parent("tr",!1),s=0;if(o){s=a*(r.getHeight()/30)}return s},getVerticalDayPosition:function(e){var t=e.data.Record.get(this.getPlugin().getStartEventField()),n=this.getRoundedTime(t),i=2*n.getHours()+(30===n.getMinutes()?1:0),a=(t.getTime()-n.getTime())/1e3/60,r=this.getCalendar().element.select("table.time-slot-table td",this.getCalendar().element.dom).first(),o=0;if(r){var s=r.getHeight();o=this.getCalendar().el.getY()+i*s+a*(s/30)}return o},getHorizontalDayPosition:function(e,t){var n=e.get("BarPosition");return 53+n*t+n*this.getPlugin().getEventBarSpacing()},getRoundedTimeMillis:function(e){var t=e.getTime();return t-=t%this._dayTimeSlotSizeMillis},getRoundedTime:function(e){e=Ext.Date.clone(e);var t=e.getMinutes();return e.setMinutes(t-t%this.getCalendar().getDayTimeSlotSize()),e.setSeconds(0),e.setMilliseconds(0),e}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events.month"};Ext.define("Ext.ux.TouchCalendarMonthEvents",{extend:"Ext.ux.TouchCalendarEventsBase",eventFilterFn:function(e,t,n){var i=Ext.Date.clearTime(e.get(this.getPlugin().getStartEventField()),!0).getTime(),a=Ext.Date.clearTime(e.get(this.getPlugin().getEndEventField()),!0).getTime();return i<=n&&a>=n},renderEventBars:function(e){var t=this.getCalendar().element.select("thead",this.getCalendar().element.dom).first().getHeight(),n=this.getCalendar().element.select("tbody",this.getCalendar().element.dom).first().getHeight(),i=this.getCalendar().element.select("tbody tr",this.getCalendar().element.dom).getCount(),a=n/i,r=this.getPlugin().getEventBarSpacing(),o=[];e.each(function(e){var t=this.getCalendar().getDateCell(e.get("Date")),n=this.getCalendar().getStore().findBy(function(t){return t.get("date").getTime()===Ext.Date.clearTime(e.get("Date"),!0).getTime()},this),i=Math.floor(n/7)+1,a=t.dom.cellIndex,r=e.get("BarPosition");o[i]||(o[i]=[]),o[i][a]||(o[i][a]=[]),o[i][a][r]=e},this);for(var s=0;s<o.length;s++)for(var l=o[s]||[],c=0;c<l.length;c++){var u=l[c]||[];if(u.length>0){var d=[];u.reverse();for(var _=u.length>4?3:u.length,h=0;h<u.length&&h<_;h++){var f=u[h],p=this.getPlugin().getEventRecord(f.get("EventID"));p.data.moreCount=void 0,d.push(this.getPlugin().getEventBarTpl().apply(p.data))}u.length>4&&d.push(this.getPlugin().getEventBarTpl().apply({woName:"",account:"",subject:"",moreCount:u.length-3}));var m=Ext.DomHelper.append(this.getPlugin().getEventWrapperEl(),{tag:"div",children:[{tag:"ul",cls:this.getPlugin().getEventBarCls()+"-inner",html:d.join("")}],eventID:u[0].get("EventID"),cls:this.getPlugin().getEventBarCls()},!0),v=t+20+a*(s-1),g=this.getCalendar().element.getWidth()/7*c;m.setLeft(g+r),m.setTop(v+r),m.setMaxWidth(this.getCalendar().element.getWidth()/7),m.setMaxHeight(a-20)}}}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events.week"};Ext.define("Ext.ux.TouchCalendarWeekEvents",{extend:"Ext.ux.TouchCalendarEventsBase",config:{eventSortDirection:"ASC",minEventHeight:50,orderedEventsPerTimeSlot:{}},generateEventBars:function(){if(null==this.eventBarStore&&(this.setEventsPerTimeSlot({}),this.setEventsSlotPerDay({}),this.setOrderedEventsPerTimeSlot({}),this.__filteredEventStore||(this.__filteredEventStore=this.createFilteredEventStore()),this.__filteredEventStore&&0!=this.__filteredEventStore.data.length)){var e=this.__filteredEventStore,t=null,n=0,i=[];e.each(function(e){var t=e.data.start.getTime();-1==i.indexOf(t)&&i.push(t)}),this.eventBarStore=Ext.create("Ext.data.Store",{model:"Ext.ux.CalendarEventBarModel",data:[]}),i.forEach(function(i){var a=new Date(i),r=i,o=[];if(e.each(function(e){var i=e.internalId;if(!this.eventFilterFn.call(this,e,null,r))return!0;n+=1;var s=this.eventBarStore.findBy(function(e){return e.data.EventID===i},this);if(s>-1)t=this.eventBarStore.getAt(s),o.push(t.get("BarPosition")),t.set("BarLength",t.get("BarLength")+1),this.getOrderedEventsPerTimeSlot()[a.getTime()]||(this.getOrderedEventsPerTimeSlot()[a.getTime()]=[]),this.getOrderedEventsPerTimeSlot()[a.getTime()][t.get("BarPosition")]=i;else{var l=this.getNextFreePosition(o);l>this.getMaxEventBarPos()&&this.setMaxEventBarPos(l),o.push(l),t=Ext.create("Ext.ux.CalendarEventBarModel",{EventID:i,Date:a,BarLength:1,BarWidth:1,BarPosition:l,Colour:e.css,Record:e}),this.eventBarStore.add(t),this.getOrderedEventsPerTimeSlot()[a.getTime()]||(this.getOrderedEventsPerTimeSlot()[a.getTime()]=[]),this.getOrderedEventsPerTimeSlot()[a.getTime()][l]=i}},this),n>0){this.getEventsPerTimeSlot()[a.getTime()]=n;var s=this.getEventsSlotPerDay()[a.toLocaleDateString()]||1;n>=s&&(this.getEventsSlotPerDay()[a.toLocaleDateString()]=n)}n=0},this),this.eventBarStore.each(function(e){var t=e.get("EventID"),n=0,i=this.getEventsSlotPerDay()[e.get("Date").toLocaleDateString()]||1,a=i;for(var r in this.getOrderedEventsPerTimeSlot()){var o=(new Date(Number(r)),this.getOrderedEventsPerTimeSlot()[r]),s=o.indexOf(t);if(s>-1){n=s;for(var l=n+1;l<o.length;l++)void 0!=o[l]&&l<a&&(a=l)}}e.set("BarWidth",a-n)},this)}},eventFilterFn:function(e,t,n){var i=this.getRoundedTimeMillis(e.data[this._startEventField]),a=e.data[this._endEventField].getTime();return i<=n&&a>=n},renderEventBars:function(e){var t=e.getCount(),n=0,i=void 0;for(this.getCalendar().getMaxWeekDays();n<t;n++){i=e.getAt(n);var a=i.data.Record,r=this.createEventBar(i,a),o=this.getEventBarWidth(i,60),s=this.getColumnWidth(i,60),l=this.getVerticalDayPosition(i),c=this.getHorizontalDayPosition(i,s),u=this.getEventBarHeight(i),d=this.getMinEventHeight();u=u>d?u:d,r.setLeft(c),r.setTop(l-this.getCalendar().element.getY()),r.setHeight(u),r.setWidth(o)}this.fireEventsRendered()},fireEventsRendered:function(){var e=this.getCalendar().getPeriodMinMaxDate();e&&this.getCalendar().fireEvent("eventsRendered",this,e.min,e.max)},getColumnWidth:function(e,t){var n=this.getEventsSlotPerDay()[e.get("Date").toLocaleDateString()],i=this.getCalendar().element.getWidth(),a=this.getPlugin().getEventBarSpacing(),r=this.getCalendar().getMaxWeekDays();n=n||1,t=t||0;var o=i-t,s=o/r,l=s/n;return Math.floor(l-a)},getEventBarWidth:function(e,t){var n=this.getEventsSlotPerDay()[e.get("Date").toLocaleDateString()],i=e.get("BarWidth"),a=this.getCalendar().element.getWidth(),r=this.getCalendar().getMaxWeekDays(),o=this.getPlugin().getEventBarSpacing();n=n||1,t=t||0,i=i||1;var s=a-t,l=s/r,c=l/n;return Math.floor(c*i-o)},getEventBarHeight:function(e){var t=this.getPlugin().getEventHeight();return Ext.isNumeric(t)?t:"duration"===t?this.getEventBarHeightDuration(e):"auto"},getEventBarHeightDuration:function(e){var t=e.data.Record.get(this.getPlugin().getStartEventField()),n=e.data.Record.get(this.getPlugin().getEndEventField()),i=this.getRoundedTime(t),a=0;n.getTimezoneOffset()!=t.getTimezoneOffset()&&(n=n.getTimezoneOffset()>t.getTimezoneOffset()==1?new Date(n.getTime()-36e5):new Date(n.getTime()+36e5));var r=(n.getTime()-t.getTime())/1e3/60,o=this.getCalendar().getDateCell(i);o.parent("tr",!1)&&(a=r*(o.getHeight()/30));return a},getVerticalDayPosition:function(e){var t=e.data.Record.get(this.getPlugin().getStartEventField()),n=this.getRoundedTime(t),i=2*n.getHours()+(30===n.getMinutes()?1:0),a=(t.getTime()-n.getTime())/1e3/60,r=this.getCalendar().element.select("table.time-slot-table td",this.getCalendar().element.dom).first(),o=0;if(r){var s=r.getHeight();o=r.getY()+i*s+a*(s/30)}return o},getHorizontalDayPosition:function(e,t){var n=e.get("BarPosition"),i=e.get("Date").getDay(),a=this.getCalendar().getMaxWeekDays(),r=this.getPlugin().getEventBarSpacing();return i=a<7?i-1:i,53+(this.getCalendar().element.getWidth()-60)/a*i+n*t+n*r},getRoundedTimeMillis:function(e){var t=e.getTime();return t-=t%this._dayTimeSlotSizeMillis},getRoundedTime:function(e){e=Ext.Date.clone(e);var t=e.getMinutes();return e.setMinutes(t-t%this.getCalendar().getDayTimeSlotSize()),e.setSeconds(0),e.setMilliseconds(0),e}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(741),r=i(a),o=n(18),s=i(o),l=n(0).utils,c=n(12).DatetimeUtil,u=n(11).Facade,d=n(7).SystemData,_={name:"com.servicemax.client.ui.components.largemodern.calendar.events.map"},h=function(){return l.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},f=c;Ext.define("Ext.ux.TouchCalendarMapEvents",{extend:"Ext.ux.TouchCalendarEventsBase",__failedEvents:0,__syncManager:null,__addressToLocation:{},__addressToGeoResult:{},__addressFromLatLon:{},__locationAddress:{},config:{eventSortDirection:"ASC",minEventHeight:50,orderedEventsPerTimeSlot:{}},constructor:function(e){this.initConfig(e),this.callParent(arguments);var t=l.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=t.getInstance()},generateEventBars:function(){var e=this.getMap()&&this.getMap().carousel&&this.getMap().carousel.getInnerItems()?this.getMap().carousel.getInnerItems():[],t=e.length>1?e[1].currentDate:null,n=this;null!=t&&((new Error).stack.indexOf("refreshEventsCalenderView")>0||(n.getMap().container.setPrevNextDisabled(!0),n.getMap().lastDate=t,n.__filteredEventStore||(n.__filteredEventStore=n.createFilteredEventStore()),n.__syncManager.checkConnectivity({delay:1}).done(l.proxy(n,function(){n.__generateEventBars(e,t)})).fail(l.proxy(this,function(){this.clearEventsFromMap(),l.Msg.toast({text:h().T("FSA001_TAG003","Cannot connect to the internet, maps will have limited functionality.")}),this.getMap().container.setPrevNextDisabled(!1)}))))},__triggerIFrameEvent:function(e){window.iFrameEventCallBack&&window.iFrameEventCallBack(e)},__generateEventBars:function(e,t){var n=this,i=n.getMap();if(this.__getGoogleStatusMsg(),i){var a={method:"resize"};this.__triggerIFrameEvent(a)}if(n.__getCurrentLocationLatLong().done(function(e){if(e in n.__addressFromLatLon||n.__getCurrentLocationAddressFromLatLong(e.location).then(function(t){t&&(n.__addressFromLatLon[e]=t)}),e in n.__addressFromLatLon){var t=n.__addressFromLatLon[e];n.__getGeocodeResult(t,{address:t}).then(function(e,i,a){n.__addressToLocation[t]=e[0].geometry.location;var r={method:"addCurrentMarker",position:n.__addressToLocation[t],icon:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/Map_Current_Location.svg"};n.__triggerIFrameEvent(r)})}}),!n.__filteredEventStore||0===n.__filteredEventStore.data.length){var r=l.getCurrentApplication().getCurrentView();return void(r&&r.__activeTab&&"map"===r.__activeTab&&n.__showNoWorkToast())}var o=n.__filteredEventStore,s=null;if(n.eventBarStore=Ext.create("Ext.data.Store",{model:"Ext.ux.CalendarEventBarModel",data:[]}),o.each(function(e){var t=e.internalId;if(!n.eventFilterFn.call(n,e,null,null))return!0;s=Ext.create("Ext.ux.CalendarEventBarModel",{EventID:t,Date:this.getCalendar().getCurrentDate(),Record:e}),n.eventBarStore.add(s)},n),0==n.eventBarStore.getCount())return void n.__showNoWorkToast();n.renderEventBars(n.eventBarStore)},__getGoogleStatusMsg:function(){var e=this,t={method:"googleStatusMsg",handler:function(t){e.__statusOk=l.cloneObject(t)}};this.__triggerIFrameEvent(t)},__showNoWorkToast:function(){var e=this;e.clearEventsFromMap(),e.getMap().container.setPrevNextDisabled(!1);var t=h().T("FSA001_TAG022","There are no work orders assigned for the day");l.Msg.toast({text:t})},__getCurrentLocationLatLong:function(){var e=l.Deferred();this.__nativeService=u;var t=this.__nativeService.createLocationTrackingRequest();return t.bind("REQUEST_COMPLETED",function(t){if(t.data.success){var n=l.toObject(t.data.data);n.hasOwnProperty("accuracy")&&(n.accuracy=parseFloat(n.accuracy)),n.hasOwnProperty("location")&&n.location.hasOwnProperty("lat")&&(n.location.lat=parseFloat(n.location.lat)),n.hasOwnProperty("location")&&n.location.hasOwnProperty("lng")&&(n.location.lng=parseFloat(n.location.lng)),e.resolve(n)}else this.logger.info("unable to find current location"),e.resolve([])},this),t.bind("REQUEST_ERROR",function(t){e.resolve([])},this),t.execute(),e},__getCurrentLocationAddressFromLatLong:function(e){var t=l.Deferred(),n={method:"geoCoder",type:"location",currentLocation:l.cloneObject(e),handler:function(e,n){var i=l.cloneObject(e);null!=i&&void 0!==i&&i.length>0?t.resolve(i[0].formatted_address):t.resolve()}};return this.__triggerIFrameEvent(n),t.promise()},__getGeocodeResult:function(e,t){var n=l.Deferred();t=t||{};var i={method:"geoCoder",type:"address",address:l.cloneObject(e),handler:function(e,i){var a=l.cloneObject(e),r=l.cloneObject(i);n.resolve(a,r,t)}};return this.__triggerIFrameEvent(i),n.promise()},eventFilterFn:function(e,t,n){return!!e.data.woName},renderEventBars:function(e){this.clearEventsFromMap(),this.__plotEvents(e)},__plotEvents:function(e){var t=this.getMap();if(!t||!e)return void(t&&t.container.setPrevNextDisabled(!1));var n={method:"resize"};this.__triggerIFrameEvent(n);var i=new Ext.Template("{street}\n","{city}, {state}\n","{country} {zipcode}",{compiled:!0}),a=this,o=e.getCount();this.__failedEvents=0;for(var c=[],u=0;u<o;u++){var d=e.getAt(u),_=d.data.Record,h=_.data.address,f=i.apply(h),p=f+_.id,m={address:f,record:_,addrWithId:p},v=null;if(h.latitude&&(0,s.default)("number"===h.latitude)&&h.longitude&&(0,s.default)("number"===h.longitude)&&(a.__addressToGeoResult[p]=[{geometry:{location:{lat:h.latitude,lng:h.longitude}}}]),p in a.__addressToGeoResult)v=a.__addressToGeoResult[p],a.__plotPoints(v,a.__statusOk,m);else{var g=(0,r.default)(h).toString();v=this.__getGeocodeResult(g,m).then(function(e,t,n){a.__plotPoints(e,t,n),status==a.__statusOk&&(a.__addressToGeoResult[n.addrWithId]=e)})}c.push(v)}l.when(c).then(a.__geocodesCallback.bind(this)).always(function(){t.container.setPrevNextDisabled(!1)})},__geocodesCallback:function(){var e=this,t=d.getUserInfo(),n=t.street,i=t.city,a=t.state,r=t.country,o=t.zip,s=null;n&&i&&a&&r&&o&&(s=n+"\n"+i+","+a+"\n"+r+o),e.geoStatus=null,e.__failedEvents>0?e.__showFailedLocationDialog(e.__plotHome(s)):e.__plotHome(s)},__showFailedLocationDialog:function(e){if(!this.__alertOpened){this.__alertOpened=!0;var t=this,n=h().T("TODO","One or more Work Orders contain an invalid address. Invalid addresses will be excluded from the route.");l.Msg.alert({text:n,handler:e}).then(function(e){t.__alertOpened=!1})}},__plotHome:function(e){var t=this.getMap(),n=this;e?(e in n.__addressToGeoResult||n.__getGeocodeResult(e,{address:e}).then(function(i,a,r){if(a==n.__statusOk)n.__addressToGeoResult[e]=i,n.__prepareRoute(n,t,e);else{var o=h().T("FSA001_TAG025","Home location address invalid and cannot be plotted");l.Msg.toast({text:o}),lat=null,lng=null,n.__checkMarkers(n),n.__fetchRoute(n,t,lat,lng)}}),e in n.__addressToGeoResult&&n.__prepareRoute(n,t,e)):(lat=null,lng=null,n.__checkMarkers(n),n.__fetchRoute(n,t,lat,lng))},__prepareRoute:function(e,t,n){var i=e.__addressToGeoResult[n],a=i[0].geometry.location.lat,r=i[0].geometry.location.lng,o=i[0].geometry.location,s=i[0].geometry.location;o in e.__locationAddress||e.__getCurrentLocationAddress(o).then(function(n){if(n==e.__statusOk)e.__locationAddress[o]=n,e.__plotRoute(e,o,s,t,a,r);else;}),o in e.__locationAddress&&e.__locationAddress[o]==e.__statusOk&&e.__plotRoute(e,o,s,t,a,r)},__plotRoute:function(e,t,n,i,a,r){e.geoStatus=e.__statusOk,e.__plotPoints(t,!0,null),e.__plotPoints(n,!0,null),e.__checkMarkers(e),e.__routeHomeLocation(e),e.__fetchRoute(e,i,a,r)},__checkMarkers:function(e){var t={method:"markersLength",handler:function(t){e.__markesLength=l.cloneObject(t),t>0&&e.fitToMarkers()}};this.__triggerIFrameEvent(t)},__routeHomeLocation:function(e){var t={method:"routeHomeLocation"};this.__triggerIFrameEvent(t)},__fetchRoute:function(e,t,n,i){if(null==n||null==i||e.geoStatus!=e.__statusOk){var a={method:"sortMarkers"};this.__triggerIFrameEvent(a)}var r={method:"createDirections"};if(this.__triggerIFrameEvent(r),e.__markesLength>0){var o={method:"getWayPoints",handler:function(t,n,i){var a=l.cloneObject(t),r=l.cloneObject(n),o=l.cloneObject(i);e.getRoute(a,r,o).done(function(t,n){var i={method:"directionsResponse",response:t};e.__triggerIFrameEvent(i)}).fail(function(e,t){l.Msg.toast({text:h().T("FSA001_TAG026","Unable to render directions on the map.")})})}};this.__triggerIFrameEvent(o)}},__getCurrentLocationAddress:function(e){var t=l.Deferred(),n={method:"geoCoder",type:"location",currentLocation:l.cloneObject(e),handler:function(e,n){l.cloneObject(n);t.resolve(n)}};return this.__triggerIFrameEvent(n),t.promise()},reset:function(){this.callParent(arguments)},clearEventsFromMap:function(){if(this.getMap()){var e={method:"clearEvents"};this.__triggerIFrameEvent(e)}},getMap:function(){return this.getPlugin().getInitialConfig().getMap()},getRoute:function(e,t,n){var i=l.Deferred(),a=this,r={method:"getRoute",start:e,end:t,waypoints:n,handler:function(e,t){var n=l.cloneObject(e),r=l.cloneObject(t);r==a.__statusOk?i.resolve(n,r):i.reject(n,r)}};return this.__triggerIFrameEvent(r),i.promise()},__plotPoints:function(e,t,n){var i=this,a=(i.getMap(),null);if(1==t){var r={method:"addMarker",position:e,eventRecord:a,icon:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/Map_techHome@1x.png"};i.__triggerIFrameEvent(r)}else{var o=n.address;a=n.record;var s=new Ext.Template('<div class="svmx-sfmevent-marker-top-section">','<span class="svmx-sfmevent-marker-title">{title}</span>','<span id="details-button" class="svmx-sfmevent-marker-details">{details}</span>',"</div>",'<div class="svmx-sfmevent-marker-body">','<span class="svmx-sfmevent-marker-time">{start_time}</span>','<span class="svmx-sfmevent-marker-date">{start_date}</span>','<div class="svmx-sfmevent-marker-addr-dir-wrap">','<span class="svmx-sfmevent-marker-address">{address}</span>','<span id="get-directions-button" class="svmx-sfmevent-marker-directions-btn">{get_directions}</span>',"</div>","</div>",{compiled:!0});if(t!==i.__statusOk)return void this.__failedEvents++;var l={title:a.data.title,details:h().T("FSA001_TAG027","Details"),start_time:f.getFormattedDatetime(a.data.start,f.getDefaultTimeFormat()),start_date:i.__formatDateForDayTitle(a.data.start),address:o,get_directions:h().T("FSA001_TAG028","Get Directions")},c={method:"addMarker",position:e[0].geometry.location,type:"addInfo",eventRecord:a,content:s.apply(l),icon:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/pin@1x.png",handler:function(e){if("details"==e.type&&i.getPlugin().getCalendar().fireEvent("eventtap",a),"direction"==e.type){u.createGEORequest().execute({latitude:e.lat,longitude:e.lng})}}};i.__triggerIFrameEvent(c)}},fitToMarkers:function(){var e={method:"fitToMarkers"};this.__triggerIFrameEvent(e)},getRoundedTimeMillis:function(e){var t=e.getTime();return t-=t%this._dayTimeSlotSizeMillis},getRoundedTime:function(e){e=Ext.Date.clone(e);var t=e.getMinutes();return e.setMinutes(t-t%this.getCalendar().getDayTimeSlotSize()),e.setSeconds(0),e.setMilliseconds(0),e},__formatDateForDayTitle:function(e){return"en"==f.getLocale()?f.getFormattedDatetime(e,"ddd MMM D, YYYY"):f.getFormattedDatetime(e,"LL")}}),l.defineGlobal(_.name,_),e.exports=_},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events.simple"};Ext.define("Ext.ux.TouchCalendarSimpleEvents",{extend:"Ext.mixin.Observable",startEventField:"start",endEventField:"end",multiEventDots:!1,wrapperCls:"simple-event-wrapper",eventDotCls:"simple-event",dotWidth:10,eventTpl:['<span class="{wrapperCls}">','<tpl for="events">','<span class="{[parent.eventDotCls]}"></span>',"</tpl>","</span>"].join(""),filterFn:function(e,t,n){2===arguments.length&&(n=t);var i=e.get(this.startEventField).getTime(),a=e.get(this.endEventField).getTime(),r=n.getTime();return i<r+864e5&&a>=r},init:function(e){this.calendar=e,this.calendar.simpleEventsPlugin=this,this.wrapperCls=this.wrapperCls+(this.multiEventDots?"-multi":""),this.eventDotCls=this.eventDotCls+(this.multiEventDots?"-multi":""),this.calendar.showEvents=this.showEvents,this.calendar.hideEvents=this.hideEvents,this.calendar.removeEvents=this.removeEvents,this.calendar.checkSetDate=Ext.Function.interceptBefore(this.calendar,"checkSetDate",this.__onSetDate,this),this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this),this.calendar.reset=Ext.Function.createSequence(this.calendar.reset,this.reset,this)},__needRefreshEvents:!0,reset:function(){this.__needRefreshEvents=!0},__onSetDate:function(e,t){e!==t&&this.reset()},refreshEvents:function(){if(this.__needRefreshEvents&&!this.disabled&&"DAY"!==this.calendar.getViewMode()&&"WEEK"!==this.calendar.getViewMode()){var e=this.calendar.getStore();if(e){var t=e.getCount(),n=e.getData(),i=0,a=[];for(this.removeEvents();i<t;i++){var r=n.items[i].get("date"),o=this.calendar.getDateCell(r),s=this.calendar.eventStore;if(o){if(o.hasCls("unselectable"))continue;var l=o.getWidth(),c=o.getHeight();s.clearFilter();var u=r.toDateString();if(!a[u]){a[u]=!0;var d=s.findBy(Ext.bind(this.filterFn,this,[r],!0)),_=s.getRange().length;if(!this.multiEventDots&&d>-1||this.multiEventDots&&_>0){var h=Math.min(l/this.dotWidth,_),f=new Ext.XTemplate(this.eventTpl).append(o,{events:this.multiEventDots?s.getRange().slice(0,h):["event"],wrapperCls:this.wrapperCls,eventDotCls:this.eventDotCls},!0),p=Math.min((this.multiEventDots?s.getRange().length:1)*this.dotWidth,l),m=Math.round(o.getY()+c-20)-(f.getHeight()+.1*c),v=Math.round(o.getX()+l/2-2)-f.getWidth()/2;f.setWidth(p),f.setXY([v,m])}}}}this.__needRefreshEvents=!1}}},hideEvents:function(){this.simpleEventsPlugin.disabled=!0,this.calendar.element.select("span."+this.wrapperCls,this.calendar.element.dom).hide()},showEvents:function(){this.simpleEventsPlugin.disabled=!1,this.calendar.element.select("span."+this.wrapperCls,this.calendar.element.dom).show()},removeEvents:function(){this.calendar.element&&this.calendar.element.select("span."+this.wrapperCls,this.calendar.element.dom).each(function(e){Ext.destroy(e)})}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(30),s=i(o),l=n(10),c=n(0).utils,u=n(22).View,d=n(89).ConnectionUtil,_=n(131).PIQSearchUtilityHelper,h=n(131).CacheHelper,f=3,p={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.resultview"},m=function(){return c.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},v=u,g=c.getLoggingService().getLogger("sfmsearch-ui"),y=p.name,S=d;p.PIQSearchUtilityHelper=_,p.CacheHelper=h,Ext.define(y+".SfmSearchContainer",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXVertPanel",alias:"widget.sfmsearch.sfmsearchcontainer",width:"100%",ui:"svmx-default",height:"100%"}),Ext.define(y+".viewmodel.SearchResultViewModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.sfmsearch.SearchResultViewModel"}),Ext.define(y+".view.SfmSearchResultController",{extend:"Ext.app.ViewController",alias:"controller.sfmsearch.SfmSearchResultController",init:function(){},onInfoColumnClicked:function(e,t){t.stopEvent();var n=this,i=e.parent,a=i._record,r=n.getView().getColumns(),o=i.getParent(),s=o.getGrid(),l=s.currentSearchDetails,c=Ext.create({xtype:"sfmsearch.recordviewpopover",record:a,columns:r,currentSearchDetails:l});Ext.Viewport.add(c).show()},onItemTap:function(e,t,n,i,a,r){var o=Ext.get(a.target),s=Ext.valueFrom(i.get("dodstatus"),""),l="true"===i.get("online")||"downloading"===i.get("online"),c=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DownloadOnDemandHelper",{}),u=o.hasCls("sfmsearch-download-icon");l&&"downloading"===s&&o.hasCls("sfmsearch-dod-cancel-link")?c.cancelDownloadRecord(i):l&&Ext.isEmpty(s)&&"error"!=s&&"offline"!=s&&u?c.downloadRecord(i,e.currentSearchDetails):l||c.openRecord(i)}}),p.ResultsView=Ext.define(y+".ResultsView",{extend:v,alias:"widget.sfm.search.resultview",ui:"svmx-default",__selected:null,config:{model:null},__syncManager:null,__syncImpl:null,__picklistTranslationCache:{},__grid:null,__firstLaunch:!0,accountID:null,isPIQCaching:null,connectivityCheckTasks:{},recordColumns:[],statics:{downloadCount:0,maxParallelDownloadCount:f},getViewLoadMask:function(){return{xtype:"svmx.loadmask",transparent:!0,indicator:!1,message:""}},constructor:function(e){this.callParent(arguments),this.on("painted",c.proxy(this,"onViewPainted")),this.on("hide",c.proxy(this,"onHide"))},getSyncManager:function(){var e=c.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");return this.__syncManager=e.getInstance(),this.__syncManager},syncCompleteRefresh:function(e){if(this.__syncManager&&this.__syncManager.getSyncType){var t=this.__syncManager.getSyncType();"ONECALLSYNC"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t||(this.refreshView(),g.info("Refreshing SFM Result View ID:"+this.id))}},bindSyncCompleted:function(){this.__syncManager&&(g.info("BIND Refresh ::for View Id: "+this.id),this.__syncManager.bind("SYNC_COMPLETED",this.syncCompleteRefresh,this))},unBindSyncCompleted:function(){this.__syncManager&&(g.info("UNBIND Refresh ::for View Id: "+this.id),this.__syncManager.unbind("SYNC_COMPLETED",this.syncCompleteRefresh,this))},updateOptions:function(e){this.accountID=e.accountID?e.accountID:"",this.isPIQCaching=!!e.isCaching&&e.isCaching,this.__syncManager=this.getSyncManager(),this.bindSyncCompleted();var t=e.record;this.setViewInfo({windowTitle:t.get("name"),backText:t.get("name"),subTitle:t.get("description"),hideContextMenu:!0})},refreshView:function(){var e=this.getOption("searchId"),t=this.getOption("detailObjectId");this.fireSearch({searchId:e,detailObjectId:t,fromSyncRefresh:!0}),p.CacheHelper.refreshView()},getGrid:function(){return this.__grid},setGrid:function(e){this.__grid=e},onShow:function(){this.bindSyncCompleted(),this.__selected=!1;var e=this.getGrid();e&&e.deselectAll(),this.updateConnectivityMonitor("start"),g.info("SfmSearchView View showing"),this.callParent()},onHide:function(){this.__firstLaunch||(this.unBindSyncCompleted(),this.__storeSortersInCache(),this.__storeStateInCache(),this.updateConnectivityMonitor("stop"),g.info("SfmSearchView View hiding")),this.callParent()},onViewPainted:function(){this.__firstLaunch&&(this.blockApplication(),this.__firstLaunch=!1)},updateConnectivityMonitor:function(e){var t=this,n=t.connectivityCheckTasks;switch(e){case"start":t.connectivityCheckTasks.onlineOption||t.initConnectivityMonitorForOnlineSearchOption();break;case"stop":for(var i in n){n[i].destroy(),delete n[i]}t.connectivityCheckTasks={}}},__storeStateInCache:function(){var e=this.getGrid(),t=void 0;this.destroyed||(t=this.down("#searchBar"));var n=this.operator,i=this.keyword,a=this.maximumLocalRecordsToQuery;this.includeOnline;if(t&&t.getItems()&&t.getItems().items.length>0&&(n=t.getComponent("operator").getValue(),i=t.getComponent("keyWord").getValue(),t.getComponent("includeOnline").getValue()),e){var r={operator:n,keyWord:i,recordLimit:a,interests:[!1]};this.cacheServ&&this.cacheServ.setItem("sfmsearch"+this.detailObjectId,c.toJSON(r))}},__storeSortersInCache:function(){if(this.listIdArray&&this.listIdArray.length>0)for(var e=this.listIdArray.length,t=0;t<e;t++){var n=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DynamicViewIdHelper",{}),i=n.getStoreId(this.listIdArray[t]),a=Ext.data.StoreManager.lookup(i),r=a&&a.getState();r&&r.sorters.length>0&&this.cacheServ.setItem("sfmsearch"+i,c.toJSON(r))}},viewsCreated:null,cacheServ:null,listIdArray:[],keyword:null,operator:null,searchEngine:null,metaModel:null,onlineSearchEnabled:null,includeOnlineValueChanged:null,currentSearchDetails:{},searchType:null,ready:function(){var e=this;e.viewsCreated=!1,e.searchEngine=e.getDeliveryEngine(),"PRODUCTIQ"===e.searchEngine.getSearchType()?e.metaModel=e.searchEngine.getIBSearchDataModel():e.metaModel=e.searchEngine.getMetaModel(),e.cacheServ=c.getClient().getServiceRegistry().getService("com.servicemax.client.cache").getInstance(),e.listIdArray=[],e.keyword=null,e.operator=null,e.includeOnline=null,this.setModel(e.metaModel),e.maximumLocalRecordsToQuery=2e3,e.onlineSearchEnabled=c.getClient().getApplicationParameter("enable-online-search"),e.includeOnlineValueChanged=!1,e.searchType=e.getDeliveryEngine().getSearchType(),f=c.getClient().getApplicationParameter("sfm-search-max-parallel-download-count"),e.buildRecordLimitStore(),e.searchId=e.getOption("searchId"),e.detailObjectId=e.getOption("detailObjectId");var t={xtype:"svmx.verticalpanel",width:"100%",height:"100%",cls:"sfmsearch-search-container",ui:"svmx-default",scrollable:"y",items:[{xtype:"sfmsearch.sfmsearchbar",cls:"sfmsearch-search-bar",itemId:"searchBar",ui:"svmx-default",docked:"top",defaultRecordLimit:e.maximumLocalRecordsToQuery,onlineSearchEnabled:e.onlineSearchEnabled,searchTapHandler:e.searchTapHandler},{xtype:"svmx.panel",cls:"sfmsearch-search-results-container",ui:"svmx-default",itemId:"searchResultsContainer",items:[]}]};e.add(t),e.updateConnectivityMonitor("start"),e.fireSearch({searchId:e.searchId,accountID:e.accountID,detailObjectId:e.detailObjectId,isPIQCaching:e.isPIQCaching})},searchTapHandler:function(e,t,n){var i=this,a=p.PIQSearchUtilityHelper.getToolBarView(),r=a.getComponent("operator"),o=a.getComponent("keyWord"),s=a.getComponent("includeOnline");e||(e=a.getComponent("searchButton")),t&&e&&e.getText()===m().T("FSA004_TAG014","Reset")&&(o.setValue(o.originalValue),r.setValue(r.originalValue),e.setText(m().T("FSA004_TAG011","Search")));var l=r.getValue(),c=o.getValue(),u=s.getValue(),d=!1,_=p.PIQSearchUtilityHelper.getSearchResultsView();_&&(d=_.isPIQCaching);var h={KeyWord:c,Operator:l,RecordLimit:i.maximumLocalRecordsToQuery,includeOnline:u,isPIQCaching:d};_&&_.fireSearch(h)},uniqueBy:function(e,t){var n={},i=[];return e.forEach(function(e){var a=t(e);n[a]||(i.push(a),n[a]=!0)}),i},clientRecordLimits:[25,50,100,150],buildRecordLimitStore:function(){var e=this,t=400,n=parseInt(e.searchEngine.searchResultsMaxCount);n&&n>0&&n<t&&(t=n),e.onlineSearchResultLimit=t},getGridForSearchResult:function(e){var t=this,n={listViewId:e.listViewId,itemId:e.gridId,title:e.title,padding:"0px 0px 10px 0px !important",collapsible:!1,collapsed:!e.collapsed,cls:"sfmsearch-collapsible-container",ui:"svmx-default",emptyText:m().T("FSA004_TAG013","No records to display."),store:e.store,columns:e.columns,currentSearchDetails:t.currentSearchDetails[e.listViewId],infinite:!1,parent:t};e.resultCount>100&&(n.plugins="svmxgridpagingtoolbar",n.pagingBarDockPosition="bottom",n.addToParent=!0,n.parentPage="search");var i=Ext.widget("sfmsearch.sfmsearchresultgrid",n);t.setGrid(i);var a=p.PIQSearchUtilityHelper.getSearchResultsContainer();a&&a.add(i)},fireSearch:function(e){var t=this,n=p.PIQSearchUtilityHelper.getToolBarView();if(n){t.operator=n.getComponent("operator").getValue(),t.keyword=n.getComponent("keyWord").getValue(),t.includeOnline=n.getComponent("includeOnline").getValue();n.getComponent("searchButton").setDisabled(!0)}Ext.isEmpty(e.fromSyncRefresh)&&this.__storeStateInCache(),e.searchId||(e.searchId=t.searchId),e.detailObjectId||(e.detailObjectId=t.detailObjectId);var i=void 0;e.isPIQCaching||(i=this.cacheServ.getItem("sfmsearch"+e.detailObjectId)),i=c.toObject(i);var a=c.array.get(t.metaModel,function(t){return t.processObjectId==e.searchId}),r=c.deepCloneObject(a);if(r.searchDetails.length>1){var o=c.array.get(r.searchDetails,function(t){return t.detailObjectId==e.detailObjectId});r.searchDetails=[],r.searchDetails[0]=o}var s=void 0;if(i){for(var l=0;l<i.interests.length;l++)Ext.isEmpty(r.searchDetails[l])||(r.searchDetails[l].collapsed=i.interests[l]);if(s={searchInfo:r,KeyWord:i.keyWord,Operator:i.operator,RecordLimit:i.recordLimit,includeOnline:t.includeOnline},n){n.getComponent("operator").setValue(i.operator),n.getComponent("keyWord").setValue(i.keyWord)}}else s={searchInfo:r,KeyWord:e.KeyWord,Operator:e.Operator,RecordLimit:e.RecordLimit,includeOnline:e.includeOnline};t.performSearch(s,e.searchId)},performSearch:function(e,t){var n=l.Deferred(),i=null,a=this;a.unblockApplication(),a.blockApplication();var r=e.searchInfo,o=(e.KeyWord,e.Operator,e.RecordLimit||a.maximumLocalRecordsToQuery);e.includeOnline;if(!r)return!1;var u=p.PIQSearchUtilityHelper.getToolBarView(),d=null,_=null,h=null;if(u&&(d=u.getComponent("operator"),_=u.getComponent("keyWord"),i=u.getComponent("searchButton"),h=u.getComponent("includeOnline"),u.getComponent("includeOnline").setValue(!1)),i.getText()===m().T("FSA004_TAG014","Reset"))d.setValue(d.getValue()),_.setValue(_.getValue()),h.setLabel(m().T("FSA004_TAG010","Online Items")),h.setValue(!1),i.setText(m().T("FSA004_TAG014","Reset")),i.setDisabled(!1),this.__storeStateInCache(),a.unblockApplication();else{i&&(d.getValue()!=d.originalValue||_.getValue()&&""!=_.getValue()||h.getValue())&&i.setText(m().T("FSA004_TAG014","Reset"));var f=null,v=[],g=r.searchDetails,y=void 0,E=g.length;for(y=0;y<E;y++){f={ProcessId:r.processObjectId,ProcessName:r.processId,KeyWord:Ext.isEmpty(e.KeyWord)?"":e.KeyWord,Operator:Ext.isEmpty(e.Operator)?"Contains":e.Operator,RecordLimit:a.maximumLocalRecordsToQuery,OnlineRecordLimit:a.onlineSearchResultLimit};var b=g[y],T=b.detailObjectId;f.ObjectId=T,f.searchDetail=b,f.accountID=this.accountID,a.makeFieldNameWithoutIndex(b.fields),v.push(c.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_SEARCH_RESULTS",this,{request:f})),a.currentSearchDetails[T]=b,!0===e.includeOnline&&(this.setViewInfo({windowTitle:m().T("FSA004_TAG015","Searching..."),backText:null,hideBackButton:!0,hideContextMenu:!0}),a.unblockApplication(),Ext.Viewport.setMasked({xtype:"svmx.panel",items:[{xtype:"svmx.loadmask",message:"",transparent:!0},{xtype:"svmx.button",ui:"button-sfmdelivery-load-cancel",cls:"button-sfmdelivery-load-cancel",labelCls:"svmx-button-label-largemodern",text:m().T("FSA004_TAG016","Cancel Search"),handler:function(){"pending"==n.state()&&n.reject(),u&&i.setDisabled(!1),a.setViewInfo({windowTitle:e.searchInfo.name,backText:e.searchInfo.name,hideBackButton:!1,hideContextMenu:!0}),Ext.Viewport.setMasked(null),a.unblockApplication()}}]}),v.push(c.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_ONLINE_RESULTS",this,{request:(0,s.default)({},f)})))}c.create("com.servicemax.client.sfmconsole.utils.EventCollection",a.getDeliveryEngine().getEventBus(),v).triggerAll(function(t){var i=t.items(),r=i.length,s=void 0,l=[],u=[];for(s=0;s<r;s++)"SFMSEARCHDELIVERY.GET_SEARCH_RESULTS"==i[s].type()?l.push(i[s].response):"SFMSEARCHDELIVERY.GET_ONLINE_RESULTS"==i[s].type()&&(i[s].response?u.push(i[s].response):S.checkConnectivity().then(function(e){if("false"===e.toLowerCase()){var t={text:m().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."),type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};c.getCurrentApplication().showMessage(t)}Ext.Viewport.setMasked(null),a.unblockApplication()}));if(s==r)if(u.length){var d=this;setTimeout(function(){d.setViewInfo({windowTitle:e.searchInfo.name,backText:e.searchInfo.name,hideBackButton:!1,hideContextMenu:!0}),"rejected"===n.state()?d.handleSearchResults(l,o,e.searchInfo):n.resolve(d.mergeResults(u,l))},100)}else n.resolve(l)},this),n.then(function(n){u&&(i.setDisabled(!1),setTimeout(function(){u.getComponent("keyWord").enable(),u.getComponent("keyWord").hideClearTrigger()},0)),a.includeOnline&&h?h.setLabel(m().T("FSA004_TAG017","Refresh Online Items")):h&&h.setLabel(m().T("FSA004_TAG010","Online Items")),n&&n.length&&a.__fixTranslationsForPicklists(n,t),a.handleSearchResults(n,o,e.searchInfo),Ext.Viewport.setMasked(null),setTimeout(function(){a.setViewInfo({windowTitle:e.searchInfo.name,backText:e.searchInfo.name,hideBackButton:!1,hideContextMenu:!0})},100),a.unblockApplication(),a.showTutorial(n.length)})}},makeFieldNameWithoutIndex:function(e){if(e){var t=e.length,n=0;for(n;n<t;n++){var i=e[n];if(i.fieldName.includes("@__")){var a=i.fieldName.split("@__");i.fieldName=a[0]}}}return""},__fixTranslationsForPicklists:function(e,t){var n=c.array.get(this.metaModel,function(e){return e.processObjectId==t});if(n){var i=0,a=e.length;for(i;i<a;i++){var r=e[i].MapStringMap;if(r.length){var o=e[i].stringMap[0].value;this.__translatePickListRecordValues(r,o,n)}}}},__getAvailableTranslationsForPicklist:function(e,t,n){if(n.indexOf("-")>0){var i=n.split("-").reverse();n=i[0]}if(this.__picklistTranslationCache[e]&&this.__picklistTranslationCache[e][n])return this.__picklistTranslationCache[e][n];var a=(this.metaModel,[]),r=c.array.filter(t.searchDetails,function(t){if(t.detailObjectId===e)return t});if(r.length){r=r[0];var o=c.array.get(r.fields,function(e){if(e.fieldName===n)return e});o&&o.__data&&o.__data.fldDescribe&&(a=o.__data.fldDescribe.picklistValues)}return this.__picklistTranslationCache[e]=this.__picklistTranslationCache[e]||{},this.__picklistTranslationCache[e][n]=a,a},__translatePickListRecordValues:function(e,t,n){var i=0,a=e.length,r=e[0].valueMap.length;for(i;i<a;i++){var o=e[i],s=0;for(s;s<r;s++){var l=o.valueMap[s];if(l&&l.type){var c=l.type.toLowerCase();if("--"===l.value&&(l.value=""),l.value&&("picklist"===c||"multipicklist"===c)){var u=this.__getAvailableTranslationsForPicklist(t,n,l.key);l.value=this.__getTranslatedPicklistValues(l.value,u,c)}}}}},__getTranslatedPicklistValues:function(e,t,n){var i=void 0;return"picklist"===n?i=this.__getPicklistTranslation(e,t):"multipicklist"===n&&(i=this.__getTranslatedValuesForMultiPicklist(e,t)),i},__getTranslatedValuesForMultiPicklist:function(e,t){var n=e.split(";"),i=n.length,a=0,r=[];for(a;a<i;a++){var o=n[a],s=this.__getPicklistTranslation(o,t);r.push(s)}return r.join(";")},__getPicklistTranslation:function(e,t){var n=0,i=t.length,a=e;for(n;n<i;n++){var r=t[n];if(r.value===e){a=r.label||e;break}}return a},mergeResults:function(e,t){(e||[]).forEach(function(e){(e.MapStringMap||[]).forEach(function(e){var t=null;(e.valueMap||[]).forEach(function(n){"Id"==n.key&&(n.value=e.Id,t=!0)}),t||e.valueMap.push({key:"Id",value:e.Id})})});var n={};return(t||[]).forEach(function(e){n[e.stringMap[0].value]=e}),(e||[]).forEach(function(e){if(!Ext.isEmpty((0,r.default)(e))&&e.stringMap[0].value in n){var t=n[e.stringMap[0].value],i={};(t.MapStringMap||[]).forEach(function(e){i[e.id]=e}),(e.MapStringMap||[]).forEach(function(e){e.Id in i||t.MapStringMap.push(e)})}}),this.applySorting(t,{})},applySorting:function(e,t){for(var n=e.length,i=this.maximumLocalRecordsToQuery+this.onlineSearchResultLimit,a=0;a<n;a++){var r=e[a],o=this.__getViewIdFromResult(r),s=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DynamicViewIdHelper",{}),l=s.getStoreId(o),u=Ext.data.StoreManager.lookup(l);if(u){var d=this.cacheServ.getItem("sfmsearch"+l);d=c.toObject(d),d&&d.sorters.length>0&&u.sort(d.sorters)}}for(var _=0;_<n;_++)e[_].MapStringMap=e[_].MapStringMap.slice(0,i);return e},showTutorial:function(e){var t=c.getCurrentApplication();if(t.initialSfmSearchTutorialShown&&e>1){var n=Ext.ComponentQuery.query("svmx\\.collapsibletitlebar")[0];Ext.widget("sfmsearch.tutorial",{html:m().T("FSA004_TAG018","Tap on the titles to expand and collapse the tables ")}).showBy(n,"tl-tr?"),t.initialSfmSearchTutorialShown=!1}},__getViewIdFromResult:function(e){var t=e.stringMap,n=void 0,i=t.length,a=null;for(n=0;n<i;n++)if("SEARCH_OBJECT_ID"==t[n].key){a=t[n].value;break}return a},sortByProperty:function(e,t){var n="targetObjectLabel",i=e[n],a=t[n];return i>a?1:i<a?-1:0},onlineSearchValueChanged:function(e){this.includeOnlineValueChanged=e},createViews:function(e,t){var n=this,i=p.PIQSearchUtilityHelper.getSearchResultsContainer();if(i){var a=n.getDockedItems();a&&a.length>0&&a[0].destroy(),i.removeAll()}var r=e.searchDetails,o=void 0,s=r.length,l=1===r.length;for(o=0;o<s;o++)void 0!=r[o].collapsed?n.__createListView(r[o],!r[o].collapsed,t):n.__createListView(r[o],l,t);n.viewsCreated=!0},handleSearchResults:function(e,t,n){var i=this,a=void 0,r=e.length,o=void 0,s=void 0,l=void 0,u=null,d=null;for(a=0;a<r;a++){o=e[a];var _=this.__getViewIdFromResult(o);s=o.MapStringMap,u=[];var h,f=o.totalCount,p=s.length;for(i.createViews(n,p),h=0;h<p;h++){l=s[h];var m,v=l.valueMap,g=v.length,y=v.filter(function(e){return"online"===e.key})[0],S=!y,E=0,b=l.Id?l.Id:l.id;for(i.addRecordIDObject(v,b),d={RecordId:b,info:"",Id:b,id:b},m=1;m<g;m++){var T="";"online"!=v[m].key&&(T="@__"+m),S?d[v[m].key+T]=v[m].value:v[m-E].key!=i.fieldNameForOnline[m]?(E+=1,d[i.displayFieldWithSeq[m]+T]=""):d[i.displayFieldWithSeq[m]+T]=v[m-E].value,"online"===v[m].key?d[v[m].key]=v[m].value:d[v[m].key+"__key"]=v[m].value1}u[h]=d}var M=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DynamicViewIdHelper",{}),I=M.getStoreId(_),C=Ext.data.StoreManager.lookup(I),A=C.proxy,D=A.reader,x=A.data[D._rootProperty]||[];A.data[D._rootProperty]=x.concat(u),C.totalCount=Number(u.length),A.data.total=Number(u.length),C.load();var R=i.cacheServ.getItem("sfmsearch"+I);R=c.toObject(R),R&&R.sorters.length>0&&C.sort(R.sorters);var O=u.length;i.updateResultGridTitle({listViewId:_,recordLimit:t,shownCount:O,resultsTotalCount:f})}},addRecordIDObject:function(e,t){if(e&&e.length>0&&"Id"!=e[0].key){var n={};n.key="Id",n.value=t,e.splice(0,0,n)}},updateResultGridTitle:function(e){var t=this,n=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DynamicViewIdHelper",{}),i=n.getGridId(e.listViewId),a=Ext.ComponentQuery.query("#"+i);if(!Ext.isEmpty(a)){var r=a[0];a.length>1&&(r=a[1]);var o=r.initialTitle,s=c.string.substitute("{{title}} ({{shownCount}})",{title:o,shownCount:e.shownCount});if(e.resultsTotalCount>e.recordLimit&&!t.includeOnline){var l={title:o,showingText:m().T("FSA004_TAG027","Showing"),shownCount:e.shownCount,ofText:m().T("FSA004_TAG028","of"),resultsTotalCount:e.resultsTotalCount,refineText:m().T("FSA004_TAG029","Refine search to narrow results")};s=c.string.substitute('{{title}} (<span class="sfmsearch-result-title-showing-text">{{showingText}}</span> {{shownCount}} {{ofText}} {{resultsTotalCount}}) <span class="sfmsearch-result-title-secondary">{{refineText}}</span>',l)}r.setTitle(s)}},initConnectivityMonitorOnStore:function(e){var t=this,n=new Ext.util.TaskRunner,i=void 0,a=function(n){var i=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DynamicViewIdHelper",{}),a=i.getGridId(e),r=Ext.ComponentQuery.query("#"+a)[0];if(r){var o=r.getStore();"false"===n.toLowerCase()?o.each(function(e){"true"===e.get("online")&&t.updateDODStatus(e,"offline")}):o.each(function(e){"true"===e.get("online")&&"offline"===e.get("dodstatus")&&t.updateDODStatus(e,"")}),o.sync()}},r=function(e){S.checkConnectivity().then(a)};i=n.newTask({id:e,run:r,interval:1e3}),i.start(),t.connectivityCheckTasks[e]||(t.connectivityCheckTasks[e]=i)},updateDODStatus:function(e,t){var n=e.get("online");e.beginEdit(),e.set("dodstatus",t),e.set("online",""),e.endEdit(),e.beginEdit(),e.set("online",n),e.endEdit()},initConnectivityMonitorForOnlineSearchOption:function(){var e=this,t=new Ext.util.TaskRunner,n=void 0,i=function(t){var n=e.down("#searchBar"),i=null;n&&(i=n.getComponent("includeOnline")),"false"===t.toLowerCase()?i&&i.setDisabled(!0):i&&i.setDisabled(!1)},a=function(e){S.checkConnectivity().then(i)};n=t.newTask({id:"onlineOption",run:a,interval:1e3}),n.start(),e.connectivityCheckTasks.onlineOption||(e.connectivityCheckTasks.onlineOption=n)},__createListView:function(e,t,n){var i=this,a=e.detailObjectId,r=e.fields,o=void 0,s=r.length,l=[],c=[],u=void 0;for(i.displayFieldWithSeq=[],i.fieldNameForOnline=[],i.displayFieldWithSeq.push("Id"),i.fieldNameForOnline.push("Id"),o=0;o<s;o++){u=r[o];var d=u.getFullFieldName();i.displayFieldWithSeq.push(d),i.fieldNameForOnline.push(i.getCustomFieldName(u));if(!u.fieldName.includes("@__")){var _=1+o;u.fieldName=u.fieldName+"@__"+_}var h=this.__getFieldType(u),f={name:u.getFullFieldName(),type:h,reference:""};"date"===h&&(f.sortType=Ext.data.SortTypes.asDate(),f.calculate=function(e){return e[this.name]}),c.push(f),l[o]=this.__createListViewColumnDefinition(u,{text:u.fieldLabel,flex:1,cls:"sfmsearch-result-column",tooltip:u.fieldLabel,hidden:o>=4,dataIndex:u.getFullFieldName()},o)}i.includeOnline&&l.push(this._getOnlineColumn()),l.push(this._getInfoColumn()),c.push({name:"isRecordInConflict",type:"string",reference:""}),c.push({name:"Info",type:"string",reference:""}),c.push({name:"online",type:"string",reference:""}),i.listIdArray.push(a);var p=Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.DynamicViewIdHelper",{}),m=p.getStoreId(a),v=p.getGridId(a),g=Ext.create("Ext.data.Store",{fields:c,storeId:m,gridId:v,stateful:!0,autoLoad:!0,pageSize:100,remoteSort:!0,data:{searchResults:[]},proxy:{type:"memory",enablePaging:!0,reader:{type:"json",rootProperty:"searchResults"}}});i.initConnectivityMonitorOnStore(a),i.getGridForSearchResult({title:Ext.String.htmlEncode(e.targetObjectLabel),listViewId:a,gridId:v,columns:l,store:g,collapsed:t,resultCount:n})},getCustomFieldName:function(e){var t=e.fieldName;return e.parentReferenceName.length>0&&(t=e.parentReferenceName+"-"+t),t},_getInfoColumn:function(){var e={displayType:"TEMPLATE",fieldLabel:"",fieldName:"",parentName:"",data:{Info:""},parentReferenceName:"",getFullFieldName:function(){return this.fieldName}};return this.__createListViewColumnDefinition(e,{text:"",dataIndex:"Info",cls:"sfmsearch-result-info-icon-column",flex:.4,skipInViewRecord:!0,sortable:!1})},_getOnlineColumn:function(){var e={displayType:"ONLINE_COLUMN",fieldLabel:"",fieldName:"online",parentName:"",data:{online:""},parentReferenceName:"",getFullFieldName:function(){return this.fieldName}};return this.__createListViewColumnDefinition(e,{text:"",dataIndex:"online",cls:"sfmsearch-result-online-icon-column",flex:.4,skipInViewRecord:!0,sortable:!1})},__getFieldType:function(e){return"DATETIME"==e.displayType?"date":"string"},__createListViewColumnDefinition:function(e,t,n){var i=null,a=Ext.create("sfmsearch.columnfactory",{fld:e,uiConfig:t,index:n});switch(e.displayType){case"TEMPLATE":i=a.createColumn("TEMPLATE");break;case"DATETIME":i=a.createColumn("DATETIME");break;case"DATE":i=a.createColumn("DATE");break;case"ONLINE_COLUMN":i=a.createColumn("ONLINE_COLUMN");break;default:i=a.createColumn("TEXT")}return i},doDestroy:function(){this.unBindSyncCompleted(),this.updateConnectivityMonitor("stop"),this.callParent(),Ext.dom.GarbageCollector.collect()}}),c.defineGlobal(p.name,p),e.exports=p},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(5).SVMXObject,v={name:"com.servicemax.client.sfmdelivery.utils"},g=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};v.SFMUtils=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,null,[{key:"fadeIn",value:function(e){var t=setInterval(function(){n+=.2,f("#"+e).css("opacity",n<=1?n:1),n>=1&&clearInterval(t)},50),n=0}},{key:"fadeOut",value:function(e,t){var n=setInterval(function(){i-=.2,f("#"+e).css("opacity",i>=0?i:0),i<=0&&(clearInterval(n),t&&t())},50),i=1}},{key:"requiredFieldErrMessage",value:function(e){return g().T("FSA008_TAG127","Required field is blank:")+" "+e}},{key:"requiredFieldDescriptionMessage",value:function(e){return g().T("FSA008_TAG141","Required description field:")+" "+e}},{key:"invalidFieldErrMessage",value:function(e){return g().T("FSA008_TAG128","Invalid value in field:")+" "+e}},{key:"exceedsLengthFieldMessage",value:function(e){return g().T("FSA008_TAG120","Exceeds maximum length: ")+" "+e}},{key:"requiredFieldDescriptionWithAttachmentMessage",value:function(e){return g().T("FSA008_TAG142","Required attachment, description field: ")+" "+e}},{key:"prepareDataForDisplay",value:function(e,t){return"textarea"!=t&&"string"!=t||e&&(e=e.split("<").join("&lt;"),e=e.split(">").join("&gt;"),e=e.split('"').join("&quot;")),e}},{key:"prepareDataForEdit",value:function(e,t){return e}}]),t}(m),p.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(4),d=i(u),_=n(0).utils,h=n(5).SVMXObject,f={name:"com.servicemax.client.sfmopdocdelivery.constants"};f.Constants=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),t}(h),f.Constants.SAVE="Save",f.Constants.CANCEL="Cancel",f.Constants.IMAGENAMEID="ImageNameId",f.Constants.LOCALE="Locale",f.Constants.TYPE_DETAIL="Detail_Object",f.Constants.TYPE_HEADER="Header_Object",f.Constants.REF_FLD_TYP_2="RTYP2",f.Constants.REF_FLD_NAME_2="RFN2",f.Constants.REF_OBJ_NAME_2="ROBJ2",f.Constants.RLN_NAME_2="RLN2",f.Constants.REF_FLD_TYP="RTYP",f.Constants.REF_FLD_NAME="RFN",f.Constants.REF_OBJ_NAME="ROBJ",f.Constants.RLN_NAME="RLN",f.Constants.FLD_TYP="TYP",f.Constants.FLD_NAME="FN",f.Constants.OBJ_NAME="OBJ",f.Constants.ADDRESS="Address",f.Constants.USERNAME="UserName",f.Constants.NOW="Now",f.Constants.YESTERDAY="Yesterday",f.Constants.TOMORROW="Tomorrow",f.Constants.TODAY="Today",f.Constants.DOCUMENT_SPINNER="document_spinner",f.Constants.DOCUMENT_PAGE="document_page",f.Constants.DRAFT_DIV="draft_div",f.Constants.DRAFT="Generate Draft",f.Constants.FINALIZE_DIV="finalize_div",f.Constants.FINALIZE="Finalize",_.defineGlobal(f.name,f),e.exports=f},function(module,exports,__webpack_require__){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _typeof2=__webpack_require__(18),_typeof3=_interopRequireDefault(_typeof2),_getPrototypeOf=__webpack_require__(1),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(2),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(6),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(3),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(4),_inherits3=_interopRequireDefault(_inherits2),$=__webpack_require__(10),SVMX=__webpack_require__(0).utils,SVMXObject=__webpack_require__(5).SVMXObject,SFMOPDOCUtils=__webpack_require__(190).SFMOPDOCUtils,DatetimeUtil=__webpack_require__(12).DatetimeUtil,jseeImpl={name:"com.servicemax.client.sfmopdocdelivery.jsel"};jseeImpl.JSExpressionEngine=function(_SVMXObject){function _class(e){(0,_classCallCheck3.default)(this,_class);var t=(0,_possibleConstructorReturn3.default)(this,(_class.__proto__||(0,_getPrototypeOf2.default)(_class)).apply(this,arguments));return t.__interceptors={},t.__de=e,t}return(0,_inherits3.default)(_class,_SVMXObject),(0,_createClass3.default)(_class,[{key:"addInterceptor",value:function(e,t,n){this.__interceptors[e]={interceptor:t,context:n}}},{key:"initialize",value:function initialize(params){var me=this,props={},i=0,cr=params.contextRoots,l=cr.length;for(i=0;i<l;i++)window[cr[i]]={};this.addContext=function(e,t){var n=window[t];for(var i in e){var a=e[i];n[i]=a}},this.setProperty=function(e,t){props[e]=t},this.getProperty=function(e){return props[e]},this.isEntryCriteriaForSection=function(e){var t=!0;if(e.sectionDetail){t=!(e.sectionDetail[SVMX.OrgNamespace+"__Entry_Criteria__c"]||!1)}return t},this.filterSkippedSection=function(e,t){if(t){for(var n=SVMX.toObject(e),i=SVMX.toObject(t),a=i.page.header.sections,r=a.length,o=[],s=0;s<r;s++){var l=a[s];if(this.isEntryCriteriaForSection(l))if(l.fields.length>0){var c=SVMX.toObject(l.fields[0].fieldDetail[SVMX.OrgNamespace+"__QuestionInfoJSON__c"]);c.question&&c.question.questionID&&n.hasOwnProperty(c.question.questionID)&&o.push(l)}else o.push(l)}return i.page.header.sections=o,i}return SVMX.toObject(t)},this.getAttachmentIDFromQuestionID=function(e,t){var n=this.getProperty("allChecklistAttachment"),i=void 0;if(n){var a=n[t];if(a)for(var r=a.length,o=0;o<r;o++){var s=a[o];if(s[SVMX.OrgNamespace+"__SM_Internal_Question_ID__c"]===e){i=s;break}}}return i},this.getMediaContainer=function(e,t,n,i,a,r,o,s){var l=void 0;n&&(n=this.htmlEntities(n)),a&&(a=this.htmlEntities(a)),e&&(e=this.htmlEntities(e));var c='<tr><tr><td align="left" width="100%" border="1" style="word-break:break-word;word-wrap:break-word; border-bottom:1px solid #6e6e6e;">'+e+"</td></tr>";if(i){var u=!!window.opDocImg;if(void 0!==r)if(""===r||void 0===t||null===t)var d='<tr><td align="left" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+a+"</td></tr></tr>",_='<tr><td align="left" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+n+"</td></tr></tr>";else{r=SFMOPDOCUtils.getEncodedFileName(r);var h=t;s&&(h=s),l=u?"<img id="+o+' alt="'+a+'" attachmentId="'+h+'" onload="opDocImg('+o+')" class="opdoc-img" align="middle" hspace="10" vspace="10" style="max-width:100%" src="'+r+'" svmx-data="'+a+'">':'<img  align="middle" hspace="10" vspace="10" style="max-width:100%" src="'+r+'" svmx-data="'+a+'" attachmentId="'+h+'">';var d='<tr><td align="center" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+l+"</td></tr></tr>",_='<tr><td align="center" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+n+"</td></tr></tr>"}else{var f="";f=s?"/sfc/servlet.shepherd/version/download/"+s:"/servlet/servlet.FileDownload?file="+t,l=u?"<img id="+o+' alt="'+a+'" onload="opDocImg('+o+')" class="opdoc-img" align="middle" hspace="10" vspace="10" src="'+f+'">':'<img  align="middle" hspace="10" vspace="10" src="'+f+'">';var d='<tr><td align="center" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+l+"</td></tr></tr>",_='<tr><td align="center" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+n+"</td></tr></tr>"}}else var d='<tr><td align="left" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+a+"</td></tr></tr>",_='<tr><td align="left" width="100%" style="word-break:break-word;word-wrap:break-word; border:0pt solid black;">'+n+"</td></tr></tr>";return'<tr><td colspan="2"><table width="100%" border="0" cellpadding="0" cellspacing="0" style="table-layout:auto background-color:red">'+c+d+_+"</table></td></tr>"},this.htmlEntities=function(e){return!0===SVMX.getClient().getApplicationParameter("svmx_is_sanitizehtml_enabled")&&SVMX.sanitizeHTML&&(e=SVMX.sanitizeHTML(e)),e},this.getNonmediaContainer=function(e,t){return t&&(t=this.htmlEntities(t)),e&&(e=this.htmlEntities(e)),'<tr><td align="left" width="55%" style="word-break:break-word;word-wrap:break-word;">'+e+'</td><td align="left" width="45%" style="word-break:break-word;word-wrap:break-word;">'+t+"</td></tr>"},this.evalExpression=function(expr,params){function $MODIFY(e){return"Modified "+e}function $BOOL(e){return!!e}function $ISNULL(e){return!e}function $ADD(){var e=0,t=0,n=arguments.length;for(t=0;t<n;t++)e+=arguments[t];return e}function $INT(e){var t=parseInt(e);return isNaN(t)&&(t=0),t}function $FLOAT(e){var t=parseFloat(e);return isNaN(t)&&(t=0),t}function $TOUPPER(e){return e&&"object"===(void 0===e?"undefined":(0,_typeof3.default)(e))&&e.value?e.value.toUpperCase():e.toUpperCase()}function $IMAGE(e){return me.__interceptors.$IMAGE?me.__interceptors.$IMAGE.interceptor(e,params):"/servlet/servlet.FileDownload?file="+e}function $LOGO(){return me.__interceptors.$IMAGE?me.__interceptors.$IMAGE.interceptor("LOGO",params):"/servlet/servlet.FileDownload?file="+value}function $SIGNATURE(e,t,n,i,a){var r=$(me.__de.__rootNode).attr("id").replace(/-/g,"_"),o="handleOutputDocSignatureButtonClick"+r;SVMX[o]=function(e){var t=e.target,n=null,i=null,a=null,r=e.currentTarget&&e.currentTarget.nextElementSibling&&e.currentTarget.nextElementSibling.innerHTML;if(t){var o=$(e.target);if(n=o.attr("signature-name"),i=o.attr("imgHeight"),a=o.attr("imgWidth"),!i||!a){var s=o.find("img").length>0&&o.find("img")||o;i=s&&s.height()+"px",a=s&&s.width()+"px"}}var l=SVMX.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.CAPTURE_SIGNATURE",me.__de,{request:{handler:SVMX.proxy(me.__de,me.__de.__onCaptureSignature),processId:me.__de.getProcessId(),recordId:me.__de.getRecordId(),uniqueName:n,imgHeight:i,imgWidth:a,signatureTitle:r}});me.__de.getEventBus().triggerEvent(l),$("[signature-name]").css("pointer-events","none"),setTimeout(function(){$("[signature-name]").css("pointer-events","auto")},1e3)};var s="";if(null!=me.__de.__allowSignatures&&!0===me.__de.__allowSignatures&&(t=t&&null!=t&&t.length>0?t:e,e))if(me.__de.createSignatureButtons)s=me.__de.createSignatureButtons.handler.apply(me.__de.createSignatureButtons.context,[e,r,n,a,i,o,t]);else{var l="186px",c="350px";l=void 0!=a&&null!=a&&a.length>0?a+"px":l,c=void 0!=i&&null!=i&&i.length>0?i+"px":c,s="svmx-signature-start<div id='"+e+r+"'><button style='min-width:50px; height:40px;' signature-name='"+e+r+"' imgHeight='"+l+"' imgWidth='"+c+"' onclick='SVMX."+o+"(event);'>"+t+"</button></div>svmx-signature-end"}return void 0!==n&&"true"===n.toString().toLowerCase()&&me.__de.__signaturesPending.addItem(e+r,e+r),s}function $URL(e){}function $IF(e,t,n){return"string"==typeof e&&"false"==e&&(e=!1),e?t:n}function $SUMOF(e,t,n){var a=0,r="",o="";for(e.length>0&&(r=e[0].aliasName),void 0!==$M[r]&&null!=$M[r]&&void 0!==$M[r][t]&&null!==$M[r][t]&&void 0!==$M[r][t].dataType&&null!==$M[r][t].dataType&&(o=$M[r][t].dataType),i=0;i<e.length;i++){var s=e[i][t];"picklist"!==o&&"multipicklist"!==o||(s=e[i][t].value),a+=$FLOAT(s)}if(void 0!==$M[r]&&null!=$M[r]&&void 0!==$M[r][t]&&null!==$M[r][t]){var l=$M[r][t].scale;a=a.toFixed(l)}return a}function $FORMAT(){if(0==arguments.length)return"";for(var e=arguments[0],t=1;t<arguments.length;t++){var n=new RegExp("\\{"+(t-1)+"\\}","gi");e=e.replace(n,void 0!==arguments[t]&&null!==arguments[t]?arguments[t]:"")}return e}function $TODAY(){if(me.getProperty("Today"))return me.getProperty("Today")}function $TOMORROW(){if(me.getProperty("Tomorrow"))return me.getProperty("Tomorrow")}function $NOW(){if(me.getProperty("Now"))return me.getProperty("Now")}function $YESTERDAY(){if(me.getProperty("Yesterday"))return me.getProperty("Yesterday")}function $USERNAME(){if(me.getProperty("UserName"))return me.getProperty("UserName")}function $ADDRESS(){if(me.getProperty("Address"))return me.getProperty("Address")}function $LNUMBER(e,t){var n=parseFloat(e),i=e;if(!isNaN(n)){var a=me.getProperty("Locale");i=SFMOPDOCUtils.localeFormat(a,n,t)}return i}function $ROUND(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function $SNUMBER(e,t,n){var i=e.aliasName,n=parseInt(n),a=$D[i][t],r=parseFloat(a);return isNaN(r)?a:(void 0===n||null===n||isNaN(n)?void 0!==$M[i]&&null!=$M[i]&&void 0!==$M[i][t]&&null!==$M[i][t]&&(n=$M[i][t].scale,r=r.toFixed(n)):r=r.toFixed(n),r)}function $CHECKLIST(e,t,n){var i=void 0;i=!1===me.getProperty("includeSkippedSections")?me.filterSkippedSection(e,t):SVMX.toObject(t);for(var a=SVMX.toObject(e),r=i.page.header.sections.length,o=i.page.processTitle||i.processTitle,s='<table width="100%" border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed"><tr><th width="100%" style="background-color:#BDBDBD" align="left"><strong>'+me.__de.__getTagValue("SFM004_TAG009")+" "+o+"</strong></th></tr>",l=0;l<r;l++){var c=i.page.header.sections[l];if(c.fields&&c.fields.length>0){var u=""+c.sectionDetail[SVMX.OrgNamespace+"__Title__c"];u=me.htmlEntities(u),s+='<table width="100%" border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed"><tr><td width="100%" align="left" style="background-color:#6E6E6E;word-break:break-word;word-wrap:break-word;border: 1px solid black;"><strong style="color:#FFFFFF">'+me.__de.__getTagValue("SFM004_TAG010")+"-"+u+"</strong></td></tr></table>",s+='<tr><td style="word-break:break-word;word-wrap:break-word;"><table width="100%" border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed">',s+='<tr><th align="left" style="background-color:#D8D8D8"><strong>'+me.__de.__getTagValue("SFM004_TAG011")+'</strong></th><th align="left" width="45%" style="background-color:#D8D8D8"><strong>'+me.__de.__getTagValue("SFM004_TAG012")+"</strong></th></tr>",s+='</table></td></tr><table width="100%" border="1" cellpadding="0" cellspacing="0" style="table-layout:auto">';for(var d=c.fields.length,_=0;_<d;_++){var h=c.fields[_],f=SVMX.toObject(h.fieldDetail[SVMX.OrgNamespace+"__QuestionInfoJSON__c"]),p=a[f.question.questionID];p&&f.question.responseType&&("datetime"==f.question.responseType.toLowerCase()?(p=com.servicemax.client.lib.datetimeutils.DatetimeUtil.convertToTimezone(p,me.getProperty("userTimezoneOffset")),p=com.servicemax.client.lib.datetimeutils.DatetimeUtil.getFormattedDatetime(p,me.__de.__dateFormat+" "+me.__de.__timeFormat)):"date"==f.question.responseType.toLowerCase()&&(p=com.servicemax.client.lib.datetimeutils.DatetimeUtil.getFormattedDatetime(p,me.__de.__dateFormat))),p&&p instanceof Array?p=p.join(", "):p&&p instanceof Object?p=p.fieldvalue.value:void 0!==p&&null!==p||(p="");var m=f.question.ShowInSmartDoc;if("attachment"===f.question.responseType.toLowerCase()&&(!0===m||"string"==typeof m&&"true"===m.toLocaleLowerCase())){var v="",g="",y=!1,S=void 0,E=void 0,b=n+"_"+f.question.questionID,T=me.getAttachmentIDFromQuestionID(f.question.questionID,n);T&&(g=T[SVMX.OrgNamespace+"__SM_Attachment_Name__c"],T[SVMX.OrgNamespace+"__SM_File_Type__c"]&&"image"===T[SVMX.OrgNamespace+"__SM_File_Type__c"].toLowerCase()&&(y=!0,T[SVMX.OrgNamespace+"__SM_ContentDocumentLink_ID__c"]?E=T[SVMX.OrgNamespace+"__SM_ContentDocumentLink_ID__c"]:(v=T[SVMX.OrgNamespace+"__SM_Attachment_ID__c"],E=null)),S=T.filePath),s+=me.getMediaContainer(f.question.question,v,p,y,g,S,b,E)}else s+=me.getNonmediaContainer(f.question.question,p)}s+="</table>"}}return s+="</table>"}function $WORD_BREAK(e,t,n){if(null===e||void 0===e)return e;var i=function(e,t){return e.match(new RegExp(".{1,"+t+"}","g"))};null!==n&&void 0!==n||(n="");for(var a=[""],r=e.split(" "),o=0;o<r.length;o++){var s=r[o];if(s.length>t)for(var l=function(e,t,n){var a=[];if(t>=1){var r=i(e,t-1);if(r.length>=1){for(var o=0;o<r.length-1;o++){var s=r[o]+n;a.push(s)}a.push(r[r.length-1]+" ")}}return 0==a.length&&a.push(e),a}(s,t,n),c=0;c<l.length;c++)a.push(l[c]);else(function(e,t){return t?e.length+t.length:e.length})(a[a.length-1],s)>t&&a.push(""),a[a.length-1]=a[a.length-1]+s+" "}return a.length>1?a.join("\n"):a[0]}var $F={BOOL:$BOOL,ISNULL:$ISNULL,ADD:$ADD,INT:$INT,TOUPPER:$TOUPPER,IMAGE:$IMAGE,IF:$IF,SUMOF:$SUMOF,FORMAT:$FORMAT,TODAY:$TODAY,TOMORROW:$TOMORROW,YESTERDAY:$YESTERDAY,NOW:$NOW,USERNAME:$USERNAME,LOGO:$LOGO,ADDRESS:$ADDRESS,LNUMBER:$LNUMBER,ROUND:$ROUND,SIGNATURE:$SIGNATURE,SNUMBER:$SNUMBER,CHECKLIST:$CHECKLIST,WORD_BREAK:$WORD_BREAK};try{var result=eval(expr);return result&&"object"===(void 0===result?"undefined":(0,_typeof3.default)(result))&&(void 0!==result.label&&null!==result.label&&void 0!==result.value&&null!==result.value?result=result.value:result.Id&&(result=result.Id)),result}catch(e){return""}}}}]),_class}(SVMXObject),SVMX.defineGlobal(jseeImpl.name,jseeImpl),module.exports=jseeImpl},function(e,t,n){var i=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=n(22).View,s=n(7).Cache,l=(n(89).ConnectionUtil,{name:"com.servicemax.client.mobileinventory.ui.largemodern.api"}),c=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},u=o,d=r.getLoggingService().getLogger("MobileInventory-UI"),_=l.name,h=s;l.KeyValueStore=Ext.define(_+".KeyValueStore",{extend:"com.servicemax.client.ui.components.modern.data.SVMXStore",alias:"widget.mobileinventorysearch.keyvaluestore",constructor:function(e){this.callParent(arguments)},fields:["opLabel","opValue"]}),l.View=Ext.define(_+".MobileInventoryContainer",{extend:u,alias:"widget.mobileinventory.mobileinventorycontainer",trunkStockItemsContainer:null,catalogItemsContainer:null,mobileInventoryTabButtons:null,__grid:null,activeTab:"trunkstock",mystockObject:null,catalogObject:null,utilsObject:null,__syncManager:null,__isConnected:null,updateOptions:function(e){this.activeTab="trunkstock",!e.activeTab||"trunkstock"!==e.activeTab&&"catalog"!==e.activeTab||(this.activeTab=e.activeTab),this.__getSyncManager(),this.__bindSyncCompletedEvent(),this.__bindUpdateStockEvent(),this.__bindConnectivityChangedEvent(),this.__buildHeaderTabButtons(this.activeTab),this.__isConnected=!1,this.__syncManager&&(this.__isConnected=this.__syncManager.__lastConnectionStatus)},__connectionHandler:function(e){this.__isConnected=e.data.isConnected},__refreshViewsOnSyncCompletedEvent:function(e){var t=e.target.__syncType;"ONECALLSYNC"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t||(this.refreshView(),d.info("Refreshing Parts View ID:"+this.id))},__bindSyncCompletedEvent:function(){this.__syncManager&&(d.info("BIND Refresh ::for View Id: "+this.id),this.bind(this.__syncManager,"SYNC_COMPLETED",this.__refreshViewsOnSyncCompletedEvent,this))},__unBindSyncCompletedEvent:function(){this.__syncManager&&(d.info("UNBIND Refresh ::for View Id: "+this.id),this.unbind(this.__syncManager,"SYNC_COMPLETED",this.__refreshViewsOnSyncCompletedEvent,this))},__bindUpdateStockEvent:function(){this.__syncManager&&(d.info("BIND UpdateStock ::for View Id: "+this.id),this.bind(this.__syncManager,"UPDATE_STOCK",this.refreshView,this))},__unBindUpdateStockEvent:function(){this.__syncManager&&(d.info("UNBIND Refresh ::for View Id: "+this.id),this.unbind(this.__syncManager,"UPDATE_STOCK",this.refreshView,this))},__bindConnectivityChangedEvent:function(){this.__syncManager&&this.bind(this.__syncManager,"CONNECTIVITY_CHANGED",this.__connectionHandler,this)},__unBindConnectivityChangedEvent:function(){this.__syncManager&&this.unbind(this.__syncManager,"CONNECTIVITY_CHANGED",this.__connectionHandler,this)},__getSyncManager:function(){var e=r.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");return this.__syncManager=e.getInstance(),this.__syncManager},refreshView:function(){var e=this;if(!e.__isInventoryConfigDataAvailable())return void e.__showInlineErrorLabels();e.__removeInlineErrorLabels(),e.refreshViewGrid()},refreshViewGrid:function(){var e=this;h.readObjectFromDBCache("INVENTORY_TRUNK_STOCK_SEARCH_INFO").then(r.proxy(this,function(t){e.mystockObject.performTrunkStockSearch(t)}))},onShow:function(){d.info("MobileInventoryContainer View showing"),this.__getSyncManager(),this.__bindSyncCompletedEvent(),this.__bindUpdateStockEvent(),this.__bindConnectivityChangedEvent(),this.activeTab&&this.__buildHeaderTabButtons(this.activeTab),this.callParent()},onHide:function(){d.info("MobileInventoryContainer View hiding");var e=this;if(this.__unBindSyncCompletedEvent(),this.__unBindUpdateStockEvent(),this.__unBindConnectivityChangedEvent(),this.mystockObject){var t=this.mystockObject.getTrunkStockSearchCriteriaInfo();t&&e.__saveSearchCriteriaInfo(t)}this.callParent()},__saveSearchCriteriaInfo:function(e){this.utilsObject.storeStateInCache("INVENTORY_TRUNK_STOCK_SEARCH_INFO",e)},ready:function(){var e=this;e.__setupHomeview(),e.add(e.__getMainContainerItems())[0],e.__refreshViewsOnActiveTab()},__setupHomeview:function(){var e=this;e.maximumLocalRecordsToQuery=2e3,e.mystockObject=r.create("com.servicemax.client.mobileinventory.ui.largemodern.mystock.MyStock",{deliveryEngine:e.getDeliveryEngine(),context:this}),e.catalogObject=r.create("com.servicemax.client.mobileinventory.ui.largemodern.catalog.Catalog",{deliveryEngine:e.getDeliveryEngine(),context:this}),e.utilsObject=r.create("com.servicemax.client.mobileinventory.ui.largemodern.utils.Utils",{}),e.__createOperatorStoreForMobileInventorySearch(),e.setViewInfo({backText:c().T("FSA018_TAG004","Parts"),hideContextMenu:!0}),e.__buildHeaderTabButtons(e.activeTab)},__refreshViewsOnActiveTab:function(){var e=this;e.trunkStockItemsContainer=e.down("#trunkStockContainer"),e.catalogItemsContainer=e.down("#catalogContainer"),e.mobileInventoryTabButtons=e.parent.down("#mobileInventoryTabButtons"),"trunkstock"===e.activeTab?e.__showTrunkStockViews():"catalog"===e.activeTab&&e.__showCatalogViews(),this.__isInventoryConfigDataAvailable()?(e.__removeInlineErrorLabels(),e.mystockObject.performTrunkStockSearch(e.getDeliveryEngine().getTrunkStockCacheSearchInfo()),e.catalogObject.loadGrid()):e.__showInlineErrorLabels()},__isInventoryConfigDataAvailable:function(){return!!(0,a.default)(this.getDeliveryEngine().getMetaModel()).length>0},__showInlineErrorLabels:function(){var e=this.down("#trunkStockContainer"),t=this.down("#catalogContainer"),n=this.down("#MyStocKErrorLabel"),i=this.down("#CatalogErrorLabel"),a=c().T("FSA018_TAG012","Please contact your ServiceMax administrator to access Stock details and Spare Parts Catalog.");e&&!n&&e.add(this.__getErrorLabelItem(a,"mobileinventory-mystock-error-label","MyStocKErrorLabel")),t&&!i&&t.add(this.__getErrorLabelItem(a,"mobileinventory-mystock-error-label","CatalogErrorLabel"))},__getErrorLabelItem:function(e,t,n){return{xtype:"svmx.label",text:e,cls:t,itemId:n,style:"text-align:center;"}},__removeInlineErrorLabels:function(){var e=this.down("#MyStocKErrorLabel"),t=this.down("#CatalogErrorLabel");e&&e.destroy(),t&&t.destroy()},__getMainContainerItems:function(){var e=this;return{xtype:"svmx.verticalpanel",width:"100%",height:"100%",cls:"mobileInventory-container",ui:"svmx-default",scrollable:"y",items:[e.__getSearchBarConfig("TrunkStock",e.__searchTapHandler,e),e.__getSearchBarConfig("Catalog",e.__searchTapHandler,e),{xtype:"svmx.panel",cls:"sfmsearch-search-results-container trunkstock-container",ui:"svmx-default",itemId:"trunkStockContainer"},{xtype:"svmx.panel",cls:"sfmsearch-search-results-container catalog-container",ui:"svmx-default",hidden:!0,itemId:"catalogContainer"}]}},__showTrunkStockViews:function(){var e=this;e.__showOrHideSelectedTabSearchBar("TrunkStock",!0),e.__showOrHideSelectedTabSearchBar("Catalog",!1),e.trunkStockItemsContainer&&e.trunkStockItemsContainer.show(),e.catalogItemsContainer&&e.catalogItemsContainer.hide();var t=e.parent.down("#mobileInventoryTabButtons");t&&t.setValue(0);var n=e.down("#trunkstock");n&&n._store&&e.showOrHidePaginationBottomBar()},__showCatalogViews:function(){var e=this;e.__showOrHideSelectedTabSearchBar("Catalog",!0),e.__showOrHideSelectedTabSearchBar("TrunkStock",!1),e.catalogItemsContainer&&e.catalogItemsContainer.show(),e.trunkStockItemsContainer&&e.trunkStockItemsContainer.hide();var t=e.parent.down("#mobileInventoryTabButtons");t&&t.setValue(1);var n=e.down("#catalog");n&&n._store&&e.showOrHidePaginationBottomBar()},showOrHidePaginationBottomBar:function(){var e=this,t=e.down("#trunkstockPagingToolBar"),n=e.down("#catalogPagingToolBar"),i=e.down("#trunkstock"),a=e.down("#catalog");"trunkstock"===e.activeTab?(n&&n.setHidden(!0),i&&i.getStore&&i.getStore()&&i.getStore().totalCount>=100?t&&t.setHidden(!1):t&&t.setHidden(!0)):(t&&t.setHidden(!0),a&&a.getStore&&a.getStore()&&a.getStore().totalCount>=100?n&&n.setHidden(!1):n&&n.setHidden(!0))},__createOperatorStoreForMobileInventorySearch:function(){Ext.StoreManager.lookup("mobileInventoryOperatorStore")||Ext.create(_+".KeyValueStore",{storeId:"mobileInventoryOperatorStore",data:[{opValue:"Contains",opLabel:c().T("FSA004_TAG024","Contains")},{opValue:"Starts With",opLabel:c().T("FSA004_TAG025","Starts With")},{opValue:"Ends With",opLabel:c().T("FSA004_TAG026","Ends With")},{opValue:"Exact Match",opLabel:c().T("FSA004_TAG012","Exactly")}]})},__getSearchBarConfig:function(e,t,n){return{xtype:"panel",layout:"hbox",docked:"top",hidden:!0,itemId:"searchBar"+e,cls:"sfmsearch-search-bar",items:[{xtype:"svmx.field.picklist",itemId:"mobileInventoryoperator",ui:"svmx-default",cls:"x-field-select sfmsearch-operator-picklist",inputCls:"mobileInventory-picklist",value:c().T("FSA004_TAG024","Contains"),store:"mobileInventoryOperatorStore",queryMode:"local",flex:.27,displayField:"opLabel",valueField:"opValue",listeners:{change:function(){}}},{xtype:"svmx.field.search",itemId:"mobileInventorykeyWord",ui:"svmx-default",cls:"mobileInventory-search-field",flex:1,minWidth:70,disabled:!1,placeHolder:c().T("FSA004_TAG008","Search term"),name:"keyWord",listeners:{change:function(){}},enableSearch:!0,searchAction:t,enableBarcode:r.getClient().isBarCodeEnabled(),alwaysShowBarcode:!0,barcodeHandler:function(e,n){t()}},{xtype:"button",itemId:"mobileInventorysearchButton",ui:"svmx-default",cls:"mobileInventory-search-button",text:c().T("FSA004_TAG011","Search"),height:30,minWidth:76,activeTab:e,parentContext:n,listeners:{tap:t}}]}},__searchTapHandler:function(e,t,n){var i=this;if(!i.parentContext.__isInventoryConfigDataAvailable())return void i.parentContext.__showInlineErrorLabels();if(i.parentContext.__removeInlineErrorLabels(),"TrunkStock"===i.activeTab)i.parentContext.mystockObject.performTrunkStockSearch();else if("Catalog"===i.activeTab){var a="",r="Contains",o=i.parentContext.down("#searchBarCatalog"),s=i.parentContext.maximumLocalRecordsToQuery;o&&(r=o.getComponent("mobileInventoryoperator").getValue(),a=o.getComponent("mobileInventorykeyWord").getValue()||""),i.parentContext.catalogObject.performCatalogSearch({operator:r,keyWord:a,recordLimit:s})}},__showOrHideSelectedTabSearchBar:function(e,t){var n=this,i="#searchBar"+e,a=n.down(i);a&&(t?a.show():a.hide())},__buildHeaderTabButtons:function(e){var t=this,n=t.parent.down("#mobileInventoryTabButtons");n||(e||(e="trunkstock"),t.setViewInfo({centerItem:t.__getCenterItem(e)}),t.mobileInventoryTabButtons=n)},updateStateConfig:function(e){return e.centerItem=this.__getCenterItem(this.activeTab),e},__getCenterItem:function(e){var t=this;return{xtype:"svmx.buttonset",itemId:"mobileInventoryTabButtons",cls:"mobileInventory-nav-selector",height:29,allowMultiple:!1,items:[{text:c().T("FSA018_TAG001","My Stock"),cls:"mobileInventory-nav-selector-button",flex:1,minWidth:115,itemId:"trunkStockTabButton",pressed:"trunkstock"===e,handler:function(){t.__switchTo("trunkstock",this)}},{text:c().T("FSA018_TAG002","Catalog"),itemId:"catalogTabButton",cls:"mobileInventory-nav-selector-button",flex:1,minWidth:115,pressed:"catalog"===e,handler:function(){this.pressed=!0,t.__switchTo("catalog",this)}}]}},__switchTo:function(e,t){var n=this;switch(e){case"trunkstock":n.__setActiveTabButton(0,t),n.activeTab=e,n.__showTrunkStockViews();break;case"catalog":n.__setActiveTabButton(1,t),n.activeTab=e,n.__showCatalogViews()}},__setActiveTabButton:function(e,t){var n=this;if(n.mobileInventoryTabButtons&&t)try{n.mobileInventoryTabButtons&&(n.mobileInventoryTabButtons.setPressedButtons([t]),n.mobileInventoryTabButtons.setValue(e))}catch(e){}},doDestroy:function(){this.__unBindSyncCompletedEvent(),this.__unBindUpdateStockEvent(),this.__unBindConnectivityChangedEvent(),this.mystockObject&&(this.mystockObject.doCleanup(),this.mystockObject=null),this.catalogObject&&(this.catalogObject.doCleanup(),this.catalogObject=null),this.utilsObject&&(this.utilsObject.doCleanup(),this.utilsObject=null),this.getDeliveryEngine().doCleanup(),this.trunkStockItemsContainer&&(this.trunkStockItemsContainer.removeAll(),this.trunkStockItemsContainer.destroy(),this.trunkStockItemsContainer=null),this.catalogItemsContainer&&(this.catalogItemsContainer.removeAll(),this.catalogItemsContainer.destroy(),this.catalogItemsContainer=null),this.mobileInventoryTabButtons&&(this.mobileInventoryTabButtons.destroy(),this.mobileInventoryTabButtons=null),Ext.dom.GarbageCollector.collect(),this.callParent()}}),r.defineGlobal(l.name,l),e.exports=l},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(7).Cache,g=n(5).SVMXObject,y={name:"com.servicemax.client.mobileinventory.ui.largemodern.utils"},S=function(){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},E=v;y.Utils=function(e){function t(e){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,c.default)(t,[{key:"getQuantityColumn",value:function(e){var t=m.getCustomFieldName("Available_Qty"),n={dataType:"TEXT",displayLabel:S().T("FSA018_TAG003","Quantity"),sequence:e,fieldName:t};return this.createListViewColumnDefinition(n,{text:S().T("FSA018_TAG003","Quantity"),dataIndex:t,flex:1,align:"right",sortable:!0})}},{key:"getInStockColumn",value:function(e){var t=m.getCustomFieldName("Available_Qty"),n={dataType:"TEXT",displayLabel:S().T("FSA018_TAG034","In Stock"),sequence:e,fieldName:t},i=this.createListViewColumnDefinition(n,{text:S().T("FSA018_TAG034","In Stock"),dataIndex:t,flex:1,align:"right",sortable:!0});return i.renderer=function(e,t,n,i,a){return"0"===e?'<span style="color:#FE3824;font-weight:600;">'+e+"</span>":e},i}},{key:"getFieldType",value:function(e){return"datetime"==e.dataType?"date":"string"}},{key:"createListViewColumnDefinition",value:function(e,t,n,i){var a=null;void 0===i&&(i=!0);var r=Ext.create("mobileinventory.columnfactory",{fld:e,uiConfig:t,index:n,shouldCreateExpander:i});switch(e.dataType){case"TEMPLATE":a=r.createColumn("TEMPLATE");break;case"DATETIME":a=r.createColumn("DATETIME");break;case"DATE":a=r.createColumn("DATE");break;case"CUSTOMTEXT":a=r.createColumn("CUSTOMTEXT");break;default:a=r.createColumn("TEXT")}return a}},{key:"storeStateInCache",value:function(e,t){E.writeObjectToDBCache(e,t)}},{key:"doCleanup",value:function(){return(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){var i=n(0).utils,a=n(191),r=n(192),o=n(105),s={appVersion:"1.0.0.0"},l=i.getClient().getApplicationParameter("org-name-space"),c=i.getClient().getApplicationParameter("server-min-version");s.parseHash=function(){var e={};if(window.location.hash){var t=window.location.hash.substr(1),n=t.split("&");for(var i in n){var a=n[i].split("=");e[a[0]]=unescape(a[1])}}return e},s.checkConnection=function(){var e=!0,t=navigator.connection.type;return"unknown"!==t&&"none"!==t||(e=!1),e},s.__createConnectionTable=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"CREATE TABLE IF NOT EXISTS svmxo_Connection (Connection_Id integer primary key, Login_Url VARCHAR UNIQUE, Instance_Url VARCHAR, Refresh_Token VARCHAR, Access_Token VARCHAR, User_Info_Url VARCHAR, Env_Default VARCHAR, Env_Tag VARCHAR);",onSuccess:e.onSuccess,onError:e.onError})},s.__createClientCacheTable=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"CREATE TABLE IF NOT EXISTS ClientCache ( key VARCHAR UNIQUE, value VARCHAR);",onSuccess:e.onSuccess,onError:e.onError})},s.__createUserTable=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"CREATE TABLE IF NOT EXISTS svmxo_User (User_Id integer primary key, User_Name VARCHAR, Language VARCHAR, Is_Sync_On_Login INTEGER, Timezone VARCHAR, Locale VARCHAR, SFUserId VARCHAR);",onSuccess:e.onSuccess,onError:e.onError})},s.createDatabase=function(e){function t(){s.__createUserTable({context:n,onSuccess:e.onSuccess,onError:e.onError})}e=e||{};var n=e.context||window;s.__createConnectionTable({context:n,onSuccess:t,onError:e.onError}),s.__createClientCacheTable({context:n,onSuccess:function(){},onError:function(){}})},s.getExistingRefreshToken=function(e){function t(t){var i={refresh_token:null,access_token:null,instance_url:null,login_url:null,user_info_url:null};t&&t.rows.length>0&&(i.refresh_token=t.rows.item(0).Refresh_Token,i.access_token=t.rows.item(0).Access_Token,i.instance_url=t.rows.item(0).Instance_Url,i.login_url=t.rows.item(0).Login_Url,i.user_info_url=t.rows.item(0).User_Info_Url),e.onSuccess&&e.onSuccess.call(n,i)}e=e||{};var n=e.context||window,i=e.loginUrl||"";a.query({context:n,query:"SELECT Login_Url, Instance_Url, Refresh_Token, Access_Token, User_Info_Url FROM svmxo_Connection WHERE Login_Url = '"+i+"'",onSuccess:t,onError:e.onError})},s.getSessionIdFromRefreshToken=function(e){e=e||{};var t=e.context||window,n="grant_type=refresh_token&client_id="+escape(e.clientId)+"&refresh_token="+escape(e.refreshToken)+"&immediate=true&format=json";r.sendRequest({context:t,type:"POST",uri:e.loginUrl+"/services/oauth2/token?"+n,data:"",timeout:3e4,headers:[{HEADER:"Content-Type",VALUE:"application/json"}],onSuccess:function(n,i,a){e.onSuccess&&e.onSuccess.call(t,JSON.parse(n))},onError:function(n,i){e.onError&&e.onError.call(t,n,i)}})},s.insertNewRefreshToken=function(e){function t(t){t=t?JSON.parse(t):{envTag:"FSA015_TAG017",envDefault:"Production"},t.envTag=t.envTag||"FSA015_TAG017",t.envTagDefault=t.envDefault||"Production",a.query({context:n,query:"INSERT OR REPLACE INTO svmxo_Connection (Login_Url, Instance_Url, Refresh_Token, Access_Token, User_Info_Url, Env_Default, Env_Tag) VALUES ('"+e.loginUrl+"', '"+e.instanceUrl+"', '"+e.refreshToken+"', '"+e.accessToken+"',  '"+e.userInfoUrl+"', '"+t.envTagDefault+"', '"+t.envTag+"');",onSuccess:e.onSuccess,onError:e.onError})}e=e||{};var n=e.context||window;o.getEnv(t,t)},s.updateRefreshToken=function(e){function t(t){t=t?JSON.parse(t):{envTag:"FSA015_TAG017",envDefault:"Production"},a.query({context:n,query:"UPDATE svmxo_Connection  SET Login_Url = '"+e.loginUrl+"', Instance_Url = '"+e.instanceUrl+"', Refresh_Token = '"+e.refreshToken+"', Access_Token = '"+e.accessToken+"', User_Info_Url = '"+e.userInfoUrl+"' WHERE Login_Url = '"+e.loginUrl+"';",onSuccess:e.onSuccess,onError:e.onError})}e=e||{};var n=e.context||window;o.getEnv(t,t)},s.deleteRefreshToken=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"DELETE FROM svmxo_Connection;",onSuccess:e.onSuccess,onError:e.onError})},s.deleteUserInfo=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"DELETE FROM svmxo_User;",onSuccess:e.onSuccess,onError:e.onError})},s.deleteCache=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"DELETE FROM ClientCache;",onSuccess:e.onSuccess,onError:e.onError})},s.deleteUserInfoCache=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"DELETE FROM ClientCache WHERE key = 'USER_INFO';",onSuccess:e.onSuccess,onError:e.onError})},s.deleteConflicts=function(e){e=e||{};var t=e.context||window;a.query({context:t,query:"DELETE FROM ClientSyncConflict;",onSuccess:e.onSuccess,onError:e.onError})},s.insertUserInfo=function(e){e=e||{};var t=e.context||window,n="Insert into svmxo_User (User_Name,Language,Is_Sync_On_Login,TimeZone,Locale,SFUserId) Values ('{{UserName}}','English','{{IsSyncOnLogin}}','{{TimeZone}}','{{Locale}}','{{SFUserId}}');";n=n.replace("{{UserName}}",e.UserName.replace("'","''")),n=n.replace("{{IsSyncOnLogin}}",e.IsSyncOnLogin),n=n.replace("{{TimeZone}}",e.TimeZone),n=n.replace("{{Locale}}",e.Locale),n=n.replace("{{SFUserId}}",e.SFUserId),a.query({context:t,query:n,onSuccess:e.onSuccess,onError:e.onError})},s.signOut=function(e){function t(){s.deleteRefreshToken({onSuccess:n,onError:n,context:u}),s.deleteUserInfo({onSuccess:n,onError:n,context:u})}function n(){2==++d&&l({refresh_token:h})}function i(e){_=e,s.getExistingRefreshToken({loginUrl:e,onSuccess:a,onError:c,context:u})}function a(e){e=e||{},e.refresh_token&&(h=e.refresh_token),t()}function l(t){if(t=t||{},t.refresh_token){var n=_+"/services/oauth2/revoke?token="+escape(t.refresh_token),i={uri:n,type:"GET",headers:[{Header:"Authorization",Value:"OAuth "+e.sessionId}],context:u,timeout:3e4,onSuccess:c,onError:c};r.sendRequest(i)}else c.call()}function c(){o.signOut()}e=e||{};var u=e.context||window,d=0,_="",h="";o.getLoginUrl(i,c)},s.getUserInfo=function(e){function t(t){a.query({context:r,query:l,onSuccess:function(t){t.rows.length>0?(o.UserName=t.rows.item(0).User_Name,o.Language=t.rows.item(0).Language,o.IsSyncOnLogin=t.rows.item(0).Is_Sync_On_Login,o.TimeZone=t.rows.item(0).TimeZone,o.Locale=t.rows.item(0).Locale,o.SFUserId=t.rows.item(0).SFUserId,i()):(t={IsSuccessful:!0,Result:o},e.onSuccess&&e.onSuccess(t))},onError:function(t){var n={IsSuccessful:!1,ResultAsString:t};e.onError&&e.onError(n)}})}function n(e,t,n){for(e=e||"",n=n||"0";e.length<t;)e=n+e;return e}function i(){navigator.globalization.getDatePattern(function(t){var i=(t.pattern,t.timezone),a=-1*(new Date).getTimezoneOffset(),r=parseInt(Math.abs(a)/60),s=parseInt(Math.abs(a)%60),l=n(""+r,2,"0")+":"+n(s,"2","0");l=a<0?"-"+l:"+"+l,o.TimeZoneOffSet=l,o.TimeZone=i;var c={IsSuccessful:!0,Result:o};e.onSuccess&&e.onSuccess(c)},function(){var t={IsSuccessful:!1,ResultAsString:"Unable to determine TimeZone"};e.onError&&e.onError(t)},{formatLength:"short",selector:"date and time"})}e=e||{};var r=e.context||window,o={};o.AppVersion=s.appVersion,o.EnvDefault="N/A",o.EnvTag="NA";var l="SELECT User_Name,Language,Is_Sync_On_Login,TimeZone,Locale,SFUserId FROM svmxo_User;";a.query({context:r,query:"SELECT Env_Default, Env_Tag FROM svmxo_Connection;",onSuccess:function(e){e.rows.length>0&&(o.EnvDefault=e.rows.item(0).Env_Default,o.EnvTag=e.rows.item(0).Env_Tag),t()},onError:function(e){t()}})},s.checkVersion=function(e){function t(t,n,r){var o=!1,s=JSON.parse(t),l=i(c,"1660000"),u=0;s.length>0&&s[0].value&&(u=i(s[0].value,0)),o=u>=l,e.callback.call(a,o)}function n(t,n,i){e.callback.call(a,!1)}function i(e,t){var n=t,i=e?e.replace(".",""):"";return i&&!isNaN(i)&&(n=parseInt(i)),n}e=e||{};var a=e.context||window,o=e.instanceUrl+"/services/apexrest/"+e.nameSpace+"/svmx/MobServiceIntf/getSVMXVersion",s={uri:o,type:"POST",headers:[{Header:"Authorization",Value:"OAuth "+e.sessionId}],context:a,data:"[]",timeout:3e4,onSuccess:t,onError:n};r.sendRequest(s)},s.getSFGroupProfile=function(e){function t(t,n,a){e.callback&&e.callback.call(i,t)}function n(t,n,a){e.callback&&e.callback.call(i,t)}e=e||{};var i=e.context||window,a=e.instanceUrl+"/services/apexrest/"+e.nameSpace+"/svmx/MobServiceIntf/MetaSyncRequest",o={uri:a,type:"POST",headers:[{Header:"Authorization",Value:"OAuth "+e.sessionId}],context:i,timeout:3e4,data:'{"eventType":"GROUP_PROFILE","eventName":"VALIDATE_PROFILE","values":[]}',onSuccess:t,onError:n};r.sendRequest(o)},s.getSFUserProfile=function(e){function t(t,n,a){e.callback&&e.callback.call(i,t)}function n(t,n,a){e.callback&&e.callback.call(i,t)}e=e||{};var i=e.context||window,a=e.instanceUrl+"/services/data/v20.0/sobjects/user/"+e.userId+"/?",o={uri:a,type:"GET",headers:[{Header:"Authorization",Value:"OAuth "+e.sessionId}],context:i,timeout:3e4,onSuccess:t,onError:n};r.sendRequest(o)},s.getSessionId=function(e){function t(){s.checkConnection()&&A?(o.showMenu(function(){var e=x+"/services/oauth2/authorize?display=touch&response_type=token&client_id="+escape(R)+"&redirect_uri="+escape(O);window.location=e}),e.onError&&e.onError.call(M,null)):e.onShowSplash.call(M,D)}function n(e){function t(){i.call(M,e)}var n={context:M,loginUrl:x,instanceUrl:e.instance_url,refreshToken:L,accessToken:e.access_token,userInfoUrl:e.id,onSuccess:t,onError:t};s.updateRefreshToken(n)}function i(t){var n={access_token:t.access_token,instance_url:t.instance_url,user_info_url:t.id,client_id:R,login_url:x,refresh_token:L,analytics:w};e.onSuccess&&e.onSuccess.call(M,n)}function u(a){a&&a.refresh_token?(N=a.user_info_url,L=a.refresh_token,s.checkConnection()?s.getSessionIdFromRefreshToken({context:M,loginUrl:x,clientId:R,refreshToken:a.refresh_token,onSuccess:n,onError:t}):a.access_token?i({access_token:a.access_token,instance_url:a.instance_url,user_info_url:a.user_info_url}):(A=null,t.call(M,e))):t.call(M,e)}function d(){var e=function(e){var t=JSON.parse(e);F=t.user_id,P=t.organization_id,q=t.username,V=t.email,B=t.display_name,j=t.timezone,H=t.language,z=t.locale,U=t.utcOffset,_()},t={uri:N,type:"GET",headers:[{Header:"Authorization",Value:"OAuth "+C}],context:M,timeout:3e4,onSuccess:e,onError:e};r.sendRequest(t)}function _(){var e={instanceUrl:k,sessionId:C,nameSpace:l,callback:h,context:M};s.getSFGroupProfile(e)}function h(e){var t=null,n=!1,i="Profile : Your Salesforce Profile is not associated with any active ServiceMax Group Profile. Please contact your ServiceMax administrator to resolve this.";try{t=JSON.parse(e),a.query({context:M,query:"INSERT OR REPLACE INTO ClientCache VALUES('VALIDATE_PROFILE_RESULT','"+e+"')",onSuccess:function(){},onError:function(){}})}catch(t){n=!0,i=e}if(!(W=t&&t.values&&t.values.length>0?t.values[0]:null)||n){if(t&&t.errors&&t.errors.length>0&&t.errors[0].errorTitle)i=t.errors[0].errorTitle;else if(t&&t instanceof Array&&t.length>0&&t[0].errorCode&&t[0].message)i=t[0].errorCode+" : "+t[0].message;else if(t&&t instanceof Object&&t.error){var r=JSON.parse(t.error);if(r instanceof Array)for(var o=r.length-1;o>=0;o--){var l=r[o];if(l.message){i=l.message;break}}}return alert(i),void s.signOut({})}navigator.globalization.getLocaleName(function(e){z=e.value,f()},function(){f()})}function f(e){navigator.globalization.getDatePattern(function(e){Y=e.pattern,j=e.timezone,p()},function(){p()},{formatLength:"short",selector:"date and time"})}function p(){var e={instanceUrl:k,sessionId:C,userId:F,callback:m,context:M};s.getSFUserProfile(e)}function m(){var e={context:M,instanceUrl:k,sessionId:C,nameSpace:l,callback:v};s.checkVersion(e)}function v(e){e?g.call(M):(alert("This ServiceMax application version requires the following ServiceMax server version or above:\n\nServiceMax Version: "+c),s.signOut({}))}function g(){var e={onSuccess:y,onError:y};s.deleteUserInfo(e)}function y(){var e={UserName:q,IsSyncOnLogin:0,TimeZone:j,Locale:z.replace("_","-"),SFUserId:F,onSuccess:S,onError:function(){T.call(M,"Unable to save user credentials.")}};s.insertUserInfo(e)}function S(){var e={onSuccess:E,onError:E};s.deleteRefreshToken(e)}function E(){s.insertNewRefreshToken({context:M,loginUrl:x,instanceUrl:k,refreshToken:L,accessToken:C,userInfoUrl:N,onSuccess:b,onError:function(){T.call(M,"Unable to save user connection information.")}})}function b(t){var n={access_token:C,instance_url:k,id:k,client_id:R,login_url:x,user_info_url:N,refresh_token:L,analytics:w};e.onSuccess&&e.onSuccess.call(M,n)}function T(t){e.onError&&e.onError.call(M,t)}e=e||{};var M=e.context||window,I=e.oAuthState||{},C=I.access_token,A=I.no_splash,D=!!e.networkStatus,x=I.login_url,R=I.client_key,O=I.callback_url||"SVMX:///",L=I.refresh_token,k=I.instance_url,N=I.id,w=I.analytics,F=void 0,P=void 0,q=void 0,V=void 0,B=void 0,j=void 0,H=void 0,z=void 0,U=void 0,Y=void 0,W=void 0;C||L?C&&L?d.call(M):C&&!L?d.call(M):e.onError&&e.onError.call(M,"Unexpected path."):function(e){function t(t){t&&t.rows&&"1"===t.rows.item(0).count?(s.deleteCache(e),s.signOut({})):s.getExistingRefreshToken({context:M,loginUrl:x,onError:u,onSuccess:u})}a.query({context:M,query:"SELECT COUNT(*) as count FROM ClientCache where key = 'USER_INFO' or key = 'LAST_SYNC_TIME';",onSuccess:t,onError:t})}(e)},e.exports=s},function(e,t,n){n(424),e.exports=n(626)},function(e,t,n){"use strict";(function(e){function t(e,t,n){e[t]||Object[i](e,t,{writable:!0,configurable:!0,value:n})}if(n(425),n(622),n(623),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var i="defineProperty";t(String.prototype,"padLeft","".padStart),t(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&t(Array,e,Function.call.bind([][e]))})}).call(t,n(132))},function(e,t,n){n(426),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(506),n(507),n(509),n(510),n(511),n(512),n(513),n(514),n(515),n(517),n(518),n(519),n(520),n(521),n(522),n(523),n(524),n(525),n(526),n(527),n(528),n(529),n(153),n(530),n(213),n(531),n(214),n(532),n(533),n(534),n(535),n(536),n(217),n(219),n(220),n(537),n(538),n(539),n(540),n(541),n(542),n(543),n(544),n(545),n(546),n(547),n(548),n(549),n(550),n(551),n(552),n(553),n(554),n(555),n(556),n(557),n(558),n(559),n(560),n(561),n(562),n(563),n(564),n(565),n(566),n(567),n(568),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(576),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(586),n(587),n(588),n(589),n(590),n(591),n(592),n(593),n(594),n(595),n(596),n(597),n(598),n(599),n(600),n(601),n(602),n(603),n(604),n(605),n(606),n(607),n(608),n(609),n(610),n(611),n(612),n(613),n(614),n(615),n(616),n(617),n(618),n(619),n(620),n(621),e.exports=n(43)},function(e,t,n){"use strict";var i=n(17),a=n(38),r=n(26),o=n(9),s=n(36),l=n(62).KEY,c=n(20),u=n(90),d=n(82),_=n(68),h=n(23),f=n(195),p=n(134),m=n(428),v=n(108),g=n(15),y=n(21),S=n(39),E=n(51),b=n(67),T=n(71),M=n(198),I=n(40),C=n(27),A=n(69),D=I.f,x=C.f,R=M.f,O=i.Symbol,L=i.JSON,k=L&&L.stringify,N=h("_hidden"),w=h("toPrimitive"),F={}.propertyIsEnumerable,P=u("symbol-registry"),q=u("symbols"),V=u("op-symbols"),B=Object.prototype,j="function"==typeof O,H=i.QObject,z=!H||!H.prototype||!H.prototype.findChild,U=r&&c(function(){return 7!=T(x({},"a",{get:function(){return x(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=D(B,t);i&&delete B[t],x(e,t,n),i&&e!==B&&x(B,t,i)}:x,Y=function(e){var t=q[e]=T(O.prototype);return t._k=e,t},W=j&&"symbol"==typeof O.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof O},G=function(e,t,n){return e===B&&G(V,t,n),g(e),t=E(t,!0),g(n),a(q,t)?(n.enumerable?(a(e,N)&&e[N][t]&&(e[N][t]=!1),n=T(n,{enumerable:b(0,!1)})):(a(e,N)||x(e,N,b(1,{})),e[N][t]=!0),U(e,t,n)):x(e,t,n)},X=function(e,t){g(e);for(var n,i=m(t=S(t)),a=0,r=i.length;r>a;)G(e,n=i[a++],t[n]);return e},Q=function(e,t){return void 0===t?T(e):X(T(e),t)},J=function(e){var t=F.call(this,e=E(e,!0));return!(this===B&&a(q,e)&&!a(V,e))&&(!(t||!a(this,e)||!a(q,e)||a(this,N)&&this[N][e])||t)},K=function(e,t){if(e=S(e),t=E(t,!0),e!==B||!a(q,t)||a(V,t)){var n=D(e,t);return!n||!a(q,t)||a(e,N)&&e[N][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=R(S(e)),i=[],r=0;n.length>r;)a(q,t=n[r++])||t==N||t==l||i.push(t);return i},Z=function(e){for(var t,n=e===B,i=R(n?V:S(e)),r=[],o=0;i.length>o;)!a(q,t=i[o++])||n&&!a(B,t)||r.push(q[t]);return r};j||(O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var e=_(arguments.length>0?arguments[0]:void 0),t=function(n){this===B&&t.call(V,n),a(this,N)&&a(this[N],e)&&(this[N][e]=!1),U(this,e,b(1,n))};return r&&z&&U(B,e,{configurable:!0,set:t}),Y(e)},s(O.prototype,"toString",function(){return this._k}),I.f=K,C.f=G,n(72).f=M.f=$,n(92).f=J,n(107).f=Z,r&&!n(61)&&s(B,"propertyIsEnumerable",J,!0),f.f=function(e){return Y(h(e))}),o(o.G+o.W+o.F*!j,{Symbol:O});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)h(ee[te++]);for(var ne=A(h.store),ie=0;ne.length>ie;)p(ne[ie++]);o(o.S+o.F*!j,"Symbol",{for:function(e){return a(P,e+="")?P[e]:P[e]=O(e)},keyFor:function(e){if(!W(e))throw TypeError(e+" is not a symbol!");for(var t in P)if(P[t]===e)return t},useSetter:function(){z=!0},useSimple:function(){z=!1}}),o(o.S+o.F*!j,"Object",{create:Q,defineProperty:G,defineProperties:X,getOwnPropertyDescriptor:K,getOwnPropertyNames:$,getOwnPropertySymbols:Z}),L&&o(o.S+o.F*(!j||c(function(){var e=O();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){for(var t,n,i=[e],a=1;arguments.length>a;)i.push(arguments[a++]);if(n=t=i[1],(y(t)||void 0!==e)&&!W(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!W(t))return t}),i[1]=t,k.apply(L,i)}}),O.prototype[w]||n(35)(O.prototype,w,O.prototype.valueOf),d(O,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},function(e,t,n){e.exports=n(90)("native-function-to-string",Function.toString)},function(e,t,n){var i=n(69),a=n(107),r=n(92);e.exports=function(e){var t=i(e),n=a.f;if(n)for(var o,s=n(e),l=r.f,c=0;s.length>c;)l.call(e,o=s[c++])&&t.push(o);return t}},function(e,t,n){var i=n(9);i(i.S,"Object",{create:n(71)})},function(e,t,n){var i=n(9);i(i.S+i.F*!n(26),"Object",{defineProperty:n(27).f})},function(e,t,n){var i=n(9);i(i.S+i.F*!n(26),"Object",{defineProperties:n(197)})},function(e,t,n){var i=n(39),a=n(40).f;n(53)("getOwnPropertyDescriptor",function(){return function(e,t){return a(i(e),t)}})},function(e,t,n){var i=n(29),a=n(41);n(53)("getPrototypeOf",function(){return function(e){return a(i(e))}})},function(e,t,n){var i=n(29),a=n(69);n(53)("keys",function(){return function(e){return a(i(e))}})},function(e,t,n){n(53)("getOwnPropertyNames",function(){return n(198).f})},function(e,t,n){var i=n(21),a=n(62).onFreeze;n(53)("freeze",function(e){return function(t){return e&&i(t)?e(a(t)):t}})},function(e,t,n){var i=n(21),a=n(62).onFreeze;n(53)("seal",function(e){return function(t){return e&&i(t)?e(a(t)):t}})},function(e,t,n){var i=n(21),a=n(62).onFreeze;n(53)("preventExtensions",function(e){return function(t){return e&&i(t)?e(a(t)):t}})},function(e,t,n){var i=n(21);n(53)("isFrozen",function(e){return function(t){return!i(t)||!!e&&e(t)}})},function(e,t,n){var i=n(21);n(53)("isSealed",function(e){return function(t){return!i(t)||!!e&&e(t)}})},function(e,t,n){var i=n(21);n(53)("isExtensible",function(e){return function(t){return!!i(t)&&(!e||e(t))}})},function(e,t,n){var i=n(9);i(i.S+i.F,"Object",{assign:n(199)})},function(e,t,n){var i=n(9);i(i.S,"Object",{is:n(200)})},function(e,t,n){var i=n(9);i(i.S,"Object",{setPrototypeOf:n(138).set})},function(e,t,n){"use strict";var i=n(83),a={};a[n(23)("toStringTag")]="z",a+""!="[object z]"&&n(36)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(e,t,n){var i=n(9);i(i.P,"Function",{bind:n(201)})},function(e,t,n){var i=n(27).f,a=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in a||n(26)&&i(a,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var i=n(21),a=n(41),r=n(23)("hasInstance"),o=Function.prototype;r in o||n(27).f(o,r,{value:function(e){if("function"!=typeof this||!i(e))return!1;if(!i(this.prototype))return e instanceof this;for(;e=a(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var i=n(9),a=n(203);i(i.G+i.F*(parseInt!=a),{parseInt:a})},function(e,t,n){var i=n(9),a=n(204);i(i.G+i.F*(parseFloat!=a),{parseFloat:a})},function(e,t,n){"use strict";var i=n(17),a=n(38),r=n(45),o=n(140),s=n(51),l=n(20),c=n(72).f,u=n(40).f,d=n(27).f,_=n(84).trim,h=i.Number,f=h,p=h.prototype,m="Number"==r(n(71)(p)),v="trim"in String.prototype,g=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=v?t.trim():_(t,3);var n,i,a,r=t.charCodeAt(0);if(43===r||45===r){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(var o,l=t.slice(2),c=0,u=l.length;c<u;c++)if((o=l.charCodeAt(c))<48||o>a)return NaN;return parseInt(l,i)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof h&&(m?l(function(){p.valueOf.call(n)}):"Number"!=r(n))?o(new f(g(t)),n,h):g(t)};for(var y,S=n(26)?c(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;S.length>E;E++)a(f,y=S[E])&&!a(h,y)&&d(h,y,u(f,y));h.prototype=p,p.constructor=h,n(36)(i,"Number",h)}},function(e,t,n){"use strict";var i=n(9),a=n(46),r=n(205),o=n(141),s=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",d=function(e,t){for(var n=-1,i=t;++n<6;)i+=e*c[n],c[n]=i%1e7,i=l(i/1e7)},_=function(e){for(var t=6,n=0;--t>=0;)n+=c[t],c[t]=l(n/e),n=n%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==c[e]){var n=String(c[e]);t=""===t?n:t+o.call("0",7-n.length)+n}return t},f=function(e,t,n){return 0===t?n:t%2==1?f(e,t-1,n*e):f(e*e,t/2,n)},p=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t};i(i.P+i.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(20)(function(){s.call({})})),"Number",{toFixed:function(e){var t,n,i,s,l=r(this,u),c=a(e),m="",v="0";if(c<0||c>20)throw RangeError(u);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(m="-",l=-l),l>1e-21)if(t=p(l*f(2,69,1))-69,n=t<0?l*f(2,-t,1):l/f(2,t,1),n*=4503599627370496,(t=52-t)>0){for(d(0,n),i=c;i>=7;)d(1e7,0),i-=7;for(d(f(10,i,1),0),i=t-1;i>=23;)_(1<<23),i-=23;_(1<<i),d(1,1),_(2),v=h()}else d(0,n),d(1<<-t,0),v=h()+o.call("0",c);return c>0?(s=v.length,v=m+(s<=c?"0."+o.call("0",c-s)+v:v.slice(0,s-c)+"."+v.slice(s-c))):v=m+v,v}})},function(e,t,n){"use strict";var i=n(9),a=n(20),r=n(205),o=1..toPrecision;i(i.P+i.F*(a(function(){return"1"!==o.call(1,void 0)})||!a(function(){o.call({})})),"Number",{toPrecision:function(e){var t=r(this,"Number#toPrecision: incorrect invocation!");return void 0===e?o.call(t):o.call(t,e)}})},function(e,t,n){var i=n(9);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var i=n(9),a=n(17).isFinite;i(i.S,"Number",{isFinite:function(e){return"number"==typeof e&&a(e)}})},function(e,t,n){var i=n(9);i(i.S,"Number",{isInteger:n(206)})},function(e,t,n){var i=n(9);i(i.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var i=n(9),a=n(206),r=Math.abs;i(i.S,"Number",{isSafeInteger:function(e){return a(e)&&r(e)<=9007199254740991}})},function(e,t,n){var i=n(9);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var i=n(9);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var i=n(9),a=n(204);i(i.S+i.F*(Number.parseFloat!=a),"Number",{parseFloat:a})},function(e,t,n){var i=n(9),a=n(203);i(i.S+i.F*(Number.parseInt!=a),"Number",{parseInt:a})},function(e,t,n){var i=n(9),a=n(207),r=Math.sqrt,o=Math.acosh;i(i.S+i.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:a(e-1+r(e-1)*r(e+1))}})},function(e,t,n){function i(e){return isFinite(e=+e)&&0!=e?e<0?-i(-e):Math.log(e+Math.sqrt(e*e+1)):e}var a=n(9),r=Math.asinh;a(a.S+a.F*!(r&&1/r(0)>0),"Math",{asinh:i})},function(e,t,n){var i=n(9),a=Math.atanh;i(i.S+i.F*!(a&&1/a(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var i=n(9),a=n(142);i(i.S,"Math",{cbrt:function(e){return a(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var i=n(9);i(i.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var i=n(9),a=Math.exp;i(i.S,"Math",{cosh:function(e){return(a(e=+e)+a(-e))/2}})},function(e,t,n){var i=n(9),a=n(143);i(i.S+i.F*(a!=Math.expm1),"Math",{expm1:a})},function(e,t,n){var i=n(9);i(i.S,"Math",{fround:n(208)})},function(e,t,n){var i=n(9),a=Math.abs;i(i.S,"Math",{hypot:function(e,t){for(var n,i,r=0,o=0,s=arguments.length,l=0;o<s;)n=a(arguments[o++]),l<n?(i=l/n,r=r*i*i+1,l=n):n>0?(i=n/l,r+=i*i):r+=n;return l===1/0?1/0:l*Math.sqrt(r)}})},function(e,t,n){var i=n(9),a=Math.imul;i(i.S+i.F*n(20)(function(){return-5!=a(4294967295,5)||2!=a.length}),"Math",{imul:function(e,t){var n=+e,i=+t,a=65535&n,r=65535&i;return 0|a*r+((65535&n>>>16)*r+a*(65535&i>>>16)<<16>>>0)}})},function(e,t,n){var i=n(9);i(i.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var i=n(9);i(i.S,"Math",{log1p:n(207)})},function(e,t,n){var i=n(9);i(i.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var i=n(9);i(i.S,"Math",{sign:n(142)})},function(e,t,n){var i=n(9),a=n(143),r=Math.exp;i(i.S+i.F*n(20)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(a(e)-a(-e))/2:(r(e-1)-r(-e-1))*(Math.E/2)}})},function(e,t,n){var i=n(9),a=n(143),r=Math.exp;i(i.S,"Math",{tanh:function(e){var t=a(e=+e),n=a(-e);return t==1/0?1:n==1/0?-1:(t-n)/(r(e)+r(-e))}})},function(e,t,n){var i=n(9);i(i.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var i=n(9),a=n(70),r=String.fromCharCode,o=String.fromCodePoint;i(i.S+i.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,n=[],i=arguments.length,o=0;i>o;){if(t=+arguments[o++],a(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?r(t):r(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var i=n(9),a=n(39),r=n(25);i(i.S,"String",{raw:function(e){for(var t=a(e.raw),n=r(t.length),i=arguments.length,o=[],s=0;n>s;)o.push(String(t[s++])),s<i&&o.push(String(arguments[s]));return o.join("")}})},function(e,t,n){"use strict";n(84)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var i=n(109)(!0);n(144)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var i=n(9),a=n(109)(!1);i(i.P,"String",{codePointAt:function(e){return a(this,e)}})},function(e,t,n){"use strict";var i=n(9),a=n(25),r=n(146),o="".endsWith;i(i.P+i.F*n(147)("endsWith"),"String",{endsWith:function(e){var t=r(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=a(t.length),s=void 0===n?i:Math.min(a(n),i),l=String(e);return o?o.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";var i=n(9),a=n(146);i(i.P+i.F*n(147)("includes"),"String",{includes:function(e){return!!~a(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var i=n(9);i(i.P,"String",{repeat:n(141)})},function(e,t,n){"use strict";var i=n(9),a=n(25),r=n(146),o="".startsWith;i(i.P+i.F*n(147)("startsWith"),"String",{startsWith:function(e){var t=r(this,e,"startsWith"),n=a(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return o?o.call(t,i,n):t.slice(n,n+i.length)===i}})},function(e,t,n){"use strict";n(37)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(37)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,n){"use strict";n(37)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,n){"use strict";n(37)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,n){"use strict";n(37)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,n){"use strict";n(37)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,n){"use strict";n(37)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,n){"use strict";n(37)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,n){"use strict";n(37)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,n){"use strict";n(37)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,n){"use strict";n(37)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,n){"use strict";n(37)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,n){"use strict";n(37)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,n){var i=n(9);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var i=n(9),a=n(29),r=n(51);i(i.P+i.F*n(20)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=a(this),n=r(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var i=n(9),a=n(505);i(i.P+i.F*(Date.prototype.toISOString!==a),"Date",{toISOString:a})},function(e,t,n){"use strict";var i=n(20),a=Date.prototype.getTime,r=Date.prototype.toISOString,o=function(e){return e>9?e:"0"+e};e.exports=i(function(){return"0385-07-25T07:06:39.999Z"!=r.call(new Date(-5e13-1))})||!i(function(){r.call(new Date(NaN))})?function(){if(!isFinite(a.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),i=t<0?"-":t>9999?"+":"";return i+("00000"+Math.abs(t)).slice(i?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:r},function(e,t,n){var i=Date.prototype,a=i.toString,r=i.getTime;new Date(NaN)+""!="Invalid Date"&&n(36)(i,"toString",function(){var e=r.call(this);return e===e?a.call(this):"Invalid Date"})},function(e,t,n){var i=n(23)("toPrimitive"),a=Date.prototype;i in a||n(35)(a,i,n(508))},function(e,t,n){"use strict";var i=n(15),a=n(51);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return a(i(this),"number"!=e)}},function(e,t,n){var i=n(9);i(i.S,"Array",{isArray:n(108)})},function(e,t,n){"use strict";var i=n(44),a=n(9),r=n(29),o=n(209),s=n(148),l=n(25),c=n(149),u=n(150);a(a.S+a.F*!n(111)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,a,d,_=r(e),h="function"==typeof this?this:Array,f=arguments.length,p=f>1?arguments[1]:void 0,m=void 0!==p,v=0,g=u(_);if(m&&(p=i(p,f>2?arguments[2]:void 0,2)),void 0==g||h==Array&&s(g))for(t=l(_.length),n=new h(t);t>v;v++)c(n,v,m?p(_[v],v):_[v]);else for(d=g.call(_),n=new h;!(a=d.next()).done;v++)c(n,v,m?o(d,p,[a.value,v],!0):a.value);return n.length=v,n}})},function(e,t,n){"use strict";var i=n(9),a=n(149);i(i.S+i.F*n(20)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)a(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var i=n(9),a=n(39),r=[].join;i(i.P+i.F*(n(91)!=Object||!n(47)(r)),"Array",{join:function(e){return r.call(a(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var i=n(9),a=n(137),r=n(45),o=n(70),s=n(25),l=[].slice;i(i.P+i.F*n(20)(function(){a&&l.call(a)}),"Array",{slice:function(e,t){var n=s(this.length),i=r(this);if(t=void 0===t?n:t,"Array"==i)return l.call(this,e,t);for(var a=o(e,n),c=o(t,n),u=s(c-a),d=new Array(u),_=0;_<u;_++)d[_]="String"==i?this.charAt(a+_):this[a+_];return d}})},function(e,t,n){"use strict";var i=n(9),a=n(32),r=n(29),o=n(20),s=[].sort,l=[1,2,3];i(i.P+i.F*(o(function(){l.sort(void 0)})||!o(function(){l.sort(null)})||!n(47)(s)),"Array",{sort:function(e){return void 0===e?s.call(r(this)):s.call(r(this),a(e))}})},function(e,t,n){"use strict";var i=n(9),a=n(54)(0),r=n(47)([].forEach,!0);i(i.P+i.F*!r,"Array",{forEach:function(e){return a(this,e,arguments[1])}})},function(e,t,n){var i=n(21),a=n(108),r=n(23)("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),i(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var i=n(9),a=n(54)(1);i(i.P+i.F*!n(47)([].map,!0),"Array",{map:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var i=n(9),a=n(54)(2);i(i.P+i.F*!n(47)([].filter,!0),"Array",{filter:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var i=n(9),a=n(54)(3);i(i.P+i.F*!n(47)([].some,!0),"Array",{some:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var i=n(9),a=n(54)(4);i(i.P+i.F*!n(47)([].every,!0),"Array",{every:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var i=n(9),a=n(210);i(i.P+i.F*!n(47)([].reduce,!0),"Array",{reduce:function(e){return a(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var i=n(9),a=n(210);i(i.P+i.F*!n(47)([].reduceRight,!0),"Array",{reduceRight:function(e){return a(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var i=n(9),a=n(106)(!1),r=[].indexOf,o=!!r&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(o||!n(47)(r)),"Array",{indexOf:function(e){return o?r.apply(this,arguments)||0:a(this,e,arguments[1])}})},function(e,t,n){"use strict";var i=n(9),a=n(39),r=n(46),o=n(25),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(l||!n(47)(s)),"Array",{lastIndexOf:function(e){if(l)return s.apply(this,arguments)||0;var t=a(this),n=o(t.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,r(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}})},function(e,t,n){var i=n(9);i(i.P,"Array",{copyWithin:n(211)}),n(63)("copyWithin")},function(e,t,n){var i=n(9);i(i.P,"Array",{fill:n(152)}),n(63)("fill")},function(e,t,n){"use strict";var i=n(9),a=n(54)(5),r=!0;"find"in[]&&Array(1).find(function(){r=!1}),i(i.P+i.F*r,"Array",{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(63)("find")},function(e,t,n){"use strict";var i=n(9),a=n(54)(6),r="findIndex",o=!0;r in[]&&Array(1)[r](function(){o=!1}),i(i.P+i.F*o,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(63)(r)},function(e,t,n){n(73)("Array")},function(e,t,n){var i=n(17),a=n(140),r=n(27).f,o=n(72).f,s=n(110),l=n(93),c=i.RegExp,u=c,d=c.prototype,_=/a/g,h=/a/g,f=new c(_)!==_;if(n(26)&&(!f||n(20)(function(){return h[n(23)("match")]=!1,c(_)!=_||c(h)==h||"/a/i"!=c(_,"i")}))){c=function(e,t){var n=this instanceof c,i=s(e),r=void 0===t;return!n&&i&&e.constructor===c&&r?e:a(f?new u(i&&!r?e.source:e,t):u((i=e instanceof c)?e.source:e,i&&r?l.call(e):t),n?this:d,c)};for(var p=o(u),m=0;p.length>m;)!function(e){e in c||r(c,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})}(p[m++]);d.constructor=c,c.prototype=d,n(36)(i,"RegExp",c)}n(73)("RegExp")},function(e,t,n){"use strict";n(214);var i=n(15),a=n(93),r=n(26),o=/./.toString,s=function(e){n(36)(RegExp.prototype,"toString",e,!0)};n(20)(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?s(function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!r&&e instanceof RegExp?a.call(e):void 0)}):"toString"!=o.name&&s(function(){return o.call(this)})},function(e,t,n){"use strict";var i=n(15),a=n(25),r=n(155),o=n(112);n(113)("match",1,function(e,t,n,s){return[function(n){var i=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,i):new RegExp(n)[t](String(i))},function(e){var t=s(n,e,this);if(t.done)return t.value;var l=i(e),c=String(this);if(!l.global)return o(l,c);var u=l.unicode;l.lastIndex=0;for(var d,_=[],h=0;null!==(d=o(l,c));){var f=String(d[0]);_[h]=f,""===f&&(l.lastIndex=r(c,a(l.lastIndex),u)),h++}return 0===h?null:_}]})},function(e,t,n){"use strict";var i=n(15),a=n(29),r=n(25),o=n(46),s=n(155),l=n(112),c=Math.max,u=Math.min,d=Math.floor,_=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g,f=function(e){return void 0===e?e:String(e)};n(113)("replace",2,function(e,t,n,p){function m(e,t,i,r,o,s){var l=i+e.length,c=r.length,u=h;return void 0!==o&&(o=a(o),u=_),n.call(s,u,function(n,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(l);case"<":s=o[a.slice(1,-1)];break;default:var u=+a;if(0===u)return n;if(u>c){var _=d(u/10);return 0===_?n:_<=c?void 0===r[_-1]?a.charAt(1):r[_-1]+a.charAt(1):n}s=r[u-1]}return void 0===s?"":s})}return[function(i,a){var r=e(this),o=void 0==i?void 0:i[t];return void 0!==o?o.call(i,r,a):n.call(String(r),i,a)},function(e,t){var a=p(n,e,this,t);if(a.done)return a.value;var d=i(e),_=String(this),h="function"==typeof t;h||(t=String(t));var v=d.global;if(v){var g=d.unicode;d.lastIndex=0}for(var y=[];;){var S=l(d,_);if(null===S)break;if(y.push(S),!v)break;""===String(S[0])&&(d.lastIndex=s(_,r(d.lastIndex),g))}for(var E="",b=0,T=0;T<y.length;T++){S=y[T];for(var M=String(S[0]),I=c(u(o(S.index),_.length),0),C=[],A=1;A<S.length;A++)C.push(f(S[A]));var D=S.groups;if(h){var x=[M].concat(C,I,_);void 0!==D&&x.push(D);var R=String(t.apply(void 0,x))}else R=m(M,_,I,C,D,t);I>=b&&(E+=_.slice(b,I)+R,b=I+M.length)}return E+_.slice(b)}]})},function(e,t,n){"use strict";var i=n(15),a=n(200),r=n(112);n(113)("search",1,function(e,t,n,o){return[function(n){var i=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,i):new RegExp(n)[t](String(i))},function(e){var t=o(n,e,this);if(t.done)return t.value;var s=i(e),l=String(this),c=s.lastIndex;a(c,0)||(s.lastIndex=0);var u=r(s,l);return a(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]})},function(e,t,n){"use strict";var i=n(110),a=n(15),r=n(94),o=n(155),s=n(25),l=n(112),c=n(154),u=n(20),d=Math.min,_=[].push,h="length",f=!u(function(){RegExp(4294967295,"y")});n(113)("split",2,function(e,t,n,u){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[h]||2!="ab".split(/(?:ab)*/)[h]||4!=".".split(/(.?)(.?)/)[h]||".".split(/()()/)[h]>1||"".split(/.?/)[h]?function(e,t){var a=String(this);if(void 0===e&&0===t)return[];if(!i(e))return n.call(a,e,t);for(var r,o,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?4294967295:t>>>0,p=new RegExp(e.source,u+"g");(r=c.call(p,a))&&!((o=p.lastIndex)>d&&(l.push(a.slice(d,r.index)),r[h]>1&&r.index<a[h]&&_.apply(l,r.slice(1)),s=r[0][h],d=o,l[h]>=f));)p.lastIndex===r.index&&p.lastIndex++;return d===a[h]?!s&&p.test("")||l.push(""):l.push(a.slice(d)),l[h]>f?l.slice(0,f):l}:"0".split(void 0,0)[h]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,i){var a=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,a,i):p.call(String(a),n,i)},function(e,t){var i=u(p,e,this,t,p!==n);if(i.done)return i.value;var c=a(e),_=String(this),h=r(c,RegExp),m=c.unicode,v=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(f?"y":"g"),g=new h(f?c:"^(?:"+c.source+")",v),y=void 0===t?4294967295:t>>>0;if(0===y)return[];if(0===_.length)return null===l(g,_)?[_]:[];for(var S=0,E=0,b=[];E<_.length;){g.lastIndex=f?E:0;var T,M=l(g,f?_:_.slice(E));if(null===M||(T=d(s(g.lastIndex+(f?0:E)),_.length))===S)E=o(_,E,m);else{if(b.push(_.slice(S,E)),b.length===y)return b;for(var I=1;I<=M.length-1;I++)if(b.push(M[I]),b.length===y)return b;E=S=T}}return b.push(_.slice(S)),b}]})},function(e,t,n){"use strict";var i,a,r,o,s=n(61),l=n(17),c=n(44),u=n(83),d=n(9),_=n(21),h=n(32),f=n(74),p=n(75),m=n(94),v=n(156).set,g=n(157)(),y=n(158),S=n(215),E=n(114),b=n(216),T=l.TypeError,M=l.process,I=M&&M.versions,C=I&&I.v8||"",A=l.Promise,D="process"==u(M),x=function(){},R=a=y.f,O=!!function(){try{var e=A.resolve(1),t=(e.constructor={})[n(23)("species")]=function(e){e(x,x)};return(D||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof t&&0!==C.indexOf("6.6")&&-1===E.indexOf("Chrome/66")}catch(e){}}(),L=function(e){var t;return!(!_(e)||"function"!=typeof(t=e.then))&&t},k=function(e,t){if(!e._n){e._n=!0;var n=e._c;g(function(){for(var i=e._v,a=1==e._s,r=0;n.length>r;)!function(t){var n,r,o,s=a?t.ok:t.fail,l=t.resolve,c=t.reject,u=t.domain;try{s?(a||(2==e._h&&F(e),e._h=1),!0===s?n=i:(u&&u.enter(),n=s(i),u&&(u.exit(),o=!0)),n===t.promise?c(T("Promise-chain cycle")):(r=L(n))?r.call(n,l,c):l(n)):c(i)}catch(e){u&&!o&&u.exit(),c(e)}}(n[r++]);e._c=[],e._n=!1,t&&!e._h&&N(e)})}},N=function(e){v.call(l,function(){var t,n,i,a=e._v,r=w(e);if(r&&(t=S(function(){D?M.emit("unhandledRejection",a,e):(n=l.onunhandledrejection)?n({promise:e,reason:a}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",a)}),e._h=D||w(e)?2:1),e._a=void 0,r&&t.e)throw t.v})},w=function(e){return 1!==e._h&&0===(e._a||e._c).length},F=function(e){v.call(l,function(){var t;D?M.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},P=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),k(t,!0))},q=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw T("Promise can't be resolved itself");(t=L(e))?g(function(){var i={_w:n,_d:!1};try{t.call(e,c(q,i,1),c(P,i,1))}catch(e){P.call(i,e)}}):(n._v=e,n._s=1,k(n,!1))}catch(e){P.call({_w:n,_d:!1},e)}}};O||(A=function(e){f(this,A,"Promise","_h"),h(e),i.call(this);try{e(c(q,this,1),c(P,this,1))}catch(e){P.call(this,e)}},i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(76)(A.prototype,{then:function(e,t){var n=R(m(this,A));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=D?M.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),r=function(){var e=new i;this.promise=e,this.resolve=c(q,e,1),this.reject=c(P,e,1)},y.f=R=function(e){return e===A||e===o?new r(e):a(e)}),d(d.G+d.W+d.F*!O,{Promise:A}),n(82)(A,"Promise"),n(73)("Promise"),o=n(43).Promise,d(d.S+d.F*!O,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(s||!O),"Promise",{resolve:function(e){return b(s&&this===o?A:this,e)}}),d(d.S+d.F*!(O&&n(111)(function(e){A.all(e).catch(x)})),"Promise",{all:function(e){var t=this,n=R(t),i=n.resolve,a=n.reject,r=S(function(){var n=[],r=0,o=1;p(e,!1,function(e){var s=r++,l=!1;n.push(void 0),o++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--o||i(n))},a)}),--o||i(n)});return r.e&&a(r.v),n.promise},race:function(e){var t=this,n=R(t),i=n.reject,a=S(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return a.e&&i(a.v),n.promise}})},function(e,t,n){"use strict";var i=n(221),a=n(77);n(115)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(a(this,"WeakSet"),e,!0)}},i,!1,!0)},function(e,t,n){"use strict";var i=n(9),a=n(116),r=n(159),o=n(15),s=n(70),l=n(25),c=n(21),u=n(17).ArrayBuffer,d=n(94),_=r.ArrayBuffer,h=r.DataView,f=a.ABV&&u.isView,p=_.prototype.slice,m=a.VIEW;i(i.G+i.W+i.F*(u!==_),{ArrayBuffer:_}),i(i.S+i.F*!a.CONSTR,"ArrayBuffer",{isView:function(e){return f&&f(e)||c(e)&&m in e}}),i(i.P+i.U+i.F*n(20)(function(){return!new _(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==p&&void 0===t)return p.call(o(this),e);for(var n=o(this).byteLength,i=s(e,n),a=s(void 0===t?n:t,n),r=new(d(this,_))(l(a-i)),c=new h(this),u=new h(r),f=0;i<a;)u.setUint8(f++,c.getUint8(i++));return r}}),n(73)("ArrayBuffer")},function(e,t,n){var i=n(9);i(i.G+i.W+i.F*!n(116).ABV,{DataView:n(159).DataView})},function(e,t,n){n(57)("Int8",1,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Uint8",1,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Uint8",1,function(e){return function(t,n,i){return e(this,t,n,i)}},!0)},function(e,t,n){n(57)("Int16",2,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Uint16",2,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Int32",4,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Uint32",4,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Float32",4,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){n(57)("Float64",8,function(e){return function(t,n,i){return e(this,t,n,i)}})},function(e,t,n){var i=n(9),a=n(32),r=n(15),o=(n(17).Reflect||{}).apply,s=Function.apply;i(i.S+i.F*!n(20)(function(){o(function(){})}),"Reflect",{apply:function(e,t,n){var i=a(e),l=r(n);return o?o(i,t,l):s.call(i,t,l)}})},function(e,t,n){var i=n(9),a=n(71),r=n(32),o=n(15),s=n(21),l=n(20),c=n(201),u=(n(17).Reflect||{}).construct,d=l(function(){function e(){}return!(u(function(){},[],e)instanceof e)}),_=!l(function(){u(function(){})});i(i.S+i.F*(d||_),"Reflect",{construct:function(e,t){r(e),o(t);var n=arguments.length<3?e:r(arguments[2]);if(_&&!d)return u(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var i=[null];return i.push.apply(i,t),new(c.apply(e,i))}var l=n.prototype,h=a(s(l)?l:Object.prototype),f=Function.apply.call(e,h,t);return s(f)?f:h}})},function(e,t,n){var i=n(27),a=n(9),r=n(15),o=n(51);a(a.S+a.F*n(20)(function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){r(e),t=o(t,!0),r(n);try{return i.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var i=n(9),a=n(40).f,r=n(15);i(i.S,"Reflect",{deleteProperty:function(e,t){var n=a(r(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var i=n(9),a=n(15),r=function(e){this._t=a(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(145)(r,"Object",function(){var e,t=this,n=t._k;do{if(t._i>=n.length)return{value:void 0,done:!0}}while(!((e=n[t._i++])in t._t));return{value:e,done:!1}}),i(i.S,"Reflect",{enumerate:function(e){return new r(e)}})},function(e,t,n){function i(e,t){var n,s,u=arguments.length<3?e:arguments[2];return c(e)===u?e[t]:(n=a.f(e,t))?o(n,"value")?n.value:void 0!==n.get?n.get.call(u):void 0:l(s=r(e))?i(s,t,u):void 0}var a=n(40),r=n(41),o=n(38),s=n(9),l=n(21),c=n(15);s(s.S,"Reflect",{get:i})},function(e,t,n){var i=n(40),a=n(9),r=n(15);a(a.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return i.f(r(e),t)}})},function(e,t,n){var i=n(9),a=n(41),r=n(15);i(i.S,"Reflect",{getPrototypeOf:function(e){return a(r(e))}})},function(e,t,n){var i=n(9);i(i.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var i=n(9),a=n(15),r=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(e){return a(e),!r||r(e)}})},function(e,t,n){var i=n(9);i(i.S,"Reflect",{ownKeys:n(223)})},function(e,t,n){var i=n(9),a=n(15),r=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(e){a(e);try{return r&&r(e),!0}catch(e){return!1}}})},function(e,t,n){function i(e,t,n){var l,_,h=arguments.length<4?e:arguments[3],f=r.f(u(e),t);if(!f){if(d(_=o(e)))return i(_,t,n,h);f=c(0)}if(s(f,"value")){if(!1===f.writable||!d(h))return!1;if(l=r.f(h,t)){if(l.get||l.set||!1===l.writable)return!1;l.value=n,a.f(h,t,l)}else a.f(h,t,c(0,n));return!0}return void 0!==f.set&&(f.set.call(h,n),!0)}var a=n(27),r=n(40),o=n(41),s=n(38),l=n(9),c=n(67),u=n(15),d=n(21);l(l.S,"Reflect",{set:i})},function(e,t,n){var i=n(9),a=n(138);a&&i(i.S,"Reflect",{setPrototypeOf:function(e,t){a.check(e,t);try{return a.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var i=n(9),a=n(106)(!0);i(i.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(63)("includes")},function(e,t,n){"use strict";var i=n(9),a=n(224),r=n(29),o=n(25),s=n(32),l=n(151);i(i.P,"Array",{flatMap:function(e){var t,n,i=r(this);return s(e),t=o(i.length),n=l(i,0),a(n,i,i,t,0,1,e,arguments[1]),n}}),n(63)("flatMap")},function(e,t,n){"use strict";var i=n(9),a=n(224),r=n(29),o=n(25),s=n(46),l=n(151);i(i.P,"Array",{flatten:function(){var e=arguments[0],t=r(this),n=o(t.length),i=l(t,0);return a(i,t,t,n,0,void 0===e?1:s(e)),i}}),n(63)("flatten")},function(e,t,n){"use strict";var i=n(9),a=n(109)(!0);i(i.P,"String",{at:function(e){return a(this,e)}})},function(e,t,n){"use strict";var i=n(9),a=n(225),r=n(114),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);i(i.P+i.F*o,"String",{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var i=n(9),a=n(225),r=n(114),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);i(i.P+i.F*o,"String",{padEnd:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(84)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},function(e,t,n){"use strict";n(84)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},function(e,t,n){"use strict";var i=n(9),a=n(52),r=n(25),o=n(110),s=n(93),l=RegExp.prototype,c=function(e,t){this._r=e,this._s=t};n(145)(c,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),i(i.P,"String",{matchAll:function(e){if(a(this),!o(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in l?String(e.flags):s.call(e),i=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return i.lastIndex=r(e.lastIndex),new c(i,t)}})},function(e,t,n){n(134)("asyncIterator")},function(e,t,n){n(134)("observable")},function(e,t,n){var i=n(9),a=n(223),r=n(39),o=n(40),s=n(149);i(i.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,i=r(e),l=o.f,c=a(i),u={},d=0;c.length>d;)void 0!==(n=l(i,t=c[d++]))&&s(u,t,n);return u}})},function(e,t,n){var i=n(9),a=n(226)(!1);i(i.S,"Object",{values:function(e){return a(e)}})},function(e,t,n){var i=n(9),a=n(226)(!0);i(i.S,"Object",{entries:function(e){return a(e)}})},function(e,t,n){"use strict";var i=n(9),a=n(29),r=n(32),o=n(27);n(26)&&i(i.P+n(117),"Object",{__defineGetter__:function(e,t){o.f(a(this),e,{get:r(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var i=n(9),a=n(29),r=n(32),o=n(27);n(26)&&i(i.P+n(117),"Object",{__defineSetter__:function(e,t){o.f(a(this),e,{set:r(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var i=n(9),a=n(29),r=n(51),o=n(41),s=n(40).f;n(26)&&i(i.P+n(117),"Object",{__lookupGetter__:function(e){var t,n=a(this),i=r(e,!0);do{if(t=s(n,i))return t.get}while(n=o(n))}})},function(e,t,n){"use strict";var i=n(9),a=n(29),r=n(51),o=n(41),s=n(40).f;n(26)&&i(i.P+n(117),"Object",{__lookupSetter__:function(e){var t,n=a(this),i=r(e,!0);do{if(t=s(n,i))return t.set}while(n=o(n))}})},function(e,t,n){var i=n(9);i(i.P+i.R,"Map",{toJSON:n(227)("Map")})},function(e,t,n){var i=n(9);i(i.P+i.R,"Set",{toJSON:n(227)("Set")})},function(e,t,n){n(118)("Map")},function(e,t,n){n(118)("Set")},function(e,t,n){n(118)("WeakMap")},function(e,t,n){n(118)("WeakSet")},function(e,t,n){n(119)("Map")},function(e,t,n){n(119)("Set")},function(e,t,n){n(119)("WeakMap")},function(e,t,n){n(119)("WeakSet")},function(e,t,n){var i=n(9);i(i.G,{global:n(17)})},function(e,t,n){var i=n(9);i(i.S,"System",{global:n(17)})},function(e,t,n){var i=n(9),a=n(45);i(i.S,"Error",{isError:function(e){return"Error"===a(e)}})},function(e,t,n){var i=n(9);i(i.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},function(e,t,n){var i=n(9);i(i.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,n){var i=n(9),a=180/Math.PI;i(i.S,"Math",{degrees:function(e){return e*a}})},function(e,t,n){var i=n(9),a=n(229),r=n(208);i(i.S,"Math",{fscale:function(e,t,n,i,o){return r(a(e,t,n,i,o))}})},function(e,t,n){var i=n(9);i(i.S,"Math",{iaddh:function(e,t,n,i){var a=e>>>0,r=t>>>0,o=n>>>0;return r+(i>>>0)+((a&o|(a|o)&~(a+o>>>0))>>>31)|0}})},function(e,t,n){var i=n(9);i(i.S,"Math",{isubh:function(e,t,n,i){var a=e>>>0,r=t>>>0,o=n>>>0;return r-(i>>>0)-((~a&o|~(a^o)&a-o>>>0)>>>31)|0}})},function(e,t,n){var i=n(9);i(i.S,"Math",{imulh:function(e,t){var n=+e,i=+t,a=65535&n,r=65535&i,o=n>>16,s=i>>16,l=(o*r>>>0)+(a*r>>>16);return o*s+(l>>16)+((a*s>>>0)+(65535&l)>>16)}})},function(e,t,n){var i=n(9);i(i.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,n){var i=n(9),a=Math.PI/180;i(i.S,"Math",{radians:function(e){return e*a}})},function(e,t,n){var i=n(9);i(i.S,"Math",{scale:n(229)})},function(e,t,n){var i=n(9);i(i.S,"Math",{umulh:function(e,t){var n=+e,i=+t,a=65535&n,r=65535&i,o=n>>>16,s=i>>>16,l=(o*r>>>0)+(a*r>>>16);return o*s+(l>>>16)+((a*s>>>0)+(65535&l)>>>16)}})},function(e,t,n){var i=n(9);i(i.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,n){"use strict";var i=n(9),a=n(43),r=n(17),o=n(94),s=n(216);i(i.P+i.R,"Promise",{finally:function(e){var t=o(this,a.Promise||r.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var i=n(9),a=n(158),r=n(215);i(i.S,"Promise",{try:function(e){var t=a.f(this),n=r(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){var i=n(58),a=n(15),r=i.key,o=i.set;i.exp({defineMetadata:function(e,t,n,i){o(e,t,a(n),r(i))}})},function(e,t,n){var i=n(58),a=n(15),r=i.key,o=i.map,s=i.store;i.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:r(arguments[2]),i=o(a(t),n,!1);if(void 0===i||!i.delete(e))return!1;if(i.size)return!0;var l=s.get(t);return l.delete(n),!!l.size||s.delete(t)}})},function(e,t,n){var i=n(58),a=n(15),r=n(41),o=i.has,s=i.get,l=i.key,c=function(e,t,n){if(o(e,t,n))return s(e,t,n);var i=r(t);return null!==i?c(e,i,n):void 0};i.exp({getMetadata:function(e,t){return c(e,a(t),arguments.length<3?void 0:l(arguments[2]))}})},function(e,t,n){var i=n(219),a=n(228),r=n(58),o=n(15),s=n(41),l=r.keys,c=r.key,u=function(e,t){var n=l(e,t),r=s(e);if(null===r)return n;var o=u(r,t);return o.length?n.length?a(new i(n.concat(o))):o:n};r.exp({getMetadataKeys:function(e){return u(o(e),arguments.length<2?void 0:c(arguments[1]))}})},function(e,t,n){var i=n(58),a=n(15),r=i.get,o=i.key;i.exp({getOwnMetadata:function(e,t){return r(e,a(t),arguments.length<3?void 0:o(arguments[2]))}})},function(e,t,n){var i=n(58),a=n(15),r=i.keys,o=i.key;i.exp({getOwnMetadataKeys:function(e){return r(a(e),arguments.length<2?void 0:o(arguments[1]))}})},function(e,t,n){var i=n(58),a=n(15),r=n(41),o=i.has,s=i.key,l=function(e,t,n){if(o(e,t,n))return!0;var i=r(t);return null!==i&&l(e,i,n)};i.exp({hasMetadata:function(e,t){return l(e,a(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){var i=n(58),a=n(15),r=i.has,o=i.key;i.exp({hasOwnMetadata:function(e,t){return r(e,a(t),arguments.length<3?void 0:o(arguments[2]))}})},function(e,t,n){var i=n(58),a=n(15),r=n(32),o=i.key,s=i.set;i.exp({metadata:function(e,t){return function(n,i){s(e,t,(void 0!==i?a:r)(n),o(i))}}})},function(e,t,n){var i=n(9),a=n(157)(),r=n(17).process,o="process"==n(45)(r);i(i.G,{asap:function(e){var t=o&&r.domain;a(t?t.bind(e):e)}})},function(e,t,n){"use strict";var i=n(9),a=n(17),r=n(43),o=n(157)(),s=n(23)("observable"),l=n(32),c=n(15),u=n(74),d=n(76),_=n(35),h=n(75),f=h.RETURN,p=function(e){return null==e?void 0:l(e)},m=function(e){var t=e._c;t&&(e._c=void 0,t())},v=function(e){return void 0===e._o},g=function(e){v(e)||(e._o=void 0,m(e))},y=function(e,t){c(e),this._c=void 0,this._o=e,e=new S(this);try{var n=t(e),i=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){i.unsubscribe()}:l(n),this._c=n)}catch(t){return void e.error(t)}v(this)&&m(this)};y.prototype=d({},{unsubscribe:function(){g(this)}});var S=function(e){this._s=e};S.prototype=d({},{next:function(e){var t=this._s;if(!v(t)){var n=t._o;try{var i=p(n.next);if(i)return i.call(n,e)}catch(e){try{g(t)}finally{throw e}}}},error:function(e){var t=this._s;if(v(t))throw e;var n=t._o;t._o=void 0;try{var i=p(n.error);if(!i)throw e;e=i.call(n,e)}catch(e){try{m(t)}finally{throw e}}return m(t),e},complete:function(e){var t=this._s;if(!v(t)){var n=t._o;t._o=void 0;try{var i=p(n.complete);e=i?i.call(n,e):void 0}catch(e){try{m(t)}finally{throw e}}return m(t),e}}});var E=function(e){u(this,E,"Observable","_f")._f=l(e)};d(E.prototype,{subscribe:function(e){return new y(e,this._f)},forEach:function(e){var t=this;return new(r.Promise||a.Promise)(function(n,i){l(e);var a=t.subscribe({next:function(t){try{return e(t)}catch(e){i(e),a.unsubscribe()}},error:i,complete:n})})}}),d(E,{from:function(e){var t="function"==typeof this?this:E,n=p(c(e)[s]);if(n){var i=c(n.call(e));return i.constructor===t?i:new t(function(e){return i.subscribe(e)})}return new t(function(t){var n=!1;return o(function(){if(!n){try{if(h(e,!1,function(e){if(t.next(e),n)return f})===f)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:E)(function(e){var t=!1;return o(function(){if(!t){for(var i=0;i<n.length;++i)if(e.next(n[i]),t)return;e.complete()}}),function(){t=!0}})}}),_(E.prototype,s,function(){return this}),i(i.G,{Observable:E}),n(73)("Observable")},function(e,t,n){var i=n(17),a=n(9),r=n(114),o=[].slice,s=/MSIE .\./.test(r),l=function(e){return function(t,n){var i=arguments.length>2,a=!!i&&o.call(arguments,2);return e(i?function(){("function"==typeof t?t:Function(t)).apply(this,a)}:t,n)}};a(a.G+a.B+a.F*s,{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},function(e,t,n){var i=n(9),a=n(156);i(i.G+i.B,{setImmediate:a.set,clearImmediate:a.clear})},function(e,t,n){for(var i=n(153),a=n(69),r=n(36),o=n(17),s=n(35),l=n(85),c=n(23),u=c("iterator"),d=c("toStringTag"),_=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=a(h),p=0;p<f.length;p++){var m,v=f[p],g=h[v],y=o[v],S=y&&y.prototype;if(S&&(S[u]||s(S,u,_),S[d]||s(S,d,v),l[v]=_,g))for(m in i)S[m]||r(S,m,i[m],!0)}},function(e,t,n){(function(t){!function(t){"use strict";function n(e,t,n,i){var r=t&&t.prototype instanceof a?t:a,o=Object.create(r.prototype),s=new h(i||[]);return o._invoke=c(e,n,s),o}function i(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function a(){}function r(){}function o(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function l(e){function n(t,a,r,o){var s=i(e[t],e,a);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&g.call(c,"__await")?Promise.resolve(c.__await).then(function(e){n("next",e,r,o)},function(e){n("throw",e,r,o)}):Promise.resolve(c).then(function(e){l.value=e,r(l)},o)}o(s.arg)}function a(e,t){function i(){return new Promise(function(i,a){n(e,t,i,a)})}return r=r?r.then(i,i):i()}"object"==typeof t.process&&t.process.domain&&(n=t.process.domain.bind(n));var r;this._invoke=a}function c(e,t,n){var a=I;return function(r,o){if(a===A)throw new Error("Generator is already running");if(a===D){if("throw"===r)throw o;return p()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var l=u(s,n);if(l){if(l===x)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===I)throw a=D,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=A;var c=i(e,t,n);if("normal"===c.type){if(a=n.done?D:C,c.arg===x)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=D,n.method="throw",n.arg=c.arg)}}}function u(e,t){var n=e.iterator[t.method];if(n===m){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=m,u(e,t),"throw"===t.method))return x;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return x}var a=i(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,x;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=m),t.delegate=null,x):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,x)}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function f(e){if(e){var t=e[S];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(g.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=m,t.done=!0,t};return i.next=i}}return{next:p}}function p(){return{value:m,done:!0}}var m,v=Object.prototype,g=v.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},S=y.iterator||"@@iterator",E=y.asyncIterator||"@@asyncIterator",b=y.toStringTag||"@@toStringTag",T="object"==typeof e,M=t.regeneratorRuntime;if(M)return void(T&&(e.exports=M));M=t.regeneratorRuntime=T?e.exports:{},M.wrap=n;var I="suspendedStart",C="suspendedYield",A="executing",D="completed",x={},R={};R[S]=function(){return this};var O=Object.getPrototypeOf,L=O&&O(O(f([])));L&&L!==v&&g.call(L,S)&&(R=L);var k=o.prototype=a.prototype=Object.create(R);r.prototype=k.constructor=o,o.constructor=r,o[b]=r.displayName="GeneratorFunction",M.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===r||"GeneratorFunction"===(t.displayName||t.name))},M.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,b in e||(e[b]="GeneratorFunction")),e.prototype=Object.create(k),e},M.awrap=function(e){return{__await:e}},s(l.prototype),l.prototype[E]=function(){return this},M.AsyncIterator=l,M.async=function(e,t,i,a){var r=new l(n(e,t,i,a));return M.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},s(k),k[b]="Generator",k[S]=function(){return this},k.toString=function(){return"[object Generator]"},M.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},M.values=f,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&g.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,i){return r.type="throw",r.arg=e,n.next=t,i&&(n.method="next",n.arg=m),!!i}if(this.done)throw e;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],r=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var o=g.call(a,"catchLoc"),s=g.call(a,"finallyLoc");if(o&&s){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return t(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&g.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=e,r.arg=t,a?(this.method="next",this.next=a.finallyLoc,x):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),x},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),x}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var a=i.arg;_(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:f(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=m),x}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,n(132))},function(e,t,n){n(624),e.exports=n(43).RegExp.escape},function(e,t,n){var i=n(9),a=n(625)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(e){return a(e)}})},function(e,t){e.exports=function(e,t){var n=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,n)}}},function(e,t,n){var i=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=function(e){var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),t.response)return JSON.parse(t.response);throw new Error("Couldn't read ./config.json")}("./config.json")["app-config"];(0,a.default)(o).forEach(function(e){r.getClient().addApplicationParameter(e,o[e])}),n(179),n(400),n(720),Ext.Loader.setConfig({enabled:!1});var s=function(){if(!window.svmx_app_started){window.svmx_app_started=!0;n(0).api.ExtensionRunner.run(void 0,"com.servicemax.client.onFrameworkLoad");var e=n(403).impl.Application,t=n(0).api.AbstractApplication;n(408),n(733),n(753),n(763),n(805),n(815),n(824),n(832),n(841),n(852),n(861),n(881),n(898);var i=new e;t.currentApp=i,i.beforeRun({handler:function(){return i.run()}})}};navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)?n(899).preflight(s):s()},function(e,t,n){n(628),e.exports=n(28).Object.keys},function(e,t,n){var i=n(86),a=n(87);n(167)("keys",function(){return function(e){return a(i(e))}})},function(e,t,n){var i=n(64),a=n(120),r=n(630);e.exports=function(e){return function(t,n,o){var s,l=i(t),c=a(l.length),u=r(o,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}},function(e,t,n){var i=n(163),a=Math.max,r=Math.min;e.exports=function(e,t){return e=i(e),e<0?a(e+t,0):r(e,t)}},function(e,t,n){n(632),e.exports=n(28).Object.getPrototypeOf},function(e,t,n){var i=n(86),a=n(234);n(167)("getPrototypeOf",function(){return function(e){return a(i(e))}})},function(e,t,n){e.exports={default:n(634),__esModule:!0}},function(e,t,n){n(123),n(170),e.exports=n(171).f("iterator")},function(e,t,n){var i=n(163),a=n(160);e.exports=function(e){return function(t,n){var r,o,s=String(a(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===c||(o=s.charCodeAt(l+1))<56320||o>57343?e?s.charAt(l):r:e?s.slice(l,l+2):o-56320+(r-55296<<10)+65536)}}},function(e,t,n){"use strict";var i=n(124),a=n(95),r=n(125),o={};n(65)(o,n(42)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(o,{next:a(1,n)}),r(e,t+" Iterator")}},function(e,t,n){var i=n(49),a=n(66),r=n(87);e.exports=n(55)?Object.defineProperties:function(e,t){a(e);for(var n,o=r(t),s=o.length,l=0;s>l;)i.f(e,n=o[l++],t[n]);return e}},function(e,t,n){var i=n(48).document;e.exports=i&&i.documentElement},function(e,t,n){"use strict";var i=n(640),a=n(236),r=n(96),o=n(64);e.exports=n(169)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,a(1)):"keys"==t?a(0,n):"values"==t?a(0,e[n]):a(0,[n,e[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports=function(){}},function(e,t,n){e.exports={default:n(642),__esModule:!0}},function(e,t,n){n(643),n(239),n(646),n(647),e.exports=n(28).Symbol},function(e,t,n){"use strict";var i=n(48),a=n(78),r=n(55),o=n(34),s=n(235),l=n(172).KEY,c=n(80),u=n(165),d=n(125),_=n(122),h=n(42),f=n(171),p=n(173),m=n(644),v=n(237),g=n(66),y=n(59),S=n(64),E=n(168),b=n(95),T=n(124),M=n(645),I=n(175),C=n(49),A=n(87),D=I.f,x=C.f,R=M.f,O=i.Symbol,L=i.JSON,k=L&&L.stringify,N=h("_hidden"),w=h("toPrimitive"),F={}.propertyIsEnumerable,P=u("symbol-registry"),q=u("symbols"),V=u("op-symbols"),B=Object.prototype,j="function"==typeof O,H=i.QObject,z=!H||!H.prototype||!H.prototype.findChild,U=r&&c(function(){return 7!=T(x({},"a",{get:function(){return x(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=D(B,t);i&&delete B[t],x(e,t,n),i&&e!==B&&x(B,t,i)}:x,Y=function(e){var t=q[e]=T(O.prototype);return t._k=e,t},W=j&&"symbol"==typeof O.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof O},G=function(e,t,n){return e===B&&G(V,t,n),g(e),t=E(t,!0),g(n),a(q,t)?(n.enumerable?(a(e,N)&&e[N][t]&&(e[N][t]=!1),n=T(n,{enumerable:b(0,!1)})):(a(e,N)||x(e,N,b(1,{})),e[N][t]=!0),U(e,t,n)):x(e,t,n)},X=function(e,t){g(e);for(var n,i=m(t=S(t)),a=0,r=i.length;r>a;)G(e,n=i[a++],t[n]);return e},Q=function(e,t){return void 0===t?T(e):X(T(e),t)},J=function(e){var t=F.call(this,e=E(e,!0));return!(this===B&&a(q,e)&&!a(V,e))&&(!(t||!a(this,e)||!a(q,e)||a(this,N)&&this[N][e])||t)},K=function(e,t){if(e=S(e),t=E(t,!0),e!==B||!a(q,t)||a(V,t)){var n=D(e,t);return!n||!a(q,t)||a(e,N)&&e[N][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=R(S(e)),i=[],r=0;n.length>r;)a(q,t=n[r++])||t==N||t==l||i.push(t);return i},Z=function(e){for(var t,n=e===B,i=R(n?V:S(e)),r=[],o=0;i.length>o;)!a(q,t=i[o++])||n&&!a(B,t)||r.push(q[t]);return r};j||(O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var e=_(arguments.length>0?arguments[0]:void 0),t=function(n){this===B&&t.call(V,n),a(this,N)&&a(this[N],e)&&(this[N][e]=!1),U(this,e,b(1,n))};return r&&z&&U(B,e,{configurable:!0,set:t}),Y(e)},s(O.prototype,"toString",function(){return this._k}),I.f=K,C.f=G,n(238).f=M.f=$,n(97).f=J,n(174).f=Z,r&&!n(121)&&s(B,"propertyIsEnumerable",J,!0),f.f=function(e){return Y(h(e))}),o(o.G+o.W+o.F*!j,{Symbol:O});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)h(ee[te++]);for(var ne=A(h.store),ie=0;ne.length>ie;)p(ne[ie++]);o(o.S+o.F*!j,"Symbol",{for:function(e){return a(P,e+="")?P[e]:P[e]=O(e)},keyFor:function(e){if(!W(e))throw TypeError(e+" is not a symbol!");for(var t in P)if(P[t]===e)return t},useSetter:function(){z=!0},useSimple:function(){z=!1}}),o(o.S+o.F*!j,"Object",{create:Q,defineProperty:G,defineProperties:X,getOwnPropertyDescriptor:K,getOwnPropertyNames:$,getOwnPropertySymbols:Z}),L&&o(o.S+o.F*(!j||c(function(){var e=O();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){for(var t,n,i=[e],a=1;arguments.length>a;)i.push(arguments[a++]);if(n=t=i[1],(y(t)||void 0!==e)&&!W(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!W(t))return t}),i[1]=t,k.apply(L,i)}}),O.prototype[w]||n(65)(O.prototype,w,O.prototype.valueOf),d(O,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},function(e,t,n){var i=n(87),a=n(174),r=n(97);e.exports=function(e){var t=i(e),n=a.f;if(n)for(var o,s=n(e),l=r.f,c=0;s.length>c;)l.call(e,o=s[c++])&&t.push(o);return t}},function(e,t,n){var i=n(64),a=n(238).f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return a(e)}catch(e){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==r.call(e)?s(e):a(i(e))}},function(e,t,n){n(173)("asyncIterator")},function(e,t,n){n(173)("observable")},function(e,t,n){e.exports={default:n(649),__esModule:!0}},function(e,t,n){n(650),e.exports=n(28).Object.setPrototypeOf},function(e,t,n){var i=n(34);i(i.S,"Object",{setPrototypeOf:n(651).set})},function(e,t,n){var i=n(59),a=n(66),r=function(e,t){if(a(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=n(79)(Function.call,n(175).f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},function(e,t,n){n(653);var i=n(28).Object;e.exports=function(e,t){return i.create(e,t)}},function(e,t,n){var i=n(34);i(i.S,"Object",{create:n(124)})},function(e,t,n){n(655);var i=n(28).Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},function(e,t,n){var i=n(34);i(i.S+i.F*!n(55),"Object",{defineProperty:n(49).f})},function(e,t,n){n(657),e.exports=n(28).Object.assign},function(e,t,n){var i=n(34);i(i.S+i.F,"Object",{assign:n(658)})},function(e,t,n){"use strict";var i=n(87),a=n(174),r=n(97),o=n(86),s=n(161),l=Object.assign;e.exports=!l||n(80)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=i})?function(e,t){for(var n=o(e),l=arguments.length,c=1,u=a.f,d=r.f;l>c;)for(var _,h=s(arguments[c++]),f=u?i(h).concat(u(h)):i(h),p=f.length,m=0;p>m;)d.call(h,_=f[m++])&&(n[_]=h[_]);return n}:l},function(e,t,n){n(123),n(660),e.exports=n(28).Array.from},function(e,t,n){"use strict";var i=n(79),a=n(34),r=n(86),o=n(241),s=n(242),l=n(120),c=n(661),u=n(178);a(a.S+a.F*!n(662)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,a,d,_=r(e),h="function"==typeof this?this:Array,f=arguments.length,p=f>1?arguments[1]:void 0,m=void 0!==p,v=0,g=u(_);if(m&&(p=i(p,f>2?arguments[2]:void 0,2)),void 0==g||h==Array&&s(g))for(t=l(_.length),n=new h(t);t>v;v++)c(n,v,m?p(_[v],v):_[v]);else for(d=g.call(_),n=new h;!(a=d.next()).done;v++)c(n,v,m?o(d,p,[a.value,v],!0):a.value);return n.length=v,n}})},function(e,t,n){"use strict";var i=n(49),a=n(95);e.exports=function(e,t,n){t in e?i.f(e,t,a(0,n)):e[t]=n}},function(e,t,n){var i=n(42)("iterator"),a=!1;try{var r=[7][i]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var r=[7],o=r[i]();o.next=function(){return{done:n=!0}},r[i]=function(){return o},e(r)}catch(e){}return n}},function(e,t,n){var i=n(28),a=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},function(e,t,n){e.exports={default:n(665),__esModule:!0}},function(e,t,n){n(666);var i=n(28).Object;e.exports=function(e,t){return i.getOwnPropertyDescriptor(e,t)}},function(e,t,n){var i=n(64),a=n(175).f;n(167)("getOwnPropertyDescriptor",function(){return function(e,t){return a(i(e),t)}})},function(e,t,n){(e.exports=n(668)).tz.load(n(671))},function(e,t,n){var i,a,r;//! moment-timezone.js
//! version : 0.5.13
//! Copyright (c) JS Foundation and other contributors
//! license : MIT
//! github.com/moment/moment-timezone
!function(o,s){"use strict";a=[n(8)],i=s,void 0!==(r="function"==typeof i?i.apply(t,a):i)&&(e.exports=r)}(0,function(e){"use strict";function t(e){return e>96?e-87:e>64?e-29:e-48}function n(e){var n,i=0,a=e.split("."),r=a[0],o=a[1]||"",s=1,l=0,c=1;for(45===e.charCodeAt(0)&&(i=1,c=-1),i;i<r.length;i++)n=t(r.charCodeAt(i)),l=60*l+n;for(i=0;i<o.length;i++)s/=60,n=t(o.charCodeAt(i)),l+=n*s;return l*c}function i(e){for(var t=0;t<e.length;t++)e[t]=n(e[t])}function a(e,t){for(var n=0;n<t;n++)e[n]=Math.round((e[n-1]||0)+6e4*e[n]);e[t-1]=1/0}function r(e,t){var n,i=[];for(n=0;n<t.length;n++)i[n]=e[t[n]];return i}function o(e){var t=e.split("|"),n=t[2].split(" "),o=t[3].split(""),s=t[4].split(" ");return i(n),i(o),i(s),a(s,o.length),{name:t[0],abbrs:r(t[1].split(" "),o),offsets:r(n,o),untils:s,population:0|t[5]}}function s(e){e&&this._set(o(e))}function l(e){var t=e.toTimeString(),n=t.match(/\([a-z ]+\)/i);n&&n[0]?(n=n[0].match(/[A-Z]/g),n=n?n.join(""):void 0):(n=t.match(/[A-Z]{3,5}/g),n=n?n[0]:void 0),"GMT"===n&&(n=void 0),this.at=+e,this.abbr=n,this.offset=e.getTimezoneOffset()}function c(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function u(e,t){for(var n,i;i=6e4*((t.at-e.at)/12e4|0);)n=new l(new Date(e.at+i)),n.offset===e.offset?e=n:t=n;return e}function d(){var e,t,n,i=(new Date).getFullYear()-2,a=new l(new Date(i,0,1)),r=[a];for(n=1;n<48;n++)t=new l(new Date(i,n,1)),t.offset!==a.offset&&(e=u(a,t),r.push(e),r.push(new l(new Date(e.at+6e4)))),a=t;for(n=0;n<4;n++)r.push(new l(new Date(i+n,0,1))),r.push(new l(new Date(i+n,6,1)));return r}function _(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:t.zone.population-e.zone.population}function h(e,t){var n,a;for(i(t),n=0;n<t.length;n++)a=t[n],L[a]=L[a]||{},L[a][e]=!0}function f(e){var t,n,i,a=e.length,r={},o=[];for(t=0;t<a;t++){i=L[e[t].offset]||{};for(n in i)i.hasOwnProperty(n)&&(r[n]=!0)}for(t in r)r.hasOwnProperty(t)&&o.push(O[t]);return o}function p(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e){var t=O[v(e)];if(t)return t;I("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var n,i,a,r=d(),o=r.length,s=f(r),l=[];for(i=0;i<s.length;i++){for(n=new c(y(s[i]),o),a=0;a<o;a++)n.scoreOffsetAt(r[a]);l.push(n)}return l.sort(_),l.length>0?l[0].zone.name:void 0}function m(e){return D&&!e||(D=p()),D}function v(e){return(e||"").toLowerCase().replace(/\//g,"_")}function g(e){var t,n,i,a;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)i=e[t].split("|"),n=i[0],a=v(n),x[a]=e[t],O[a]=n,i[5]&&h(a,i[2].split(" "))}function y(e,t){e=v(e);var n,i=x[e];return i instanceof s?i:"string"==typeof i?(i=new s(i),x[e]=i,i):R[e]&&t!==y&&(n=y(R[e],y))?(i=x[e]=new s,i._set(n),i.name=O[e],i):null}function S(){var e,t=[];for(e in O)O.hasOwnProperty(e)&&(x[e]||x[R[e]])&&O[e]&&t.push(O[e]);return t.sort()}function E(e){var t,n,i,a;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=e[t].split("|"),i=v(n[0]),a=v(n[1]),R[i]=a,O[i]=n[0],R[a]=i,O[a]=n[1]}function b(e){g(e.zones),E(e.links),C.dataVersion=e.version}function T(e){return T.didShowError||(T.didShowError=!0,I("moment.tz.zoneExists('"+e+"') has been deprecated in favor of !moment.tz.zone('"+e+"')")),!!y(e)}function M(e){return!(!e._a||void 0!==e._tzm)}function I(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function C(t){var n=Array.prototype.slice.call(arguments,0,-1),i=arguments[arguments.length-1],a=y(i),r=e.utc.apply(null,n);return a&&!e.isMoment(t)&&M(r)&&r.add(a.parse(r),"minutes"),r.tz(i),r}function A(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}var D,x={},R={},O={},L={},k=e.version.split("."),N=+k[0],w=+k[1];(N<2||2===N&&w<6)&&I("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+e.version+". See momentjs.com"),s.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,n=+e,i=this.untils;for(t=0;t<i.length;t++)if(n<i[t])return t},parse:function(e){var t,n,i,a,r=+e,o=this.offsets,s=this.untils,l=s.length-1;for(a=0;a<l;a++)if(t=o[a],n=o[a+1],i=o[a?a-1:a],t<n&&C.moveAmbiguousForward?t=n:t>i&&C.moveInvalidForward&&(t=i),r<s[a]-6e4*t)return o[a];return o[l]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return this.offsets[this._index(e)]}},c.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.offset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},C.version="0.5.13",C.dataVersion="",C._zones=x,C._links=R,C._names=O,C.add=g,C.link=E,C.load=b,C.zone=y,C.zoneExists=T,C.guess=m,C.names=S,C.Zone=s,C.unpack=o,C.unpackBase60=n,C.needsOffset=M,C.moveInvalidForward=!0,C.moveAmbiguousForward=!1;var F=e.fn;e.tz=C,e.defaultZone=null,e.updateOffset=function(t,n){var i,a=e.defaultZone;void 0===t._z&&(a&&M(t)&&!t._isUTC&&(t._d=e.utc(t._a)._d,t.utc().add(a.parse(t),"minutes")),t._z=a),t._z&&(i=t._z.offset(t),Math.abs(i)<16&&(i/=60),void 0!==t.utcOffset?t.utcOffset(-i,n):t.zone(i,n))},F.tz=function(t){return t?(this._z=y(t),this._z?e.updateOffset(this):I("Moment Timezone has no data for "+t+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},F.zoneName=A(F.zoneName),F.zoneAbbr=A(F.zoneAbbr),F.utc=function(e){return function(){return this._z=null,e.apply(this,arguments)}}(F.utc),e.tz.setDefault=function(t){return(N<2||2===N&&w<9)&&I("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+e.version+"."),e.defaultZone=t?y(t):null,e};var P=e.momentProperties;return"[object Array]"===Object.prototype.toString.call(P)?(P.push("_z"),P.push("_a")):P&&(P._z=null),e})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){function i(e){return n(a(e))}function a(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./af":245,"./af.js":245,"./ar":246,"./ar-dz":247,"./ar-dz.js":247,"./ar-kw":248,"./ar-kw.js":248,"./ar-ly":249,"./ar-ly.js":249,"./ar-ma":250,"./ar-ma.js":250,"./ar-sa":251,"./ar-sa.js":251,"./ar-tn":252,"./ar-tn.js":252,"./ar.js":246,"./az":253,"./az.js":253,"./be":254,"./be.js":254,"./bg":255,"./bg.js":255,"./bm":256,"./bm.js":256,"./bn":257,"./bn.js":257,"./bo":258,"./bo.js":258,"./br":259,"./br.js":259,"./bs":260,"./bs.js":260,"./ca":261,"./ca.js":261,"./cs":262,"./cs.js":262,"./cv":263,"./cv.js":263,"./cy":264,"./cy.js":264,"./da":265,"./da.js":265,"./de":266,"./de-at":267,"./de-at.js":267,"./de-ch":268,"./de-ch.js":268,"./de.js":266,"./dv":269,"./dv.js":269,"./el":270,"./el.js":270,"./en-SG":271,"./en-SG.js":271,"./en-au":272,"./en-au.js":272,"./en-ca":273,"./en-ca.js":273,"./en-gb":274,"./en-gb.js":274,"./en-ie":275,"./en-ie.js":275,"./en-il":276,"./en-il.js":276,"./en-nz":277,"./en-nz.js":277,"./eo":278,"./eo.js":278,"./es":279,"./es-do":280,"./es-do.js":280,"./es-us":281,"./es-us.js":281,"./es.js":279,"./et":282,"./et.js":282,"./eu":283,"./eu.js":283,"./fa":284,"./fa.js":284,"./fi":285,"./fi.js":285,"./fo":286,"./fo.js":286,"./fr":287,"./fr-ca":288,"./fr-ca.js":288,"./fr-ch":289,"./fr-ch.js":289,"./fr.js":287,"./fy":290,"./fy.js":290,"./ga":291,"./ga.js":291,"./gd":292,"./gd.js":292,"./gl":293,"./gl.js":293,"./gom-latn":294,"./gom-latn.js":294,"./gu":295,"./gu.js":295,"./he":296,"./he.js":296,"./hi":297,"./hi.js":297,"./hr":298,"./hr.js":298,"./hu":299,"./hu.js":299,"./hy-am":300,"./hy-am.js":300,"./id":301,"./id.js":301,"./is":302,"./is.js":302,"./it":303,"./it-ch":304,"./it-ch.js":304,"./it.js":303,"./ja":305,"./ja.js":305,"./jv":306,"./jv.js":306,"./ka":307,"./ka.js":307,"./kk":308,"./kk.js":308,"./km":309,"./km.js":309,"./kn":310,"./kn.js":310,"./ko":311,"./ko.js":311,"./ku":312,"./ku.js":312,"./ky":313,"./ky.js":313,"./lb":314,"./lb.js":314,"./lo":315,"./lo.js":315,"./lt":316,"./lt.js":316,"./lv":317,"./lv.js":317,"./me":318,"./me.js":318,"./mi":319,"./mi.js":319,"./mk":320,"./mk.js":320,"./ml":321,"./ml.js":321,"./mn":322,"./mn.js":322,"./mr":323,"./mr.js":323,"./ms":324,"./ms-my":325,"./ms-my.js":325,"./ms.js":324,"./mt":326,"./mt.js":326,"./my":327,"./my.js":327,"./nb":328,"./nb.js":328,"./ne":329,"./ne.js":329,"./nl":330,"./nl-be":331,"./nl-be.js":331,"./nl.js":330,"./nn":332,"./nn.js":332,"./pa-in":333,"./pa-in.js":333,"./pl":334,"./pl.js":334,"./pt":335,"./pt-br":336,"./pt-br.js":336,"./pt.js":335,"./ro":337,"./ro.js":337,"./ru":338,"./ru.js":338,"./sd":339,"./sd.js":339,"./se":340,"./se.js":340,"./si":341,"./si.js":341,"./sk":342,"./sk.js":342,"./sl":343,"./sl.js":343,"./sq":344,"./sq.js":344,"./sr":345,"./sr-cyrl":346,"./sr-cyrl.js":346,"./sr.js":345,"./ss":347,"./ss.js":347,"./sv":348,"./sv.js":348,"./sw":349,"./sw.js":349,"./ta":350,"./ta.js":350,"./te":351,"./te.js":351,"./tet":352,"./tet.js":352,"./tg":353,"./tg.js":353,"./th":354,"./th.js":354,"./tl-ph":355,"./tl-ph.js":355,"./tlh":356,"./tlh.js":356,"./tr":357,"./tr.js":357,"./tzl":358,"./tzl.js":358,"./tzm":359,"./tzm-latn":360,"./tzm-latn.js":360,"./tzm.js":359,"./ug-cn":361,"./ug-cn.js":361,"./uk":362,"./uk.js":362,"./ur":363,"./ur.js":363,"./uz":364,"./uz-latn":365,"./uz-latn.js":365,"./uz.js":364,"./vi":366,"./vi.js":366,"./x-pseudo":367,"./x-pseudo.js":367,"./yo":368,"./yo.js":368,"./zh-cn":369,"./zh-cn.js":369,"./zh-hk":370,"./zh-hk.js":370,"./zh-tw":371,"./zh-tw.js":371};i.keys=function(){return Object.keys(r)},i.resolve=a,e.exports=i,i.id=670},function(e,t){e.exports={version:"2017b",zones:["Africa/Abidjan|LMT GMT|g.8 0|01|-2ldXH.Q|48e5","Africa/Accra|LMT GMT +0020|.Q 0 -k|012121212121212121212121212121212121212121212121|-26BbX.8 6tzX.8 MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE|41e5","Africa/Nairobi|LMT EAT +0230 +0245|-2r.g -30 -2u -2J|01231|-1F3Cr.g 3Dzr.g okMu MFXJ|47e5","Africa/Algiers|PMT WET WEST CET CEST|-9.l 0 -10 -10 -20|0121212121212121343431312123431213|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 DA0 Imo0 rd0 De0 9Xz0 1fb0 1ap0 16K0 2yo0 mEp0 hwL0 jxA0 11A0 dDd0 17b0 11B0 1cN0 2Dy0 1cN0 1fB0 1cL0|26e5","Africa/Lagos|LMT WAT|-d.A -10|01|-22y0d.A|17e6","Africa/Bissau|LMT -01 GMT|12.k 10 0|012|-2ldWV.E 2xonV.E|39e4","Africa/Maputo|LMT CAT|-2a.k -20|01|-2GJea.k|26e5","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1bIO0 vb0 1ip0 11z0 1iN0 1nz0 12p0 1pz0 10N0 1pz0 16p0 1jz0 s3d0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1WL0 rd0 1Rz0 wp0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1qL0 Xd0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1ny0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 WL0 1qN0 Rb0 1wp0 On0 1zd0 Lz0 1EN0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0|15e6","Africa/Casablanca|LMT WET WEST CET|u.k 0 -10 -10|0121212121212121213121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2gMnt.E 130Lt.E rb0 Dd0 dVb0 b6p0 TX0 EoB0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4mn0 SyN0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00 1a00 1fA0 17c0 1io0 14o0 1lc0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1lc0 14o0 1fA0|32e5","Africa/Ceuta|WET WEST CET CEST|0 -10 -10 -20|010101010101010101010232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-25KN0 11z0 drd0 18p0 3HX0 17d0 1fz0 1a10 1io0 1a00 1y7o0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4VB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|85e3","Africa/El_Aaiun|LMT -01 WET WEST|Q.M 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1rDz7.c 1GVA7.c 6L0 AL0 1Nd0 XX0 1Cp0 pz0 1cBB0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 Rc0 11A0 e00 e00 U00 11A0 8o0 e00 11A0 11A0 5A0 e00 17c0 1fA0 1a00 1a00 1fA0 17c0 1io0 14o0 1lc0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1lc0 14o0 1fA0|20e4","Africa/Johannesburg|SAST SAST SAST|-1u -20 -30|012121|-2GJdu 1Ajdu 1cL0 1cN0 1cL0|84e5","Africa/Khartoum|LMT CAT CAST EAT|-2a.8 -20 -30 -30|01212121212121212121212121212121213|-1yW2a.8 1zK0a.8 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0|51e5","Africa/Monrovia|MMT MMT GMT|H.8 I.u 0|012|-23Lzg.Q 28G01.m|11e5","Africa/Ndjamena|LMT WAT WAST|-10.c -10 -20|0121|-2le10.c 2J3c0.c Wn0|13e5","Africa/Tripoli|LMT CET CEST EET|-Q.I -10 -20 -20|012121213121212121212121213123123|-21JcQ.I 1hnBQ.I vx0 4iP0 xx0 4eN0 Bb0 7ip0 U0n0 A10 1db0 1cN0 1db0 1dd0 1db0 1eN0 1bb0 1e10 1cL0 1c10 1db0 1dd0 1db0 1cN0 1db0 1q10 fAn0 1ep0 1db0 AKq0 TA0 1o00|11e5","Africa/Tunis|PMT CET CEST|-9.l -10 -20|0121212121212121212121212121212121|-2nco9.l 18pa9.l 1qM0 DA0 3Tc0 11B0 1ze0 WM0 7z0 3d0 14L0 1cN0 1f90 1ar0 16J0 1gXB0 WM0 1rA0 11c0 nwo0 Ko0 1cM0 1cM0 1rA0 10M0 zuM0 10N0 1aN0 1qM0 WM0 1qM0 11A0 1o00|20e5","Africa/Windhoek|+0130 SAST SAST CAT WAT WAST|-1u -20 -30 -20 -10 -20|012134545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2GJdu 1Ajdu 1cL0 1SqL0 9NA0 11D0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0|32e4","America/Adak|NST NWT NPT BST BDT AHST HST HDT|b0 a0 a0 b0 a0 a0 a0 90|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AST AWT APT AHST AHDT YST AKST AKDT|a0 90 90 a0 90 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T00 8wX0 iA0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Port_of_Spain|LMT AST|46.4 40|01|-2kNvR.U|43e3","America/Araguaina|LMT -03 -02|3c.M 30 20|0121212121212121212121212121212121212121212121212121|-2glwL.c HdKL.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 ny10 Lz0|14e4","America/Argentina/Buenos_Aires|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 A4p0 uL0 1qN0 WL0","America/Argentina/Catamarca|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323132321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Cordoba|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323132323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 A4p0 uL0 1qN0 WL0","America/Argentina/Jujuy|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323121323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1ze0 TX0 1ld0 WK0 1wp0 TX0 A4p0 uL0","America/Argentina/La_Rioja|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Mendoza|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232312121321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1u20 SL0 1vd0 Tb0 1wp0 TW0 ri10 Op0 7TX0 uL0","America/Argentina/Rio_Gallegos|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 rlB0 7B0 8zb0 uL0","America/Argentina/Salta|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231323232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 A4p0 uL0","America/Argentina/San_Juan|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323231232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 rld0 m10 8lb0 uL0","America/Argentina/San_Luis|CMT -04 -03 -02|4g.M 40 30 20|012121212121212121212121212121212121212121232323121212321212|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 XX0 1q20 SL0 AN0 vDb0 m10 8lb0 8L0 jd0 1qN0 WL0 1qN0","America/Argentina/Tucuman|CMT -04 -03 -02|4g.M 40 30 20|0121212121212121212121212121212121212121212323232313232123232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 rlB0 4N0 8BX0 uL0 1qN0 WL0","America/Argentina/Ushuaia|CMT -04 -03 -02|4g.M 40 30 20|01212121212121212121212121212121212121212123232323232321232|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 rkN0 8p0 8zb0 uL0","America/Curacao|LMT -0430 AST|4z.L 4u 40|012|-2kV7o.d 28KLS.d|15e4","America/Asuncion|AMT -04 -03|3O.E 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-1x589.k 1DKM9.k 3CL0 3Dd0 10L0 1pB0 10n0 1pB0 10n0 1pB0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1lB0 14n0 1dd0 1cL0 1fd0 WL0 1rd0 1aL0 1dB0 Xz0 1qp0 Xb0 1qN0 10L0 1rB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 WN0 1qL0 11B0 1nX0 1ip0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 TX0 1tB0 19X0 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Atikokan|CST CDT CWT CPT EST|60 50 50 50 50|0101234|-25TQ0 1in0 Rnb0 3je0 8x30 iw0|28e2","America/Bahia|LMT -03 -02|2y.4 30 20|01212121212121212121212121212121212121212121212121212121212121|-2glxp.U HdLp.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 l5B0 Rb0|27e5","America/Bahia_Banderas|LMT MST CST PST MDT CDT|71 70 60 80 60 50|0121212131414141414141414141414141414152525252525252525252525252525252525252525252525252525252|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|84e3","America/Barbados|LMT BMT AST ADT|3W.t 3W.t 40 30|01232323232|-1Q0I1.v jsM0 1ODC1.v IL0 1ip0 17b0 1ip0 17b0 1ld0 13b0|28e4","America/Belem|LMT -03 -02|3d.U 30 20|012121212121212121212121212121|-2glwK.4 HdKK.4 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|20e5","America/Belize|LMT CST -0530 CDT|5Q.M 60 5u 50|01212121212121212121212121212121212121212121212121213131|-2kBu7.c fPA7.c Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1f0Mu qn0 lxB0 mn0|57e3","America/Blanc-Sablon|AST ADT AWT APT|40 30 30 30|010230|-25TS0 1in0 UGp0 8x50 iu0|11e2","America/Boa_Vista|LMT -04 -03|42.E 40 30|0121212121212121212121212121212121|-2glvV.k HdKV.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 smp0 WL0 1tB0 2L0|62e2","America/Bogota|BMT -05 -04|4U.g 50 40|0121|-2eb73.I 38yo3.I 2en0|90e5","America/Boise|PST PDT MST MWT MPT MDT|80 70 70 60 60 60|0101023425252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-261q0 1nX0 11B0 1nX0 8C10 JCL0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 Dd0 1Kn0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e4","America/Cambridge_Bay|-00 MST MWT MPT MDDT MDT CST CDT EST|0 70 60 60 50 60 60 50 50|0123141515151515151515151515151515151515151515678651515151515151515151515151515151515151515151515151515151515151515151515151|-21Jc0 RO90 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11A0 1nX0 2K0 WQ0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e2","America/Campo_Grande|LMT -04 -03|3C.s 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwl.w HdLl.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0|77e4","America/Cancun|LMT CST EST EDT CDT|5L.4 60 50 40 50|0123232341414141414141414141414141414141412|-1UQG0 2q2o0 yLB0 1lb0 14p0 1lb0 14p0 Lz0 xB0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|CMT -0430 -04|4r.E 4u 40|01212|-2kV7w.k 28KM2.k 1IwOu kqo0|29e5","America/Cayenne|LMT -04 -03|3t.k 40 30|012|-2mrwu.E 2gWou.E|58e3","America/Panama|CMT EST|5j.A 50|01|-2uduE.o|15e5","America/Chicago|CST CDT EST CWT CPT|60 50 50 50 50|01010101010101010101010101010101010102010101010103401010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 1wp0 TX0 WN0 1qL0 1cN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 11B0 1Hz0 14p0 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|LMT MST CST CDT MDT|74.k 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|81e4","America/Costa_Rica|SJMT CST CDT|5A.d 60 50|0121212121|-1Xd6n.L 2lu0n.L Db0 1Kp0 Db0 pRB0 15b0 1kp0 mL0|12e5","America/Creston|MST PST|70 80|010|-29DR0 43B0|53e2","America/Cuiaba|LMT -04 -03|3I.k 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwf.E HdLf.E 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 4a10 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0|54e4","America/Danmarkshavn|LMT -03 -02 GMT|1e.E 30 20 0|01212121212121212121212121212121213|-2a5WJ.k 2z5fJ.k 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 DC0|8","America/Dawson|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 jrA0 fNd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|13e2","America/Dawson_Creek|PST PDT PWT PPT MST|80 70 70 70 70|0102301010101010101010101010101010101010101010101010101014|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 ML0|12e3","America/Denver|MST MDT MWT MPT|70 60 60 60|01010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 11B0 1qL0 WN0 mn0 Ord0 8x20 ix0 LCN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Detroit|LMT CST EST EWT EPT EDT|5w.b 60 50 40 40 40|01234252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2Cgir.N peqr.N 156L0 8x40 iv0 6fd0 11z0 Jy10 SL0 dnB0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e5","America/Edmonton|LMT MST MDT MWT MPT|7x.Q 70 60 60 60|01212121212121341212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2yd4q.8 shdq.8 1in0 17d0 hz0 2dB0 1fz0 1a10 11z0 1qN0 WL0 1qN0 11z0 IGN0 8x20 ix0 3NB0 11z0 LFB0 1cL0 3Cp0 1cL0 66N0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|10e5","America/Eirunepe|LMT -05 -04|4D.s 50 40|0121212121212121212121212121212121|-2glvk.w HdLk.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0 yTd0 d5X0|31e3","America/El_Salvador|LMT CST CDT|5U.M 60 50|012121|-1XiG3.c 2Fvc3.c WL0 1qN0 WL0|11e5","America/Tijuana|LMT MST PST PDT PWT PPT|7M.4 70 80 70 70 70|012123245232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQE0 4PX0 8mM0 8lc0 SN0 1cL0 pHB0 83r0 zI0 5O10 1Rz0 cOO0 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 BUp0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|20e5","America/Fort_Nelson|PST PDT PWT PPT MST|80 70 70 70 70|01023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Fort_Wayne|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010101023010101010101010101040454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 QI10 Db0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 5Tz0 1o10 qLb0 1cL0 1cN0 1cL0 1qhd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Fortaleza|LMT -03 -02|2y 30 20|0121212121212121212121212121212121212121|-2glxq HdLq 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 5z0 2mN0 On0|34e5","America/Glace_Bay|LMT AST ADT AWT APT|3X.M 40 30 30 30|012134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsI0.c CwO0.c 1in0 UGp0 8x50 iu0 iq10 11z0 Jg10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","America/Godthab|LMT -03 -02|3q.U 30 20|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5Ux.4 2z5dx.4 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e3","America/Goose_Bay|NST NDT NST NDT NWT NPT AST ADT ADDT|3u.Q 2u.Q 3u 2u 2u 2u 40 30 20|010232323232323245232323232323232323232323232323232323232326767676767676767676767676767676767676767676768676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-25TSt.8 1in0 DXb0 2HbX.8 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 S10 g0u 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|76e2","America/Grand_Turk|KMT EST EDT AST|57.b 50 40 40|0121212121212121212121212121212121212121212121212121212121212121212121212123|-2l1uQ.N 2HHBQ.N 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Guatemala|LMT CST CDT|62.4 60 50|0121212121|-24KhV.U 2efXV.U An0 mtd0 Nz0 ifB0 17b0 zDB0 11z0|13e5","America/Guayaquil|QMT -05 -04|5e 50 40|0121|-1yVSK 2uILK rz0|27e5","America/Guyana|LMT -0345 -03 -04|3Q.E 3J 30 40|0123|-2dvU7.k 2r6LQ.k Bxbf|80e4","America/Halifax|LMT AST ADT AWT APT|4e.o 40 30 30 30|0121212121212121212121212121212121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsHJ.A xzzJ.A 1db0 3I30 1in0 3HX0 IL0 1E10 ML0 1yN0 Pb0 1Bd0 Mn0 1Bd0 Rz0 1w10 Xb0 1w10 LX0 1w10 Xb0 1w10 Lz0 1C10 Jz0 1E10 OL0 1yN0 Un0 1qp0 Xb0 1qp0 11X0 1w10 Lz0 1HB0 LX0 1C10 FX0 1w10 Xb0 1qp0 Xb0 1BB0 LX0 1td0 Xb0 1qp0 Xb0 Rf0 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 6i10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Havana|HMT CST CDT|5t.A 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Meuu.o 72zu.o ML0 sld0 An0 1Nd0 Db0 1Nd0 An0 6Ep0 An0 1Nd0 An0 JDd0 Mn0 1Ap0 On0 1fd0 11X0 1qN0 WL0 1wp0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 14n0 1ld0 14L0 1kN0 15b0 1kp0 1cL0 1cN0 1fz0 1a10 1fz0 1fB0 11z0 14p0 1nX0 11B0 1nX0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 1a10 1in0 1a10 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 17c0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 11A0 6i00 Rc0 1wo0 U00 1tA0 Rc0 1wo0 U00 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Hermosillo|LMT MST CST PST MDT|7n.Q 70 60 80 60|0121212131414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0|64e4","America/Indiana/Knox|CST CDT CWT CPT EST|60 50 50 50 50|0101023010101010101010101010101010101040101010101010101010101010101010101010101010101010141010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 3Cn0 8wp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 z8o0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Marengo|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010104545454545414545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 dyN0 11z0 6fd0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1e6p0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Petersburg|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010104010101010101010101010141014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 njX0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 3Fb0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 19co0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Tell_City|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vevay|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010102304545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 kPB0 Awn0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1lnd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vincennes|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Winamac|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010101010454541054545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1za0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Inuvik|-00 PST PDDT MST MDT|0 80 60 70 60|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-FnA0 tWU0 1fA0 wPe0 2pz0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|35e2","America/Iqaluit|-00 EWT EPT EST EDDT EDT CST CDT|0 40 40 50 30 40 60 50|01234353535353535353535353535353535353535353567353535353535353535353535353535353535353535353535353535353535353535353535353|-16K00 7nX0 iv0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|67e2","America/Jamaica|KMT EST EDT|57.b 50 40|0121212121212121212121|-2l1uQ.N 2uM1Q.N 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0|94e4","America/Juneau|PST PWT PPT PDT YDT YST AKST AKDT|80 70 70 70 80 90 90 80|01203030303030303030303030403030356767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cM0 1cM0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|33e3","America/Kentucky/Louisville|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101010102301010101010101010101010101454545454545414545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 3Fd0 Nb0 LPd0 11z0 RB0 8x30 iw0 Bb0 10N0 2bB0 8in0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 xz0 gso0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Kentucky/Monticello|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 SWp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/La_Paz|CMT BOST -04|4w.A 3w.A 40|012|-1x37r.o 13b0|19e5","America/Lima|LMT -05 -04|58.A 50 40|0121212121212121|-2tyGP.o 1bDzP.o zX0 1aN0 1cL0 1cN0 1cL0 1PrB0 zX0 1O10 zX0 6Gp0 zX0 98p0 zX0|11e6","America/Los_Angeles|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 5Wp1 1VaX 3dA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/Maceio|LMT -03 -02|2m.Q 30 20|012121212121212121212121212121212121212121|-2glxB.8 HdLB.8 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 8Q10 WL0 1tB0 5z0 2mN0 On0|93e4","America/Managua|MMT CST EST CDT|5J.c 60 50 50|0121313121213131|-1quie.M 1yAMe.M 4mn0 9Up0 Dz0 1K10 Dz0 s3F0 1KH0 DB0 9In0 k8p0 19X0 1o30 11y0|22e5","America/Manaus|LMT -04 -03|40.4 40 30|01212121212121212121212121212121|-2glvX.U HdKX.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0|19e5","America/Martinique|FFMT AST ADT|44.k 40 30|0121|-2mPTT.E 2LPbT.E 19X0|39e4","America/Matamoros|LMT CST CDT|6E 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|45e4","America/Mazatlan|LMT MST CST PST MDT|75.E 70 60 80 60|0121212131414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|44e4","America/Menominee|CST CDT CWT CPT EST|60 50 50 50 50|01010230101041010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 LCN0 1fz0 6410 9Jb0 1cM0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|85e2","America/Merida|LMT CST EST CDT|5W.s 60 50 50|0121313131313131313131313131313131313131313131313131313131313131313131313131313131313131|-1UQG0 2q2o0 2hz0 wu30 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|11e5","America/Metlakatla|PST PWT PPT PDT AKST AKDT|80 70 70 70 90 80|0120303030303030303030303030303030454545454545454545454545454545454545454545454|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1hU10 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Mexico_City|LMT MST CST CDT CWT|6A.A 70 60 50 50|012121232324232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 gEn0 TX0 3xd0 Jb0 6zB0 SL0 e5d0 17b0 1Pff0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|20e6","America/Miquelon|LMT AST -03 -02|3I.E 40 30 20|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2mKkf.k 2LTAf.k gQ10 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Moncton|EST AST ADT AWT APT|50 40 30 30 30|012121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsH0 CwN0 1in0 zAo0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1K10 Lz0 1zB0 NX0 1u10 Wn0 S20 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14n1 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 ReX 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|64e3","America/Monterrey|LMT CST CDT|6F.g 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0|41e5","America/Montevideo|MMT -0330 -03 -02 -0230|3I.I 3u 30 20 2u|012121212121212121212121213232323232324242423243232323232323232323232323232323232323232|-20UIf.g 8jzJ.g 1cLu 1dcu 1cLu 1dcu 1cLu ircu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu WLu 1qMu WLu 1qMu 11zu 1o0u 11zu NAu 11bu 2iMu zWu Dq10 19X0 pd0 jz0 cm10 19X0 1fB0 1on0 11d0 1oL0 1nB0 1fzu 1aou 1fzu 1aou 1fzu 3nAu Jb0 3MN0 1SLu 4jzu 2PB0 Lb0 3Dd0 1pb0 ixd0 An0 1MN0 An0 1wp0 On0 1wp0 Rb0 1zd0 On0 1wp0 Rb0 s8p0 1fB0 1ip0 11z0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Toronto|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101012301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 11Wu 1nzu 1fD0 WJ0 1wr0 Nb0 1Ap0 On0 1zd0 On0 1wp0 TX0 1tB0 TX0 1tB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 4kM0 8x40 iv0 1o10 11z0 1nX0 11z0 1o10 11z0 1o10 1qL0 11D0 1nX0 11B0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e5","America/Nassau|LMT EST EDT|59.u 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2kNuO.u 26XdO.u 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|24e4","America/New_York|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 11B0 1qL0 1a10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Nipigon|EST EDT EWT EPT|50 40 40 40|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 Rnb0 3je0 8x40 iv0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|16e2","America/Nome|NST NWT NPT BST BDT YST AKST AKDT|b0 a0 a0 b0 a0 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cl0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|38e2","America/Noronha|LMT -02 -01|29.E 20 10|0121212121212121212121212121212121212121|-2glxO.k HdKO.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|30e2","America/North_Dakota/Beulah|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/Center|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/New_Salem|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Ojinaga|LMT MST CST CDT MDT|6V.E 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Pangnirtung|-00 AST AWT APT ADDT ADT EDT EST CST CDT|0 40 30 30 20 30 40 50 60 50|012314151515151515151515151515151515167676767689767676767676767676767676767676767676767676767676767676767676767676767676767|-1XiM0 PnG0 8x50 iu0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1o00 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Paramaribo|LMT PMT PMT -0330 -03|3E.E 3E.Q 3E.A 3u 30|01234|-2nDUj.k Wqo0.c qanX.I 1yVXN.o|24e4","America/Phoenix|MST MDT MWT|70 60 60|01010202010|-261r0 1nX0 11B0 1nX0 SgN0 4Al1 Ap0 1db0 SWqX 1cL0|42e5","America/Port-au-Prince|PPMT EST EDT|4N 50 40|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-28RHb 2FnMb 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14q0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 i6n0 1nX0 11B0 1nX0 d430 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Rio_Branco|LMT -05 -04|4v.c 50 40|01212121212121212121212121212121|-2glvs.M HdLs.M 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0 d5X0|31e4","America/Porto_Velho|LMT -04 -03|4f.A 40 30|012121212121212121212121212121|-2glvI.o HdKI.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0|37e4","America/Puerto_Rico|AST AWT APT|40 30 30|0120|-17lU0 7XT0 iu0|24e5","America/Punta_Arenas|SMT -05 -04 -03|4G.K 50 40 30|0102021212121212121232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 blz0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0","America/Rainy_River|CST CDT CWT CPT|60 50 50 50|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TQ0 1in0 Rnb0 3je0 8x30 iw0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|842","America/Rankin_Inlet|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313131313131313131313131313131313131313131313131313131313131313131|-vDc0 keu0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e2","America/Recife|LMT -03 -02|2j.A 30 20|0121212121212121212121212121212121212121|-2glxE.o HdLE.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0|33e5","America/Regina|LMT MST MDT MWT MPT CST|6W.A 70 60 60 60 60|012121212121212121212121341212121212121212121212121215|-2AD51.o uHe1.o 1in0 s2L0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 66N0 1cL0 1cN0 19X0 1fB0 1cL0 1fB0 1cL0 1cN0 1cL0 M30 8x20 ix0 1ip0 1cL0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 3NB0 1cL0 1cN0|19e4","America/Resolute|-00 CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313431313131313131313131313131313131313131313131313131313131313131|-SnA0 GWS0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|229","America/Santarem|LMT -04 -03|3C.M 40 30|0121212121212121212121212121212|-2glwl.c HdLl.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0|21e4","America/Santiago|SMT -05 -04 -03|4G.K 50 40 30|010202121212121212321232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-2q2jh.e fJAh.e 5knG.K 1Vzh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 9Bz0 jb0 1oN0 ko0 Qeo0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|62e5","America/Santo_Domingo|SDMT EST EDT -0430 AST|4E 50 40 4u 40|01213131313131414|-1ttjk 1lJMk Mn0 6sp0 Lbu 1Cou yLu 1RAu wLu 1QMu xzu 1Q0u xXu 1PAu 13jB0 e00|29e5","America/Sao_Paulo|LMT -03 -02|36.s 30 20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwR.w HdKR.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 pTd0 PX0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0|20e6","America/Scoresbysund|LMT -02 -01 +00|1r.Q 20 10 0|0121323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2a5Ww.8 2z5ew.8 1a00 1cK0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|452","America/Sitka|PST PWT PPT PDT YST AKST AKDT|80 70 70 70 90 90 80|01203030303030303030303030303030345656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|90e2","America/St_Johns|NST NDT NST NDT NWT NPT NDDT|3u.Q 2u.Q 3u 2u 2u 2u 1u|01010101010101010101010101010101010102323232323232324523232323232323232323232323232323232323232323232323232323232323232323232323232323232326232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-28oit.8 14L0 1nB0 1in0 1gm0 Dz0 1JB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1fB0 19X0 1fB0 19X0 10O0 eKX.8 19X0 1iq0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Swift_Current|LMT MST MDT MWT MPT CST|7b.k 70 60 60 60 60|012134121212121212121215|-2AD4M.E uHdM.E 1in0 UGp0 8x20 ix0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 isN0 1cL0 3Cp0 1cL0 1cN0 11z0 1qN0 WL0 pMp0|16e3","America/Tegucigalpa|LMT CST CDT|5M.Q 60 50|01212121|-1WGGb.8 2ETcb.8 WL0 1qN0 WL0 GRd0 AL0|11e5","America/Thule|LMT AST ADT|4z.8 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5To.Q 31NBo.Q 1cL0 1cN0 1cL0 1fB0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|656","America/Thunder_Bay|CST EST EWT EPT EDT|60 50 40 40 40|0123141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-2q5S0 1iaN0 8x40 iv0 XNB0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","America/Vancouver|PST PDT PWT PPT|80 70 70 70|0102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TO0 1in0 UGp0 8x10 iy0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","America/Whitehorse|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 3NA0 vrd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e3","America/Winnipeg|CST CDT CWT CPT|60 50 50 50|010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aIi0 WL0 3ND0 1in0 Jap0 Rb0 aCN0 8x30 iw0 1tB0 11z0 1ip0 11z0 1o10 11z0 1o10 11z0 1rd0 10L0 1op0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 1cL0 1cN0 11z0 6i10 WL0 6i10 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|66e4","America/Yakutat|YST YWT YPT YDT AKST AKDT|90 80 80 80 90 80|01203030303030303030303030303030304545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-17T10 8x00 iz0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cn0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|642","America/Yellowknife|-00 MST MWT MPT MDDT MDT|0 70 60 60 50 60|012314151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151|-1pdA0 hix0 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|19e3","Antarctica/Casey|-00 +08 +11|0 -80 -b0|0121212|-2q00 1DjS0 T90 40P0 KL0 blz0|10","Antarctica/Davis|-00 +07 +05|0 -70 -50|01012121|-vyo0 iXt0 alj0 1D7v0 VB0 3Wn0 KN0|70","Antarctica/DumontDUrville|-00 +10|0 -a0|0101|-U0o0 cfq0 bFm0|80","Antarctica/Macquarie|AEST AEDT -00 +11|-a0 -b0 0 -b0|0102010101010101010101010101010101010101010101010101010101010101010101010101010101010101013|-29E80 19X0 4SL0 1ayy0 Lvs0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0|1","Antarctica/Mawson|-00 +06 +05|0 -60 -50|012|-CEo0 2fyk0|60","Pacific/Auckland|NZMT NZST NZST NZDT|-bu -cu -c0 -d0|01020202020202020202020202023232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1GCVu Lz0 1tB0 11zu 1o0u 11zu 1o0u 11zu 1o0u 14nu 1lcu 14nu 1lcu 1lbu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1qLu WMu 1qLu 11Au 1n1bu IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|14e5","Antarctica/Palmer|-00 -03 -04 -02|0 30 40 20|0121212121213121212121212121212121212121212121212121212121212121212121212121212121|-cao0 nD0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 jsN0 14N0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0|40","Antarctica/Rothera|-00 -03|0 30|01|gOo0|130","Antarctica/Syowa|-00 +03|0 -30|01|-vs00|20","Antarctica/Troll|-00 +00 +02|0 0 -20|01212121212121212121212121212121212121212121212121212121212121212121|1puo0 hd0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|40","Antarctica/Vostok|-00 +06|0 -60|01|-tjA0|25","Europe/Oslo|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2awM0 Qm0 W6o0 5pf0 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 wJc0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1qM0 WM0 zpc0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e4","Asia/Riyadh|LMT +03|-36.Q -30|01|-TvD6.Q|57e5","Asia/Almaty|LMT +05 +06 +07|-57.M -50 -60 -70|012323232323232323232321232323232323232323232323232|-1Pc57.M eUo7.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|15e5","Asia/Amman|LMT EET EEST|-2n.I -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1yW2n.I 1HiMn.I KL0 1oN0 11b0 1oN0 11b0 1pd0 1dz0 1cp0 11b0 1op0 11b0 fO10 1db0 1e10 1cL0 1cN0 1cL0 1cN0 1fz0 1pd0 10n0 1ld0 14n0 1hB0 15b0 1ip0 19X0 1cN0 1cL0 1cN0 17b0 1ld0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1So0 y00 1fc0 1dc0 1co0 1dc0 1cM0 1cM0 1cM0 1o00 11A0 1lc0 17c0 1cM0 1cM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e5","Asia/Anadyr|LMT +12 +13 +14 +11|-bN.U -c0 -d0 -e0 -b0|01232121212121212121214121212121212121212121212121212121212141|-1PcbN.U eUnN.U 23CL0 1db0 2q10 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|13e3","Asia/Aqtau|LMT +04 +05 +06|-3l.4 -40 -50 -60|012323232323232323232123232312121212121212121212|-1Pc3l.4 eUnl.4 24PX0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|15e4","Asia/Aqtobe|LMT +04 +05 +06|-3M.E -40 -50 -60|0123232323232323232321232323232323232323232323232|-1Pc3M.E eUnM.E 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0|27e4","Asia/Ashgabat|LMT +04 +05 +06|-3R.w -40 -50 -60|0123232323232323232323212|-1Pc3R.w eUnR.w 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0|41e4","Asia/Atyrau|LMT +03 +05 +06 +04|-3r.I -30 -50 -60 -40|01232323232323232323242323232323232324242424242|-1Pc3r.I eUor.I 24PW0 2pX0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 2sp0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0","Asia/Baghdad|BMT +03 +04|-2V.A -30 -40|012121212121212121212121212121212121212121212121212121|-26BeV.A 2ACnV.A 11b0 1cp0 1dz0 1dd0 1db0 1cN0 1cp0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1de0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0|66e5","Asia/Qatar|LMT +04 +03|-3q.8 -40 -30|012|-21Jfq.8 27BXq.8|96e4","Asia/Baku|LMT +03 +04 +05|-3j.o -30 -40 -50|01232323232323232323232123232323232323232323232323232323232323232|-1Pc3j.o 1jUoj.o WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cM0 9Je0 1o00 11z0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|BMT +07|-6G.4 -70|01|-218SG.4|15e6","Asia/Barnaul|LMT +06 +07 +08|-5z -60 -70 -80|0123232323232323232323212323232321212121212121212121212121212121212|-21S5z pCnz 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 p90 LE0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Asia/Beirut|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-21aq0 1on0 1410 1db0 19B0 1in0 1ip0 WL0 1lQp0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 q6N0 En0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1op0 11b0 dA10 17b0 1iN0 17b0 1iN0 17b0 1iN0 17b0 1vB0 SL0 1mp0 13z0 1iN0 17b0 1iN0 17b0 1jd0 12n0 1a10 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0|22e5","Asia/Bishkek|LMT +05 +06 +07|-4W.o -50 -60 -70|012323232323232323232321212121212121212121212121212|-1Pc4W.o eUnW.o 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2e00 1tX0 17b0 1ip0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1cPu 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0|87e4","Asia/Brunei|LMT +0730 +08|-7D.E -7u -80|012|-1KITD.E gDc9.E|42e4","Asia/Kolkata|HMT +0630 IST|-5R.k -6u -5u|01212|-18LFR.k 1unn.k HB0 7zX0|15e6","Asia/Chita|LMT +08 +09 +10|-7x.Q -80 -90 -a0|012323232323232323232321232323232323232323232323232323232323232312|-21Q7x.Q pAnx.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3re0|33e4","Asia/Choibalsan|LMT +07 +08 +10 +09|-7C -70 -80 -a0 -90|0123434343434343434343434343434343434343434343424242|-2APHC 2UkoC cKn0 1da0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 3Db0 h1f0 1cJ0 1cP0 1cJ0|38e3","Asia/Shanghai|CST CDT|-80 -90|01010101010101010|-1c1I0 LX0 16p0 1jz0 1Myp0 Rb0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0|23e6","Asia/Colombo|MMT +0530 +06 +0630|-5j.w -5u -60 -6u|01231321|-2zOtj.w 1rFbN.w 1zzu 7Apu 23dz0 11zu n3cu|22e5","Asia/Dhaka|HMT +0630 +0530 +06 +07|-5R.k -6u -5u -60 -70|0121343|-18LFR.k 1unn.k HB0 m6n0 2kxbu 1i00|16e6","Asia/Damascus|LMT EET EEST|-2p.c -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-21Jep.c Hep.c 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1xRB0 11X0 1oN0 10L0 1pB0 11b0 1oN0 10L0 1mp0 13X0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 Nb0 1AN0 Nb0 bcp0 19X0 1gp0 19X0 3ld0 1xX0 Vd0 1Bz0 Sp0 1vX0 10p0 1dz0 1cN0 1cL0 1db0 1db0 1g10 1an0 1ap0 1db0 1fd0 1db0 1cN0 1db0 1dd0 1db0 1cp0 1dz0 1c10 1dX0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 19z0 1fB0 1qL0 11B0 1on0 Wp0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|26e5","Asia/Dili|LMT +08 +09|-8m.k -80 -90|01212|-2le8m.k 1dnXm.k 1nfA0 Xld0|19e4","Asia/Dubai|LMT +04|-3F.c -40|01|-21JfF.c|39e5","Asia/Dushanbe|LMT +05 +06 +07|-4z.c -50 -60 -70|012323232323232323232321|-1Pc4z.c eUnz.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2hB0|76e4","Asia/Famagusta|LMT EET EEST +03|-2f.M -20 -30 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212123|-1Vc2f.M 2a3cf.M 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 15U0","Asia/Gaza|EET EEST IST IDT|-20 -30 -20 -30|010101010101010101010101010101012323232323232323232323232320101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 11z0 1o10 14o0 1lA1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0|18e5","Asia/Hebron|EET EEST IST IDT|-20 -30 -20 -30|01010101010101010101010101010101232323232323232323232323232010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 12L0 1mN0 14o0 1lc0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0|25e4","Asia/Ho_Chi_Minh|LMT PLMT +07 +08 +09|-76.E -76.u -70 -80 -90|0123423232|-2yC76.E bK00.a 1h7b6.u 5lz0 18o0 3Oq0 k5b0 aW00 BAM0|90e5","Asia/Hong_Kong|LMT HKT HKST JST|-7A.G -80 -90 -90|0121312121212121212121212121212121212121212121212121212121212121212121|-2CFHA.G 1sEP6.G 1cL0 ylu 93X0 1qQu 1tX0 Rd0 1In0 NB0 1cL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1kL0 14N0 1nX0 U10 1tz0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 Rd0 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 17d0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1cL0 6fd0 14n0|73e5","Asia/Hovd|LMT +06 +07 +08|-66.A -60 -70 -80|012323232323232323232323232323232323232323232323232|-2APG6.A 2Uko6.A cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|IMT +07 +08 +09|-6V.5 -70 -80 -90|01232323232323232323232123232323232323232323232323232323232323232|-21zGV.5 pjXV.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Europe/Istanbul|IMT EET EEST +04 +03|-1U.U -20 -30 -40 -30|012121212121212121212121212121212121212121212121212121234343434342121212121212121212121212121212121212121212121212121212121212124|-2ogNU.U dzzU.U 11b0 8tB0 1on0 1410 1db0 19B0 1in0 3Rd0 Un0 1oN0 11b0 zSp0 CL0 mN0 1Vz0 1gN0 1pz0 5Rd0 1fz0 1yp0 ML0 1kp0 17b0 1ip0 17b0 1fB0 19X0 1jB0 18L0 1ip0 17z0 qdd0 xX0 3S10 Tz0 dA10 11z0 1o10 11z0 1qN0 11z0 1ze0 11B0 WM0 1qO0 WI0 1nX0 1rB0 10L0 11B0 1in0 17d0 1in0 2pX0 19E0 1fU0 16Q0 1iI0 16Q0 1iI0 1Vd0 pb0 3Kp0 14o0 1de0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1a00 1fA0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WO0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|BMT +0720 +0730 +09 +08 WIB|-77.c -7k -7u -90 -80 -70|01232425|-1Q0Tk luM0 mPzO 8vWu 6kpu 4PXu xhcu|31e6","Asia/Jayapura|LMT +09 +0930 WIT|-9m.M -90 -9u -90|0123|-1uu9m.M sMMm.M L4nu|26e4","Asia/Jerusalem|JMT IST IDT IDDT|-2k.E -20 -30 -40|01212121212132121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-26Bek.E SyMk.E 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 3LB0 Em0 or0 1cn0 1dB0 16n0 10O0 1ja0 1tC0 14o0 1cM0 1a00 11A0 1Na0 An0 1MP0 AJ0 1Kp0 LC0 1oo0 Wl0 EQN0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 1hB0 1dX0 1ep0 1aL0 1eN0 17X0 1nf0 11z0 1tB0 19W0 1e10 17b0 1ep0 1gL0 18N0 1fz0 1eN0 17b0 1gq0 1gn0 19d0 1dz0 1c10 17X0 1hB0 1gn0 19d0 1dz0 1c10 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|+04 +0430|-40 -4u|01|-10Qs0|46e5","Asia/Kamchatka|LMT +11 +12 +13|-ay.A -b0 -c0 -d0|012323232323232323232321232323232323232323232323232323232323212|-1SLKy.A ivXy.A 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|18e4","Asia/Karachi|LMT +0530 +0630 +05 PKT PKST|-4s.c -5u -6u -50 -50 -60|012134545454|-2xoss.c 1qOKW.c 7zX0 eup0 LqMu 1fy00 1cL0 dK10 11b0 1610 1jX0|24e6","Asia/Urumqi|LMT +06|-5O.k -60|01|-1GgtO.k|32e5","Asia/Kathmandu|LMT +0530 +0545|-5F.g -5u -5J|012|-21JhF.g 2EGMb.g|12e5","Asia/Khandyga|LMT +08 +09 +10 +11|-92.d -80 -90 -a0 -b0|0123232323232323232323212323232323232323232323232343434343434343432|-21Q92.d pAp2.d 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 qK0 yN0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|66e2","Asia/Krasnoyarsk|LMT +06 +07 +08|-6b.q -60 -70 -80|01232323232323232323232123232323232323232323232323232323232323232|-21Hib.q prAb.q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Asia/Kuala_Lumpur|SMT +07 +0720 +0730 +09 +08|-6T.p -70 -7k -7u -90 -80|0123435|-2Bg6T.p 17anT.p l5XE 17bO 8Fyu 1so1u|71e5","Asia/Kuching|LMT +0730 +08 +0820 +09|-7l.k -7u -80 -8k -90|0123232323232323242|-1KITl.k gDbP.k 6ynu AnE 1O0k AnE 1NAk AnE 1NAk AnE 1NAk AnE 1O0k AnE 1NAk AnE pAk 8Fz0|13e4","Asia/Macau|LMT CST CDT|-7y.k -80 -90|012121212121212121212121212121212121212121|-2le7y.k 1XO34.k 1wn0 Rd0 1wn0 R9u 1wqu U10 1tz0 TVu 1tz0 17gu 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cOu 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cL0|57e4","Asia/Magadan|LMT +10 +11 +12|-a3.c -a0 -b0 -c0|012323232323232323232321232323232323232323232323232323232323232312|-1Pca3.c eUo3.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Cq0|95e3","Asia/Makassar|LMT MMT +08 +09 WITA|-7V.A -7V.A -80 -90 -80|01234|-21JjV.A vfc0 myLV.A 8ML0|15e5","Asia/Manila|+08 +09|-80 -90|010101010|-1kJI0 AL0 cK10 65X0 mXB0 vX0 VK10 1db0|24e6","Asia/Nicosia|LMT EET EEST|-2d.s -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Vc2d.s 2a3cd.s 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|32e4","Asia/Novokuznetsk|LMT +06 +07 +08|-5M.M -60 -70 -80|012323232323232323232321232323232323232323232323232323232323212|-1PctM.M eULM.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|55e4","Asia/Novosibirsk|LMT +06 +07 +08|-5v.E -60 -70 -80|0123232323232323232323212323212121212121212121212121212121212121212|-21Qnv.E pAFv.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 ml0 Os0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 4eN0|15e5","Asia/Omsk|LMT +05 +06 +07|-4R.u -50 -60 -70|01232323232323232323232123232323232323232323232323232323232323232|-224sR.u pMLR.u 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|12e5","Asia/Oral|LMT +03 +05 +06 +04|-3p.o -30 -50 -60 -40|01232323232323232424242424242424242424242424242|-1Pc3p.o eUop.o 23CK0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 1cM0 IM0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|27e4","Asia/Pontianak|LMT PMT +0730 +09 +08 WITA WIB|-7h.k -7h.k -7u -90 -80 -80 -70|012324256|-2ua7h.k XE00 munL.k 8Rau 6kpu 4PXu xhcu Wqnu|23e4","Asia/Pyongyang|LMT KST JST KST|-8n -8u -90 -90|01231|-2um8n 97XR 1lTzu 2Onc0|29e5","Asia/Qyzylorda|LMT +04 +05 +06|-4l.Q -40 -50 -60|0123232323232323232323232323232323232323232323|-1Pc4l.Q eUol.Q 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 3ao0 1EM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0|73e4","Asia/Rangoon|RMT +0630 +09|-6o.E -6u -90|0121|-21Jio.E SmnS.E 7j9u|48e5","Asia/Sakhalin|LMT +09 +11 +12 +10|-9u.M -90 -b0 -c0 -a0|01232323232323232323232423232323232424242424242424242424242424242|-2AGVu.M 1BoMu.M 1qFa0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 2pB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0|58e4","Asia/Samarkand|LMT +04 +05 +06|-4r.R -40 -50 -60|01232323232323232323232|-1Pc4r.R eUor.R 23CL0 3Db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0|36e4","Asia/Seoul|LMT KST JST KST KDT KDT|-8r.Q -8u -90 -90 -9u -a0|0123141414141414135353|-2um8r.Q 97XV.Q 1m1zu kKo0 2I0u OL0 1FB0 Rb0 1qN0 TX0 1tB0 TX0 1tB0 TX0 1tB0 TX0 2ap0 12FBu 11A0 1o00 11A0|23e6","Asia/Srednekolymsk|LMT +10 +11 +12|-ae.Q -a0 -b0 -c0|01232323232323232323232123232323232323232323232323232323232323232|-1Pcae.Q eUoe.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|35e2","Asia/Taipei|CST JST CDT|-80 -90 -90|01020202020202020202020202020202020202020|-1iw80 joM0 1yo0 Tz0 1ip0 1jX0 1cN0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 10N0 1BX0 10p0 1pz0 10p0 1pz0 10p0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1BB0 ML0 1Bd0 ML0 uq10 1db0 1cN0 1db0 97B0 AL0|74e5","Asia/Tashkent|LMT +05 +06 +07|-4B.b -50 -60 -70|012323232323232323232321|-1Pc4B.b eUnB.b 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0|23e5","Asia/Tbilisi|TBMT +03 +04 +05|-2X.b -30 -40 -50|0123232323232323232323212121232323232323232323212|-1Pc2X.b 1jUnX.b WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cK0 1cL0 1cN0 1cL0 1cN0 2pz0 1cL0 1fB0 3Nz0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 An0 Os0 WM0|11e5","Asia/Tehran|LMT TMT +0330 +04 +05 +0430|-3p.I -3p.I -3u -40 -50 -4u|01234325252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2btDp.I 1d3c0 1huLT.I TXu 1pz0 sN0 vAu 1cL0 1dB0 1en0 pNB0 UL0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 64p0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0|14e6","Asia/Thimphu|LMT +0530 +06|-5W.A -5u -60|012|-Su5W.A 1BGMs.A|79e3","Asia/Tokyo|JST JDT|-90 -a0|010101010|-QJH0 QL0 1lB0 13X0 1zB0 NX0 1zB0 NX0|38e6","Asia/Tomsk|LMT +06 +07 +08|-5D.P -60 -70 -80|0123232323232323232323212323232323232323232323212121212121212121212|-21NhD.P pxzD.P 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 co0 1bB0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3Qp0|10e5","Asia/Ulaanbaatar|LMT +07 +08 +09|-77.w -70 -80 -90|012323232323232323232323232323232323232323232323232|-2APH7.w 2Uko7.w cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 kEp0 1cJ0 1cP0 1cJ0|12e5","Asia/Ust-Nera|LMT +08 +09 +12 +11 +10|-9w.S -80 -90 -c0 -b0 -a0|012343434343434343434345434343434343434343434343434343434343434345|-21Q9w.S pApw.S 23CL0 1d90 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0|65e2","Asia/Vladivostok|LMT +09 +10 +11|-8L.v -90 -a0 -b0|01232323232323232323232123232323232323232323232323232323232323232|-1SJIL.v itXL.v 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|60e4","Asia/Yakutsk|LMT +08 +09 +10|-8C.W -80 -90 -a0|01232323232323232323232123232323232323232323232323232323232323232|-21Q8C.W pAoC.W 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|28e4","Asia/Yekaterinburg|LMT PMT +04 +05 +06|-42.x -3J.5 -40 -50 -60|012343434343434343434343234343434343434343434343434343434343434343|-2ag42.x 7mQh.s qBvJ.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|14e5","Asia/Yerevan|LMT +03 +04 +05|-2W -30 -40 -50|0123232323232323232323212121212323232323232323232323232323232|-1Pc2W 1jUnW WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2pB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 4RX0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|13e5","Atlantic/Azores|HMT -02 -01 +00 WET|1S.w 20 10 0 0|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121232323232323232323232323232323234323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2ldW5.s aPX5.s Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|25e4","Atlantic/Bermuda|LMT AST ADT|4j.i 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1BnRE.G 1LTbE.G 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|65e3","Atlantic/Canary|LMT -01 WET WEST|11.A 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UtaW.o XPAW.o 1lAK0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Atlantic/Cape_Verde|LMT -02 -01|1y.4 20 10|01212|-2xomp.U 1qOMp.U 7zX0 1djf0|50e4","Atlantic/Faroe|LMT WET WEST|r.4 0 -10|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2uSnw.U 2Wgow.U 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|49e3","Atlantic/Madeira|FMT -01 +00 +01 WET WEST|17.A 10 0 -10 0 -10|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldWQ.o aPWQ.o Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e4","Atlantic/Reykjavik|LMT -01 +00 GMT|1s 10 0 0|012121212121212121212121212121212121212121212121212121212121212121213|-2uWmw mfaw 1Bd0 ML0 1LB0 Cn0 1LB0 3fX0 C10 HrX0 1cO0 LB0 1EL0 LA0 1C00 Oo0 1wo0 Rc0 1wo0 Rc0 1wo0 Rc0 1zc0 Oo0 1zc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0|12e4","Atlantic/South_Georgia|-02|20|0||30","Atlantic/Stanley|SMT -04 -03 -02|3P.o 40 30 20|012121212121212323212121212121212121212121212121212121212121212121212|-2kJw8.A 12bA8.A 19X0 1fB0 19X0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 Cn0 1Cc10 WL0 1qL0 U10 1tz0 2mN0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 U10 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qN0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 U10 1tz0 U10 1tz0 U10|21e2","Australia/Sydney|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 WM0 1qM0 Rc0 1zc0 U00 1tA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST AEDT|-a0 -b0|01010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0|20e5","Australia/Broken_Hill|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|18e3","Australia/Currie|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|746","Australia/Darwin|ACST ACDT|-9u -au|010101010|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0|12e4","Australia/Eucla|+0845 +0945|-8J -9J|0101010101010101010|-293kI xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|368","Australia/Hobart|AEST AEDT|-a0 -b0|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 VfB0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|21e4","Australia/Lord_Howe|AEST +1030 +1130 +11|-a0 -au -bu -b0|0121212121313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|raC0 1zdu Rb0 1zd0 On0 1zd0 On0 1zd0 On0 1zd0 TXu 1qMu WLu 1tAu WLu 1tAu TXu 1tAu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 11Au 1nXu 1qMu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu 11zu 1o0u WLu 1qMu 14nu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu|347","Australia/Lindeman|AEST AEDT|-a0 -b0|010101010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0|10","Australia/Melbourne|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1qM0 11A0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0|39e5","Australia/Perth|AWST AWDT|-80 -90|0101010101010101010|-293jX xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0|18e5","CET|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","CST6CDT|CST CDT CWT CPT|60 50 50 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Easter|EMT -07 -06 -05|7h.s 70 60 50|012121212121212121212121212123232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1uSgG.w 1s4IG.w WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 2pA0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1o10 11z0 1qN0 WL0 1fB0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Dd0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1Nb0 Ap0|30e2","EET|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","EST|EST|50|0|","EST5EDT|EST EDT EWT EPT|50 40 40 40|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 SgN0 8x40 iv0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Europe/Dublin|DMT IST GMT BST IST|p.l -y.D 0 -10 -10|01232323232324242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242|-2ax9y.D Rc0 1fzy.D 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 g5X0 14p0 1wn0 17d0 1io0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Etc/GMT+0|GMT|0|0|","Etc/GMT+1|-01|10|0|","Etc/GMT+10|-10|a0|0|","Etc/GMT+11|-11|b0|0|","Etc/GMT+12|-12|c0|0|","Etc/GMT+3|-03|30|0|","Etc/GMT+4|-04|40|0|","Etc/GMT+5|-05|50|0|","Etc/GMT+6|-06|60|0|","Etc/GMT+7|-07|70|0|","Etc/GMT+8|-08|80|0|","Etc/GMT+9|-09|90|0|","Etc/GMT-1|+01|-10|0|","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Pohnpei|+11|-b0|0||34e3","Pacific/Tarawa|+12|-c0|0||29e3","Etc/GMT-13|+13|-d0|0|","Etc/GMT-14|+14|-e0|0|","Etc/GMT-2|+02|-20|0|","Etc/GMT-3|+03|-30|0|","Etc/GMT-4|+04|-40|0|","Etc/GMT-5|+05|-50|0|","Etc/GMT-6|+06|-60|0|","Indian/Christmas|+07|-70|0||21e2","Etc/GMT-8|+08|-80|0|","Pacific/Palau|+09|-90|0||21e3","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Amsterdam|AMT NST +0120 +0020 CEST CET|-j.w -1j.w -1k -k -20 -10|010101010101010101010101010101010101010101012323234545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2aFcj.w 11b0 1iP0 11A0 1io0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1co0 1io0 1yo0 Pc0 1a00 1fA0 1Bc0 Mo0 1tc0 Uo0 1tA0 U00 1uo0 W00 1s00 VA0 1so0 Vc0 1sM0 UM0 1wo0 Rc0 1u00 Wo0 1rA0 W00 1s00 VA0 1sM0 UM0 1w00 fV0 BCX.w 1tA0 U00 1u00 Wo0 1sm0 601k WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|16e5","Europe/Andorra|WET CET CEST|0 -10 -20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-UBA0 1xIN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|79e3","Europe/Astrakhan|LMT +03 +04 +05|-3c.c -30 -40 -50|012323232323232323212121212121212121212121212121212121212121212|-1Pcrc.c eUMc.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Europe/Athens|AMT EET EEST CEST CET|-1y.Q -20 -30 -20 -10|012123434121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a61x.Q CNbx.Q mn0 kU10 9b0 3Es0 Xa0 1fb0 1dd0 k3X0 Nz0 SCp0 1vc0 SO0 1cM0 1a00 1ao0 1fc0 1a10 1fG0 1cg0 1dX0 1bX0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|35e5","Europe/London|GMT BST BDST|0 -10 -20|0101010101010101010101010101010101010101010101010121212121210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|10e6","Europe/Belgrade|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19RC0 3IP0 WM0 1fA0 1cM0 1cM0 1rc0 Qo0 1vmo0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Berlin|CET CEST CEMT|-10 -20 -30|01010101010101210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 kL0 Nc0 m10 WM0 1ao0 1cp0 dX0 jz0 Dd0 1io0 17c0 1fA0 1a00 1ehA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e5","Europe/Prague|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 16M0 1lc0 1tA0 17A0 11c0 1io0 17c0 1io0 17c0 1fc0 1ao0 1bNc0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|13e5","Europe/Brussels|WET CET CEST WEST|0 -10 -20 -10|0121212103030303030303030303030303030303030303030303212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ehc0 3zX0 11c0 1iO0 11A0 1o00 11A0 my0 Ic0 1qM0 Rc0 1EM0 UM0 1u00 10o0 1io0 1io0 17c0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a30 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 y00 5Wn0 WM0 1fA0 1cM0 16M0 1iM0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|21e5","Europe/Bucharest|BMT EET EEST|-1I.o -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1xApI.o 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Axc0 On0 1fA0 1a10 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|19e5","Europe/Budapest|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1ip0 17b0 1op0 1tb0 Q2m0 3Ne0 WM0 1fA0 1cM0 1cM0 1oJ0 1dc0 1030 1fA0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1iM0 1fA0 8Ha0 Rb0 1wN0 Rb0 1BB0 Lz0 1C20 LB0 SNX0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zurich|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19Lc0 11A0 1o00 11A0 1xG10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e4","Europe/Chisinau|CMT BMT EET EEST CEST CET MSK MSD|-1T -1I.o -20 -30 -20 -10 -30 -40|012323232323232323234545467676767676767676767323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-26jdT wGMa.A 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 27A0 2en0 39g0 WM0 1fA0 1cM0 V90 1t7z0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 gL0 WO0 1cM0 1cM0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11D0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|67e4","Europe/Copenhagen|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 Tz0 VuO0 60q0 WM0 1fA0 1cM0 1cM0 1cM0 S00 1HA0 Nc0 1C00 Dc0 1Nc0 Ao0 1h5A0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Gibraltar|GMT BST BDST CET CEST|0 -10 -20 -10 -20|010101010101010101010101010101010101010101010101012121212121010121010101010101010101034343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 10Jz0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|30e3","Europe/Helsinki|HMT EET EEST|-1D.N -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1WuND.N OULD.N 1dA0 1xGq0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Kaliningrad|CET CEST CET CEST MSK MSD EEST EET +03|-10 -20 -20 -30 -30 -40 -30 -20 -30|0101010101010232454545454545454546767676767676767676767676767676767676767676787|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 Am0 Lb0 1en0 op0 1pNz0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|44e4","Europe/Kiev|KMT EET MSK CEST CET MSD EEST|-22.4 -20 -30 -20 -10 -40 -30|0123434252525252525252525256161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc22.4 eUo2.4 rnz0 2Hg0 WM0 1fA0 da0 1v4m0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 Db0 3220 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|34e5","Europe/Kirov|LMT +03 +04 +05|-3i.M -30 -40 -50|01232323232323232321212121212121212121212121212121212121212121|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|48e4","Europe/Lisbon|LMT WET WEST WEMT CET CEST|A.J 0 -10 -20 -10 -20|012121212121212121212121212121212121212121212321232123212321212121212121212121212121212121212121214121212121212121212121212121212124545454212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ldXn.f aPWn.f Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 pvy0 1cM0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|27e5","Europe/Luxembourg|LMT CET CEST WET WEST WEST WET|-o.A -10 -20 0 -10 -20 -10|0121212134343434343434343434343434343434343434343434565651212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2DG0o.A t6mo.A TB0 1nX0 Up0 1o20 11A0 rW0 CM0 1qP0 R90 1EO0 UK0 1u20 10m0 1ip0 1in0 17e0 19W0 1fB0 1db0 1cp0 1in0 17d0 1fz0 1a10 1in0 1a10 1in0 17f0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 vA0 60L0 WM0 1fA0 1cM0 17c0 1io0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Madrid|WET WEST WEMT CET CEST|0 -10 -20 -10 -20|010101010101010101210343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-25Td0 19B0 1cL0 1dd0 b1z0 18p0 3HX0 17d0 1fz0 1a10 1io0 1a00 1in0 17d0 iIn0 Hd0 1cL0 bb0 1200 2s20 14n0 5aL0 Mp0 1vz0 17d0 1in0 17d0 1in0 17d0 1in0 17d0 6hX0 11B0 XHX0 1a10 1fz0 1a10 19X0 1cN0 1fz0 1a10 1fC0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|62e5","Europe/Malta|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2arB0 Lz0 1cN0 1db0 1410 1on0 Wp0 1qL0 17d0 1cL0 M3B0 5M20 WM0 1fA0 1co0 17c0 1iM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 LA0 1C00 LA0 1EM0 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1co0 1cM0 1lA0 Xc0 1qq0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1iN0 19z0 1fB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Minsk|MMT EET MSK CEST CET MSD EEST +03|-1O -20 -30 -20 -10 -40 -30 -30|01234343252525252525252525261616161616161616161616161616161616161617|-1Pc1O eUnO qNX0 3gQ0 WM0 1fA0 1cM0 Al0 1tsn0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fc0 1cN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0|19e5","Europe/Monaco|PMT WET WEST WEMT CET CEST|-9.l 0 -10 -20 -10 -20|01212121212121212121212121212121212121212121212121232323232345454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 2RV0 11z0 11B0 1ze0 WM0 1fA0 1cM0 1fa0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|38e3","Europe/Moscow|MMT MMT MST MDST MSD MSK +05 EET EEST MSK|-2u.h -2v.j -3v.j -4v.j -40 -30 -50 -20 -30 -40|012132345464575454545454545454545458754545454545454545454545454545454545454595|-2ag2u.h 2pyW.W 1bA0 11X0 GN0 1Hb0 c4v.j ik0 3DA0 dz0 15A0 c10 2q10 iM10 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|16e6","Europe/Paris|PMT WET WEST CEST CET WEMT|-9.l 0 -10 -20 -10 -20|0121212121212121212121212121212121212121212121212123434352543434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2nco8.l cNb8.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 Ik0 5M30 WM0 1fA0 1cM0 Vx0 hB0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e6","Europe/Riga|RMT LST EET MSK CEST CET MSD EEST|-1A.y -2A.y -20 -30 -20 -10 -40 -30|010102345454536363636363636363727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272|-25TzA.y 11A0 1iM0 ko0 gWm0 yDXA.y 2bX0 3fE0 WM0 1fA0 1cM0 1cM0 4m0 1sLy0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1o00 11A0 1o00 11A0 1qM0 3oo0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|64e4","Europe/Rome|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2arB0 Lz0 1cN0 1db0 1410 1on0 Wp0 1qL0 17d0 1cL0 M3B0 5M20 WM0 1fA0 1cM0 16M0 1iM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 LA0 1C00 LA0 1EM0 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1C00 LA0 1zc0 Oo0 1C00 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1zc0 Oo0 1fC0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|39e5","Europe/Samara|LMT +03 +04 +05|-3k.k -30 -40 -50|0123232323232323232121232323232323232323232323232323232323212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2y10 14m0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 2sp0 WM0|12e5","Europe/Saratov|LMT +03 +04 +05|-34.i -30 -40 -50|012323232323232321212121212121212121212121212121212121212121212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1cM0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 5810","Europe/Simferopol|SMT EET MSK CEST CET MSD EEST MSK|-2g -20 -30 -20 -10 -40 -30 -40|012343432525252525252525252161616525252616161616161616161616161616161616172|-1Pc2g eUog rEn0 2qs0 WM0 1fA0 1cM0 3V0 1u0L0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 4eL0 1cL0 1cN0 1cL0 1cN0 dX0 WL0 1cN0 1cL0 1fB0 1o30 11B0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0|33e4","Europe/Sofia|EET CET CEST EEST|-20 -10 -20 -30|01212103030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030|-168L0 WM0 1fA0 1cM0 1cM0 1cN0 1mKH0 1dd0 1fb0 1ap0 1fb0 1a20 1fy0 1a30 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|12e5","Europe/Stockholm|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 TB0 2yDe0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|15e5","Europe/Tallinn|TMT CET CEST EET MSK MSD EEST|-1D -10 -20 -20 -30 -40 -30|012103421212454545454545454546363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363|-26oND teD 11A0 1Ta0 4rXl KSLD 2FX0 2Jg0 WM0 1fA0 1cM0 18J0 1sTX0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o10 11A0 1qM0 5QM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|41e4","Europe/Tirane|LMT CET CEST|-1j.k -10 -20|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glBj.k 14pcj.k 5LC0 WM0 4M0 1fCK0 10n0 1op0 11z0 1pd0 11z0 1qN0 WL0 1qp0 Xb0 1qp0 Xb0 1qp0 11z0 1lB0 11z0 1qN0 11z0 1iN0 16n0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|42e4","Europe/Ulyanovsk|LMT +03 +04 +05 +02|-3d.A -30 -40 -50 -20|01232323232323232321214121212121212121212121212121212121212121212|-22WM0 qH90 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1fA0 2pB0 IM0 rX0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0 3rd0","Europe/Uzhgorod|CET CEST MSK MSD EET EEST|-10 -20 -30 -40 -20 -30|010101023232323232323232320454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-1cqL0 6i00 WM0 1fA0 1cM0 1ml0 1Cp0 1r3W0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 1Nf0 2pw0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|11e4","Europe/Vienna|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 3KM0 14o0 LA00 6i00 WM0 1fA0 1cM0 1cM0 1cM0 400 2qM0 1a00 1cM0 1cM0 1io0 17c0 1gHa0 19X0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|18e5","Europe/Vilnius|WMT KMT CET EET MSK CEST MSD EEST|-1o -1z.A -10 -20 -30 -20 -40 -30|012324525254646464646464646473737373737373737352537373737373737373737373737373737373737373737373737373737373737373737373|-293do 6ILM.o 1Ooz.A zz0 Mfd0 29W0 3is0 WM0 1fA0 1cM0 LV0 1tgL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11B0 1o00 11A0 1qM0 8io0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|54e4","Europe/Volgograd|LMT +03 +04 +05|-2V.E -30 -40 -50|01232323232323232121212121212121212121212121212121212121212121|-21IqV.E psLV.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 2pB0 1cM0 1cM0 1cM0 1fA0 1cM0 3Co0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0|10e5","Europe/Warsaw|WMT CET CEST EET EEST|-1o -10 -20 -20 -30|012121234312121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ctdo 1LXo 11d0 1iO0 11A0 1o00 11A0 1on0 11A0 6zy0 HWP0 5IM0 WM0 1fA0 1cM0 1dz0 1mL0 1en0 15B0 1aq0 1nA0 11A0 1io0 17c0 1fA0 1a00 iDX0 LA0 1cM0 1cM0 1C00 Oo0 1cM0 1cM0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1C00 LA0 uso0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|17e5","Europe/Zaporozhye|+0220 EET MSK CEST CET MSD EEST|-2k -20 -30 -20 -10 -40 -30|01234342525252525252525252526161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc2k eUok rdb0 2RE0 WM0 1fA0 8m0 1v9a0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cK0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00|77e4","HST|HST|a0|0|","Indian/Chagos|LMT +05 +06|-4N.E -50 -60|012|-2xosN.E 3AGLN.E|30e2","Indian/Cocos|+0630|-6u|0||596","Indian/Kerguelen|-00 +05|0 -50|01|-MG00|130","Indian/Mahe|LMT +04|-3F.M -40|01|-2yO3F.M|79e3","Indian/Maldives|MMT +05|-4S -50|01|-olgS|35e4","Indian/Mauritius|LMT +04 +05|-3O -40 -50|012121|-2xorO 34unO 14L0 12kr0 11z0|15e4","Indian/Reunion|LMT +04|-3F.Q -40|01|-2mDDF.Q|84e4","Pacific/Kwajalein|+11 -12 +12|-b0 c0 -c0|012|-AX0 W9X0|14e3","MET|MET MEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","MST|MST|70|0|","MST7MDT|MST MDT MWT MPT|70 60 60 60|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Chatham|+1215 +1245 +1345|-cf -cJ -dJ|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-WqAf 1adef IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|600","PST8PDT|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Apia|LMT -1130 -11 -10 +14 +13|bq.U bu b0 a0 -e0 -d0|01232345454545454545454545454545454545454545454545454545454|-2nDMx.4 1yW03.4 2rRbu 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|+10 +09 +11|-a0 -90 -b0|0102|-16Wy0 7CN0 2MQp0|18e4","Pacific/Efate|LMT +11 +12|-bd.g -b0 -c0|0121212121212121212121|-2l9nd.g 2Szcd.g 1cL0 1oN0 10L0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 Lz0 1Nd0 An0|66e3","Pacific/Enderbury|-12 -11 +13|c0 b0 -d0|012|nIc0 B8n0|1","Pacific/Fakaofo|-11 +13|b0 -d0|01|1Gfn0|483","Pacific/Fiji|LMT +12 +13|-bT.I -c0 -d0|0121212121212121212121212121212121212121212121212121212121212121|-2bUzT.I 3m8NT.I LA0 1EM0 IM0 nJc0 LA0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0|88e4","Pacific/Galapagos|LMT -05 -06|5W.o 50 60|01212|-1yVS1.A 2dTz1.A gNd0 rz0|25e3","Pacific/Gambier|LMT -09|8X.M 90|01|-2jof0.c|125","Pacific/Guadalcanal|LMT +11|-aD.M -b0|01|-2joyD.M|11e4","Pacific/Guam|GST ChST|-a0 -a0|01|1fpq0|17e4","Pacific/Honolulu|HST HDT HST|au 9u a0|010102|-1thLu 8x0 lef0 8Pz0 46p0|37e4","Pacific/Kiritimati|-1040 -10 +14|aE a0 -e0|012|nIaE B8nk|51e2","Pacific/Kosrae|+11 +12|-b0 -c0|010|-AX0 1bdz0|66e2","Pacific/Majuro|+11 +12|-b0 -c0|01|-AX0|28e3","Pacific/Marquesas|LMT -0930|9i 9u|01|-2joeG|86e2","Pacific/Pago_Pago|LMT SST|bm.M b0|01|-2nDMB.c|37e2","Pacific/Nauru|LMT +1130 +09 +12|-b7.E -bu -90 -c0|01213|-1Xdn7.E PvzB.E 5RCu 1ouJu|10e3","Pacific/Niue|-1120 -1130 -11|bk bu b0|012|-KfME 17y0a|12e2","Pacific/Norfolk|+1112 +1130 +1230 +11|-bc -bu -cu -b0|01213|-Kgbc W01G On0 1COp0|25e4","Pacific/Noumea|LMT +11 +12|-b5.M -b0 -c0|01212121|-2l9n5.M 2EqM5.M xX0 1PB0 yn0 HeP0 Ao0|98e3","Pacific/Pitcairn|-0830 -08|8u 80|01|18Vku|56","Pacific/Rarotonga|-1030 -0930 -10|au 9u a0|012121212121212121212121212|lyWu IL0 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu|13e3","Pacific/Tahiti|LMT -10|9W.g a0|01|-2joe1.I|18e4","Pacific/Tongatapu|+1220 +13 +14|-ck -d0 -e0|0121212121212121212121212121212121212121212121212121|-1aB0k 2n5dk 15A0 1wo0 xz0 1Q10 xz0 zWN0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0|75e3","WET|WET WEST|0 -10|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00"],links:["Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|Atlantic/St_Helena","Africa/Cairo|Egypt","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Khartoum|Africa/Juba","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|US/Alaska","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Catamarca|America/Argentina/ComodRivadavia","America/Argentina/Catamarca|America/Catamarca","America/Argentina/Cordoba|America/Cordoba","America/Argentina/Cordoba|America/Rosario","America/Argentina/Jujuy|America/Jujuy","America/Argentina/Mendoza|America/Mendoza","America/Atikokan|America/Coral_Harbour","America/Chicago|US/Central","America/Curacao|America/Aruba","America/Curacao|America/Kralendijk","America/Curacao|America/Lower_Princes","America/Denver|America/Shiprock","America/Denver|Navajo","America/Denver|US/Mountain","America/Detroit|US/Michigan","America/Edmonton|Canada/Mountain","America/Fort_Wayne|America/Indiana/Indianapolis","America/Fort_Wayne|America/Indianapolis","America/Fort_Wayne|US/East-Indiana","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Indiana/Knox|America/Knox_IN","America/Indiana/Knox|US/Indiana-Starke","America/Jamaica|Jamaica","America/Kentucky/Louisville|America/Louisville","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Manaus|Brazil/West","America/Mazatlan|Mexico/BajaSur","America/Mexico_City|Mexico/General","America/New_York|US/Eastern","America/Noronha|Brazil/DeNoronha","America/Panama|America/Cayman","America/Phoenix|US/Arizona","America/Port_of_Spain|America/Anguilla","America/Port_of_Spain|America/Antigua","America/Port_of_Spain|America/Dominica","America/Port_of_Spain|America/Grenada","America/Port_of_Spain|America/Guadeloupe","America/Port_of_Spain|America/Marigot","America/Port_of_Spain|America/Montserrat","America/Port_of_Spain|America/St_Barthelemy","America/Port_of_Spain|America/St_Kitts","America/Port_of_Spain|America/St_Lucia","America/Port_of_Spain|America/St_Thomas","America/Port_of_Spain|America/St_Vincent","America/Port_of_Spain|America/Tortola","America/Port_of_Spain|America/Virgin","America/Regina|Canada/East-Saskatchewan","America/Regina|Canada/Saskatchewan","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Tijuana|America/Ensenada","America/Tijuana|America/Santa_Isabel","America/Tijuana|Mexico/BajaNorte","America/Toronto|America/Montreal","America/Toronto|Canada/Eastern","America/Vancouver|Canada/Pacific","America/Whitehorse|Canada/Yukon","America/Winnipeg|Canada/Central","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Vientiane","Asia/Dhaka|Asia/Dacca","Asia/Dubai|Asia/Muscat","Asia/Ho_Chi_Minh|Asia/Saigon","Asia/Hong_Kong|Hongkong","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Singapore","Asia/Macau|Asia/Macao","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|Europe/Nicosia","Asia/Qatar|Asia/Bahrain","Asia/Rangoon|Asia/Yangon","Asia/Riyadh|Asia/Aden","Asia/Riyadh|Asia/Kuwait","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|PRC","Asia/Taipei|ROC","Asia/Tehran|Iran","Asia/Thimphu|Asia/Thimbu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Urumqi|Asia/Kashgar","Atlantic/Faroe|Atlantic/Faeroe","Atlantic/Reykjavik|Iceland","Atlantic/South_Georgia|Etc/GMT+2","Australia/Adelaide|Australia/South","Australia/Brisbane|Australia/Queensland","Australia/Broken_Hill|Australia/Yancowinna","Australia/Darwin|Australia/North","Australia/Hobart|Australia/Tasmania","Australia/Lord_Howe|Australia/LHI","Australia/Melbourne|Australia/Victoria","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/NSW","Etc/GMT+0|Etc/GMT","Etc/GMT+0|Etc/GMT-0","Etc/GMT+0|Etc/GMT0","Etc/GMT+0|Etc/Greenwich","Etc/GMT+0|GMT","Etc/GMT+0|GMT+0","Etc/GMT+0|GMT-0","Etc/GMT+0|GMT0","Etc/GMT+0|Greenwich","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belgrade|Europe/Ljubljana","Europe/Belgrade|Europe/Podgorica","Europe/Belgrade|Europe/Sarajevo","Europe/Belgrade|Europe/Skopje","Europe/Belgrade|Europe/Zagreb","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Helsinki|Europe/Mariehamn","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Portugal","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Oslo|Arctic/Longyearbyen","Europe/Oslo|Atlantic/Jan_Mayen","Europe/Prague|Europe/Bratislava","Europe/Rome|Europe/San_Marino","Europe/Rome|Europe/Vatican","Europe/Warsaw|Poland","Europe/Zurich|Europe/Busingen","Europe/Zurich|Europe/Vaduz","Indian/Christmas|Etc/GMT-7","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kwajalein|Kwajalein","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Palau|Etc/GMT-9","Pacific/Pohnpei|Etc/GMT-11","Pacific/Pohnpei|Pacific/Ponape","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tarawa|Etc/GMT-12","Pacific/Tarawa|Pacific/Funafuti","Pacific/Tarawa|Pacific/Wake","Pacific/Tarawa|Pacific/Wallis"]}},function(e,t,n){var i=n(373);n(0).utils.registerService(JSON.parse('{"id":"com.servicemax.client.sal.service.factory","class-name":"com.servicemax.client.sal.impl.ServiceManagerFactory"}')),e.exports={impl:i}},function(e,t,n){n(170),n(123),e.exports=n(674)},function(e,t,n){var i=n(66),a=n(178);e.exports=n(28).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},function(e,t,n){n(239),n(123),n(170),n(676),n(683),n(686),n(688),e.exports=n(28).Set},function(e,t,n){"use strict";var i=n(677),a=n(380);e.exports=n(679)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(a(this,"Set"),e=0===e?0:e,e)}},i)},function(e,t,n){"use strict";var i=n(49).f,a=n(124),r=n(378),o=n(79),s=n(379),l=n(128),c=n(169),u=n(236),d=n(678),_=n(55),h=n(172).fastKey,f=n(380),p=_?"_s":"size",m=function(e,t){var n,i=h(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var u=e(function(e,i){s(e,u,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[p]=0,void 0!=i&&l(i,n,e[c],e)});return r(u.prototype,{clear:function(){for(var e=f(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var n=f(this,t),i=m(n,e);if(i){var a=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=a),a&&(a.p=r),n._f==i&&(n._f=a),n._l==i&&(n._l=r),n[p]--}return!!i},forEach:function(e){f(this,t);for(var n,i=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(f(this,t),e)}}),_&&i(u.prototype,"size",{get:function(){return f(this,t)[p]}}),u},def:function(e,t,n){var i,a,r=m(e,t);return r?r.v=n:(e._l=r={i:a=h(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=r),i&&(i.n=r),e[p]++,"F"!==a&&(e._i[a]=r)),e},getEntry:m,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=f(e,t),this._k=n,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?u(0,n.k):"values"==t?u(0,n.v):u(0,[n.k,n.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";var i=n(48),a=n(28),r=n(49),o=n(55),s=n(42)("species");e.exports=function(e){var t="function"==typeof a[e]?a[e]:i[e];o&&t&&!t[s]&&r.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(48),a=n(34),r=n(172),o=n(80),s=n(65),l=n(378),c=n(128),u=n(379),d=n(59),_=n(125),h=n(49).f,f=n(680)(0),p=n(55);e.exports=function(e,t,n,m,v,g){var y=i[e],S=y,E=v?"set":"add",b=S&&S.prototype,T={};return p&&"function"==typeof S&&(g||b.forEach&&!o(function(){(new S).entries().next()}))?(S=t(function(t,n){u(t,S,e,"_c"),t._c=new y,void 0!=n&&c(n,v,t[E],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in b&&(!g||"clear"!=e)&&s(S.prototype,e,function(n,i){if(u(this,S,e),!t&&g&&!d(n))return"get"==e&&void 0;var a=this._c[e](0===n?0:n,i);return t?this:a})}),g||h(S.prototype,"size",{get:function(){return this._c.size}})):(S=m.getConstructor(t,e,v,E),l(S.prototype,n),r.NEED=!0),_(S,e),T[e]=S,a(a.G+a.W+a.F,T),g||m.setStrong(S,e,v),S}},function(e,t,n){var i=n(79),a=n(161),r=n(86),o=n(120),s=n(681);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,d=6==e,_=5==e||d,h=t||s;return function(t,s,f){for(var p,m,v=r(t),g=a(v),y=i(s,f,3),S=o(g.length),E=0,b=n?h(t,S):l?h(t,0):void 0;S>E;E++)if((_||E in g)&&(p=g[E],m=y(p,E,v),e))if(n)b[E]=m;else if(m)switch(e){case 3:return!0;case 5:return p;case 6:return E;case 2:b.push(p)}else if(u)return!1;return d?-1:c||u?u:b}}},function(e,t,n){var i=n(682);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){var i=n(59),a=n(237),r=n(42)("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),i(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var i=n(34);i(i.P+i.R,"Set",{toJSON:n(684)("Set")})},function(e,t,n){var i=n(243),a=n(685);e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},function(e,t,n){var i=n(128);e.exports=function(e,t){var n=[];return i(e,!1,n.push,n,t),n}},function(e,t,n){n(687)("Set")},function(e,t,n){"use strict";var i=n(34);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){n(689)("Set")},function(e,t,n){"use strict";var i=n(34),a=n(231),r=n(79),o=n(128);e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,s,l=arguments[1];return a(this),t=void 0!==l,t&&a(l),void 0==e?new this:(n=[],t?(i=0,s=r(l,arguments[2],2),o(e,!1,function(e){n.push(s(e,i++))})):o(e,!1,n.push,n),new this(n))}})}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m=n(386).Constants.PREF_KEY_THEME,v=n(5).SVMXObject,g=n(5).AbstractApplication.currentApp,y={name:"com.servicemax.client.runtime.impl"};y.Module=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e._logger=f.getLoggingService().getLogger("CLIENT-RUNTIME"),e.__runtime=new y.Runtime(e),f.getClient().bind("READY",e.__onClientReady,e),e.__displayRoot=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){f.getClient().getServiceRegistry().getService("com.servicemax.client.preferences").getInstance().addPreferenceKey(m)}},{key:"__onClientReady",value:function(e){this._logger.info("Client ready to run!"),this.__runtime.start()}}]),t}(p),y.Runtime=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__logger=f.getLoggingService().getLogger("CLIENT-RUNTIME"),n.__app=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"start",value:function(e){function t(){if(this.__logger.info("Theme <"+r+">loaded successfully"),e&&"function"==typeof e)e();else{if(i=n.getDeclaration("com.servicemax.client.runtime.application"),a=n.getDefinitionsFor(i),0==a.length)return void this.__logger.error("Cannot find an application extension!");var t=a[0],o=t.config.application,s="";if(s=f.getUrlParameter("application-id"),null!=s&&""!=s||(s=n.getApplicationParameter("application-id")),!s)return void this.__logger.error("Your application configuration does not specify an application id. Please rectify");if(o instanceof Array){for(var l=0;l<o.length;l++){var c=o[l];if(c.id==s){o=c;break}}l==o.length&&(o={id:"__INVALID_APP_ID__"})}if(o.id!=s)return void this.__logger.error("Cannot find the application "+s+" in any of the definitions. Please rectify");var u=o["class-name"];if(this.__app=f.create(u),this.__logger.info("Running application <"+s+"> with class <"+u+">"),g=this.__app,f.TEST)return void f.startTests();this.__app.beforeRun({handler:this.__beforeRunCompleted,context:this});var d=f.create("com.servicemax.client.lib.core.ClientEvent","APPLICATION_CREATED",this);f.getClient().triggerEvent(d)}}var n=f.getClient(),i=null,a=null,r="CLASSIC",o=f.getUrlParameter("theme"),s=n.getApplicationParameter("theme");if(void 0!=o&&""!=o)r=o;else if(s)r=s;else try{var l=f.getClient().getServiceRegistry().getService("com.servicemax.client.preferences").getInstance(),c=m,u=l.getPreference(c);u&&(r=u)}catch(e){this.__logger.warn("Could not load preferences. => "+e)}f.getClient().getServiceRegistry().getService("com.servicemax.client.themeservice").getInstance().loadTheme(r,t,this)}},{key:"__beforeRunCompleted",value:function(){f.getClient().getProgressMonitor().finish(),this.__app.run()}}]),t}(v),y.ThemeService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));if(null!=y.ThemeService.__instance){var n;return n=y.ThemeService.__instance,(0,d.default)(e,n)}return y.ThemeService.__instance=e,e.__themeProperties={},e.__logger=f.getLoggingService().getLogger("THEME-SERVICE"),e.__currentTheme=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getThemeProperties",value:function(){return this.__themeProperties}},{key:"getThemeProperty",value:function(e){var t=this.getThemeProperties(),n=null;for(var i in t)if(i==e){n=t[i];break}return n}},{key:"__extractThemeProperties",value:function(e){var t=this.getThemeProperties();for(var n in e)t[n]=e[n]}},{key:"getAvailableThemes",value:function(){var e=f.getClient(),t=null,n=null,i={};if(t=e.getDeclaration("com.servicemax.client.runtime.uitheme"),n=e.getDefinitionsFor(t),n.length>0){var a=void 0,r=n.length;for(a=0;a<r;a++){var o=n[a],s=o.config["theme-defs"];if(s){var l,c=s.length;for(l=0;l<c;l++){var u=s[l];if(i[u.type]=i[u.type]?i[u.type]:{properties:{}},u.properties)for(var d in u.properties)i[u.type].properties[d]=u.properties[d]}}}}return i}},{key:"getCurrentTheme",value:function(){return this.__currentTheme}},{key:"__getResourceUrl",value:function(e,t){var n=e.config&&e.config["appconfig-resource-path-key"],i=e.config&&e.config["resource-build-path"];return f.getClient().getApplicationParameter(n||"")+"/"+i+"/"+t}},{key:"loadTheme",value:function(e,t,n,i){if(this.__currentTheme=e,i)return this.__logger.info("Will load the theme later => "+e),void t.call(n);this.__logger.info("Loading theme => "+e);var a=f.getClient(),r=null,o=null,s=[];if(r=a.getDeclaration("com.servicemax.client.runtime.uitheme"),o=a.getDefinitionsFor(r),o.length>0){var l=void 0,c=o.length;for(l=0;l<c;l++){var u=o[l],d=u.config["theme-defs"];if(d){var _,h=d.length;for(_=0;_<h;_++){var p=d[_];if(p.type==e){if(p["valid-platforms"]){var m=p["valid-platforms"];if(!f.isPlatform(m))continue}if(p.properties&&this.__extractThemeProperties(p.properties),p.path){var v=void 0,g=f.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");v=g&&!0===g?this.__getResourceUrl(u,p.path):u.getResourceUrl(p.path),s[s.length]=v}}}}}}f.TEST?(console.log("Skipping requireStyleSheet in test mode for now"),t.call(n)):s.length>0?f.requireStyleSheet(s,t,n,{}):t.call(n)}}]),t}(v),y.ThemeService.__instance=null,y.NamedInstanceService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));if(null!=y.NamedInstanceService.__instance){var n;return n=y.NamedInstanceService.__instance,(0,d.default)(e,n)}y.NamedInstanceService.__instance=e,e.__logger=f.getLoggingService().getLogger("NAMEDINSTANCE-SERVICE"),e.__allInstanceDefinitions={};var i=f.getClient(),a=null,o=null;if(a=i.getDeclaration("com.servicemax.client.runtime.namedinstance"),null!=(o=i.getDefinitionsFor(a))){var l=void 0,c=o.length;for(l=0;l<c;l++){var u=o[l],_=u.config;_.define&&(e.__allInstanceDefinitions[_.define.name]={definition:u,data:[]})}for(l=0;l<c;l++){var u=o[l],_=u.config;if(_.configure){var u=e.__allInstanceDefinitions[_.configure.name];u.data[u.data.length]={definition:u,data:_.configure.data}}}}return e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"createNamedInstanceAsync",value:function(e,t){this.__createdNamedInstanceAsyncInternal(e,t)}},{key:"__createdNamedInstanceAsyncInternal",value:function(e,t){var n=this.__allInstanceDefinitions[e],i=n.definition.config.define.type,a=f.getClass(i),r=new a;r.initialize(e,n.data,t.additionalParams),t.handler.call(t.context,r)}}]),t}(v),y.NamedInstanceService.__instance=null,y.Preferences=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__preferenceKeys={},e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"addPreferenceKey",value:function(e){e=this.__getKey(e),this.__preferenceKeys[e]=e}},{key:"getPreferenceKeys",value:function(){return f.cloneObject(this.__preferenceKeys)}},{key:"getPreference",value:function(e){var t=void 0,n=f.getClient().getServiceRegistry().getService("com.servicemax.client.cache");if(n){var i=n.getInstance();e=this.__getKey(e),t=i.getItem(e)}else f.getLoggingService().getLogger("CLIENT-RUNTIME").warning("No com.servicemax.client.cache has been registered");return t}},{key:"setPreference",value:function(e,t){var n=f.getClient().getServiceRegistry().getService("com.servicemax.client.cache");if(n){var i=n.getInstance();e=this.__getKey(e),i.setItem(e,t)}else f.getLoggingService().getLogger("CLIENT-RUNTIME").warning("No com.servicemax.client.cache has been registered")}},{key:"__getKey",value:function(e){return"SVMX-CLIENT-UPREF-"+e}}]),t}(v),f.defineGlobal(y.name,y),e.exports=y},function(module,exports,__webpack_require__){var SVMX=__webpack_require__(0).utils,jseeApi={name:"com.servicemax.client.runtime.jsee.api"};jseeApi.initialize=function(){void 0!=window.$EXPR&&null!=window.$EXPR||(window.$EXPR={});var JSEE=function JSEE(){this.evalExpression=function(expr,context,callback,callbackContext,async){var result=null,bReturned=!1;return function(expr,context,callback,callbackContext,async){function $ADD(e,t){return e+t}function $SUB(e,t){return e-t}function $ISNULL(e){return!!e}function $BOOL(e){return!!e}function $SORT(e,t){if("string"==typeof t){var n=void 0,i=e.length;if(i<2)return e;for(n=0;n<i-1;){for(var a=0;a<i-1;a++)if(e[a][t]>e[a+1][t]){var r=e[a];e[a]=e[a+1],e[a+1]=r}i--}return e}}function $RETURN(e){if(bReturned)throw new Error("Attempted to RETURN twice in the same expression!");bReturned=!0,callback.call(callbackContext,e)}function $FORMAT(){return SVMX.format(arguments)}context=window.$EXPR.toObject(context),result=eval(expr)}(expr,context,callback,callbackContext,async),async||callback.call(callbackContext,result),result}};window.$EXPR.executeExpression=function(e,t,n,i,a){return(new JSEE).evalExpression(e,t,n,i,a)},window.$EXPR.toJSON=function(e){return SVMX.toJSON(e)},window.$EXPR.toObject=function(e){return SVMX.toObject(e)},window.$EXPR.ajax=function(e){return SVMX.ajax(e)},window.$EXPR.Logger=SVMX.getLoggingService().getLogger("JSEE")},SVMX.defineGlobal(jseeApi.name,jseeApi),module.exports=jseeApi},function(module,exports,__webpack_require__){var SVMX=__webpack_require__(0).utils,datetimeutils=__webpack_require__(0).datetimeutils,$=__webpack_require__(10),JSEE=function JSEE(){function $LC(e){return"string"==typeof e?e.toLowerCase():e}function $ADD(e,t){return e+t}function $SUB(e,t){return e-t}function $ISNULL(e){return!e&&0!==e&&!1!==e}function $ISNOTNULL(e){return!(!e&&0!==e&&!1!==e)}function $EQ(e,t,n){return n||e===t||!$ISNULL(e)&&!$ISNULL(t)?(e instanceof Date&&(e=e.getTime()),t instanceof Date&&(t=t.getTime()),$LC(e)===$LC(t)):CONSTANTS.INVALID}function $NE(e,t){return!$EQ(e,t,!0)}function $GT(e,t){return $ISNULL(e)||$ISNULL(t)?CONSTANTS.INVALID:$LC(e)>$LC(t)}function $LT(e,t){return $ISNULL(e)||$ISNULL(t)?CONSTANTS.INVALID:$LC(e)<$LC(t)}function $GE(e,t){return $ISNULL(e)||$ISNULL(t)?CONSTANTS.INVALID:$LC(e)>=$LC(t)}function $LE(e,t){return $ISNULL(e)||$ISNULL(t)?CONSTANTS.INVALID:$LC(e)<=$LC(t)}function $STARTS(e,t){return $ISNULL(e)||$ISNULL(t)?CONSTANTS.INVALID:0===String(e).toLowerCase().indexOf($LC(t))}function $CONTAINS(e,t){return $ISNULL(e)||$ISNULL(t)?CONSTANTS.INVALID:-1!==String(e).toLowerCase().indexOf($LC(t))}function $NOTCONTAINS(e,t){return-1===String(e).toLowerCase().indexOf($LC(t))}function $IN(e,t){if($ISNULL(t)||$ISNULL(e))return CONSTANTS.INVALID;var n=String(e).toLowerCase().split(/[,;]/);return-1!==SVMX.array.indexOf(n,String(t).toLowerCase())}function $NOTIN(e,t){var n=$IN(e,t);return 0===n?CONSTANTS.INVALID:!n}function $NUMBER(e){return $ISNULL(e)?null:Number(e)}function $BOOLEAN(e){return!!e&&"false"!==String(e).toLowerCase()}function $DATE(e){return $ISNULL(e)?null:datetimeutils.DatetimeUtil.parseGMTDate(e)}function $DATEONLY(e){return $ISNULL(e)?null:com.servicemax.client.lib.datetimeutils.DatetimeUtil.dateObjFormatter(e)}function $TIMEZONEDATE(e){return $ISNULL(e)?null:datetimeutils.DatetimeUtil.parseDateOnly(e)}function $DISPLAYDATETIME(e){return $ISNULL(e)?null:datetimeutils.DatetimeUtil.getFormattedDatetime(e,"YYYY-MM-DD","HH:mm:ss")}function $DATEEQ(e,t){return e&&t?(e=datetimeutils.DatetimeUtil.parseDateOnly(e),t=datetimeutils.DatetimeUtil.parseDateOnly(t),e.getTime()===t.getTime()):CONSTANTS.INVALID}function $DATENE(e,t){return e&&t?!$DATEEQ(e,t):CONSTANTS.INVALID}function $DATEGT(e,t){return e&&t?(e=datetimeutils.DatetimeUtil.parseDateOnly(e),t=datetimeutils.DatetimeUtil.parseDateOnly(t),e.getTime()>t.getTime()):CONSTANTS.INVALID}function $DATEGE(e,t){return e&&t?(e=datetimeutils.DatetimeUtil.parseDateOnly(e),t=datetimeutils.DatetimeUtil.parseDateOnly(t),e.getTime()>=t.getTime()):CONSTANTS.INVALID}function $DATELT(e,t){return e&&t?(e=datetimeutils.DatetimeUtil.parseDateOnly(e),t=datetimeutils.DatetimeUtil.parseDateOnly(t),e.getTime()<t.getTime()):CONSTANTS.INVALID}function $DATELE(e,t){return e&&t?(e=datetimeutils.DatetimeUtil.parseDateOnly(e),t=datetimeutils.DatetimeUtil.parseDateOnly(t),e.getTime()<=t.getTime()):CONSTANTS.INVALID}function $DATETODAY(){var e=datetimeutils.DatetimeUtil.macroDrivenDatetime("today","YYYY-MM-DD","HH:mm:ss");return e=datetimeutils.DatetimeUtil.parseDateOnly(e)}function $DATETOMORROW(){var e=datetimeutils.DatetimeUtil.macroDrivenDatetime("tomorrow","YYYY-MM-DD","HH:mm:ss");return e=datetimeutils.DatetimeUtil.parseDateOnly(e)}function $DATEYESTERDAY(){var e=datetimeutils.DatetimeUtil.macroDrivenDatetime("yesterday","YYYY-MM-DD","HH:mm:ss");return e=datetimeutils.DatetimeUtil.parseDateOnly(e)}function $DATENOW(){var e=datetimeutils.DatetimeUtil.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss");return e=datetimeutils.DatetimeUtil.parseGMTDate(e)}function $SORT(e,t){if("string"==typeof t){var n=void 0,i=e.length;if(i<2)return e;for(n=0;n<i-1;){for(var a=0;a<i-1;a++)if(e[a][t]>e[a+1][t]){var r=e[a];e[a]=e[a+1],e[a+1]=r}i--}return e}}function $FORMAT(){return SVMX.format(arguments)}this.evalExpressions=function(exprs,context,callback,callbackContext,async){function $RETURN(e){if(bReturned)throw new Error("Attempted to RETURN twice in the same expression!");bReturned=!0,callback.call(callbackContext,e)}var bReturned=!1,results=[];return function(exprs,context,callback,callbackContext,async){context=SVMX.toObject(context);var scopeExpr=[];for(var key in context)context.hasOwnProperty(key)&&scopeExpr.push("var "+key+" = context."+key+";");eval(scopeExpr.join("\n")),SVMX.array.forEach(exprs,function(expr,i){results[i]=eval(expr),logger.info(expr+" = "+results[i])})}(exprs,context,callback,callbackContext,async),!async&&callback&&callback.call(callbackContext,results),results},this.expressionInterface=function(func){return eval(func)}},expressionEngine=new JSEE,logger=SVMX.getLoggingService().getLogger("SVMX-expressions"),SQLJSEE=function SQLJSEE(){function $LC(e){var t="$LC("+e+")";return expressionEngine.expressionInterface(t)}function $ISNULL(e){return"("+e+" IS NULL OR "+e+" = '')"}function $ISNOTNULL(e){return"("+e+" IS NOT NULL AND "+e+" != '')"}function $EQ(e,t){return"("+e+" = '"+t+"')"}function $NE(e,t){return"("+e+" != '"+t+"')"}function $GT(e,t){return"("+e+" IS NOT NULL AND "+e+" != '' AND "+e+" > '"+t+"')"}function $LT(e,t){return"("+e+" IS NOT NULL AND "+e+" != '' AND "+e+" < '"+t+"')"}function $GE(e,t){return"("+e+" IS NOT NULL AND "+e+" != '' AND "+e+" >= '"+t+"')"}function $LE(e,t){return"("+e+" IS NOT NULL AND "+e+" != '' AND "+e+" <= '"+t+"')"}function $STARTS(e,t){return"("+e+" LIKE '"+t+"%')"}function $CONTAINS(e,t){return"("+e+" LIKE '%"+t+"%')"}function $NOTCONTAINS(e,t){return"("+e+" NOT LIKE '%"+t+"%')"}function $IN(e,t){return t+" IN ('"+(e.join?e.join("','"):e)+"')"}function $NOTIN(e,t){return t+" NOT IN ('"+e.join("','")+"')"}function $DATE(e){return e}function $DATEONLY(e){return e}function $TIMEZONEDATE(e){var t="$TIMEZONEDATE("+e+")";return expressionEngine.expressionInterface(t)}function $DISPLAYDATETIME(e){var t="$DISPLAYDATETIME("+e+")";return expressionEngine.expressionInterface(t)}function $DATEEQ(e,t){return e+" LIKE '"+t+"%'"}function $DATENE(e,t){return e+" NOT LIKE '"+t+"%'"}function $DATEGT(e,t){var n=t&&t.split(" "),i=t&&t.split("T");return n&&n.length>1||i&&i.length>1?e+" > datetime( '"+t+"', '+1 day')":e+" > datetime( '"+t+" 00:00:00', '+1 day')"}function $DATEGE(e,t){var n=t&&t.split(" "),i=t&&t.split("T");return n&&n.length>1||i&&i.length>1?e+" >= datetime( '"+t+"')":e+" >= datetime( '"+t+" 00:00:00')"}function $DATELT(e,t){var n=t&&t.split(" "),i=t&&t.split("T");return n&&n.length>1||i&&i.length>1?e+" < datetime( '"+t+"')":e+" < datetime( '"+t+" 00:00:00')"}function $DATELE(e,t){var n=t&&t.split(" "),i=t&&t.split("T");return n&&n.length>1||i&&i.length>1?e+" <= datetime( '"+t+"', '+1 day')":e+" <= datetime( '"+t+" 00:00:00', '+1 day')"}function $DATETODAY(){return datetimeutils.DatetimeUtil.macroDrivenDatetime("today","YYYY-MM-DD","","date")}function $DATETOMORROW(){return datetimeutils.DatetimeUtil.macroDrivenDatetime("tomorrow","YYYY-MM-DD","","date")}function $DATEYESTERDAY(){return datetimeutils.DatetimeUtil.macroDrivenDatetime("yesterday","YYYY-MM-DD","","date")}function $DATENOW(){return datetimeutils.DatetimeUtil.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss")}this.evalSqlExpressions=function(exprs){for(var result=[],i=0;i<exprs.length;i++){var expr=exprs[i];result[i]=eval(expr)}return result}},sqlExpressionEngine=new SQLJSEE,sqlLogger=SVMX.getLoggingService().getLogger("SVMX-SQL-expressions");SVMX.executeExpressions=function(e,t,n,i,a){try{var r=expressionEngine.evalExpressions($.isArray(e)?e:[e],t,n,i,a)}catch(t){logger.error("executeExpression: error in expression: "+e)}return $.isArray(e)?r:r[0]},SVMX.executeSqlExpressions=function(e){try{var t=sqlExpressionEngine.evalSqlExpressions($.isArray(e)?e:[e])}catch(t){sqlLogger.error("executeSqlExpressions: error in expression: "+e)}return $.isArray(e)?t:t[0]};var CONSTANTS={INVALID:0};SVMX.executeExpressionsResultInvalid=function(e){return e===CONSTANTS.INVALID}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(){return new Error("Invalid Custom Snippet ErrorCode")}var r=n(31),o=i(r),s=n(18),l=i(s),c=n(240),u=i(c),d=n(0).utils,_=(n(5).SVMXObject,d.getLoggingService().getLogger("SVMX-JSDataAccessLayer"),n(694)),h=function(){return d.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},f={name:"com.servicemax.client.runtime.jsee.JSDAIErrorFactory"};a.prototype=(0,u.default)(Error.prototype),f.ErrorCodes=_,f.GetErrorResponse=function(e,t){if(void 0===e||"object"!==(void 0===e?"undefined":(0,l.default)(e))||!e.hasOwnProperty("tag")||!e.hasOwnProperty("isCSError"))throw new a;t="string"==typeof t?t:null;var n={};return n.status="error",n.error=e.getErrorCode(),n.error_message=h().T(e.tag,e.text)+(t?" : "+t:""),n},f.GetErrorResponseString=function(e,t){var n=f.GetErrorResponse(e,t);return(0,o.default)(n)},d.defineGlobal(f.name,f),e.exports=f},function(e,t,n){var i=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r={CS:{SVMX_CS_001:{text:"Missing Parameter",tag:""},SVMX_CS_002:{text:"Invalid Parameter",tag:""}},DB:{SVMX_CS_DB_001:{text:"Failed to form the query",tag:""},SVMX_CS_DB_002:{text:"Query Error",tag:""}},ENV:{SVMX_CS_ENV_001:{text:"Unable to retrieve environment details",tag:""}},SFM:{SVMX_CS_SFM_001:{text:"Unable to retrieve record details",tag:""},SVMX_CS_SFM_002:{text:"Field not accessible",tag:""}},EVT:{SVMX_CS_EVT_001:{text:"Unable to retrieve event details",tag:""}}};for(var o in r){var s=r[o],l=(0,a.default)(s).filter(function(e){return 0==e.indexOf("SVMX_CS_")});for(var c in l)s[l[c]]&&function(){s[l[c]].isCSError=!0;var e=l[c];s[l[c]].getErrorCode=function(){return e}}()}e.exports=r},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(7).SystemData,v=n(7).Data,g=n(7).MetaData,y=n(12).DatetimeUtil,S=(n(7).SyncData,n(11).Facade),E=n(13).Operation,b=n(389).PlatformSpecifics,T={name:"com.servicemax.client.offline.sal.model.sfmeventdelivery.operations"},M=m,I=v,C=g,A=y,D=function(e,t){var n=p.Deferred();t&&(e=p.string.substitute(e,t));var i=S,a=i.createSQLRequest();return a.bind("REQUEST_COMPLETED",function(e){n.resolve(e.data)},this),a.bind("REQUEST_ERROR",function(e){n.resolve(null)},this),a.execute({query:e,async:!0}),n};T.DeleteEventData=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"__executeQuery",value:function(e,t,n){void 0===n?n=t:t&&(e=p.string.substitute(e,t));var i=S,a=i.createSQLRequest();return a.bind("REQUEST_COMPLETED",function(e){n&&n(e.data)},this),a.bind("REQUEST_ERROR",function(e){n&&n(e.data)},this),a.execute({query:e,async:!0})}},{key:"performAsync",value:function(e,t){var n=this;I.getRecord({Id:e.recordId}).fail(p.proxy(this,function(){t&&t.result()})).done(p.proxy(this,function(e){e&&e.deleteRecord(p.proxy(n,n.__sync,t),p.proxy(n,n.__failedUpdate,t))}))}},{key:"__sync",value:function(e,t){var n=!0;t&&t.Id&&-1!=t.Id.indexOf("local_")&&(n=!1),n&&p.getCurrentApplication().getSyncImpl()&&p.getCurrentApplication().getSyncImpl().onSaveStarted(),I.writeSyncRecords(null,null,[t],p.proxy(this,this.__finish,e)),!n&&this.__localFinish(e)}},{key:"__localFinish",value:function(e){e&&e.result()}},{key:"__finish",value:function(e){p.getCurrentApplication().getSyncImpl()&&p.getCurrentApplication().getSyncImpl().onSaveCompleted(),e&&e.result()}},{key:"__failedUpdate",value:function(e){e&&e.result()}}]),t}(E),T.UpdateEventDate=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=p.getLoggingService().getLogger("SFM-EVENT-DATA-OP"),e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=this;if(!(e&&e.recordId&&e.startDate&&e.endDate))return this.__logger.error("Cannot update date on event record. Missing all required request data"),void(t&&t.result());var i=e.recordId,a=e.startDate,r=e.endDate;v.getRecord({Id:i}).fail(p.proxy(this,function(){this.__logger.error("Cannot update date on event record. Record not found for: "+i),t&&t.result()})).done(p.proxy(this,function(e){var i=e.getTableName(),o="IsAllDayEvent",s="StartDateTime",l="EndDateTime",c="ActivityDateTime",u="ActivityDate",d="DurationInMinutes";"Event"!=i&&(o=p.OrgNamespace+"__IsAllDayEvent__c",s=p.OrgNamespace+"__StartDateTime__c",l=p.OrgNamespace+"__EndDateTime__c",c=p.OrgNamespace+"__ActivityDateTime__c",u=p.OrgNamespace+"__ActivityDate__c",d=p.OrgNamespace+"__DurationInMinutes__c");var _=a.split(" ")[0],h=A.getDurationBetween(a,r).asMinutes();e[o]="false",e[s]=a,e[l]=r,e[c]=a,e[u]=_,e[d]=h,e.writeRecord(p.proxy(n,n.__sync,t),p.proxy(n,n.__failedUpdate,t))}))}},{key:"__sync",value:function(e,t,n){p.getCurrentApplication().getSyncImpl()&&p.getCurrentApplication().getSyncImpl().onSaveStarted(),t?I.writeSyncRecords([n],null,null,p.proxy(this,this.__finish,e)):I.writeSyncRecords(null,[n],null,p.proxy(this,this.__finish,e))}},{key:"__finish",value:function(e){p.getCurrentApplication().getSyncImpl()&&p.getCurrentApplication().getSyncImpl().onSaveCompleted(),e&&e.result()}},{key:"__failedUpdate",value:function(e){e&&e.result()}}]),t}(E),T.GetEventData=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=p.getLoggingService().getLogger("SFM-EVENT-DATA-OP"),e.__queryCounter=0,e.__data={},e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){this.responder=t,this.__refereceFields=[],this.__ids=[],this.__data.userinfo=M.getUserInfo();this.__getCalendarSettings().then(p.proxy(this,function(e){this.__data.settings=e,this.__sfEventFields=this.__getFieldsFromSubjectSetting(e.sfEventSubjectSetting),this.__svmxEventFields=this.__getFieldsFromSubjectSetting(e.svmxEventSubjetSetting),this.__describeObject("Event",this.__sfEventFields).then(p.proxy(this,function(e){this.__data.sfEventFieldAndFieldType=e;var t=p.OrgNamespace+"__SVMX_Event__c";this.__describeObject(t,this.__svmxEventFields).then(p.proxy(this,function(e){this.__data.svmxEventFieldAndFieldType=e;var t=this.__getCalendarUsers(),n=this.__getCalendarEvents(this.__data.userinfo);p.when([t,n]).then(p.proxy(this,function(e,t){this.__data.users=e.data,this.__data.events=t;for(var n=0;n<t.length;n++){for(var i=0;i<this.__refereceFields.length;i++){var a=t[n][this.__refereceFields[i]];null!=a&&a.length>0&&this.__ids.push(a)}if(t[n].EventType===p.OrgNamespace+"__SVMX_Event__c")for(var r in this.__data.svmxEventFieldAndFieldType)"datetime"===this.__data.svmxEventFieldAndFieldType[r]&&(t[n][r]=A.convertToTimezone(t[n][r],this.__data.userinfo.TimezoneOffset))}this.__ids.length>0?this.__getNameForIds(this.__ids).then(p.proxy(this,function(e){this.__data.recordIdName=e,this.__processResponseData()})):this.__processResponseData()}))}))}))}))}},{key:"__getNameForIds",value:function(e){var t={Ids:e.join("','")};return D("SELECT Id, Name FROM SFRecordName WHERE Id IN ('{{Ids}}')",t).then(p.proxy(this,this.__parseRecordNameId))}},{key:"__parseRecordNameId",value:function(e){for(var t=p.Deferred(),n={},i=e.data||[],a=0;a<i.length;a++)n[i[a].Id]=i[a].Name;return t.resolve(n),t.promise()}},{key:"__processResponseData",value:function(){if(this.__data.userinfo){this.__data.users=this.__data.users||[];for(var e=!1,t=0;t<this.__data.users.length;t++)this.__data.users[t].Id==this.__data.userinfo.UserId&&(e=!0);!e&&this.__data.users.push&&this.__data.users.push({Id:this.__data.userinfo.UserId,FirstName:this.__data.userinfo.UserName,LastName:""})}else this.__data.userinfo={};this.responder.result(this.__data)}},{key:"__processDateFields",value:function(e,t){var n=[],i=this.__data.userinfo.TimezoneOffset;return i||this.__logger.error("User Info: missing user timezone offset; Location TimeZone"),0!==i?(f.each(e,function(e,a){if("true"!=a.IsRecurrence)if("true"!=a.IsAllDayEvent){var r={};f.each(a,function(e,n){t[e]?r[e]=A.convertToTimezone(n,i):r[e]=n}),r.StartDateTime&&r.EndDateTime&&n.push(r)}else{if(a.EventType===p.getCustomObjectName("SVMX_Event")){var o=void 0,s=void 0;a.StartDateTime=a.ActivityDate&&a.ActivityDate+" 00:00:00",o=new Date(a.StartDateTime);var l=isNaN(a.DurationInMinutes)?0:Number(a.DurationInMinutes);a.EndDateTime=A.manipulateDatetime(a.StartDateTime,"minutes",l),s=new Date(a.EndDateTime),s.getTimezoneOffset()>o.getTimezoneOffset()&&(a.EndDateTime=new Date(s.getTime()+36e5))}else{var c=a.EndDateTime;a.EndDateTime=A.manipulateDatetime(c,"days",1)}a.StartDateTime&&a.EndDateTime&&n.push(a)}}),n):e}},{key:"__getCalendarUsers",value:function(e){return D("SELECT * FROM User LIMIT 10")}},{key:"__getCalendarEvents",value:function(e){var t=this.__data.settings,n=null,i=[],a={event:{hasDriveTime:!1},svmxevent:{hasEvent:!1,hasDriveTime:!1,hasAllDayEvent:!1},wo:{hasName:!1,hasSLA:!1,hasCompany:!1,hasStreet:!1,hasCity:!1,hasState:!1,hasCountry:!1,hasZip:!1},case:{hasName:!1,hasSLA:!1,hasCompany:!1,caseExists:!1}};return f.when(!0).then(p.proxy(this,function(){var e=f.Deferred();return g.describeObject({objectName:p.OrgNamespace+"__Service_Order__c"}).done(p.proxy(this,function(t){for(var n=0;n<t.fields.length;n++){var i=t.fields[n];"Name"==i.name?a.wo.hasName=!0:i.name==p.OrgNamespace+"__SLA_Terms__c"?a.wo.hasSLA=!0:i.name==p.OrgNamespace+"__Company__c"?a.wo.hasCompany=!0:i.name==p.OrgNamespace+"__Street__c"?a.wo.hasStreet=!0:i.name==p.OrgNamespace+"__City__c"?a.wo.hasCity=!0:i.name==p.OrgNamespace+"__State__c"?a.wo.hasState=!0:i.name==p.OrgNamespace+"__Country__c"?a.wo.hasCountry=!0:i.name==p.OrgNamespace+"__Zip__c"?a.wo.hasZip=!0:i.name==p.OrgNamespace+"__Latitude__c"?a.wo.hasLat=!0:i.name==p.OrgNamespace+"__Longitude__c"&&(a.wo.hasLng=!0)}e.resolve()})).fail(p.proxy(this,function(){this.__logger.warn("Unable to get ObjectDescribe of Service_Order "),e.resolve()})),e.promise()})).then(p.proxy(this,function(){var e=f.Deferred();return g.describeObject({objectName:"Case"}).done(p.proxy(this,function(t){a.case.caseExists=!0;for(var n=0;n<t.fields.length;n++){var i=t.fields[n];"CaseNumber"==i.name?a.case.hasName=!0:i.name==p.OrgNamespace+"__SLA_Terms__c"?a.case.hasSLA=!0:"AccountId"==i.name&&(a.case.hasCompany=!0)}e.resolve()})).fail(p.proxy(this,function(){a.case.caseExists=!1,this.__logger.warn("Unable to get ObjectDescribe of Case "),e.resolve()})),e.promise()})).then(p.proxy(this,function(){var e=f.Deferred();return g.describeObject({objectName:"Event"}).done(p.proxy(this,function(t){for(var n=0;n<t.fields.length;n++){t.fields[n].name==p.OrgNamespace+"__Driving_Time__c"&&(a.event.hasDriveTime=!0)}e.resolve()})).fail(p.proxy(this,function(){this.__logger.warn("Unable to get ObjectDescribe of Event "),e.resolve()})),e.promise()})).then(p.proxy(this,function(){var e=f.Deferred();return g.describeObject({objectName:p.OrgNamespace+"__SVMX_Event__c"}).done(p.proxy(this,function(t){for(var n=0;n<t.fields.length;n++){var i=t.fields[n];i.name==p.OrgNamespace+"__Driving_Time__c"&&(a.svmxevent.hasDriveTime=!0),i.name==p.OrgNamespace+"__IsAllDayEvent__c"&&(a.svmxevent.hasAllDayEvent=!0)}a.svmxevent.hasEvent=!0,e.resolve()})).fail(p.proxy(this,function(){this.__logger.warn("Unable to get ObjectDescribe of ServiceMax Event, this is standard behavior and can safely be ignored if you have the Global Setting for ServiceMax Events to behave as Salesforce Events (GLB025) or do not have permission to ServiceMax Events."),e.resolve()})),e.promise()})).then(p.proxy(this,function(){var e="SELECT DISTINCT R.*, A.Name As AccountName FROM (SELECT E.*, 'Event' AS EventType, "+(a.event.hasDriveTime?"    E."+p.OrgNamespace+"__Driving_Time__c As DrivingTime, ":" '' as DrivingTime, ")+"S.Name as WO_Name, S."+p.OrgNamespace+"__Company__c AS WO_AccountId, S."+p.OrgNamespace+"__SLA_Terms__c AS WO_SLA, S."+p.OrgNamespace+"__Street__c AS WO_Street, S."+p.OrgNamespace+"__City__c AS WO_City, S."+p.OrgNamespace+"__State__c AS WO_State, S."+p.OrgNamespace+"__Country__c AS WO_Country, S."+p.OrgNamespace+"__Zip__c AS WO_Zip, CAST(S."+p.OrgNamespace+"__Latitude__c AS NUMERIC) WO_Latitude, CAST(S."+p.OrgNamespace+"__Longitude__c AS NUMERIC) WO_Longitude, C.error_type as isRecordInConflict FROM Event E LEFT JOIN ClientSyncConflict C ON C.Id = E.WhatID OR C.parent_id = E.WhatID LEFT JOIN (SELECT Id,"+(a.wo.hasName?"Name,":"'' AS Name,")+(a.wo.hasSLA?p.OrgNamespace+"__SLA_Terms__c,":"'' AS "+p.OrgNamespace+"__SLA_Terms__c,")+(a.wo.hasCompany?p.OrgNamespace+"__Company__c,":"'' AS "+p.OrgNamespace+"__Company__c,")+(a.wo.hasStreet?p.OrgNamespace+"__Street__c,":"'' AS "+p.OrgNamespace+"__Street__c,")+(a.wo.hasState?p.OrgNamespace+"__State__c,":"'' AS "+p.OrgNamespace+"__State__c,")+(a.wo.hasCity?p.OrgNamespace+"__City__c,":"'' AS "+p.OrgNamespace+"__City__c,")+(a.wo.hasCountry?p.OrgNamespace+"__Country__c,":"'' AS "+p.OrgNamespace+"__Country__c,")+(a.wo.hasZip?p.OrgNamespace+"__Zip__c,":"'' AS "+p.OrgNamespace+"__Zip__c,")+(a.wo.hasLat?p.OrgNamespace+"__Latitude__c,":"'' AS "+p.OrgNamespace+"__Latitude__c,")+(a.wo.hasLng?p.OrgNamespace+"__Longitude__c":"'' AS "+p.OrgNamespace+"__Longitude__c")+" FROM "+p.OrgNamespace+"__Service_Order__c ";return a.case.caseExists?e+="UNION SELECT Id, "+(a.case.hasCompany?"AccountId,":"'',")+(a.case.hasSLA?p.OrgNamespace+"__SLA_Terms__c,":"'',")+(a.case.hasName?" CaseNumber,":"'',")+" '', '', '', '', '', '', '' FROM 'Case') AS S ON S.Id = E.WhatId WHERE (E.IsRecurrence != 'true' OR E.IsRecurrence IS NULL)":e+=") AS S ON S.Id = E.WhatId WHERE (E.IsRecurrence != 'true' OR E.IsRecurrence IS NULL)",e+=") R LEFT JOIN SFRecordName A ON A.Id = R.WO_AccountId",D(e)})).then(p.proxy(this,function(e){if(n=e&&e.data?e.data:[],!a.svmxevent.hasEvent)return p.Deferred().resolve({}).promise();var t="SELECT R.*, A.Name As AccountName FROM (SELECT E.*,'"+p.OrgNamespace+"__SVMX_Event__c' AS EventType,     E.Id, E.Name AS Subject,     E."+p.OrgNamespace+"__WhoId__c, "+(a.svmxevent.hasAllDayEvent?"    E."+p.OrgNamespace+"__IsAllDayEvent__c AS IsAllDayEvent, ":" '' as IsAllDayEvent, ")+"    E."+p.OrgNamespace+"__WhatId__c AS WhatId,     E."+p.OrgNamespace+"__Service_Order__c,     E."+p.OrgNamespace+"__Location__c AS Location,     E."+p.OrgNamespace+"__ActivityDateTime__c AS ActivityDateTime,     E."+p.OrgNamespace+"__ActivityDate__c AS ActivityDate,     E."+p.OrgNamespace+"__DurationInMinutes__c AS DurationInMinutes,     E."+p.OrgNamespace+"__StartDateTime__c AS StartDateTime,     E."+p.OrgNamespace+"__EndDateTime__c AS EndDateTime,     E."+p.OrgNamespace+"__Description__c AS Description, "+(a.svmxevent.hasDriveTime?"    E."+p.OrgNamespace+"__Driving_Time__c As DrivingTime, ":" '' as DrivingTime, ")+"    E.OwnerId, E.IsDeleted, E.CreatedDate, E.CreatedById, E.LastModifiedDate,     E.LastModifiedById, E.SystemModStamp, S.Name as WO_Name, S."+p.OrgNamespace+"__Company__c AS AccountId, S."+p.OrgNamespace+"__SLA_Terms__c AS WO_SLA, S."+p.OrgNamespace+"__Street__c AS WO_Street, S."+p.OrgNamespace+"__City__c AS WO_City, S."+p.OrgNamespace+"__State__c AS WO_State, S."+p.OrgNamespace+"__Country__c AS WO_Country, S."+p.OrgNamespace+"__Zip__c AS WO_Zip, CAST(S."+p.OrgNamespace+"__Latitude__c AS NUMERIC) WO_Latitude, CAST(S."+p.OrgNamespace+"__Longitude__c AS NUMERIC) WO_Longitude,     C.error_type as isRecordInConflict FROM "+p.OrgNamespace+"__SVMX_Event__c E LEFT JOIN ClientSyncConflict C     ON C.Id = E."+p.OrgNamespace+"__WhatId__c OR C.parent_id = E."+p.OrgNamespace+"__WhatId__c LEFT JOIN (SELECT Id,"+(a.wo.hasName?"Name,":"'' AS Name,")+(a.wo.hasSLA?p.OrgNamespace+"__SLA_Terms__c,":"'' AS "+p.OrgNamespace+"__SLA_Terms__c,")+(a.wo.hasCompany?p.OrgNamespace+"__Company__c,":"'' AS "+p.OrgNamespace+"__Company__c,")+(a.wo.hasStreet?p.OrgNamespace+"__Street__c,":"'' AS "+p.OrgNamespace+"__Street__c,")+(a.wo.hasState?p.OrgNamespace+"__State__c,":"'' AS "+p.OrgNamespace+"__State__c,")+(a.wo.hasCity?p.OrgNamespace+"__City__c,":"'' AS "+p.OrgNamespace+"__City__c,")+(a.wo.hasCountry?p.OrgNamespace+"__Country__c,":"'' AS "+p.OrgNamespace+"__Country__c,")+(a.wo.hasZip?p.OrgNamespace+"__Zip__c,":"'' AS "+p.OrgNamespace+"__Zip__c,")+(a.wo.hasLat?p.OrgNamespace+"__Latitude__c,":"'' AS "+p.OrgNamespace+"__Latitude__c,")+(a.wo.hasLng?p.OrgNamespace+"__Longitude__c":"'' AS "+p.OrgNamespace+"__Longitude__c")+" FROM "+p.OrgNamespace+"__Service_Order__c ";return a.case.caseExists?t+="UNION SELECT Id, "+(a.case.hasCompany?"AccountId,":"'',")+(a.case.hasSLA?p.OrgNamespace+"__SLA_Terms__c,":"'',")+(a.case.hasName?" CaseNumber,":"'',")+" '', '', '', '', '', '', '' FROM 'Case') AS S ON S.Id = E."+p.OrgNamespace+"__WhatId__c ":t+=") AS S ON S.Id = E."+p.OrgNamespace+"__WhatId__c ",t+=") R LEFT JOIN SFRecordName A ON A.Id = R.AccountId",D(t)})).then(p.proxy(this,function(e){var t=p.Deferred();if(e&&void 0!==e.data)for(var i=0;i<e.data.length;i++)n.push(e.data[i]);return t.resolve(n),t.promise()})).then(p.proxy(this,function(e){f.Deferred();for(var t in e)e[t].WhatId&&e[t].WhatId.length>0&&i.push(e[t].WhatId);return this.__getRelatedRecordPriority(i)})).then(p.proxy(this,function(e){for(var a=(p.Deferred(),0);a<n.length;a++){var r=n[a].WhatId,o=null;if(n[a].Color=t.colors.Other,n[a].Priority="Other",e&&e.data)for(var s=0;s<e.data.length;s++)if(e.data[s].Id==r){o=e.data[s].priority,n[a].Priority=o;var l=t.colors[o];l&&(n[a].Color=l);break}}return n=this.__processDateFields(n,{ActivityDateTime:!0,StartDateTime:!0,EndDateTime:!0,CreatedDate:!0,LastModifiedDate:!0,SystemModstamp:!0}),this.__getDisplayNames(n,i)}))}},{key:"__getDisplayNames",value:function(e,t){var n={},i=0;p.array.forEach(e,function(e){if(e.WhatId)try{var t=C.getTableForId(e.WhatId);t&&!n[t]&&(n[t]=[],i++),t&&n[t].push(e.WhatId)}catch(e){this.__logger.error("Failed call to getTableForId from __getDisplayNames")}},this),this.__logger.info("COUNT: "+i);var a=[];return p.forEachProperty(n,p.proxy(this,function(e,t){var n={nameField:C.getNameField(e),tableName:e,Id:t.join("','")};a.push(D("SELECT Id, {{nameField}} as name_field FROM '{{tableName}}' WHERE Id IN ('{{Id}}')",n))})),p.when(a).then(p.proxy(this,function(){for(var t=p.Deferred(),n=0;n<arguments.length;n++)if(arguments[n]&&arguments[n].data)for(var i=arguments[n].data,a=0;a<i.length;a++)p.array.forEach(e,function(e){e.WhatId==i[a].Id&&i[a].name_field!=e.Subject&&(e.RelatedName=i[a].name_field)});return t.resolve(e),t.promise()}))}},{key:"__getFieldsFromSubjectSetting",value:function(e){var t=[],n=[];if(null!=e&&null!=(n=e.match(/\{\w+\}/g))&&n.length>0)for(var i=0;i<n.length;i++)t.push(n[i].replace(/\{*\}*/g,""));return t}},{key:"__describeObject",value:function(e,t){var n=this,i=p.Deferred(),t=t;return g.describeObject({objectName:e}).done(p.proxy(this,function(a){for(var r={},o=a.fields,s=0;s<t.length;s++)for(var l=0;l<o.length;l++)if(t[s]==o[l].name){if(e!=p.OrgNamespace+"__SVMX_Event__c"||t[s]!=p.OrgNamespace+"__WhatId__c"){r[t[s]]=o[l].type,"reference"==o[l].type&&n.__refereceFields.push(t[s]);break}r[t[s]]="reference",n.__refereceFields.push(t[s])}i.resolve(r)})).fail(p.proxy(this,function(){this.__logger.warn("Unable to get ObjectDescribe of "+e),i.resolve()})),i.promise()}},{key:"__getCalendarSettings",value:function(){return D("SELECT setting_id as key, value FROM MobileDeviceSettings where setting_id in ('IPAD006_SET001', 'IPAD006_SET002', 'IPAD006_SET003', 'IPAD006_SET004','Synchronization To Get Events', 'Synchronization To Remove Events', 'IPAD006_SET005', 'IPAD006_SET006')").then(p.proxy(this,this.__parseCalenderSettings))}},{key:"__parseCalenderSettings",value:function(e){var t=p.Deferred(),n={colors:{},daysToGet:null,daysToDelete:null,sfEventSubjectSetting:null,svmxEventSubjetSetting:null};for(var i in e.data){var a=e.data[i].key,r=e.data[i].value;switch(a){case"IPAD006_SET001":n.colors.High=r;break;case"IPAD006_SET002":n.colors.Medium=r;break;case"IPAD006_SET003":n.colors.Low=r;break;case"IPAD006_SET004":n.colors.Other=r;break;case"Synchronization To Get Events":n.daysToGet=r;break;case"Synchronization To Remove Events":n.daysToDelete=r;break;case"IPAD006_SET005":n.sfEventSubjectSetting=r;break;case"IPAD006_SET006":n.svmxEventSubjetSetting=r}}return t.resolve(n),t.promise()}},{key:"__getRelatedRecordPriority",value:function(e){var t="SELECT Id, {{ns}}__Priority__c as priority FROM {{ns}}__Service_Order__c WHERE Id IN ('{{ids}}')";if(C.isTableInDatabase("Case")){t+=" UNION SELECT Id, priority FROM 'case' WHERE Id IN ('{{ids}}')"}var n={ids:e.join("','"),ns:p.OrgNamespace};return D(t,n)}}]),t}(E),T.GetEditableObjectNames=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n="SELECT DISTINCT pc.object_name AS name FROM SFProcess AS p JOIN SFProcessComponent AS pc ON p.process_id = pc.process_id WHERE pc.component_type = 'TARGET' AND p.process_type = 'STANDALONE EDIT' AND pc.object_name IN ('Event', '"+p.OrgNamespace+"__SVMX_Event__c')";D(n).always(p.proxy(this,function(e){e=e||{},e.data=e.data||[];for(var n=[],i=0;i<e.data.length;i++)n.push(e.data[i].name);t.result(n)}))}}]),t}(E),T.GetFirstEventProcess=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"__executeQuery",value:function(e){var t=p.Deferred(),n=S,i=n.createSQLRequest();return i.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data)},this),i.bind("REQUEST_ERROR",function(e){t.resolve(null)},this),i.execute({query:e,async:!0}),t}},{key:"performAsync",value:function(e,t){var n=this.getEventObjects();n=n.then(p.proxy(this,function(e){return this.getFirstEventProcess(e)})),n.always(p.proxy(this,function(e){t.result(e)}))}},{key:"getEventObjects",value:function(){var e=p.Deferred();return this.__executeQuery("SELECT value FROM MobileDeviceSettings WHERE setting_id = 'GLOB001_GBL025'").always(p.proxy(this,function(t){var n=t.data&&t.data[0]&&t.data[0].value,i=[];switch(n){case"ServiceMax Event":i=[p.OrgNamespace+"__SVMX_Event__c"];break;case"Salesforce Event":i=["Event"];break;default:i=["Event",p.OrgNamespace+"__SVMX_Event__c"]}e.resolve(i)})),e.promise()}},{key:"getFirstEventProcess",value:function(e){var t=p.Deferred(),n="SELECT p.process_unique_id, pc.object_name FROM SFProcess AS p JOIN SFProcessComponent AS pc ON p.process_id = pc.process_id WHERE pc.component_type = 'TARGET' AND p.process_type = 'STANDALONE CREATE' AND pc.object_name IN ('"+e.join("','")+"')  ORDER BY pc.object_name LIMIT 1";return this.__executeQuery(n).always(p.proxy(this,function(e){t.resolve(e)})),t.promise()}}]),t}(E),T.GetPriorityColors=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"__executeQuery",value:function(e){var t=p.Deferred(),n=S,i=n.createSQLRequest();return i.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data)},this),i.bind("REQUEST_ERROR",function(e){t.resolve(null)},this),i.execute({query:e,async:!0}),t}},{key:"performAsync",value:function(e,t){this.getPrioritySettings().always(p.proxy(this,function(e){t.result(e)}))}},{key:"getPrioritySettings",value:function(){var e=p.Deferred(),t={High:"#F75D59",Medium:"#ADDFF",Low:"#C9BE62",Other:"#4E8975"};return this.__executeQuery("SELECT setting_id, value FROM MobileDeviceSettings WHERE setting_id IN ('IPAD006_SET001', 'IPAD006_SET002', 'IPAD006_SET003', 'IPAD006_SET004')").always(p.proxy(this,function(n){n=n.data||[];var i=0;for(i=0;i<n.length;i++)switch(n[i].setting_id){case"IPAD006_SET001":t.High=n[i].value;break;case"IPAD006_SET002":t.Medium=n[i].value;break;case"IPAD006_SET003":t.Low=n[i].value;break;case"IPAD006_SET004":t.Other=n[i].value}e.resolve(t)})),e.promise()}}]),t}(E),T.RetrieveMobileSettings=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){this.getMobileSettings(e.settingIds).always(p.proxy(this,function(e){t.result(e)}))}},{key:"getMobileSettings",value:function(e){var t=p.Deferred(),n=[];e.map(function(e){n.push("'"+e+"'")});return D("SELECT * FROM MobileDeviceSettings WHERE setting_id IN ({{settingIds}})",{settingIds:n}).always(p.proxy(this,function(e){t.resolve(e&&e.data?e.data:[])})),t.promise()}}]),t}(E),T.SaveNewEvent=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.eventRecord={},e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){if("create"==e.type){var n={},i=p.getCurrentApplication().getUserInfo().UserId,a=p.getCurrentApplication().getUserInfo().UserTechId;"Event"===e.objectName?(n.Subject=e.subject,n.Description=e.description,n.StartDateTime=e.startDateTime,n.EndDateTime=e.endDateTime,n.WhatId=e.whatId):e.objectName===p.OrgNamespace+"__SVMX_Event__c"&&(n.Name=e.subject,n[p.OrgNamespace+"__Description__c"]=e.description,n[p.OrgNamespace+"__EndDateTime__c"]=e.endDateTime,n[p.OrgNamespace+"__StartDateTime__c"]=e.startDateTime,n[p.OrgNamespace+"__WhatId__c"]=e.whatId,n[p.OrgNamespace+"__Technician__c"]=a,n.OwnerId=i),I.writeRecord({data:n,type:e.objectName,onSuccess:p.proxy(this,this.__sync,t),onError:p.proxy(this,this.__failedUpdate,t)})}}},{key:"__sync",value:function(e,t,n){this.eventRecord={},this.eventRecord.recordId=n.Id,this.eventRecord.objectName=n.objectName,p.getCurrentApplication().getSyncImpl()&&p.getCurrentApplication().getSyncImpl().onSaveStarted(),t?I.writeSyncRecords([n],null,null,p.proxy(this,this.__finish,e)):I.writeSyncRecords(null,[n],null,p.proxy(this,this.__finish,e))}},{key:"__finish",value:function(e){p.getCurrentApplication().getSyncImpl()&&p.getCurrentApplication().getSyncImpl().onSaveCompleted(),e&&e.result(this.eventRecord)}},{key:"__failedUpdate",value:function(e){e&&e.result(),this.__logger.error("Cannot insert event record.")}}]),t}(E),T.PlatformSpecifics=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"showRecord",value:function(e){var t=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},n=e.key,i=this,a=e.objectName;a||(a=this.__getObjectName(n)),function(e,n){C.getQualifiedProcessesForRecord({objectName:n,recordId:e,processType:"VIEW RECORD",considerDefaultView:!0}).then(p.proxy(this,function(n,a){if(n.length){var r={SVMX_processId:n[0].process_unique_id,SVMX_recordId:e,SVMX_record:a};p.getCurrentApplication().launchConsoleApp("sfmdelivery",r)}else{var o=t().T("FSA004_TAG021","View not configured for this record. Please contact your system administrator.");p.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:o,buttons:[{text:t().T("FSA016_TAG003","OK"),itemId:"OK"}]}),i.triggerNoViewProcessEvent()}}))}(n,a)}},{key:"triggerNoViewProcessEvent",value:function(){var e=p.getClient().getApplicationParameter("client-type");if(e&&"laptop"===e.toLowerCase()){var t=p.getCurrentApplication(),n=p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.VIEW_LOADED",this,null);t.triggerEvent(n)}}},{key:"editRecord",value:function(e){e=e||{};var t=e.key,n=e.objectName,i=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};n||(n=this.__getObjectName(t)),function(t,n){C.getQualifiedProcessesForRecord({objectName:n,recordId:t,processType:"STANDALONE EDIT"}).then(p.proxy(this,function(n,a){if(n.length){var r=void 0,o=void 0;for(o=0;o<n.length;o++){if("EVT_004"==n[o].process_unique_id||"SVMXEVT_004"==n[o].process_unique_id){r=n[o].process_unique_id;break}r=n[0].process_unique_id}e.callback&&e.callback.call(e.context||this,r,t,a)}else{var s=i().T("FSA008_TAG114","An edit process is not associated with this record.");p.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:s,buttons:[{text:i().T("FSA016_TAG003","OK"),itemId:"OK"}]})}}))}(t,n)}},{key:"__getObjectName",value:function(e){return C.getTableForId(e)}}]),t}(b),p.defineGlobal(T.name,T),e.exports=T},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(7).Data,m=(n(7).SystemData,n(100).Utils),v=n(13).Operation,g={name:"com.servicemax.client.offline.sal.model.sfwdelivery.operations"},y=p,S=m,E=f.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.sfwdelivery");g.GetWizardInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e.Record?this.__onGetRecordSuccess(e,t,e.Record):f.doLater(function(){y.getRecord({Id:e.RecordId,loadReferences:!0,convertPicklists:!0}).then(f.proxy(this,"__onGetRecordSuccess",e,t),f.proxy(this,"__onGetRecordFail",e,t))},this)}},{key:"__onGetRecordSuccess",value:function(e,t,n){S.processWizardRawData(n).then(f.proxy(this,function(i){var a=0,r=i.length,o={SFWs:[],RecordId:e.RecordId,Record:n},s=void 0,l=void 0,c=void 0,u=void 0;for(a=0;a<r;a++)for(o.SFWs[a]={SFWDef:{},actions:[]},o.SFWs[a].SFWDef.Id=i[a].wizard_id,o.SFWs[a].SFWDef[f.OrgNamespace+"__Name__c"]=i[a].wizard_name,c=i[a].steps,l=c?c.length:0,s=0;s<l;s++)u={actionDef:{}},u.Enabled=c[s].expressionPassed,u.actionDef.Id=c[s].local_id,u.actionDef[f.OrgNamespace+"__Action_Type__c"]=c[s].action_type,u.actionDef[f.OrgNamespace+"__Custom_Action_Type__c"]=c[s].customActionType,u.actionDef[f.OrgNamespace+"__Enable_Confirmation_Dialog__c"]=!1,u.actionDef[f.OrgNamespace+"__Mode_Of_Execution__c"]=c[s].mode_of_execution||"Interactive",u.actionDef[f.OrgNamespace+"__Handover__c"]=!1,u.actionDef[f.OrgNamespace+"__Confirmation_Message__c"]=null,u.actionDef[f.OrgNamespace+"__Name__c"]=c[s].action_name,u.actionDef[f.OrgNamespace+"__Description__c"]=c[s].action_description,u.actionDef[f.OrgNamespace+"__Process__r"]={},u.actionDef[f.OrgNamespace+"__Process__r"][f.OrgNamespace+"__ProcessID__c"]=c[s].process_id,o.SFWs[a].actions.push(u);t.result(o)}))}},{key:"__onGetRecordFail",value:function(e,t,n){E.error("Failed to get record for sfw:"+n),t.fault(n)}}]),t}(v),f.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(30),v=i(m),g=n(10),y=n(0).utils,S=n(103),E={name:"com.servicemax.client.sync.targetedsyncevent"},b=E;(0,v.default)(b,S),E.TargetedSyncEvent=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"_getTargetedSyncHeaderId",value:function(e){var t={query:"SELECT Id, parent_id FROM ClientSyncLog ORDER BY datetime(modified_at) DESC LIMIT 1"};this._initSQLServiceRequest(t,{handler:function(t){var n="";t&&t.length>0&&(n=t[0].parent_id?t[0].parent_id:t[0].Id),e&&e.call(this,n)}})}},{key:"_getTargetedSyncRecords",value:function(e,t,n,i,a){var r=void 0;if(n){r="SELECT * FROM ClientSyncLog WHERE (Id = '"+t+"' OR Id IN ("+y.toObject(n).map(function(e){return"'"+e+"'"}).join(",")+") OR parent_id = '"+t+"') AND operation = '"+e+"' "+(a?" AND Id IN ('"+a.join("','")+"')":"")}else r="SELECT * FROM ClientSyncLog WHERE (Id = '"+t+"' OR parent_id = '"+t+"') AND operation = '"+e+"' "+(a?" AND Id IN ('"+a.join("','")+"')":"");"insert"===e&&(r+=" AND record_type != 'attachment'");var o={query:r};this._initSQLServiceRequest(o,{handler:function(t){t=t||[],this._getSyncRecordResults(t,e,i)}})}},{key:"_getTargetedSyncRecordsByObjectOrder",value:function(e,t,n){var i=this;this._getTargetedSyncRecords(e,t,null,function(e){var t=i,a=function(i,a){var r=y.cloneObject(a);!function a(){var o=r.shift();o?n.call(t,i,o,e,"TARGETED_SYNC",function(){a()}):r.length>0&&a()}()};for(var r in e.byObject){for(var o=e.describe[r].name,s=[],l=0;l<e.byOrder.length;l++)for(var c in e.byOrder[l])for(var u in e.byOrder[l][c])u in e.byObject[r]&&(s[l]=s[l]||{},s[l][u]=e.byOrder[l][c][u]);a.call(i,o,s)}})}},{key:"_deleteTargetedSyncRecords",value:function(e,t){if(!e||0===e.length)return void(t&&t.call(this,null));var n=this._getState("TargetedSyncInsertedRecords"),i=n?"IN('"+e.join("','")+"','"+n.join("','")+"')":"IN('"+e.join("','")+"')",a=["DELETE FROM","ClientSyncLog","WHERE Id",""+i].join(" "),r=["DELETE FROM","ClientSyncConflict","WHERE Id",""+i].join(" "),o={queryArray:[a,r]};this.__logger.info("TS Log: delete targeted sync log records: "+y.toJSON(o)),this._initSQLServiceRequest(o,{handler:function(e){t&&t.call(this,e)}})}},{key:"_updateSFIDForInsertedRecords",value:function(e,t,n){var i=y.Deferred(),a="Update "+n+" SET Id = '"+t+"' WHERE Id = '"+e+"'",r={query:a};return this.__logger.info("TS Log: update SFID for inserted records : "+y.toJSON(r)),this._initSQLServiceRequest(r,{handler:function(e){return i.resolve(),i.promise()}}),i.promise()}},{key:"_saveTargetSyncRecordTimeStamps",value:function(e,t){for(var n=y.Deferred(),i=[],a=0;a<e.length;a++){var r={};r.Id=e[a],r.lastSyncTime=t,i.push(r)}var o=b.SQLSchema.getInsertReplaceQuery("SmartSyncTimeStamp",i,!0,"SmartSyncTimeStamp"),s={query:o};return this.__logger.info("TS Log: save timestamps for TS records : "+y.toJSON(s)),this._initSQLServiceRequest(s,{handler:function(e){return n.resolve(),n.promise()}}),n.promise()}},{key:"_getProcessComponentObjects",value:function(e,t){var n="SELECT DISTINCT object_name FROM SFProcessComponent where process_id = '"+e+"' AND component_type = 'TARGETCHILD'",i={query:n};this._initSQLServiceRequest(i,{handler:function(e){var n=[];if(e)for(var i=0;i<e.length;i++)n.push(e[i].object_name);t&&t.call(this,n)}})}},{key:"__insertUpdateSyncConflictForTargetedSync",value:function(e,t){var n=g.Deferred();if(e.Id){var i={query:"SELECT 1 FROM ClientSyncConflict WHERE Id = {{Id}} AND operation = {{op}}",binds:{Id:e.Id,op:e.operation}};this._initSQLServiceRequest(i,{handler:function(i){var a=null;e.override_flag="",a=i&&i[0]?b.SQLSchema.getUpdateQuery("ClientSyncConflict",e):b.SQLSchema.getInsertQuery("ClientSyncConflict",e),this._initSQLServiceRequest({query:a},{handler:function(){n.resolve(),t&&t.call(this,null)}})}})}return n}},{key:"_getExcludedIds",value:function(e){var t={query:"SELECT Id FROM ClientSyncConflict where operation = 'update' AND (override_flag IS NULL OR override_flag = '')"};this._initSQLServiceRequest(t,{handler:function(t){var n=this,i=[];!t||t&&0===t.length?e&&e.call(this,i):function(){for(var a={},o=0;o<t.length;o++)!function(o){var s=t[o].Id,l=s.substring(0,3);n._getObjectNameForKeyPrefix(l,function(l){if(l){var c=a[l]||[];c.push(s),a[l]=c}if(o===t.length-1)if((0,r.default)(a).length>0){for(var u in a){var d={key:u,values:a[u]};i.push(d)}e&&e.call(n,i)}else e&&e.call(n,i)})}(o)}()}})}},{key:"_getValueFromClientCache",value:function(e,t){var n="SELECT value from ClientCache where key='"+e+"' limit 1",i={query:n};this._initSQLServiceRequest(i,{handler:function(e){if(e&&e.length>0){var n=e[0].value;t&&t.call(this,n)}else t&&t.call(this,null)}})}}]),t}(b.SyncDataEvent),y.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(7).Utilities,m=(n(7).SystemData,n(13).Operation),v=n(11).Facade,g={name:"com.servicemax.client.offline.sal.model.sfmcreatedelivery.operations"},y=p,S="CREATE_RECENT_ITEMS";g.GetCreateProcessInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.doLater(function(){f.create("com.servicemax.client.offline.sal.model.sfmcreateutils.Utils").getCreateProcessInfo({},function(e){t.result(e)},this)})}}]),t}(m),g.GetRecentsInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.doLater(function(){y.readObjectFromCache(S,function(e){e||(e=[]),t.result(e)},this)})}}]),t}(m),g.AddToRecents=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.doLater(function(){y.readObjectFromCache(S,function(n){n||(n=[]);var i=void 0,a=n.length,r=!1,o=e.item;for(i=0;i<a;i++)if(o.id==n[i].id){r=!0;break}if(r){n.splice(i,1);n.splice(0,0,o)}else n.splice(0,0,o);y.writeObjectToCache(S,n,function(){},this),t.result({})},this)})}}]),t}(m),g.GetProcessId=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=e.record,i=n.data.id,a="SELECT process_unique_id FROM SFProcess WHERE process_id ='"+i+"';";this.__executeQuery(a,function(e){t(e)})}},{key:"__executeQuery",value:function(e,t,n){"function"==typeof t&&(n=t,t={});var i=v,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){n.call(this,f.toObject(e.data.data)[0].process_unique_id)},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger("__getRealProcessId Failed"+e.data.data),n.call(this,!1)},this),a.execute({query:e,async:!0,queryBinds:t})}}]),t}(m),f.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m=n(11).Facade,v={name:"com.servicemax.client.offline.sal.model.sfmcreateutils"};v.Utils=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getCreateProcessInfo",value:function(e,t,n){this.prepareCreateProcessInfo(e,function(e){t.call(n,e)})}},{key:"prepareCreateProcessInfo",value:function(e,t){var n=this,i=f.getClient().getApplicationParameter("InstallBase"),a="SELECT DISTINCT p.process_id as id, p.process_name as name, p.process_description as description, pc.object_name as objectName FROM SFProcess AS p JOIN SFProcessComponent AS pc ON p.process_id = pc.process_id WHERE pc.component_type = 'TARGET' AND p.process_type = 'STANDALONE CREATE' ";i&&(a+=" AND pc.object_name NOT IN (SELECT object_name FROM InstallBaseObject)");var r=f.string.substitute(a,{});n.__executeQuery(r,function(e){var i=[],o=[];if(!1!==e){i=e;var s=void 0,l=i.length;for(s=0;s<l;s++)o.push(i[s].objectName);a="SELECT DISTINCT object_name as objectName, label FROM SFObjectDescribe where object_name in ('{{value}}')",r=f.string.substitute(a,{value:o.join("','")}),n.__executeQuery(r,function(e){for(s=0;s<l;s++)i[s].objectLabel=function(t){var n=void 0,i=e.length,a=t;for(n=0;n<i;n++)if(e[n].objectName==t){a=e[n].label;break}return a}(i[s].objectName);n.__filterCreateProcessInfo(i,t)})}else t(e)})}},{key:"__filterCreateProcessInfo",value:function(e,t){var n=[];this.__executeQuery("SELECT value FROM MobileDeviceSettings WHERE setting_id = 'GLOB001_GBL025'",function(i){for(var a=i&&i[0]&&i[0].value,r="ServiceMax Event"===a?"Event":f.OrgNamespace+"__SVMX_Event__c",o=0;o<e.length;o++){var s=e[o];s.objectName!==r&&n.push(s)}t(n)})}},{key:"__executeQuery",value:function(e,t){var n=m,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){t(f.toObject(e.data.data))},this),i.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),t(!1)},this),i.execute({query:e,async:!0})}}]),t}(p),v.PlatformSpecifics=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAction",value:function(e){this.__getRealProcessId(e.id,function(e){var t={SVMX_processId:e};f.getCurrentApplication().launchConsoleApp("sfmdelivery",t)})}},{key:"__getRealProcessId",value:function(e,t){var n=m,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=f.toObject(e.data.data)[0].process_unique_id;t(n)}),i.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger("__getRealProcessId Failed"+e.data.data)}),i.execute({query:"SELECT process_unique_id FROM SFProcess WHERE process_id = '{{process_id}}'",queryParams:{process_id:e}})}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(11).Facade,m=n(7).SystemData,v=n(13).Operation,g=n(7).Cache,y={name:"com.servicemax.client.offline.sal.model.sfmconsole.operations"},S=f.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.sfmdelivery.operations"),E=m;y.GetUserInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){t.result(E.getUserInfo())}}]),t}(v),y.GetAppInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n={version:"0.0.0",server_version:"N/A",org_type:"Unknown",org_tag:"NA",user_name:"ServiceMax User",user_login:"user@servicemax.com"},i=[this.__getLoginInfo()];f.when(i).then(f.proxy(this,function(e){var i=[this.__getUserInfo()];f.when(i).then(f.proxy(this,function(i){e=e||{},i=i||{},n.version=e.AppVersion||n.version,n.server_version=i.SvmxVersion||n.server_version,n.org_type=e.EnvDefault||n.org_type,n.org_tag=e.EnvTag||n.org_tag,n.user_name=i.UserName||n.user_name,n.user_login=i.UserLogin||n.user_login,t.result(n)}))}))}},{key:"__getLoginInfo",value:function(){var e=f.Deferred(),t=p,n=t.createLoginInfoRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data;e.resolve(n)},this),n.bind("REQUEST_ERROR",function(t){e.resolve({})},this),n.execute(),e.promise()}},{key:"__getUserInfo",value:function(){var e=f.Deferred(),t=g.readFromDBCache("USER_INFO");return t.done(function(t){e.resolve(f.toObject(t))}),t.fail(function(){e.resolve({})}),e.promise()}}]),t}(v),y.RetrieveDisplayTags=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){E.getDisplayTags({onSuccess:function(e){t.result(e)},onError:function(e){S.error("getDisplayTags Failed");var n=f.getClient().getServiceRegistry().getService("com.servicemax.client.translation");t.result(n.getInstance())}})}}]),t}(v),y.RetrieveOnDemandAppSettings=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=p,i=n.createSQLRequest(),a=e.settings,r=a.join("','"),o="SELECT setting_id, value FROM MobileDeviceSettings WHERE setting_id IN ('"+r+"')";i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data||[],i=0,a=n.length,r={};for(i;i<a;i++){var o=n[i],s=o.setting_id,l="true"===o.value.toString().toLowerCase();r[s]=l}t.result(r)},this),i.bind("REQUEST_ERROR",function(e){t.result({})},this),i.execute({query:o})}}]),t}(v),f.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=E.Deferred(),n=Y.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(n){t.resolve(n.data.data),e.onSuccess&&(e.state?b.proxy(e.context,e.onSuccess)(e.state,n):b.proxy(e.context,e.onSuccess)(n))}),n.bind("REQUEST_ERROR",function(n){t.reject(n.data.data),e.onError&&(e.state?b.proxy(e.context,e.onError)(e.state,n):b.proxy(e.context,e.onError)(n))}),n.execute({query:e.query,queryParams:e.queryParams}),t}var r=n(50),o=i(r),s=n(30),l=i(s),c=n(16),u=i(c),d=n(1),_=i(d),h=n(2),f=i(h),p=n(6),m=i(p),v=n(3),g=i(v),y=n(4),S=i(y),E=n(10),b=n(0).utils,T=n(12).DatetimeUtil,M=n(7).SystemData,I=n(7).MetaData,C=n(7).Data,A=n(7).Attachments,D=n(7).Cache,x=n(11).Facade,R=n(7).SyncData,O=n(5).SVMXObject,L=n(7).FieldSet,k=n(7).ServerInfo,N=n(7).CheckListChunkUtils,w=n(7).Expressions,F=n(11).File,P={name:"com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils"},q=M,V=I,B=C,j=A,H=D,z=k,U="",Y=x,W=R,G=b.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils");P.Utils=function(e){function t(){(0,f.default)(this,t);var e=(0,g.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments));return e.__templateData={},e.__specialFieldsData={},e.__expressionsInfo=null,e.__sortingOptions=null,e}return(0,S.default)(t,e),(0,m.default)(t,[{key:"getUserInfo",value:function(e,t,n){var i=q.getUserInfo(),a=T.macroDrivenDatetime("Tomorrow",i.DateFormat,i.TimeFormat,"date"),r=T.macroDrivenDatetime("Yesterday",i.DateFormat,i.TimeFormat,"date"),o=T.macroDrivenDatetime("Today",i.DateFormat,i.TimeFormat,"date"),s=T.getFormattedDatetime(T.getCurrentDatetime(T.getSaveFormat("dateTime")),i.DateFormat+" "+i.TimeFormat);return i.Yesterday=r,i.Tomorrow=a,i.Today=o,i.Now=s,i.DateFormat=i.DateFormat,i.TimeFormat=i.TimeFormat,i.Locale=i.Language,i.amText="AM",i.pmText="PM",i}},{key:"getTemplate",value:function(e,t){var n="",i=this;this.__getDocTemplateId(e.ProcessId,"",function(a){var r=a.docTemplateId;r?setTimeout(function(){i.__getTemplateLocation(r,function(a){a?(n=a.filePath.replace(/\//g,"\\\\"),setTimeout(function(){i.__readTemplate(n,function(n){n?t(n):(console.error("Read template failed for process.id: "+e.ProcessId),t(!1))})},100)):(console.error("Unable to retrieve o/p doc template  file path for process.id: "+e.ProcessId),t(!1))})},100):(console.error("Unable to retrieve o/p doc template for process.id: "+e.ProcessId),t(!1))})}},{key:"__getDocTemplateId",value:function(e,t,n){var i=x,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){var i=e.data.data;if(i&&i.length){var a={docTemplateId:b.toObject(i)[0].doc_template_id,recordId:t,sfProcessId:b.toObject(i)[0].process_id,inSkipSections:b.toObject(i)[0].include_skipped_sections||""};n(a)}},this),a.bind("REQUEST_ERROR",function(e){G.error(" __getDocTemplateId Failed. Error : "+e.data.data),n(!1)}),a.execute({query:"SELECT * FROM SFProcess WHERE process_unique_id = '{{process_id}}'",queryParams:{process_id:e},async:!0})}},{key:"__getTemplateLocation",value:function(e,t){var n=x,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i=n&&n.length?{filePath:b.toObject(n)[0].file_path}:null;t(i)},this),i.bind("REQUEST_ERROR",function(e){G.error(" __getTemplateLocation Failed. Error : "+e.data.data),t(!1)}),i.execute({query:"SELECT file_path FROM SFAttachments WHERE parent_id = '{{parent_id}}' ORDER BY datetime(last_modified_date) DESC LIMIT 1",queryParams:{parent_id:e},async:!0})}},{key:"__readTemplate",value:function(e,t){var n=x.createFileRequest(),i={type:"FILEIO",operation:"READ",file:e,parameters:{file:e},async:!0};n.bind("REQUEST_COMPLETED",function(e){var n=e.data.data;t({Template:n})},this),n.bind("REQUEST_ERROR",function(e){G.error(" __readTemplate  Failed. Error Info : "+e.data.data),t(!1)}),n.execute(i)}},{key:"describeObject",value:function(e,t){return V.describeObject({objectName:e.objectName,onSuccess:b.proxy(this,function(e){return e}),onError:b.proxy(this,function(e){return{}})})}},{key:"getDocumentMetaData",value:function(e,t){var n=this;this.__getImageNames(e,function(e){var i=(e.MediaResources,e.DocTemplateId),a=e.sfProcessId,r=e.inSkipSections;setTimeout(function(){n.__getAllObjectInfo(i,function(e){var i={AllObjectInfo:e};n.__getBusinessRules(a,function(e){var n={};n[b.OrgNamespace+"__SM_Include_Skipped_Sections__c"]="true"==r.toLocaleLowerCase(),i.outputDocConfigurationObject={lstSelectedChecklistProcess:e,processOutputDoc:n},t(i)})})},100)})}},{key:"__getAllObjectInfo",value:function(e,t){var n=x,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data;if(n&&n.length)for(var i="",a="",r="",o="",s="",l="",c=0;c<n.length;c++)U=b.toJSON(n[c].fields),a='"Id":""',r='"'+b.OrgNamespace+'__Fields__c":'+U,o='"'+b.OrgNamespace+'__Object_Name__c":"'+n[c].object_name+'"',s='"'+b.OrgNamespace+'__Alias__c":"'+n[c].alias+'"',l='"'+b.OrgNamespace+'__Type__c":"'+n[c].type+'"',i=i+"{"+a+","+r+","+o+","+s+","+l+"},";i=i.substring(0,i.lastIndexOf(","));var u="["+i+"]";t(b.toObject(u))},this),i.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getMediaResources Failed"+e.data.data)}),i.execute({query:"SELECT fields, type, alias, object_name FROM SFDocTemplateDetail WHERE doc_template  = '{{id}}'",queryParams:{id:e},async:!0})}},{key:"__getImageNames",value:function(e,t){var n=this;this.__getDocTemplateId(e.ProcessId,"",function(e){var i=e.docTemplateId,a=e.sfProcessId,r=e.inSkipSections;setTimeout(function(){n.__getMediaResources(i,function(e){if(e){var n={MediaResources:e.mediaResources,DocTemplateId:i,sfProcessId:a,inSkipSections:r};t(n)}})},100)})}},{key:"__getMediaResources",value:function(e,t){var n=x,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i=n&&n.length?{mediaResources:b.toObject(n)[0].media_resources}:null;t(i)},this),i.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getMediaResources Failed"+e.data.data)}),i.execute({query:"SELECT media_resources FROM SFDocTemplate WHERE Id = '{{id}}'",queryParams:{id:e},async:!0})}},{key:"__getBusinessRules",value:function(e,t){a({query:"Select * FROM SFProcessBusinessRule WHERE target_manager = '{{processId}}'",queryParams:{processId:e},state:{callback:t,bzInfo:{}},context:this,onSuccess:"__getProcessBusinessRuleSuccess",onError:"__getBusinessRulesError"})}},{key:"__getProcessBusinessRuleSuccess",value:function(e,t){var n=e.bzInfo.pbz=t.data.data;if(0===n.length)return void e.callback([]);a({query:"Select * FROM SFBusinessRule WHERE Id in ('{{ids}}')",queryParams:{ids:n.map(function(e){return e.business_rule}).join("','")},state:e,context:this,onSuccess:"__getBusinessRuleSuccess",onError:"__getBusinessRulesError"})}},{key:"__getBusinessRuleSuccess",value:function(e,t){a({query:"Select * FROM SFExpressionComponent WHERE expression_id in ('{{ids}}') and expression_type IN ('Business_Rule', 'Field_Update_Rule')",queryParams:{ids:(e.bzInfo.bz=t.data.data).map(function(e){return e.Id}).join("','")},state:e,context:this,onSuccess:"__getBusinessRuleExpressionsSuccess",onError:"__getBusinessRulesError"})}},{key:"__getBusinessRuleExpressionsSuccess",value:function(e,t){function n(t){for(var n=t,i=e.bzInfo.pbz,a=e.bzInfo.pbz.length,r=void 0,o=0;o<a;o++)if(n===i[o].Id){r=i[o];break}return r}e.bzInfo.bzExp=t.data.data,function(){for(var t=e.bzInfo.bzExp||[],n=t.length,i={},a=0;a<n;a++)i[t[a].expression_id+"."+t[a].sequence]=t[a];t=e.bzInfo.bzExp=[];for(var r in i)t.push(i[r])}();var i=[];for(var a in e.bzInfo.pbz){var r=e.bzInfo.pbz[a].process_node_object;i.push({sequence:e.bzInfo.pbz[a].sequence,message:e.bzInfo.pbz[a].error_msg,checklistProcessSFId:r,ruleInfo:{bizRule:function(t,i){var a=e.bzInfo.bz||[],r=void 0,o=a.length,s={};for(r=0;r<o;r++)if(a[r].Id==t){var l=a[r];s={},"CHECKLIST"===e.processType&&(s.source_object_name=b.getCustomObjectName("Checklist"));var c=n(i);if(c){s.Name=l.name,s[b.OrgNamespace+"__ProcessID__c"]=l.process_ID,s[b.OrgNamespace+"__Description__c"]=l.description,s[b.OrgNamespace+"__Source_Object_Name__c"]=l.source_object_name,s[b.OrgNamespace+"__Parent_Error_Msg__c"]=l.error_msg,s[b.OrgNamespace+"__Advance_Expression__c"]=l.advanced_expression,s[b.OrgNamespace+"__Message_Type__c"]=l.message_type,s[b.OrgNamespace+"__Rule_Type__c"]=l.rule_type,s[b.OrgNamespace+"__SM_Section__c"]=c.section,s[b.OrgNamespace+"__SM_Target_Section__c"]=c.target_section,s[b.OrgNamespace+"__Sequence__c"]=c.sequence;break}}return s}(e.bzInfo.pbz[a].business_rule,e.bzInfo.pbz[a].Id),bizRuleDetails:function(t){var n=e.bzInfo.bzExp||[],i=void 0,a=n.length,r=[],o=void 0;for(i=0;i<a;i++)n[i].expression_id==t&&(o=n[i],r.push(o),o[b.OrgNamespace+"__Expression_Rule__c"]=o.expression_id,o[b.OrgNamespace+"__Field_Name__c"]=o.source_field_name,o[b.OrgNamespace+"__Operator__c"]=o.operator,o[b.OrgNamespace+"__Operand__c"]=o.value,o[b.OrgNamespace+"__Display_Type__c"]=o.field_type,o[b.OrgNamespace+"__Sequence__c"]=o.sequence,o[b.OrgNamespace+"__Parameter_Type__c"]=o.parameter_type,o[b.OrgNamespace+"__Expression_Type__c"]=o.expression_type,o[b.OrgNamespace+"__Formula__c"]=o.formula,o[b.OrgNamespace+"__Action_Type__c"]=o.action_type);return r}(e.bzInfo.pbz[a].business_rule)}})}e.callback(i)}},{key:"__getBusinessRulesError",value:function(e,t){e.callback([])}},{key:"getDocumentData",value:function(e,t){var n=this;this.__opdocConfiguredChecklist=[],this.__getDocTemplateId(e.ProcessId,e.RecordId,function(e){var i=e.docTemplateId,a=e.recordId,r=e.sfProcessId;setTimeout(function(){n.__getOPDOCChecklistDetails(r,function(e){e&&e.length>0&&(n.__opdocConfiguredChecklist=e),n.__getProcessNodeDetails(r,function(e){var o=0,s=e.length;for(this.__expressionsInfo={},this.__sortingOptions={},o=0;o<s;o++)this.__expressionsInfo[e[o].doc_template_detail_id]=e[o].expression_id,this.__sortingOptions[e[o].doc_template_detail_id]=e[o].advanced_options;n.__getTemplateDetails(i,a,function(e){if(e){var i=0,o=e.recs.length,s=[];for(i=0;i<o;i++){var l=e.recs[i];a=e.recordId;var c=n.__constructQueries(l,a);s.push(c)}n.__docDetailsCollection=s,n.__executeDocumentDetails(r,a,s,n.__finalizeData,n,t)}})},n)},n)},100)})}},{key:"__getProcessNodeDetails",value:function(e,t,n){var i=b.string.substitute("SELECT Id, process_id, expression_id, doc_template_detail_id, advanced_options  FROM SFProcessComponent where process_id = '{{processId}}'",{processId:e});this.__executeQuery(i,function(e){t.call(n,e)},this)}},{key:"__getOPDOCChecklistDetails",value:function(e,t,n){var i=b.string.substitute("SELECT ChecklistProcessId, ChecklistVersion  FROM SFChecklistOPDOC where OPDOCProcessId = '{{processId}}'",{processId:e});this.__executeQuery(i,function(e){t.call(n,e)},this)}},{key:"__isChecklistAttachmentEnabled",value:function(){if(z){return z.getMultiServerVersionRequest().isChecklistAttachementsEnabled()}return!1}},{key:"__isTableInDatabase",value:function(e){var t=!1;return V.isTableInDatabase(e)&&(t=!0),t}},{key:"__fetchRelatedRecords",value:function(e,t,n,i){var a=this;if(!this.__isChecklistAttachmentEnabled()&&!this.__isTableInDatabase(b.OrgNamespace+"__SM_Checklist_Attachment__c"))return void(n&&n.call(i,[]));var r=b.OrgNamespace+"__SM_Checklist_Attachment__c",o=b.string.substitute("SELECT "+r+".*,SFAttachments.file_path,SFAttachments.name as attachmentName, SFAttachments.Id as recordId FROM "+r+" "),s=z.getMultiServerVersionRequest();if(s.isSalesForceFilesEnabled()&&(o+=b.string.substitute(" LEFT JOIN ContentDocumentLink ON ContentDocumentLink.Id = "+r+"."+b.OrgNamespace+"__SM_ContentDocumentLink_ID__c ")),o+=b.string.substitute(" LEFT JOIN SFAttachments ON SFAttachments.Id = "+r+"."+b.OrgNamespace+"__SM_Attachment_ID__c "),s.isSalesForceFilesEnabled()&&(o+=b.string.substitute(" OR SFAttachments.Id = "+r+"."+b.OrgNamespace+"__SM_ContentDocumentLink_ID__c OR SFAttachments.content_document_id = ContentDocumentLink.ContentDocumentID ")),this.__finalChecklistRecordsId&&this.__finalChecklistRecordsId.length>0){var l="'"+this.__finalChecklistRecordsId.join("','")+"'";o+=" WHERE ("+b.OrgNamespace+"__SM_Checklist__c IN ("+l+"))",this.__executeQuery(o,function(r){var o=[];r&&r.length>0?a.__getFilePath(r,e,t,function(e){for(var t={},a=0;a<e.length;a++){var r=e[a],s=r[b.OrgNamespace+"__SM_Checklist__c"];t[s]||(t[s]=[]),t[s].push(r)}for(var l in t){var c={headerRecordId:l,records:t[l]};o.push(c)}n.call(i,o)},a):n.call(i,o)},this)}else n.call(i,[])}},{key:"__getFilePath",value:function(e,t,n,i,a){var r=this,o=this,s=e.length;if(e.length>0)for(var l=0;l<e.length;l++)!function(l){var c=Y.createFileRequest(),u=e[l],d=u.attachmentName;d||(d=""),u[b.OrgNamespace+"__SM_Attachment_Name__c"]=d,o.__updateChecklistAttachment(u,t,n),c.bind("REQUEST_COMPLETED",function(t){var n=t.data.data;n&&(u.filePath=n.FilePath),0==--s&&i.call(a,e)},r),c.bind("REQUEST_ERROR",function(t){u.filePath="",0==--s&&i.call(a,e)},r);var _=u.file_path;c.execute({operation:"INFO",file:_})}(l);else i.call(a,e)}},{key:"__updateChecklistAttachment",value:function(e,t,n){if("image"===e[b.OrgNamespace+"__SM_File_Type__c"].toLowerCase()){var i=e.recordId,a=b.OrgNamespace+"__SM_Attachment_Name__c",r=b.string.substitute("INSERT INTO SmartDocSignature (Id, name, process_id, record_id, unique_id, attachment) VALUES('"+i+"', '"+e[a]+"', '"+t+"', '"+n+"', 'checklist_attachments', 'true')");this.__executeQuery(r,function(e){})}}},{key:"__getSortString",value:function(e,t){var n=E.Deferred(),i="";if(e&&e.lstSortingRec){var a=void 0;L.getFieldSet(t,function(t){a=t;for(var r=e.lstSortingRec,o=0;o<r.length;o++){var s=r[o].queryField||r[o].queryfield;a.getFieldType(s)&&(i&&(i+=", "),i+=s,i+=" "+r[o].sortingOrder)}i&&(i=" ORDER BY "+i),n.resolve(i)})}else n.resolve(i);return n}},{key:"__executeTemplateQueries",value:function(e,t){this.__templateData={};var n=e.firstLevelQuery,e=e,i=e.objName;if(i===b.OrgNamespace+"__Checklist__c"){var a=k.getMultiServerVersionRequest();if(a.getArrayCollectionForChecklistTemplate(e),n=a.getFirstLevelQueryForChecklistInOpdoc(n),this.__opdocConfiguredChecklist.length>0){var r=this.__opdocConfiguredChecklist.map(function(e){return e.ChecklistProcessId});if(r&&r.length>0){var o="'"+r.join("','")+"'";n+=" AND ("+b.OrgNamespace+"__ChecklistProcessID__c IN ("+o+"))"}}}if(void 0!==n&&null!==n){var s=E.Deferred(),l=this.__sortingOptions[e.docTemplateDetailId];if(void 0!==l&&null!==l){l=b.toObject(l);this.__getSortString(l,i).then(b.proxy(this,function(e){void 0!==e&&null!==e&&e.length>0&&(n+=e),s.resolve()}))}else s.resolve();s.then(b.proxy(this,function(){"Detail_Object"===e.type&&e.objName!==b.getCustomObjectName("Checklist")?B.getExpr(i,this.__expressionsInfo[e.docTemplateDetailId]).then(b.proxy(this,function(n){this.__getOpdocTemplateDetailLine(i,e,n,t).then(b.proxy(this,function(n,a){var r=[],o=(e.firstLevelInfo,e.secondLevelInfo),s=(0,u.default)(o),l=e.thirdLevelInfo,c=(0,u.default)(l);for(var d in n){var _=n[d],h={};for(var f in a){var p=a[f];h[p]=_[p]}for(var m in s){var v=s[m],g=o[v];h[v]=_[v],h[g.relationName]={Id:_[v]};var y=I.getNameField(g.objName);h[g.relationName][y]=_[g.relationName]||_[g.relationName+"SFRecordName"]||_.SFRecordNamefield;for(var S in g.arrCols){var E=g.relationName+"."+g.arrCols[S];-1===c.indexOf(E)&&g.arrCols[S]!==y&&(h[g.relationName][g.arrCols[S]]=_[g.relationName+g.arrCols[S]])}}var T=void 0;L.getFieldSet(i,function(e){T=e});for(var M=T.getFieldsByType("reference"),C=0;C<M.length;C++){var A=M[C];if(h[A.name]||(h[A.name]=_[A.name]),!h[A.relationshipName]){h[A.relationshipName]={Id:_[A.name]};var D=I.getNameField(A.referenceTo[0]);h[A.relationshipName][D]=_[A.relationshipName]||""}}r[d]=h}if(this.__templateData[e.alias]=r,0===this.__getObjectLength(l))this.__processDateTimeFields(e),t&&t.call();else{var x={},R=[];for(d=0;d<n.length;d++){var O=n[d];for(var k in l){var N=k.split(".");if(void 0!==O[N[0]]&&null!==O[N[0]]){var w=O[N[0]+N[1]];void 0!==w&&null!==w&&(void 0!==x[k]&&null!==x[k]||(x[k]=""),x[k]+=",'"+w+"'",R.push(w),this.__templateData[e.alias][d][N[0]+N[1]]=w)}}}var F=b.string.substitute("SELECT * FROM SFRecordName WHERE Id IN ({{tempRefIds}})",{tempRefIds:"'"+R.join("','")+"'"});this.__executeQuery(F,function(n){this.__queryLevelData(l,x,e,this.__processThirdLevelData,t,this,n)},this)}}))})):this.__getOpdocTemplateData(n,i,e,t)}))}}},{key:"__getOpdocTemplateDetailLine",value:function(e,t,n,i){var a=new E.Deferred,r=void 0,o=[];L.getFieldSet(e,function(e){r=e}),r&&r.forEach(function(e){o.push(e)});for(var s=(0,u.default)(t.secondLevelInfo),l=[],c=[],d=0;d<o.length;d++){var _=o[d];if("reference"===_.dataType&&-1===s.indexOf(_.name)){var h={name:_.name,referenceTo:_.referenceTo[0],relationshipName:_.relationshipName};l.push(h)}else c.push(_.name)}for(var f="MAIN."+t.headerDetails.refField+" = '"+t.headerDetails.recId+"'",p=[],m=["MAIN.* "],v={},g=0;g<s.length;g++){var y=t.secondLevelInfo[s[g]],S=t.secondLevelInfo[s[g]].arrCols,T=(y.relationName?y.relationName+"Table":"table"+g)+"SFRecordName",M=b.string.substitute("LEFT JOIN `{{referenceTo}}` AS {{alias}} ON MAIN.{{fieldName}} = `{{alias}}`.{{fldName}}",{referenceTo:"SFRecordName",fieldName:s[g],alias:T,fldName:"Id"});if(p.push(M),V.isTableInDatabase(y.objName)){var C=y.relationName?y.relationName+"Table":"table"+g,A=b.string.substitute("LEFT JOIN `{{referenceTo}}` AS {{alias}} ON MAIN.{{fieldName}} = `{{alias}}`.{{fldName}}",{referenceTo:y.objName,fieldName:s[g],alias:C,fldName:y.fldName});p.push(A);var D="`"+C+"`.",R=[],O=[],k=I.getNameField(y.objName);for(var N in S)k!==S[N]&&R.push(D+S[N]+" AS "+y.relationName+S[N]);R.push(D+k+" AS "+(y.relationName||"field"+g)),O.push("`"+C+"SFRecordName`.Name AS "+(y.relationName+"SFRecordName"||"field"+g+"SFRecordName")),m.push(R.join(",")),m.push(O.join(",")),v[C]=y.relationName||"field"+g}else{var w=[];w.push("`"+T+"`.Name AS SFRecordNamefield"),m.push(w.join(","))}}for(var F=0;F<l.length;F++){var P=l[F],q=P.referenceTo;if(V.isTableInDatabase(q)){var C=P.relationshipName?P.relationshipName+"Table":"table"+F,A=b.string.substitute("LEFT JOIN `{{referenceTo}}` AS {{alias}} ON MAIN.{{fieldName}} = `{{alias}}`.Id",{referenceTo:q,fieldName:P.name,alias:C});p.push(A);var R=I.getNameField(q);m.push(b.string.substitute("`{{tableName}}`.{{nameField}} AS {{relationshipName}}",{referenceTo:q,nameField:R,tableName:C,relationshipName:P.relationshipName||"field"+F})),v[P.name]=P.relationshipName||"field"+F}}B.buildQueryForExpression(n,v);var j=b.string.substitute("SELECT {{fieldList}}\n FROM `{{tableName}}` AS MAIN\n {{joins}}\n WHERE {{whereClause}}",{fieldList:m,tableName:e,joins:p.join("\n"),whereClause:f});n&&n.advancedExpression&&(j=j+" AND ("+n.advancedExpression+")");var H=x,z=H.createSQLRequest();return z.bind("REQUEST_COMPLETED",function(e){G.info("Successfully obtained 1st level and 2nd level data of childLine"),a.resolve(e.data.data,c)},this),z.bind("REQUEST_ERROR",function(e){G.info("something went wrong in obtaining 1st and 2nd level data for childline"),a.resolve()},this),z.execute({query:j,async:!0}),a}},{key:"__getOpdocTemplateData",value:function(e,t,n,i){var a=this;this.__executeQueryValidateExpression(e,t,n.arrCols,function(e){var r=0,o=n.secondLevelInfo,s={},l={},c=[];this.__sortingOptions[n.docTemplateDetailId];t===b.OrgNamespace+"__Checklist__c"&&(this.__mapRemoteId(e),e&&e.length>0&&(e=a.__processChecklistVersionFilter(e)),a.__getFinalChecklistRecordIds(e)),s=e;for(r=0;r<s.length;r++){var u=s[r];for(var d in o){var _=u[d];void 0!==_&&null!==_&&(void 0!==l[d]&&null!==l[d]||(l[d]=""),c.push(_),l[d]+=",'"+_+"'")}}if(this.__templateData[n.alias]=s,0===this.__getObjectLength(o))this.__processDateTimeFields(n),i.call();else{var h=b.string.substitute("SELECT * FROM SFRecordName WHERE Id IN ({{tempRefIds}})",{tempRefIds:"'"+c.join("','")+"'"});this.__executeQuery(h,function(e){this.__queryLevelData(o,l,n,this.__processSecondLevelData,i,this,e)},this)}},this.__expressionsInfo[n.docTemplateDetailId],this)}},{key:"__mapRemoteId",value:function(e){var t=b.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),n=t&&t.__syncEventCol&&t.__syncEventCol.getState("MAP_REMOTE_IDS");if(n)for(var i=0;i<e.length;i++){var a=e[i],r=a&&a.Id;r&&/local/i.test(r)&&n[r]&&(a.Id=n[r])}}},{key:"__processChecklistVersionFilter",value:function(e){var t=this,n=[];if(this.__opdocConfiguredChecklist.length>0)for(var i=0;i<this.__opdocConfiguredChecklist.length;i++)!function(i){var a=t.__opdocConfiguredChecklist[i],r=a.ChecklistProcessId,o=e.filter(function(e){return e[b.OrgNamespace+"__ChecklistProcessID__c"]===r});o.length>0&&("All Versions"===a.ChecklistVersion?n=n.concat(o):(o.sort(function(e,t){return new Date(e.CreatedDate)-new Date(t.CreatedDate)}),"First Version"===a.ChecklistVersion?n.push(o[0]):n.push(o[o.length-1])))}(i);else for(var i=0;i<e.length;i++)n.push(e[i]);return n}},{key:"__getFinalChecklistRecordIds",value:function(e){this.__finalChecklistRecordsId=e.map(function(e){return e.Id})}},{key:"__processDateTimeFields",value:function(e){var t=q.getUserInfo(),n=t.TimezoneOffset,i=e.specialFields;this.__specialFieldsData[e.alias]=[];for(var a=this.__templateData[e.alias],r=0;r<a.length;r++){var o={},s=a[r];o.Key=s.Id;var l=[];for(var c in i){var u={},d=s[c],_=c.split(".");void 0!==_&&null!==_&&2===_.length&&(d=s[_[0]][_[1]]);var h=i[c];"date"===h&&(u.Value=d?T.convertDatetimeForSave(d):d),"datetime"===h&&(u.Value=d?T.convertToTimezone(d,n,!1):d),u.Key=c,u.Info=i[c],l.push(u)}o.Value=l,this.__specialFieldsData[e.alias].push(o)}}},{key:"__queryLevelData",value:function(e,t,n,i,a,r,o){var s=[];for(var l in e){var c=void 0!==e[l].cols&&null!==e[l].cols&&e[l].cols.length>1?e[l].cols.substring(1):"",u=e[l].objName,d=void 0!==t[l]&&null!==t[l]&&t[l].length>1?t[l].substring(1):"",_=e[l].fldName;if(0!==c.length&&2!==d.length){c="Id,"+c,e[l].arrCols.push("Id");var h=b.string.substitute("SELECT * FROM '{{table_name}}' WHERE {{fldName}} IN ({{ids}})",{cols:c,table_name:u,ids:d,fldName:_});s.push({type:l,query:h,arrCols:e[l].arrCols,refId:d,objectType:e[l].objName})}}s.length>0?this.__executeQueryCollection(s,i,n,a,r,o):i.call(r,{},n,a,r)}},{key:"__getObjectLength",value:function(e){var t=0,n=void 0;for(n in e)e.hasOwnProperty(n)&&t++;return t}},{key:"__processSecondLevelData",value:function(e,t,n,i){var a={},r=[];for(var o in e)for(var s=e[o],c=0;c<s.length;c++)a[s[c].Id]=a.hasOwnProperty(s[c].Id)?(0,l.default)(a[s[c].Id],s[c]):s[c];var u=t.alias,d=t.secondLevelInfo,_=i.__templateData[u],h=t.thirdLevelInfo;for(c=0;c<_.length;c++){var f=_[c];for(var p in d){var m=f[p],v=d[p].relationName;void 0!==m&&null!==m&&void 0!==a[m]&&null!==a[m]?f[v]=a[m]:f[v]={}}}if(0===this.__getObjectLength(h))this.__processDateTimeFields(t),n.call();else{var g={};for(c=0;c<_.length;c++){var f=_[c];for(var p in h){var y=p.split(".");if(void 0!==f[y[0]]&&null!==f[y[0]]){var S=f[y[0]][y[1]];void 0!==S&&null!==S&&(void 0!==g[p]&&null!==g[p]||(g[p]=""),r.push(S),g[p]+=",'"+S+"'")}}}var E=b.string.substitute("SELECT * FROM SFRecordName WHERE Id IN ({{tempRefIds}})",{tempRefIds:"'"+r.join("','")+"'"});this.__executeQuery(E,function(e){this.__queryLevelData(h,g,t,this.__processThirdLevelData,n,this,e)},this)}}},{key:"__processThirdLevelData",value:function(e,t,n,i){var a={};for(var r in e)for(var o=e[r],s=0;s<o.length;s++)a[o[s].Id]=o[s];var l=t.alias,c=this.__templateData[l],u=t.thirdLevelInfo;for(s=0;s<c.length;s++){var d=c[s];for(var _ in u){var h,f=_.split(".");void 0!==d[f[0]]&&null!==d[f[0]]&&(h=t.objName===b.getCustomObjectName("Service_Order_Line")?d[f[0]+f[1]]:d[f[0]][f[1]]);var p=u[_].relationName,m=p.split(".");void 0!==h&&null!==h&&void 0!==a[h]&&null!==a[h]?d[m[0]][m[1]]=a[h]:d[m[0]][m[1]]={}}}this.__processDateTimeFields(t),n.call()}},{key:"__executeDocumentDetails",value:function(e,t,n,i,a,r){for(var o=this,s=n.length,l=s,c=0;c<s;c++)a.__executeTemplateQueries(n[c],function(){0==--l&&o.__fetchRelatedRecords(e,t,function(e){e&&(o.__checklistRelatedRecords=e),i.call(a,r)},o)},a)}},{key:"__finalizeData",value:function(e){var t=[];for(var n in this.__templateData){var i=[];n.indexOf("Checklist")>-1&&(i=this.__checklistRelatedRecords),t.push({SpecialFields:this.__specialFieldsData[n],Records:this.__templateData[n],Key:n,relatedRecords:i})}if(t.length>0&&this.__docDetailsCollection.length>0){for(var a=0;a<t.length;a++)for(var r=0;r<this.__docDetailsCollection.length;r++)t[a].Key&&this.__docDetailsCollection[r].alias&&t[a].Key==this.__docDetailsCollection[r].alias&&(t[a].docTemplateDetailId=this.__docDetailsCollection[r].docTemplateDetailId);for(var a=0;a<t.length;a++)if(t[a].docTemplateDetailId){var o=t[a].docTemplateDetailId;if(this.__sortingOptions){var s=this.__sortingOptions[o];void 0!=s&&null!=s&&""!=s&&(s=b.toObject(s),t[a].Records&&t[a].Records.length>0&&(t[a].Records=this.__sortLines(t[a].Records,s)))}}}var l=this;setTimeout(function(){l.__constructData(t,function(t){e(t)})},100)}},{key:"__sortLines",value:function(e,t){var n=(t.lstSortingRec,function e(n,i,a){var r=t.lstSortingRec[a],o=r.fieldAPIName,s=null,l=void 0,c=void 0;return"REFERENCE"==r.dataType?(o=r.queryField.split(".")[0],s=r.queryField.split(".")[1],l=n[o][s],c=i[o][s]):(l=n[o],c=i[o]),l&&"number"!=typeof l&&(l=l.toLowerCase()),c&&"number"!=typeof c&&(c=c.toLowerCase()),l===c&&a!=t.lstSortingRec.length-1?e(n,i,a+1):void 0==l||null==l?-1:void 0==c||null==c?1:"ASC"==r.sortingOrder?l<c?-1:1:l<c?1:-1});return t.lstSortingRec.length>0&&e.sort(function(e,t){return n(e,t,0)}),e}},{key:"__executeQueryCollection",value:function(e,t,n,i,a,r){var o=this,s=void 0,l=e.length,c={},u=l;for(s=0;s<l;s++)this.executeQuery(e[s].query,e[s].type,e[s].arrCols,function(e,s,l,d,_){b.getLoggingService().getLogger("Remaining Query count: "+u);var h=0,f=0,p=[];for(h=0;h<s.length;h++){var m={};for(f=0;f<l.length;f++)m[l[f]]=s[h][l[f]];p.push(m)}if((!s||0===s.length)&&r&&r.length>0){var v=b.array.filter(r,function(e){return e.Id===d.replace(/["']/g,"")});if(v&&v.length>0&&l.length>0&&o.checkArraycolsFieldName(l[0],_)){var g={};g[l[0]]=v[0].Name,g.Id=v[0].Id,p.push(g)}}c[e]=p,0==--u&&(b.getLoggingService().getLogger("Finished now calling back: "+u),t.call(a,c,n,i,a))},a,e[s].refId,e[s].objectType)}},{key:"checkArraycolsFieldName",value:function(e,t){var n="Name";return"Case"===t?n="CaseNumber":"Event"===t||"Task"===t?n="Subject":"Solution"===t?n="SolutionName":"PartnerNetworkConnection"===t&&(n="ConnectionName"),e===n}},{key:"executeQuery",value:function(e,t,n,i,a,r,o){this.__executeQuery(e,function(e){i.call(a,t,e,n,r,o)})}},{key:"__executeQuery",value:function(e,t,n){var i=x,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){t.call(n,b.toObject(e.data.data))},this),a.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger(e.data),t.call(n,!1)},this),a.execute({query:e,async:!0})}},{key:"__getCombinedChecklistInformation",value:function(e){return N.getCombinedChecklistData(e)}},{key:"__executeQueryValidateExpression",value:function(e,t,n,i,a,r){var o=x,s=o.createSQLRequest();s.bind("REQUEST_COMPLETED",function(e){var o=this,s=b.toObject(e.data.data);if(void 0!==a&&null!==a&&a.length>0&&s.length>0){var l,c,u;!function(){l=0,c=s.length,u=s.length;var e=[];for(l=0;l<c;l++){var d=s[l],_=0,h={};if(void 0!==n&&null!==n)for(_=0;_<n.length;_++)h[n[_]]=d[n[_]];var f=k.getMultiServerVersionRequest(),p=f.isChecklistMultiRowSequencingEnabled();t===b.getCustomObjectName("Checklist")&&p?function(t,n){o.__getCombinedChecklistInformation(t).then(function(t){var s=b.getCustomFieldName("ChecklistJSON"),l=b.getCustomFieldName("ChecklistMetaJSON");n[s]=t[s],n[l]=t[l],o.__evaluateExpression(n,a,function(t,n){u--,t[0].result&&e.push(n),0===u&&i.call(r,e)},o)})}(d,h):o.__evaluateExpression(h,a,function(t,n){u--,t[0].result&&e.push(n),0===u&&i.call(r,e)},o)}}()}else if(s.length>0&&t===b.getCustomObjectName("Checklist"))for(var l=0;l<s.length;l++)!function(e,t){o.__getCombinedChecklistInformation(e).then(function(n){var a=b.getCustomFieldName("ChecklistJSON"),o=b.getCustomFieldName("ChecklistMetaJSON");e[a]=n[a],e[o]=n[o],s[t]=e,t+1===s.length&&i.call(r,s)})}(s[l],l);else i.call(r,b.toObject(s))},this),s.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger(e.data),i.call(r,!1)},this),s.execute({query:e,async:!0})}},{key:"__evaluateExpression",value:function(e,t,n,i){w.evaluate({recordId:e.Id,expressionId:t,returnMessage:!0,onSuccess:b.proxy(this,function(t){n.call(i,t,e)}),onError:b.proxy(this,function(t){n.call(i,[{result:!1}],e)})})}},{key:"__constructQueries",value:function(e,t){var n=b.toObject(e.fields).Metadata,i=e.alias,t=t,a=0,r="",o=[],s={},l={},c={},u={},d=[],_={};if(void 0!==n&&null!==n)for(a=0;a<n.length;a++){var h=n[a];if(void 0!==h.FN&&null!==h.FN&&void 0==_[h.FN]&&(_[h.FN]=h.FN,r=r+","+h.FN,o.push(h.FN)),void 0!==h.TYP&&"reference"===h.TYP&&void 0!==h.RFN&&null!==h.RFN){if(void 0!==l[h.FN]&&null!==l[h.FN]||(l[h.FN]={},l[h.FN].cols="",l[h.FN].arrCols=[]),l[h.FN].arrCols.push(h.RFN),l[h.FN].cols+=","+h.RFN,l[h.FN].objName=h.ROBJ,l[h.FN].fldName="Id",l[h.FN].relationName=h.RLN,void 0!==h.RTYP&&"reference"===h.RTYP){var f=h.RLN+"."+h.RFN;void 0!==c[f]&&null!==c[f]||(c[f]={},c[f].cols="",c[f].arrCols=[]),c[f].arrCols.push(h.RFN2),c[f].cols+=","+h.RFN2,c[f].objName=h.ROBJ2,c[f].fldName="Id",c[f].relationName=h.RLN+"."+h.RLN2}else if(void 0!==h.RTYP&&("datetime"===h.RTYP||"date"===h.RTYP)){var f=h.RLN+"."+h.RFN;u[f]=h.RTYP}}else void 0===h.TYP||"datetime"!==h.TYP&&"date"!==h.TYP?d.push(h.FN):u[h.FN]=h.TYP}r=r.substring(1),r="Id,"+r,o.push("Id"),s=b.string.substitute("SELECT * FROM '{{objName}}' WHERE {{fldName}} = '{{recordId}}'",{cols:r,objName:e.object_name,fldName:e.header_ref_fld,recordId:t});var p={};return p.firstLevelQuery=s,p.arrCols=o,p.secondLevelInfo=l,p.thirdLevelInfo=c,p.specialFields=u,p.alias=i,p.objName=e.object_name,p.docTemplateDetailId=e.Id,p.headerDetails={refField:e.header_ref_fld,recId:t},p.firstLevelInfo=d,p.type=e.type,p}},{key:"__constructData",value:function(e,t){var e={Status:!0,Message:"",DocumentData:e};t(e)}},{key:"__firstLevelData",value:function(e,t,n,i){var a=void 0,r="",o="";for(a=0;a<e.length;a++)void 0==e[a].RTYP&&(r=r+","+e[a].FN,o=e[a].OBJ);r=r.substring(1);var s=x,l=s.createSQLRequest();l.bind("REQUEST_COMPLETED",function(e){var t=e.data.data;if(t&&t.length){i({data:t,alias:n})}},this),l.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getMediaResources Failed"+e.data.data)}),l.execute({query:"SELECT {{cols}} FROM '{{objName}}' WHERE Id = '{{recordId}}'",queryParams:{cols:r,objName:o,recordId:t},async:!0})}},{key:"__getTemplateDetails",value:function(e,t,n){var i=x,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){var i=e.data.data,a="";i&&i.length&&(a={recordId:t,recs:i}),n(a)},this),a.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("__getMediaResources Failed"+e.data.data)}),a.execute({query:"SELECT Id, fields, alias, type, header_ref_fld, object_name FROM SFDocTemplateDetail WHERE doc_template  = '{{id}}' ",queryParams:{id:e},async:!0})}},{key:"captureDeviceSignature",value:function(e,t){var n=e.processId,i=e.recordId,a=e.uniqueName,r=(e.capturedSignature,e.imgHeight),o=e.imgWidth,s=x,e=s.createSignatureCaptureRequest();e.bind("REQUEST_COMPLETED",function(e){var n=e.data;n={path:e.data.fileLocation.replace(/\\/g,"/"),height:r,width:o,uniqueName:a},t(n?n:null)},this),e.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("createSignatureRequest Failed"+e.data)}),e.execute({operation:"SIGNATURECAPTURE",type:"SIGNATURECAPTURE",recordId:i,processId:n,uniqueName:a,async:!1})}},{key:"captureHtmlSignature",value:function(e,t){var n=e.processId,i=e.recordId,a=e.uniqueName,r=(e.capturedSignature,e.imgHeight),o=e.imgWidth,s=M.getUserInfo(),l=s.DateFormat;s.TimeFormat,T.convertFormatForExt(l).split(" ")[0];C.getRecord({Id:i,loadReferences:!1,convertPicklists:!1}).done(b.proxy(this,function(s){if(Ext.query("#html_signature_panel").length>0)return void G.warn("Already Signature Panel is Active");var l="";s&&s.Name?l=s.Name+" ":s&&s.CaseNumber&&(l=s.CaseNumber+" "),l+=T.getFormattedDatetime(T.getCurrentDatetime(T.getSaveFormat("dateTime")))+"   ";var c=b.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.CAPTURE_HTML_SIGNATURE",this,{request:{processId:n,recordId:i,uniqueName:a,watermark:l,imgHeight:r,imgWidth:o,signatureTitle:e.signatureTitle,callback:b.proxy(this,t),handler:b.proxy(this,this.onCaptureHtmlSignatureComplete)}});b.getCurrentApplication().triggerEvent(c)}))}},{key:"onCaptureHtmlSignatureComplete",value:function(e){if(e.success){var t=e.data,n=e.isBase64Encoded||!1;if(t){var i=this.__clearSignatureFile({uniqueName:e.uniqueName,processId:e.processId,recordId:e.recordId});i=i.then(b.proxy(this,function(e){return this.__saveSignatureFile({uniqueName:e.uniqueName,processId:e.processId,recordId:e.recordId,data:t,isBase64Encoded:n})})),i=i.then(b.proxy(this,this.__saveSignatureRecord)),i.done(b.proxy(this,function(t){var n={path:t.path,uniqueName:t.uniqueName,width:e.imgWidth,height:e.imgHeight};e.callback(n)})),i.fail(b.proxy(this,function(){e.callback({uniqueName:e.uniqueName})}))}else{var i=this.__clearSignatureFile({uniqueName:e.uniqueName,processId:e.processId,recordId:e.recordId});i.always(b.proxy(this,function(){e.callback({uniqueName:e.uniqueName})}))}}}},{key:"clearOrphanSignatures",value:function(){var e=new b.Deferred,t=a({query:"SELECT name, process_id, record_id, unique_id, attachment FROM SmartDocSignature WHERE html_name = '' OR html_name IS NULL",queryParams:{}});return t=t.then(b.proxy(this,function(t){var n=t.length,i=0;if(n){var a=new b.Deferred;for(a.resolve(),i=0;i<n;i++){var r={fileName:t[i].name,processId:t[i].process_id,recordId:t[i].record_id,uniqueName:t[i].unique_id,attachment:t[i].attachment};a=a.then(b.proxy(this,this.__clearSignatureFile,r))}a.always(b.proxy(this,function(){e.resolve()}))}else e.resolve()})),t.fail(b.proxy(this,function(){e.resolve()})),e}},{key:"__clearSignatureFile",value:function(e){var t=new b.Deferred,n=void 0,i=e.fileName;return i?(n=new b.Deferred,n.resolve({fileName:i})):n=this.__getSignatureRecord({processId:e.processId,recordId:e.recordId,uniqueName:e.uniqueName}),e.attachment&&""!==e.attachment&&"false"!==e.attachment||(n=n.then(b.proxy(this,function(t){return i=t.fileName,this.__deleteSignatureFile({processId:e.processId,recordId:e.recordId,uniqueName:e.uniqueName,fileName:t.fileName})}))),n=n.then(b.proxy(this,function(t){return this.__deleteSignatureRecord({processId:e.processId,recordId:e.recordId,uniqueName:e.uniqueName,fileName:t.fileName})})),n.always(b.proxy(this,function(){t.resolve(e)})),t}},{key:"__getSignatureRecord",value:function(e){var t=new b.Deferred,n=a({query:"SELECT name FROM SmartDocSignature WHERE process_id = '{{processId}}' AND record_id = '{{recordId}}' AND unique_id = '{{uniqueName}}' AND (html_name = '' OR html_name IS NULL)",queryParams:e});return n=n.then(b.proxy(this,function(e){var n=e.length;n?t.resolve({fileName:e[0].name}):t.reject()})),t}},{key:"__deleteSignatureFile",value:function(e){var t=new b.Deferred,n=x.createFileRequest();return n.bind("REQUEST_COMPLETED",function(n){t.resolve(e)},this),n.bind("REQUEST_ERROR",function(n){t.resolve(e)},this),n.execute({operation:"DELETE",file:"{UploadDirectory}/"+e.fileName}),t}},{key:"__deleteSignatureRecord",value:function(e){var t=new b.Deferred;return a({query:"DELETE FROM SmartDocSignature WHERE name = '{{fileName}}' AND process_id = '{{processId}}' AND record_id = '{{recordId}}' AND unique_id = '{{uniqueName}}'",queryParams:e}).always(b.proxy(this,function(){t.resolve(e)})),t}},{key:"__saveSignatureFile",value:function(e){var t=new b.Deferred,n=(new Date).getTime(),i=x.createFileRequest(),a=x.createFileRequest(),r=e.processId+"_"+e.uniqueName+"_"+n+".png";return i.bind("REQUEST_COMPLETED",function(e){a.execute({operation:"Info",file:"{UploadDirectory}/"+r})},this),a.bind("REQUEST_COMPLETED",function(n){var i=n.data.data.FilePath;t.resolve({uniqueName:e.uniqueName,processId:e.processId,recordId:e.recordId,path:i,fileName:r})},this),i.bind("REQUEST_ERROR",function(e){t.reject()},this),a.bind("REQUEST_ERROR",function(e){t.reject()},this),i.execute({operation:"WRITE",file:"{UploadDirectory}/"+r,data:e.data,isBase64Encoded:e.isBase64Encoded}),t}},{key:"__saveSignatureRecord",value:function(e){var t,n=new b.Deferred;return a({query:"INSERT INTO SmartDocSignature (Id, name, html_name, process_id, record_id, unique_id) VALUES('{{id}}', '{{file_name}}', null, '{{process_id}}', '{{record_id}}', '{{unique_id}}')",queryParams:(t={id:"sig_local_"+(new Date).getTime(),record_id:e.recordId,file_name:e.fileName,process_id:e.processId},(0,o.default)(t,"record_id",e.recordId),(0,o.default)(t,"unique_id",e.uniqueName),t)}).always(b.proxy(this,function(){n.resolve({uniqueName:e.uniqueName,processId:e.processId,recordId:e.recordId,path:e.path})})),n}},{key:"__parseHTMLContentForStyle",value:function(e){var t="";if(void 0!==e&&null!==e){var n=e.indexOf("<style"),i=0;-1!=n&&(i=e.indexOf(">",n)+1);var a=e.indexOf("</style>"),r=0;-1!=a&&(r=a),-1!=n&&-1!=a&&(a+=8,t=e.substring(i,r),e=e.substring(0,n)+e.substring(a,e.length))}return'<html><head><style type="text/css">'+t+"body{word-break: break-all}</style> <style>body {font-family: Arial Unicode MS;}</style></head>"+e+"</html>"}},{key:"executeTargetObjectUpdate",value:function(e,t,n){var i=b.Deferred();return a({query:"select process_id from SFProcess where process_unique_id = '{{process_id}}'",queryParams:{process_id:e.processId}}).then(b.proxy(this,function(t){a({query:"select * from SFSourceUpdate LEFT JOIN SFProcessComponent ON SFProcessComponent.Id = SFSourceUpdate.target_process_node where SFProcessComponent.process_id='{{process_id}}' AND configuration_type='Source Update'",queryParams:{process_id:t[0].process_id}}).then(b.proxy(this,function(t){if(0===t.length)return i.resolve(),i;var n=b.create("com.servicemax.client.offline.sal.model.sfmdelivery.operations.SaveTargetRecord");b.array.forEach(t,function(t){n.executeOneSourceObjectUpdate(null,e.sourceRecord,t)}),e.sourceRecord.writeRecord(function(e,t){var n=[],a=[];t&&(e?n.push(t):a.push(t)),B.writeSyncRecords(n,a,[],b.proxy(this,function(){i.resolve()}))},function(e){G.error("Failed to write sourceObjectUpdate record "+inId+": "+e.message+"; "+e.stack),i.resolve()})}))})),i}},{key:"getVersionedContentDocumentId",value:function(e,t){var n=this;if(!e)return t&&t.call(this,null);var i=b.string.substitute("SELECT DISTINCT ContentDocumentId from ContentVersion where {{processIdCol}} = '{{processId}}' ORDER BY LastModifiedDate DESC LIMIT 1",{processIdCol:b.OrgNamespace+"__SM_Process_ID__c",processId:e});this.__executeQuery(i,function(e){var i=null;e&&e.length>0&&(i=e[0].ContentDocumentId),t&&t.call(n,i)},this)}},{key:"finalizeLocal",value:function(e,t,n){var i=e.ProcessId,r=e.RecordId,o=this.__parseHTMLContentForStyle(e.HTMLContent),s=e.SourceRecord,l=x,c=e.MappedRecordIds,e=l.createPDFRequest(),u=this;this.__replaceImagePath(o,c).done(function(l){o=l||o,e.bind("REQUEST_COMPLETED",function(e){if(void 0!==e.data&&null!=e.data&&void 0!==e.data.parameters&&null!==e.data.parameters&&void 0!==e.data.parameters.operation&&null!==e.data.parameters.operation){var t=e.data.parameters.processId,n=e.data.parameters.sourceRecord,i=e.data.parameters.recordId,r=e.data.data,o=e.data.parameters.context,s=e.data.parameters.callback,l=b.string.substitute("SELECT process_id, run_targeted_sync, file_version_enabled FROM SFProcess WHERE process_unique_id = '{{process_id}}'",{process_id:t});u.__executeQuery(l,function(e){B.executeSourceUpdateMapping({processId:e[0].process_id,data:n}).then(function(){j.copyAttachmentIntoDownloads(r,function(r){if(r.success){var o=new F(r.targetPath+"/"+r.targetFileName),s=q.getUserInfo(),l=(s.TimezoneOffset,T.getTimestampWithSaveFormat()),c=T.macroDrivenDatetime("Now","YYYYMMDD","HHmmss").replace(/\s+/g,""),d=t+"_"+i+"_"+c+".pdf",_="local_"+(new Date).getTime();o.execute(),o.info().then(b.proxy(u,function(r,s){var c=q.getUserInfo().UserId,h=o.getPath();h=h.replace(/'/g,"''"),d=d.replace(/'/g,"''");var f=z.getMultiServerVersionRequest(),p=f.isSalesForceFilesEnabled()?"SFILE":null,m=e[0].file_version_enabled,v=m&&"true"===m?""+t+i:null;u.getVersionedContentDocumentId(v,function(e){return a({query:"INSERT INTO SFAttachments (Id, parent_id, file_path, name, last_modified_date, content_length, created_by_id, downloaded, file_type, process_id, content_document_id, content_type) VALUES('{{id}}', '{{record_id}}', '{{target_path}}', '{{file_name}}', '{{last_modified}}', {{size}}, '{{author}}', 'true', '{{fileType}}', '{{processId}}', '{{contentDocumentId}}', '{{contentType}}' )",queryParams:{id:_,record_id:i,file_name:d,target_path:h,last_modified:l,size:s.size,author:c,fileType:p,processId:v,contentDocumentId:e,contentType:"pdf"}}).then(function(){var e=b.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),t=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",u,{request:{recordId:n.Id}});e.triggerEvent(t)})})})).then(b.proxy(u,function(){var e=b.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),t=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",u,{request:{recordId:n.Id}});e.triggerEvent(t);var i=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_INSERTED",u,{request:{recordId:n.Id}});e.triggerEvent(i)})),W.insertAttachment({Id:_,isAttachment:!0,parentId:n.Id||""})}}),j.copyAttachmentIntoUploads(r,function(e){e.success}),b.getCurrentApplication().getSyncImpl().isSyncRunning()?s.call(o,!0):(H.registerJSCache("TARGETEDSYNC",1),H.writeToJSCache("TARGETEDSYNC","recordId",i),V.getObjectNameFromKeyPrefix({key_prefix:i.substr(0,3),onSuccess:function(n){H.writeToDBCache("TARGETED_SYNC_REFERENCE."+i,t+"."+n),s.call(o,!0,e[0].run_targeted_sync)},onError:function(t){b.getLoggingService().getLogger("severe error : objectName not found"),s.call(o,!0,e[0].run_targeted_sync)}}))})},u)}},u),e.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("createSignatureRequest Failed"+e.data)}),e.execute({operation:"GENERATEPDF",type:"GENERATEPDF",recordId:r,processId:i,htmlContent:o,sourceRecord:s,callback:t,context:n,async:!1})})}},{key:"finalizeRemote",value:function(e,t,n){var i=this,r=e.ProcessId,o=e.RecordId,s=this.__parseHTMLContentForStyle(e.HTMLContent),l=e.MappedRecordIds;this.__replaceImagePath(s,l).done(function(l){s=l||s;var c=e.SourceRecord,u=new Date,d=u.getFullYear(),_=u.getMonth()+1,h=u.getDate(),f=u.getHours(),p=u.getMinutes(),m=u.getSeconds(),v=""+d+_+h+f+p+m,g=r+"_"+o+"_"+v+".html";s=s.replace(/(<\/?html>)/gi,"").replace(/(<\/?head>)/gi,"");var y=x.createFileRequest();y.bind("REQUEST_ERROR",function(e){return console.error("Unable to upload output document at "+g),t.call(n,!0)}),y.bind("REQUEST_COMPLETED",function(e){var i=e.data.parameters.processId,r=e.data.parameters.sourceRecord,s=b.string.substitute("SELECT process_id, run_targeted_sync, file_version_enabled FROM SFProcess WHERE process_unique_id = '{{process_id}}'",{process_id:i});this.__executeQuery(s,function(e){B.executeSourceUpdateMapping({processId:e[0].process_id,data:r}).then(function(){var s=e[0].file_version_enabled,l=s&&"true"===s?""+i+o:null;a({query:"INSERT INTO SmartDocHTML (Id, name, process_id, record_id, file_process_id, version_enabled) VALUES('{{Id}}', '{{name}}', '{{process_id}}', '{{record_id}}', '{{file_process_id}}', '{{version_enabled}}')",queryParams:{Id:"smd_local_"+(new Date).getTime(),name:g,process_id:i,record_id:o,file_process_id:l,version_enabled:s}}).then(function(){a({query:"UPDATE SmartDocSignature SET html_name = '{{html_name}}' WHERE html_name IS NULL OR html_name = ''",queryParams:{html_name:g}})}).then(function(){var a=b.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),s=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{recordId:r.Id}});a.triggerEvent(s);var l=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_INSERTED",this,{request:{recordId:r.Id}});a.triggerEvent(l),b.getCurrentApplication().getSyncImpl().isSyncRunning()?t.call(n,!0):(H.registerJSCache("TARGETEDSYNC",1),H.writeToJSCache("TARGETEDSYNC","recordId",o),V.getObjectNameFromKeyPrefix({key_prefix:o.substr(0,3),onSuccess:function(a){H.writeToDBCache("TARGETED_SYNC_REFERENCE."+o,i+"."+a),t.call(n,!0,e[0].run_targeted_sync)},onError:function(i){b.getLoggingService().getLogger("severe error : objectName not found"),t.call(n,!0,e[0].run_targeted_sync)}}))})})},this)},i),y.execute({operation:"WRITE",file:"{UploadDirectory}/"+g,data:s,recordId:o,processId:r,sourceRecord:c,isSmartDoc:!0})})}},{key:"finalizePDFCordovaLocal",value:function(e,t,n){var i=this,a=e.ProcessId,r=e.RecordId,o=this.__parseHTMLContentForStyle(e.HTMLContent),s=e,l=n,c=e.MappedRecordIds;this.__replaceOpdocTemplateLogo(o).then(function(e){o=e||o,i.__replaceImageToDataURL(o,c).done(function(e){var n=s.SourceRecord,o=x,c=e||c,u=o.createPDFRequest(),d=T.macroDrivenDatetime("Now","YYYYMMDD","HHmmss").replace(/\s+/g,""),_=a+"_"+r+"_"+d+".pdf";u.bind("REQUEST_COMPLETED",function(e){var n=this;if(void 0!==e.data&&null!=e.data&&void 0!==e.data.parameters&&null!==e.data.parameters&&void 0!==e.data.parameters.operation&&null!==e.data.parameters.operation){var i=e.data.parameters.processId,a=e.data.parameters.sourceRecord,r=e.data.parameters.recordId,s=(e.data.data,e.data.parameters.context),c=e.data.parameters.callback,u=e,d=b.string.substitute("SELECT process_id FROM SFProcess WHERE process_unique_id = '{{process_id}}'",{process_id:i});this.__executeQuery(d,function(e){e&&e.length>0?B.executeSourceUpdateMapping({processId:e[0].process_id,data:a}).then(function(){var e=o.createFileRequest(),t=u.data,i=b.toObject(t.data),l="{UploadDirectory}/"+i.name,d=q.getUserInfo(),_=d.TimezoneOffset,h=T.getTimestampWithSaveFormat();h=T.convertToTimezone(h,_,!0);var f="local_"+(new Date).getTime();e.bind("REQUEST_COMPLETED",function(e){var t=this;if(e.data.success){var n=q.getUserInfo().UserId,o=e.data.data&&e.data.data.FileSizeInBytes,u=b.string.substitute("INSERT INTO SFAttachments (Id, parent_id, file_path, name, last_modified_date, content_length, created_by_id, downloaded) VALUES('{{id}}', '{{record_id}}', '{{target_path}}', '{{file_name}}', '{{last_modified}}', {{size}}, '{{author}}', 'true')",{id:f,record_id:r,file_name:i.name,target_path:l,last_modified:h,size:o,author:n});this.__executeQuery(u,function(e){var n=b.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),i=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",t,{request:{recordId:a.Id}});n.triggerEvent(i);var r=b.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_INSERTED",t,{request:{recordId:a.Id}});n.triggerEvent(r),W.insertAttachment({Id:f,isAttachment:!0}),c.call(s,!0)})}else c.call(s,!1)},n),e.bind("REQUEST_ERROR",function(e){c.call(s,!1)},n),e.execute({operation:"INFO",file:l})}):c.call(c,!1)},this)}else t.call(l,!1)},i),u.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("createSignatureRequest Failed"+e.data),t.call(l,!1)}),u.execute({operation:"GENERATEPDF",type:"GENERATEPDF",recordId:r,processId:a,htmlContent:c,sourceRecord:n,pdfName:_,callback:t,context:l,async:!1})})})}},{key:"getDownloadsPath",value:function(e){var t=x,n=t.createInstallationsRequest();n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data;e(n||null)},this),n.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("getDownloadsPath Failed"+e.data.data)}),n.execute({operation:"GETDOWNLOADFOLDERPATH",type:"MISC",async:!0})}},{key:"submitQuery",value:function(e,t){var n=x,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i=this;if(n&&n.length){var a=n[0].Id+"_"+n[0].DeveloperName+"."+n[0].Type;i.getDownloadsPath(function(e){t(e+"\\"+a)})}},this),i.bind("REQUEST_ERROR",function(e){b.getLoggingService().getLogger("Submit Query Failed"+e.data.data)}),i.execute({query:e.Query,async:!0})}},{key:"__replaceOpdocTemplateLogo",value:function(e){var t=b.Deferred(),n=document.createElement("div");n.innerHTML=e;var i=n.getElementsByTagName("img"),a=i.length>0&&i[0];return a&&!/\.(gif|png||jpg|jpeg)$/i.test(a.src)?this.__getOpDocTemplateLogo(a).then(function(e){e&&(filePath=e,a.src=filePath,i[0]=a),t.resolve(n.innerHTML)}):t.resolve(n.innerHTML),t}},{key:"__replaceImagePath",value:function(e,t){var n=this,i=b.Deferred();t||i.resolve(e);var a=[],r=document.createElement("div");r.innerHTML=e;var o=r.getElementsByTagName("img");if(o&&o.length>0){for(var s=0;s<o.length;s++)!function(e){var i=o[e],r=i.getAttribute("attachmentId");if(r&&/local/i.test(r)&&i.src.length>0){var s=n.getFailedImagePath(i,t,!0).then(function(t){t&&(i.src=t,o[e]=i)});a.push(s)}}(s);b.when(a).done(function(){i.resolve(r.innerHTML)})}else i.resolve(r.innerHTML);return i}},{key:"__replaceImageToDataURL",value:function(e,t){var n=this,i=b.Deferred(),a=[],r=document.createElement("div");r.innerHTML=e;var o=r.getElementsByTagName("img");if(o&&o.length>0){for(var s=0;s<o.length;s++)!function(e){var i=o[e];if(i.src.length>0&&i.src.search("http://localhost")>=0){var r=i.src,s=n.getImageDataURL(r,i,t).then(function(t){i.src=t,o[e]=i});a.push(s)}}(s);b.when(a).done(function(){i.resolve(r.innerHTML)})}else i.resolve(r.innerHTML);return i}},{key:"__getOpDocTemplateLogo",value:function(e){var t=b.Deferred(),n=e.alt;n=n.replace(" ","");var i=b.string.substitute("select Id, DeveloperName, Type from Document  where DeveloperName = '{{name}}'",{name:n});return this.__executeQuery(i,function(e){var n=void 0;if(e&&e.length>0){n=e[0].Id+"_"+e[0].DeveloperName+"."+e[0].Type;var i="iOS"===window.device.platform?cordova.file.documentsDirectory:cordova.file.externalDataDirectory;i=i.replace("file://","http://localhost:8080/local-filesystem/"),n="iOS"===window.device.platform?i+"NoCloud/Download/"+n:i+"Download/"+n}else n="";t.resolve(n)},this),t}},{key:"getImageDataURL",value:function(e,t,n,i){var a=this,r=b.Deferred(),o=n,s=i,l=document.createElement("canvas"),c=l.getContext("2d"),u=new Image;return u.onload=function(){var e=u.width<600?1:600/u.width;e=e.toFixed(2),l.width=u.width*e,l.height=u.height*e,c.drawImage(u,0,0,l.width,l.height);var t=u.src,n=/\.(gif|png)$/i.test(t)?"image/png":"image/jpeg",i=l.toDataURL(n,.6);u.src="",r.resolve(i)},u.onerror=function(){s?r.resolve(""):a.getFailedImagePath(t,o).then(function(e){r.resolve(e)})},u.src=e,r}},{key:"getFailedImagePath",value:function(e,t,n){var i=this,a=b.Deferred(),r=e,o=e.getAttribute("attachmentId");if(t&&o&&/local/i.test(o)){var s=t&&t[o];if(s){var l=b.string.substitute("SELECT file_path  FROM SFAttachments where Id = '{{attachmentID}}'",{attachmentID:s});this.__executeQuery(l,function(e){if(e&&e.length>0){var t=e[0].file_path;t?i.getFullFilePath(t).then(function(e){n?a.resolve(e):i.getImageDataURL(e,r,{},!0).then(function(e){a.resolve(e)})}):a.resolve("")}else a.resolve("")},this)}else a.resolve("")}return a}},{key:"getFullFilePath",value:function(e){var t=b.Deferred(),n=Y.createFileRequest();return n.bind("REQUEST_COMPLETED",function(e){var n=e.data.data,i="";n&&(i=n.FilePath),t.resolve(i)},this),n.bind("REQUEST_ERROR",function(e){t.resolve("")},this),n.execute({operation:"INFO",file:e}),t}}]),t}(O),b.defineGlobal(P.name,P),e.exports=P},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(18),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=n(10),y=n(0).utils,S=n(88).AbstractExtension,E=n(11).Facade,b=n(5).ExtensionRunner,T=n(88).SQLSchema,M={name:"com.servicemax.client.offline.sal.model.sync.extensions"};M.SFMObjectFieldExtension=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"execQuery",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",y.proxy(e.context,e.onSuccess||function(e){})),t.bind("REQUEST_ERROR",y.proxy(e.context,e.onError||function(e){})),t.execute({query:e.query,queryParams:e.queryParams})}},{key:"perform",value:function(e){return this.deferred=new g.Deferred,"INITIAL"==e.getSyncType()||"CONFIG"==e.getSyncType()?(this.__nativeService=E,this.__logger=y.getLoggingService().getLogger("SYNC-EXT-SFMObjectField"),this.localId=1,this.execQuery({query:"DELETE FROM SFObjectField",onSuccess:y.proxy(this,function(){this.execQuery({query:"SELECT COUNT(*) as count FROM SFObjectDescribe",context:this,onSuccess:function(e){this.numDescribeEntries=y.toObject(e.data.data)[0].count,this.currentPageOfEntries=0,this.getTenEntries()},onError:function(e){this.__logger.error("SFMObjectFieldExtension.perform has had a fatal error: "+e.data.data)}})})})):this.deferred.resolve(),this.deferred}},{key:"getTenEntries",value:function(){if(10*this.currentPageOfEntries>this.numDescribeEntries)return void this.callLoadExtensions();this.execQuery({query:"SELECT * FROM SFObjectDescribe LIMIT 10 OFFSET "+10*this.currentPageOfEntries,onSuccess:"processDescribeObject",context:this}),this.currentPageOfEntries++}},{key:"callLoadExtensions",value:function(){b.run(this,"com.servicemax.client.onFrameworkLoad").then(y.proxy(this,function(){return this.deferred.resolve()}))}},{key:"processDescribeObject",value:function(e){var t=y.toObject(e.data.data);this.dataToProcess=t,t.length?this.processNext():this.callLoadExtensions()}},{key:"processNext",value:function(){var e=[],t=this.dataToProcess.shift(),n=(t.object_describe,y.toObject(t.object_describe));if(n&&"string"!=typeof n||(t.object_describe=t.object_describe.replace(/"inlineHelpText\"\:\".*?'ubmodul',/g,""),n=y.toObject(t.object_describe)),n&&"object"===(void 0===n?"undefined":(0,s.default)(n))){var i=t.object_name;y.array.forEach(n.fields,function(t){var n=t.referenceTo[t.referenceTo.length-1];e.push(y.string.substitute("({{local_id}}, '{{object_api_name}}', '{{api_name}}', '{{label}}', {{precision}}, {{scale}}, {{length}}, '{{type}}', '{{reference_to}}', '{{nillable}}', '{{unique}}', '{{restricted_picklist}}', '{{calculated}}', '{{defaulted_on_create}}', '{{name_field}}', '{{relationship_name}}', '{{dependent_picklist}}', '{{controler_field}}')",{local_id:this.localId++,object_api_name:i,api_name:t.name,label:t.label.replace(/'/g,"&apos"),type:t.type||t.dataType,reference_to:t.referenceTo[t.referenceTo.length-1],restricted_picklist:String(t.restrictedPicklist||!1),defaulted_on_create:String(t.defaultedOnCreate),name_field:String(t.nameField),relationship_name:t.relationshipName,dependent_picklist:!!n,controler_field:"",precision:String(t.precision),scale:String(t.scale),length:String(t.length),nillable:String(t.nillable),unique:String(t.unique||!1),calculated:String(t.calculated)}))},this);for(;e.length>0;){var a=e.splice(0,100);this.execQuery({query:"INSERT INTO SFObjectField (local_id, object_api_name, api_name, label, precision, scale, length, type, reference_to, nillable, 'unique', restricted_picklist, calculated, defaulted_on_create, name_field, relationship_name, dependent_picklist, controler_field) VALUES "+a.join(", "),context:this,onError:function(e){this.__logger.error("SERIOUS ERROR IN SFMObjectFieldExtension inserting into SFObjectField: "+e.data.parameters.query+"; "+e.data.data)}})}}this.dataToProcess.length>0?this.processNext():this.getTenEntries()}}]),t}(S),M.InstallBaseExtension=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e){if(this.deferred=new y.Deferred,"INCREMENTAL"==e.getSyncType())this.deferred.resolve();else{this.__logger=y.getLoggingService().getLogger("SYNC-EXT-InstallBase");var t=this.__dropTable("InstallBaseObject");t=t.then(y.proxy(this,this.__createObjectTable)),t=t.then(y.proxy(this,this.fillObjectTable)),"CONFIG"!=e.getSyncType()&&(t=t.then(y.proxy(this,this.__clearLocks))),t.always(y.proxy(this,function(){this.deferred.resolve()}))}return this.deferred}},{key:"__dropTable",value:function(e){return this.execQuery({query:"DROP TABLE IF EXISTS '"+e+"'"})}},{key:"__createObjectTable",value:function(){var e=T.getCreateQuery("InstallBaseObject");return this.execQuery({query:e})}},{key:"fillObjectTable",value:function(){var e=T.getInsertReplaceQuery("InstallBaseObject",[{Object_Name:y.OrgNamespace+"__Installed_Product__c"},{Object_Name:y.OrgNamespace+"__Site__c"},{Object_Name:y.OrgNamespace+"__Sub_Location__c"}],!0);return this.execQuery({query:e})}},{key:"__clearLocks",value:function(e){return this.execQuery({query:"DELETE FROM 'InstallBaseLock'"})}},{key:"execQuery",value:function(e){var t=new y.Deferred,n=E,i=n.createSQLRequest();return i.bind("REQUEST_COMPLETED",y.proxy(this,function(e){t.resolve(e.data.data)})),i.bind("REQUEST_ERROR",y.proxy(this,function(e){t.reject(e.data.data)})),i.execute({query:e.query,queryParams:e.queryParams}),t}}]),t}(S),M.SFObjectFieldPopulateExtension=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"execQuery",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",y.proxy(e.context,e.onSuccess||function(e){})),t.bind("REQUEST_ERROR",y.proxy(e.context,e.onError||function(e){})),t.execute({query:e.query,queryParams:e.queryParams})}},{key:"perform",value:function(e,t){var n=this;return n.syncService=e,n.productIqTables=t.tables,this.deferred=new g.Deferred,"INITIAL"==e.getSyncType()||"CONFIG"==e.getSyncType()?(this.__nativeService=E,this.__logger=y.getLoggingService().getLogger("SYNC-EXT-SFMObjectField"),this.localId=1,this.execQuery({query:"DELETE FROM SFObjectField",onSuccess:y.proxy(this,function(){this.numDescribeEntries=n.productIqTables.length,this.currentPageOfEntries=0,this.getTenEntries()})})):this.deferred.resolve(),this.deferred}},{key:"getTenEntries",value:function(){var e=this;if(10*this.currentPageOfEntries>this.numDescribeEntries)return void this.callLoadExtensions();var t=e.productIqTables.join("','");this.execQuery({query:"SELECT * FROM TEMP__SFObjectDescribe WHERE object_name IN ('"+t+"') LIMIT 10 OFFSET "+10*this.currentPageOfEntries,onSuccess:"processDescribeObject",context:this}),this.currentPageOfEntries++}},{key:"callLoadExtensions",value:function(){b.run(this,"com.servicemax.client.onFrameworkLoad").then(y.proxy(this,function(){return this.deferred.resolve()}))}},{key:"processDescribeObject",value:function(e){var t=y.toObject(e.data.data);this.dataToProcess=t,t.length?this.processNext():this.callLoadExtensions()}},{key:"processNext",value:function(){var e=[],t=this.dataToProcess.shift(),n=(t.object_describe,y.toObject(t.object_describe));if(n&&"string"!=typeof n||(t.object_describe=t.object_describe.replace(/"inlineHelpText\"\:\".*?'ubmodul',/g,""),n=y.toObject(t.object_describe)),n&&"object"===(void 0===n?"undefined":(0,s.default)(n))){var i=t.object_name;y.array.forEach(n.fields,function(t){var n=t.referenceTo[t.referenceTo.length-1];e.push(y.string.substitute("({{local_id}}, '{{object_api_name}}', '{{api_name}}', '{{label}}', {{precision}}, {{scale}}, {{length}}, '{{type}}', '{{reference_to}}', '{{nillable}}', '{{unique}}', '{{restricted_picklist}}', '{{calculated}}', '{{defaulted_on_create}}', '{{name_field}}', '{{relationship_name}}', '{{dependent_picklist}}', '{{controler_field}}')",{local_id:this.localId++,object_api_name:i,api_name:t.name,label:t.label.replace(/'/g,"&apos"),type:t.type||t.dataType,reference_to:n,restricted_picklist:String(t.restrictedPicklist||!1),defaulted_on_create:String(t.defaultedOnCreate),name_field:String(t.nameField),relationship_name:t.relationshipName,dependent_picklist:!!n,controler_field:"",precision:String(t.precision),scale:String(t.scale),length:String(t.length),nillable:String(t.nillable),unique:String(t.unique||!1),calculated:String(t.calculated)}))},this);for(;e.length>0;){var a=e.splice(0,100);this.execQuery({query:"INSERT INTO SFObjectField (local_id, object_api_name, api_name, label, precision, scale, length, type, reference_to, nillable, 'unique', restricted_picklist, calculated, defaulted_on_create, name_field, relationship_name, dependent_picklist, controler_field) VALUES "+a.join(", "),context:this,onError:function(e){this.__logger.error("SERIOUS ERROR IN SFMObjectFieldExtension inserting into SFObjectField: "+e.data.parameters.query+"; "+e.data.data)}})}}this.dataToProcess.length>0?this.processNext():this.getTenEntries()}}]),t}(S),M.ServicemaxProcessForChecklistExtension=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e,t){return this.__nativeService=E,this.__logger=y.getLoggingService().getLogger("SVMXProcess-Checklist-EXT"),this.__batchSize=25,this.__tables=t.tables,this.deferred=new g.Deferred,this.execQuery({query:"SELECT COUNT(*) as count FROM "+this.__tables[0]+" WHERE process_type = 'CHECKLIST'",onSuccess:function(e){this.numDescribeEntries=y.toObject(e.data.data)[0].count,this.numDescribeEntries?(this.__logger.info("Total number of checklist processes = "+this.numDescribeEntries),this.currentPageOfEntries=0,this.getTwentyFiveEntries()):this.__logger.info("No checklist processes")},onError:function(e){this.__logger.error("ServicemaxProcessForChecklistExtension.perform has had a fatal error: "+e.data.data)},context:this}),this.deferred}},{key:"getTwentyFiveEntries",value:function(){if(this.currentPageOfEntries*this.__batchSize>this.numDescribeEntries)return void this.callLoadExtensions();this.execQuery({query:"SELECT * FROM "+this.__tables[0]+" WHERE process_type = 'CHECKLIST' LIMIT "+this.__batchSize+" OFFSET "+this.currentPageOfEntries*this.__batchSize,onSuccess:"processChecklistProcesses",context:this}),this.currentPageOfEntries++}},{key:"processChecklistProcesses",value:function(e){var t=this,n=e.data.data,i=T,a=i.getTableSchema(y.getCustomObjectName("ServiceMax_Processes")),r=a.fields,o={process_id:"Id",process_unique_id:y.getCustomObjectName("ProcessID"),process_type:y.getCustomObjectName("Record_Type_Name"),process_name:y.getCustomObjectName("Name"),process_description:y.getCustomObjectName("Description"),page_layout_id:y.getCustomObjectName("Page_Layout"),doc_template_id:y.getCustomObjectName("Doc_Template")};for(var s in o)r[o[s]]||delete o[s];var l=this.__tables[1];if(n&&n.length>0){var c=t.getInsertQueryForFields(o,n,l);t.execQuery({query:c,onSuccess:function(e){t.getTwentyFiveEntries()},onError:function(e){this.__logger.error("Failed to insert into Servicemax_Process Table")},context:t})}else this.__logger.info("No checklist Processes")}},{key:"getInsertQueryForFields",value:function(e,t,n){for(var i=(0,r.default)(e),a=i.map(function(t){return e[t]}),o=[],s=0;s<t.length;s++){for(var l=t[s],c="",u=0;u<i.length;u++)c=c.length?c+",'"+l[i[u]]+"'":"'"+l[i[u]]+"'";o[s]="("+c+")"}return"INSERT OR REPLACE INTO "+n+" ("+a.join(",")+") VALUES "+o.join(",")}},{key:"callLoadExtensions",value:function(){b.run(this,"com.servicemax.client.onFrameworkLoad").then(y.proxy(this,function(){return this.deferred.resolve()}))}},{key:"execQuery",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",y.proxy(e.context,e.onSuccess||function(e){})),t.bind("REQUEST_ERROR",y.proxy(e.context,e.onError||function(e){})),t.execute({query:e.query,queryParams:e.queryParams})}}]),t}(S),M.PurgeIBRelatedRecords=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e,t){return this.deferred=new g.Deferred,this.__syncService=e,this.ibRecordIds=t.ibRecordIds,this.context=t.context,this.__nativeService=E,this.__logger=y.getLoggingService().getLogger("SVMXProcess-Checklist-EXT"),this.deleteIbRelatedRecords(this.ibRecordIds,this.context),this.deferred}},{key:"deleteIbRelatedRecords",value:function(e,t){var n=y.Deferred(),i=this;if(!(e.length<0)){var a=this.getIBTableName("SM_IB_Attributes_History"),r=this.getIBTableName("SM_Installed_Product_Id"),o=this.getIBTableName("SM_IB_Attributes_Template_Instance"),s=e.join("','");this.__logger.info("deleting IB related records from SM_IB_Attributes_History Table and SM_IB_Attributes_Template_Instance Table");var l=this.deleteSQLRequest(a,r,s,t),c=this.deleteSQLRequest(o,r,s,t);g.when(l,c).done(function(){i.__logger.info("finished deleting"),i.callLoadExtensions(i),n.resolve()}).fail(function(){i.__logger.error("Something went wrong while deleting records from IB Related Attributes"),n.resolve()})}}},{key:"deleteSQLRequest",value:function(e,t,n,i){var a=y.Deferred(),r=this;query="SELECT ID FROM "+e+" WHERE "+t+" IN ('"+n+"')",this.execQuery({query:query,onSuccess:function(t){var n=t.data.data,i=0,o=n.length,s=[];for(i;i<o;i++)s.push(n[i].Id);r.context._deleteRecord(e,s),a.resolve()},onError:function(e){this.__logger.error("Failed to get IB attribute template ids to purge"),a.resolve()},context:r})}},{key:"getIBTableName",value:function(e){return y.getCustomObjectName(e)}},{key:"callLoadExtensions",value:function(){b.run(this,"com.servicemax.client.onFrameworkLoad").then(y.proxy(this,function(){return this.deferred.resolve()}))}},{key:"execQuery",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",y.proxy(e.context,e.onSuccess||function(e){})),t.bind("REQUEST_ERROR",y.proxy(e.context,e.onError||function(e){})),t.execute({query:e.query,queryParams:e.queryParams})}}]),t}(S),M.PurgePiqTechnicalAttributeRelatedRecords=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"perform",value:function(e,t){return this.deferred=new g.Deferred,this.__syncEvent=t.syncEvent,this.__nativeService=E,this.__logger=y.getLoggingService().getLogger("SVMXProcess-Checklist-EXT"),this._purgeProductAttributesAndTemplateRecords(),this.deferred}},{key:"_purgeProductAttributesAndTemplateRecords",value:function(){var e=this;this.__logger.info("Start Product attribute and Attribute template Purge"),this._getProductIdsToPurge().then(e._getAttributeTemplateIds).then(e.getPurgeAttributeTemplateIdWithNoProducts).then(e._getAttributeTemplateIdsToPurge).then(e._purgePiqAttributesAndTemplates).done(function(){e.__logger.info("Purge Product attributes and Attribute template successfully"),e.callLoadExtensions(e)}).fail(function(){e.__logger.error("Purge Product attributes and Attribute template failed"),e.callLoadExtensions()})}},{key:"_getProductIdsToPurge",value:function(){var e=y.Deferred(),t=this,n=y.getCustomFieldName("SM_Product"),i={columnName:n,attrTableName:y.getCustomFieldName("SM_Product_Attributes"),prodTableName:"Product2"},a=y.string.substitute("SELECT DISTINCT {{columnName}} FROM {{attrTableName}} WHERE {{columnName}} NOT IN (SELECT Id FROM {{prodTableName}}) AND SVMXDEV__SM_Product__c != ''",i);return t.execQuery({query:a,onSuccess:function(i){e.resolve(t._getResultIds(i.data.data,n),t)},onError:function(e){this.__logger.error("Failed to get deleted product ids")},context:t}),e}},{key:"_getResultIds",value:function(e,t){for(var n=[],i=0;i<e.length;i++){var a=e[i][t];a&&a.length&&-1===n.indexOf(a)&&(n[i]=a)}return n}},{key:"_getQueryCondition",value:function(e){var t="";return e.length&&(t=e.join("','"),t="'"+t+"'"),t}},{key:"_getAttributeTemplateIds",value:function(e,t){var n=y.Deferred(),i=y.getCustomFieldName("SM_Attribute_Template_Id"),a={columnName:y.getCustomFieldName("SM_Product"),selectColumnName:i,tableName:y.getCustomFieldName("SM_Product_Attributes"),deletedProductIds:t._getQueryCondition(e)},r=y.string.substitute("SELECT DISTINCT Id, {{selectColumnName}} FROM {{tableName}} WHERE {{columnName}} IN ({{deletedProductIds}})",a);return t.execQuery({query:r,onSuccess:function(a){t.productAttrToPurge=t._getResultIds(a.data.data,"Id"),n.resolve(t._getResultIds(a.data.data,i),e,t)},onError:function(e){this.__logger.error("Failed to get product attribute ids and attribute templates")},context:t}),n}},{key:"getPurgeAttributeTemplateIdWithNoProducts",value:function(e,t,n){var i=y.Deferred(),a=y.getCustomFieldName("SM_Attribute_Template_Id"),r={columnName:y.getCustomFieldName("SM_Product"),selectColumnName:a,tableName:y.getCustomFieldName("SM_Product_Attributes"),deletedProductIds:n._getQueryCondition(t),attrTemplateIds:n._getQueryCondition(e)},o=y.string.substitute("SELECT DISTINCT {{selectColumnName}} FROM {{tableName}} WHERE {{selectColumnName}} IN ({{attrTemplateIds}}) AND {{columnName}} NOT IN ({{deletedProductIds}})",r);return n.execQuery({query:o,onSuccess:function(t){var r=n._getResultIds(t.data.data,a),o=e,s=o.filter(function(e){return-1==r.indexOf(e)});i.resolve(s,n)},onError:function(e){this.__logger.error("Failed to get attribute template ids that shouldnt be purged")},context:n}),i}},{key:"_getAttributeTemplateIdsToPurge",value:function(e,t){var n=y.Deferred(),i=y.getCustomFieldName("SM_Attribute_Template_Id"),a={productLine:y.getCustomFieldName("SM_Product_Line"),productFamily:y.getCustomFieldName("SM_Product_Family"),selectColumnName:i,tableName:y.getCustomFieldName("SM_Product_Attributes"),attrTemplateIds:t._getQueryCondition(e)},r=y.string.substitute("SELECT {{selectColumnName}} FROM {{tableName}} WHERE {{selectColumnName}} IN ({{attrTemplateIds}}) AND {{productLine}} = '' AND {{productFamily}} = '' ",a);return t.execQuery({query:r,onSuccess:function(e){t.attrTemplateToPurge=t._getResultIds(e.data.data,i),t.__logger.info(t.attrTemplateToPurge.length+" records to be deleted from Attribute template table"),t.__logger.info(t.productAttrToPurge.length+" records to be deleted from Product attribute table"),n.resolve(t)},onError:function(e){this.__logger.error("Failed to get attribute template ids to purge")},context:t}),n}},{key:"_purgePiqAttributesAndTemplates",value:function(e){var t=y.Deferred(),n=e.__syncEvent._deleteRecord(y.getCustomFieldName("SM_Attributes_Template"),e.attrTemplateToPurge,function(){this.__logger.info(e.attrTemplateToPurge.length+" Records deleted successfully from SM_Attributes_Template table")}),i=e.__syncEvent._deleteRecord(y.getCustomFieldName("SM_Product_Attributes"),e.productAttrToPurge,function(){this.__logger.info(e.productAttrToPurge.length+" Records deleted successfully from SM_Product_Attributes table")});return g.when(n,i).done(function(){e.__logger.info("finished deleting"),t.resolve()}).fail(function(){e.__logger.error("Something went wrong while deleting records from Attribute template/Product attribute table finished deleting"),t.resolve()}),t}},{key:"callLoadExtensions",value:function(){b.run(this,"com.servicemax.client.onFrameworkLoad").then(y.proxy(this,function(){return this.deferred.resolve()}))}},{key:"execQuery",value:function(e){var t=this.__nativeService.createSQLRequest();t.bind("REQUEST_COMPLETED",y.proxy(e.context,e.onSuccess||function(e){})),t.bind("REQUEST_ERROR",y.proxy(e.context,e.onError||function(e){})),t.execute({query:e.query,queryParams:e.queryParams})}}]),t}(S),y.defineGlobal(M.name,M),e.exports=M},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(7).Data,n(7).SystemData,n(100).Utils,n(13).Operation),m=n(11).Facade,v=n(12).DatetimeUtil,g={name:"com.servicemax.client.offline.sal.model.sync.operations"},y=(f.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.sync"),function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")});g.GetSyncStatus=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=e.syncType,i=null,a=null;f.when([this.__runNativeSQLRequest({query:"SELECT value FROM ClientCache where key IN('LAST_SYNC_TIME."+n+"') AND value is NOT NULL LIMIT 1;"}),this.__runNativeSQLRequest({query:"SELECT value FROM ClientCache where key IN('SYNC_STATUS."+n+"') AND value is NOT NULL LIMIT 1;"})]).then(f.proxy(this,function(e,t){return null===e?i="-":null===t?a="-":(i=this.__getQueryColumnValueAsDate(e),a=this.__getQueryColumnValueAsString(t)),{statusTime:i,statusToUpdate:a}})).done(f.proxy(this,function(e){t.result(e)}))}},{key:"__runNativeSQLRequest",value:function(e){var t=f.Deferred(),n=m,i=n.createSQLRequest(),a=e.query;return i.bind("REQUEST_COMPLETED",function(e){t.resolve(f.toObject(e.data.data))},this),i.bind("REQUEST_ERROR",function(e){t.reject({})},this),i.execute({query:a,async:!0}),t.promise()}},{key:"__getQueryColumnValueAsDate",value:function(e){var t=" ";if(e&&e[0]){var n=e[0].value;t=v.parseGMTDate(n)}return t}},{key:"__getQueryColumnValueAsString",value:function(e){var t=" ";return e&&e[0]&&e[0].value&&(t=this.__getTranslatedValues(e[0].value)),t}},{key:"__getTranslatedValues",value:function(e){return"Success"===e?y().T("FSA010_TAG124","Success"):"No Connectivity"===e?y().T("FSA010_TAG058","No Connectivity"):"Failed"===e?y().T("FSA010_TAG123","Failed"):"Canceled"===e?y().T("FSA010_TAG051","Cancelled"):" "}}]),t}(p),f.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(7).Data,n(7).SystemData,n(100).Utils,n(13).Operation),m=n(11).Facade,v={name:"com.servicemax.client.offline.sal.model.toolspages.operations"};f.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.toolspages");v.UpdateConflict=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=e.action,i=e.record,a="UPDATE ClientSyncConflict SET override_flag = '"+n+"' WHERE local_id = '"+i.local_id+"' AND Id = '"+i.Id+"';";this.__executeQuery(a,function(e){t.result(e)})}},{key:"__executeQuery",value:function(e,t,n){"function"==typeof t&&(n=t,t={});var i=m,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){n.call(this,f.toObject(e.data.data))},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),n.call(this,!1)},this),a.execute({query:e,async:!0,queryBinds:t})}}]),t}(p),v.GetOutputDocsCount=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.getClient().getApplicationParameter("client-type").toLowerCase(),i=void 0;"laptop"==n?i="SELECT Id FROM SFAttachments WHERE Id LIKE 'local_%'":"mobile"==n&&(i="SELECT Id FROM SmartDocHTML WHERE Id LIKE '%local_%'"),this.__executeQuery(i,function(e){t(e.length)})}},{key:"__executeQuery",value:function(e,t,n){"function"==typeof t&&(n=t,t={});var i=m,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){n.call(this,f.toObject(e.data.data))},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),n.call(this,!1)},this),a.execute({query:e,async:!0,queryBinds:t})}}]),t}(p),v.AllowApiAccess=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.getClient().getApplicationParameter("client-type").toLowerCase(),i=void 0;"laptop"==n?(i="SELECT value as api_key FROM MobileDeviceSettings WHERE setting_id = 'Allow API Access';",this.__executeQuery(i,function(e){t(e)})):"mobile"==n&&t(!1)}},{key:"__executeQuery",value:function(e,t,n){"function"==typeof t&&(n=t,t={});var i=m,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){n.call(this,f.toObject(e.data.data[0]&&e.data.data[0].api_key))},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),n.call(this,!1)},this),a.execute({query:e,async:!0,queryBinds:t})}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(7).Data,m=n(7).SystemData,v=(n(100).Utils,n(13).Operation),g=n(11).Facade,y={name:"com.servicemax.client.offline.sal.model.tasks.operations"},S=p,E=m;f.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.tasks");y.GetTasksList=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){this.__executeQuery("SELECT * FROM Task ORDER BY ActivityDate ASC, Subject ASC;",function(e){if(e)t.result(e);else{this.__executeQuery("SELECT * FROM Task ORDER BY Subject ASC;",function(e){t.result(e)})}})}},{key:"__executeQuery",value:function(e,t,n){"function"==typeof t&&(n=t,t={});var i=g,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){n.call(this,f.toObject(e.data.data))},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),n.call(this,!1)},this),a.execute({query:e,async:!0,queryBinds:t})}}]),t}(v),y.ManageTask=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){if("delete"==e.type)S.deleteRecord({Id:e.recordId,onSuccess:f.proxy(this,function(e){f.getCurrentApplication().getSyncImpl()&&f.getCurrentApplication().getSyncImpl().onSaveStarted(),S.writeSyncRecords([],[],[e],function(){f.getCurrentApplication().getSyncImpl()&&f.getCurrentApplication().getSyncImpl().onSaveCompleted()}),t.result(e)}),onError:f.proxy(this,function(){alert("deleteRecord on Task failed!")})});else{var n=e.date,i=e.priority,a=e.description,r=e.record,o=E.getUserInfo().UserId,s=void 0;"edit"==e.type?(s=r.data,s.Priority=i,s.Subject=a,s.ActivityDate=n,s.OwnerId=o):s={Subject:a,ActivityDate:n,Priority:i,OwnerId:o},S.writeRecord({data:s,type:"Task",onSuccess:f.proxy(this,function(e,n){var i=[],a=[],r=[];n&&(e?i.push(n):a.push(n)),f.getCurrentApplication().getSyncImpl()&&f.getCurrentApplication().getSyncImpl().onSaveStarted(),S.writeSyncRecords(i,a,r,function(){f.getCurrentApplication().getSyncImpl()&&f.getCurrentApplication().getSyncImpl().onSaveCompleted(),t.result(s)})}),onError:f.proxy(this,function(e){alert("Create/Update Task Failed!")})})}}},{key:"__executeQuery",value:function(e,t,n){"function"==typeof t&&(n=t,t={});var i=g,a=i.createSQLRequest();a.bind("REQUEST_COMPLETED",function(e){n.call(this,f.toObject(e.data.data))},this),a.bind("REQUEST_ERROR",function(e){f.getLoggingService().getLogger(e.data),n.call(this,!1)},this),a.execute({query:e,async:!0,queryBinds:t})}}]),t}(v),f.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=v.Deferred(),n=b.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)}),n.bind("REQUEST_ERROR",function(e){t.reject(e.data.data)}),n.execute({query:e.query,queryParams:e.queryParams}),t}var r=n(31),o=i(r),s=n(1),l=i(s),c=n(2),u=i(c),d=n(6),_=i(d),h=n(3),f=i(h),p=n(4),m=i(p),v=n(10),g=n(0).utils,y=n(11).Facade,S=n(13).Operation,E={name:"com.servicemax.client.offline.sal.model.recents.operations"},b=y;g.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.troubleshootdelivery.operations");E.GetRecents=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=this;a({query:"select RecentItems.RecordId,RecentItems.Type,RecentItems.LastAccessed, SFObjectDescribe.label, RecentItems.ObjectName, RecentItems.nameField From RecentItems LEFT JOIN SFObjectDescribe ON SFObjectDescribe.object_name = RecentItems.ObjectName ORDER BY LastAccessed DESC"}).then(function(e){var i=void 0,r=void 0,o=void 0,s=n.addNameFieldToRecords(e);g.when(s).then(function(){var s=g.array.filter(e,function(e){return void 0===e.NameField});if(e=g.array.filter(e,function(e){return void 0!=e.NameField}),i=n.formatData(e),r=n.getCreatedRecords(e),o=n.formatData(r),s.length>0){a({query:"DELETE FROM RecentItems WHERE RecentItems.RecordId IN ('"+s.map(function(e){return e.RecordId}).join("','")+"')"})}t.result({allRecords:i,createdRecords:o}),g.doLater(function(){n.doCleanup()})})})}},{key:"formatData",value:function(e){var t={},n=null,i=void 0;return(e||[]).forEach(function(e){n=e.ObjectName,n in t||(t[n]=[],t[n].label=e.label,t[n].data=[]),i=JSON.parse((0,o.default)(e)),delete i.label,delete i.ObjectName,t[n].data.length<25&&t[n].data.push(i)}),t}},{key:"getCreatedRecords",value:function(e){var t=[];return(e||[]).forEach(function(e){"CREATE"==e.Type&&t.push(e)}),t}},{key:"addNameFieldToRecords",value:function(e){var t=this,n=[],i=e.length,r=0,o={};for(t.__tempResult=e,r;r<i;r++){var s=e[r],l=s.ObjectName,c=s.RecordId,u=s.NameField;s.NameField=void 0,o[l]||(o[l]={},o[l].NameField=u,o[l].records=[]),o[l].records.push(c)}for(var d in o){var _=o[d],h=_.records.join("','"),f=_.NameField;n.push(a({query:"select '"+d+"'."+f+" AS Name,'"+d+"'.Id from '"+d+"' where '"+d+"'.Id IN ('"+h+"')"}).then(function(e){if(e&&e.length>0){var n=0,i=e.length;for(n;n<i;n++){var a=e[n].Id,r=g.array.filter(t.__tempResult,function(e){return e.RecordId===a})[0];r&&(r.NameField=e[n].Name)}}}))}return n}}]),t}(S),E.AddRecents=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=[],i={RecordId:e.recordId,ObjectName:e.objectName,LastAccessed:e.lastAccessed,NameField:e.nameField,Type:e.type};a({query:"SELECT Count(*) AS RecordsCount FROM RecentItems WHERE Type = '{{Type}}' AND ObjectName = '{{ObjectName}}' AND RecordId = '{{RecordId}}'",queryParams:i}).then(function(e){e[0]&&0==e[0].RecordsCount&&("CREATE"==i.Type?n.push(a({query:"SELECT COUNT(*) as Count FROM RecentItems WHERE Type = 'Create' AND ObjectName ='"+i.ObjectName+"'"}).then(function(e){e[0]&&e[0].Count>=25&&n.push(a({query:"Delete from RecentItems where recordId = (select RecordId from  RecentItems WHERE Type IN ('CREATE) AND ObjectName = '"+i.ObjectName+"'ORDER BY LastAccessed ASC limit 1); "}))})):n.push(a({query:"SELECT COUNT(*) as Count FROM RecentItems WHERE Type <> 'Create' AND ObjectName ='"+i.ObjectName+"'"}).then(function(e){e[0]&&e[0].Count>=25&&n.push(a({query:"Delete from RecentItems where recordId = (select RecordId from  RecentItems WHERE Type IN ('VIEW','EDIT') AND ObjectName = '"+i.ObjectName+"'ORDER BY LastAccessed ASC limit 1); "}))}))),g.when(n).then(function(){a({query:"SELECT Count(*) AS RecordsCount FROM RecentItems WHERE Type = 'Create' AND RecordId = '{{RecordId}}'",queryParams:i}).then(function(e){e[0].RecordsCount>0?a({query:"UPDATE RecentItems SET LastAccessed ='{{LastAccessed}}' WHERE RecordId = '{{RecordId}}'",queryParams:i}).then(function(e){}):a({query:"INSERT OR REPLACE INTO RecentItems (RecordId,ObjectName,LastAccessed,NameField,Type) SELECT * FROM (SELECT '{{RecordId}}','{{ObjectName}}','{{LastAccessed}}','{{NameField}}','{{Type}}') AS tmp WHERE NOT EXISTS (SELECT Type FROM RecentItems WHERE Type = 'Create' AND RecordId = '{{RecordId}}') LIMIT 1;",queryParams:i}).then(function(){})})})})}}]),t}(S),g.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=v.Deferred(),n=M.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)}),n.bind("REQUEST_ERROR",function(e){t.reject(e.data.data)}),n.execute({query:e.query,queryParams:e.queryParams}),t}var r=n(31),o=i(r),s=n(1),l=i(s),c=n(2),u=i(c),d=n(6),_=i(d),h=n(3),f=i(h),p=n(4),m=i(p),v=n(10),g=n(0).utils,y=n(396).FeedInfoParser,S=n(11).Facade,E=n(13).Operation,b={name:"com.servicemax.client.offline.sal.model.troubleshootdelivery.operations"},T=y,M=S;g.getLoggingService().getLogger("com.servicemax.client.offline.sal.model.troubleshootdelivery.operations");b.GetFeedInfo=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance();n.checkConnectivity().then(function(){n.getFeedInfo({data:e}).then(function(n){if(n&&n.data&&n.data.feedItems){var r={Id:e.recordId,feedJSON:(0,o.default)(n.data)};a({query:"INSERT OR REPLACE INTO SFChatterFeedInfo (Id,feedJSON) VALUES('{{Id}}','{{feedJSON}}')",queryParams:r}).then(function(){t.result({isSuccess:!0,data:T.parse(JSON.parse(r.feedJSON))})},function(e){i(function(n){n.isSuccess&&(e.data=n.data),t.result(e)})})}else t.result({isSuccess:!1})},g.proxy(t,t.result))},function(){i(function(e){t.result(e)})});var i=function(t){a({query:"SELECT Id, feedJSON FROM SFChatterFeedInfo WHERE Id = '{{Id}}'",queryParams:{Id:e.recordId}}).then(function(e){t(e&&e.length&&e[0].feedJSON?{isSuccess:!0,data:T.parse(JSON.parse(e[0].feedJSON))}:{isSuccess:!1})},function(){t({isSuccess:!1})})}}}]),t}(E),b.SaveFeedInfo=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance();n.checkConnectivity().then(function(){var i=g.proxy(t,t.result);n.saveFeedInfo({data:e}).then(i,i)},function(){t.result({isSuccess:!1})})}}]),t}(E),b.DownloadDocumentOnDemand=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance();n.checkConnectivity().then(function(){var i=g.proxy(t,t.result);n.downloadDocumentOnDemand({data:e}).then(i,i)},function(e){t.result({isSuccess:!1,isConnectivityError:!0})})}}]),t}(E),b.GetProductDocuments=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),i=function(e,n){e=e||{},e.isSuccess=!1,e.isConnectivityError=!!n,t.result(e)},r=function(e){var n=g.deepCloneObject(e)||{};n.isSuccess=!0,t.result(n)},o=function(t){if(!(t&&t.data&&t.data.records))return i();var n=[];(t.data.records||[]).forEach(function(t){var i={Id:t.Id,Name:t.Name,Description:t.Description,Keywords:t.Keywords,Type:t.Type,BodyLength:t.BodyLength,attType:t.attributes.type,attUrl:t.attributes.url,docType:"TROUBLESHOOTING_DOCUMENT",online:!0,parentId:e.parentId};n.push(a({query:"INSERT OR REPLACE INTO Product_Troubleshoot_Documents (Id,Name,Description,Keywords,Type,BodyLength,attType,attUrl,docType,online,parentId) SELECT * FROM (SELECT '{{Id}}','{{Name}}','{{Description}}','{{Keywords}}','{{Type}}','{{BodyLength}}','{{attType}}','{{attUrl}}','{{docType}}','{{online}}','{{parentId}}') AS tmp WHERE NOT EXISTS (SELECT online FROM product_Troubleshoot_Documents WHERE online = 'false' AND Id = '{{Id}}') LIMIT 1;",queryParams:i}))}),g.when(n).then(r,i)};n.checkConnectivity().then(function(){n.getProductDocuments({data:e}).then(o,i)},function(e){i(e,!0)})}}]),t}(E),b.GetProductManual=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),i=function(e,n){e=e||{},e.isSuccess=!1,e.isConnectivityError=!!n,t.result(e)},r=function(e){var n=g.deepCloneObject(e)||{};n.isSuccess=!0,t.result(n)},o=function(t){if(!(t&&t.data&&t.data.records))return i();var n=[];(t.data.records||[]).forEach(function(t){var i={Id:t.Id,Name:t.Name,Description:t.Description,Keywords:t.Keywords,Type:t.Type,BodyLength:t.BodyLength,attType:t.attributes.type,attUrl:t.attributes.url,docType:"TROUBLESHOOTING_PRODUCT_MANUAL",online:!0,parentId:e.parentId};n.push(a({query:"INSERT OR REPLACE INTO Product_Troubleshoot_Documents (Id,Name,Description,Keywords,Type,BodyLength,attType,attUrl,docType,online,parentId) SELECT * FROM (SELECT '{{Id}}','{{Name}}','{{Description}}','{{Keywords}}','{{Type}}','{{BodyLength}}','{{attType}}','{{attUrl}}','{{docType}}','{{online}}','{{parentId}}') AS tmp WHERE NOT EXISTS (SELECT online FROM product_Troubleshoot_Documents WHERE online = 'false' AND Id = '{{Id}}') LIMIT 1;",queryParams:i}))}),g.when(n).then(r,i)};n.checkConnectivity().then(function(){n.getProductManual({data:e}).then(o,i)},function(e){i(e,!0)})}}]),t}(E),b.GetAllDocuments=function(e){function t(){return(0,u.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this))}return(0,m.default)(t,e),(0,_.default)(t,[{key:"performAsync",value:function(e,t){var n=g.proxy(t,t.result);a({query:"SELECT *  FROM Product_Troubleshoot_Documents WHERE parentId = '{{Id}}'"+(e.offlineRecordsOnly?" AND online = 'false'":""),queryParams:{Id:e.parentId}}).then(n,n)}}]),t}(E),g.defineGlobal(b.name,b),e.exports=b},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g={name:"com.servicemax.client.offline.sal.model.sfmdelivery.targetrecord.impl"};g.SFMTargetRecord=function(e){function t(e,n,i){(0,c.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return a.__data=e,a.__metadata=n,a.__additionalInfo=i,a}return(0,p.default)(t,e),(0,d.default)(t,[{key:"getParentObjectName",value:function(){return this.__metadata.page.header.headerLayout[m.OrgNamespace+"__Object_Name__c"]}},{key:"getHeaderLayoutId",value:function(){return this.__metadata.page.header.hdrLayoutId}},{key:"getProcessType",value:function(){return this.__metadata.response.sfmProcessType}},{key:"getHeaderRecords",value:function(){var e=[],t=this.__data.getRawData().sfmData,n={targetRecordAsKeyValue:[]},i=null;return t.forEachField(m.proxy(this,function(e){var a=e.name;if("sourceRecordID"!=a){var o=t[a];i=null,o||(o=null),"object"===(void 0===o?"undefined":(0,r.default)(o))&&void 0!==o&&null!==o?i={key:a,value:o.fieldvalue.key,value1:o.fieldvalue.value}:"RecordTypeId"==a&&void 0===o||(i={key:a,value:o}),i&&(n.targetRecordAsKeyValue[n.targetRecordAsKeyValue.length]=i)}})),e[e.length]=n,e}},{key:"getDetailRecords",value:function(){var e=[],t=this.__data.getRawData().sfmData.details,n=null,i=null;for(i in t)e[e.length]={};for(i in t){var a,o=this.getDetailMetadata(i),s=null,l=null,c=null,u=t[i].lines,d=u.length,_=null,h=null;n={},n.aliasName=o.dtlLayoutId,n.pageLayoutId=o.dtlLayoutId,n.objName=o.DetailLayout[m.OrgNamespace+"__Object_Name__c"],n.parentColumnName=this.getDetailParentColumnName(o),n.records=[],n.deleteRecID=this.getDetailDeletedRecords(i),e[o.DetailLayout[m.OrgNamespace+"__Sequence__c"]-1]=n;for(var a=0;a<d;a++)_=u[a],h={},l=_.Id,l&&(h.targetRecordId=l),c=_.sourceRecordID,c&&(h.sourceRecordId=c),h.targetRecordAsKeyValue=[],_.forEachField(function(e){var t=e.name;if("sourceRecordID"!=t){var n=_[t];s=null,n||(n=null),"object"===(void 0===n?"undefined":(0,r.default)(n))&&void 0!==n&&null!==n?s={key:t,value:n.fieldvalue.key,value1:n.fieldvalue.value}:"RecordTypeId"==t&&void 0===n||(s={key:t,value:n}),s&&(h.targetRecordAsKeyValue[h.targetRecordAsKeyValue.length]=s)}}),n.records[n.records.length]=h}return e}},{key:"getDetailDeletedRecords",value:function(e){var t=[],n=this.__data.getDeletedRecords(),i=void 0,a=n.length,r=void 0;for(i=0;i<a;i++)r=n[i],r.alias==e&&t.push(r.id);return t}},{key:"getDetailMetadata",value:function(e){var t=null,n=this.__metadata.page.details,i=void 0,a=n.length;for(i=0;i<a;i++)if(n[i].dtlLayoutId==e){t=n[i];break}return t}},{key:"getDetailParentColumnName",value:function(e){var t=null,n=e.dtlLayoutId,i=this.__metadata.response.stringMap,a=void 0,r=i.length;for(a=0;a<r;a++)if("PROCESSTYPE"!=i[a].key&&i[a].key==n){t=i[a].value;break}return t}},{key:"getRequest",value:function(){var e={headerRecord:{}};e.sfmProcessId=this.__additionalInfo.sfmProcessId,e.eventType=this.__additionalInfo.eventType,e.headerRecord.objName=this.getParentObjectName(),e.headerRecord.pageLayoutId=this.getHeaderLayoutId(),e.headerRecord.records=this.getHeaderRecords(),e.detailRecords=this.getDetailRecords();var t=this.getProcessType();if("EDIT"==t)e.headerRecord.records[0].targetRecordId=this.__data.getTargetRecordId();else if("SOURCETOTARGET"==t){var n=this.__data.getTargetRecordId();if(n){e.headerRecord.records[0].targetRecordId=n;var i=e.headerRecord.records[0].targetRecordAsKeyValue;i[i.length]={key:"Id",value:n}}e.headerRecord.records[0].sourceRecordId=this.__data.getSourceRecordId()}else"SOURCETOTARGETONLYCHILDROWS"==t&&(e.headerRecord.records[0].targetRecordId=this.__data.getTargetRecordId(),e.headerRecord.records[0].sourceRecordId=this.__data.getTargetRecordId());return e}}]),t}(v),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(31),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(7).MetaData,g=n(13).Operation,y=n(12).DatetimeUtil,S=n(182).Util,E=n(182).SyncData,b=n(7).Data,T=n(11).File,M=m.getLoggingService().getLogger("sfm-offline-operations"),I={name:"com.servicemax.client.offline.sal.model.productiq.operations"},C=v;I.GetMetadata=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this;n.__getUserConfig().done(function(e){n.__getUserState(e).done(function(n){e.state=n,t.result(e)})})}},{key:"__getUserConfig",value:function(){var e=m.Deferred();return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Value").from("Configuration").where("Type = 'user'").execute().done(function(t){var n={};t&&t[0]&&t[0].Value&&(n=m.toObject(t[0].Value)),e.resolve(n)}),e}},{key:"__getUserState",value:function(){var e=m.Deferred();return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Value").from("Configuration").where("Type = 'state'").execute().done(function(t){var n={};t&&t[0]&&t[0].Value&&(n=m.toObject(t[0].Value)),e.resolve(n)}),e}}]),t}(g),I.GetTopLevelIBs=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i=y,a={},r=performance.now(),o=performance.now();M.info("PIQTree: -- buildQueryWithExpressions "+new Date);var s=e.context.getFilterExpressions?e.context.getFilterExpressions():null,l=void 0;e.params.accountId&&(l=e.params.accountId);var c=this.buildQueryWithExpressions(e.iBReferenceInfo,s,void 0,l).orderBy("datetime(main.LastModifiedDate)").desc().andSetValue("main.Name COLLATE NOCASE"),u=c.q();this.__runQueryInBatch(u,0,[],function(c){if(a.ibs=c,M.info("PIQTree ["+(performance.now()-r)+"] - GetTopLevelIBs: -- getTopLevelQueryWithExpressions"),r=performance.now(),a.ibs.length){var u=n.getTopLevelQueryWithExpressions(e.iBReferenceInfo,s,void 0,l);n.__getIBAttributesTemplateInstanceRecordsForSelectedIBs(u).execute().done(function(e){var c=a.ibs.length;if(e.length>0)for(var d=0;d<c;d++){var _=a.ibs[d].Id;a.ibs[d].IBAttributeInstanceLastModDate="";for(var h=0;h<e.length;h++){var f=e[h][m.getCustomFieldName("SM_Installed_Product_Id")];if(f===_){a.ibs[d].IBAttributeInstanceLastModDate=e[h].LastModifiedDate;break}}}n.__getAttachementRecordsForSelectedRecords(u).execute().done(function(e){var c=a.ibs.length;if(e.length>0)for(var u=0;u<c;u++){var d=a.ibs[u].Id;a.ibs[u].AttachementLastModDate="";for(var _=0;_<e.length;_++){var h=e[_].ParentId;if(h===d){var f=e[_].LastModifiedDate;if(-1!==f.search(/T/i)){var p=f.split("T");if(p.length>1){var m=i.convertISODateStringToSpecifiedFormat(f,"YYYY-MM-DD HH:mm:ss");a.ibs[u].AttachementLastModDate=m}}else a.ibs[u].AttachementLastModDate=e[_].LastModifiedDate;break}}}n.__appendParentRecords(s,a,l).done(function(){n.__appendTemplateConfigs(a).done(function(){n.__appendTransientRecordIndex(a).done(function(){var e=n.__getLocationIds(a);n.__getAttachementRecordsForSelectedLocationRecords(e).execute().done(function(e){n.__getModifiedLocationRecords(a,e,i),M.info("PIQTree ["+(performance.now()-r)+"] - GetTopLevelIBs: -- responder-1 time2 "+(performance.now()-o)),t.result(a)})})})})})})}else M.info("PIQTree["+(performance.now()-r)+"]- GetTopLevelIBs: -- getLocationsForSelectedAccount -2"),r=performance.now(),n.__getLocationsForSelectedAccount(a,l).done(function(){var e=n.__getLocationIds(a);n.__getAttachementRecordsForSelectedLocationRecords(e).execute().done(function(e){n.__getModifiedLocationRecords(a,e,i),M.info("PIQTree ["+(performance.now()-r)+"] - GetTopLevelIBs: -- responder-2 time2 "+(performance.now()-o)),t.result(a)})})})}},{key:"__runQueryInBatch",value:function(e,t,n,i){var a=this,r=3e3*t;n=n||[],m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{query:e}).limit(3e3).offset(r).execute().done(function(r){r&&r.length>0?(n=n.concat(r),r.length<3e3?i(n):a.__runQueryInBatch(e,t+1,n,i)):i(n)})}},{key:"__getLocationIds",value:function(e){for(var t=[],n=e.locations,i=n.length,a=0;a<i;a++){var r=n[a].Id;r&&t.push(r)}return t}},{key:"__getModifiedLocationRecords",value:function(e,t,n){if(t.length>0)for(var i=e.locations.length,a=0;a<i;a++){var r=e.locations[a].Id;e.locations[a].AttachementLastModDate="";for(var o=0;o<t.length;o++){var s=t[o].ParentId;if(s===r){var l=t[o].LastModifiedDate;if(-1!==l.search(/T/i)){var c=l.split("T");if(c.length>1){var u=n.convertISODateStringToSpecifiedFormat(l,"YYYY-MM-DD HH:mm:ss");e.locations[a].AttachementLastModDate=u}}else e.locations[a].AttachementLastModDate=t[o].LastModifiedDate;break}}}}},{key:"buildQueryWithExpressions",value:function(e,t,n,i){var a=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),r=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});r.select("Id").from(m.getCustomFieldName("Site")).where(m.getCustomFieldName("Account")+" = '"+i+"'");var o="main.Name , main.Id , main.LastModifiedDate ,main."+m.getCustomObjectName("Site")+",main."+m.getCustomObjectName("Top_Level")+",main."+m.getCustomObjectName("Company")+",main."+m.getCustomObjectName("Parent")+", TableB."+m.getCustomObjectName("Parent")+" as hasChild";if(a.select("DISTINCT "+o).from(m.getCustomObjectName("Installed_Product")+" main LEFT JOIN "+m.getCustomObjectName("Installed_Product")+" TableB ON main.Id = TableB."+m.getCustomObjectName("Parent")).where("1 = 1"),(n||void 0===n)&&a.where("(main."+m.getCustomFieldName("Top_Level")+" = '' OR main."+m.getCustomFieldName("Top_Level")+" Is Null)"),i&&a.where("(main."+m.getCustomFieldName("Site")+" IN ("+r.__q+") OR main."+m.getCustomFieldName("Company")+" = '"+i+"')"),t&&t.length)for(var s=0;s<t.length;s++)a.and(this.__buildFilterQueryRecursive(e,t[s],null,"main"));return a}},{key:"getTopLevelQueryWithExpressions",value:function(e,t,n,i){var a=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),r=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(r.select("Id").from(m.getCustomFieldName("Site")).where(m.getCustomFieldName("Account")+" = '"+i+"'"),a.select("Id").from(m.getCustomObjectName("Installed_Product")).where("1 = 1"),(n||void 0===n)&&a.where("("+m.getCustomFieldName("Top_Level")+" = '' OR "+m.getCustomFieldName("Top_Level")+" Is Null)"),i&&a.where("("+m.getCustomFieldName("Site")+" IN ("+r.__q+") OR "+m.getCustomFieldName("Company")+" = '"+i+"')"),t&&t.length)for(var o=0;o<t.length;o++)a.and(this.__buildFilterQueryRecursive(e,t[o],null));return a}},{key:"__checkForChildIbsFromTopLevelIbs",value:function(e,t,n){var i=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(i.selectDistinct(m.getCustomFieldName("Parent")).from(m.getCustomObjectName("Installed_Product")).where(m.getCustomFieldName("Parent")+" IN ("+t.__q+")"),n&&n.length)for(var a=0;a<n.length;a++)i.and(this.__buildFilterQueryRecursive(e,n[a],null));return i}},{key:"__getIBAttributesTemplateInstanceRecordsForSelectedIBs",value:function(e){var t=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});n.select("max(LastModifiedDate)"),n.from(m.getCustomFieldName("SM_IB_Attributes_Template_Instance")),n.__q+=" t2",n.__q=n.__q+" where t1."+m.getCustomFieldName("SM_Installed_Product_Id")+" = t2."+m.getCustomFieldName("SM_Installed_Product_Id");return t.selectDistinct("LastModifiedDate,"+m.getCustomFieldName("SM_Installed_Product_Id")).from(m.getCustomFieldName("SM_IB_Attributes_Template_Instance")),t.__q+=" t1",t.where(m.getCustomFieldName("SM_Installed_Product_Id")+" IN ("+e.__q+")"),t.and("LastModifiedDate = ("+n.__q+")"),t.orderBy("datetime(LastModifiedDate)"),t.desc(),t}},{key:"__getAttachementRecordsForSelectedRecords",value:function(e){var t=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return t.selectDistinct("parent_id as ParentId,last_modified_date as LastModifiedDate").from("SFAttachments"),t.__q+=" sf",t.where("parent_id IN ("+e.__q+")"),t.and("last_modified_date = (select max(last_modified_date) from SFAttachments where sf.parent_id = SFAttachments.parent_id)"),t.orderBy("datetime(last_modified_date)"),t.desc(),t}},{key:"__getAttachementRecordsForSelectedLocationRecords",value:function(e){var t=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return t.selectDistinct("parent_id as ParentId,last_modified_date as LastModifiedDate").from("SFAttachments"),t.__q+=" sf",t.where("parent_id").within(e),t.and("last_modified_date = (select max(last_modified_date) from SFAttachments where sf.parent_id = SFAttachments.parent_id)"),t.orderBy("datetime(last_modified_date)"),t.desc(),t}},{key:"__buildFilterQueryRecursive",value:function(e,t,n,i){var a=[];n=n||"AND",t.children=t.children||[];for(var r=0;r<t.children.length;r++){var o=t.children[r];switch(o.exprType){case"operator":case"operatorroot":var s=null,l=null;switch(o.operator){case"And":s="AND";break;case"Not And":s="AND",l=!0;break;case"Or":s="OR";break;case"Not Or":s="OR",l=!0}var c=this.__buildFilterQueryRecursive(e,o,s,i);c&&(r>0&&a.push(n),l&&a.push("NOT"),a.push("("+c+")"));break;case"expression":var u=this.__buildFilterQueryCondition(e,o,i);u&&(r>0&&a.push(n),a.push("("+u+" ) "));break;case"root":default:a.push(this.__buildFilterQueryRecursive(e,o,null,i))}}return a.join(" ")}},{key:"__buildFilterQueryCondition",value:function(e,t,n){var i=t.field,a=!1;e[i]&&("reference"!=e[i].type||this.__isNullOperater(t.condition)?a=!1:(i="Name",a=!0));var r=t.value,o="",s=void 0;if(i){var l=""+i;switch(n&&(l="main."+i),r=this.getdate(r,e[i].type),t.condition){case"Starts With":case"startswith":o=l+" LIKE '"+r+"%'";break;case"Not Equal":case"notequal":this.__istypeCastNeeded(l,e[i])?(s=this.typeCasting(l,e[i]),o=s+" != "+r):o=l+" != '"+r+"'";break;case"Less or Equal To":case"lessorequalto":if(s=this.typeCasting(l,e[i]),null===r||""===r)return;o=s+" <= "+r,o=this.excludeBlankStringFrom(l,o);break;case"Less Than":case"lessthan":if(s=this.typeCasting(l,e[i]),null===r||""===r)return;o=s+" < "+r,o=this.excludeBlankStringFrom(l,o);break;case"Is Null":case"isnull":o=l+" IS NULL",o=this.getNullValue(l,o);break;case"Is Not Null":case"isnotnull":o=l+" IS NOT NULL",o=this.getNotNullValue(l,o);break;case"Greater or Equal To":case"greaterorequalto":if(s=this.typeCasting(l,e[i]),null===r||""===r)return;o=s+" >= "+r,o=this.excludeBlankStringFrom(l,o);break;case"Greater Than":case"greaterthan":if(s=this.typeCasting(l,e[i]),null===r||""===r)return;o=s+" > "+r,o=this.excludeBlankStringFrom(l,o);break;case"in":case"Includes":case"includes":"MULTIPICKLIST"==e[i].type.toUpperCase()?(o=this.multiPiclistSupport("in",r,l),o=this.excludeBlankStringFrom(l,o)):o="1=1";break;case"ex":case"Excludes":case"excludes":o="MULTIPICKLIST"==e[i].type.toUpperCase()?this.multiPiclistSupport("NOTIN",r,l):"1=1";break;case"Equals":case"equals":this.__istypeCastNeeded(l,e[i])?(s=this.typeCasting(l,e[i]),o=s+" = "+r):o=l+" = '"+r+"'";break;case"Does Not Contain":case"doesnotcontain":o=l+" NOT LIKE '%"+r+"%'";break;case"Contains":case"contains":o=l+" LIKE '%"+r+"%'"}if(a){var c=t.condition;return"doesnotcontain"==c||"Does Not Contain"==c||"Not Equal"==c||"notequal"==c?this.getNullValue(l,this.__makeInQuery(e[t.field],o)):this.__makeInQuery(e[t.field],o)}return o}}},{key:"__isNullOperater",value:function(e){var t=!1;return"Is Null"!=e&&"isnull"!=e&&"Is Not Null"!=e&&"isnotnull"!=e||(t=!0),t}},{key:"excludeBlankStringFrom",value:function(e,t){return t+" AND ("+e+" != '')"}},{key:"getNullValue",value:function(e,t){return"("+t+") OR ("+e+" = '') "}},{key:"getNotNullValue",value:function(e,t){return"("+t+") AND ("+e+" != '') "}},{key:"typeCasting",value:function(e,t){if("DATE"==t.type.toUpperCase())e="date("+e+")";else if("DATETIME"==t.type.toUpperCase())e="datetime(replace("+e+",'+0000',''))";else if("BOOLEAN"==t.type.toUpperCase())e="cast("+e+" as "+t.type+")";else if("DOUBLE"==t.type.toUpperCase())e="cast("+e+" as "+t.type+")";else{if("INTEGER"!=t.type.toUpperCase())return e;e="cast("+e+" as "+t.type+")"}return e}},{key:"multiPiclistSupport",value:function(e,t,n){var i=t.split(","),a="",r="";"IN"==e.toUpperCase()?r=" like ":"NOTIN"==e.toUpperCase()&&(r=" not like ");for(var o=0;o<i.length;o++)0!=o&&(a+=" AND "),a=a+" ';' || "+n+" || ';'"+r+" '%;"+i[o].trim()+";%'";return"("+a+")"}},{key:"__istypeCastNeeded",value:function(e,t){var n=!1,i=t.type.toUpperCase();return"DATE"!=i&&"DATETIME"!=i&&"INTEGER"!=i&&"DOUBLE"!=i&&"BOOLEAN"!=i||(n=!0),n}},{key:"__makeInQuery",value:function(e,t){return e.api_name+" IN ( select id from "+e.reference_to+" Where "+t+")"}},{key:"getdate",value:function(e,t){switch(e.toLowerCase()){case"svmx.currentuser":case"svmx.currentuserid":case"svmx.usertrunk":break;case"yesterday":case"svmx.yesterday":e=this.getDateTimeAsFormat(t,"Yesterday");break;case"today":case"svmx.today":e=this.getDateTimeAsFormat(t,"Today");break;case"tomorrow":case"svmx.tomorrow":e=this.getDateTimeAsFormat(t,"Tomorrow");break;case"now":case"svmx.now":e=this.getDateTimeAsFormat(t,"Now")}return e}},{key:"getDateTimeAsFormat",value:function(e,t){var n="''",i=y;return"datetime"==e.toLowerCase()?n=i.macroDrivenDatetime(t,"YYYY-MM-DD","HH:mm:ss"):"date"==e.toLowerCase()&&(n=i.macroDrivenDatetime(t,"YYYY-MM-DD","","date")),"'"+n+"'"}},{key:"__appendParentRecords",value:function(e,t,n){function i(){0===--s&&(M.info("PIQTree ["+(performance.now()-o)+"] - appendParentRecords: -- onComplete"),r.resolve())}var a=this,r=m.Deferred();m.getCustomFieldName("Company"),m.getCustomFieldName("Site"),m.getCustomFieldName("Sub_Location");M.info("PIQTree []- appendParentRecords: -- start - ib length "+t.ibs.length+" accountId "+n);var o=performance.now(),s=0;return function(e){s++,m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("*").from("Account").where("Id").within(e).execute().done(function(e){t.accounts=e,i()})}([n]),function(e){s++;var n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});n.select("Id,Name,"+m.getCustomFieldName("Parent")+","+m.getCustomFieldName("Account")).from(m.getCustomObjectName("Site")),e&&n.where(m.getCustomFieldName("Account")+" = '"+e+"'"),n.orderBy("datetime(LastModifiedDate)"),n.desc(),n.andSetValue("Name COLLATE NOCASE");var r=n.q();a.__runQueryInBatch(r,0,[],function(e){t.locations=t.locations||[],t.locations=t.locations.concat(e),i()})}(n),r}},{key:"__appendTemplateConfigs",value:function(e){var t=m.Deferred(),n=void 0,i=e.ibs.length,a=[];for(n=0;n<i;n++){var r=e.ibs[n],o=r[m.getCustomFieldName("ProductIQTemplate")];o&&-1===a.indexOf(o)&&a.push(o)}return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Value").from("Configuration").where("Key").within(a).execute().done(function(n){if(n){for(var i={},a=0;a<n.length;a++){var r=m.toObject(n[a].Value);i[r.sfdcId]=r}e.templates=i}t.resolve()}),t}},{key:"__appendTransientRecordIndex",value:function(e){var t=m.Deferred();return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Id").from("ClientSyncLogTransient").execute().done(function(n){e.transients=[];for(var i=0;i<n.length;i++)e.transients.push(n[i].Id);t.resolve()}),t}},{key:"__getAllAccountsLocations",value:function(e){var t=m.Deferred();return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("*").from("Account").execute().done(function(n){e.accounts=n,m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("*").from(m.getCustomObjectName("Site")).execute().done(function(n){e.locations=n,t.resolve()})}),t}},{key:"__getLocationsForSelectedAccount",value:function(e,t){var n=this,i=m.Deferred();return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("*").from("Account").where("Id = '"+t+"'").execute().done(function(a){e.accounts=a;var r=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});r.select("Id,Name,"+m.getCustomFieldName("Parent")+","+m.getCustomFieldName("Account")).from(m.getCustomObjectName("Site")).where(m.getCustomFieldName("Account")+" = '"+t+"'").orderBy("datetime(LastModifiedDate)").desc().andSetValue("Name COLLATE NOCASE");var o=r.q();n.__runQueryInBatch(o,0,[],function(t){e.locations=t,i.resolve()})}),i}}]),t}(g),I.GetMoreIBs=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=y,i=e.parentIBId,a=(m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),0);e.page&&(a=1e6*(e.page-1));var r=new I.GetTopLevelIBs,o=null;void 0!==e.context.getFilterExpressions&&(o=e.context.getFilterExpressions()),r.buildQueryWithExpressions(e.params.iBReferenceInfo,o,!1).where("main."+m.getCustomFieldName("Parent")+" = '"+i+"'").orderBy("datetime(main.LastModifiedDate)").desc().andSetValue("main.Name COLLATE NOCASE").limit(1e6).offset(a).execute().done(function(s){var l=r.getTopLevelQueryWithExpressions(e.params.iBReferenceInfo,o,!1).where(m.getCustomFieldName("Parent")+" = '"+i+"'").orderBy("datetime(LastModifiedDate)").desc().andSetValue("Name COLLATE NOCASE").limit(1e6).offset(a);r.__getIBAttributesTemplateInstanceRecordsForSelectedIBs(l).execute().done(function(i){if(i.length>0)for(var a=s.length,c=0;c<a;c++){var u=s[c].Id;s[c].IBAttributeInstanceLastModDate="";for(var d=0;d<i.length;d++){var _=i[d][m.getCustomFieldName("SM_Installed_Product_Id")];if(_===u){s[c].IBAttributeInstanceLastModDate=i[d].LastModifiedDate;break}}}r.__getAttachementRecordsForSelectedRecords(l).execute().done(function(i){if(i.length>0)for(var a=s.length,c=0;c<a;c++){var u=s[c].Id;s[c].AttachementLastModDate="";for(var d=0;d<i.length;d++){var _=i[d].ParentId;if(_===u){var h=i[d].LastModifiedDate;if(-1!==h.search(/T/i)){var f=h.split("T");if(f.length>1){var p=n.convertISODateStringToSpecifiedFormat(h,"YYYY-MM-DD HH:mm:ss");s[c].AttachementLastModDate=p}}else s[c].AttachementLastModDate=i[d].LastModifiedDate;break}}}r.__checkForChildIbsFromTopLevelIbs(e.params.iBReferenceInfo,l,o).execute().done(function(e){for(var n=s.length,i=!1,a=m.getCustomFieldName("Parent"),r=0;r<n;r++){var o=s[r].Id;s[r].hasChild=!1;for(var l=0;l<e.length;l++){if(e[l][a]===o){i=!0;break}}i&&(s[r].hasChild=!0,i=!1)}t.result(s)})})})})}},{key:"performAsync2",value:function(e,t){var n=e.lastIBIndex||1;setTimeout(function(){for(var e=[],i=n;i<n+100;i++)e.push({Id:"Id"+i,Name:"Name"+i,RecordId:i});t.result(e)},1)}}]),t}(g),I.GetDetalPageInfo=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this;this.buildQueryWithExpressions().execute().done(function(e){if(e&&e.length>0){var i=JSON.parse(e[0].Value),a=i.ibEditProces,o=i.locationEditProces;a&&a.length>0?n.getPIQSFMEditProcessRecord(a[0].sfdcId,a[0].processId).execute().done(function(a){a&&a.length>0&&(i.ibEditProces[0].sfdcId=a[0].process_id,e[0].Value=(0,r.default)(i)),o&&o.length>0?n.getPIQSFMEditProcessRecord(o[0].sfdcId,o[0].processId).execute().done(function(n){n&&n.length>0&&(i.locationEditProces[0].sfdcId=n[0].process_id,e[0].Value=(0,r.default)(i)),t.result(e)}):t.result(e)}):o&&o.length>0?n.getPIQSFMEditProcessRecord(o[0].sfdcId,o[0].processId).execute().done(function(n){n&&n.length>0&&(i.locationEditProces[0].sfdcId=n[0].process_id,e[0].Value=(0,r.default)(i)),t.result(e)}):t.result(e)}else t.result(e)})}},{key:"buildQueryWithExpressions",value:function(){var e=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return e.select("*").from("Configuration"),e}},{key:"getPIQSFMEditProcessRecord",value:function(e,t){var n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return n.select("*").from("SFProcess"),n.where("process_id = '"+e+"'"),n.or("process_unique_id = '"+t+"'"),n}}]),t}(g),I.GetAllParentIBs=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){S.getAllParents4IB(e.record.Id).done(function(e){t.result(e)})}}]),t}(g),I.GetSearchProcessIB=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this;this.buildQueryWithExpressions().execute().done(function(e){var i=JSON.parse(e[0].Value),a=i.search[0].searches[0].sfdcId,r=i.search[0].searches[0].searchName;a?n.getSearchProcessfromProcessNameWithSfdcId(a).execute().done(function(e){e&&0===e.length?n.getSearchProcessfromProcessNameWithSearchName(r).execute().done(function(e){t.result(e)}):t.result(e)}):n.getSearchProcessfromProcessNameWithSearchName(r).execute().done(function(e){t.result(e)})})}},{key:"buildQueryWithExpressions",value:function(){var e=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return e.select("*").from("Configuration"),e}},{key:"getSearchProcessfromProcessNameWithSfdcId",value:function(e){var t=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return t.select("Id,"+m.OrgNamespace+"__Name__c as processName").from(m.OrgNamespace+"__ServiceMax_Processes__c"),t.where(m.OrgNamespace+"__Rule_Type__c = 'SRCH_NAMED_SEARCH'"),t.where("Id = '"+e+"'"),t}},{key:"getSearchProcessfromProcessNameWithSearchName",value:function(e){var t=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return t.select("Id,"+m.OrgNamespace+"__Name__c as processName").from(m.OrgNamespace+"__ServiceMax_Processes__c"),t.where(m.OrgNamespace+"__Rule_Type__c = 'SRCH_NAMED_SEARCH'"),t.where(m.OrgNamespace+"__ProcessID__c = '"+e+"'"),t}}]),t}(g),I.FindTechnicalAttributeTemplateForIB=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this;n.productDetails={},n.__getIbAttributesTemplateInstance(e.selectedIBID).done(function(i){if(i.length>0){var a={};a.IbAttributesTemplateInstance=i,a.templateId="";var r=i[0][m.getCustomFieldName("SM_Captured_On")],o=y.getFormattedDatetime(r,"YYYY-MM-DD");n.__getIBAttributesHistoryForSelectedIb(e.selectedIBID,o).done(function(i){a.IbAttributesHistory=i,n.__getTemplateAttributeDetailsForSelectedIB(e.selectedIBID).done(function(i){n.__updateLatestTechnicalAttributTemplateWithIBInstancePayload(i,a,e.selectedIBID),t.result(a)})})}else n.__getTemplateAttributeDetailsForSelectedIB(e.selectedIBID).done(function(e){t.result(e)})})}},{key:"__getIbAttributesTemplateInstance",value:function(e){var t=m.Deferred(),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return n.select("*").from(m.OrgNamespace+"__SM_IB_Attributes_Template_Instance__c"),n.where(m.OrgNamespace+"__SM_Installed_Product_Id__c = '"+e+"'"),(new I.SaveTechnicalAttributeTemplateInstanceForIB).__CheckForLastModifiedDate().done(function(e){e&&(n.orderBy(m.getCustomFieldName("SM_Captured_On")),n.desc()),n.execute().done(function(e){t.resolve(e)})}),t}},{key:"__getIBAttributesHistoryForSelectedIb",value:function(e,t){var n=m.Deferred(),i=y,a=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return a.select("LastModifiedDate, id, "+m.getCustomFieldName("SM_Captured_On")).from(m.OrgNamespace+"__SM_IB_Attributes_History__c"),a.where(m.getCustomFieldName("SM_Installed_Product_Id")+" = '"+e+"'"),a.orderBy(m.getCustomFieldName("SM_Captured_On")),a.desc(),a.execute().done(function(e){var t=[],a=[];if(e.length>0){for(var r=0;r<e.length;r++){var o=e[r][m.getCustomFieldName("SM_Captured_On")];if(o){for(var s=i.convertToTimezone(o),l=i.getFormattedDatetime(s,"YYYY-MM-DD"),c=!1,u=0;u<t.length;u++){if(t[u]===l){c=!0;break}}c||t.push(l)}}var d={};d.Id=e[0].Id,d.LastModifiedDate=e[0].LastModifiedDate,d[m.getCustomFieldName("SM_Captured_On")]=e[0][m.getCustomFieldName("SM_Captured_On")],d.TotalHistory=t.length,a.push(d),n.resolve(a)}else n.resolve(e)}),n}},{key:"__getProductDetailsForIB",value:function(e){var t=m.Deferred(),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return n.__q="select * from Product2 where id in ( select "+m.getCustomFieldName("Product")+" from "+m.OrgNamespace+"__Installed_Product__c where id = '"+e+"' )",n.execute().done(function(e){t.resolve(e)}),t}},{key:"__getTemplateForIBsProduct",value:function(e){var t=m.Deferred(),n=this,i=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return i.__q="select * from "+m.OrgNamespace+"__SM_Attributes_Template__c where id in ( select "+m.OrgNamespace+"__SM_Attribute_Template_Id__c from "+m.OrgNamespace+"__SM_Product_Attributes__c where "+m.OrgNamespace+"__SM_Product__c = '"+e.prodId+"' )",i.execute().done(function(e){n.__getLastModifiedDate("",e),t.resolve(e)}),t}},{key:"__getTemplateForIBsProductLine",value:function(e){var t=m.Deferred(),n=this,i=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return i.__q="select * from "+m.OrgNamespace+"__SM_Attributes_Template__c where id in ( select "+m.OrgNamespace+"__SM_Attribute_Template_Id__c from "+m.OrgNamespace+"__SM_Product_Attributes__c where "+m.OrgNamespace+"__SM_Product_Line__c = '"+e.prodLine+"' )",i.execute().done(function(e){n.__getLastModifiedDate("",e),t.resolve(e)}),t}},{key:"__getTemplateForIBsProductFamily",value:function(e){var t=m.Deferred(),n=this,i=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return i.__q="select * from "+m.OrgNamespace+"__SM_Attributes_Template__c where id in ( select "+m.OrgNamespace+"__SM_Attribute_Template_Id__c from "+m.OrgNamespace+"__SM_Product_Attributes__c where "+m.OrgNamespace+"__SM_Product_Family__c = '"+e.prodFamily+"' )",i.execute().done(function(e){n.__getLastModifiedDate("",e),t.resolve(e)}),t}},{key:"__getLastModifiedDate",value:function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var i=t[n];i.LastModifiedDate=e}}},{key:"__updateLatestTechnicalAttributTemplateWithIBInstancePayload",value:function(e,t,n){var i=this,a=null,o=null,s=null;if(t.IbAttributesTemplateInstance[0][m.getCustomFieldName("SM_Instance_Template_Id")],s=JSON.parse(t.IbAttributesTemplateInstance[0][m.getCustomFieldName("SM_Attr_Payload")]),e.length>0){a=e[0].Id,o=JSON.parse(e[0][m.getCustomFieldName("SM_Template_Json")]);for(var l=i.__getAllAttributesFromIBInstancePayload(s),c=0;c<o.fields.length;c++){for(var u=o.fields[c].technicalAttributes,d=[],_=0;_<u.length;_++){var h=u[_].label;h&&"string"==typeof h&&(h=h.toLowerCase());for(var f=!1,p=0;p<l.length;p++){var v=l[p].label;if(v&&"string"==typeof v&&(v=v.toLowerCase()),v===h){f=!0,u[_].defaultValue=l[p].defaultValue,d.push(u[_]);break}}f||d.push(u[_])}o.fields[c].technicalAttributes=d}t.IbAttributesTemplateInstance[0][m.getCustomFieldName("SM_Attr_Payload")]=(0,r.default)(o),t.templateId=a}}},{key:"__getTemplateAttributeDetailsForSelectedIB",value:function(e){var t=m.Deferred(),n=this;return n.__getProductDetailsForIB(e).done(function(e){e.length>0?(n.productDetails={prodId:null,prodLine:null,prodFamily:null},e[0].Id&&(n.productDetails.prodId=e[0].Id),e[0][m.OrgNamespace+"__Product_Line__c"]&&(n.productDetails.prodLine=e[0][m.OrgNamespace+"__Product_Line__c"]),e[0].Family&&(n.productDetails.prodFamily=e[0].Family),n.__getTemplateForIBsProduct(n.productDetails).done(function(e){e.length>0?t.resolve(e):n.__getTemplateForIBsProductLine(n.productDetails).done(function(e){e.length>0?t.resolve(e):n.__getTemplateForIBsProductFamily(n.productDetails).done(function(e){t.resolve(e)})})})):t.resolve(e)}),t}},{key:"__getAllAttributesFromIBInstancePayload",value:function(e){for(var t=[],n=0;n<e.fields.length;n++)for(var i=e.fields[n].technicalAttributes,a=0;a<i.length;a++)t.push(i[a]);return t}}]),t}(g),I.FindTechnicalAttributeHistoryTemplateForIB=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i={};n.__getIBAttributesHistoryForSelectedIb(e).done(function(e){i.IbAttributesHistory=e,t.result(i)})}},{key:"__getIBAttributesHistoryForSelectedIb",value:function(e){var t=m.Deferred(),n=e.selectedIBID,i=e.selectedTapDate,a=m.getCustomFieldName("SM_Captured_On"),r=m.getCustomFieldName("SM_Captured_On");r="datetime("+r+",'localtime')",i="datetime('"+i+"')";var o=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(o.select("*").from(m.getCustomFieldName("SM_IB_Attributes_History")),o.where(m.getCustomFieldName("SM_Installed_Product_Id")+" = '"+n+"'"),"previous"===e.tapStatus){var s=r+" < "+i;o.and(s),o.orderBy("datetime("+a+")"),o.desc()}else if("next"===e.tapStatus){var s=r+" > "+i;o.and(s),o.orderBy("datetime("+a+")")}return o.__q+=" Limit 1 ",o.execute().done(function(e){t.resolve(e)}),t}}]),t}(g),I.SaveTechnicalAttributeTemplateInstanceForIB=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this;n.__saveTemplateAttributeInstanceData(e).done(function(i){var a=i;n.__saveIBAttributeHistroyData(e,i.IBAttributeInstanceId).done(function(e){a.IBAttributeHistroryId=e.IBAttributeHistroryId,a.IBAttributeHistroryCapturedOn=e.IBAttributeHistroryCapturedOn,t.result(a)})})}},{key:"__saveTemplateAttributeInstanceData",value:function(e){var t=this,n=m.Deferred(),i=E,a=m.OrgNamespace+"__SM_IB_Attributes_Template_Instance__c";return C.describeObject({objectName:a,onSuccess:m.proxy(this,function(r){var o=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),s=b,l=null;l=s.__generateId(a);var c=i.getTableInfoFromDescribe(r),u=(c.columns,e.data),d=m.getCustomFieldName("SM_Attr_Payload"),_=m.getCustomFieldName("SM_Attr_Type"),h=m.getCustomFieldName("SM_Installed_Product_Id"),f=m.getCustomFieldName("SM_Instance_Template_Id"),p=m.getCustomFieldName("SM_Captured_On");(new Date).setHours(0,0,0,0);var v=((new Date).toISOString(),(new Date).toISOString(),m.getCustomFieldName("SM_Template_Json"));u[v]||(v=m.getCustomFieldName("SM_Attr_Payload"));var g={Id:l,OwnerId:"",IsDeleted:!1,Name:"",CreatedDate:"",CreatedById:"",LastModifiedById:"",SystemModstamp:""};g[d]=u[v],g[_]=u[m.getCustomFieldName("SM_Attr_Type_Template")],g[h]=e.selectedIBNodeId,g[f]=u.Id,t.__CheckForLastModifiedDate().done(function(t){if(t){var r=y.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss");g[p]=r}g[d]=u[v],g[_]=u[m.getCustomFieldName("SM_Attr_Type_Template")],g[h]=e.selectedIBNodeId,g[f]=u.Id,o.replaceInto(a),o.columns(c.columns),o.values(g),o.execute().done(function(e){i.createSyncLogs(a,[l],"insert").done(function(){var e={IBAttributeInstanceId:l,IBAttributeHistroryCapturedOn:r};n.resolve(e)})})})})}),n}},{key:"__saveIBAttributeHistroyData",value:function(e,t){var n=m.Deferred(),i=E,a=m.OrgNamespace+"__SM_IB_Attributes_History__c";return C.describeObject({objectName:a,onSuccess:m.proxy(this,function(r){var o=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),s=window.parent.com.servicemax.client.offline.sal.model.utils.Data,l=null;l=s.__generateId(a);var c=i.getTableInfoFromDescribe(r),u=(c.columns,e.data),d=m.getCustomFieldName("SM_Attr_Payload"),_=m.getCustomFieldName("SM_Attr_Type"),h=m.getCustomFieldName("SM_Installed_Product_Id"),f=m.getCustomFieldName("SM_Instance_Template_Id"),p=m.getCustomFieldName("SM_Captured_By"),v=m.getCustomFieldName("SM_Captured_On"),g=new Date;g.setHours(0,0,0,0);var S=(Ext.Date.format(g,"Y-m-d"),y.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss")),E={Id:l,OwnerId:"",IsDeleted:!1,Name:"",CreatedDate:"",CreatedById:"",LastModifiedDate:S,LastModifiedById:"",SystemModstamp:""},b=m.OrgNamespace+"__SM_Template_Json__c";void 0===u[b]&&(b=m.OrgNamespace+"__SM_Attr_Payload__c"),E[d]=u[b],E[_]=u[m.getCustomFieldName("SM_Attr_Type_Template")],E[h]=e.selectedIBNodeId,E[f]=t,E[p]="",E[v]=S,o.replaceInto(a).columns(c.columns).values(E).execute().done(function(e){i.createSyncLogs(a,[l],"insert").done(function(){var e={IBAttributeInstanceId:l,IBAttributeHistroryCapturedOn:S};n.resolve(e)})})})}),n}},{key:"__CheckForLastModifiedDate",value:function(){var e=m.Deferred();return this.__getInstanceTableFieldInfo().done(function(t){if(t){var n=t.length>0;e.resolve(n)}}),e}},{key:"__getInstanceTableFieldInfo",value:function(){var e=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),t=m.Deferred();return e.select(" api_name "),e.from("SFObjectField"),e.where("object_api_name").equals(m.getCustomFieldName("SM_IB_Attributes_Template_Instance")),e.where("api_name").equals(m.getCustomFieldName("SM_Captured_On")),e.execute().done(function(e){t.resolve(e)}),t}}]),t}(g),I.UpdateTechnicalAttributeTemplateForIB=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i=y;e.data.IBAttributeInstanceId?n.__updateTemplateAttributeInstanceData(e).done(function(a){var r=e.data,o=r.LastModifiedDate,s=new Date(o);s.setHours(0,0,0,0);var l=(Ext.Date.format(s,"Y-m-d"),i.getCurrentDatetime("YYYY-MM-DD")),c=i.convertToTimezone(r.IBAttributeHistroryCapturedOn),u=i.convertDateForExt(c,"YYYY-MM-DD");i.isSame(l,u)?n.__updateIBAttributeHistroyData(e).done(function(e){t.result(e)}):(new I.SaveTechnicalAttributeTemplateInstanceForIB).__saveIBAttributeHistroyData(e,r.Id).done(function(e){var n={};n.IBAttributeHistroryId=e.IBAttributeHistroryId,n.IBAttributeHistroryCapturedOn=e.IBAttributeHistroryCapturedOn,t.result(n)})}):n.__saveTemplateAttributeInstanceData(e,t)}},{key:"__saveTemplateAttributeInstanceData",value:function(e,t){var n=new I.SaveTechnicalAttributeTemplateInstanceForIB;n.__saveTemplateAttributeInstanceData(e).done(function(i){var a=i;n.__saveIBAttributeHistroyData(e,i.IBAttributeInstanceId).done(function(e){a.IBAttributeHistroryId=e.IBAttributeHistroryId,a.IBAttributeHistroryCapturedOn=e.IBAttributeHistroryCapturedOn,t.result(a)})})}},{key:"__updateTemplateAttributeInstanceData",value:function(e){var t=this,n=m.Deferred(),i=E,a=m.OrgNamespace+"__SM_IB_Attributes_Template_Instance__c";return C.describeObject({objectName:a,onSuccess:m.proxy(this,function(r){var o=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),s=e.data,l=s.IBAttributeInstanceId;(new Date).setHours(0,0,0,0);var c=((new Date).toISOString(),m.OrgNamespace+"__SM_Template_Json__c");void 0===s[c]&&(c=m.OrgNamespace+"__SM_Attr_Payload__c");var u=s[c],d=s.templateId,_=s[m.getCustomFieldName("SM_Instance_Template_Id")];t.__CheckForLastModifiedDate().done(function(e){if(o.update(a),o.setValue(m.getCustomFieldName("SM_Attr_Payload")).equals(u),e){var t=y.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss");o.andSetValue(m.getCustomFieldName("SM_Captured_On")).equals(t)}d&&d!==_&&o.andSetValue(m.getCustomFieldName("SM_Instance_Template_Id")).equals(d),o.where("Id").equals(l),o.execute().done(function(e){i.createSyncLogs(a,[l],"update").done(function(){n.resolve(e)})})})})}),n}},{key:"__updateIBAttributeHistroyData",value:function(e){var t=m.Deferred(),n=E,i=m.OrgNamespace+"__SM_IB_Attributes_History__c";return C.describeObject({objectName:i,onSuccess:m.proxy(this,function(a){var r=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),o=e.data,s=o.IBAttributeHistroryId;(new Date).setHours(0,0,0,0);var l=(new Date).toISOString(),c=m.OrgNamespace+"__SM_Template_Json__c";void 0===o[c]&&(c=m.OrgNamespace+"__SM_Attr_Payload__c");var u=o[c],d=y.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss");r.update(i).setValue(m.getCustomFieldName("SM_Attr_Payload")).equals(u).andSetValue("LastModifiedDate").equals(l).andSetValue(m.getCustomFieldName("SM_Captured_On")).equals(d).where("Id").equals(s).execute().done(function(e){n.createSyncLogs(i,[s],"update").done(function(){t.resolve(e)})})})}),t}},{key:"__CheckForLastModifiedDate",value:function(){var e=m.Deferred();return this.__getInstanceTableFieldInfo().done(function(t){if(t){var n=t.length>0;e.resolve(n)}}),e}},{key:"__getInstanceTableFieldInfo",value:function(){var e=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),t=m.Deferred();return e.select(" api_name "),e.from("SFObjectField"),e.where("object_api_name").equals(m.getCustomFieldName("SM_IB_Attributes_Template_Instance")),e.where("api_name").equals(m.getCustomFieldName("SM_Captured_On")),e.execute().done(function(e){t.resolve(e)}),t}}]),t}(g),I.FindIBRecordDetailsInLocalDB=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this,i=e.params.selectedIBId,a=e.params.accountId;this.__findSelectedIBRecordInLocalDB(i).done(function(e){if(e.length>0){var i=m.getCustomFieldName("Site"),r=m.getCustomFieldName("Parent"),o=m.getCustomFieldName("Top_Level"),s=e[0],l=s[i],c=s[r],u=s[o];u||c?n.__findTopLevelIdAndParentIdInLocalDatabase(u,c).done(function(e){e.length>0?n.__findSelectedAccountRecordInLocalDB(a).done(function(e){e.length>0?n.__findSelectedLocationRecordInLocalDB(l).done(function(e){e.length>0?t.result(!0):t.result(!1)}):t.result(!1)}):t.result(!1)}):n.__findSelectedAccountRecordInLocalDB(a).done(function(e){e.length>0?n.__findSelectedLocationRecordInLocalDB(l).done(function(e){e.length>0?t.result(!0):t.result(!1)}):t.result(!1)})}else t.result(!1)})}},{key:"__findTopLevelIdAndParentIdInLocalDatabase",value:function(e,t){var n=m.Deferred(),i=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(i.select("*").from(m.getCustomFieldName("Installed_Product")),e&&t){var a=[e,t];i.where("Id").within(a)}else!e||null!=t&&void 0!=t&&0!==t.length?null!=e&&void 0!=e&&0!==e.length||!t||i.where("Id = '"+t+"'"):i.where("Id = '"+e+"'");return i.execute().done(function(e){n.resolve(e)}),n}},{key:"__findSelectedIBRecordInLocalDB",value:function(e){var t=m.Deferred(),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return n.select("*").from(m.getCustomFieldName("Installed_Product")).where("Id = '"+e+"' "),n.execute().done(function(e){t.resolve(e)}),t}},{key:"__findSelectedAccountRecordInLocalDB",value:function(e){var t=m.Deferred(),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(n.select("*").from("Account").where("Id = '"+e+"' "),e.length>0)n.execute().done(function(e){t.resolve(e)});else{var i=[{test:"true"}];t.resolve(i)}return t}},{key:"__findSelectedLocationRecordInLocalDB",value:function(e){var t=m.Deferred(),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});if(n.select("*").from(m.getCustomFieldName("Site")).where("Id = '"+e+"' "),e.length>0)n.execute().done(function(e){t.resolve(e)});else{var i=[{test:"true"}];t.resolve(i)}return t}}]),t}(g),I.DeleteRecords=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=this;if(e.params&&e.params.node)this.__getAllNodeRecordDetails(e).done(function(i){n.__getTemplateRecords(i).done(function(i){n.__areAllRecordsTransient(i)?n.__DeleteRelatedAttachment(i,e.recordId).done(function(){n.__deleteAllRecords(i).done(function(){t.result(!0)})}):t.result(!1)})});else{var i=e.records;n.__getTemplateRecords(i).done(function(i){n.__DeleteRelatedAttachment(i,e.recordId).done(function(){n.__deleteAllRecords(i).done(function(){t.result(!0)})})})}}},{key:"__getAllNodeRecordDetails",value:function(e){function t(e){var n=m.Deferred(),a=e.childNodes.length,s=0;if(a){for(var l=0;l<a;l++){var c=e.childNodes[l];"LOADING"!==c.data.nodeType?(r.push({id:c.id,objectName:i.getObjectNameByNodeType(c.data.nodeType)}),"IB"===c.data.nodeType&&"IB"!==e.data.nodeType?i.getAllChildren4IB(c.id).done(function(e){for(var t=0;t<e.length;t++)r.push({id:e[t].Id,objectName:i.getObjectNameByNodeType("IB")});++s===a&&n.resolve()}):t(c).done(function(){++s===a&&n.resolve()})):(s++,o=c.data.parentId)}s===a&&n.resolve()}else n.resolve();return n}var n=m.Deferred(),i=S,a=e.params.node,r=[{id:e.recordId,objectName:i.getObjectNameByNodeType(a.data.nodeType)}],o=null;return t(a).done(function(){o?i.getAllChildren4IB(o).done(function(e){for(var t=0;t<e.length;t++)r.push({id:e[t].Id,objectName:i.getObjectNameByNodeType("IB")});n.resolve(r)}):n.resolve(r)}),n}},{key:"__getTemplateRecords",value:function(e){function t(t){var n=m.Deferred(),i=m.OrgNamespace+"__SM_IB_Attributes_Template_Instance__c";return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Id").from(i).where(m.getCustomFieldName("SM_Installed_Product_Id")).within(t).execute().done(function(t){for(var a=0;a<t.length;a++)e.push({id:t[a].Id,objectName:i});n.resolve(e)}),n}for(var n=m.Deferred(),i=[],a=0;a<e.length;a++)i.push(e[a].id);return function(t){var n=m.Deferred(),i=m.OrgNamespace+"__SM_IB_Attributes_History__c";return m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}).select("Id").from(i).where(m.getCustomFieldName("SM_Installed_Product_Id")).within(t).execute().done(function(t){for(var a=0;a<t.length;a++)e.push({id:t[a].Id,objectName:i});n.resolve(e)}),n}(i).done(function(e){t(i).done(function(e){n.resolve(e)})}),n}},{key:"__areAllRecordsTransient",value:function(e){for(var t=0;t<e.length;t++)if(4!==e[t].id.indexOf("local"))return!1;return!0}},{key:"__deleteAllRecords",value:function(e){var t=m.Deferred(),n=void 0,i=E,a={};for(n=0;n<e.length;n++){var r=e[n].id,o=e[n].objectName;a[o]=a[o]||[],a[o].push(r)}var s=[],l=void 0;for(var c in a)for(l=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),l.deleteFrom(c).where("Id").within(a[c]),s.push(l),n=0;n<a[c].length;n++){var u=a[c][n];i.deleteSyncLog(u)}return s.length?function(){var e=s.length;for(n=0;n<s.length;n++)s[n].execute().done(function(){0===--e&&t.resolve()})}():t.resolve(),t}},{key:"__DeleteRelatedAttachment",value:function(e,t){var n=m.Deferred(),i=this;return function(t){var n=m.Deferred(),a=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return a.select("Id, file_path as __path").from("SFAttachments").where("parent_id = '"+t+"'"),a.execute().done(function(t){i.DeleteLocalStorageFileAlso(t);for(var a=0;a<t.length;a++)e.push({id:t[a].Id,objectName:"SFAttachments"});n.resolve(e)}),n}(t).done(function(){n.resolve(e)}),n}},{key:"DeleteLocalStorageFileAlso",value:function(e){var t=this.getPathFromData(e);this.deleteFiles(t)}},{key:"getPathFromData",value:function(e){for(var t=[],n=e.length,i=0;i<n;i++){var a=e[i].__path;t.push(this.deleteLocalFile(a))}return t}},{key:"deleteFiles",value:function(e){var t=m.array.map(e,function(e){return e.deleteFile()});m.when(t).then(function(){})}},{key:"deleteLocalFile",value:function(e){return new T(e)}}]),t}(g),I.UpdateIBHierarchy=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"performAsync",value:function(e,t){var n=E;this.updateIBHierarchy(e.objectName,e.record).done(function(i){n.createSyncLogs(e.objectName,i,"update").done(function(){t.result()})})}},{key:"createFieldData4API",value:function(e){return m.create("com.servicemax.client.offline.sal.model.productiq.utils.API",{}).method("UPDATE").objectName(m.getCustomObjectName("Installed_Product")).criteria([{name:"Id",value:e,operator:"="}])}},{key:"updateIBHierarchy",value:function(e,t){if(e===m.getCustomObjectName("Site"))return this.updateLocation(t);var n=this,i=m.Deferred();return S.getAllChildren4IB(t.Id).done(function(e){var a=[],r=[];n.apiQueries=[];var o=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),s=t[m.getCustomFieldName("Site")]||"",l=(t[m.getCustomFieldName("Sub_Location")],t[m.getCustomFieldName("Parent")]||""),c=t[m.getCustomFieldName("Top_Level")]||"",u=void 0,d=e.length;for(o.update(m.getCustomObjectName("Installed_Product")).setValue(m.getCustomFieldName("Site")).equals(s).andSetValue(m.getCustomFieldName("Parent")).equals(l).andSetValue(m.getCustomFieldName("Top_Level")).equals(c).where("Id").equals(t.Id),r.push(o),a.push(t.Id),t.Id.match("local")&&n.apiQueries.push(n.createFieldData4API(t.Id).addField(m.getCustomObjectName("Site"),s).addField(m.getCustomObjectName("Parent"),l).addField(m.getCustomObjectName("Top_Level"),c)),c=c||t.Id,u=0;u<d;u++)if(o=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),o.update(m.getCustomObjectName("Installed_Product")).setValue(m.getCustomFieldName("Site")).equals(s).andSetValue(m.getCustomFieldName("Top_Level")).equals(c).where("Id").equals(e[u].Id),r.push(o),a.push(e[u].Id),e[u].Id.match("local")){var _=n.createFieldData4API(e[u].Id).addField(m.getCustomObjectName("Site"),s).addField(m.getCustomObjectName("Parent"),l).addField(m.getCustomObjectName("Top_Level"),c);n.apiQueries.push(_)}d=r.length;var h=d;for(u=0;u<d;u++)r[u].execute().done(function(e){0==--h&&(n.apiIBUpdate(n.apiQueries),i.resolve(a))})}),i}},{key:"updateLocation",value:function(e){var t=m.Deferred(),n=m.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{}),i=e[m.getCustomFieldName("Parent")]||"";return n.update(m.getCustomObjectName("Site")).setValue(m.getCustomFieldName("Parent")).equals(i).where("Id").equals(e.Id).execute().done(function(){t.resolve([e.Id])}),t}},{key:"apiIBUpdate",value:function(e){var t=m.Deferred(),n=0,i=e.length,a=i;for(n=0;n<i;n++)e[n].execute().done(function(e){0==--a&&t.resolve()});return t}}]),t}(g),m.defineGlobal(I.name,I),e.exports=I},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(5).SVMXObject,v=n(11).Facade,g={name:"com.servicemax.client.offline.sal.model.mobileinventory.utils"};g.Query=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__logger=p.getLoggingService().getLogger(),n.__q="",e&&e.query&&(n.__q=e.query),n.__insertColumns=null,n.__multiQueries=null,n.__multiQueryIndex=0,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"query",value:function(e){return this.__q=e,this}},{key:"q",value:function(){return this.__q}},{key:"__moveNext",value:function(){return null==this.__multiQueries?null:(this.__multiQueryIndex++,this.__multiQueryIndex<this.__multiQueries.length?this.__multiQueries[this.__multiQueryIndex]:null)}},{key:"execute",value:function(e){var t=f.Deferred();return this.executeInternal(this.q(),function(n){e?t.resolveWith(e,n):t.resolve(n)}),t}},{key:"executeInternal",value:function(e,t){function n(e){var n=r.__moveNext();n?r.executeInternal(n,t):t.call(r,e)}var i=v,a=i.createSQLRequest(),r=this;a.bind("REQUEST_COMPLETED",function(e){n(e.data.data)},this),a.bind("REQUEST_ERROR",function(t){this.__logger.error("Error QUERY: "+e),n([])},this),this.__logger.info("Executing QUERY: "+e.substring(0,e.length>150?150:e.length)),a.execute({query:e})}}]),t}(m),p.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=(n(10),n(0).utils),v=n(88).AbstractExtension,g=n(11).Facade,y=n(7).Data,S=n(7).Cache,E=n(7).ServerInfo,b={name:"com.servicemax.client.offline.sal.model.checklist.extensions"},T=y;b.ChecklistAttachmentExtension=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"perform",value:function(e,t){var n=t.attachmentData;this.__syncEventContext=e,this.__updateChecklistAttachments(n)}},{key:"__initSQLServiceRequest",value:function(e){var t=new m.Deferred,n=g,i=n.createSQLRequest();return i.bind("REQUEST_COMPLETED",m.proxy(this,function(e){t.resolve(e.data.data||[])})),i.bind("REQUEST_ERROR",m.proxy(this,function(e){t.reject(e.data.data||[])})),i.execute({query:e.query,queryArray:e.queryArray,queryParams:e.queryParams,doRollBack:e.doRollBack||!1}),t}},{key:"__updateChecklistAttachments",value:function(e){var t=this,n=m.OrgNamespace+"__SM_Checklist_Attachment__c",i=m.OrgNamespace+"__SM_Checklist__c",a=m.OrgNamespace+"__SM_Attachment_ID__c",o=m.OrgNamespace+"__SM_ContentDocumentLink_ID__c",s=(0,r.default)(e).map(function(t){return e[t]}),l=s.join("','"),c=this,u="";u=E.getMultiServerVersionRequest().isSalesForceFilesEnabled()?"SELECT Id, "+o+" AS contentDocumentLinkId, "+i+" AS ChecklistId  FROM "+n+" WHERE ("+o+" IN (SELECT c.Id from ContentDocumentLink c LEFT JOIN ContentDocument cd on c.ContentDocumentId = cd.Id where cd.LatestPublishedVersionId IN ('"+l+"'))) AND "+i+" NOT LIKE '%local%'":"SELECT Id, "+a+" AS AttachmentId, "+i+" AS ChecklistId  FROM "+n+" WHERE "+a+" IN ('"+l+"') AND "+i+" NOT LIKE '%local%'",this.__initSQLServiceRequest({query:u}).always(m.proxy(this,function(e){if(e&&"undefined"!==e){for(var n=[],i=void 0,a=[],r=0;r<e.length;r++)(i=e[r].Id)&&(a.push(i),n.push({Id:i,recordType:"master",parentId:e[r].ChecklistId||""}));n.length>0&&T.writeSyncRecords(n,[],[],function(){if(m.getCurrentApplication().getSyncImpl(),"SyncTargetedAttachments"===(t.__syncEventContext&&t.__syncEventContext.getName())){var e=m.getCustomFieldName("What_Id"),n=m.getCustomObjectName("Checklist"),i=m.getCustomFieldName("SM_Checklist"),r=m.getCustomObjectName("SM_Checklist_Attachment"),o=a.join("','"),s="select distinct "+e+" FROM "+n+" where Id in (\n                    select distinct "+i+" FROM "+r+" where id IN ('"+o+"'))";t.__initSQLServiceRequest({query:s}).always(m.proxy(t,function(e){var t=void 0;e&&"undefined"!==e&&e[0]&&(t=e[0].SVMXC__What_Id__c),t&&S.writeToJSCache("TARGETEDSYNC","recordId",t),c.__triggerDataSync()}))}else c.__triggerDataSync()})}}))}},{key:"__triggerDataSync",value:function(){var e=m.getCurrentApplication(),t=e.getSyncImpl(),n=this.__syncEventContext&&this.__syncEventContext.getName(),i=E.getMultiServerVersionRequest();"SyncTargetedAttachments"===n&&i.runTargetedSyncForChecklistAndOpdoc()?t.performTargetedSync(!1):t.performSync("ONECALLSYNC")}}]),t}(v),m.defineGlobal(b.name,b),e.exports=b},function(e,t,n){var i=n(13),a=n(713),r=n(0).utils;r.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"CONTROLLER","type":"com.servicemax.client.mvc.impl.Controller"}}}')),r.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"MODEL","type":"com.servicemax.client.mvc.impl.Model"}}}')),r.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),e.exports={api:i,impl:a}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m=n(129).AbstractNamedInstance,v={name:"com.servicemax.client.mvc.impl"};v.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(p),v.Controller=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__eventId2EventMap=null,e._model=null,e.__logger=null,e.__eventBus=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e,t,n){this.__logger=f.getLoggingService().getLogger("MVC-CONTROLLER("+e+")"),this.__eventId2EventMap={};var i=n.eventBus;this.__eventBus=n.eventBus;var a=void 0,r=t.length;for(a=0;a<r;a++){var o,s=t[a],l=s.data,c=l.length;for(o=0;o<c;o++){var u=l[o];this.__eventId2EventMap[u.event]={data:s,mapping:u},i.bind(u.event,this.eventHandler,this)}}}},{key:"eventHandler",value:function(e){try{var t=this.__eventId2EventMap[e.type],n=t.mapping.command,i=f.getClass(n),a=new i;a.setController(this),a.setEventBus(this.__eventBus);var r=e.data.request,o=e.data.responder;this.__logger.info("Executing command => "+e.type),a.executeAsync(r,o)}catch(e){throw this.__logger.error(e),e}}},{key:"setModel",value:function(e){this._model=e}},{key:"getModel",value:function(){return this._model}}]),t}(m),v.Model=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__operationId2OperationMap=null,e.__logger=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e,t,n){this.__logger=f.getLoggingService().getLogger("MVC-MODEL("+e+")"),this.__operationId2OperationMap={};var i=void 0,a=t.length;for(i=0;i<a;i++){var r,o=t[i],s=o.data,l=s.length;for(r=0;r<l;r++){var c=s[r];this.__operationId2OperationMap[c.operationId]={data:o,mapping:c}}}}},{key:"executeOperationAsync",value:function(e,t,n,i){try{var a=this.__operationId2OperationMap[n.operationId];if(!a)return;var r=a.mapping.operation,o=f.getClass(r),s=new o;s.setEventBus(i),s.performAsync(e,t)}catch(e){throw this.__logger.error(e),e}}}]),t}(m),v.View=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__viewConfig=null,e.__logger=null,e.__eventBus=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e,t,n){this.__logger=f.getLoggingService().getLogger("MVC-VIEW("+e+")"),this.__viewConfig={},n||(n={}),this.__eventBus=n.eventBus,f.array.forEach(t,function(e){f.array.forEach(e.data,function(e){var t=e["component-id"];this.__viewConfig[t]=e["class-name"]},this)},this)}},{key:"createComponent",value:function(e,t){try{var n=this.__viewConfig[e];if(t||(t={}),t.__view=this,n&&f.getClass(n,!0))return f.create(n,t)}catch(t){throw this.__logger.error("Error creating "+e+": "+t),t}}},{key:"triggerEvent",value:function(e){this.__eventBus.triggerEvent(e)}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(129).AbstractNamedInstance,v=n(5).SVMXObject,g={name:"com.servicemax.client.sfmconsole.engine"},y=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("IPAD")};g.ConsoleToolbarNameInstance=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__menuitems=[],e.__app=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"__processMenuItem",value:function(e){var t={title:"text","icon-class":"iconCls"};if(e.handler&&"function"!=p.typeOf(e.handler)){var n=this,i=p.create(e.handler);e.processor=i,e.handler=function(){i.eventHandler.call(this,{application:n.__app})}}var a={};for(var r in e)t[r]?a[t[r]]=e[r]:a[r]=e[r];return a}},{key:"initialize",value:function(e,t,n){this.__app||(n&&n.application?this.__app=n.application:this.__app=p.getCurrentApplication());for(var i=0;i<t.length;i++)for(var a=t[i].data,r=0;r<a.length;r++){var o=this.__processMenuItem(a[r]);this.__menuitems.push(o)}return this}},{key:"getMenuConfigItems",value:function(){return this.__menuitems}}]),t}(m),g.AbstractConsoleToolbarMenuItem=function(e){function t(){var e;(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e=null,(0,d.default)(n,e)}return(0,h.default)(t,e),(0,c.default)(t,[{key:"__translateMenuItem",value:function(e){var t=f.Deferred();for(var n in e)e[n]=this.__translateItems(n,e[n]);return t.resolve(),t}},{key:"__translateItems",value:function(e,t){return{title:!0,tooltip:!0,text:!0,displayText:!0,path:!0}[e]&&"Object"==p.typeOf(t)?"path"==e?this.__translatePathObject(t):y().T(t.module+"."+t.tag,t.text):t}},{key:"__translatePathObject",value:function(e){for(var t=e.text.split("/"),n=e.tag.split("/"),i=[],a=0;a<n.length;a++)i.push(y().T(e.module+"."+n[a],t[a]));return i.join("/")}},{key:"__isValueExist",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}},{key:"eventHandler",value:function(e){return null}},{key:"translateMenuItem",value:function(e,t,n){this.__translateMenuItem(t).done(function(){n()})}}]),t}(v),p.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m=n(13).Responder,v={name:"com.servicemax.client.sfmconsole.commands"};v.GetUserInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCONSOLE.GET_USERINFO"})}}]),t}(p),v.GetAppInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCONSOLE.GET_APP_INFO"})}}]),t}(p),v.GetUserInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetUserInfoCompleted(e)}},{key:"fault",value:function(e){}}]),t}(m),v.RetrieveDisplayTags=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCONSOLE.RETRIEVE_DISPLAY_TAGS"})}}]),t}(p),v.RetrieveDisplayTagsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__callback=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onRetrieveDisplayTags(e,null,this.__callback)}},{key:"fault",value:function(e,t){this.__parent.onRetrieveDisplayTags(e,t,this.__callback)}}]),t}(m),v.RetrieveOnDemandAppSettings=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCONSOLE.RETRIEVE_ON_DEMAND_APP_SETTINGS"})}}]),t}(p),v.RetrieveOnDemandSettingsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__callback=null,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onRetrieveOnDemandSettings(e)}},{key:"fault",value:function(e){this.__parent.onRetrieveOnDemandSettings(e)}}]),t}(m),v.SignOutUser=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCONSOLE.SIGNOUT"})}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(4),d=i(u),_=n(0).utils,h=n(5).EventDispatcher,f=n(5).SVMXObject,p={name:"com.servicemax.client.sfmconsole.ui.components.api"};p.ViewComposite=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,d.default)(t,e),t}(h),p.ViewContainer=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,d.default)(t,e),t}(p.ViewComposite),p.ViewPlan=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,d.default)(t,e),t}(p.ViewContainer),p.ViewModel=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,d.default)(t,e),t}(h),p.ViewModelNode=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,d.default)(t,e),t}(h),p.ViewEngine=function(e){function t(){return(0,s.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,d.default)(t,e),t}(f),_.defineGlobal(p.name,p),e.exports=p},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.sync.commands"};m.GetSyncStatus=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SYNC.GET_SYNC_STATUS"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(31),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(30),v=i(m),g=n(0).utils,y=n(5).EventDispatcher,S=n(402).pluginMethods,E=n(102).Facade,b=n(7).Cache,T=n(11).Facade,M=n(130).Utils,I=n(12).DatetimeUtil,C=n(5).ExtensionRunner,A=(n(7).ServerInfo,n(56)),D=n(401),x=n(56).SyncEvent,R={name:"com.servicemax.client.sync.impl.syncservice"},O=R;(0,v.default)(O,A,D,{name:R.name});var L=function(){return g.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},k=function(e){if(e.errors&&e.errors.length>0){var t={text:e.errors[0].errorMsg,type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};g.getCurrentApplication().showMessage(t)}else e.success&&g.Msg.toast({text:L().T("FSA018_TAG013","Transfer successfully completed. Initiate Data sync to get the updates.")})},N=function(e){var t={text:L().T("FSA018_TAG030","Can not complete the transaction as the app is in offline."),type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};g.getCurrentApplication().showMessage(t)};R.SyncService=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments));return e.__logger=g.getLoggingService().getLogger("SYNC-IMPL"),e.checkConnectionService(),e.addPluginMethods(),e.__requestId=null,e.__syncType=null,e.__syncEventCol=null,e.__syncAttachmentEventCol=null,e.__eventConfig=null,e.__eventDispatcher=null,e.__totalAttachmentCount=0,e.__currentAttachmentCount=0,e.__errorManagerImpl=null,e.__enableLogging=!0,e.__lastFailedRequestIds=[],e.__lastFailedSyncTypes={},e.__validatedUserProfileInfo={},e.__isSyncProfilingOnServerEnabled=!1,e.__enableOneCallSync=!1,e.__pausedAttachmentSyncType=null,e.__locationTrackingEnabled=!1,e.__syncQueue=null,e.__progressTotal=0,e.__lastConnectionStatus=!1,e.__inventoryQueue=[],e.__defaultEventConfig={PREINITIAL:[["SyncCacheOldSFAttachmentRecords"],["SyncLocalMetadata","SyncFailedRequestIds"],["SyncSettings"]],INITIAL:[["SyncCacheOldSFAttachmentRecords"],["SyncValidateProfile"],["SyncInitServer"],["SyncLocalMetadata"],["PopulateIgnoreList","SyncSettings"],["SyncServerVersion"],["SyncConfigDataInitial","PiqUserConfiguration"],["MobileInventoryConfigData"],["SyncPiqSettingsLocalDb"],["SyncGetPriceMetadata","PiqObjectDescribeInitial"],["PiqObjectDescribeForDependentPickListInitial","SyncGetCustomSnippetConfig"],["SyncRecordTypes","SyncGetChecklistData","SyncGetEvents"],["SyncGetDownloadCriteria","SyncGetAdvDownloadCriteria"],["SyncGetDownloadSalesforceFiles"],["PiqDataInitial"],["MobileInventoryData"],["SyncGetPriceData"],["SyncPiqGetLocalTopLevelIbs"],["PiqProductAttributeDataInitial","PiqIBAttributeDataInitial"],["PiqAttachmentSyncIntial"],["PiqFileSyncInitial"],["PopulateServicemaxProcessForChecklist"],["SyncLocalData"],["UpdateServiceMaxEventsInitial"],["CleanUnwantedTableData"],["SyncCleanUpSelect"]],ONECALLSYNC:[["SyncInitServer","UserTrunk"],["SuccessiveUpdates"],["SyncPiqSettingsLocalDb"],["SyncLocalDataIncremental"],["PiqDeletedProductIqData"],["SyncGetDeleteDownloadCriteria"],["SyncPutDelete"],["SyncPutInsert"],["SyncPutUpdate"],["OneCallSync"],["DeleteEventRelatedObjects"],["PiqDataIncremental"],["MobileInventoryData"],["SyncPiqGetLocalTopLevelIbs"],["SyncGetAdvDownloadCriteriaIncremental"],["SyncGetDownloadSalesforceFilesIncremental"],["SyncGetPriceDataIncremental"],["SyncChecklistIncremental","PiqProductAttributeDataIncremental","PiqIBAttributeDataInitialIncremental"],["PiqAttachmentSyncIncremental"],["PiqFileSyncIncremental"],["PiqCleanUnwantedTableData"],["SyncCleanUpSelect"],["SuccessiveUpdates"],["UpdateServiceMaxEvents"]],AGGRESSIVE:[["SyncInitServer","UserTrunk"],["SuccessiveUpdates"],["SyncLocalDataIncremental","PopulateIgnoreList"],["SyncGetDeleteDownloadCriteria"],["SyncPutDelete"],["SyncPutInsert"],["SyncPutUpdate"],["OneCallSync"],["DeleteEventRelatedObjects"],["SyncGetAdvDownloadCriteriaIncremental"],["SyncGetDownloadSalesforceFilesIncremental"],["SyncChecklistIncremental"],["SyncGetPriceDataIncrementalAggressive"],["SyncCleanUpSelect"],["SuccessiveUpdates"],["UpdateServiceMaxEvents"]],CONFIG:[["SyncValidateProfile"],["SyncInitServer"],["SyncLocalMetadataConfig"],["SyncConfigData"],["SyncGetPriceMetadataConfig","SyncSettingsConfig","SyncRecordTypes"],["PiqUserConfiguration","SyncGetCustomSnippetConfig"],["SyncPiqSettingsLocalDb"],["PiqObjectDescribeInitial"],["PiqObjectDescribeForDependentPickListInitial"],["PopulateServicemaxProcessForChecklist"],["MobileInventoryConfigData"],["SyncAttachmentsConfig","SyncMergeTempSFObjectConfig"],["SyncCleanUpSelect"],["ConfigUpgradeTableDefinition","SyncLocalData"]],PURGE:[["SyncInitServer"],["SyncLocalDataIncremental","PopulateIgnoreList"],["SyncGetEventsPurge","SyncGetDownloadCriteriaPurge","SyncGetAdvDownloadCriteriaPurge","SyncGetDownloadSalesforceFilesPurge"],["SyncGetPriceDataPurge"],["SyncMobileInventoryDataPurge"],["SyncPiqDataPurge"],["SyncCleanUpSelect"],["DataPurge"]],INSERT_LOCAL_RECORDS:[["SyncPutInsert"]],TARGETEDSYNC:[["SuccessiveUpdates"],["TargetedSyncPutDelete"],["TargetedSyncPutInsert"],["TargetedSyncPutUpdate"],["TargetedSyncReferenceData"],["TargetedSync"],["SuccessiveUpdates"]]},e.__attachmentsOnDemand={},e.__lastAttachmentOnDemand=null,e.__queueAttachmentIds=[],e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"checkConnectionService",value:function(){window.cordova?(this.__checkInitialConnection(),this.__checkConnectionByNotification()):this.__checkConnectionByPolling()}},{key:"__checkInitialConnection",value:function(){this.checkConnectivity().done(g.proxy(this,function(){this.__lastConnectionStatus=!0,this.dispatchEvent("CONNECTIVITY_CHANGED",{isConnected:!0})})).fail(g.proxy(this,function(){this.__lastConnectionStatus=!1,this.dispatchEvent("CONNECTIVITY_CHANGED",{isConnected:!1})}))}},{key:"__checkConnectionByPolling",value:function(){setInterval(g.proxy(this,function(){var e=this.getEvents("CONNECTIVITY_CHANGED");e&&e.length>0&&this.checkConnectivity().done(g.proxy(this,function(){this.__fireOnlineConnectivityNotification()})).fail(g.proxy(this,function(){this.__fireOfflineConnectivityNotification()}))}),5e3)}},{key:"__checkConnectionByNotification",value:function(){var e=this;document.addEventListener("online",g.proxy(this,function(){e.__fireOnlineConnectivityNotification()}),!1),document.addEventListener("offline",g.proxy(this,function(){e.__fireOfflineConnectivityNotification()}),!1)}},{key:"__fireOnlineConnectivityNotification",value:function(){!0!==this.__lastConnectionStatus&&(this.__lastConnectionStatus=!0,this.dispatchEvent("CONNECTIVITY_CHANGED",{isConnected:!0}))}},{key:"__fireOfflineConnectivityNotification",value:function(){!1!==this.__lastConnectionStatus&&(this.__lastConnectionStatus=!1,this.dispatchEvent("CONNECTIVITY_CHANGED",{isConnected:!1}))}},{key:"addPluginMethods",value:function(){var e=S;if(e)for(var t in e)t in this||(this[t]=e[t])}},{key:"isDataSync",value:function(e){return"ONECALLSYNC"===e||"AGGRESSIVE"===e||"TARGETEDSYNC"===e}},{key:"isAggressiveSync",value:function(e){return"AGGRESSIVE"===e}},{key:"isConfigSync",value:function(e){return"CONFIG"===e||"INITIAL"===e||"PREINITIAL"===e}},{key:"isInitialSync",value:function(e){return"INITIAL"===e}},{key:"isDataPurge",value:function(e){return"PURGE"===e}},{key:"validateDataSyncSequence",value:function(){var e=this.getSyncType(),t=this.isDataSync(e),n=this.isConfigSync(e),i=this.isDataPurge(e);return!t&&!n&&!i}},{key:"updateEventGroupBasedOnServerVersion",value:function(e){for(var t=E.getVersionClass(),n=e.length,i=0;i<n;i++)"PiqProductAttributeDataInitial"===e[i]?e[i]=t.getPiqProductAttributeDataInitialClassName():"PiqProductAttributeDataIncremental"===e[i]&&(e[i]=t.getPiqProductAttributeDataIncrementalClassName());return e}},{key:"startSync",value:function(e){if(!this.__restartRequired){this.__stopped=!0;var t=this.getSyncType(),n="ONECALLSYNC",i=!1,a=!1,o=!1,s=!1;if(t&&(i=!0),i&&(a=this.isDataSync(t)),e.type&&(n=e.type),this.__logger.info("Sync Request: "+e.type+"("+(0,r.default)(e)+")"),i&&this.__logger.info("Running Sync: "+t),o=this.isDataSync(n),o&&(s=this.validateDataSyncSequence(e)),o&&!s)return void this.__logger.info("Could not initiate Data sync");if(i){if("INSERT_LOCAL_RECORDS"===n)return void(a?this.__pushToSyncQueue(e.type,e.state):(this.__logger.info("Rejecting external request for inserting local records"),this.dispatchEvent("SYNC_REQUEST_REJECTED",{syncType:n})));if(a)return void this.__logger.info("Could not initiate "+n);this.__logger.info("Stopping Sync: '"+t+"'"),this.stopSync()}else this.__syncQueue=[];if("LOCATION"===n&&!this.isLocationTrackingEnabled())return void this.__logger.info("Location Tracking is NOT Enabled for this User By Admin");if(!(e.eventConfig||n in this.__defaultEventConfig))return void this.__logger.error("Unknown sync type '"+n+"'");g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().dispatchEvent("ABORT_ATTACHMENT_DOWNLOAD",this),this.__logger.info("Ready to run: '"+n+"'"),this.__syncType=n,this.__eventDispatcher=new O.SyncEventDispatcher,e.eventConfig?this.__eventConfig=e.eventConfig:this.__eventConfig=g.cloneObject(this.__defaultEventConfig[n]),this.enableDisableAutoLock(!0);var l=this;return g.doLater(function(){var t=[],n=this.__getEnableLogging({context:l,callback:function(e){l.__enableLogging=e,l.__logger.info("Enable Logging? "+this.__enableLogging)}});t.push(n);var i=b.readObjectFromDBCache("LAST_FAILED_REQUEST_IDS",function(e){l.__logger.info("Failed sync request ids:"+e),l.__lastFailedRequestIds=e||[]},l);t.push(i);var a=b.readObjectFromDBCache("LAST_FAILED_SYNC_TYPES",function(e){l.__lastFailedSyncTypes=e||{},l.__logger.info("Failed Sync Request Id in DB: "+(0,r.default)(l.__lastFailedSyncTypes))});t.push(a);var o=b.readObjectFromDBCache("VALIDATE_PROFILE_RESULT",function(e){var t={};if(e&&e.valueMap){for(var n=e.valueMap,i=0;i<n.length;i++){var a=n[i];t[a.key]=a.value}l.__validatedUserProfileInfo=t,l.__logger.info("VALIDATE_PROFILE_RESULT in DB: "+(0,r.default)(l.__validatedUserProfileInfo))}else l.__validatedUserProfileInfo=t});t.push(o),g.when(t).then(function(){l.getRequestId(!0),"ONECALLSYNC"!==l.__syncType&&"TARGETEDSYNC"!==l.__syncType&&"AGGRESSIVE"!==l.__syncType||(l.setLastFailedSyncType(!0),l.setLastFailedRequestId(!0)),l.__syncStart=new Date,l.__logger.info("Sync started ("+l.__syncType+") at "+l.__syncStart),l.__syncFinished=!1,l.dispatchEvent("SYNC_STARTED",l),l.__initProgressTracking(),l.__triggerNextEventCollection(e.state);var t=l.__validatedUserProfileInfo.SYNC_PROFILING||"";"true"===t.toLowerCase()||!0===t?l.__initSyncProfiling(l.__syncType):l.__logger.info("Sync Profiling Setting is False in Validate Profile Result.")},function(){l.__logger.error("Failed to getEnableLogging! Sync not started")})},l),this.__eventDispatcher}}},{key:"__pushToSyncQueue",value:function(e,t){this.__syncType===e||!this.__syncQueue||"INSERT_LOCAL_RECORDS"!==this.__syncType&&"INSERT_LOCAL_RECORDS"!==e||(this.__logger.info("Pushing Sync "+e+" in Queue"),this.__syncQueue.push({type:e,state:t}))}},{key:"getSyncImpl",value:function(){return g.getCurrentApplication().getSyncImpl()}},{key:"isEnableLogging",value:function(){return!0}},{key:"isLocationTrackingEnabled",value:function(){return!!this.getSyncImpl().getSyncSettingValue("ENABLE_LOCATION")}},{key:"isGetPriceEnabled",value:function(){return this.getSyncImpl().getSyncSettingValue("GET_PRICE_ENABLED")}},{key:"isGetPriceEnabledDuringAggressiveSync",value:function(){return this.getSyncImpl().getSyncSettingValue("GET_PRICE_ENBABLED_DURING_AGGRESSIVE_SYNC")}},{key:"isChecklistEnabled",value:function(){return this.getSyncImpl().getSyncSettingValue("CHECKLIST_ENABLED")}},{key:"enableDisableAutoLock",value:function(e){if(!this.__restartRequired){if("laptop"===g.getClient().getApplicationParameter("client-type").toLowerCase()){var t=T,n=void 0,i=void 0;e?(n=t.createDisableAutoSleepRequest(),i="Disabling Auto Lock during Sync Progress"):(n=t.createEnableAutoSleepRequest(),i="Clearing Auto Lock Setting as Sync Completed or Stopped"),n.bind("REQUEST_COMPLETED",function(e){this.__logger.info(i+" request was Successful")},this),n.bind("REQUEST_ERROR",function(e){this.__logger.error(i+" request Failed")},this),n.execute()}else e?SVMXPlugin.preventAutoLock(null,null,this.__syncType):SVMXPlugin.donotPreventAutoLock()}}},{key:"isProductIQEnabled",value:function(){return!!this.getSyncImpl().getSyncSettingValue("ENABLE_PRODUCTIQ")}},{key:"isMobileInventoryEnabled",value:function(){return!!this.getSyncImpl().getSyncSettingValue("ENABLE_MOBILE_INVENTORY")}},{key:"addInventoryParamsToSyncManager",value:function(e){this.__inventoryQueue.push(e)}},{key:"initiateInventoryTransfer",value:function(){var e=this;e.__inventoryQueue.length>0&&this.checkConnectivity(0).done(function(){for(var t=e.__inventoryQueue.length;t--;)e.__initiateStockTransfer(e.__inventoryQueue[t]),e.__inventoryQueue.splice(t,1)}).fail(function(){e.__showConnectivityErrorMessage()})}},{key:"__initiateStockTransfer",value:function(e){var t=this,n=e.requestParams||{};n.context=t;var i=g.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.STOCK_TRANSFER",this,{request:n,responder:{result:function(e){k(e)},fault:function(e){N()}}});e.deliveryEngine.getEventBus().triggerEvent(i)}},{key:"__showConnectivityErrorMessage",value:function(){var e={text:L().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."),type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};g.getCurrentApplication().showMessage(e)}},{key:"isFieldMergeEnabled",value:function(){return!!this.getSyncImpl().getSyncSettingValue("ENABLE_FIELD_MERGE")}},{key:"resetLastFailedSyncTypesStatus",value:function(){if(this.__syncType){var e=this.__getSyncTypeNormalized(this.__syncType);this.__lastFailedSyncTypes&&(delete this.__lastFailedSyncTypes[e],this.__logger.info("Deleting the Completed (Failed) Request: "+(0,r.default)(this.__lastFailedSyncTypes))),this.saveLastFailedSyncTypesToDb()}}},{key:"__getEnableLogging",value:function(e){var t=new g.Deferred,n=!1,i=this.getSyncType();return(this.isDataSync(i)||this.isDataPurge(i)||this.isInitialSync(i)||"CONFIG"===i)&&(n=!0),e.callback.call(e.context,n),t.resolve(),t}},{key:"stopSync",value:function(e){this.__syncType=null,this.__eventConfig=null;var t=!1;return this.__syncFinished=!0,this.__syncEventCol&&(this.__syncEventCol.stopAll(),this.__syncEventCol=null,t=!0),this.stopAttachmentSync(),this.enableDisableAutoLock(!1),t&&(this.setLastFailedSyncType(e),this.setLastFailedRequestId(e),this.__logger.info("Sync stopped"),this.dispatchEvent("SYNC_STOPPED",this)),t}},{key:"pauseSync",value:function(e){this.__syncEventCol?(this.__syncEventCol.pauseAll(),this.__logger.info("Sync paused"),this.dispatchEvent("SYNC_PAUSED",this)):this.__syncAttachmentEventCol&&(this.__syncAttachmentEventCol.pauseAll(),this.__pausedAttachmentSyncType=this.__syncAttachmentEventCol.__eventGroup[0],this.__logger.info("Attachment sync paused"),this.dispatchEvent("SYNC_PAUSED",this)),void 0===e&&(e=!0),this.setLastFailedSyncType(e),this.setLastFailedRequestId(e)}},{key:"setLastFailedSyncType",value:function(e,t){if((e||t)&&this.__syncType){var n=this.getRequestId(),i=this.__getSyncTypeNormalized(this.__syncType);this.__lastFailedSyncTypes[i]=n,this.saveLastFailedSyncTypesToDb(),this.__logger.info("Failed Sync Type List :"+(0,r.default)(this.__lastFailedSyncTypes))}}},{key:"saveLastFailedSyncTypesToDb",value:function(){this.__logger.info("Saving Failed Sync Types As : "+(0,r.default)(this.__lastFailedSyncTypes?this.__lastFailedSyncTypes:{})),b.writeObjectToDBCache("LAST_FAILED_SYNC_TYPES",this.__lastFailedSyncTypes?this.__lastFailedSyncTypes:{})}},{key:"setLastFailedRequestId",value:function(e,t){this.__lastFailedRequestIds||(this.__lastFailedRequestIds=[]),(e||t)&&this.__syncType&&(-1===this.__lastFailedRequestIds.indexOf(this.__requestId)&&this.__lastFailedRequestIds.push(this.__requestId),this.__logger.info("Saving Failed request Ids As : "+(0,r.default)(this.__lastFailedRequestIds)),b.writeObjectToDBCache("LAST_FAILED_REQUEST_IDS",this.__lastFailedRequestIds))}},{key:"resumeSync",value:function(){this.__syncEventCol?(this.__syncEventCol.resumeAll(),this.__logger.info("Sync resumed"),this.dispatchEvent("SYNC_RESUMED",this)):this.__syncAttachmentEventCol&&(this.__syncAttachmentEventCol.resumeAll(),this.__logger.info("Attachment sync resumed"),this.dispatchEvent("SYNC_RESUMED",this))}},{key:"__getSyncTypeNormalized",value:function(e){return this.isDataSync(e)&&(e="DATA"),e}},{key:"getRequestId",value:function(e){var t=this.__getSyncTypeNormalized(this.__syncType),n=this.__lastFailedSyncTypes?this.__lastFailedSyncTypes[t]:null;return n?this.__requestId=n:this.__requestId&&!e||(this.__requestId="Sync_"+Math.floor((new Date).getTime())+"_"+Math.floor(1e3*Math.random())),this.__requestId}},{key:"getSyncType",value:function(){return this.__syncType}},{key:"getEventConfig",value:function(){return g.cloneObject(this.__eventConfig)}},{key:"getUserInfo",value:function(e,t){this.getSyncImpl().getLastSyncUser({callback:e||function(){},context:t||this})}},{key:"setUserInfo",value:function(e,t,n){t||(t=function(){}),this.getSyncImpl().refreshUserInfo(e,t,n)}},{key:"getState",value:function(e){return this.__syncEventCol?this.__syncEventCol.getState(e):null}},{key:"setState",value:function(e,t){return this.__syncEventCol?this.__syncEventCol.setState(e,t):null}},{key:"getConflicts",value:function(e){return M.getSyncConflicts(e)}},{key:"getConflictCount",value:function(e){return M.getSyncConflictCount(null,e)}},{key:"getDisplayableConflicts",value:function(e){return M.getDisplayableSyncConflicts(e)}},{key:"getDetailedSyncConflicts",value:function(e,t){return M.getDetailedSyncConflicts(e,t)}},{key:"getIsRunning",value:function(){return Boolean(this.__syncType)}},{key:"dispatchEvent",value:function(e,t){var n=new O.SyncEvent(e,this,t);if(this.triggerEvent(n),this.__eventDispatcher){var i=new O.SyncEvent(e,this,t);this.__eventDispatcher.triggerEvent(i)}}},{key:"validateLocalMetadata",value:function(e){var t=g.create("com.servicemax.client.sync.api.SyncEventCollection",this,{});g.create("com.servicemax.client.sync.api.SyncLocalMetadata",{},"SyncLocalMetadata",t).validateSchema(e)}},{key:"loadInstallBaseTable",value:function(e){return g.create("com.servicemax.client.offline.sal.model.sync.extensions.InstallBaseExtension",this,{}).fillObjectTable()}},{key:"startAttachmentSync",value:function(e){e=e||{},"SyncAttachmentsInitial"===this.__pausedAttachmentSyncType&&(e.syncType="INITIAL"),e.syncType=e.syncType||"ONECALLSYNC";var t=null;if(this.isInitialSync(e.syncType))t="SyncAttachmentsInitial";else{if(!this.isDataSync(e.syncType)&&!this.isDataPurge(e.syncType))return void this.__finalizeAttachmentSync(!1);t="TARGETEDSYNC"===e.syncType?"SyncTargetedAttachments":"SyncAttachmentsIncremental"}this.__eventDispatcher=new O.SyncEventDispatcher;var n=new Date,i=0;return this.__syncAttachmentEventCol=g.create("com.servicemax.client.sync.api.SyncEventCollection",this,{eventGroup:[t],state:this.getState(),onCompleted:g.proxy(this,function(){i=new Date-n,this.__syncAttachmentEventCol=null,this.__logger.info("Attachment sync completed in "+i+"ms total"),this.dispatchEvent("SYNC_ATTACHMENTS_COMPLETED"),this.dispatchEvent("SYNC_ATTACHMENTS_STOPPED",{success:!0}),this.__finalizeAttachmentSync(!0),this.enableDisableAutoLock(!1),this.__triggerEncryptDecryptCheck(t)})}),g.create("com.servicemax.client.sync.api."+t,{},t,this).getTotalCount(g.proxy(this,function(e){e>0?(this.enableDisableAutoLock(!0),this.__attachmentInProgress=!0,this.dispatchEvent("SYNC_ATTACHMENTS_STARTED"),this.__logger.info("Attachment sync started ("+e+" pending) at "+n),this.__syncAttachmentEventCol.triggerAll()):(this.__logger.info("No attachments pending sync"),this.__syncAttachmentEventCol=null,this.__finalizeAttachmentSync(!1),this.__triggerEncryptDecryptCheck(t))})),this.__eventDispatcher.bind("SYNC_EVENT_PROGRESS",g.proxy(this,function(e){this.dispatchEvent("SYNC_ATTACHMENTS_PROGRESS",e.data)})),this.__eventDispatcher}},{key:"stopAttachmentSync",value:function(){return this.dispatchEvent("SYNC_ATTACHMENTS_STOPPED",this),this.__attachmentInProgress=!1,this.__totalAttachmentCount=0,this.__stopped=!0,!!this.__syncAttachmentEventCol&&(this.__syncAttachmentEventCol.stopAll(),this.__triggerEncryptDecryptCheck(this.__syncAttachmentEventCol.__eventGroup[0]),this.__syncAttachmentEventCol=null,this.__logger.info("Attachment sync stopped"),!0)}},{key:"startLocationSync",value:function(){function e(e){e||t.__syncLocationEventCol.stopAll(),t.__syncLocationEventCol=null,b.writeToDBCache("SYNC_STATUS.LOCATION",e?"Success":"Failed"),b.writeToDBCache("LAST_SYNC_TIME.LOCATION",n),t.enableDisableAutoLock(!1)}if(!this.__syncLocationEventCol){if(!this.isLocationTrackingEnabled())return void this.__logger.info("Location Tracking is NOT Enabled for this User By Admin");var t=this,n=I.getTimestampWithSaveFormat();this.enableDisableAutoLock(!0);var i={dispatchEvent:function(n,i){"SYNC_EVENT_STARTED"===n?(i.getSyncManager=function(){return t},i._checkConnectivity=function(t){return function(n){t.call(i,function(t){t||e(!1),n&&n.call(i,t)})}}(i._checkConnectivity)):"SYNC_ERROR"===n&&e(!1)}};t.__syncLocationEventCol=g.create("com.servicemax.client.sync.api.SyncEventCollection",i,{eventGroup:["SyncLocationData"],onCompleted:function(){t.__syncLocationEventCol&&e(!0)}}),t.__syncLocationEventCol.triggerAll()}}},{key:"beforeFirstRun",value:function(e){this.startSync({type:"PREINITIAL"}).bind("SYNC_STOPPED",g.proxy(this,function(){g.doLater(function(){this.beforeFirstRunCompleted(!0),e&&e()},this)}))}},{key:"beforeFirstRunCompleted",value:function(e){return void 0!==e&&(this.__beforeFirstRunCompleted=e),this.__beforeFirstRunCompleted}},{key:"checkConnectivity",value:function(e){var t=g.Deferred();if(g.TEST)return t.resolve(),t;var n=T,i=n.createConnectivityRequest();return e=e||{},i.bind("REQUEST_COMPLETED",function(e){var n=e.data.data.toLowerCase();"true"===n?t.resolve():t.reject()},this),i.bind("REQUEST_ERROR",function(e){t.reject()},this),i.execute({delay:e.delay||2e3}),t.promise()}},{key:"downloadOnDemand",value:function(e,t){var n=g.Deferred();return g.create("com.servicemax.client.sync.api.SyncEventCollection",this,{eventGroup:["SyncDownloadOnDemand"],state:{recordId:e},onCompleted:g.proxy(this,function(e){return n.resolve(),t&&t()})}).triggerAll(),n}},{key:"cancelAttachmentDownloadOnDemand",value:function(e){if(!e||!this.__attachmentsOnDemand[e])return void console.warn("Tried to cancel an attachment download on demand that was not yet queued!");"waiting"==this.__attachmentsOnDemand[e].status&&(this.__attachmentsOnDemand[e].status=""),this.__queueAttachmentIds.splice(this.__queueAttachmentIds.indexOf(e),1)}},{key:"clearAttachmentDownload",value:function(){this.__attachmentsOnDemand={},this.__queueAttachmentIds=[]}},{key:"downloadAttachmentOnDemandStatus",value:function(e){return e&&this.__attachmentsOnDemand[e]&&this.__attachmentsOnDemand[e].status?this.__attachmentsOnDemand[e].status:""}},{key:"downloadAttachmentOnDemandClearError",value:function(e){e&&this.__attachmentsOnDemand[e]&&"error"===this.__attachmentsOnDemand[e].status&&delete this.__attachmentsOnDemand[e]}},{key:"downloadAttachmentOnDemand",value:function(e){if(e&&!(this.__attachmentsOnDemand[e]&&"error"!=this.__attachmentsOnDemand[e].status&&this.__queueAttachmentIds.indexOf(e)>-1)){var t=g.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.__attachmentsOnDemand[e]={status:"waiting"},this.__downloadAttachmentOnDemandTriggerEvent(t,e,"ATTACHMENT_ON_DEMAND.STARTING"),this.__createAttachmentOnDemendQueueItem(e)}}},{key:"__createAttachmentOnDemendQueueItem",value:function(e){this.__queueAttachmentIds.indexOf(e)<0&&this.__queueAttachmentIds.push(e),1===this.__queueAttachmentIds.length&&this.__processQueueItem(this.__queueAttachmentIds[0])}},{key:"__processQueueItem",value:function(e){var t=this,n=(g.Deferred(),g.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance());e&&(this.__attachmentsOnDemand[e]={status:"downloading"}),this.__downloadAttachmentOnDemandTriggerEvent(n,e,"ATTACHMENT_ON_DEMAND.DOWNLOADING"),this.__downloadAttachmentOnDemandJob(e).done(g.proxy(this,function(){e&&delete this.__attachmentsOnDemand[e],this.__downloadAttachmentOnDemandTriggerEvent(n,e,"ATTACHMENT_ON_DEMAND.FINISHED")})).fail(g.proxy(this,function(t){t=t||"error",this.__attachmentsOnDemand[e]={status:t},this.__downloadAttachmentOnDemandTriggerEvent(n,e,"ATTACHMENT_ON_DEMAND."+t.toUpperCase())})).always(g.proxy(this,function(){t.__queueAttachmentIds.splice(t.__queueAttachmentIds.indexOf(e),1),t.__queueAttachmentIds.length>0&&t.__processQueueItem(t.__queueAttachmentIds[0])}))}},{key:"__downloadAttachmentOnDemandJob",value:function(e){var t=g.Deferred();return e?this.__queueAttachmentIds.indexOf(e)<0?(t.reject("cancelled"),t.promise()):(this.__downloadAttachmentOnDemandImpl(e,0,3,t),t.promise()):(t.resolve(),t.promise())}},{key:"__downloadAttachmentOnDemandImpl",value:function(e,t,n,i){var a=this;this.checkConnectivity().done(g.proxy(this,function(){this.downloadOnDemand(e,function(){g.create("com.servicemax.client.sync.api.SyncDownloadOnDemand",this)._downloadAttachment(e,!1).done(g.proxy(a,function(){i.resolve()})).fail(g.proxy(a,function(){++t>n?(a.__logger.warn("Failed 3 times to download attachment on demand!"),i.reject()):setTimeout(g.proxy(a,function(){a.__downloadAttachmentOnDemandImpl(e,t,n,i)}),5e3)}))})})).fail(g.proxy(this,function(){setTimeout(g.proxy(this,function(){this.__downloadAttachmentOnDemandImpl(e,t,n,i)}),5e3)}))}},{key:"__downloadAttachmentOnDemandTriggerEvent",value:function(e,t,n){if(e&&t&&n){var i=g.create("com.servicemax.client.lib.api.Event",n,this,{request:{recordId:t}});e.triggerEvent(i)}}},{key:"__initProgressTracking",value:function(){for(var e=1,t=0,n=0;n<this.__eventConfig.length;n++)e+=this.__eventConfig[n].length;e++,this.__eventDispatcher.bind("SYNC_STARTED",g.proxy(this,function(n){this.dispatchEvent("SYNC_PROGRESS",{currentStep:t,totalCount:e})})),this.__eventDispatcher.bind("SYNC_EVENT_COMPLETED",g.proxy(this,function(n){this.dispatchEvent("SYNC_PROGRESS",{currentStep:t++,totalCount:e,description:n.data.getDescription(),eventName:n.data.getName()})})),this.__eventDispatcher.bind("SYNC_EVENT_PROGRESS",g.proxy(this,function(e){this.dispatchEvent("SYNC_PROGRESS",{recordCount:e.data.recordCount})})),this.__eventDispatcher.bind("SYNC_COMPLETED",g.proxy(this,function(t){this.dispatchEvent("SYNC_PROGRESS",{currentStep:e,totalCount:e})}))}},{key:"__initProfilingOnServer",value:function(e){var t=this,n=e.data?e.data.currentStep:-1,i=null;0!==n||0===n&&-1!=n&&(i=t.__getProfilingOnServerRequestParams("start"),t.__makeRequestToProfilingOnServer(i))}},{key:"__getProfilingOnServerHeaders",value:function(){var e=this.__validatedUserProfileInfo;return{"Content-Type":"application/json",From:"ServiceMaxNow",clientId:e.ORGID,clientName:e.ORGNAME}}},{key:"__getProfilingOnServerInitParameters",value:function(){var e=this,t=e.__validatedUserProfileInfo,n=g.getCurrentApplication().getUserInfo(),i=e.getState("SYNC_START_TIME");g.getClient().getApplicationParameter("client-uuid");return{classicprofileid:t.PROFILEID,classicuserid:{id:n.UserId,name:n.UserName},devicename:g.getClientTypeForUnifiedApp(),srid:e.__requestId,svmxprofile:{id:n.SvmxProfileId,name:t.PROFILENAME},syncstartime:i}}},{key:"__getProfileOnServerEndParameters",value:function(){var e=this,t=I.getSaveFormat("datetime"),n=I.getCurrentDatetimeGMT(t);return{srid:e.getRequestId(),syncendtime:n,requesttimeout:"No"}}},{key:"__getProfilingOnServerRequestParams",value:function(e){var t=this,n={},i=t.__getProfilingOnServerHeaders();return"start"===e?n=t.__getProfilingOnServerInitParameters():(e="end",n=t.__getProfileOnServerEndParameters()),{url:"https://empp.servicemax-api.com/instrument/clientsync",method:"POST",isNonSalesforceUrl:!0,data:n,headers:i,type:e}}},{key:"__makeRequestToProfilingOnServer",value:function(e){var t=T,n=b,i=t.createHTTPRequest();i.bind("REQUEST_COMPLETED",function(e){n.deleteFromDBCache("SYNC_PROFILING_PENDING_REQUEST")}),i.bind("REQUEST_ERROR",function(t){e.requesttimeout="Yes",e.reason="Update to profiling Server failed.",n.writeObjectToDBCache("SYNC_PROFILING_PENDING_REQUEST",e)}),i.execute(e)}},{key:"__updateProfilingOnServer",value:function(e){var t=this,n=b,i=t.__getProfilingOnServerRequestParams("end"),a=e.type;"SYNC_STOPPED"===a||"SYNC_FAILED"===a?(i.requesttimeout="Yes",i.reason=a,n.writeObjectToDBCache("SYNC_PROFILING_PENDING_REQUEST",i)):"SYNC_COMPLETED"===e.type&&t.__makeRequestToProfilingOnServer(i),t.__unBindProfilingListeners()}},{key:"__unBindProfilingListeners",value:function(e){var t=this,n=t.getSyncImpl();n.unbind("SYNC_PROGRESS",t.__initProfilingOnServer),n.unbind("SYNC_COMPLETED",t.__updateProfilingOnServer),n.unbind("SYNC_STOPPED",t.__updateProfilingOnServer),n.unbind("SYNC_FAILED",t.__updateProfilingOnServer)}},{key:"__checkFailedProfilingRequestAndUpdateServer",value:function(){var e=this;b.readObjectFromDBCache("SYNC_PROFILING_PENDING_REQUEST",function(t){t&&e.__makeRequestToProfilingOnServer(t)})}},{key:"__initSyncProfiling",value:function(e){var t=this,e=e||t.getSyncType(),n=t.isDataPurge(e)||t.isDataSync(e)||t.isConfigSync(e)&&"PREINITIAL"!=e,i=this.getSyncImpl();t.__checkFailedProfilingRequestAndUpdateServer(),n?(this.__logger.info("Initiating Profiling for "+e),i.bind("SYNC_PROGRESS",t.__initProfilingOnServer,t),i.bind("SYNC_COMPLETED",t.__updateProfilingOnServer,t),i.bind("SYNC_STOPPED",t.__updateProfilingOnServer,t),i.bind("SYNC_FAILED",t.__updateProfilingOnServer,t)):this.__logger.info("Could not Initiate Profiling for "+e)}},{key:"__triggerNextEventCollection",value:function(e){this.__eventConfig&&this.__eventConfig.length&&(this.__eventGroup=this.__eventConfig.shift(),this.__eventGroup||this.__triggerNextEventCollection(),this.__eventGroup=this.updateEventGroupBasedOnServerVersion(this.__eventGroup),this.__syncEventCol=g.create("com.servicemax.client.sync.api.SyncEventCollection",this,{state:e||this.getState(),requestId:this.getRequestId(),eventGroup:this.__eventGroup,onCompleted:this.__onCollectionCompleted}),this.setState("LAST_FAILED_REQUEST_IDS",this.__lastFailedRequestIds),this.__logger.info("Triggering sync events: "+this.__eventGroup),this.setState("SYNC_START_TIME",I.getCurrentDatetimeGMT(I.getSaveFormat("datetime"))),this.__syncEventCol.triggerAll())}},{key:"__triggerNextSyncInQueue",value:function(){if(this.__syncQueue&&this.__syncQueue.length){var e=this.__syncQueue.shift();e&&e.type&&this.startSync(e)}}},{key:"triggerExternalRequest",value:function(e,t){this.__eventDispatcher.bind("INSERT_LOCAL_RECORDS_RESPONSE",function(e){t&&t.handler.call(t.context,e.data)}),this.dispatchEvent("INSERT_LOCAL_RECORDS",{syncType:"INSERT_LOCAL_RECORDS",requestData:{recordIds:e}})}},{key:"triggerRecursiveDataSync",value:function(e){var t=this;t.getConflictCount(g.proxy(this,function(n){if(n&&n.count>0)return e();t.__eventConfig&&t.__eventConfig.unshift(["SuccessiveUpdates"],["SyncPutDelete"],["SyncPutInsert"],["SyncPutUpdate"],["OneCallSync"]),e()}))}},{key:"__onCollectionCompleted",value:function(e){if(this.__eventConfig&&0===this.__eventConfig.length)if(e){var t=this;e.cleanUp(function(){t.__finalizeSync()})}else this.__finalizeSync();else this.__triggerNextEventCollection()}},{key:"__finalizeSync",value:function(){function e(e,i,a){i&&t.getSyncImpl().refreshSyncSettingValues(function(){t.getSyncImpl().resetScheduledSyncTimes()},i);var r=null;if(e&&(r={mapRecordIds:t.getState("MAP_REMOTE_IDS")}),t.__dispatchFinalSyncEvents(r),t.__stopped=!1,a)if(t.isInitialSync(n)){var o=new x;t.__deleteSFAttachments(o,function(){o._downloadAttachmentsOptimized(function(){t.startAttachmentSync({syncType:n})})})}else t.startAttachmentSync({syncType:n});t.__syncEventCol=null,t.__syncType=null,t.enableDisableAutoLock(!1)}var t=this,n=this.getSyncType(),i=t.getState("USER_INFO");if(i&&t.setUserInfo(i),t.isInitialSync(n)||t.isDataPurge(n)||t.isDataSync(n))t.__finalizeDataSync(function(){t.isInitialSync(n)?e(!0,!0,!0):e(!0,!1,!0)});else switch(n){case"INSERT_LOCAL_RECORDS":e(!0,!1,!1);break;case"CONFIG":t.__runSyncExtensions(function(){e(!1,!0,!1)});break;case"PREINITIAL":case"LOCATION":e(!1,!1,!1)}}},{key:"__deleteSFAttachments",value:function(e,t){e._initSQLServiceRequest({query:"DELETE FROM SFAttachments "},{handler:function(e){t.call()}})}},{key:"__finalizeDataSync",value:function(e){for(var t=["LAST_SYNC_TIME","LAST_SYNC_TIME_DELETE","LAST_SYNC_TIME_INSERT","LAST_SYNC_TIME_UPDATE","LastDataSyncTime"],n=b,i=0,a=t.length;i<a;i++){var r=t[i],o=this.getState(r);o&&n.writeToDBCache(r,o)}this.__showSyncErrors(),this.__runSyncExtensions(e)}},{key:"__runSyncExtensions",value:function(e){C.run(this,"com.servicemax.client.sync.extensions").then(e)}},{key:"__encryptOrDecrypt",value:function(){var e=T,t=e.createEncryptDecryptRequest();t.bind("REQUEST_COMPLETED",function(e){if(this.__logger.info(this.__syncType),e.data.success){var t=g.toObject(e.data.data),n=t.restartApp;console.log("Success"),n&&(this.__restartRequired=!0,this.__performRestartOfApp())}else console.log("Failure")},this),t.bind("REQUEST_ERROR",function(e){console.log("Failed to execute the request")},this),t.execute()}},{key:"__performRestartOfApp",value:function(){var e=T,t=e.createAppRestartRequest();if(t.bind("REQUEST_COMPLETED",function(e){if(e.data.success){g.toObject(e.data.data)}else console.log("Failure")},this),t.bind("REQUEST_ERROR",function(e){console.log("Failed to execute the request")},this),!g.getCurrentApplication().checkForMessageId("appRestartWindow")){var n=function(){return g.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};g.getCurrentApplication().showMessage({type:"WARN",title:n().T("FSA010_TAG121","Application Settings Update"),text:n().T("FSA010_TAG122","Application Will Restart In Order to Apply the New Configuration Settings"),buttons:[{text:n().T("FSA016_TAG003","OK"),itemId:"OK",handler:function(e){t.execute()}}],itemId:"appRestartWindow"})}}},{key:"__finalizeAttachmentSync",value:function(e){e&&this.__showSyncErrors(!0),this.__triggerNextSyncInQueue()}},{key:"__triggerEncryptDecryptCheck",value:function(e){if("SyncAttachmentsInitial"==e){var t={status:!0,type:"INITIAL_ATTACHMENT_SYNC"};this.__performDBUpdateOnConfigSyncSuccess(t)}this.__pausedAttachmentSyncType=null}},{key:"__getErrorManagerImpl",value:function(){if(!this.__errorManagerImpl){var e=g.getClient().getDeclaration("com.servicemax.client.sync.errormgmt"),t=g.getClient().getDefinitionsFor(e);if(0===t.length)return void this.__logger.error("Unable to load error manager");var n=t[0].config.impl["class-name"];this.__errorManagerImpl=g.create(n,this)}return this.__errorManagerImpl}},{key:"__showSyncErrors",value:function(e){this.__getSyncConflicts(function(t){if(t)for(var n=0;n<t.length;n++)if(e&&t[n].parent_id||!e&&!t[n].parent_id)return this.__getErrorManagerImpl(),void(this.__errorManagerImpl&&this.__errorManagerImpl.showErrorUI())})}},{key:"__dispatchFinalSyncEvents",value:function(e){var t=this,n=new Date-this.__syncStart,i=this.__syncType,a=this.__syncType,r="Stopped",o="SYNC_STATUS."+i;this.isDataSync(i)&&(i="DATA",o="SYNC_STATUS.DATA"),this.__syncFinished=!0;var s=!0,l=this;try{this.nrParams={};var c=b.readFromJSCache("newrelic","nr_org_id"),u=g.getClient().getApplicationParameter("client-uuid");if(this.getState("FAILED"))this.__logger.info("Sync failed in "+n+" ms total"),this.dispatchEvent("SYNC_FAILED",{syncType:i,errorMessage:this.getState("ERROR_MESSAGE"),allFailures:this.getState("HTTP_FAILURES")||[],usageLogging:this.getState("USAGE_LOGGING_ENABLED"),toolsServerURL:this.getState("TOOLS_SERVER_URL")}),r="Failed","TARGETEDSYNC"!==a&&this.setState(o,r),s=!1,this.nrParams={type:"NEWRELICCUSTOMEVT",parameters:{fsaEventType:"MobileSync",syncId:this.__requestId,syncType:i,syncTypeStatus:r,timeSpent:n,orgId:c,uniqueClientId:u}};else{var d=this.getState("RECORD_COUNTS_TOTAL")||0;this.__logger.info("Sync downloaded "+d+" records total"),this.__logger.info("Sync completed in "+n+" ms total"),this.dispatchEvent("SYNC_COMPLETED",{syncType:i,syncData:e,usageLogging:this.getState("USAGE_LOGGING_ENABLED"),toolsServerURL:this.getState("TOOLS_SERVER_URL")}),r="Success","TARGETEDSYNC"!==a&&this.setState(o,r),this.nrParams={type:"NEWRELICCUSTOMEVT",parameters:{fsaEventType:"MobileSync",syncId:this.__requestId,syncType:i,syncTypeStatus:r,timeSpent:n,orgId:c,uniqueClientId:u,recordCount:d}}}if(window.external.getOauthCredentials?window.external.getOauthCredentials().analytics:void 0!==window.newrelic)if(c&&c.length>0){var _=T.createNewRelicCustomEvtRequest();_.execute(this.nrParams)}else{var h=b.readFromDBCache("USER_INFO");h.done(g.proxy(this,function(e){var n=g.toObject(e);if(n&&n.OrgId){b.writeToJSCache("newrelic","nr_org_id",n.OrgId),t.nrParams.parameters.orgId=n.OrgId;T.createNewRelicCustomEvtRequest().execute(t.nrParams)}}))}if(i&&"TARGETEDSYNC"!=a){b.writeToDBCache(o,r,this.__updateFailedRequestsToCache({status:s}),l);var f=I.getTimestampWithSaveFormat();a&&"TARGETEDSYNC"!==a&&b.writeToDBCache("LAST_SYNC_TIME."+i,f),"CONFIG"==i&&"Success"==r&&b.writeToDBCache("LAST_SYNC_TIME.CONFIG_SUCCESS",f)}else this.dispatchEvent("SYNC_STOPPED",{syncType:i})}catch(e){this.__logger.error("Error in __finalizeSync event handler: "+e)}}},{key:"__updateFailedRequestsToCache",value:function(e){if(this.__enableLogging){var t=!1;this.getState("FAILED")?g.array.contains(this.__lastFailedRequestIds,function(e){return this.__requestId===e})||(-1===this.__lastFailedRequestIds.indexOf(this.__requestId)&&this.__lastFailedRequestIds.push(this.__requestId),t=!0):this.__lastFailedRequestIds.length>0&&(this.__lastFailedRequestIds=[],t=!0),t?t&&(this.__lastFailedRequestIds&&0!==this.__lastFailedRequestIds.length||(this.__lastFailedRequestIds=""),b.writeObjectToDBCache("LAST_FAILED_REQUEST_IDS",this.__lastFailedRequestIds,this.__performDBUpdateOnConfigSyncSuccess(e),this)):this.__performDBUpdateOnConfigSyncSuccess(e)}else this.__performDBUpdateOnConfigSyncSuccess(e)}},{key:"__performDBUpdateOnConfigSyncSuccess",value:function(e){"laptop"===g.getClient().getApplicationParameter("client-type").toLowerCase()?("CONFIG"!=this.__syncType&&"INITIAL_ATTACHMENT_SYNC"!=e.type||!e.status||this.__encryptOrDecrypt(),this.dispatchEvent("SYNC_STOPPED",{syncType:this.__syncType})):this.dispatchEvent("SYNC_STOPPED",{syncType:this.__syncType})}},{key:"__getSyncConflicts",value:function(e){var t=T,n=t.createSQLRequest();n.bind("REQUEST_COMPLETED",function(t){var n=g.toObject(t.data.data);e.call(this,n)},this),n.bind("REQUEST_ERROR",function(e){g.getLoggingService().getLogger(e.data)},this),n.execute({query:"SELECT * FROM ClientSyncConflict",async:!0})}}]),t}(y),g.defineGlobal(R.name,R),e.exports=R},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m=n(11).Facade,v={name:"com.servicemax.client.sync.integration"};v.IntegrationService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=f.getLoggingService().getLogger("INTEGRATION-API"),e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"notifyNewRecords",value:function(e,t){if(t&&t.length>0){var n=t[0];if("Event"==e){var i={};i.type="event";var a=n.What.Name;i.woStartDateTime=n.StartDateTime,i.woReminderDateTime=n.ReminderDateTime,i.woEndDateTime=n.EndDateTime,i.woSummary=n.Subject,SVMXGlassInterface.notifyNewWorkOrder(a,i)}else if("SVMXC__Service_Order__c"==e){var i={};i.type="workorder";var a=n.Name;i.woType=n.SVMXC__Order_Type__c,i.woStatus=n.SVMXC__Order_Type__c;var r=n.SVMXC__Contact__c;this.__executeQuery("SELECT Id,LastName,FirstName,Title,Phone,MobilePhone,HomePhone,OtherPhone,AssistantPhone,Email FROM Contact WHERE Id='"+r+"'",function(e){if(e&&e.length>0){var t=e[0],n={};n.type="contact",n.woContactFirstName=t.FirstName,n.woContactLastName=t.LastName,n.woContactTitle=t.Title,n.woContactEmail=t.Email,""!=t.Phone?n.woContactPhone=t.Phone:""!=t.MobilePhone?n.woContactPhone=t.MobilePhone:""!=t.HomePhone?n.woContactPhone=t.HomePhone:""!=t.OtherPhone?n.woContactPhone=t.OtherPhone:""!=t.AssistantPhone?n.woContactPhone=t.AssistantPhone:n.woContactPhone="No phone number provided",SVMXGlassInterface.notifyNewWorkOrder(a,n)}}),i.woProduct=n.SVMXC__Product__r.Name,i.woDescription=n.SVMXC__Problem_Description__c,i.woCompany=n.SVMXC__Company__r.Name,i.woStreet=n.SVMXC__Street__c,i.woCity=n.SVMXC__City__c,i.woState=n.SVMXC__State__c,i.woCountry=n.SVMXC__Country__c,i.woPostalCode=n.SVMXC__Zip__c,this.__logger.info("Notifying new workorder!"),SVMXGlassInterface.notifyNewWorkOrder(a,i)}}}},{key:"__executeQuery",value:function(e,t){var n=m,i=n.createSQLRequest();i.bind("REQUEST_COMPLETED",function(e){t(f.toObject(e.data.data))},this),i.bind("REQUEST_ERROR",function(e){t(!1)},this),i.execute({query:e,async:!0})}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){var i=n(721),a=n(722);n(0).utils;e.exports={impl:i,client:a}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.native.laptop.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){window.newrelic&&e.fsaEventType&&(window.newRelicJson&&"object"===(0,u.default)(window.newRelicJson)&&(0,o.default)(e,window.newRelicJson),window.newrelic.addPageAction(e.fsaEventType,e))}var r=n(30),o=i(r),s=n(31),l=i(s),c=n(18),u=i(c),d=n(1),_=i(d),h=n(2),f=i(h),p=n(6),m=i(p),v=n(3),g=i(v),y=n(4),S=i(y),E=n(10),b=n(0).utils,T=n(11).AbstractClient,M=n(11).AbstractClient.TRACE,I=(n(7).Cache,{name:"com.servicemax.client.nativeservice"}),C={},A=0,D={},x={};if(window.showSQL=!1,I.Client=function(e){function t(){return(0,f.default)(this,t),(0,g.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments))}return(0,S.default)(t,e),(0,m.default)(t,null,[{key:"execute",value:function(e){if(b.TEST)return console.log("Skipping "+e.type+" call in testing mode"),e.callback.handler.call(e.callback.context,{success:!0}),!0;var t="id"+ ++A,n=new Object,i=void 0,r=void 0;switch(e.type){case"DOWNLOAD":i="HTTP",e.operation="DOWNLOAD",n.SourceObject=e.parameters.sourceObject,n.RecordId=e.parameters.recordId,n.FileName=e.parameters.file,n.FieldName=e.parameters.fieldName,n.IsTroubleshootDocumentDownload=e.parameters.isTroubleshootDocumentDownload||!1;break;case"UPLOAD":i="HTTP",e.operation="UPLOAD",n.ParentId=e.parameters.parentId,n.FilePath=e.parameters.file,n.FileName=e.parameters.name,n.ObjectName=e.parameters.objectName,n.ContentVersionId=e.parameters.contentVersionId;break;case"HTTP":i="HTTP",e.operation,n.Uri=e.parameters.url,n.allowPost=e.parameters.allowPost,n.isNonSalesforceUrl=!!e.parameters.isNonSalesforceUrl&&e.parameters.isNonSalesforceUrl,"object"===(0,u.default)(e.parameters.data)?n.RequestBody=b.toJSON(e.parameters.data):n.RequestBody=e.parameters.data,n.RequestMethod=e.parameters.method,x={};var o=new Array,s=0;if(E.isArray(e.parameters.headers))o=E.merge(o,e.parameters.headers);else for(var c in e.parameters.headers)o[s]=new Object,o[s].Header=c,o[s].Value=e.parameters.headers[c],++s;n.HttpRequestHeaders=b.toJSON(o);break;case"SQL":i="SQL",n.SQL=e.parameters.query,n.SQLArray=e.parameters.queryArray,n.RollBack=e.parameters.doRollBack,window.showSQL&&console.warn(n.SQL);break;case"PRINTHTMLCONTENT":i="PRINTHTMLCONTENT",e.operation="PRINTHTMLCONTENT",n.parameters=e.parameters;break;case"NEWRELICCUSTOMEVT":if(i="NEWRELICCUSTOMEVT",e.operation="NEWRELICCUSTOMEVT",n.parameters=e.parameters,"laptop"===b.getClient().getApplicationParameter("device-info")["client-type"])return void a(e.parameters);break;case"FORCEORIENTATION":i="FORCEORIENTATION",e.operation="FORCEORIENTATION",n.parameters=e.parameters;break;case"TRACE":i="LOG",e.operation="TRACE",n.Message=e.parameters.message;break;case"REPORT":i="GENERATEREPORT",e.operation="DEFAULT",n.RecordId=e.parameters.recId,n.TemplateName=e.parameters.processId;break;case"LOG":i="LOG",e.operation="LOG";break;case"CONNECTIVITY":i="CHECKCONNECTIVITY",n.delay=e.parameters.delay;break;case"LOGININFO":i="MISC",e.operation="LOGININFO";break;case"SIGNOUT":i="MISC",e.operation="SIGNOUT";break;case"EXIT":i="MISC",e.operation="EXIT";break;case"SMS":i="MISC",e.operation="SMS",n.phone=e.parameters.phone,n.message=e.parameters.message;break;case"EMAIL":i="MISC",e.operation="EMAIL",n.address=e.parameters.address,n.subject=e.parameters.subject,n.message=e.parameters.message,n.attachmentFiles=e.parameters.attachmentFiles;break;case"SHARE":i="MISC",e.operation="SHARE",n.files=e.parameters.files;break;case"TEL":i="MISC",e.operation="TEL",n.phone=e.parameters.phone;break;case"GEO":i="MISC",e.operation="GEO",n.street=e.parameters.street,n.city=e.parameters.city,n.state=e.parameters.state,n.country=e.parameters.country,n.zipcode=e.parameters.zipcode,n.latitude=e.parameters.latitude,n.longitude=e.parameters.longitude;break;case"SCAN":i="MISC",e.operation="SCAN",n.paraCallback=e.callback;break;case"OPENEXTERNALAPP":i="MISC",e.operation="OpenExternalApp",n.paraCallback=e.callback,n.url=e.parameters.url,n.param=e.parameters.param;break;case"BROWSER":i="MISC",e.operation="BROWSER",n.link=e.parameters.link;break;case"CAPTUREPHOTO":i="MISC",n.mode=e.parameters.mode,n.duration=e.parameters.duration,e.parameters.imageCompression&&(n.imageCompression=e.parameters.imageCompression),e.operation="CapturePhoto";break;case"FILE":switch(i="FILEIO",e.parameters.operation.toUpperCase()){case"READ":e.operation="READTEXTFILE",n.FileName=e.parameters.file;break;case"READBASE64":e.operation="READBASE64FILE",n.FileName=e.parameters.file;break;case"WRITE":e.operation="WRITE",n.WriteContent=e.parameters.data,n.FileName=e.parameters.file,n.isBase64Encoded=e.parameters.isBase64Encoded,n.isSmartDoc=e.parameters.isSmartDoc;break;case"APPEND":e.operation="WRITELINE",n.WriteContent=e.parameters.data,n.FileName=e.parameters.file;break;case"COPY":e.operation="COPYFILE",n.FilePath=e.parameters.file,n.TargetFileName=e.parameters.targetFile,n.DestinationPath=e.parameters.targetPath;break;case"DELETE":e.operation="DELETEFILE",n.FilePath=e.parameters.file;break;case"RENAME":e.operation="RENAMEFILE",n.FilePath=e.parameters.file,n.TargetFileName=e.parameters.targetFileName;break;case"EXECUTE":e.operation="OPENFILE",n.FilePath=e.parameters.file;break;case"INFO":e.operation="FILEINFO",n.FilePath=e.parameters.file;break;case"SELECT":e.operation="BROWSEANDCOPYFILE",n.MultiSelect=e.parameters.multiSelect,n.DestinationPath=e.parameters.targetPath,e.parameters.imageCompression&&(n.imageCompression=e.parameters.imageCompression);break;case"LIST":e.operation="LISTFILES",n.FilePath=e.parameters.file;break;case"READOPENFILE":e.operation="READOPENFILE",n.FilePath=e.parameters.file;break;case"QUEUEUSAGEDATA":e.operation="QUEUEUSAGEDATA",n.WriteContent=e.parameters.data,n.FilePath=e.parameters.file;break;case"CLEARSHAREDFILE":e.operation="CLEARSHAREDFILE",n.FilePath=e.parameters.file}break;case"INSTALLATIONS":i="MISC",e.operation="GETDOWNLOADFOLDERPATH";break;case"SIGNATURECAPTURE":i="SIGNATURECAPTURE",e.operation="DEFAULT",n.recordId=e.parameters.recordId,n.processId=e.parameters.processId,n.uniqueName=e.parameters.uniqueName;break;case"SIGNATUREDEVICECHECK":i="MISC",e.operation="SIGNATUREDEVICECHECK";break;case"GENERATEPDF":i="MISC",e.operation="GENERATEPDF",n.recordId=e.parameters.recordId,n.processId=e.parameters.processId,n.sourceRecord=e.parameters.sourceRecord,n.htmlContent=e.parameters.htmlContent,n.pdfName=e.parameters.pdfName||"";break;case"CHECKEXTERNAL":i="EXTERNALAPP",e.operation="APPINFO",n.AppName=e.parameters.AppName;break;case"SENDEXTERNAL":i="EXTERNALAPP",e.operation="SENDMESSAGE",n.AppName=e.parameters.AppName,n.externalRequest=e.parameters.externalRequest;break;case"SETEXTERNALHANDLER":i="SETMESSAGEHANDLER",e.operation="SETMESSAGEHANDLER",n.handler=e.parameters.handler;break;case"DATAACCESSAPI":i="DATAACCESSAPI",e.operation=e.method,n.objectName=e.parameters.objectName,n.fields=e.parameters.fields,n.criteria=e.parameters.criteria,n.userName=e.parameters.userName,n.records=e.parameters.records,n.query=e.parameters.query,n.handler=e.parameters.handler,n.recordIds=e.parameters.recordIds;break;case"APPLICATIONFOCUS":i="APPLICATIONFOCUS",e.operation="APPLICATIONFOCUS";break;case"LOCATION_TRACKING":i="LOCATION_TRACKING";break;case"LOCALEFORMAT":i="MISC",e.operation="LOCALEFORMAT";break;case"CLIENT_INFO":i="MISC",e.operation="CLIENT_INFO";break;case"GETSETTINGVALUE":i="MISC",e.operation="GETSETTINGVALUE",n.settingName=e.parameters.settingName;break;case"DEVICEINFO":i="MISC",e.operation="DEVICEINFO";break;case"ENCRYPT_OR_DECRYPT":i="ENCRYPT_OR_DECRYPT";break;case"APP_RESTART":i="APP_RESTART";break;case"GENERATEAPIKEY":i="MISC",e.operation="GENERATEAPIKEY",n.link=e.parameters.link;break;case"DISABLEAUTOLOCK":i="SYSTEM_UTILITY",e.operation="DISABLEAUTOLOCK";break;case"ENABLEAUTOLOCK":i="SYSTEM_UTILITY",e.operation="ENABLEAUTOLOCK";break;case"SETSSLCERTIFICATEPINNING":i="MISC",e.operation="SETSSLCERTIFICATEPINNING",n.value=e.parameters.value;break;case"TCPREQUEST":i="TCPREQUEST",n.data=e.parameters,e.operation=e.parameters.operation;break;default:throw"Type not supported."}if(e.operation)switch(e.operation){case"":r="default";break;default:r=e.operation}else r="default";C[t]=e.callback;var d=new Object;d.MethodName=r,d.Type=i,d.RequestId=t,d.IsAsync=e.parameters.async;var _=new Date;d.OriginateTime=_.getTime(),e.parameters.async?d.IsAsync=e.parameters.async:d.IsAsync=!1,d.jsCallback="nativeCallback",d.ParameterString=b.toJSON(n),d.TotalPages=1,d.CurrentPage=1;var h=d.ParameterString,f=null;if(d.ParameterString.length>1e5){var p=Math.ceil(d.ParameterString.length/1e5);d.TotalPages=p;var m=0;for(m=0;m<p;m++)d.CurrentPage=m+1,d.ParameterString=h.substr(1e5*m,1e5),f=window.external.execute((0,l.default)(d))}else f=window.external.execute((0,l.default)(d));return f}},{key:"nativeCallback",value:function(e){e=b.toObject(e);var t=e.RequestId,n=C[t],i=new Object;i.RequestId=e.RequestId,i.Type="LOG",i.MethodName="LOG",i.IsAsync="true",i.TotalPages="1";var a=new Object;a.LogLevel="DEBUG",a.Source="JS",a.CorrelationId=e.RequestId,a.Message="Response received in JS callback with response status: "+e.Status+" for Page: "+e.CurrentPage+" of Total Pages: "+e.TotalPages,i.ParameterString=b.toJSON(a),window.external.execute(b.toJSON(i));var r=void 0,o=e.CurrentPage,s=e.TotalPages;if(o!=s)return r=t+"."+o,D[r]=e.Result,1;r=t+"."+o,D[r]=e.Result;var l=1,c="";for(l=1;l<s+1;l++)c+=D[t+"."+l],delete D[t+"."+l];if(e.Result=c,o==s){var u=e.Result,d=new Object,_=void 0;switch(d.success=e.Status,e.Type){case"HTTP":if(e.MethodName,d.headers=new Object,!1!==e.Status&&"DOWNLOAD"!=e.MethodName){u=b.toObject(u),_=b.toObject(u.ResponseHeaders);for(var h in _)d.headers[_[h].Header]=_[h].Value;if(d.data=u.ResponseBody,d.status=u.StatusCode,x[e.RequestId]){var f=x[e.RequestId].uri,p=-1==f.indexOf("/describe",f.length-"/describe".length),m=-1==f.indexOf("/Soap/");p&&m&&(x[e.RequestId].res=d.data),m&&(x[e.RequestId].req&&(x[e.RequestId].req=b.toObject(x[e.RequestId].req)),x[e.RequestId].res&&(x[e.RequestId].res=b.toObject(x[e.RequestId].res))),m||(x[e.RequestId].res="SOAP",x[e.RequestId].req="SOAP")}}else d.data=u;"UPLOAD"==e.MethodName&&(d.data=b.toObject(d.data));break;case"SQL":d.data=u||[],d.success=e.Status;break;case"GENERATEREPORT":case"SIGNATURECAPTURE":d.fileLocation=u||[],d.success=e.Status;break;case"SIGNATUREDEVICECHECK":case"CHECKCONNECTIVITY":d.data=e.Result,d.success=e.Status;break;case"MISC":"GENERATEAPIKEY"==e.MethodName?(d.data=e.Result,d.success=e.Status):"SIGNATUREDEVICECHECK"===e.MethodName?(d.data=e.Result,d.success=e.Status):"DEVICEINFO"===e.MethodName?(u=b.toObject(u),d.data=u&&u[0],d.success=e.Status,d.data&&d.data["barcode-enabled"]&&"string"==typeof d.data["barcode-enabled"]&&(d.data["barcode-enabled"]="true"==d.data["barcode-enabled"].toLowerCase())):"BROWSER"===e.MethodName?(d.data=e.Result,d.success=e.Status):"CapturePhoto"===e.MethodName?(d.data=e.Result,d.success=e.Status):"GENERATEPDF"===e.MethodName&&e.Device?(d.data=e.Result,d.success=e.Status,d.device=e.Device||""):(u=b.toObject(u),d.data=u&&u[0],d.success=e.Status);break;case"FILEIO":switch(e.MethodName){case"BROWSEANDCOPYFILE":d.data=b.toObject(e.Result);break;case"FILEINFO":var v=e.Result.replace(/\\/g,"/");d.data=b.toObject(v);break;default:d.data=e.Result}d.success=e.Status;break;case"DEVICEINFO":d.data=e.Result,console.warn("RICHARD",d.data),d.success=e.Status;break;case"DATAACCESSAPI":case"EXTERNALAPP":case"SETMESSAGEHANDLER":case"LOCATION_TRACKING":d.data=e.Result,d.success=e.Status,d.permission=e.Permission;break;case"ENCRYPT_OR_DECRYPT":case"APP_RESTART":d.data=e.Result,d.success=e.Status;break;case"SYSTEM_UTILITY":switch(e.MethodName){case"DISABLEAUTOLOCK":case"ENABLEAUTOLOCK":d.data=e.Result,d.success=e.Status}break;case"TCPREQUEST":d.data=e.Result,d.success=e.Status;break;default:console.warn("Invalid response.Type "+e.Type)}try{n&&n.handler.call(n.context,d)}catch(e){console.error(e.stack?e.stack:e)}delete C[t]}}}]),t}(T),window.nativeCallback=function(e){I.Client.nativeCallback(e)},b._debugDiv){var R=b._debugDiv.innerHTML.split(/\<BR\/?\>/i);b.array.forEach(R,function(e){I.execute({type:M,parameters:{message:e},callback:{handler:function(e){},context:{}}})}),document.body.removeChild(b._debugDiv),delete b._debugDiv}n(11).Facade.__nativeService=I,b.defineGlobal(I.name,I),e.exports=I},function(e,t,n){var i=n(724);n(0).utils;e.exports={impl:i}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),u=i(l),d=n(3),_=i(d),h=n(4),f=i(h),p=n(98),m=i(p),v=n(18),g=i(v),y=n(0).utils,S=n(5).ModuleActivator,E=n(5).SVMXObject,b={name:"com.servicemax.client.ui.ext6modernloader.impl"};b.onExtReady=function(){Ext.enableGarbageCollector=!0,Ext.Base.addMembers({toString:function(e){var t=this.$className?this.$className.replace(/^com\.servicemax\.client\./,"client."):"unknown";return e=e?" "+e:"",t+" (Ext"+e+")"},getClassName:function(){return this.$className},__base:function(e){var t=this.__base.caller;if(t)if("constructor"===t.$name)var n,i=(n=this.__base.caller)&&(n.$previous||(n=n.$owner?n:n.caller)&&n.$owner.superclass[n.$name]);else var i=t.$previous||(t=t.$owner?t:t.caller)&&t.$owner.superclass.self[t.$name];if(i)return i.apply(this,e||c)}});var e=function(){var e=this,t=e.id,n=void 0,i=void 0,a=void 0,r=void 0,o=void 0;if(!t){if(n=e.self.prototype,i=e.defaultIdSeparator,r=Ext.mixin.Identifiable.uniqueIds,!n.hasOwnProperty("identifiablePrefix")){if(a=e.xtype)o=e.defaultIdPrefix+a+i;else{o=n.$className.replace(e.idCleanRegex,i).toLowerCase()+i}n.identifiablePrefix=o}o=e.identifiablePrefix,r.hasOwnProperty(o)||(r[o]=0);t=o+ ++r[o];var s=/\./g;t=e.id=t.replace(s,"-")}return e.getUniqueId=e.getOptimizedId,t};Ext.Component.addMembers({getUniqueId:e}),Ext.mixin.Identifiable.prototype.getUniqueId=e,Ext.env.Browser.prototype.getPreferredTranslationMethod=function(e){return"object"===(void 0===e?"undefined":(0,g.default)(e))&&"translationMethod"in e&&e.translationMethod&&"auto"!==e.translationMethod?e.translationMethod:this.is.AndroidStock2||this.is.IE?"scrollposition":"csstransform"},Ext.define("SVMX.Ext.util.SorterCollection",{override:"Ext.util.SorterCollection",addSort:function(e,t,n){var i=this,a=void 0,r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0;e?(s=i.getOptions(),e instanceof Array?(u=e,n=t,t=null):Ext.isString(e)?u=(c=i.get(e))?[c]:[{property:e,direction:t||s.getDefaultSortDirection()}]:Ext.isFunction(e)?u=[{sorterFn:e,direction:t||s.getDefaultSortDirection()}]:(Ext.isObject(e)||Ext.raise("Invalid sort descriptor: "+e),u=[e],n=t,t=null),n&&!i._sortModes[n]&&Ext.raise('Sort mode should be "multi", "append", "prepend" or "replace", not "'+n+'"'),n=i._sortModes[n||"replace"],l=i.getAt(0),a=i.length,r=n.append?a:0,i.beginUpdate(),i.splice(r,n.replace?a:0,u),n.multi&&(a=i.length,o=s.getMultiSortLimit(),a>o&&i.removeAt(o,a)),c&&t?c.setDirection(t):0===r&&l&&l===i.getAt(0)&&l.toggle(),i.endUpdate()):(i.beginUpdate(),i.endUpdate())}}),Ext.override(Ext.dataview.List,{updateHeaderMap:function(){var e=this,t=e.headerMap,n=e.headerIndices,i=void 0,a=void 0;t.length=0;for(a in n)if(n.hasOwnProperty(a)){var r=e.getItemAt(a);if(!r)continue;i=r.getHeader(),t.push(i.renderElement.dom.offsetTop)}}}),Ext.override(Ext.grid.HeaderContainer,{privates:{doUpdateSpacer:function(){var e=this.getGrid().getScrollable();e&&this.element.setStyle("padding-right",e.getScrollbarSize().width+"px")}}}),Ext.override(Ext.field.Input,{getTemplate:function(){var e=this,t=[],n=e.beforeTemplate,i=e.afterTemplate;return n&&t.push.apply(t,(0,m.default)(n)),t.push({reference:"inputBodyElement",cls:Ext.baseCSSPrefix+"input-body-el",children:[{reference:"inputElement",tag:this.tag,cls:Ext.baseCSSPrefix+"input-el"},{reference:"maskElement",classList:[Ext.baseCSSPrefix+"mask-el",Ext.baseCSSPrefix+"hidden-display"]},{reference:"barcodeIcon",hidden:!0},{reference:"searchIcon",hidden:!0,classList:["icon-Magnify-Glass-Gray","textfield-search-icon"]}]}),i&&t.push.apply(t,(0,m.default)(i)),t},doDestroy:function(){this.barcodeIcon&&this.barcodeIcon.destroy(),this.searchIcon&&this.searchIcon.destroy(),this.maskElement&&this.maskElement.destroy(),this.inputElement&&this.inputElement.destroy(),this.inputBodyElement&&this.inputBodyElement.destroy(),this.callParent()}}),Ext.override(Ext.field.Text,{applyMaxLength:function(e){if(void 0!==e){if(null!==e&&"number"!=typeof e)throw new Error("Ext.field.Text: [applyMaxLength] trying to pass a value which is not a number");return e}}}),Ext.override(Ext.viewport.Default,{hideMenu:function(e,t){var n=this,i=this.getMenus(),a=i[e],r=void 0,o=void 0,s=void 0;t=!1!==t,!a||a.isHidden()||a.isAnimating||(r={translateX:0,translateY:0},o={translateX:0,translateY:0},a.element&&(s="left"==e||"right"==e?a.element.getWidth():a.element.getHeight(),"left"==e?r.translateX=-s:"right"==e?r.translateX=s:"top"==e?r.translateY=-s:"bottom"==e&&(r.translateY=s),a.$cover?t?(a.getTranslatable().on("animationend",function(){a.isAnimating=!1,a.hide()},n,{single:!0}),a.translate(r.translateX,r.translateY,{preserveEndState:!0,duration:200})):(a.translate(r.translateX,r.translateY),a.hide()):t?(n.getTranslatable().on("animationend",function(){a.isAnimating=!1,a.hide()},n,{single:!0}),n.translate(o.translateX,o.translateY,{preserveEndState:!0,duration:200})):(n.translate(o.translateX,o.translateY),a.hide())))},onEdgeSwipeEnd:function(e){var t=this,n=t.sideForDirection(e.direction),i=t.getMenus()[n],a=!1,r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0;i&&i.element&&(r="left"==n||"right"==n?i.element.getWidth():i.element.getHeight(),o=e.flick?e.flick.velocity:0,"right"==n?o.x>0&&(a=!0):"left"==n?o.x<0&&(a=!0):"top"==n?o.y<0&&(a=!0):"bottom"==n&&o.y>0&&(a=!0),s=a?r:0,l=a?0:-r,c={translateX:0,translateY:0},u={translateX:0,translateY:0},"left"==n?(c.translateX=-s,u.translateX=-l):"right"==n?(c.translateX=s,u.translateX=l):"top"==n?(c.translateY=-s,u.translateY=-l):"bottom"==n&&(c.translateY=s,u.translateY=l),i.$cover?(i.getTranslatable().on("animationend",function(){a&&i.hide()},t,{single:!0}),i.translate(c.translateX,c.translateY,{preserveEndState:!0,duration:200})):(t.getTranslatable().on("animationend",function(){a&&i.hide()},t,{single:!0}),t.translate(u.translateX,u.translateY,{preserveEndState:!0,duration:200})),t.$swiping=!1)}})},Ext.onReady(b.onExtReady),b.Module=function(e){function t(){(0,s.default)(this,t);var e=(0,_.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return b.Module.instance=e,y.getClient().bind("GLOBAL.HANDLE_USER_INFO",function(e){var t={zh_CN:"lang/ext-lang-zh_CN.js",zh_TW:"lang/ext-lang-zh_TW.js",de:"lang/ext-lang-de.js",nl_NL:"lang/ext-lang-nl_NL.js",pt_BR:"lang/ext-lang-pt_BR.js",fr:"lang/ext-lang-fr.js",ja:"lang/ext-lang-ja.js",es:"lang/ext-lang-es.js",it:"lang/ext-lang-it.js",ko:"lang/ext-lang-ko.js"},n=e.data,i=n.Language;if(t[i]){var a=this.getModule().getResourceUrl(t[i]);y.requireScript(a,function(){},null,this,{ignoreLoadVersion:!0})}},e),e}return(0,f.default)(t,e),(0,u.default)(t,[{key:"beforeInitialize",value:function(){var e=y.create(b.name+".ExtUIElementsCreationHelper");y.registerCreateHelper(e),Ext.onReady(b.onExtReady)}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(S),b.Module.instance=null,b.ExtUIElementsCreationHelper=function(e){function t(){return(0,s.default)(this,t),(0,_.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,u.default)(t,[{key:"__getClassName",value:function(e){var t=Ext.ClassManager;return t.classes[e]?e:t.getNameByAlias("widget."+e)?t.getNameByAlias("widget."+e):void 0}},{key:"canCreate",value:function(e){return Boolean(this.__getClassName(e))}},{key:"doCreate",value:function(e,t){var n=Ext.create(this.__getClassName(e),t);return n.__self=Ext.ClassManager.getClass(n),n}}]),t}(E),y.defineGlobal(b.name,b),e.exports=b},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(5).ModuleActivator,n(19).svmxbasebutton,n(19).impl,n(19).signature,n(19).form,n(5).SVMXObject),m={name:"com.servicemax.client.ui.components.modern.impl"};Ext.onReady(function(){Ext.application({startupImage:{"320x460":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png","640x920":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png","640x1096":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png","768x1004":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png","748x1024":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png","1536x2008":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png","1496x2048":"lib/com.servicemax.client.lib/resources/images/servicemax_logo_sm.png"},name:"ServiceMax FSA",icon:"lib/com.servicemax.client.lib/resources/images/servicemax_icon.png",viewport:{layout:"fit"},launch:function(){}})}),m.TranslationService=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getDictionary",value:function(e){return{T:function(e,t){return t}}}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(6),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).SVMXObject,m={name:"com.servicemax.client.ui.components.modern.notifications"},v=f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA");m.NotificationManager=function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__lastTarget=null,e}return(0,h.default)(t,e),(0,d.default)(t,[{key:"quickMessage",value:function(e,t,n){f.Msg.toast({text:e,duration:t,messageType:n})}},{key:"errorMessage",value:function(e,t){if(e){var n=e.message;n instanceof Array||(n=[{message:n,msgDetail:e.msgDetail}]);var i=n[0].message,a={text:i};t&&(a.title=t),f.Msg.alert(a)}}},{key:"showMessage",value:function(e){e&&("string"==typeof e&&(e={message:e}),f.Msg.alert(e))}},{key:"checkForMessageId",value:function(e){return!!(e&&Ext.ComponentQuery.query("#"+e).length>0)}},{key:"waitingMessage",value:function(e,t){this.__lastTarget&&this.endWaitingMessage(this.__lastTarget);var n=t||{xtype:"svmx.loadmask",message:v.T("FSA016_TAG007","Loading...")};n&&n.html&&window.matchMedia("(orientation: portrait)").matches&&n.html.indexOf(".field-component-cell-right {display: table-cell;")>0&&(n.html=n.html.replace(".field-component-cell-right {display: table-cell;",".field-component-cell-right {display: none;")),e&&e.setMasked?(n.transparent=void 0===n.transparent||null===n.transparent||n.transparent,e.setMasked(n),this.__lastTarget=e):Ext.Viewport.setMasked(n)}},{key:"endWaitingMessage",value:function(e){var t=e||this.__lastTarget,n=void 0;n=t&&t.element?t.getMasked():Ext.Viewport.getMasked(),n&&(n.hide(),n.destroy()),this.__lastTarget=null}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.modern.pagingtoolbar"};Ext.define(a.name+".SVMXPagingToolbar",{extend:"Ext.plugin.Abstract",alias:["plugin.svmxpagingtoolbar","plugin.svmxgridpagingtoolbar"],mixins:["Ext.mixin.Hookable"],requires:["Ext.grid.PagingToolbar"],config:{grid:null,currentPage:1,totalPages:0,pageSize:0,totalCount:0,loadPages:null,toolbar:{xtype:"pagingtoolbar",docked:"top",cls:"toolbar-paging"}},init:function(e){this.setGrid(e);var t=this.getToolbar();t.removeAll(),t.setDocked(e.pagingBarDockPosition||"top"),e.pagingBarItemId&&t.setItemId(e.pagingBarItemId),this.__comboBoxFilled=!1;var n=e.alignPagingToolBar,i=this.getToolBarItems(n||"center");t.add(i),e.addToParent?e.parent.add(t):e.add(t)},getToolBarItems:function(e){var t=[{xtype:"button",itemId:"previousPage",ui:"button-paging-toolbar",iconCls:"icon-chevron-left",pressingCls:"svmx-button-pressing",cls:"button-paging-toolbar",handler:i.proxy(this,"onPreviousPageTap")},{xtype:"label",itemId:"pageNumberCount"},{xtype:"svmx.field.picklist",itemId:"pageNumberPicklist",inputCls:"sfmsearch-picklist-borderless paging-picklist",cls:"picklist-sfmdelivery-paging-toolbar",listeners:{change:i.proxy(this,"onPageNumberFieldChange")}},{xtype:"button",itemId:"nextPage",ui:"button-paging-toolbar",iconCls:"icon-chevron-right",pressingCls:"svmx-button-pressing",cls:"button-paging-toolbar",handler:i.proxy(this,"onNextPageTap")}];return"right"===e?t.unshift({xtype:"spacer"}):"left"===e?t.push({xtype:"spacer"}):(t.unshift({xtype:"spacer"}),t.push({xtype:"spacer"})),t},getPreviousPageButton:function(){return this.getToolBarChildByItemId("previousPage")},getNextPageButton:function(){return this.getToolBarChildByItemId("nextPage")},getPageNumberDisplayLabel:function(){return this.getToolBarChildByItemId("pageNumberCount")},getPageNumberPicklist:function(){return this.getToolBarChildByItemId("pageNumberPicklist")},getToolBarChildByItemId:function(e){var t=this.getToolbar().getItems().items;return i.array.filter(t,function(t){return t.getItemId()===e})[0]},onFirstPageTap:function(e){1!=parseInt(this.getCurrentPage())&&this.setCurrentPage(1)},onLastPageTap:function(e){var t=Math.ceil(this.__store.totalCount/this.__store.getPageSize());parseInt(this.getCurrentPage())!=t&&this.setCurrentPage(t)},onPageNumberFieldChange:function(e){var t=parseInt(e.getValue());parseInt(this.getCurrentPage())!=t&&(this.setCurrentPage(t),this.scrollGridToShowFirstRow())},scrollGridToShowFirstRow:function(){var e=this.getGrid();if(this.cmp&&this.cmp.parentPage&&"search"==this.cmp.parentPage&&e)for(var t=e.parent,n=void 0;t;){if(void 0!==(n=t.getScrollable())&&null!==n&&!1!==n){n.scrollTo(0,0);break}t=t.parent}else e.scrollIntoView(!1),this.cmp.scrollIntoView(!1)},doDestroy:function(){this.setGrid(null),this.callParent()},updateGrid:function(e,t){var n=this;n.gridListeners=n.storeListeners=Ext.destroy(n.gridListeners,n.storeListeners),e&&(n.gridListeners=e.on({updatevisiblecount:"onUpdateVisibleCount",storechange:"onStoreChanged",painted:"onGridPainted",destroyable:!0,scope:n}))},onGridPainted:function(){var e=this.getGrid();this.bindStore(e.getStore())},bindStore:function(e){var t=this;Ext.destroy(t.storeListeners),t.getToolbar().setDisabled(!!e),e&&(t.storeListeners=e.on({add:"onTotalCountChange",remove:"onTotalCountChange",refresh:"onTotalCountChange",clear:"onTotalCountChange",destroyable:!0,scope:t}),t.setLoadPages(e.pageSize>0),e.isLoaded()&&t.onTotalCountChange(e))},onStoreChanged:function(e,t){this.bindStore(t)},getPageData:function(){var e=this.getGrid(),t=e.getStore(),n=t.getProxy(),i=t.getTotalCount()||t.getCount();if(n){var a=n.getData();a&&a.total&&(i=a.total)}var r=this.getLoadPages()?t.pageSize:e.visibleCount,o=Math.ceil(i/r);return{totalCount:i,totalPages:Ext.Number.isFinite(o)?o:1,currentPage:t.currentPage,pageSize:r}},checkPageChange:function(){var e=this,t=e.getGrid(),n=e.getPageSize(),i=parseInt(e.getCurrentPage()),a=t.topVisibleIndex,r=Math.ceil((a+n)/n);t.getStore()&&!e.getLoadPages()&&r>0&&r!==i&&(e.preventGridScroll=!0,e.setCurrentPage(r),e.preventGridScroll=!1)},applyToolbar:function(e,t){return Ext.factory(e,Ext.Toolbar,t)},onPageChange:function(e,t){this.setCurrentPage(t)},onPageSliderDrag:function(e,t,n){this.setCurrentPage(Ext.isArray(n)?n[0]:n)},onNextPageTap:function(){var e=parseInt(this.getCurrentPage())+1;e<=this.getTotalPages()&&(this.setCurrentPage(e),this.scrollGridToShowFirstRow())},onPreviousPageTap:function(){var e=parseInt(this.getCurrentPage())-1;e>0&&(this.setCurrentPage(e),this.scrollGridToShowFirstRow())},onTotalCountChange:function(e){var t=this,n=t.getPageData(),i=t.getToolbar();n.totalPages>1?i.isHidden()&&i.show():i.hide(),t.bulkConfigs=!0,t.setConfig(n),t.bulkConfigs=!1,this.__comboBoxFilled=!1,t.syncSummary()},onUpdateVisibleCount:function(e,t){var n=e.getStore(),i=void 0;n&&!this.getLoadPages()&&(t-=1,this.setPageSize(t),i=n.getTotalCount()||n.getCount(),this.setTotalPages(Math.ceil(i/t)))},updateTotalPages:function(){this.isConfiguring||this.syncSummary()},updateCurrentPage:function(e){var t=this;t.isConfiguring||(t.getLoadPages()?t.getGrid().getStore().loadPage(e):t.syncSummary())},updateTotalCount:function(e){this.isConfiguring||this.syncSummary()},privates:{syncSummary:function(){var e=this;if(!e.bulkConfigs){var t=e.getGrid(),n=t.getStore(),i=void 0;i=parseInt(e.getCurrentPage());var a=e.getTotalPages();n.totalPages=a,i>a&&(i=a,this.onPreviousPageTap());var r=" Page "+i+" of "+(a||1);e.getPageNumberDisplayLabel().setHtml(r),e.getNextPageButton().setDisabled(i===a||0===a),e.getPreviousPageButton().setDisabled(1===i);var o=(Math.ceil(n.totalCount/n.getPageSize()),e.getPageNumberPicklist());if(o.setDisabled(0===a),a>0){if(o.suspendEvents(),!this.__comboBoxFilled){var s=0,l=[];for(s;s<a;s++)l[s]={label:(s+1).toString(),value:(s+1).toString(),text:(s+1).toString()};o.setOptions(l),this.__comboBoxFilled=!0}o.setValue(i),o.resumeEvents()}}}}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(14),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=n(10),y=n(0).utils,S=n(5).ModuleActivator,E=n(397).Application,b=n(11).Facade,T=n(7).Cache,M=n(7).ImageCompression,I=n(0).api,C={name:"com.servicemax.client.sfmconsole.ui.largemodern.impl"},A=y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("IPAD"),D=y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA");C.Module=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){init(),C.init(),C.init(),C.init()}}]),t}(S),C.Application=function(e){function t(){(0,d.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this));e.__logger=y.getLoggingService().getLogger("sfmconsole-app");var n=y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager");return n.bind("STATE_CHANGE",e.__handleStateChange,e),n.bind("STATE_MODIFIED",e.__handleStateModified,e),n.bind("STATE_DESTROYED",e.__handleStateDestroyed,e),y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.transientstatemanager").bind("HANDLE_TRANSIENT_STATE",e.__handleTransientState,e),y.getClient().bind("DISPLAY_TAGS_LOADED",e.__resetMenuLabels,e),e.__currentView=null,e.__currentConsoleApp=null,e}return(0,v.default)(t,e),(0,h.default)(t,[{key:"run",value:function(){var e=this;window.cordova&&(document.addEventListener("pause",y.proxy(this,function(){var t=new I.Event("APP_STATUS_BACKGROUND",e,{});e.triggerEvent(t)}),!1),document.addEventListener("resume",y.proxy(this,function(){var t=new I.Event("APP_STATUS_FOREGROUND",e,{});e.triggerEvent(t)}),!1)),this.__logger.info("Caching is => "+y.isCachingEnabled()),this.__loadTags(y.proxy(this,function(){this.__runConsole()}))}},{key:"__runConsole",value:function(){var e=this;e.getAppInfo().then(function(t){e.__addDeviceInfo().then(y.proxy(e,function(n){var i=window.external.getOauthCredentials?window.external.getOauthCredentials().analytics:void 0!==window.newrelic;if(i&&void 0!==window.newrelic&&window.newRelicJson&&"object"===(0,r.default)(window.newRelicJson)&&(delete window.newRelicJson.enabled,t.version&&(window.newRelicJson["App Version"]=t.version)),i){var a=T.readFromJSCache("newrelic","nr_org_id");if(a&&a.length>0){var o=b.createNewRelicCustomEvtRequest(),s={type:"NEWRELICCUSTOMEVT",parameters:{fsaEventType:"MobileAppLaunch",orgId:a}};o.execute(s)}else{T.readFromDBCache("USER_INFO").done(function(e){var t=y.toObject(e);if(t&&t.OrgId){T.writeToJSCache("newrelic","nr_org_id",t.OrgId);var n=b.createNewRelicCustomEvtRequest(),i={type:"NEWRELICCUSTOMEVT",parameters:{fsaEventType:"MobileAppLaunch",orgId:t.OrgId}};n.execute(i)}})}}e.__runSync()}))})}},{key:"getAppInfo",value:function(){var e=y.Deferred();return y.create("com.servicemax.client.sfmconsole.utils.EventCollection",this,[y.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.GET_APP_INFO",this,{request:{}})]).triggerAll(function(t){var n=t.items()[0].response,i=n.version||"";y.getClient().addApplicationParameter("app-version",i),y.getClient().ClientVersion=i,e.resolve(n)}),e.promise()}},{key:"__addDeviceInfo",value:function(){var e=y.Deferred(),t=b,n=t.createDeviceInfoRequest();return n.bind("REQUEST_COMPLETED",function(t){if(y.getClient().addApplicationParameter("device-info",t.data.data||{}),y.getClient().getApplicationParameter("device-info")&&y.getClient().getApplicationParameter("device-info")["client-type"]){var n=y.getClient().getApplicationParameter("device-info")["client-type"];y.getClient().addApplicationParameter("client-type",n),y.getClient().isLaptop=function(){return"laptop"==y.getClient().getApplicationParameter("client-type").toLowerCase()};var i=y.getClient().getApplicationParameter("device-info").details,a=void 0;if(y.getClient().isLaptop()){for(var r=JSON.parse(i),o=0;o<r.length;o++)if("BiosSerialNumber"===r[o].Key){a=r[o].Value;break}}else"string"!=typeof i&&(a=i.uuid);y.getClient().addApplicationParameter("client-uuid",a),y.getClient().isLaptop()||g(document).on("click",'a[href^="http"]',function(e){var t=g(this).attr("href");window.open(t,"_system"),e.preventDefault()}),y.getClient().isBarCodeEnabled=function(){var e=!1,t=y.getClient().getApplicationParameter("device-info");return t&&t["barcode-enabled"]&&(e=!0),e}}e.resolve({})},this),n.bind("REQUEST_ERROR",function(t){e.resolve({})},this),n.execute({method:"DEVICEINFO",type:"MISC"}),e}},{key:"__runSync",value:function(){var e=this.__getSyncImpl();this.__buildRootContainer(),this.showSpinner(this.getRoot()),this.__discoverConsoleApps(),e.bind("SYNC_FINISHED_INITIALIZING",function(e){e.data.lastSync.user&&this.setUserInfo(e.data.lastSync.user),this.hideSpinner(this.getRoot()),setTimeout(y.proxy(this,function(){this.__syncCompleted(e.data.lastSync)}),200)},this),e.bind("SYNC_COMPLETED",function(t){e.getSyncUserInfo({context:this,callback:function(e){this.setUserInfo(e)}})},this),e.run()}},{key:"__buildRootContainer",value:function(){this.__root=this.__view.createComponent("ROOTCONTAINER",{renderTo:y.getDisplayRootId(),console:this})}},{key:"__syncCompleted",value:function(e){A.isEmpty()?this.__loadTags(y.proxy(this,function(){this.__buildConsole(e)})):this.__buildConsole(e)}},{key:"__buildConsole",value:function(e){this.__userInfo=e.user,y.TEST||this.__root.setUserInfo(this.getUserInfo()),this.__openFirstConsoleApp(),this.__startIncrementalReSync();var t=y.create("com.servicemax.client.lib.api.Event","CONSOLE_APP_LAUNCHED",this);if(y.getClient().triggerEvent(t),y.getClient().getApplicationParameter("InstallBase")){var n={action:"OPEN",operation:"OPEN"},i=b,a=i.createSendExternalRequest();a.bind("REQUEST_COMPLETED",function(e){}),a.bind("REQUEST_ERROR",function(e){}),a.execute({appName:"Installigence",externalRequest:y.toJSON(n)})}}},{key:"__discoverConsoleApps",value:function(){var e=y.getClient().getDeclaration("com.servicemax.client.sfmconsole.consoleapp"),t=y.getClient().getDefinitionsFor(e);if(0===t.length)return void this.__logger.error("No console apps defined.");var n=[];this.__load_on_demand_settings_cache={};for(var i=0;i<t.length;i++){var a=t[i].config.app.id;if(this.__consoleAppConfigs[a]=t[i].config,this.__consoleAppConfigs[a].load_on_demand){var r=this.__consoleAppConfigs[a].load_on_demand_setting_value,o=0,s=r.length;for(o;o<s;o++)n.push(r[o])}}this.__getOnDemandConsoleAppSettings(n)}},{key:"__getOnDemandConsoleAppSettings",value:function(e){var t=y.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.RETRIEVE_ON_DEMAND_APP_SETTINGS",this,{request:{settings:e},responder:y.create("com.servicemax.client.sfmconsole.commands.RetrieveOnDemandSettingsResponder",this)});this.triggerEvent(t)}},{key:"onRetrieveOnDemandSettings",value:function(e){this.__load_on_demand_settings_cache=e,this.__buildAndRegisterConsoleApps()}},{key:"__buildAndRegisterConsoleApps",value:function(){var e=y.getClient().getDeclaration("com.servicemax.client.sfmconsole.consoleapp"),t=y.getClient().getDefinitionsFor(e),n=[],i=0,a=[];for(i;i<t.length;i++){var o=t[i].config.app.id,s=this.__consoleAppConfigs[o].tooltip,l="object"===(void 0===s?"undefined":(0,r.default)(s))?s[0]:s,c="object"===(void 0===s?"undefined":(0,r.default)(s))?s[1]:s,u=this.__consoleAppConfigs[o]["button-text"],d="object"===(void 0===u?"undefined":(0,r.default)(u))?u[0]:u,_="object"===(void 0===u?"undefined":(0,r.default)(u))?u[1]:u,h=!1,f="";if(this.__consoleAppConfigs[o]["show-conflicts"]&&(h=!0,f=this.__consoleAppConfigs[o]["conflict-badge-class"]||""),this.__consoleAppConfigs[o].discover){if(this.__consoleAppConfigs[o].load_on_demand){this.__checkToShowOnDemandApp(this.__consoleAppConfigs[o].load_on_demand_setting_value)||a.push(o)}n.push({weight:t[i].config.positionWeight,context:this,key:o,iconClass:this.__consoleAppConfigs[o].icon["large-css-class"],tooltip:l?A.T(l,c):"",buttonText:d?D.T(d,_):"",showConflictBadge:h,conflictBadgeCls:f})}}n.sort(function(e,t){return e.weight-t.weight});for(var p=0;p<n.length;p++)n[p]&&this.__registerLaunchableApp(n[p]);this.__hideConsoleApps(a);var m=y.create("com.servicemax.client.lib.api.Event","CONSOLE_APPS_REGISTERED",this);y.getClient().triggerEvent(m),M.loadImageCompressionSettingValue()}},{key:"__checkToShowOnDemandApp",value:function(e){var t=e.length,n=0,i=!0;for(n;n<t;n++){var a=e[n];if(!this.__load_on_demand_settings_cache[a]){i=!1;break}}return i}},{key:"__resetMenuLabels",value:function(){this.__discoverConsoleApps()}},{key:"__handleStateChange",value:function(e){try{var t=e.data,n=e.target,i=t.app,a=!t.viewInstanceId,r=void 0,o=void 0,s=!1;if("consoleInstanceId"in t){if(!(r=this.findConsoleAppByWindowId(t.consoleInstanceId)))return void this.__logger.error("consoleAppInstance "+t.consoleInstanceId+" not found; unable handle state change")}else r=this.createConsoleApp(i,t.options);if(o=a?r.createView(t.view):r.getView(t.viewInstanceId),o.getParent()||(s=!0,this.getRoot().add(o),t.viewInstanceId&&t.consoleInstanceId||(t=n.modifyState({viewInstanceId:o.getId(),consoleInstanceId:r.getId(),stateParameters:{noEvent:!0}}))),this.getRoot().handleStateChange(t,r,o,s,this.__restoreViewData,e.isBack),delete this.__restoreViewData,s){if(!r.setViewOptions(o.getId(),t.options||{}))return n.back()}this.__currentConsoleApp=r,this.__currentView=o}catch(e){this.__logger.error("Exception caught on __handleStateChange.\n",e.stack)}}},{key:"__handleStateModified",value:function(e){var t=e.data,n=this.findConsoleAppByWindowId(t.consoleInstanceId),i=n.getView(t.viewInstanceId);this.getRoot().handleStateModified(e.data,n,i)}},{key:"__handleStateDestroyed",value:function(e){var t=e.data,n=e.target,i=this.findConsoleAppByWindowId(t.consoleInstanceId);if(i){i.getView(t.viewInstanceId);i.getAppConfig().discover||n.findByField("consoleInstanceId",t.consoleInstanceId)?i.viewRemoved(t.viewInstanceId):this.destroyConsoleApp(i)}}},{key:"__handleTransientState",value:function(e){var t=e.data;t&&t.handler&&t.handler.call(t.scope)}},{key:"enableProgressBar",value:function(){this.getRoot().enableProgressBar()}},{key:"disableProgressBar",value:function(){this.getRoot().disableProgressBar()}},{key:"pushState",value:function(e){e.options||(e.options={});var t=y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager");if(!("windowTitle"in e)){var n=t.getState();n&&(e.windowTitle=n.windowTitle,"subTitle"in e||(e.subTitle=n.subTitle),"backText"in e||(e.backText=n.backText))}t.pushState(e)}},{key:"getCurrentView",value:function(){return this.__currentView}},{key:"__registerLaunchableApp",value:function(e){if(this.__root&&this.__root.addConsoleNavLaunchButton){this.__root.addConsoleNavLaunchButton(e.context,e.key,e.iconClass,e.buttonText,e.showConflictBadge,e.conflictBadgeCls)}}},{key:"__hideConsoleApps",value:function(e){this.__root&&this.__root.hideConsoleNavLaunchButton&&this.__root.hideConsoleNavLaunchButton(e)}},{key:"launchConsoleApp",value:function(e,t){this.pushState({app:e,options:t})}},{key:"__openFirstConsoleApp",value:function(e){e=e||!1;var t=this.__getFirstConsoleApp();if(t){var n={app:t,options:{}},i=y.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager");i.getState()&&!e&&i.resetAll(),i.pushMainState(t,n)}}},{key:"showConsoleApp",value:function(e){}},{key:"getCurrentConsoleApp",value:function(){return this.__currentConsoleApp}},{key:"showSpinner",value:function(e,n){(0,s.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"showSpinner",this).call(this,e||this.getRoot().getActiveItem(),n)}},{key:"hideSpinner",value:function(e){(0,s.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"hideSpinner",this).call(this,e)}},{key:"getApplicationErrorHandler",value:function(){return this}},{key:"notifyApplicationError",value:function(e){if(e){var t=e.message;t instanceof Array||(t=[{message:t,msgDetail:e.msgDetail}]);var n=t[0].message;y.Msg.alert({title:D.T("FSA016_TAG043","Error"),text:n,buttons:[{text:D.T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]})}}},{key:"showMessage",value:function(e){var t=void 0;return this.__notificationService?t=this.__notificationService.showMessage(e):this.__logger.error("showMessage failed because there is no notification service"),t}}]),t}(E),y.defineGlobal(C.name,C),e.exports=C},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(19).impl,n(24).navigation),m=n(5).EventDispatcher,v=n(0).api,g=n(11).Facade,y=n(12).DatetimeUtil,S=n(7).Cache,E=(n(5).SVMXObject,{name:"com.servicemax.client.sfmconsole.ui.largemodern.api"}),b=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},T=p;E.TransientStateService=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__states=[],e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"pushState",value:function(e){this.__states=this.__states||[],e&&e.state&&e.handler&&-1==this.__findStateIndex(e)&&(e.scope=e.scope||e.state,this.__states.push(e),this.triggerStateAdded(e))}},{key:"pullState",value:function(e){this.__states=this.__states||[];var t=this.__findStateIndex(e);return t>-1&&(this.__states.splice(t,1),this.triggerStateRemoved(e)),t>1}},{key:"nextState",value:function(){this.__states=this.__states||[];var e=this.__states.pop();return e&&this.triggerHandleState(e),!!e}},{key:"__findStateIndex",value:function(e){var t=-1,n=this.__states.length,i=0;for(i=0;i<n;i++)if(this.__states[i].state===e.state){t=i;break}return t}},{key:"triggerHandleState",value:function(e){var t=new v.Event("HANDLE_TRANSIENT_STATE",this,e);return this.triggerEvent(t)}},{key:"triggerStateRemoved",value:function(e){var t=new v.Event("REMOVED_TRANSIENT_STATE",this,e);return this.triggerEvent(t)}},{key:"triggerStateAdded",value:function(e){var t=new v.Event("ADDED_TRANSIENT_STATE",this,e);return this.triggerEvent(t)}}]),t}(m),Ext.define(E.name+".SFMConsoleRootContainer",{extend:T.name+".SVMXCardPanel",alias:"widget.sfmconsolecontainer",__logger:null,__console:null,__syncStarted:!1,__backShowing:!1,__exitState:!0,__backButtonInToolbar:!1,__enableProgressBar:!1,__showBackButton:!0,fullscreen:!0,config:{enableHardwareBack:!0,itemId:"consoleMain",layout:"fit",items:[{xtype:"svmx.horizontalpanel",valign:"center",halign:"center",cls:"sfm-console-navbar-panel",width:"100%",items:[{xtype:"svmx.buttonset",cls:"sfm-console-navbar-buttonset",itemId:"navMenu",defaults:{flex:1}}],docked:"bottom"},{xtype:"svmx.verticalpanel",itemId:"titleBarWrapper",docked:"top",items:[{xtype:"svmx.headerbar",itemId:"titleBar",ui:"console-header",docked:"top",halign:"full",cls:"sfm-console-titlebar"}]},{xtype:"svmx.horizontalpanel",itemId:"progressBarWrapper",docked:"top",valign:"progressBarWrapper",halign:"center",cls:"sfm-console-progressbar-wrapper",width:"100%",items:[{xtype:"svmx.progressbar",itemId:"syncMenuProgress",id:"syncMenuProgress",message:"",showSubProgress:!1,containerCls:"sfm-console-small-progressbar",barCls:"sfm-console-small-progressbar",hidden:!0,width:"100%"}]},{xtype:"svmx.horizontalpanel",itemId:"toastWrapper",docked:"top",valign:"toastWrapper",halign:"center",cls:"sfm-console-toast-wrapper",width:"100%",items:[{xtype:"svmx.label",cls:"sfm-console-toast-label",html:"Toast messages will be shown here...",hidden:!0,itemId:"toastLabel"}]}]},__transientStateManager:null,constructor:function(e){this.__logger=f.getLoggingService().getLogger("SFMCONSOLE-ROOT"),this.__console=e.console,this.callParent([e]),this.__showBackButton=f.getClient().getApplicationParameter("svmx-sfm-software-back"),this.__backButtonInToolbar=!0,this.run(),this.__transientStateManager=f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.transientstatemanager"),Ext.Viewport.addListener("transientState",f.proxy(this,"handleTransientState"))},getSyncManager:function(){return this.__syncManager||(this.__syncManager=f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.syncmanager")),this.__syncManager},getSyncImpl:function(){return!this.__syncImpl&&this.__console&&(this.__syncImpl=this.__console.__getSyncImpl()),this.__syncImpl},run:function(){this.titleBar=this.query("#titleBar")[0],this.__createDefaultLeftItem(),this.__createDefaultCenterItem(),this.__createDefaultRightItem(),this.titleBarWrapper=this.query("#titleBarWrapper")[0],this.navMenu=this.query("#navMenu")[0],this.progressBar=this.query("#syncMenuProgress")[0],this.toastLabel=this.query("#toastLabel")[0],f.Msg.toast=f.proxy(this,this.__consoleToast),this.navMenu.hide();var e="sfm-console-toast-wrapper-margin-top-android-mfl";"iOS"===f.getClient().__appParams["device-info"]["device-platform"]&&(e="sfm-console-toast-wrapper-margin-top-iPad",parseFloat(f.getClient().__appParams["device-info"].details.version)>=11&&(e="sfm-console-toast-wrapper-margin-top-android-mfl")),this.query("#toastWrapper")[0].addCls(e),this.__bindSyncEventHandlers(),document.hardwareBackHandler=this.hardwareBack.bind(this),document.addEventListener("backbutton",document.hardwareBackHandler,!1)},__consoleToast:function(e){this.toastLabel.setHtml(e.text);var t=e.duration;t||(t=5e3),f.timer.job(this.getId()+".showToast",t,this,function(){this.toastLabel.hide()}),this.toastLabel.show()},__createDefaultLeftItem:function(){this.backButton=this.titleBar.query("#backButton")[0],this.backButton||(this.titleBar.setLeftItem([{xtype:"svmx.button",itemId:"backButton",iconCls:"icon-chevron-left svmx-back-button",cls:"sfmconsole-back-button",iconAlign:"left",hidden:!0},{xtype:"svmx.horizontalpanel",itemId:"leftCustomHeader",hidden:!0}]),this.backButton=this.query("#backButton")[0],this.backButton.setHandler(this.__createBackButtonHandler()),this.leftCustomHeader=this.query("#leftCustomHeader")[0])},__createBackButtonHandler:function(){return this.__createOncePerInterval(f.proxy(this,"back"),1e3,this)},__createOncePerInterval:function(e,t,n){var i=0,a=void 0,r=function(){e.apply(n,a)};return function(){a=arguments;var e=Date.now();e-i>t?(i=e,r()):console.warn("Skipping execution of duplicate call.")}},__createDefaultCenterItem:function(e){this.titleLabel=this.titleBar.query("#titleLabel")[0],this.titleBar.setCenterItem([{xtype:"svmx.button",itemId:"titleLabel",cls:"sfm-console-titlelabel x-iconalign-right",transparent:!0,text:""},{xtype:"svmx.label",itemId:"subTitle",cls:"sfm-console-subtitle"}]),this.titleLabel=this.query("#titleLabel")[0],this.subTitle=this.query("#subTitle")[0]},__createDefaultRightItem:function(){this.menuButton=this.titleBar.query("#menuButton")[0],this.menuButton||(this.titleBar.setRightItem([{xtype:"svmx.horizontalpanel",itemId:"rightCustomHeader",hidden:!0},{xtype:"svmx.contextmenubutton",text:b().T("FSA008_TAG006","Actions"),itemId:"menuButton"}]),this.rightCustomHeader=this.query("#rightCustomHeader")[0],this.menuButton=this.query("#menuButton")[0])},setTitle:function(e,t,n){this.titleLabel.setHtml(e||"---"),t?(this.titleLabel.addListener("tap",t),this.titleLabel.setIconCls("sfm-console-titlelabel-tap-icon"),this.titleLabel.setIconAlign("right"),this.titleLabel.el.dom.style.cursor="pointer"):n||(this.titleLabel.clearListeners(),this.titleLabel.setIconCls(""),this.titleLabel.el.dom.style.cursor="default")},setSubTitle:function(e){this.subTitle.setHtml(e),e?this.subTitle.show():this.subTitle.hide()},setBackText:function(e){this.backButton.setText(e)},showBackButton:function(){this.__backShowing=!0,this.backButton.show()},hideBackButton:function(){this.__backShowing=!1,this.backButton.hide()},hideLoading:function(){f.getCurrentApplication().hideSpinner(f.getCurrentApplication().getRoot())},back:function(){if(this.__backShowing){f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").back()}},handleTransientState:function(e){if(e=e||{},e.type=e.type||"",e.state)switch(e.scope=e.scope||e.state,e.type){case"open":e.handler&&this.__transientStateManager.pushState(e);break;case"close":this.__transientStateManager.pullState(e)}},hardwareBack:function(e){if(!f.getCurrentApplication().getRoot().getEnableHardwareBack())return void f.getCurrentApplication().getRoot().setEnableHardwareBack(!0);if(!f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.transientstatemanager").nextState()){var t=this.__console.getCurrentView();t&&t.handleHardwareBack()||(f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").getIndex()>0&&!this.__exitState?this.back():this.__exitState&&this.showExitDialog())}},enableProgressBar:function(){this.__enableProgressBar=!0},disableProgressBar:function(){this.__enableProgressBar&&this.progressBar&&(this.__enableProgressBar=!1,this.progressBar.updateProgress(0),this.progressBar.hide())},showExitDialog:function(){var e=b().T("FSA010_TAG086","Exit Application"),t=b().T("FSA010_TAG087","Would you like to exit the application?"),n=b().T("FSA016_TAG001","Yes"),i=b().T("FSA016_TAG002","No"),a=[{text:n,itemId:"CONTINUE",ui:"svmx-button-square"},{text:i,itemId:"CANCEL",ui:"svmx-button-square"}];f.Msg.alert({title:e,text:t,buttons:a}).then(f.proxy(this,function(e){if("CONTINUE"==e||e==n){g.createExitRequest().execute(location)}}))},addCards:function(e){this.add(e);for(var t={},n=0;n<e.length;n++){var i=e[n];i.itemId&&(t[i.itemId]=this.query("#"+i.itemId)[0])}return t},handleStateChange:function(e,t,n,i,a,r){if(n)try{var o=n.getParent();if(o)var s=o.getActiveItem();if(!e.stopAnimation||r){r?(n.setShowAnimation({type:"slide",direction:"right",duration:250}),n.setZIndex(500),s&&(s.setHideAnimation({type:"slideOut",direction:"right",duration:500}),s.setZIndex(0))):(n.setShowAnimation({type:"slide",direction:"left",duration:250}),n.setZIndex(500),s&&(s.setHideAnimation({type:"slideOut",direction:"left",duration:500}),s.setZIndex(0)))}else s&&(s.setHideAnimation(null),s.setShowAnimation(null)),n.setShowAnimation(null),n.setHideAnimation(null);n.activate(),i||n.restore(a),n.setShowAnimation(null),s.setHideAnimation(null)}catch(e){this.__logger.error("Error activating view: "+e)}var l=n.updateStateConfig(e);this.handleStateModified(l,t,n),this.hightlightConsoleApp(t)},handleStateModified:function(e,t,n){if(this.titleBarWrapper[e.hideMenuBar?"hide":"show"](),e.leftItem)this.titleBar.setLeftItem(e.leftItem);else{this.__createDefaultLeftItem(),e.leftHeader&&(this.leftCustomHeader.removeAllDelayDestroy(),this.leftCustomHeader.add(e.leftHeader)),this.leftCustomHeader[e.leftHeader?"show":"hide"]();var i=this._getPriorState();i&&!1!==i.backText&&!e.hideBackButton?(this.setBackText(i.backText||b().T("FSA016_TAG015","Back")),this.showBackButton(),this.__exitState=!1):(this.hideBackButton(),this.__exitState=!i),0==this.__exitState&&e.disableNavMenu&&(this.__exitState=!0)}if(e.centerItem?this.titleBar.setCenterItem(e.centerItem):(this.__createDefaultCenterItem(e),this.setTitle(e.windowTitle,e.windowTitleTap),this.setSubTitle(e.subTitle)),e.rightItem)this.titleBar.setRightItem(e.rightItem);else{this.__createDefaultRightItem(),e.rightHeader&&(this.rightCustomHeader.removeAllDelayDestroy(),this.rightCustomHeader.add(e.rightHeader)),this.rightCustomHeader[e.rightHeader?"show":"hide"]();var a=this;setTimeout(function(){void 0!==e.disableActionMenu&&null!==e.disableActionMenu?a.menuButton.setMenuItems(e.disableActionMenu?[]:n.getMenuItems()):a.menuButton.setMenuItems(n.getMenuItems()||[]),a.menuButton[e.hideContextMenu?"hide":"show"]()},0)}this.navMenu[e.disableNavMenu?"hide":"show"]()},_getPriorState:function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").getPriorState()},_getPriorStateBackText:function(){var e=this._getPriorState();return e&&e.backText},__bindSyncEventHandlers:function(){var e=this.getSyncManager(),t=this.getSyncImpl(),n=this;e.bind("SYNC_STARTED",function(t){var i=e.getSyncType();-1==["ONECALLSYNC","AGGRESSIVE","TARGETEDSYNC","LOCATION","CONFIG_SYNC_REMINDER"].indexOf(i)&&f.doLater(function(){this.__console.closeClosableApps()},this),"AGGRESSIVE"!=i&&"ONECALLSYNC"!=i&&"TARGETEDSYNC"!=i||(n.enableProgressBar(),n.progressBar.show())},this),e.bind("SYNC_STOPPED",function(e){var t=this;this.getSyncManager().getConflictCount(function(e){e&&e.count&&parseInt(e.count),t.showConflicts()}),this.disableProgressBar()},this),e.bind("SYNC_COMPLETED",function(e){this.updateLocaleInfo();var t=["ONECALLSYNC","AGGRESSIVE","TARGETEDSYNC"],n=this.getSyncManager().getSyncType();"TARGETEDSYNC"!==n&&t.indexOf(n)>-1&&this.__enableProgressBar&&f.Msg.toast({text:b().T("FSA010_TAG090","Data sync completed successfully")}),this.disableProgressBar()},this),t.bind("SYNC_PROGRESS_IMPL",function(t){var n=e.getSyncType(),i=0,a=0;["ONECALLSYNC","AGGRESSIVE","TARGETEDSYNC"].indexOf(n)>-1&&this.__enableProgressBar&&(i=t.data.totalCount||i,a=t.data.currentStep||a),"TARGETEDSYNC"===n&&this.__enableProgressBar&&f.Msg.toast({text:b().T("FSA010_TAG149","Syncing records...")});var r=Math.round(a/i*100);this.progressBar.updateProgress(r)},this),t.bind("SYNC_PROFILE_ERROR_DIALOG",function(e){this.showProfileErrorDialog(e)},this),t.bind("SYNC_CONNECTION_ERROR_DIALOG",function(e){this.showConnectionErrorDialog(e)},this),t.bind("SYNC_FAILED_DIALOG",function(e){this.showOnFailedErrorDialog(e)},this),t.bind("SYNC_CONNECTION_WARNING_DIALOG",function(e){this.showConnectionWarningDialog(e)},this),t.bind("REFRESH_SSL_PINNING",function(e){this.updateSSLCertificatePinning(e)},this),t.bind("SYNC_STARTED_IMPL",function(t){var n=e.getSyncType(),i=["ONECALLSYNC","AGGRESSIVE","TARGETEDSYNC"];if(t.data.runningInitial){f.getCurrentApplication().hideSpinner(f.getCurrentApplication().getRoot());f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").pushState({app:"toolspages-largemodern",windowTitle:b().T("FSA010_TAG053","Welcome to ServiceMax Field Service"),view:"resetapp",disableNavMenu:!0,backText:null,hideBackButton:!0,options:{successMessage:b().T("FSA010_TAG091","The ServiceMax application is now ready to use."),progressMessage:b().T("FSA010_TAG092","ServiceMax is synchronizing with the server to retrieve your latest work orders and other items you need.")}})}else i.indexOf(n)>-1&&this.__enableProgressBar&&this.progressBar.addCls("sfm-progress-shadow")},this),f.getClient().bind("CONSOLE_APPS_REGISTERED",function(e){this.showConflicts()},this),t.bind("SYNC_COMPLETED_IMPL",function(e){var t=e.data.syncType;"edit"!=f.getCurrentApplication().getCurrentView().getViewConfig()&&"checklistedit"!=f.getCurrentApplication().getCurrentView().getViewConfig()&&("DATA"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t&&"ONECALLSYNC"!=t||setTimeout(function(){f.Msg.toast({text:b().T("FSA002_TAG004","Refreshing View")})},2e3))},this)},updateSSLCertificatePinning:function(e){var t=e.data.ENABLE_SSL_CERTIFICATE_PINNING||!1,n=g,i=n.createSetSSLCertificatePinningRequest();i.bind("REQUEST_COMPLETED",function(e){console.log("Successfully set SSL Certifcate Pinning to "+t)}),i.bind("REQUEST_ERROR",function(e){console.warn("FAILED TO Set SSL Certifcate Pinning to "+t)}),i.execute({value:t})},updateLocaleInfo:function(){var e=f.Deferred(),t=g,n=t.createLocaleFormatRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data;if(!n)return void e.reject();Ext.util.Format.decimalSeparator=n.number_decimal_separator,Ext.util.Format.thousandSeparator=n.number_group_separator;var i=y.convertFormatToJSFormat(n.date);i=i.replace(/[Yy]+/g,"YYYY"),y.setDateFormat(i);var a=y.convertFormatToJSFormat(n.time);y.setTimeFormat(a);var r=y.convertFormatToJSFormat(n.long_date);y.setLongDateFormat(r),e.resolve()},this),n.bind("REQUEST_ERROR",function(t){this.__logger.debug("Unable to cache locale info"),e.reject()},this),n.execute(),e},showProfileErrorDialog:function(e){var t=b().T("FSA010_TAG093","Error"),n=b().T("FSA010_TAG094","Your Salesforce Profile is not associated with any active ServiceMax Group Profile. Please contact your ServiceMax administrator to resolve this."),i=b().T("FSA010_TAG095","SignOut"),a=[{text:i,itemId:"CANCEL",ui:"svmx-button-square"}];f.Msg.alert({title:t,text:n,buttons:a}).then(f.proxy(this,function(e){if("CANCEL"==e||e==i){var t=f.getCurrentApplication(),n=f.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.SIGNOUT",t,{request:null,responder:null});t.triggerEvent(n)}}))},showConnectionErrorDialog:function(e){if(!f.getCurrentApplication().checkForMessageId("tools-conn-msgbox")&&!f.getCurrentApplication().checkForMessageId("connectionErrorDialog")){var t=this,n=this.getSyncImpl(),i=e.data.syncType,a=null,r=e.data.msgbox,o=e.data.initialConn;r&&r.hide(),this._activeItem.msgbox&&(a=this._activeItem.msgbox,a.hide());var s=b().T("FSA010_TAG096","Connection Error"),l=b().T("FSA010_TAG050","There is an issue with your connection to the server. Please try again later. If the problem persists, contact your system administrator."),c=b().T("FSA010_TAG097","Retry"),u=b().T("FSA016_TAG004","Cancel"),d=f.getClient().getApplicationParameter("client-type").toLowerCase(),_=[{text:u,itemId:"CANCEL",ui:"button-tools-msgbox"},{text:c,itemId:"OK",ui:"button-tools-msgbox button-highlight"}];(e.data.runningInitial||o)&&("laptop"==d?_=[{text:c,itemId:"OK",ui:"button-tools-msgbox"}]:"mobile"==d&&(_=[{text:u,itemId:"SIGNOUT",ui:"button-tools-msgbox"},{text:c,itemId:"OK",ui:"button-tools-msgbox  button-highlight"}])),f.Msg.alert({title:s,text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:l}],buttons:_,itemId:"connectionErrorDialog"}).then(f.proxy(this,function(e){if("OK"==e)a&&a.show(),r&&r.show(),1==o?n.performPreInitialSync():n.connectionErrorRetry(i);else if("SIGNOUT"==e){var s=f.getCurrentApplication(),l=f.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.SIGNOUT",s,{request:null,responder:null});a&&(a.destroy(),t._activeItem.msgbox=null),r&&(r.destroy(),r=null),s.triggerEvent(l)}else a&&(a.destroy(),t._activeItem.msgbox=null),r&&(r.destroy(),r=null),n.connectionErrorCancel()}))}},showConnectionWarningDialog:function(e){if(!f.getCurrentApplication().checkForMessageId("connectionWarningDialog")){var t=this,n=this.getSyncImpl(),i=null,a=e.data.msgbox;a&&a.hide(),this._activeItem.msgbox&&(i=this._activeItem.msgbox,i.hide());var r=b().T("FSA007_TAG001","Connection Warning"),o=b().T("FSA007_TAG002","There is an issue with your connection to the server. Please try again later. If the problem persists, contact your system administrator."),s=b().T("FSA010_TAG097","Retry"),l=b().T("FSA016_TAG004","Cancel"),c=[{text:l,itemId:"CANCEL",ui:"button-tools-msgbox"},{text:s,itemId:"OK",ui:"button-tools-msgbox button-highlight"}];e.data.runningInitial&&(c[1].itemId="SIGNOUT"),f.Msg.alert({title:r,text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:o}],buttons:c,itemId:"connectionWarningDialog"}).then(f.proxy(this,function(e){if("OK"==e)i&&i.show(),n.connectionErrorRetry();else if("SIGNOUT"==e){var r=f.getCurrentApplication(),o=f.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.SIGNOUT",r,{request:null,responder:null});i&&(i.destroy(),t._activeItem.msgbox=null),a&&(a.destroy(),a=null),r.triggerEvent(o)}else i&&(i.destroy(),t._activeItem.msgbox=null),a&&(a.destroy(),a=null),n.connectionErrorCancel()}))}},showOnFailedErrorDialog:function(e){var t=this,n=this.getSyncImpl(),i=b().T("FSA010_TAG098","Synchronization failed"),a=null;this._activeItem.msgbox&&(a=this._activeItem.msgbox,a.hide());var r=void 0,o="";if(e.data.errorMessages){o+="<BR>";var s="<BR>",l=0;for(r=0;r<e.data.errorMessages.length;r++)l+=e.data.errorMessages[r].length;for(s="\n\n",o+="<textarea readonly rows='4' cols='50' style='width:100%;'>",r=0;r<e.data.errorMessages.length;r++)e.data.errorMessages[r]&&(o+=s+e.data.errorMessages[r].trim());o+="</textarea>"}if(e.data.allowRetry&&e.data.allowContinue){var c=b().T("FSA010_TAG099","One or more sync processes have failed. Would you like to continue?");c+=o;var u=b().T("FSA010_TAG141","Continue"),d=b().T("FSA010_TAG097","Retry"),_=[{text:d,itemId:"CANCEL",ui:"button-tools-msgbox"},{text:u,itemId:"CONTINUE",ui:"button-tools-msgbox button-highlight"}];f.Msg.alert({title:i,text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:c}],buttons:_}).then(f.proxy(this,function(e){a&&(a.destroy(),t._activeItem.msgbox=null),"CONTINUE"==e||e==u?n.failedErrorContinue():n.failedErrorRetry()}))}else if(e.data.allowRetry){var c=b().T("FSA010_TAG099","One or more sync processes have failed. Would you like to continue?");c+=o;var d=b().T("FSA010_TAG097","Retry"),_=[{text:d,itemId:"CANCEL",ui:"svmx-button-square"}];f.Msg.alert({title:i,text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:c}],buttons:_}).then(f.proxy(this,function(e){"CANCEL"!=e&&e!=d||(a&&(a.destroy(),t._activeItem.msgbox=null),n.failedErrorRetry())}))}else{var h=b().T("FSA016_TAG003","OK"),c=b().T("FSA010_TAG142","Synchronization error");c+=o;var _=[{text:h,itemId:"CONTINUE",ui:"button-tools-msgbox"}];n.failedErrorContinue(),f.Msg.alert({title:i,text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:c}],buttons:_}).then(f.proxy(this,function(e){a&&(a.destroy(),t._activeItem.msgbox=null)}))}},showConflicts:function(){var e=this,t=[];this.__syncManager.getConflictCount(function(n){var i=0;n&&n.count&&(i=parseInt(n.count)),t.push(S.readFromDBCache("IS_CONFIG_SYNC_DUE").then(f.proxy(this,function(e){e&&"true"===e&&i++}))),t.push(S.readFromDBCache("IS_DATA_PURGE_DUE").then(f.proxy(this,function(e){e&&"true"===e&&i++}))),f.when(t).then(f.proxy(this,function(){for(var t=i>0?""+i:"",n=e.navMenu.getItems().items,a=n.length,r=0;r<a;r++)n[r].config&&n[r].config.showConflictBadge&&n[r].setBadgeText(t)}))})},setUserInfo:function(e){},addConsoleNavLaunchButton:function(e,t,n,i,a,r){for(var o="<div class='"+n+"'></div><div class='svmx-menu-icon-label'>"+i+"</div>",s=this.navMenu.getItems().items,l=s.length,c=!0,u=0;u<l;u++)s[u].config&&s[u].config.consoleAppId===t&&(s[u].setText(o),s[u].show(),c=!1);if(c){var d={xtype:"svmx.button",text:o,handler:f.proxy(this,"launchConsoleApp",t,!0),showConflictBadge:!!a,consoleAppId:t,tapOverflowTop:0};a&&r&&(d.badgeCls=r),this.navMenu.add(d)}},hideConsoleNavLaunchButton:function(e){var t=0,n=0,i=e.length,a=this.navMenu.getItems().items,r=a.length;for(t;t<i;t++){var o=e[t];for(n;n<r;n++)a[n].config&&a[n].config.consoleAppId===o&&a[n].hide()}},hightlightConsoleApp:function(e){var t=e.getAppTypeId();this.__hightlightConsoleAppById(t)},__hightlightConsoleAppById:function(e){for(var t=this.navMenu.getItems().items,n=[],i=0;i<t.length;i++)if(t[i].config&&t[i].config.consoleAppId===e){n.push(t[i]);break}1==n.length&&(this.navMenu.updatePressedButtons([]),this.navMenu.updatePressedButtons(this.navMenu.getItems().items.indexOf(n[0])))},__consoleAppLaunchingTime:0,__previousConsoleAppId:null,launchConsoleApp:function(e,t){if(Date.now()-this.__consoleAppLaunchingTime<300)return console.warn("launchConsoleApp: A consoleApp is launching, skipping."),void(this.__previousConsoleAppId&&e!=this.__previousConsoleAppId&&this.__hightlightConsoleAppById(this.__previousConsoleAppId));this.__previousConsoleAppId=e;try{f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").pushMainState(e,{app:e,options:{},stopAnimation:!1!==t})}finally{this.__consoleAppLaunchingTime=Date.now()}},manageConsoleAppContainerClose:function(e){},isActiveItem:function(e){if("string"!=typeof e)return e==this.getActiveItem().__parent;for(var t=this.getInnerItems(),n=0;n<t.length;n++)if(t[n].__parent.getAppTypeId()==e)return t[n]==this.getActiveItem()}}),f.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Operation,m=n(11).Facade,v={name:"com.servicemax.client.sfmconsole.ui.largemodern.operations"},g=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};v.SignOutUser=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){var n=f.getCurrentApplication(),i=n?n.getCurrentView():null;i&&(i.setViewInfo({hideContextMenu:!0,disableNavMenu:!0}),i.setItems([{xtype:"loadmask",message:g().T("FSA012_TAG005","Exiting..."),transparent:!0}]));var a=f.getClient().getServiceRegistry().getService("com.servicemax.client.cache").getInstance();a&&a.reset();var r=m,o=r.createSignOutRequest();document.hardwareBackHandler&&(document.removeEventListener("backbutton",document.hardwareBackHandler),delete document.hardwareBackHandler),o.execute({})}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){var i=(n(0).utils,n(11).Facade);window.$EXTERNAL=window.$EXTERNAL||{},window.$EXTERNAL.TCPRequest={open:function(e,t,n){var a=i.createTCPRequest(),r={host:e,port:t,operation:"OPEN"};a.bind("REQUEST_COMPLETED",function(e){var t=e.data.data;n(!0,t)},this),a.bind("REQUEST_ERROR",function(e){console.warn("socket open error: "+e.data.data),n(!1)},this),a.execute(r)},write:function(e,t,n){var a=i.createTCPRequest(),r={socketKey:e,operation:"WRITE",data:t};a.bind("REQUEST_COMPLETED",function(){n(!0)},this),a.bind("REQUEST_ERROR",function(i){console.warn(e+": socket write data=> "+t+"; error: "+i.data.data),n(!1)},this),a.execute(r)},read:function(e,t){var n=i.createTCPRequest(),a={socketKey:e,operation:"READ"};n.bind("REQUEST_COMPLETED",function(e){t(!0,e.data.data)},this),n.bind("REQUEST_ERROR",function(n){console.warn(e+": socket read error: "+n.data.data),t(!1)},this),n.execute(a)},close:function(e,t){var n=i.createTCPRequest(),a={socketKey:e,operation:"CLOSE"};n.bind("REQUEST_COMPLETED",function(){t(!0)},this),n.bind("REQUEST_ERROR",function(n){console.warn(e+": socket close error: "+evt.data.data),t(!1)},this),n.execute(a)}}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.ui.modern.themes.orange.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){var e=this.getModule().getResourceUrl("theme-triton-debug.js");f.requireScript(e,function(){},null,this,{ignoreLoadVersion:!0})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){n(734),n(739);var i=n(749),a=n(750),r=n(751),o=n(752);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"sfmeventdelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},views:[{id:"home","class-name":"com.servicemax.client.sfmeventdelivery.ui.largemodern.homeview.HomeView","default-view":!0},{id:"createevent","class-name":"com.servicemax.client.sfmeventdelivery.ui.largemodern.eventview.CreateEventView"}],icon:{"large-css-class":"icon-calendar","small-css-class":"icon-calendar"},controller:{"class-name":"com.servicemax.client.sfmeventdelivery.engine.DeliveryEngineImpl"},discover:!0,multiple:!1,positionWeight:10,"button-text":["FSA001_TAG059","Calendar"]}}),e.exports={impl:i,api:a,HomeView:r,eventview:o}},function(e,t,n){var i=n(735),a=n(736),r=n(737),o=n(738),s=n(0).utils;s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"SFMEVENTDELIVERY.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"sfmeventdelivery","class-name":"com.servicemax.client.sfmeventdelivery.engine.DeliveryEngineImpl"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.extension","config":{"class-name":"com.servicemax.client.sfmeventdelivery.engine.EngineUpdaterExtension","event":"com.servicemax.client.onDataChange"}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMEVENTDELIVERY.GET_EVENT_DATA","command":"com.servicemax.client.sfmeventdelivery.commands.GetData"},{"event":"SFMEVENTDELIVERY.DELETE_EVENT_DATA","command":"com.servicemax.client.sfmeventdelivery.commands.DeleteData"},{"event":"SFMEVENTDELIVERY.UPDATE_EVENT_DATE","command":"com.servicemax.client.sfmeventdelivery.commands.UpdateDate"},{"event":"SFMEVENTDELIVERY.GET_EDITABLE_OBJECTS","command":"com.servicemax.client.sfmeventdelivery.commands.GetEditableObjectNames"},{"event":"SFMEVENTDELIVERY.GET_FIRST_EVENT_PROCESS","command":"com.servicemax.client.sfmeventdelivery.commands.GetFirstEventProcess"},{"event":"SFMEVENTDELIVERY.GET_PRIORITY_COLORS","command":"com.servicemax.client.sfmeventdelivery.commands.GetPriorityColors"},{"event":"SFMEVENTDELIVERY.RETRIEVE_MOBILE_SETTINGS","command":"com.servicemax.client.sfmeventdelivery.commands.RetrieveMobileSettings"},{"event":"SFMEVENTDELIVERY.SAVE_NEW_EVENT","command":"com.servicemax.client.sfmeventdelivery.commands.SaveNewEvent"}]}}}')),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.sfmeventdelivery.impl"};y.Module=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e._logger=m.getLoggingService().getLogger("SFMEVENTDELIVERY-IMPL"),e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){y.init(),y.init(),y.init()}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(v),y.SFMEventDeliveryEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFMEventDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(33).AbstractDeliveryEngine,v=n(0).api,g=n(5).AbstractExtension,y=n(5).SVMXObject,S=n(12).DatetimeUtil,E={name:"com.servicemax.client.sfmeventdelivery.engine"},b=null;E.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=p.getLoggingService().getLogger("SFMEVENTDELIVERY-ENGINE-IMPL"),b=e,e.__root=null,e.__loadMask=null,e.__dataModel=null,e.__eventBus=null,e.__translations=null,e.options=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){var t=p.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("SFMEVENTDELIVERY.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.getEventBus()}})}},{key:"getEventBus",value:function(){return this.__eventBus||(this.__eventBus=p.create("com.servicemax.client.sfmeventdelivery.impl.SFMEventDeliveryEngineEventBus",{})),this.__eventBus}},{key:"getDataModel",value:function(){return this.__dataModel||(this.__dataModel=p.create("com.servicemax.client.sfmeventdelivery.engine.SFMEventModel",this)),this.__dataModel}},{key:"getRoot",value:function(){return this.__root}},{key:"allowSyncPopUp",value:function(){p.getCurrentApplication().getSyncImpl().triggerEvent(new v.Event("EDITMODE_OUT",this,{}))}},{key:"blockSyncPopUp",value:function(){p.getCurrentApplication().getSyncImpl().triggerEvent(new v.Event("EDITMODE_IN",this,{}))}},{key:"regenerate",value:function(){this.__root&&this.__root.destroy(),this.run(this.options)}},{key:"run",value:function(e){this.__logger.info("Running event delivery engine"),this.options=e||{},this.__root=this.__view.createComponent("ROOTCONTAINER",{deliveryEngine:this,dataModel:this.getDataModel()}),null==this.options.onReady&&(this.__root.render(p.getDisplayRootId()),p.getClient().getApplicationParameter("svmx-sfm-no-window-resize")||p.onWindowResize(function(){var e={width:Ext.getBody().getViewSize().width,height:Ext.getBody().getViewSize().height};this.onResize(e)},this),this.__root.setHeight(Ext.getBody().getViewSize().height)),this.refreshData()}},{key:"refreshData",value:function(e){var t=e||{},n=p.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.GET_EVENT_DATA",this,{request:t,responder:p.create("com.servicemax.client.sfmeventdelivery.responders.GetEventDataResponder",this)});this.getEventBus().triggerEvent(n)}},{key:"onGetDataCompleted",value:function(e){this.getDataModel().processData(e);var t=this.getRoot();t&&t.run(),this.options.onReady?this.options.onReady.handler.call(this.options.onReady.context||this):(this.__loadMask.hide(),f(window).trigger("resize"))}},{key:"onResize",value:function(e){this.getRoot().resize(e)}},{key:"appDataHasBeenUpdated",value:function(e){var t=e.changedData;if(t)for(var n=0;n<t.length;n++)if("Event"==t[n].attributes.type||t[n].attributes.type==p.OrgNamespace+"__SVMX_Event__c"){this.refreshData();break}}}]),t}(m),E.EngineUpdaterExtension=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"perform",value:function(e,t){b&&b.appDataHasBeenUpdated(t);var n=new f.Deferred;return n.resolve(),n}}]),t}(g),E.SFMEventModel=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__deliveryEngine=e,n.__eventData=null,n.__taskData=null,n.__userData=null,n.__userInfo=null,n.__recordIdName=null,n.__sfEventFieldAndFieldType=null,n.__svmxEventFieldAndFieldType=null,n.__settings=null,n.__eventModels=[],n.__taskModels=[],n.__userModels=[],n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"processData",value:function(e){this.__eventData=e.events,this.__taskData=e.tasks,this.__userData=e.users,this.__userInfo=e.userinfo,this.__settings=e.settings,this.__recordIdName=e.recordIdName,this.__sfEventFieldAndFieldType=e.sfEventFieldAndFieldType,this.__svmxEventFieldAndFieldType=e.svmxEventFieldAndFieldType,this.__eventModels=[],this.__taskModels=[],this.__userModels=[];for(var t in this.__eventData)this.__eventData[t].EndDateTime&&this.__eventData[t].StartDateTime&&(this.__eventModels[t]=p.create("com.servicemax.client.sfmeventdelivery.engine.SFMEventDetailModel",this,this.__eventData[t]));for(var t in this.__taskData)this.__taskModels[t]=p.create("com.servicemax.client.sfmeventdelivery.engine.SFMEventTaskModel",this,this.__taskData[t]);for(var t in this.__userData)this.__userModels[t]=p.create("com.servicemax.client.sfmeventdelivery.engine.SFMEventUserModel",this,this.__userData[t]);this.__userInfoModel=p.create("com.servicemax.client.sfmeventdelivery.engine.SFMEventUserInfoModel",this,this.__userInfo)}},{key:"getUserInfo",value:function(){return this.__userInfoModel}},{key:"getEvents",value:function(){return this.__eventModels}},{key:"getTasks",value:function(){return this.__taskModels}},{key:"getUsers",value:function(){return this.__userModels}},{key:"getEventById",value:function(e){for(var t in this.__eventModels)if(this.__eventModels[t].getId()==e)return this.__eventModels[t];return null}},{key:"getEventsByUser",value:function(e){var t=[];for(var n in this.__eventModels)this.__eventModels[n].getOwnerId()==e&&t.push(this.__eventModels[n]);return t}},{key:"getTasksByEvent",value:function(e){var t=this.getEventById(e);if(null===t)return[];var n=[];for(var i in this.__taskModels)this.__taskModels[i].getRelatedId()==t.getWhatId()&&n.push(this.__taskModels[i]);return n}},{key:"getRecordIdName",value:function(){return this.__recordIdName}},{key:"getSFEventFieldAndFieldType",value:function(){return this.__sfEventFieldAndFieldType}},{key:"getSVMXEventFieldAndFieldType",value:function(){return this.__svmxEventFieldAndFieldType}},{key:"getSFEventSubjectSetting",value:function(){return this.__settings.sfEventSubjectSetting}},{key:"getSVMXEventSubjectSetting",value:function(){return this.__settings.svmxEventSubjetSetting}}]),t}(y),E.SFMEventDetailModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getId",value:function(){return this.__data.Id}},{key:"getSubject",value:function(){return this.__data.Subject}},{key:"getRelatedName",value:function(){return this.__data.RelatedName}},{key:"getDescription",value:function(){return this.__data.Description}},{key:"getStartDateTime",value:function(){return this.parseDateValue(this.__data.StartDateTime)}},{key:"getEndDateTime",value:function(){return this.parseDateValue(this.__data.EndDateTime)}},{key:"getColor",value:function(){return this.__data.Color}},{key:"getConflict",value:function(){return"conflict"==this.__data.isRecordInConflict}},{key:"parseDateValue",value:function(e){var t=e,n=S;return"string"==typeof e&&(t=n.parseDate(e)),t}},{key:"getWhatId",value:function(){return this.__data.WhatId}},{key:"getOwnerId",value:function(){return this.__data.OwnerId}}]),t}(y),E.SFMEventUserModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getId",value:function(){return this.__data.Id}},{key:"getFirstName",value:function(){return this.__data.FirstName?this.__data.FirstName:""}},{key:"getLastName",value:function(){return this.__data.LastName?this.__data.LastName:""}},{key:"getFullName",value:function(){var e=this.getFirstName();return""!=e&&(e+=" "),e+=this.getLastName()}},{key:"getIsActive",value:function(){return this.getIsSelf()}},{key:"getIsSelf",value:function(){return this.__parent.getUserInfo().getId()==this.getId()}}]),t}(y),E.SFMEventTaskModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getId",value:function(){return this.__data.Id}},{key:"getSubject",value:function(){return this.__data.Task_Description__c}},{key:"getCompleted",value:function(){return this.__data.Task_Completed__c}},{key:"getRelatedId",value:function(){return this.__data.Work_Order__c}}]),t}(y),E.SFMEventUserInfoModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getId",value:function(){return this.__data.UserId}},{key:"getDateFormat",value:function(){return this.__data.DateFormat}},{key:"getTimeFormat",value:function(){return this.__data.TimeFormat}},{key:"getTimezoneOffset",value:function(){return this.__data.TimezoneOffset}}]),t}(y),p.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.sfmeventdelivery.commands"};m.GetData=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.GET_EVENT_DATA"})}}]),t}(p),m.DeleteData=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.DELETE_EVENT_DATA"})}}]),t}(p),m.UpdateDate=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.UPDATE_EVENT_DATE"})}}]),t}(p),m.GetFirstEventProcess=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.GET_FIRST_EVENT_PROCESS"})}}]),t}(p),m.GetEditableObjectNames=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.GET_EDITABLE_OBJECTS"})}}]),t}(p),m.GetPriorityColors=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.GET_PRIORITY_COLORS"})}}]),t}(p),m.RetrieveMobileSettings=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.RETRIEVE_MOBILE_SETTINGS"})}}]),t}(p),m.SaveNewEvent=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMEVENTDELIVERY.SAVE_NEW_EVENT"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.sfmeventdelivery.responders"};m.GetEventDataResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetDataCompleted(e)}}]),t}(p),m.DeleteEventDataResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onDeleteDataCompleted(e)}}]),t}(p),m.UpdateEventDateResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onUpdateDateCompleted()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){(function(t){var i=n(740),a=n(745),r=n(746),o=n(410),s=n(411),l=n(412),c=n(413),u=n(415),d=n(747),_=n(409),h=n(414),f=n(748),p=n(0).utils;p.requireStyleSheet(t+"/resources/css/Ext.ux.TouchCalendarView.css",function(){},null,{}),p.requireStyleSheet(t+"/resources/css/skin1.css",function(){},null,{}),p.requireStyleSheet(t+"/resources/css/Ext.ux.TouchCalendarEvents.css",function(){},null,{}),p.requireStyleSheet(t+"/resources/css/Ext.ux.TouchCalendarSimpleEvents.css",function(){},null,{}),p.requireStyleSheet(t+"/resources/css/app.css",function(){},null,{}),p.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.uitheme","config":{"theme-defs":[{"type":"DEFAULT","path":"./css/Ext.ux.TouchCalendarView.css"},{"type":"CLASSIC","path":"./css/Ext.ux.TouchCalendarView.css"},{"type":"DEFAULT","path":"./css/skin1.css"},{"type":"CLASSIC","path":"./css/skin1.css"},{"type":"DEFAULT","path":"./css/Ext.ux.TouchCalendarEvents.css"},{"type":"CLASSIC","path":"./css/Ext.ux.TouchCalendarEvents.css"},{"type":"DEFAULT","path":"./css/Ext.ux.TouchCalendarSimpleEvents.css"},{"type":"CLASSIC","path":"./css/Ext.ux.TouchCalendarSimpleEvents.css"},{"type":"DEFAULT","path":"./css/app.css"},{"type":"CLASSIC","path":"./css/app.css"}]}}')),e.exports={impl:i,calendar:{carousel:a,view:r,baseevents:o,dayevents:s,monthevents:l,weekevents:c,simpleevents:u,touchevents:d,eventmodel:_,mapevents:h,mapinfobox:f}}}).call(t,"modules/com.servicemax.client.ui.components.largemodern.calendar")},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m=n(409),v=n(410),g=n(411),y=n(412),S=n(413),E=n(414),b=n(415),T={name:"com.servicemax.client.ui.components.largemodern.calendar.impl"};T.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){T.init(),T.init(),m.init(),v.init(),g.init(),y.init(),S.init(),E.init(),b.init(),T.init()}},{key:"afterInitialize",value:function(){}}]),t}(p),T.Module.instance=null,f.defineGlobal(T.name,T),e.exports=T},function(e,t,n){e.exports={default:n(742),__esModule:!0}},function(e,t,n){n(743),e.exports=n(28).Object.values},function(e,t,n){var i=n(34),a=n(744)(!1);i(i.S,"Object",{values:function(e){return a(e)}})},function(e,t,n){var i=n(87),a=n(64),r=n(97).f;e.exports=function(e){return function(t){for(var n,o=a(t),s=i(o),l=s.length,c=0,u=[];l>c;)r.call(o,n=s[c++])&&u.push(e?[n,o[n]]:o[n]);return u}}},function(e,t,n){var i=n(0).utils,a=n(12).DatetimeUtil,r={name:"com.servicemax.client.ui.components.largemodern.calendar.carousel"},o=a;Ext.define("Ext.ux.TouchCalendar",{extend:"Ext.carousel.Carousel",xtype:"calendar",config:{scrollerEvents:null,viewMode:"month",enableSwipeNavigate:!0,enableSimpleEvents:!1,enableEventBars:!1,viewConfig:{},maxWeekDays:7},defaultViewConfig:{viewMode:"MONTH",weekStart:1,bubbleEvents:["selectionchange"]},touchAction:{panX:!1,panY:!0,pinchZoom:!1,doubleTapZoom:!1},indicator:!1,view:null,scrollable:"y",initialize:function(){this.viewConfig=Ext.applyIf(this.viewConfig||{},this.defaultViewConfig),this.viewConfig.currentDate=this.viewConfig.currentDate||this.viewConfig.value||new Date,this.setViewMode(this.viewConfig.viewMode.toUpperCase()),this.initViews(),Ext.apply(this,{cls:"touch-calendar",activeItem:1,direction:"horizontal"}),this.setIndicator(!1),this.setActiveItem(1),this.onSelectionChange&&this.addListener("selectionchange",this.onSelectionChange),this.addListener("activeitemchange",this.onActiveItemChange),this.getEnableSwipeNavigate()?(this.addListener({dragstart:{fn:this.onDragStart,dragThreshold:5,direction:this.direction},drag:{fn:this.onDrag,dragThreshold:5,direction:this.direction},dragend:{fn:this.onDragEnd,dragThreshold:5,direction:this.direction}}),this.element.addCls(this.baseCls+"-"+this.direction)):(this.onDragStart=function(e){return!1},this.onDrag=function(e){return!1},this.onDragEnd=function(e){return!1})},onDragStart:function(e){if(this.eventDragEnabled)return!1;Math.abs(e.deltaY)>Math.abs(e.deltaX)?this.draggingDirection="v":this.draggingDirection="h";try{this.callParent([e])}catch(e){}},onDrag:function(e){if(this.eventDragEnabled)return!1;if("v"==this.draggingDirection)return!1;this.isDragging=!0;try{this.callParent([e])}catch(e){}},onDragEnd:function(e){if(this.eventDragEnabled)return!1;try{this.callParent([e])}catch(e){}},setMaxWeekDays:function(e){this.maxWeekDays=e,this.getItems()&&this.getItems().each(function(e){e.setMaxWeekDays(this.maxWeekDays)},this)},getMaxWeekDays:function(){return this.maxWeekDays},destroy:function(){var e=this,t=e.carouselItems.slice();e.carouselItems.length=0,Ext.destroy(t,e.getIndicator(),e.translatable),e.callParent(),delete e.carouselItems},getViewConfig:function(e){var t=[],n=void 0;return this.getEnableSimpleEvents()?(n=Ext.isObject(this.getEnableSimpleEvents())?this.getEnableSimpleEvents():{},t.push(Ext.create("Ext.ux.TouchCalendarSimpleEvents",n))):this.getEnableEventBars()&&(n=Ext.isObject(this.getEnableEventBars())?this.getEnableEventBars():{},t.push(Ext.create("Ext.ux.TouchCalendarEvents",n))),Ext.apply(this._viewConfig,{plugins:t,currentDate:e,viewMode:this.getViewMode(),maxWeekDays:this.getMaxWeekDays(),onTableHeaderTap:Ext.bind(this.onTableHeaderTap,this),bubbleEvents:["periodchange","eventtap","eventlongpress","selectionchange","timeslotchange","selectionmade","eventdragstart","eventdragend","eventsRendered"]}),this._viewConfig},getViewDate:function(e,t){var n="WEEK"===this.getViewMode()||"MAP"===this.getViewMode()?"DAY":this.getViewMode().toUpperCase(),i="WEEK"===this.getViewMode()?7*t:t;return"DAY"===n?o.addUnitToDateTime(e,i,"days"):Ext.Date.add(e,Ext.Date[n],i)},initViews:function(){var e=Ext.Date.clone(this.viewConfig.currentDate);this.__createViewSet(e)},getCurrentDate:function(){return this.view.getCurrentDate()},setDate:function(e){return this.removeAll(!0,!0),this.__createViewSet(e,!0)},__createViewSet:function(e,t){var n=[],i=t||!1,a=this.getViewDate(e,-1);if(n.push(Ext.create("Ext.ux.TouchCalendarView",Ext.applyIf({currentDate:a},this.getViewConfig(a)))),n.push(Ext.create("Ext.ux.TouchCalendarView",Ext.ux.TouchCalendarView(this.getViewConfig(e)))),a=this.getViewDate(e,1),n.push(Ext.create("Ext.ux.TouchCalendarView",Ext.ux.TouchCalendarView(Ext.applyIf({currentDate:a},this.getViewConfig(a))))),i){for(var r=0;r<n.length;r++)this.add(n[r]);this.view=n[1],this.setActiveItem(1)}else this.setItems(n),this.view=n[1];return this.view},onTableHeaderTap:function(e,t){t=Ext.fly(t),(t.hasCls(this.view.getPrevPeriodCls())||t.hasCls(this.view.getNextPeriodCls()))&&this[t.hasCls(this.view.getPrevPeriodCls())?"previous":"next"]()},applyViewMode:function(e){return e.toUpperCase()},updateViewMode:function(e){this.viewConfig=this.viewConfig||{},this.viewConfig.viewMode=e,this.view&&Ext.each(this.getInnerItems(),function(t,n){t.currentDate=this.getViewDate(Ext.Date.clone(this.view.currentDate),n-1),t.setViewMode(e,!0),t.refresh()},this)},refreshEvents:function(e){var t=this;if(this.view)if("MAP"==this.viewConfig.viewMode)this.view.refreshEvents();else{var n=this.getActiveIndex(),a=this.getActiveItem();a.refreshEvents(),i.doLater(function(){Ext.each(t.getInnerItems(),function(e,t){t!=n&&e.refreshEvents()},t),e&&e()})}},getValue:function(){var e=this.view.getSelected();return e.length>0?e:null},setValue:function(e){this.view.setValue(e)},onActiveItemChange:function(e,t,n){var i=this.getItems(),a=i.indexOf(t),r=i.indexOf(n),o="skip",s=null,l=void 0,c=this;r>-1&&(o=a>r?"forward":"backward","forward"===o?(this.remove(i.get(0)),l=function(){return new Ext.ux.TouchCalendarView(c.getViewConfig(c.getViewDate(t.currentDate,1)))}(),this.add(l),s=i.items[i.indexOf(l)]):(this.remove(i.get(i.getCount()-1)),l=function(){return new Ext.ux.TouchCalendarView(c.getViewConfig(c.getViewDate(t.currentDate,-1)))}(),this.insert(0,l),s=i.items[i.indexOf(l)])),s&&function(){var e=n.getScrollable()?n.getScrollable().position.y:0;s.on({painted:function(){s.getScrollable()&&setTimeout(function(){s.getScrollable()&&(s.getScrollable().scrollTo(0,e,!1),s.getScrollable().refresh())},450)}})}(),this.counter=(this.counter||0)+1,this.view=t,function(){var e=c.view.getPeriodMinMaxDate();c.fireEvent("periodchange",c.view,e.min,e.max,o),c.fireEvent("datechange",c.view)}()}}),i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(0).utils,a=n(12).DatetimeUtil,r=n(7).SystemData,o=n(7).CalendarTranslations,s={name:"com.servicemax.client.ui.components.largemodern.calendar.view"},l=o;Ext.define("Ext.ux.TouchCalendarView",{extend:"Ext.Container",$configStrict:!1,alias:"widget.touchcalendarview",mixins:["Ext.mixin.Responsive"],currentDate:null,config:{viewMode:"month",weekStart:1,todayCls:"today",selectedItemCls:"selected",unselectableCls:"unselectable",prevMonthCls:"prev-month",nextMonthCls:"next-month",weekendCls:"weekend",prevPeriodCls:"goto-prev",nextPeriodCls:"goto-next",dayTimeSlotSize:30,timeSlotDateTpls:{},hideHalfHourTimeSlotLabels:!0,value:null,vents:null,scrollData:null,store:null,baseTpl:['<table class="{[this.me.getViewMode().toLowerCase()]}">',"<thead>","<tr>",'<tpl for="this.getDaysArray(values)">',"<th>","{[this.getDayNameLocalized(values.date)]}","</th>","</tpl>","</tr>","</thead>","<tbody>",'<tr class="time-block-row">','<tpl for=".">','<td class="time-block {[this.getClasses(values)]}" datetime="{[this.me.getDateAttribute(values.date)]}">','<span datetime="{[this.me.getDateAttribute(values.date)]}">{date:this.formatDate()}</span>',"</td>",'<tpl if="this.isEndOfRow(xindex)">',"</tr>",'<tpl if="!this.isEndOfPeriod(xindex)">',"<tr>","</tpl>","</tpl>","</tpl>","</tr>","</tbody>","</table>"],cls:"touch-calendar-view",itemSelector:"td.time-block",maxWeekDays:7},timeSlotDateTplsDefaults_12:{day:'<span class="hour">{date:date("g")}</span><span class="am-pm">{date:date("A")}</span>',month:'{date:date("j")}',week:'<span class="hour">{date:date("g")}</span><span class="am-pm">{date:date("A")}</span>',map:""},timeSlotDateTplsDefaults_24:{day:'<span class="hour">{date:date("H")}:00</span>',month:'{date:date("j")}',week:'<span class="hour">{date:date("H")}:00</span>',map:""},commonTemplateFunctions:{getTimeSlotRowCls:function(e){var t=[];return 0!==e.getMinutes()&&t.push("half-hour"),t.join(" ")},isHalfHour:function(e){return 0!==e.getMinutes()},formatDate:function(e){return this.getTimeSlotDateTpl().apply({date:e})},getTimeSlotDateTpl:function(){var e=this.me.getViewMode().toLowerCase();return this.me.getTimeSlotDateTpls()[e]},getClasses:function(e){var t=[];return e.selected&&t.push(this.me.getSelectedItemCls()),e.unselectable&&t.push(this.me.getUnselectableCls()),e.weekend&&t.push(this.me.getWeekendCls()),e.today&&t.push(this.me.getTodayCls()),t.join(" ")},isEndOfRow:function(e){return e%7==0&&e>0},isStartOfRow:function(e){return(e-1)%7==0&&e-1>=0},isEndOfPeriod:function(e){return e%this.me.periodRowDayCount==0},getDaysArray:function(e){var t=[],n=void 0;for(n=0;n<this.me.periodRowDayCount;n++)t.push(e[n]);return t},getHeaderClass:function(e){return 1===e?this.me.getPrevPeriodCls():7===e?this.me.getNextPeriodCls():""},getDayNameLocalized:function(e,t){return Ext.Date.isDST(e)&&(e=new Date(e.getTime()+36e5)),l.getLocalizedDayName(e)}},setRendered:function(e){return e!==this.rendered&&(this.rendered=e,!!this.items)},destroy:function(){var e=this,t=e.referenceList,n=void 0,i=void 0,a=void 0;for(n=0,i=t.length;n<i;n++)a=t[n],e.hasOwnProperty(a)&&(e[a]&&e[a].destroy(),e[a]=null);if(e.destroyBindable(),this.plugins)for(n=0;n<this.plugins.length;n++){var r=this.plugins[n];r&&r.removeEvents&&r.removeEvents()}var o=e.getScrollable();o&&o.destroy&&o.destroy(),o=null,Ext.ComponentManager.unregister(e)},constructor:function(e){this.initModel();var t=Ext.create("Ext.data.Store",{model:"TouchCalendarViewModel",autoDestroy:!0});this.setStore(t),e.timeSlotDateTpls=e.timeSlotDateTpls||{};var n=a,i=r,o=i.getUserInfo(),s=n.isFormat24HourTime(o.TimeFormat);12==s?Ext.applyIf(e.timeSlotDateTpls,this.timeSlotDateTplsDefaults_12):24==s&&Ext.applyIf(e.timeSlotDateTpls,this.timeSlotDateTplsDefaults_24),Ext.apply(this,e||{}),this.callParent(arguments),this.minDate=this.minDate?Ext.Date.clearTime(this.minDate,!0):null,this.maxDate=this.maxDate?Ext.Date.clearTime(this.maxDate,!0):null},__initialized:!1,initialize:function(){this.element.on({tap:this.onTimeSlotTap,scope:this,delegate:this.getItemSelector()}),this.on({painted:this.syncHeight,resize:this.onComponentResize,scope:this}),this.callParent(),this.__initialized=!0,this.refreshEventsCalenderView()},refreshEventsCalenderView:function(){this.refresh()},reset:function(){this.__needRefresh=!0},refreshEvents:function(){this.reset(),this.refresh()},initModel:function(){Ext.ClassManager.classes.TouchCalendarViewModel||Ext.define("TouchCalendarViewModel",{extend:"Ext.data.Model",fields:[{name:"date",type:"date"},{name:"today",type:"boolean"},{name:"unselectable",type:"boolean"},{name:"selected",type:"boolean"},{name:"prevMonth",type:"boolean"},{name:"nextMonth",type:"boolean"},{name:"weekend",type:"boolean"},{name:"previousDate"},"timeSlots"]})},updateViewMode:function(e,t){if(this.__initialized&&e!==t){this.refresh();var n=this.getPeriodMinMaxDate();this.fireEvent("periodchange",this,n.min,n.max,"none")}},applyViewMode:function(e,t){if(e!==t){e=e.toUpperCase();var n=Ext.ux.TouchCalendarView[e.toUpperCase()];if(this.getStartDate=n.getStartDate,this.getTotalDays=n.getTotalDays,this.dateAttributeFormat=n.dateAttributeFormat,this.getNextIterationDate=n.getNextIterationDate,this.getDeltaDate=n.getDeltaDate,this.periodRowDayCount=n.periodRowDayCount,this.eventFilterFn=n.eventFilterFn,this.getPeriodMinMaxDate=n.getPeriodMinMaxDate,this.isDateInView=n.isDateInView,Ext.apply(this.commonTemplateFunctions,{me:this}),this.setTpl(new Ext.XTemplate((n.tpl||this.getBaseTpl()).join(""),this.commonTemplateFunctions)),this.setScrollable({direction:("DAY"===e.toUpperCase()||"WEEK"===e.toUpperCase())&&"vertical",directionLock:!0,listeners:{click:{element:"el",fn:function(){}}},momentumEasing:{momentum:{acceleration:15,friction:.4},bounce:{acceleration:15,springTension:.3},minVelocity:.3},slotSnapSize:{x:0,y:.5}}),"DAY"===e.toUpperCase()||"WEEK"===e.toUpperCase()){var i=(this.config.scrollData,this.config.scrollerEvents),a=this.getScrollable();i&&(a._fps=10,a.on(i))}return e}},collectData:function(e){var t=[];return Ext.each(e,function(e,n){t.push(e.data)},this),t},populateStore:function(){this.currentDate=this.currentDate||this.value||new Date;var e=!0,t=this.currentDate,n=this.getStartDate(t),i=this.getStartDate(t),a=this.getTotalDays(t),r=!0,o=!1,s=void 0;this.getStore().suspendEvents(),this.getStore().removeAll(),this.__calendarStartDate=i.getTime();for(var l=null,c=0;c<a;c++)"MONTH"!==this.viewMode&&(this._onDST=1==(r&&(Ext.Date.isDST(n)||Ext.Date.isDST(i))&&n.getTimezoneOffset()!=this.getNextIterationDate(i,1).getTimezoneOffset()),this._onDST&&(i=n.getTimezoneOffset()<this.getNextIterationDate(i,1).getTimezoneOffset()?new Date(i.getTime()+36e5):new Date(i.getTime()-36e5),o=!0)),i=this.getNextIterationDate(i,0===c?0:1),e=this.minDate&&i<this.minDate||this.maxDate&&i>this.maxDate,s=Ext.create("TouchCalendarViewModel",{today:this.isSameDay(i,new Date),unselectable:e,selected:this.isSameDay(i,this.value)&&!e,prevMonth:i.getMonth()<t.getMonth(),nextMonth:i.getMonth()>t.getMonth(),weekend:this.isWeekend(i),date:i,previousDate:l||i,onDST:o}),r=1!=this._onDST&&r,l=i,this.getStore().add(s);this.__calendarEndDate=this.getNextIterationDate(i,1).getTime(),this.getStore().resumeEvents()},refreshDelta:function(e){var t=this.currentDate||new Date,n=this.getDeltaDate(t,e);if(!this.isOutsideMinMax(n)){this.setDate(n),this.refresh();var i=this.getPeriodMinMaxDate();this.fireEvent("periodchange",this,i.min,i.max,e>0?"forward":"back")}},getCurrentDate:function(){return this.currentDate},setDate:function(e){return this.checkSetDate(e,this.currentDate)},checkSetDate:function(e,t){return e!==t&&(this.reset(),this.currentDate=e),this},isOutsideMinMax:function(e){return"MONTH"===this.getViewMode()?this.minDate&&Ext.Date.getLastDateOfMonth(e)<this.minDate||this.maxDate&&Ext.Date.getFirstDateOfMonth(e)>this.maxDate:this.minDate&&this.getWeekendDate(e)<this.minDate||this.maxDate&&this.getStartDate(e)>this.maxDate},onTableHeaderTap:function(e,t){t=Ext.fly(t),(t.hasCls(this.getPrevPeriodCls())||t.hasCls(this.getNextPeriodCls()))&&this.refreshDelta(t.hasCls(this.getPrevPeriodCls())?-1:1)},onTimeSlotTap:function(e){if(!e.getTarget("."+this.getUnselectableCls())){var t=Ext.fly(e.getTarget());this.selectCell(t);var n=this.getCellDate(t),i=this.getValue()||this.currentDate;n.getTime()!==i.getTime()&&(this.setValue(n),this.fireEvent("selectionchange",this,n,i)),this.fireEvent("selectionmade",this,n,i)}},onComponentResize:function(e){this.syncHeight()},__needRefresh:!0,refresh:function(e){if(this.__needRefresh){this.populateStore();var t=this.getStore().getRange();this.setData(this.collectData(t)),this.syncHeight(),this.__needRefresh=!1,e&&e.call(this)}},syncHeight:function(){if("DAY"!==this.getViewMode().toUpperCase()&&"WEEK"!==this.getViewMode().toUpperCase()){var e=this.element.select("table",this.element.dom).first();e&&e.setHeight(this.element.getHeight())}},selectCell:function(e){var t=this.getSelectedItemCls(),n=this.element.select("."+t,this.element.dom);n&&n.removeCls(t),e.addCls(t),e.up("tr").addCls(t)},deselectEventBars:function(){},getDateRecord:function(e){return this.getStore().findBy(function(t){return Ext.Date.clearTime(t.get("date"),!0).getTime()===Ext.Date.clearTime(e,!0).getTime()},this)},getDayStartDate:function(e){return e},isSameDay:function(e,t){return!(!e||!t)&&Ext.Date.clearTime(e,!0).getTime()===Ext.Date.clearTime(t,!0).getTime()},isWeekend:function(e){return 0===e.getDay()||6===e.getDay()},getWeekendDate:function(e){var t=e.getDay()-this.getWeekStart();return t=t<0?6:t,new Date(e.getFullYear(),e.getMonth(),e.getDate()+0+t)},getCellDate:function(e){var t=e.dom.getAttribute("datetime");return this.stringToDate(t)},getDateCell:function(e){return this.element.select('td[datetime="'+this.getDateAttribute(e)+'"]',this.element.dom).first()},getDateAttribute:function(e){return Ext.Date.format(e,this.dateAttributeFormat)},getMissingDstSlotValue:function(e,t,n){if(e&&t){var i=a,o=r,s=o.getUserInfo(),l=i.isFormat24HourTime(s.TimeFormat),c="g",u="";"12"==l?(c="g",u=Ext.Date.format(e,"A")):(c="H",u=":00");var d=parseInt(Ext.Date.format(t,c)),_=d+1;_<10&&"12"!=l&&(_="0"+_);return n?'<span class="hour"></span><span class="am-pm"></span>':"12"==l?'<span class="hour">'+_+'</span><span class="am-pm">'+u+"</span>":'<span class="hour">'+_+u+"</span>"}return""},isDSTHourLabel:function(e,t,n){var i=t;return e.getTimezoneOffset()<i.getTimezoneOffset()&&!n},getSelected:function(){var e=this.element.select("td."+this.getSelectedItemCls(),this.element.dom),t=[];return e.each(function(e){t.push(this.getCellDate(e))},this),t},stringToDate:function(e){return Ext.Date.parseDate(e,this.dateAttributeFormat)},applyTimeSlotDateTpls:function(e){return Ext.Object.each(e,function(t,n){Ext.isString&&(e[t]=Ext.create("Ext.XTemplate",n))},this),e},statics:{MONTH:{dateAttributeFormat:"d-m-Y",getNextIterationDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+(0===t?0:1))},getTotalDays:function(e){var t=Ext.Date.getFirstDateOfMonth(e);return this.isWeekend(t)?42:35},eventFilterFn:function(e,t){return e.getTime()<this.__calendarEndDate&&t.getTime()>=this.__calendarStartDate},getPeriodMinMaxDate:function(){return{min:this.getStore().data.first().get("date"),max:this.getStore().data.last().get("date")}},isDateInView:function(e){var t=this.getPeriodMinMaxDate();return e>=t.min&&e<=t.max},getStartDate:function(e){return Ext.bind(Ext.ux.TouchCalendarView.WEEK.getStartDate,this)(new Date(e.getFullYear(),e.getMonth(),1))},getDeltaDate:function(e,t){var n=e.getMonth()+t,i=new Date(e.getFullYear(),n,1);return i.setDate(Ext.Date.getDaysInMonth(i)<e.getDate()?Ext.Date.getDaysInMonth(i):e.getDate()),i},periodRowDayCount:7,maxWeekDays:7},WEEK:{dateAttributeFormat:"H:i",tpl:['<table class="day">',"<tbody>","<tr>",'<td colspan="3">','<table class="time-slot-table">','<tpl for=".">','<tr class="sfmevent-day-timeslots {[this.getTimeSlotRowCls(values.date)]}">','<td class="label">','<tpl if="!this.me.getHideHalfHourTimeSlotLabels() || !this.isHalfHour(values.date)">','<tpl if="this.me.isDSTHourLabel(values.date, values.previousDate, values.onDST)">',"{[this.me.getMissingDstSlotValue(values.date, values.previousDate)]}","<tpl else>","{date:this.formatDate()}","</tpl>","</tpl>","</td>",'<td class="sfmevent-day-timeslots time-block" colspan="2" datetime="{[this.me.getDateAttribute(values.date)]}">',"</td>","</tr>","</tpl>","</table>","</td>","</tr>","</tbody>","</table>"],getNextIterationDate:function(e,t){var n=e.getTime()+(0===t?0:1)*(60*this.getDayTimeSlotSize()*1e3);return new Date(n)},getTotalDays:function(e){return 1440/this.getDayTimeSlotSize()},eventFilterFn:function(e,t){if(5==this.getMaxWeekDays()&&(0==e.getDay()||6==e.getDay()))return!1;var n=new Date(this.__calendarStartDate);n.setDate(n.getDate()+7);var i=n.getTime();return e.getTime()<i&&t.getTime()>=this.__calendarStartDate},getPeriodMinMaxDate:function(){var e=new Date(this.__calendarStartDate);e.setDate(e.getDate()+6);e.getTime();return{min:new Date(this.__calendarStartDate),max:e}},isDateInView:function(e){var t=this.getPeriodMinMaxDate();return e>=t.min&&e<=t.max},getStartDate:function(e){var t=e.getDay()-this.getWeekStart();return t=t<0?6:t,new Date(e.getFullYear(),e.getMonth(),e.getDate()-0-t)},getDeltaDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+7*t)},periodRowDayCount:7,maxWeekDays:7},DAY:{dateAttributeFormat:"d-m-Y H:i",tpl:['<table class="{[this.me.getViewMode().toLowerCase()]}">',"<tbody>","<tr>",'<td colspan="3">','<table class="time-slot-table">','<tpl for=".">','<tr class="sfmevent-day-timeslots {[this.getTimeSlotRowCls(values.date)]}">','<td class="label">','<tpl if="!this.me.getHideHalfHourTimeSlotLabels() || !this.isHalfHour(values.date)">','<tpl if="this.me.isDSTHourLabel(values.date, values.previousDate, values.onDST)">',"{[this.me.getMissingDstSlotValue(values.date, values.previousDate)]}","<tpl else>","{date:this.formatDate()}","</tpl>","</tpl>","</td>",'<td class="sfmevent-day-timeslots time-block" colspan="2" datetime="{[this.me.getDateAttribute(values.date)]}">',"</td>","</tr>","</tpl>","</table>","</td>","</tr>","</tbody>","</table>"],getNextIterationDate:function(e,t){var n=e.getTime()+(0===t?0:1)*(60*this.getDayTimeSlotSize()*1e3);return new Date(n)},getTotalDays:function(e){return 1440/this.getDayTimeSlotSize()},eventFilterFn:function(e,t){return e.getTime()<this.__calendarEndDate&&t.getTime()>=this.__calendarStartDate},getPeriodMinMaxDate:function(){return{min:this.getStore().data.first().get("date"),max:this.getStore().data.last().get("date")}},isDateInView:function(e){return this.getCurrentDate().toDateString()==e.toDateString()},getStartDate:function(e){return Ext.Date.clearTime(e,!0)},getDeltaDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},periodRowDayCount:1,maxWeekDays:7},MAP:{dateAttributeFormat:"d-m-Y",tpl:['<div viewType="map" class="sfmevent-map-container {[this.me.getViewMode().toLowerCase()]}" width="100%" ','style="text-align: center;">',"</div>"],getNextIterationDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+(0===t?0:1))},getTotalDays:function(e){return 1},eventFilterFn:function(e,t){var n=this.getPlugins()[0].getMap();if(!n||!n.carousel)return!1;var i=n.carousel.getInnerItems()?n.carousel.getInnerItems():[],a=i.length>1?i[1].currentDate:null;if(!a)return!1;var r=this.getStartDate(a),o=r.getTime(),s=this.getNextIterationDate(r,1).getTime();return e.getTime()<s&&t.getTime()>=o},getPeriodMinMaxDate:function(){return{min:this.getStore().data.first().get("date"),max:this.getStore().data.last().get("date")}},isDateInView:function(e){return this.getCurrentDate().toDateString()==e.toDateString()},getStartDate:function(e){return Ext.Date.clearTime(e,!0)},getDeltaDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},periodRowDayCount:1,maxWeekDays:7}}}),i.defineGlobal(s.name,s),e.exports=s},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.events"};Ext.define("Ext.ux.TouchCalendarEvents",{extend:"Ext.mixin.Observable",config:{viewModeProcessor:null,eventBarTpl:"{title}",eventBarCls:"event-bar",colourField:"colour",cssClassField:"css",eventHeight:"duration",eventWidth:"auto",startEventField:"start",endEventField:"end",eventWrapperCls:"event-wrapper",eventBarSelectedCls:"event-bar-selected",cellHoverCls:"date-cell-hover",autoUpdateEvent:!0,allowEventDragAndDrop:!0,eventBarSpacing:1,eventWrapperEl:null,longPressedFlag:!1},init:function(e){this.calendar=e,this.calendar.eventsPlugin=this,this.calendar.refreshEvents=Ext.Function.interceptBefore(this.calendar,"refreshEvents",this.resetViewModeProcessor,this),this.calendar.deselectEventBars=Ext.Function.createSequence(this.calendar.deselectEventBars,this.deselectEvents,this),this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this),this.calendar.setViewMode=this.createPreSequence(this.calendar.setViewMode,this.onViewModeUpdate,this),this.onViewModeUpdate(this.calendar.getViewMode())},resetViewModeProcessor:function(){this.getViewModeProcessor().reset()},onComponentResize:function(){var e=this;setTimeout(function(){e.refreshEvents()},200)},createPreSequence:function(e,t,n){return t?function(){return t.apply(n||this,arguments),e.apply(this,arguments)}:e},onViewModeUpdate:function(e){this.setViewModeProcessor(this.createViewModeProcessorIfNeeded(e))},createViewModeProcessorIfNeeded:function(e){var t=this["viewModeProcessor"+e];return t||(t=Ext.create(this.getViewModeProcessorClass(e),{calendar:this.calendar,plugin:this}),this["viewModeProcessor"+e]=t),t},getViewModeProcessorClass:function(e){var t="";switch(e.toLowerCase()){case"month":t="Ext.ux.TouchCalendarMonthEvents";break;case"week":t="Ext.ux.TouchCalendarWeekEvents";break;case"day":t="Ext.ux.TouchCalendarDayEvents";break;case"map":t="Ext.ux.TouchCalendarMapEvents"}return t},refreshEvents:function(){this.calendar.getScrollable()&&this.calendar.getScrollable().scrollTo(0,0),this.removeEvents(),this.getViewModeProcessor().generateEventBars(),this.createEventWrapper(),this.getAllowEventDragAndDrop()&&this.createDroppableRegion()},createDroppableRegion:function(){},onEventDropDeactivate:function(e,t,n,i){if(t.el.hasCls(this.eventBarCls)){var a=this.getEventRecord(t.el.getAttribute("eventID"));this.calendar.element.select("div."+a.internalId,this.calendar.element.dom).each(function(e){e.show()},this)}},onEventDrop:function(e,t,n,i){var a=!1;t.el.hasCls(this.eventBarCls)&&(this.calendar.all.each(function(i){var r=i.getPageBox(!0),o=t.el.getPageBox(!0);if(r.partial(o)&&this.calendar.fireEvent("beforeeventdrop",t,e,s,n)){a=!0;var s=this.getEventRecord(t.el.getAttribute("eventID")),l=this.calendar.getCellDate(i),c=this.getDaysDifference(s.get(this.getStartEventField()),l);this.getAutoUpdateEvent()&&(s.set(this.getStartEventField(),l),s.set(this.getEndEventField(),s.get(this.getEndEventField()).add(Date.DAY,c))),this.refreshEvents(),this.calendar.fireEvent("eventdrop",t,e,s,n)}},this),this.calendar.all.removeCls(this.getCellHoverCls()),a||t.setOffset(t.startOffset,!0))},onEventDragStart:function(e,t){var n=e.el.getAttribute("eventID"),i=this.getEventRecord(n),a=this.getEventBarRecord(n);e.el.setWidth(e.el.getWidth()/a.get("BarLength")),e.updateBoundary(!0),this.calendar.element.select("div."+i.internalId,this.calendar.element.dom).each(function(t){t.dom!==e.el.dom&&t.hide()},this),this.calendar.fireEvent("eventdragstart",e,i,t)},createEventWrapper:function(){if(this.calendar.rendered&&!this.getEventWrapperEl())if("MAP"!==this.calendar.getViewMode()){if(this.setEventWrapperEl(Ext.DomHelper.append(this.getEventsWrapperContainer(),{tag:"div",cls:this.getEventWrapperCls()},!0)),this.getEventWrapperEl().on("tap",this.onEventWrapperTap,this,{delegate:"div."+this.getEventBarCls()}),this.getEventWrapperEl().on("longpress",this.onEventWrapperLongPress,this,{delegate:"div."+this.getEventBarCls()}),this.getViewModeProcessor().eventBarStore)this.getViewModeProcessor().renderEventBars(this.getViewModeProcessor().eventBarStore);else if(this.getCalendar()&&this.getCalendar().getViewMode()){var e=this.getCalendar().getViewMode();if(e&&"week"===e.toLowerCase()){var t=this.getCalendar().getPeriodMinMaxDate();t&&this.getCalendar().fireEvent("eventsRendered",this,t.min,t.max)}}}else this.setEventWrapperEl(Ext.DomHelper.append(this.getMapEventsWrapperContainer(),{tag:"div",cls:this.getEventWrapperCls()},!0));else this.calendar.on("painted",this.createEventWrapper,this)},onEventWrapperTap:function(e,t){if(e.stopPropagation(),this.getLongPressedFlag())return void this.setLongPressedFlag(!1);var n=e.getTarget("div."+this.getEventBarCls());if(n){var i=n.getAttribute("eventID"),a=Ext.fly(n);if(i){var r=this.getEventRecord(i);this.deselectEvents(),a.addCls(this.getEventBarSelectedCls()),this.calendar.fireEvent("eventtap",r,e,this)}}},getCalendar:function(){return this.calendar},onEventWrapperLongPress:function(e,t){e.stopPropagation(),this.setLongPressedFlag(!0);var n=e.getTarget("div."+this.getEventBarCls());if(n){var i=n.getAttribute("eventID"),a=Ext.fly(n);if(i){var r=this.getEventRecord(i);this.deselectEvents(),a.addCls(this.getEventBarSelectedCls()),this.calendar.fireEvent("eventlongpress",r,e,this)}}},getEventsWrapperContainer:function(){return this.calendar.element.select("thead th",this.calendar.element.dom).first()||this.calendar.element.select("tr td",this.calendar.element.dom).first()},getMapEventsWrapperContainer:function(){return this.calendar.element.select("div[viewType=map]",this.calendar.element.dom).first()},getEventRecord:function(e){var t=this.calendar.eventStore.findBy(function(t){return t.internalId==e},this);return this.calendar.eventStore.getAt(t)},getEventBarRecord:function(e){var t=this.eventBarStore.findBy(function(t){return t.get("EventID")===e},this);return this.eventBarStore.getAt(t)},deselectEvents:function(){this.calendar.element.select("."+this.getEventBarSelectedCls(),this.calendar.element.dom).removeCls(this.getEventBarSelectedCls())},getDaysDifference:function(e,t){return e=e.clearTime(!0).getTime(),((t=t.clearTime(!0).getTime())-e)/1e3/60/60/24},removeEvents:function(){var e=this.getViewModeProcessor();e&&(e.clearEventsFromMap&&e.clearEventsFromMap(),e.removeEvents&&e.removeEvents()),this.getEventWrapperEl()&&(this.getEventWrapperEl().dom.innerHTML="",this.getEventWrapperEl().destroy(),this.setEventWrapperEl(null)),this.eventBarStore&&(this.eventBarStore.remove(this.eventBarStore.getRange()),this.eventBarStore=null),this.droppable&&(this.droppable=null)},applyEventBarTpl:function(e){return(Ext.isString(e)||Ext.isArray(e))&&(e=Ext.create("Ext.XTemplate",e)),e}}),Ext.define("Ext.ux.CalendarEventBarModel",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",config:{fields:[{name:"EventID",type:"string"},{name:"Date",type:"date"},{name:"BarLength",type:"int"},{name:"BarPosition",type:"int"},{name:"BarWidth",type:"int"},{name:"Colour",type:"string"},"Record"],hasMany:[{model:"Ext.ux.CalendarEventBarModel",name:"linked"}]}}),Ext.define("Ext.util.Region.partial",{extend:"Ext.util.Region",partial:function(e){var t=this,n=(e.right,e.left,e.bottom,e.top,t.right,t.left,t.bottom,t.top,e.top>t.top&&e.top<t.bottom);return horizontalValid=e.left>t.left&&e.left<t.right,horizontalValid&&n}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.ui.components.largemodern.calendar.map.infobox"};a._initialized=!1,a.initialize=function(){function e(e){e=e||{},google.maps.OverlayView.apply(this,arguments),this.content_=e.content||"",this.disableAutoPan_=e.disableAutoPan||!1,this.maxWidth_=e.maxWidth||0,this.pixelOffset_=e.pixelOffset||new google.maps.Size(0,0),this.position_=e.position||new google.maps.LatLng(0,0),this.zIndex_=e.zIndex||null,this.boxClass_=e.boxClass||"infoBox",this.boxStyle_=e.boxStyle||{},this.closeBoxMargin_=e.closeBoxMargin||"2px",this.closeBoxURL_=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===e.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=e.infoBoxClearance||new google.maps.Size(1,1),void 0===e.visible&&(void 0===e.isHidden?e.visible=!0:e.visible=!e.isHidden),this.isHidden_=!e.visible,this.isOpen_=!1,this.alignBottom_=e.alignBottom||!1,this.pane_=e.pane||"floatPane",this.enableEventPropagation_=e.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}return a._initialized?a.InfoBox:(e.prototype=new google.maps.OverlayView,e.prototype.createInfoBoxDiv_=function(){var e=void 0,t=void 0,n=void 0,i=this,a=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},r=function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault(),i.enableEventPropagation_||a(e)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),void 0===this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(n=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-n.left-n.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],t=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],e=0;e<t.length;e++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,t[e],a));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(e){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",r),google.maps.event.trigger(this,"domready")}},e.prototype.getCloseBoxImg_=function(){var e="";return""!==this.closeBoxURL_&&(e="<img",e+=" src='"+this.closeBoxURL_+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin_+";",e+="'>"),e},e.prototype.addClickHandler_=function(){var e=void 0;""!==this.closeBoxURL_?(e=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(e,"click",this.getCloseClickHandler_())):this.closeListener_=null},e.prototype.getCloseClickHandler_=function(){var e=this;return function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),google.maps.event.trigger(e,"closeclick"),e.close()}},e.prototype.panBox_=function(e){var t=void 0,n=0,i=0;if(!e&&(t=this.getMap())instanceof google.maps.Map){t.getBounds().contains(this.position_)||t.setCenter(this.position_),t.getBounds();var a=t.getDiv(),r=a.offsetWidth,o=a.offsetHeight,s=this.pixelOffset_.width,l=this.pixelOffset_.height,c=this.div_.offsetWidth,u=this.div_.offsetHeight,d=this.infoBoxClearance_.width,_=this.infoBoxClearance_.height,h=this.getProjection().fromLatLngToContainerPixel(this.position_);if(h.x<-s+d?n=h.x+s-d:h.x+c+s+d>r&&(n=h.x+c+s+d-r),this.alignBottom_?h.y<-l+_+u?i=h.y+l-_-u:h.y+l+_>o&&(i=h.y+l+_-o):h.y<-l+_?i=h.y+l-_:h.y+u+l+_>o&&(i=h.y+u+l+_-o),0!==n||0!==i){t.getCenter();t.panBy(n,i)}}},e.prototype.setBoxStyle_=function(){var e=void 0,t=void 0;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",t=this.boxStyle_;for(e in t)t.hasOwnProperty(e)&&(this.div_.style[e]=t[e]);this.div_.style.WebkitTransform="translateZ(0)",void 0!==this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},e.prototype.getBoxWidths_=function(){var e=void 0,t={top:0,bottom:0,left:0,right:0},n=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(e=n.ownerDocument.defaultView.getComputedStyle(n,""))&&(t.top=parseInt(e.borderTopWidth,10)||0,t.bottom=parseInt(e.borderBottomWidth,10)||0,t.left=parseInt(e.borderLeftWidth,10)||0,t.right=parseInt(e.borderRightWidth,10)||0):document.documentElement.currentStyle&&n.currentStyle&&(t.top=parseInt(n.currentStyle.borderTopWidth,10)||0,t.bottom=parseInt(n.currentStyle.borderBottomWidth,10)||0,t.left=parseInt(n.currentStyle.borderLeftWidth,10)||0,t.right=parseInt(n.currentStyle.borderRightWidth,10)||0),t},e.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},e.prototype.draw=function(){this.createInfoBoxDiv_();var e=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=e.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(e.y+this.pixelOffset_.height)+"px":this.div_.style.top=e.y+this.pixelOffset_.height+"px",this.isHidden_?this.div_.style.visibility="hidden":this.div_.style.visibility="visible"},e.prototype.setOptions=function(e){void 0!==e.boxClass&&(this.boxClass_=e.boxClass,this.setBoxStyle_()),void 0!==e.boxStyle&&(this.boxStyle_=e.boxStyle,this.setBoxStyle_()),void 0!==e.content&&this.setContent(e.content),void 0!==e.disableAutoPan&&(this.disableAutoPan_=e.disableAutoPan),void 0!==e.maxWidth&&(this.maxWidth_=e.maxWidth),void 0!==e.pixelOffset&&(this.pixelOffset_=e.pixelOffset),void 0!==e.alignBottom&&(this.alignBottom_=e.alignBottom),void 0!==e.position&&this.setPosition(e.position),void 0!==e.zIndex&&this.setZIndex(e.zIndex),void 0!==e.closeBoxMargin&&(this.closeBoxMargin_=e.closeBoxMargin),void 0!==e.closeBoxURL&&(this.closeBoxURL_=e.closeBoxURL),void 0!==e.infoBoxClearance&&(this.infoBoxClearance_=e.infoBoxClearance),void 0!==e.isHidden&&(this.isHidden_=e.isHidden),void 0!==e.visible&&(this.isHidden_=!e.visible),void 0!==e.enableEventPropagation&&(this.enableEventPropagation_=e.enableEventPropagation),this.div_&&this.draw()},e.prototype.setContent=function(e){this.content_=e,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),void 0===e.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+e:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(e)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",void 0===e.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+e:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(e))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},e.prototype.setPosition=function(e){this.position_=e,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},e.prototype.setZIndex=function(e){this.zIndex_=e,this.div_&&(this.div_.style.zIndex=e),google.maps.event.trigger(this,"zindex_changed")},e.prototype.setVisible=function(e){this.isHidden_=!e,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},e.prototype.getContent=function(){return this.content_},e.prototype.getPosition=function(){return this.position_},e.prototype.getZIndex=function(){return this.zIndex_},e.prototype.getVisible=function(){return void 0!==this.getMap()&&null!==this.getMap()&&!this.isHidden_},e.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},e.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},e.prototype.open=function(e,t){var n=this;this.isOpen_=!0,t&&(this.position_=t.getPosition(),this.moveListener_=google.maps.event.addListener(t,"position_changed",function(){n.setPosition(this.getPosition())}),this._anchor=t,this._anchor_icon=t.getIcon(),t.setIcon("modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/currentpin@1x.png")),this.setMap(e),this.div_&&this.panBox_()},e.prototype.isOpen=function(){return!!this.isOpen_},e.prototype.close=function(){var e=void 0;if(this.isOpen_=!1,this._anchor&&(this._anchor.setIcon(this._anchor_icon),this._anchor=null),this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(e=0;e<this.eventListeners_.length;e++)google.maps.event.removeListener(this.eventListeners_[e]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},e.prototype.getDom=function(){return this.div_||null},a.InfoBox=e,a._initialized=!0,a.InfoBox)},i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.sfmeventdelivery.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){m.init(),m.init(),m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(0).utils,a=n(19).impl.SVMXButton,r=n(19).impl.SVMXVertPanel,o={name:"com.servicemax.client.sfmeventdelivery.ui.largemodern.api"};i.getLoggingService().getLogger("sfmevent-ui");Ext.define(o.name+".WeekDay",{extend:a,alias:"widget.sfmevent.calendar.weekday",config:{flex:1},initConfig:function(e){this.callParent([e])}}),Ext.define(o.name+".CalendarPanel",{extend:r,alias:"widget.sfmevent.calendar.panel",calendar:null,config:{width:"100%",layout:"fit"},initConfig:function(e){e||(e={}),this.callParent([e])},initialize:function(){var e=[],t=this;e.push({xtype:"svmx.verticalpanel",itemId:"calendarHeader",width:"100%",cls:"sfmevent-nav-holder",items:[{xtype:"svmx.horizontalpanel",width:"100%",cls:"sfmevent-nav",items:[{xtype:"svmx.button",itemId:"prevButton",ui:"svmx-default",text:"Left",cls:"sfmevent-nav-prev",handler:function(){t.calendar&&t.calendar.previous&&t.calendar.previous()}},{xtype:"svmx.label",itemId:"dateLabel",ui:"svmx-default",text:"Date",cls:"sfmevent-nav-title"},{xtype:"svmx.button",itemId:"nextButton",ui:"svmx-default",text:"Right",cls:"sfmevent-nav-next",handler:function(){t.calendar&&t.calendar.next&&t.calendar.next()}}]},{xtype:"svmx.horizontalpanel",width:"100%",cls:"sfmevent-week-nav",itemId:"eventWeekNav",hidden:!1,height:"2em",items:[]}]}),this.calendar&&e.push(this.calendar),this.add(e),this.__prev=this.query("#prevButton")[0],this.__next=this.query("#nextButton")[0],this.__title=this.query("#dateLabel")[0],this.__weekDayContainer=this.query("#eventWeekNav")[0],this.__header=this.query("#calendarHeader")[0],this.__weekDayContainer=this.query("#eventWeekNav")[0],this.on("painted",function(e,t,n){this.setAdjustedHeight(this.getParent().el.getHeight())},this)},setPrevNextDisabled:function(e){this.__prev.setDisabled(e),this.__next.setDisabled(e)},setAdjustedHeight:function(e){var t=this.__header.el.getHeight(),n=e-t;this.calendar&&this.calendar.setHeight(n)},setPrevText:function(e){this.__prev&&this.__prev.setHtml(e)},setNextText:function(e){this.__next&&this.__next.setHtml(e)},setDateText:function(e){this.__title&&this.__title.setHtml(e)},setWeekDays:function(e){e&&e.length?(e.unshift({xtype:"svmx.spacer",ui:"svmx-default",cls:"sfmevent-week-nav-spacer",width:"45px"}),this.__weekDayContainer.setItems(e),this.__weekDayContainer.setHidden(!1)):(this.__weekDayContainer.setItems([]),this.__weekDayContainer.setHidden(!0))}}),i.defineGlobal(o.name,o),e.exports=o},function(e,t,n){var i=n(176),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10),o=n(0).utils,s=n(12).DatetimeUtil,l=n(22).View,c=n(7).CalendarTranslations,u={name:"com.servicemax.client.sfmeventdelivery.ui.largemodern.homeview"},d=function(){return o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},_=o.getLoggingService().getLogger("sfmevent-ui");Ext.define(u.name+".HomeView",{extend:l,alias:"widget.sfm.event.day",__calendar:null,__selectedEvent:null,__selectedDate:null,__state:null,__centerItem:null,__createProcessId:null,__editableEventObjects:[],__editTapped:!1,__activeTab:null,__disableScrollDrag:null,__isPassiveListener:null,initialize:function(){this.callParent();var e=this;this.__disableScrollDrag=!0,this.__calendar={cards:null,month:{carousel:null,container:null,timer:null},week:{carousel:null,container:null,timer:{clock:null,refresh:null,scrollData:null,marker:null,markerTime:null,type:"Week"}},day:{carousel:null,container:null,timer:{clock:null,refresh:null,scrollData:null,marker:null,markerTime:null,type:"Day"}},map:{carousel:null,container:null,timer:null,api:null,markers:[],directions:null,lastDate:null}},this.enableBubble("transientState"),this.__selectedDate=new Date,this.__state="",window.cordova&&null===this.__isPassiveListener&&this.__isBrowserSupportPassiveListener(),window.notifyMapLoaded=function(){e.__calendar.map.carousel.refreshEvents(),o.getCurrentApplication().hideSpinner()}},__disablePassiveListener:function(e){var t=this;e.addEventListener("touchmove",o.proxy(this,function(e){t.__disableScrollDrag||e.preventDefault()}),!!this.__isPassiveListener&&{passive:!1})},__isBrowserSupportPassiveListener:function(){var e=this;e.__isPassiveListener=!1;try{var t=(0,a.default)({},"passive",{get:function(){e.__isPassiveListener=!0}},e);window.addEventListener("SVMXPassiveTest",null,t),window.removeEventListener("SVMXPassiveTest",null,t)}catch(e){}},checkConnectivity:function(e){var t=o.Deferred();return this.__syncManager.checkConnectivity({delay:e}).done(o.proxy(this,function(){t.resolve()})).fail(o.proxy(this,function(){t.reject()})),t.promise()},restore:function(e){if(e&&e.data&&e.data.refreshEvents)this.onUpdateDateCompleted();else{var t=this;setTimeout(function(){t.restoreConsoleHeader()},100)}},restoreConsoleHeader:function(){var e=this,t=void 0,n=void 0,i=Ext.ComponentQuery.query("#periodButtons");0==i.length||1==i[0].getItems().destroyed?(e.__centerItem=this.buildConsoleHeader(e.__createProcessId),t=e.__calendar.cards.getActiveItem(),n=e.__calendar.cards.items.indexOf(t),e.__centerItem&&e.__centerItem.updatePressedButtons([]),e.__centerItem&&e.__centerItem.updatePressedButtons(n)):(e.__centerItem=i[0],e.__calendar.cards&&(t=e.__calendar.cards.getActiveItem(),n=e.__calendar.cards.items.indexOf(t),e.__centerItem&&e.__centerItem.updatePressedButtons([]),e.__centerItem&&e.__centerItem.updatePressedButtons(n)))},updateStateConfig:function(e){return e},updateOptions:function(e){var t=this,n=o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=n.getInstance(),this._eventDelay=1e3*o.getClient().getApplicationParameter("svmx-sfmevent-marker-timeout"),this.__getEditableEventObjects().then(o.proxy(this,function(e){return this.__editableEventObjects=e||[],this.__getCreateProcess()})).then(function(e){return t.__createProcessId=e,t.__centerItem=t.buildConsoleHeader(t.__createProcessId),t.__getPriorityColors()}).then(function(e){t.__priorityColors=e})},buildConsoleHeader:function(e){var t=this;return t.setViewInfo({leftItem:{xtype:"svmx.button",itemId:"todayButton",text:d().T("FSA001_TAG054","Today"),handler:function(){t.__handleTodayTap()}},centerItem:t.__getCenterItem(),rightItem:{xtype:"svmx.button",itemId:"newEventButton",text:d().T("FSA001_TAG058","+ New"),disabled:!e,handler:o.proxy(t,function(e){t.__handleNewEventTap(e)},e)},backText:d().T("FSA001_TAG059","Calendar")}),Ext.ComponentQuery.query("#periodButtons")[0]},__getCenterItem:function(){var e=this.__activeTab||"day";this.__activeTab=e;var t=this;return{xtype:"svmx.buttonset",itemId:"periodButtons",cls:"sfmevent-nav-selector",allowMultiple:!1,items:[{text:d().T("FSA001_TAG055","Day"),cls:"sfmevent-nav-selector-button",pressed:"day"===e,handler:function(){t.__handleDatePickerTap("day")}},{text:d().T("FSA001_TAG056","Week"),cls:"sfmevent-nav-selector-button",pressed:"week"===e,handler:function(){t.__handleDatePickerTap("week")}},{text:d().T("FSA001_TAG057","Month"),cls:"sfmevent-nav-selector-button",pressed:"month"===e,handler:function(){t.__handleDatePickerTap("month")}},{text:d().T("FSA001_TAG001","Map"),cls:"sfmevent-nav-selector-button",pressed:"map"===e,handler:function(){t.__handleDatePickerTap("map")}}]}},ready:function(){var e=this,t=this.__getCalendarData(),n=o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=n.getInstance(),this.__calendar.day.carousel?(this.__clearCalendarData(),this.__updateCalendarData(t),this.__refreshCalendar(function(){"day"===e.__activeTab&&e.__calendar.day.timer&&e.__calendar.day.carousel.view.isDateInView(new Date)&&(e.__stopWeekViewTimeMarker(),e.__startCurrentTimeMarker({load:!0,interval:1,view:e.__calendar.day.carousel.view,timer:e.__calendar.day.timer})),"week"===e.__activeTab&&e.__calendar.week.timer&&(e.__stopDayViewTimeMarker(),e.__startCurrentTimeMarker({load:!0,interval:1,view:e.__calendar.week.carousel.view,timer:e.__calendar.week.timer}))})):(this.__buildTouchCalendar(),this.__updateCalendarData(t),this.__bindTouchCalendarEvents().done(function(){e.__startCurrentTimeMarker({load:!0,interval:450,view:e.__calendar.day.carousel.view,timer:e.__calendar.day.timer}),e.__startCurrentTimeMarker({load:!0,interval:450,view:e.__calendar.week.carousel.view,timer:e.__calendar.week.timer})}),this.__refreshCalendar(function(){e.__updateScroller({view:e.__calendar.day.carousel.view,timer:e.__calendar.day.timer}),e.__updateScroller({view:e.__calendar.week.carousel.view,timer:e.__calendar.week.timer})})),e.unblockApplication()},__getCreateProcess:function(){var e=o.Deferred(),t=this.getDeliveryEngine().getEventBus(),n=o.create("com.servicemax.client.sfmconsole.utils.EventCollection",t,[]);return n.addEvent(o.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.GET_FIRST_EVENT_PROCESS",this,{request:{}})),n.triggerAll(o.proxy(this,function(t){var n=t.items(),i=null;o.array.forEach(n,function(e){switch(e.type()){case"SFMEVENTDELIVERY.GET_FIRST_EVENT_PROCESS":e.response=e.response||{},e.response.data&&e.response.data.length>0&&e.response.data[0].process_unique_id&&(i=e.response.data[0].process_unique_id)}},this),e.resolve(i)})),e.promise()},__getPriorityColors:function(){var e=o.Deferred(),t=this.getDeliveryEngine().getEventBus(),n=o.create("com.servicemax.client.sfmconsole.utils.EventCollection",t,[]);return n.addEvent(o.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.GET_PRIORITY_COLORS",this,{request:{}})),n.triggerAll(o.proxy(this,function(t){var n=t.items(),i={High:"#F75D59",Medium:"#ADDFF",Low:"#C9BE62",Other:"#4E8975"};o.array.forEach(n,function(e){switch(e.type()){case"SFMEVENTDELIVERY.GET_PRIORITY_COLORS":e.response=e.response||{},e.response&&(i=e.response)}},this),e.resolve(i)})),e.promise()},__getEditableEventObjects:function(){var e=o.Deferred(),t=this.getDeliveryEngine().getEventBus(),n=o.create("com.servicemax.client.sfmconsole.utils.EventCollection",t,[]);return n.addEvent(o.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.GET_EDITABLE_OBJECTS",this,{request:{}})),n.triggerAll(o.proxy(this,function(t){var n=t.items(),i=[];o.array.forEach(n,function(e){switch(e.type()){case"SFMEVENTDELIVERY.GET_EDITABLE_OBJECTS":i=e.response||[]}},this),e.resolve(i)})),e.promise()},__removeCurrentTimeMarker:function(e,t){var n=t.marker,i=t.markerTime;n&&n.remove(),i&&i.remove()},__showCurrentTimeMarker:function(e,t,n){var i=void 0,a=void 0,o=void 0,l=n.marker,c=n.markerTime,u=0;l||(l=document.createElement("div"),l.className="sfmevent-today-time"),c||(c=document.createElement("div"),c.className="sfmevent-today-time-disp");var d=s.getDefaultTimeFormat(),_=s.getFormattedDatetime(e,d);c.innerHTML=_,i=e.getHours(),a=e.getMinutes(),o=r(t.element.dom).find("table.day"),o.parent().prepend(l),o.parent().prepend(c);var h=o.height(),f=h/24,p=f/60,m=i*f+p*a;u=m-2*f,l.style.top=m+"px",n.marker=l,c.style.top=m+10+"px",n.markerTime=c;var v=t.getScrollable().getMaxPosition(),g=h/v.y||0;return{maxScroll:v.y,scroll:u/g||0,view:u,maxView:h}},__showRecord:function(e){var t=this,n=o.Deferred(),i=e.what_id||e.event_id,a=o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.sfmsearch.platformspecifics");return this.__state="show",a.showRecord({key:i}),setTimeout(function(){t.__calendar.day.carousel.view.deselectEventBars(),n.resolve()},500),n},__bindTouchCalendarEvents:function(){var e=o.Deferred();return this.bind(this.__syncManager,"SYNC_STOPPED",this.__handleSyncCompleteEvent,this),this.__bindDayViewEvents().then(o.proxy(this,this.__bindWeekViewEvents)).then(o.proxy(this,this.__bindMonthViewEvents)).then(o.proxy(this,this.__bindMapViewEvents)).done(function(){e.resolve()}),e},__bindWeekViewEvents:function(){var e=o.Deferred(),t=this,n=this.__calendar.week.carousel,i=null;return n.on("resize",function(e,n){var i=t.__calendar.week.carousel.getActiveItem(),a=i.getPeriodMinMaxDate();t.__calendar.week.container.setWeekDays(t.__formatDateForWeekDays(a.min)),t.__calendar.week.carousel.refreshEvents(function(){t.__updateScroller({view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer}),t.__updateScroller({view:t.__calendar.week.carousel.view,timer:t.__calendar.week.timer})})},this,{buffer:100}),n.on("periodchange",function(e,n,i,a){t.__stopCurrentTimeMarker(t.__calendar.week.timer),t.__calendar.week.container.setDateText(t.__formatDateForWeekTitle(n,i)),t.__calendar.week.container.setPrevText(t.__formatDateForPrevNextWeek(n,i,"prev")),t.__calendar.week.container.setNextText(t.__formatDateForPrevNextWeek(n,i,"next")),t.__calendar.week.container.setWeekDays(t.__formatDateForWeekDays(n))}),n.on("eventsRendered",function(e,n,i){var a=new Date;a>=n&&a<=i&&(t.__stopCurrentTimeMarker(t.__calendar.week.timer),t.__startCurrentTimeMarker({load:!0,interval:1,view:t.__calendar.week.carousel.view,timer:t.__calendar.week.timer}))}),n.on("eventlongpress",function(e,n,a){console.log("weekcalendar eventlongpress");var r=Ext.get(n.currentTarget),o=Ext.get(r.query("div[class~=sfmevent-icon-edit-weekview]")[0]);o.removeCls("sfmevent-icon-edit-hidden");var s=Ext.get(r.query("div[class~=to-hide-icon ]"));if(s&&s.length>0)for(var l=0;l<s.length;l++)s[l].addCls("sfmevent-icon-edit-hidden");a&&(i&&clearTimeout(i),i=setTimeout(function(){if(o.addCls("sfmevent-icon-edit-hidden"),s&&s.length>0)for(var e=0;e<s.length;e++)s[e].removeCls("sfmevent-icon-edit-hidden");t.__calendar.week.carousel.view.deselectEventBars(),i=null},2e3))}),n.on("eventtap",function(e,n,i){console.log("weekcalendar eventtap");var a=Ext.get(n.target),r=a.hasCls("sfmevent-icon-edit-weekview");if(!t.__editTapped)if(t.__editTapped=!0,r)t.__handleEditDialog(t,e).then(o.proxy(t,function(){this.__editTapped=!1})),t.__calendar.week.carousel.view.deselectEventBars();else{t.__selectedEvent=e;var s=e.raw;t.__showRecord(s).then(o.proxy(t,function(){this.__editTapped=!1}))}}),e.resolve(),e},__bindMonthViewEvents:function(){var e=o.Deferred(),t=this,n=this.__calendar.month.carousel;return n.on("resize",function(e,n){t.__calendar.month.carousel.refreshEvents(function(){t.__updateScroller({view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer}),t.__updateScroller({view:t.__calendar.week.carousel.view,timer:t.__calendar.week.timer})})},this,{buffer:100}),n.on("datechange",function(e){t.__calendar.month.container.setDateText(t.__formatDateForMonthTitle(e.currentDate)),t.__calendar.month.container.setPrevText(t.__formatDateForPrevNextMonth(e.currentDate,"prev")),t.__calendar.month.container.setNextText(t.__formatDateForPrevNextMonth(e.currentDate,"next")),t.__calendar.month.container.setWeekDays([])}),n.on("eventtap",function(e,t,n){this.fireEvent("selectionmade",this,e.data.start)}),e.resolve(),e},__bindMapViewEvents:function(){var e=o.Deferred(),t=this,n=this.__calendar.map.carousel;return this.onAfter("resize",function(e,t){var n=this.__calendar.cards.getActiveItem();3==this.__calendar.cards.items.indexOf(n)&&window.iFrameEventCallBack&&(window.iFrameEventCallBack({method:"resize"}),window.iFrameEventCallBack({method:"changeBounds"}))},this,{buffer:100}),n.on("resize",function(e,n){t.__calendar.map.carousel.refreshEvents(function(){t.__updateScroller({view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer}),t.__updateScroller({view:t.__calendar.week.carousel.view,timer:t.__calendar.week.timer})})},this,{buffer:100}),n.on("datechange",function(e){t.__selectedDate=e.currentDate,t.__calendar.map.container.setDateText(t.__formatDateForDayTitle(e.currentDate)),t.__calendar.map.container.setPrevText(t.__formatDateForPrevNextDay(e.currentDate,"prev")),t.__calendar.map.container.setNextText(t.__formatDateForPrevNextDay(e.currentDate,"next")),t.__calendar.map.container.setWeekDays([]);var n=t.__calendar.cards.getActiveItem();3==t.__calendar.cards.items.indexOf(n)&&t.__calendar.map.carousel.refreshEvents()}),n.on("eventtap",function(e,n,i){if(!t.__editTapped){t.__editTapped=!0,t.__selectedEvent=e;var a=e.raw;t.__showRecord(a).then(o.proxy(t,function(){this.__editTapped=!1}))}}),e.resolve(),e},__getMap:function(){return this.__calendar.map},__bindDayViewEvents:function(){var e=o.Deferred(),t=this,n=this.__calendar.day.carousel,i=null;return window.cordova&&this.__isPassiveListener&&this.__calendar.day&&this.__calendar.day.container.el&&this.__calendar.day.container.el.dom&&t.__disablePassiveListener(this.__calendar.day.container.el.dom),n.on("resize",function(e,n){t.__calendar.day.carousel.refreshEvents(function(){t.__updateScroller({view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer}),t.__updateScroller({view:t.__calendar.week.carousel.view,timer:t.__calendar.week.timers})})},this,{buffer:100}),n.on("datechange",function(e){t.__stopCurrentTimeMarker(t.__calendar.day.timer),t.__selectedDate=e.currentDate,t.__calendar.day.container.setDateText(t.__formatDateForDayTitle(e.currentDate)),t.__calendar.day.container.setPrevText(t.__formatDateForPrevNextDay(e.currentDate,"prev")),t.__calendar.day.container.setNextText(t.__formatDateForPrevNextDay(e.currentDate,"next")),t.__calendar.day.container.setWeekDays([]),e.currentDate.toDateString()==(new Date).toDateString()&&"day"===t.__activeTab&&t.__startCurrentTimeMarker({load:!0,interval:1,view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer}).done(function(){var e={x:0,y:t.__calendar.day.timer.scrollData.setvalue};n.fireEvent("timeslotchange",e)})}),n.on("timeslotchange",function(e){for(var n=this.getItems().items,i=this.getItems().items.length,a=0;a<i;a++){var r=n[a];if(r.getId()!=this.view.getId()){var o=r.getScrollable();t.__calendar.day.timer.scrollData.setvalue=e.y,o.scrollTo(0,e.y,!1),o=null}}}),n.on("eventlongpress",function(e,n,a){console.log("eventlongpress"),t.__disableScrollDrag=!1,t.__calendar.day.carousel.setTouchAction({panY:!1});var r=Ext.get(n.currentTarget);Ext.get(r.query("div[class~=sfmevent-icon-edit]")[0]).removeCls("sfmevent-icon-edit-hidden"),a&&(i&&clearTimeout(i),i=setTimeout(function(){t.__deselectDayEvent(r),t.__calendar.day.carousel.setTouchAction({panY:!0}),t.__disableScrollDrag=!0,i=null},2e3))}),n.on("eventtap",function(e,n,i){console.log("eventtap");var a=Ext.get(n.target),r=a.hasCls("sfmevent-icon-edit");if(!t.__editTapped)if(t.__editTapped=!0,r)t.__handleEditDialog(t,e).then(o.proxy(t,function(){this.__editTapped=!1})),t.__calendar.day.carousel.view.deselectEventBars();else{t.__selectedEvent=e;var s=e.raw;t.__showRecord(s).then(o.proxy(t,function(){this.__editTapped=!1}))}}),n.onBefore("eventdragstart",function(e,n){if(t.__disableScrollDrag=!1,e.get("duration")>=1440||e.get("multiDayEvent")){n.setDisabled(!0),console.log("Disable dragging for multi day event!!!");var a=d().T("FSA001_TAG004","Cannot drag multi-day event. Reschedule below.");return t.__handleEditDialog(t,e,null,null,a),void t.__calendar.day.carousel.setTouchAction({panY:!0})}i&&(clearTimeout(i),i=null)}),n.on("eventdragend",function(e,n,i){if(t.__disableScrollDrag=!0,t.__deselectDayEvent(i.getElement()),0!==n){var a=e.raw,r={};r.orignalStartDate=s.manipulateDatetime(a.orignalStartDate,"minutes",n),r.orignalEndDate=s.manipulateDatetime(a.orignalEndDate,"minutes",n),t.__handleEditDialog(t,e,r,i),t.__calendar.day.carousel.setTouchAction({panY:!0})}}),n.on("eventdragstart",function(e,t,n){console.log("eventdragstart")}),n.on("beforeeventdrop",function(e,t,n){return console.log("beforeeventdrop"),!0}),n.on("eventdrop",function(e,t,n){console.log("eventdrop")}),n.on("eventdrag",function(e,t,n){console.log("eventdrag")}),e.resolve(),e},__deselectDayEvent:function(e){var t=this;Ext.get(e.query("div[class~=sfmevent-icon-edit]")[0]).addCls("sfmevent-icon-edit-hidden"),t.__calendar.day.carousel.view.deselectEventBars()},__getMonthEventTpl:function(){var e=d().T("FSA001_TAG005","No Subject");return new Ext.XTemplate('<li class="sfmevent-month {[values.moreCount != undefined ? \'sfmevent-more\' : \'\']}"><span><tpl if="woName && account">{account:htmlEncode}</tpl><tpl if="woName && !account">{subject:htmlEncode}</tpl><tpl if="!woName && subject">{subject:htmlEncode}</tpl><tpl if="!woName && !subject && !moreCount">'+e+'</tpl><tpl if="moreCount !== undefined">{[this.getMoreText(values.moreCount)]}</tpl></span></li>',{getMoreText:function(e){return o.string.substitute(d().T("FSA001_TAG006","{{moreCount}} More..."),{moreCount:e})}})},__getMapEventTpl:function(){return"<div><div>WO: {woName}</div><div>Street: {address.street}</div><div>City: {address.city}</div><div>State: {address.state}</div><div>Zipcode: {address.zipcode}</div><div>Country: {address.country}</div></div>"},__getDayEventTpl:function(){var e=d().T("FSA001_TAG055","Day"),t=this;return new Ext.XTemplate('<div class="sfmevent-day"><div class="sfmevent-colorbar sfmevent-colorbar-{priority}" style="background-color:{[this.priorityColor(values.priority)]};"><tpl if="isRecordInConflict == true"><div class="sfmevent-icon-conflict"></div></tpl><tpl if="hasSLA == true"><div class="sfmevent-icon-sla"></div></tpl><div class="sfmevent-icon-{priority}"></div></div><div class="sfmevent-content"><div class="sfmevent-location-container"><tpl if="multiDayEvent == true"><div class="sfmevent-day-indicator">'+e+' {multiDayEventIndex}</div></tpl><tpl if="!techSubject"><tpl if="woName && account && location"><div class="sfmevent-title">{woName:htmlEncode}</div><div class="sfmevent-account sfmevent-day-subtitle">{account:htmlEncode}</div><div class="sfmevent-location sfmevent-day-subject">{location:htmlEncode}</div></tpl><tpl if="woName && account && !location"><div class="sfmevent-title">{woName:htmlEncode}</div><div class="sfmevent-account sfmevent-day-subtitle sfmevent-subject-top-border">{account:htmlEncode}</div><div class="sfmevent-subject-container sfmevent-day-subject {[values.duration <= 60 ? \'sfmevent-short-duration\' : \'sfmevent-long-duration\']}"><tpl for="subject.split(\';\')">{.}<br></tpl></div></tpl><tpl if="woName && !account && location"><div class="sfmevent-title">{woName:htmlEncode}</div><div class="sfmevent-location sfmevent-day-subtitle sfmevent-subject-top-border">{location:htmlEncode}</div><div class="sfmevent-subject-container sfmevent-day-subject {[values.duration <= 60 ? \'sfmevent-short-duration\' : \'sfmevent-long-duration\']}"><tpl for="subject.split(\';\')">{.}<br></tpl></div></tpl><tpl if="woName && !account && !location"><div class="sfmevent-title sfmevent-subject-top-border">{woName:htmlEncode}</div><div class="sfmevent-subject-container sfmevent-day-subtitle {[values.duration <= 60 ? \'sfmevent-short-duration\' : \'sfmevent-long-duration\']}"><tpl for="subject.split(\';\')">{.}<br></tpl></div></tpl><tpl if="!woName"><div class="sfmevent-non-wo-title">{subject:htmlEncode}</div></tpl></tpl><tpl if="techSubject"><div class="sfmevent-techSubject" style="white-space: pre-line;">{techSubject:htmlEncode}</div></tpl></div><tpl if="this.canEdit(eventObject)"><div class="sfmevent-icon-edit sfmevent-icon-edit-hidden"></div></tpl></div></div>',{canEdit:function(e){return!0},priorityColor:function(e){var n=t.__priorityColors.Other;switch(e){case"High":n=t.__priorityColors.High;break;case"Medium":n=t.__priorityColors.Medium;break;case"Low":n=t.__priorityColors.Low}return n}})},__getWeekEventTpl:function(){var e=d().T("FSA001_TAG055","Day"),t=this;return new Ext.XTemplate('<div class="sfmevent-week"><div class="sfmevent-colorbar sfmevent-colorbar-{priority}" style="background-color:{[this.priorityColor(values.priority)]};"></div><div class="sfmevent-content"><div class="sfmevent-location-container"><tpl if="multiDayEvent == true"><div class="sfmevent-day-indicator">'+e+' {multiDayEventIndex}</div></tpl><tpl if="!techSubject"><tpl if="woName && account && location"><div class="sfmevent-title">{woName:htmlEncode}</div><div class="sfmevent-account sfmevent-week-subtitle ">{account:htmlEncode}</div><div class="sfmevent-location sfmevent-week-subject">{location:htmlEncode}</div></tpl><tpl if="woName && account && !location"><div class="sfmevent-title">{woName:htmlEncode}</div><div class="sfmevent-account sfmevent-week-subtitle sfmevent-subject-top-border">{account:htmlEncode}</div><div class="sfmevent-subject-container sfmevent-week-subject {[values.duration <= 60 ? \'sfmevent-short-duration\' : \'sfmevent-long-duration\']}"><tpl for="subject.split(\';\')">{.}<br></tpl></div></tpl><tpl if="woName && !account && location"><div class="sfmevent-title">{woName:htmlEncode}</div><div class="sfmevent-location sfmevent-week-subtitle sfmevent-subject-top-border">{location:htmlEncode}</div><div class="sfmevent-subject-container sfmevent-week-subject {[values.duration <= 60 ? \'sfmevent-short-duration\' : \'sfmevent-long-duration\']}"><tpl for="subject.split(\';\')">{.}<br></tpl></div></tpl><tpl if="woName && !account && !location"><div class="sfmevent-title sfmevent-subject-top-border">{woName:htmlEncode}</div><div class="sfmevent-subject-container sfmevent-week-subject {[values.duration <= 60 ? \'sfmevent-short-duration\' : \'sfmevent-long-duration\']}"><tpl for="subject.split(\';\')">{.}<br></tpl></div></tpl><tpl if="!woName"><div class="sfmevent-non-wo-title">{subject:htmlEncode}</div></tpl></tpl><tpl if="techSubject"><div class="sfmevent-techSubject" style="white-space: pre-line;">{techSubject:htmlEncode}</div></tpl><div class="sfmevent-icon-edit-weekview sfmevent-icon-edit-hidden"></div></div></div></div>',{canEdit:function(e){return!0},priorityColor:function(e){var n=t.__priorityColors.Other;switch(e){case"High":n=t.__priorityColors.High;break;case"Medium":n=t.__priorityColors.Medium;break;case"Low":n=t.__priorityColors.Low}return n}})},__buildTouchCalendar:function(){var e=this,t=new Date;e.calendarStore=this.__buildCalendarEventStore();var n={store:e.calendarStore,date:t};this.__calendar.day.carousel=this.__createCalendarDayView(n),n={store:e.calendarStore,plugins:[Ext.create("Ext.ux.TouchCalendarSimpleEvents")],date:t},this.__calendar.month.carousel=this.__createCalendarMonthView(n),n={store:e.calendarStore,plugins:[Ext.create("Ext.ux.TouchCalendarSimpleEvents")],date:t},this.__calendar.week.carousel=this.__createCalendarWeekView(n),n={store:e.calendarStore,date:t},this.__calendar.map.carousel=this.__createCalendarMapView(n),n={monthview:this.__calendar.month.carousel,dayview:this.__calendar.day.carousel,weekview:this.__calendar.week.carousel,mapview:this.__calendar.map.carousel,listeners:{}};var i=this.__buildCalendarContainer(n);this.__calendar.cards=i,this.add(i)},__buildCalendarContainer:function(e){var t=this.el.getHeight();this.__dailyCalendar={cls:"sfmevent-view-daily",itemId:"dailyCalendar",calendar:e.dayview},this.__weeklyCalendar={cls:"sfmevent-view-weekly",itemId:"weeklyCalendar",calendar:e.weekview},this.__monthlyCalendar={cls:"sfmevent-view-monthly",itemId:"monthlyCalendar",calendar:e.monthview},this.__mapCalendar={cls:"sfmevent-view-map",itemId:"mapCalendar",calendar:e.mapview};var n=Ext.create("com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",{cls:"sfmevent-calendar",width:"100%",height:"100%",layout:"card",listeners:{},defaults:{xtype:"sfmevent.calendar.panel",width:"100%",height:t},items:[this.__dailyCalendar,this.__weeklyCalendar,this.__monthlyCalendar,this.__mapCalendar]});n.setActiveItem(0),this.__calendar.day.container=n.query("#dailyCalendar")[0],this.__calendar.week.container=n.query("#weeklyCalendar")[0],this.__calendar.month.container=n.query("#monthlyCalendar")[0],this.__calendar.map.container=n.query("#mapCalendar")[0];var i=e.weekview.view.getPeriodMinMaxDate();return this.__calendar.day.container.setDateText(this.__formatDateForDayTitle(e.dayview.value)),this.__calendar.week.container.setDateText(this.__formatDateForWeekTitle(i.min,i.max)),this.__calendar.month.container.setDateText(this.__formatDateForMonthTitle(e.monthview.value)),this.__calendar.map.container.setDateText(this.__formatDateForDayTitle(e.mapview.value)),this.__calendar.day.container.setPrevText(this.__formatDateForPrevNextDay(e.dayview.value,"prev")),this.__calendar.day.container.setNextText(this.__formatDateForPrevNextDay(e.dayview.value,"next")),this.__calendar.week.container.setPrevText(this.__formatDateForPrevNextWeek(i.min,i.max,"prev")),this.__calendar.week.container.setNextText(this.__formatDateForPrevNextWeek(i.min,i.max,"next")),this.__calendar.month.container.setPrevText(this.__formatDateForPrevNextMonth(e.monthview.value,"prev")),this.__calendar.month.container.setNextText(this.__formatDateForPrevNextMonth(e.monthview.value,"next")),this.__calendar.map.container.setPrevText(this.__formatDateForPrevNextDay(e.mapview.value,"prev")),this.__calendar.map.container.setNextText(this.__formatDateForPrevNextDay(e.mapview.value,"next")),this.__calendar.day.container.setWeekDays(null),this.__calendar.month.container.setWeekDays(null),this.__calendar.map.container.setWeekDays(null),this.__calendar.week.container.setWeekDays(this.__formatDateForWeekDays(i.min)),n.on("resize",function(e,t){e.getHeight()&&(this.__calendar.day.container.setAdjustedHeight(e.getHeight()),this.__calendar.week.container.setAdjustedHeight(e.getHeight()),this.__calendar.month.container.setAdjustedHeight(e.getHeight()),this.__calendar.map.container.setAdjustedHeight(e.getHeight()))},this,{buffer:100}),n},__buildCalendarEventStore:function(){return Ext.create("com.servicemax.client.ui.components.modern.data.SVMXStore",{storeId:"CalendarEventStore",model:"Event",autoLoad:!1})},__handleEditDialog:function(e,t,n,i,a){var r=this;r.getDeliveryEngine().blockSyncPopUp();var s=o.Deferred();r.__selectedEvent=t;var l=t.raw,c=l.what_id||"";return r.dialog=o.showDialog({xtype:"svmx.panel",cls:"sfmevent-edit-dialog-panel",itemId:"svmxEventEditDialog",items:[{xtype:"svmx.headerbar",cls:"sfmevent-edit-dialog-headerbar",leftItem:[{xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-cancel",text:d().T("FSA016_TAG004","Cancel"),handler:function(){i&&i.undoMove(),r.dialog.hide(),r.getDeliveryEngine().allowSyncPopUp(),r.dialog.destroy(),s.resolve()}}],centerItem:[{xtype:"svmx.label",cls:"sfmevent-edit-dialog-title",text:d().T("FSA001_TAG008","Select New Start/End Times")}],rightItem:[{xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-save",text:d().T("FSA001_TAG009","Save"),handler:function(){r.__selectedEvent=t;var e=r.dialog.query("#newStartDate")[0],n=r.dialog.query("#newEndDate")[0];r.__validateEdit(t,e,n).done(function(){r.__handleLongPressEdit(l,e.getValue(),n.getValue()),r.dialog.hide(),r.getDeliveryEngine().allowSyncPopUp(),r.dialog.destroy(),s.resolve()}).fail(function(){})}}]},{xtype:"svmx.label",cls:"sfmevent-edit-dialog-warning",html:a||"",hidden:!a},{xtype:"svmx.field.datetime",itemId:"newStartDate",cls:"sfmevent-edit-dialog-picker",label:d().T("FSA001_TAG010","Start"),labelCls:"sfmevent-edit-dialog-picker-label",labelAlign:"top",value:n?n.orignalStartDate:l.orignalStartDate},{xtype:"svmx.field.datetime",itemId:"newEndDate",cls:"sfmevent-edit-dialog-picker",label:d().T("FSA001_TAG011","End"),labelCls:"sfmevent-edit-dialog-picker-label",labelAlign:"top",value:n?n.orignalEndDate:l.orignalEndDate},{xtype:"svmx.button",ui:"button-nav-toolbar",hidden:!!c,cls:"sfmevent-edit-dialog-delete",text:d().T("FSA001_TAG012","Delete Event"),handler:function(){r.getDeliveryEngine().allowSyncPopUp(),r.dialog.hide(),r.__handleLongPressDelete(),r.dialog.destroy(),s.resolve()}}]},{cls:"sfmevent-edit-dialog",hideOnMaskTap:!1,height:"",width:""}),s},__validateEdit:function(e,t,n){var i=this,a=o.Deferred(),r=e.raw,l=(r.what_id,r.eventObject||"Event"),c=[],u=[];t.getValue()>=n.getValue()&&c.push(d().T("FSA001_TAG013","End time cannot be before start time."));var _=0;if(0===c.length){var h=s.getFormattedDatetime(t.getValue(),"YYYY-MM-DD HH:mm"),f=s.getFormattedDatetime(n.getValue(),"YYYY-MM-DD HH:mm"),p=s.getDurationBetween(h,f);_=Math.ceil(p.asDays())}if(0===c.length&&"Event"===l&&_>14&&c.push(d().T("FSA001_TAG014","Event cannot be longer than 14 days.")),0===c.length&&"Event"!==l&&_>69e3&&c.push(d().T("FSA001_TAG015","ServiceMax Event cannot be longer than 69,000 days.")),c.length>0)o.Msg.alert({text:c[0],buttons:[{text:d().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]}).then(function(){a.reject()});else{s.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm:ss")>t.getValue()&&u.push(d().T("FSA001_TAG016","You selected a time in the past."));for(var m=i.calendarStore.getData(),v=void 0,g=!1,y=s.parseGMTDate(t.getValue()),S=s.parseGMTDate(n.getValue()),E=0;E<m.length;E++)if(v=m.getAt(E),r.event_id!==v.get("event_id")&&y<=v.get("end")&&S>=v.get("start")){g=!0;break}g&&u.push(d().T("FSA001_TAG017","This will overlap with an existing event.")),u.length>0?o.Msg.confirm({text:u.join("<BR>")+"<BR>"+d().T("FSA001_TAG018","Are you sure you want to do this?"),buttons:[{text:d().T("FSA016_TAG002","No"),itemId:"NO",ui:"svmx-button-square"},{text:d().T("FSA016_TAG001","Yes"),itemId:"YES",ui:"svmx-button-square"}]}).then(function(e){"YES"==e?a.resolve():a.reject()}):a.resolve()}return a},__handleLongPressEdit:function(e,t,n){var i=this,a=e.event_id,r=o.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.UPDATE_EVENT_DATE",i,{request:{recordId:a,startDate:t,endDate:n},responder:o.create("com.servicemax.client.sfmeventdelivery.responders.UpdateEventDateResponder",i)});return i.getDeliveryEngine().getEventBus().triggerEvent(r),i.__calendar.day.carousel.view.deselectEventBars(),!0},onUpdateDateCompleted:function(){var e=this,t=o.Deferred(),n={defer:t};t.done(function(t){e.__getCalendarData();e.__calendar.map.lastDate=null}),e.getDeliveryEngine().refreshData(n)},__handleLongPressDelete:function(e){var t=this;o.Msg.confirm({text:d().T("FSA001_TAG019","Are you sure you want to delete this appointment? This cannot be undone."),buttons:[{text:d().T("FSA016_TAG004","Cancel"),itemId:"CANCEL"},{text:d().T("FSA001_TAG020","Delete"),itemId:"DELETE"}]}).then(function(e){if("DELETE"==e){var n=t.__selectedEvent,i=n.raw.event_id,a=o.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.DELETE_EVENT_DATA",t,{request:{recordId:i},responder:o.create("com.servicemax.client.sfmeventdelivery.responders.DeleteEventDataResponder",t)});t.getDeliveryEngine().getEventBus().triggerEvent(a)}t.__calendar.day.carousel.view.deselectEventBars(),t.dialog.hide(),t.dialog.destroy()})},onDeleteDataCompleted:function(e){this.onUpdateDateCompleted()},__handleDatePickerTap:function(e){o.getCurrentApplication().hideSpinner(),this.__activeTab=e;var t=this,n=0;if(this.__calendar.cards){switch(e){case"day":n=0;break;case"week":n=1;break;case"month":n=2;break;case"map":n=3}var i=this.__calendar.cards.getActiveItem(),a=this.__calendar.cards.items.indexOf(i);if(a!=n){if(this.__destroyMap(),t.__calendar&&t.__calendar.cards&&0===a&&t.currentDateInDayView&&(t.__calendar.month.carousel&&t.__calendar.month.carousel.setDate(t.currentDateInDayView),t.__calendar.week.carousel&&t.__calendar.week.carousel.setDate(t.currentDateInDayView),t.__calendar.map.carousel&&t.__calendar.map.carousel.setDate(t.currentDateInDayView),t.currentDateInDayView=null),this.__calendar.cards.setActiveItem(n),3===n)this.__addMap();else{var r=[this.__calendar.day.carousel,this.__calendar.week.carousel],s=null;switch(n){case 0:s=r.splice(0,1)[0];break;case 1:s=r.splice(1,1)[0]}if(s&&s.__needRefresh&&s.refreshEvents(function(){s.__needRefresh=!1}),t.__centerItem&&t.__centerItem.getItems()&&!t.__centerItem.getItems().destroyed)t.__centerItem.updatePressedButtons([]),t.__centerItem.updatePressedButtons(n);else{var l=Ext.ComponentQuery.query("#periodButtons");l&&l.length>0&&(t.__centerItem=l[0],t.__centerItem.updatePressedButtons([]),t.__centerItem.updatePressedButtons(n))}2==n?this.__calendar.month.carousel&&this.__calendar.month.carousel.refreshEvents(function(){t.__updateScroller({view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer}),t.__updateScroller({view:t.__calendar.week.carousel.view,timer:t.__calendar.week.timers})}):3===n&&t.__calendar.map.carousel&&t.__calendar.map.carousel.refreshEvents()}"day"===t.__activeTab&&t.__calendar.day.timer&&t.__calendar.day.carousel.view.isDateInView(new Date)&&(t.__stopWeekViewTimeMarker(),t.__startCurrentTimeMarker({load:!0,interval:1,view:t.__calendar.day.carousel.view,timer:t.__calendar.day.timer})),"week"===t.__activeTab&&t.__calendar.week.timer&&t.__stopDayViewTimeMarker()}}return this},__addMap:function(){var e=this;this.checkConnectivity(1).done(function(){var t=e.__calendar.map.container.getAt(1);t&&(o.getCurrentApplication().showSpinner(),e.__map=Ext.create({xtype:"component",width:"100%",height:"100%",cls:"calendar-map",tpl:'<iframe src="{src}"data-ref="iframeEl" width="100%" height="100%" frameborder="0" style="min-height:100% !important;min-width:100% !important;"></iframe>',data:{src:"map.html"}}),t.el.dom.firstChild?Ext.fly(t.el.dom.firstChild).replaceWith(e.__map.el.dom):t.el.dom.appendChild(e.__map.el.dom))}).fail(function(){o.Msg.toast({text:d().T("FSA001_TAG003","Cannot connect to the internet, maps will have limited functionality.")})})},__destroyMap:function(){window.iFrameEventCallBack&&(window.iFrameEventCallBack=null),this.__map&&(this.__map.destroy(),delete this.__map)},__handleTodayTap:function(){this.__calendar.day.carousel&&this.__calendar.day.carousel.setDate(new Date),this.__calendar.week.carousel&&this.__calendar.week.carousel.setDate(new Date),this.__calendar.month.carousel&&this.__calendar.month.carousel.setDate(new Date),this.__calendar.map.carousel&&this.__calendar.map.carousel.setDate(new Date)},__handleNewEventTap:function(e){var t={SVMX_processId:e};o.getCurrentApplication().getCurrentView().changeConsoleApp({app:"sfmdelivery",view:"edit",options:{SVMX_processId:t.SVMX_processId,currentCalenderDateAndTime:this.__calendar.day.carousel.getCurrentDate(),additionalInfo:{calenderCreateEvent:!0}}})},__clearCalendarData:function(){this.calendarStore.removeAll()},__updateCalendarData:function(e){this.calendarStore.setData(e)},__createCalendarDayView:function(e){var t=this,n=Ext.create("Ext.ux.TouchCalendar",{viewMode:"day",value:e.date,height:"100%",width:"100%",enableEventBars:{eventBarTpl:this.__getDayEventTpl(),eventBarSpacing:5},viewConfig:{weekStart:0,eventStore:e.store,scrollerEvents:{maxpositionchange:function(e,t,n){},refresh:function(e,t,n){},scrollend:function(e,t,i,a){var r={x:t,y:i};n.fireEvent("timeslotchange",r)},scrollstart:function(e,t,n,i){}}},listeners:{painted:function(){},activeitemchange:function(e,n,i,a){t.currentDateInDayView=n.currentDate},selectionchange:function(){},selectionmade:function(){},periodchange:function(){},datechange:function(){}}});return n},__createCalendarWeekView:function(e){var t=Ext.create("Ext.ux.TouchCalendar",{viewMode:"week",value:e.date,height:"100%",width:"100%",plugins:"responsive",enableEventBars:{eventBarTpl:this.__getWeekEventTpl()},viewConfig:{weekStart:0,eventStore:e.store,scrollerEvents:{maxpositionchange:function(e,t,n){},refresh:function(e,t,n){},scrollend:function(e,n,i,a){var r={x:n,y:i};t.fireEvent("timeslotchange",r)},scrollstart:function(e,t,n,i){}}},responsiveConfig:{narrowScreen:{maxWeekDays:5},wideScreen:{maxWeekDays:7}},listeners:{painted:function(){}}});return t},__createCalendarMonthView:function(e){var t=this;return Ext.create("Ext.ux.TouchCalendar",{viewMode:"month",value:e.date,height:"100%",width:"100%",enableEventBars:{eventBarTpl:this.__getMonthEventTpl(),eventBarCls:"sfmevent-bar-month",eventBarSelectedCls:"sfmevent-bar-month-selected"},viewConfig:{weekStart:0,eventStore:e.store},listeners:{selectionchange:function(e,t,n){},periodchange:function(){},datechange:function(){},selectionmade:function(e,n,i){t.__calendar.week.carousel&&t.__calendar.week.carousel.setDate(n),t.__calendar.day.carousel&&t.__calendar.day.carousel.setDate(n),t.__calendar.map.carousel&&t.__calendar.map.carousel.setDate(n),t.__handleDatePickerTap("day")},painted:function(){}}})},__createCalendarMapView:function(e){var t=this;return Ext.create("Ext.ux.TouchCalendar",{viewMode:"map",value:e.date,height:"100%",width:"100%",enableSwipeNavigate:!1,enableEventBars:{getMap:o.proxy(this,this.__getMap),eventBarTpl:this.__getMapEventTpl(),eventBarCls:"sfmevent-bar-map",eventBarSelectedCls:"sfmevent-bar-map-selected"},viewConfig:{weekStart:0,eventStore:e.store},listeners:{selectionmade:function(e,n,i){t.__calendar.week.carousel&&t.__calendar.week.carousel.setDate(n),t.__calendar.day.carousel&&t.__calendar.day.carousel.setDate(n),t.__calendar.month.carousel&&t.__calendar.month.carousel.setDate(n),t.__handleDatePickerTap("day")},painted:function(){}}})},__handleSyncCompleteEvent:function(){if(!this.__pageHidden){var e=this.__syncManager.getSyncType();"CONFIG"!=e&&"LOCATION"!=e&&this.onUpdateDateCompleted()}},__getCalendarData:function(){var e=this.getDeliveryEngine().getDataModel();this.__state="show";var t=e.__eventData,n=e.getRecordIdName(),i=e.getSFEventFieldAndFieldType(),a=e.getSVMXEventFieldAndFieldType(),r=e.getSFEventSubjectSetting(),o=e.getSVMXEventSubjectSetting(),s={rawevents:t,recordIdName:n,sfEventFieldAndFieldType:i,svmxEventFieldAndFieldType:a,sfEventSubjectSetting:r,svmxEventSubjetSetting:o},l=this.__mapModelData(s);return this.__createCalendarEventData(l)},__createCalendarEventData:function(e){for(var t=0,n=[],i=void 0;t<e.length;t++)if(e[t].start.toDateString()!=e[t].end.toDateString()){var a=e[t].start,r=e[t].end,o=a.getFullYear(),s=a.getMonth(),l=a.getDate(),c=(a.getHours(),a.getMinutes(),r.getHours()),u=r.getMinutes(),d=Math.ceil((r.getTime()-a.getTime())/864e5);d=d<2&&(0!=c||0!=u)?2:d;for(var _=0;_<=d;_++){if(i=Ext.clone(e[t]),0==_?(i.start=a,i.end=new Date(o,s,l+_,23,59)):(i.start=new Date(o,s,l+_,0,0),i.end=new Date(o,s,l+_,23,59)),i.id+=_,i.multiDayEvent=d>1,i.multiDayEventIndex=i.multiDayEvent?_+1:0,!(i.end<r)){i.end=r,i.start<i.end&&n.push(i);break}n.push(i)}}else i=Ext.clone(e[t]),i.multiDayEvent=!1,i.multiDayEventIndex=0,n.push(i);return n},__mapModelData:function(e){var t=this,n=e.rawevents||[],i=e.recordIdName||[],a=e.sfEventFieldAndFieldType||[],r=e.svmxEventFieldAndFieldType||[],l=e.sfEventSubjectSetting||"",c=e.svmxEventSubjetSetting||"";o.generateGUID();return o.array.map(n,function(e){var n="",u="",d={street:e.WO_Street||"",city:e.WO_City||"",state:e.WO_State||"",zipcode:e.WO_Zip||"",country:e.WO_Country||"",latitude:e.WO_Latitude||"",longitude:e.WO_Longitude||""};e.WO_City&&""!=e.WO_City&&e.WO_State&&""!=e.WO_State?n=e.WO_City+", "+e.WO_State:e.WO_City&&""!=e.WO_City?n=e.WO_City:e.WO_State&&""!=e.WO_State&&(n=e.WO_State);var _="",h="",f=0;if(e.DrivingTime&&!isNaN(e.DrivingTime)){var p=parseInt(e.DrivingTime),m=Math.floor(p/60),v=p<=60?p:p%60,g=""+v,y="00";v=y.substring(0,y.length-g.length)+g,_=m+":"+v;var S=s.getDefaultTimeFormat(),E=s.manipulateDatetime(e.StartDateTime,"minutes",-p);h=s.getFormattedDatetime(E,S)}return e.StartDateTime&&e.EndDateTime&&(f=s.getDurationBetween(e.StartDateTime,e.EndDateTime).asMinutes()),"Event"==e.EventType&&l.length>0?u=t.__buildSubject(e,l,i,a):e.EventType==o.OrgNamespace+"__SVMX_Event__c"&&c.length>0&&(u=t.__buildSubject(e,c,i,r)),{id:e.Id,event_id:e.Id,priority:e.Priority,account:e.AccountName,start:s.parseDate(e.StartDateTime),orignalStartDate:s.convertToTimezone(e.StartDateTime,null,!0),end:s.parseDate(e.EndDateTime),orignalEndDate:s.convertToTimezone(e.EndDateTime,null,!0),title:e.AccountName||e.WO_Name||"",subject:e.Subject||"",techSubject:u,event:e.Description,details:e.Description,location:n||"",address:d,css:e.Color,what_id:e.WhatId,who_id:e.WhoId,isRecordInConflict:!!e.isRecordInConflict,hasSLA:!!e.WO_SLA,woName:e.WO_Name||"",woDrivingTime:_,woLeaveAt:h,duration:f,eventObject:e.EventType}})},__buildSubject:function(e,t,n,i){var a=void 0,r=[],o={};if(null!=(r=t.match(/\{\w+\}/g))&&r.length>0)for(var l=0;l<r.length;l++){var c=r[l].replace(/\{*\}*/g,"");if("reference"==i[c]){var u=e[c];void 0!==n[u]&&(o[c]=n[u])}else if("datetime"==i[c]){var d=e[c];d=s.getFormattedDatetime(d),o[c]=d}else"date"==i[c]?o[c]=e[c]:(i[c],o[c]=e[c])}return a=this.__replaceFieldsValueInSetting(t,o),a=a.replace(/\\n/g,"\n")},__replaceFieldsValueInSetting:function(e,t){return t||(t={}),String(e).replace(/\{.*?\}/g,function(e){return e=e.substring(1,e.length-1),void 0===t[e]||null===t[e]?"":t[e]})},__formatDateForDayTitle:function(e){return e=this.__offsetDSTTime(e),c.getFormatDateForDayTitle(e)},__formatDateForPrevNextDay:function(e,t){var n=(s.getLocale(),new Date(e));return"next"==t?n.setDate(n.getDate()+1):n.setDate(n.getDate()-1),n=this.__offsetDSTTime(n),c.getMonthWithDate(n)},__formatDateForMonthTitle:function(e){return c.getMonthNameWithFullYear(e)},__formatDateForPrevNextMonth:function(e,t){var n=(s.getLocale(),new Date(e));return n.setHours(0,0,0,0),n.setDate(1),"next"==t?n.setMonth(n.getMonth()+1):n.setMonth(n.getMonth()-1),n=this.__offsetDSTTime(n),c.getMonthNameWithFullYear(n)},__formatDateForWeekDays:function(e){var t=this.__calendar.week.carousel.getActiveItem(),n=[],i=this.__calendar.week.carousel.getMaxWeekDays(),a=i>5?7:6;i>5&&n.push(this.__buildWeekDayButton(this.__offsetDSTTime(e),t));for(var r=1;r<a;r++){var o=s.manipulateDatetime(this.__offsetDSTTime(e),"day",r);n.push(this.__buildWeekDayButton(o,t))}return n},__buildWeekDayButton:function(e,t){var n=c.getLocalizedDayName(e),i=s.getFormattedDatetime(e,"DD"),a=t.isSameDay(s.parseDateOnly(e),new Date),r=t.isWeekend(s.parseDateOnly(e)),l="sfmevent-nav-weekday-button";return l+=a?" "+t.getTodayCls():"",l+=r?" "+t.getWeekendCls():"",{xtype:"sfmevent.calendar.weekday",cls:l,html:"<span class='sfmevent-week-name'>"+n+"</span><span class='sfmevent-week-date'> "+i+"</span>",handler:o.proxy(this,this.__handleWeekdaySelect,e)}},__handleWeekdaySelect:function(e){var t=s.parseDate(e);this.__calendar.month.carousel&&this.__calendar.month.carousel.setDate(t),this.__calendar.day.carousel&&this.__calendar.day.carousel.setDate(t),this.__calendar.map.carousel&&this.__calendar.map.carousel.setDate(t),this.__handleDatePickerTap("day")},__formatDateForWeekTitle:function(e,t){return this.__formatWeekSpan(e,t)},__formatWeekSpan:function(e,t){var n=(s.getLocale(),s.getFormattedDatetime(this.__offsetDSTTime(e),"YYYY-MM-DD HH:mm:ss")),i=s.getFormattedDatetime(this.__offsetDSTTime(t),"YYYY-MM-DD HH:mm:ss"),a=n.substring(5,7)==i.substring(5,7),r=n.substring(0,4)==i.substring(0,4),o="";return o=c.getMonthWithDate(e)+" - "+c.getDateWithFullYear(t),r&&!a?o=c.getMonthWithDate(e)+" - "+c.getMonthWithDateFollowedByFullYear(t):r||a||(o=c.getMonthWithDateFollowedByFullYear(e)+" - "+c.getMonthWithDateFollowedByFullYear(t)),o},__formatDateForPrevNextWeek:function(e,t,n){var i=(s.getLocale(),s.getFormattedDatetime(this.__offsetDSTTime(e),"YYYY-MM-DD HH:mm:ss")),a=s.getFormattedDatetime(this.__offsetDSTTime(t),"YYYY-MM-DD HH:mm:ss");"next"==n?(i=s.manipulateDatetime(i,"day",7),a=s.manipulateDatetime(a,"day",7)):(i=s.manipulateDatetime(i,"day",-7),a=s.manipulateDatetime(a,"day",-7));var r=i.substring(5,7)==a.substring(5,7),o=(i.substring(0,4),a.substring(0,4),"");return o=c.getMonthWithDate(i)+"-"+c.getFormattedDate(a),r||(o=c.getMonthWithDate(i)+"-"+c.getMonthWithDate(a)),o},__offsetDSTTime:function(e){return Ext.Date.isDST(e)?new Date(e.getTime()+36e5):e},__singleDigitNumberString:function(e){var t="";switch(e.length){case 0:break;case 1:t=e;break;default:t=parseInt(e.substring(0,1))>0?e:e.substring(1)}return t},__refreshCalendar:function(e){var t=this.__calendar.cards.getActiveItem(),n=this.__calendar.cards.items.indexOf(t),i=[this.__calendar.day.carousel,this.__calendar.week.carousel,this.__calendar.month.carousel,this.__calendar.map.carousel],a=null;switch(n){case 0:a=i.splice(0,1)[0];break;case 1:a=i.splice(1,1)[0];break;case 2:a=i.splice(2,1)[0];break;case 3:a=i.splice(3,1)[0]}if(a){a.refreshEvents(e);for(var r=i.length-1;r>=0;r--)i[r].__needRefresh=!0}return this},__startCurrentTimeMarker:function(e){return this.__updateCurrentTimeMarker(e)},__updateCurrentTimeMarker:function(e){var t=o.Deferred(),n=this,i=e?e.interval||450:450,a=!!e&&(e.load||!1),r=e&&e.view?e.view:this.__calendar.day.carousel.view,s=e&&e.timer?e.timer:this.__calendar.day.timer;if(r.element){var l=r.element.getHeight();clearTimeout(s.clock),s.clock=setTimeout(function(){var e=new Date;if(r.isDateInView(e)||"week"===r._viewMode.toLowerCase()){var i=n.__showCurrentTimeMarker(e,r,s),o=l+i.view;i.maxView;if(s.scrollData=i,a){var c=0;o>=i.maxView?(r.getScrollable().scrollTo(1/0,1/0,!1),c=s.scrollData.maxScroll):i.view<=0?(r.getScrollable().scrollTo(0,0,!1),c=i.view):(r.getScrollable().scrollTo(0,i.view,!1),c=i.view),s.scrollData.setvalue=c,t&&t.resolve(r)}else t&&t.resolve(r);n.__updateCurrentTimeMarker({interval:n._eventDelay,load:!1,view:r,timer:s})}else clearTimeout(s.clock),n.__removeCurrentTimeMarker(r,s),t&&t.resolve(r)},i)}return t},__stopCurrentTimeMarker:function(e){clearTimeout(e.clock)},__stopDayViewTimeMarker:function(){this.__calendar&&this.__calendar.day&&this.__calendar.day.timer&&this.__calendar.day.timer.clock&&this.__stopCurrentTimeMarker(this.__calendar.day.timer),this.__calendar.day&&this.__calendar.day.timer&&this.__calendar.day.timer.refresh&&clearTimeout(this.__calendar.day.timer.refresh)},__stopWeekViewTimeMarker:function(){this.__calendar.week&&this.__calendar.week.timer&&this.__calendar.week.timer.clock&&this.__stopCurrentTimeMarker(this.__calendar.week.timer),this.__calendar.week&&this.__calendar.week.timer&&this.__calendar.week.timer.refresh&&clearTimeout(this.__calendar.week.timer.refresh)},__updateScroller:function(e){var t=e&&e.view?e.view:null,n=e&&e.timer?e.timer:null;if(!t||!n||!n.scrollData)return void(_&&_.info("Calendar tried to update scroller but we are missing either the view and/or timer."));if(e.timer&&t.isDateInView(new Date)||"week"===t._viewMode.toLowerCase())this.__startCurrentTimeMarker({load:!0,interval:1,view:t,timer:n});else{var i=t.element.getHeight(),a=i+n.scrollData.view,r=n.scrollData.maxView/24,o=n.scrollData&&n.scrollData.setvalue;clearTimeout(n.refresh),n.refresh=setTimeout(function(){a>=n.scrollData.maxView?(t.getScrollable().scrollTo(1/0,1/0,!1),n.scrollData.maxScroll):n.scrollData.setvalue+r<=i?t.getScrollable().scrollTo(0,0,!1):t.getScrollable().scrollTo(0,o,!1)},400)}},doDestroy:function(){if(console.warn("DESTROY DayView"),this.__calendar.menu&&this.__calendar.menu.longpress&&this.__calendar.menu.longpress.destroy(),this.__calendar){this.__calendar.day.timer.clock&&this.__stopCurrentTimeMarker(this.__calendar.day.timer),this.__calendar.week.timer.clock&&this.__stopCurrentTimeMarker(this.__calendar.week.timer),this.__calendar.day.timer.refresh&&clearTimeout(this.__calendar.day.timer.refresh),this.__calendar.week.timer.day&&clearTimeout(this.__calendar.week.timer.refresh),this.__calendar.month.carousel&&this.__calendar.month.carousel.destroy(),this.__calendar.day.carousel&&this.__calendar.day.carousel.destroy(),this.__calendar.week.carousel&&this.__calendar.week.carousel.destroy(),this.__calendar.map.carousel&&this.__calendar.map.carousel.destroy(),this.calendarStore&&this.calendarStore.destroy(),this.__calendar.day.timer.marker=null,this.__calendar.day.timer.markerTime=null,this.__calendar.week.timer.marker=null,this.__calendar.week.timer.markerTime=null;var e=this.__calendar.day.container;e&&(this.__isPassiveListener&&window.cordova&&e.el&&e.el.dom&&e.el.dom.removeEventListener("touchmove"),e.destroy());var t=this.__calendar.month.container;t&&t.destroy();var n=this.__calendar.week.container;n&&n.destroy();var i=this.__calendar.map.container;i&&i.destroy(),this.__calendar=null}this.__disableScrollDrag=null,this.__isPassiveListener=null,this.callParent()},onShow:function(){if(this.__pageHidden=!1,this.__state){var e=o.Deferred(),t={defer:e};e.done(function(e){}),this.getDeliveryEngine().refreshData(t)}this.__state="",this.callParent()},onHide:function(){this.__pageHidden=!0,this.__calendar&&(this.__stopDayViewTimeMarker(),this.__stopWeekViewTimeMarker()),this.callParent()}}),o.defineGlobal(u.name,u),e.exports=u},function(e,t,n){var i=n(0).utils,a=n(12).DatetimeUtil,r=n(19).impl,o=n(24).navigation,s=n(7).MetaData,l={name:"com.servicemax.client.sfmeventdelivery.ui.largemodern.eventview"},c=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},u=a,d=i.getLoggingService().getLogger("sfmeventdelivery.ui.eventview"),_=r,h=o,f=s;Ext.define(l.name+".CreateEventView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.event.createeventview",height:"100%",layout:"fit",__saveButton:null,__cancelButton:null,__eventType:null,__startDateTime:null,__endDateTime:null,__subject:null,__description:null,__subjectLength:null,__descriptionLength:null,__deliveryEngine:null,__workorderID:null,__workorderName:null,__warnings:null,__errors:null,__currentCalenderDateAndTime:null,onShow:function(){this.getDeliveryEngine().blockSyncPopUp(),d.info("SFM Event View showing")},onHide:function(){this.getDeliveryEngine().allowSyncPopUp(),d.info("SFM Event View hiding")},updateOptions:function(e){var t=u.parseDate(u.getCurrentDatetime(u.getSaveFormat("datetime")));if(this.__currentCalenderDateAndTime=u.getCurrentDatetimeGMT(u.getSaveFormat("datetime")),void 0!==e.currentCalenderDateAndTime){var n=e.currentCalenderDateAndTime;t.toDateString()==n.toDateString()?this.__currentCalenderDateAndTime=u.getCurrentDatetimeGMT(u.getSaveFormat("datetime")):this.__currentCalenderDateAndTime=u.getFormattedUTCDatetime(n,u.getSaveFormat("datetime"))}this.__workorderID=e.SVMX_recordId,this.__workorderName=e.SVMX_recordName,this.blockApplication()},ready:function(){this.unblockApplication(),this.__deliveryEngine=this.getDeliveryEngine();var e=i.getCurrentApplication(),t=i.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.RETRIEVE_MOBILE_SETTINGS",this,{request:{settingIds:["GLOB001_GBL025"]},responder:{result:i.proxy(this,function(e){if(e&&e.length>0)for(var t in e)"GLOB001_GBL025"===e[t].setting_id&&("Salesforce Event"===e[t].value?this.__eventType="Event":this.__eventType=i.OrgNamespace+"__SVMX_Event__c",this.__describeEventObject());else this.__eventType="Event",this.__describeEventObject()})}});e.triggerEvent(t)},__describeEventObject:function(){var e=this;f.describeObject({objectName:this.__eventType,onSuccess:i.proxy(this,function(e){this.__describeObject=e,this.__createable=e.createable,this.__deletable=e.deletable;for(var t=e.fields,n=0;n<t.length;n++){var a=t[n];"Event"==this.__eventType?"Subject"==a.name?this.__subjectLength=a.length:"Description"==a.name&&(this.__descriptionLength=a.length):this.__eventType==i.OrgNamespace+"__SVMX_Event__c"&&("Name"==a.name?this.__subjectLength=a.length:a.name==i.OrgNamespace+"__Description__c"&&(this.__descriptionLength=a.length))}this.__setupView()}),onError:function(){i.Msg.confirm({title:c().T("FSA001_TAG029","Error"),text:c().T("FSA001_TAG030","Failed Object Describe. Please check ServiceMax configurations."),buttons:[{text:c().T("FSA016_TAG003","OK"),ui:"svmx-button-square",itemId:"OK"}]}).then(function(){e.done()})}})},__setupView:function(){this.setViewInfo({windowTitle:c().T("FSA001_TAG031","New Event"),subTitle:this.__workorderName,backText:null,leftHeader:this.getLeftButton(),rightHeader:this.getRightButton(),disableNavMenu:!0,hideBackButton:!0,hideContextMenu:!0});var e=this.__setupPanels();this.add(e);var t={currentCalenderDateAndTime:this.__currentCalenderDateAndTime};e.addPanel(this.__createEventTimeSection(t)),e.addPanel(this.__createEventInfoSection({subjectLength:this.__subjectLength,descriptionLength:this.__descriptionLength})),this.__saveButton=this.query("#saveButton"),this.__cancelButton=this.query("#cancelButton")},getLeftButton:function(){return{xtype:"svmx.button",html:c().T("FSA016_TAG004","Cancel"),handler:i.proxy(this,"cancel"),ui:"svmx-toolbar-btn svmx-cancel-btn",itemId:"cancelButton"}},getRightButton:function(){var e=this;return{xtype:"svmx.button",html:c().T("FSA001_TAG009","Save"),ui:"svmx-button-square svmx-save-btn",itemId:"saveButton",listeners:{tap:{fn:function(t,n){e.save()},scope:e,buffer:500}}}},__setupPanels:function(){return Ext.create(h.name+".SVMXNavContainer",{xtype:"svmx.navcontainer",ui:"svmx-default",width:"100%",height:this.el.getHeight()})},__createEventTimeSection:function(e){var t=Ext.widget("sfmevent.eventtimesection",e);return t.setStyle("margin-bottom: 25px; margin-top: 10px;"),t},__createEventInfoSection:function(e){return Ext.widget("sfmevent.eventinfosection",e)},cancel:function(){d.info("Performing Cancel action"),i.Msg.confirm({title:c().T("FSA001_TAG050","Discard Changes?"),text:c().T("FSA001_TAG051","You have unsaved changes. Do you wish to discard the changes or continue editing?"),buttons:[{text:c().T("FSA001_TAG052","Continue Editing"),ui:"svmx-button-square",itemId:"CONTINUE"},{text:c().T("FSA001_TAG053","Discard Changes"),ui:"svmx-button-square",itemId:"DISCARD"}]}).then(i.proxy(this,function(e){"DISCARD"==e&&this.done()}))},save:function(){d.info("Performing Save action"),this.blockApplication(),this.__startDateTime=this.query("#startDateTime")[0].getValue(),this.__endDateTime=this.query("#endDateTime")[0].getValue(),this.__subject=this.query("#subject")[0].getValue(),this.__description=this.query("#description")[0].getValue(),this.__validateEvent()},__validateEvent:function(){this.__checkErrors(),this.__checkWarnings(),this.__showErrorsWarnings()},__checkErrors:function(){this.__errors=[];var e=u.getFormattedDatetime(this.__startDateTime,"YYYY-MM-DD HH:mm"),t=u.getFormattedDatetime(this.__endDateTime,"YYYY-MM-DD HH:mm"),n=u.getDurationBetween(e,t),i=Math.ceil(n.asDays());this.__startDateTime||this.__errors.push(c().T("FSA001_TAG032","Start datetime is required field.")),this.__endDateTime||this.__errors.push(c().T("FSA001_TAG033","End datetime is required field.")),this.__startDateTime>=this.__endDateTime&&this.__errors.push(c().T("FSA001_TAG013","End time cannot be before start time.")),"Event"===this.__eventType&&i>14&&this.__errors.push(c().T("FSA001_TAG014","Event cannot be longer than 14 days.")),"Event"!==this.__eventType&&i>69e3&&errors.push(c().T("FSA001_TAG015","ServiceMax Event cannot be longer than 69,000 days.")),this.__subject&&this.__subject.trim()||this.__errors.push(c().T("FSA001_TAG037","Subject is required field."))},__checkWarnings:function(){this.__warnings=[];var e=u.getFormattedDatetime(this.__startDateTime,"YYYY-MM-DD HH:mm");u.macroDrivenDatetime("now","YYYY-MM-DD","HH:mm")>e&&this.__warnings.push(c().T("FSA001_TAG016","You selected a time in the past."));for(var t=this.__deliveryEngine.getDataModel().getEvents(),n=0;n<t.length;n++){var i=t[n],a=u.convertDatetimeForSave(i.getStartDateTime()),r=u.convertDatetimeForSave(i.getEndDateTime());if(this.__startDateTime<=r&&this.__endDateTime>=a){var o=c().T("FSA001_TAG017","This will overlap with an existing event.");this.__warnings.push(o);break}}},__showErrorsWarnings:function(){if(this.unblockApplication(),this.__errors&&this.__errors.length>0)i.Msg.alert({text:this.__formatErrorWarningMessage(this.__errors),buttons:[{text:c().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]});else if(this.__warnings&&this.__warnings.length>0){var e=[{text:c().T("FSA016_TAG002","No"),itemId:"NO",ui:"svmx-button-square"},{text:c().T("FSA016_TAG001","Yes"),itemId:"YES",ui:"svmx-button-square"}];i.Msg.confirm({text:this.__formatErrorWarningMessage(this.__warnings)+"<BR>"+c().T("FSA001_TAG018","Are you sure you want to do this?"),buttons:e}).then(i.proxy(this,function(e){"YES"==e&&this.confirmValidationWarning()}))}else this.confirmValidationWarning()},confirmValidationWarning:function(){this.blockApplication();var e=i.getCurrentApplication(),t=i.create("com.servicemax.client.lib.api.Event","SFMEVENTDELIVERY.SAVE_NEW_EVENT",this,{request:{type:"create",objectName:this.__eventType,startDateTime:this.__startDateTime,endDateTime:this.__endDateTime,subject:this.__subject,description:this.__description,whatId:this.__workorderID},responder:{result:i.proxy(this,function(e){this.__includeRecordInRecentItems(e),this.done({refreshEvents:!0})})}});e.triggerEvent(t)},__includeRecordInRecentItems:function(e){if(e&&e.recordId&&e.recordId.length>0&&e.objectName&&e.objectName.length>0){d.info("Adding record in Recent items table");var t=void 0,n=void 0,a=void 0,r=void 0;r=e.recordId,n=e.objectName,t=u.getCurrentDatetimeGMT(u.getSaveFormat("dateTime")),a=f.getNameField(n);var o=i.create("com.servicemax.client.lib.api.Event","RECENTS.ADD_RECENTS",this,{request:{recordId:r,objectName:n,lastAccessed:t,nameField:a,type:"CREATE"},responder:{result:function(){}}});i.getCurrentApplication().triggerEvent(o)}else d.info("Unable to add record in Recent items table, due to incomplete information")},__formatErrorWarningMessage:function(e){var t="";return e&&e.length>0&&(t=e.join("<BR>")),t}}),Ext.define(l.name+".EventTimeSection",{extend:_.name+".SVMXPanel",alias:"widget.sfmevent.eventtimesection",halign:"full",scrollable:"vertical",cls:["sfmevent-time-section"],constructor:function(){this.callParent(arguments)},initConfig:function(e){this.setTitle(c().T("FSA001_TAG041","Times")),this.__buildUI(e)},__buildUI:function(e){this.add(this.__setupDateTimePanel({id:"startDateTime",label:c().T("FSA001_TAG042","Start Date and Time"),isRequired:!0,value:e.currentCalenderDateAndTime})),this.add(this.__setupDateTimePanel({id:"endDateTime",label:c().T("FSA001_TAG043","End Date and Time"),isRequired:!0,value:u.manipulateDatetime(e.currentCalenderDateAndTime,"hours",1)}))},__setupDateTimePanel:function(e){var t=e.value||"";return Ext.widget("svmx.field.datetime",{xtype:"svmx.field.datetime",itemId:e.id,label:e.label,labelAlign:"top",value:t,required:!0,enableBarcode:!1,alwaysShowBarcode:!1,clearIcon:!1,width:"98%"})}}),Ext.define(l.name+".EventInfoSection",{extend:_.name+".SVMXPanel",alias:"widget.sfmevent.eventinfosection",halign:"full",scrollable:"vertical",cls:["sfmevent-info-section"],constructor:function(){this.callParent(arguments)},initConfig:function(e){this.setTitle(c().T("FSA001_TAG044","Information")),this.__buildUI(e)},__buildUI:function(e){this.add(this.__setupEventSubjectField({id:"subject",label:c().T("FSA001_TAG045","Subject"),maxLength:e.subjectLength,required:!0})),this.add(this.__setupDescriptionPanel({id:"description",label:c().T("FSA001_TAG046","Description"),maxLength:e.descriptionLength}))},__setupDescriptionPanel:function(e){var t=e.description||"";return Ext.widget("svmx.field.textarea",{xtype:"svmx.field.textarea",label:e.label,itemId:e.id,labelAlign:"top",value:t,enableBarcode:!1,alwaysShowBarcode:!1,clearIcon:!1,maxLength:e.maxLength,width:"99%"})},__setupEventSubjectField:function(e){var t=e.subject||"";return Ext.widget("svmx.field.text",{xtype:"svmx.field.text",label:e.label,itemId:e.id,labelAlign:"top",value:t,enableBarcode:!1,alwaysShowBarcode:!1,clearIcon:!1,maxLength:e.maxLength,required:e.required,width:"98%"})}}),i.defineGlobal(l.name,l),e.exports=l},function(e,t,n){n(754);var i=n(759),a=n(186),r=n(760),o=n(761),s=n(762),l=n(416),c=n(0).utils;c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.consoleapp","config":{"app":{"id":"sfmsearchdelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},"views":[{"id":"home","class-name":"com.servicemax.client.sfmsearchdelivery.ui.largemodern.homeview.HomeView","default-view":true},{"id":"searchListView","class-name":"com.servicemax.client.sfmsearchdelivery.ui.largemodern.listview.SearchListView"},{"id":"searchresults","class-name":"com.servicemax.client.sfmsearchdelivery.ui.largemodern.resultview.ResultsView"}],"icon":{"large-css-class":"icon-globe","small-css-class":"icon-globe"},"controller":{"class-name":"com.servicemax.client.sfmsearchdelivery.engine.DeliveryEngineImpl"},"discover":true,"multiple":false,"positionWeight":2000,"button-text":["FSA004_TAG022","Explore"]}}')),c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA007","local-id":"FSA"}}')),c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA004","local-id":"FSA"}}')),c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA016","local-id":"FSA"}}')),e.exports={impl:i,api:a,columnFactory:r,listview:o,homeview:s,resultview:l}},function(e,t,n){var i=n(755),a=n(756),r=n(757),o=n(758),s=n(0).utils;s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"SFMSEARCHDELIVERY.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"sfmsearchdelivery","class-name":"com.servicemax.client.sfmsearchdelivery.engine.DeliveryEngineImpl"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMSEARCHDELIVERY.GET_SEARCH_INFO","command":"com.servicemax.client.sfmsearchdelivery.commands.GetSearchInfo"},{"event":"SFMSEARCHDELIVERY.GET_SEARCH_RESULTS","command":"com.servicemax.client.sfmsearchdelivery.commands.GetSearchResults"},{"event":"SFMSEARCHDELIVERY.CHANGE_APP_STATE","command":"com.servicemax.client.sfmsearchdelivery.commands.ChangeApplicationState"},{"event":"SFMSEARCHDELIVERY.GET_USERINFO","command":"com.servicemax.client.sfmsearchdelivery.commands.GetUserInfo"},{"event":"SFMSEARCHDELIVERY.GET_ONLINE_RESULTS","command":"com.servicemax.client.sfmsearchdelivery.commands.GetOnlineResults"},{"event":"SFMSEARCHDELIVERY.DOWNLOAD_RECORD_ON_DEMAND","command":"com.servicemax.client.sfmsearchdelivery.commands.DownloadRecordOnDemand"},{"event":"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS","command":"com.servicemax.client.sfmsearchdelivery.commands.GetSearchResultLimitSettings"},{"event":"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_COUNT","command":"com.servicemax.client.sfmsearchdelivery.commands.GetSearchResultCount"}]}}}')),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y=n(5).SVMXObject,S={name:"com.servicemax.client.sfmsearchdelivery.impl"};S.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){S.init(),S.init(),S.init()}},{key:"afterInitialize",value:function(){}}]),t}(v),S.SFMSearchDeliveryEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFMSearchDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),S.UIElementsCreationHelper=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"doCreate",value:function(e,t){var n=Ext.create(e,t);return n.__self=Ext.ClassManager.getClass(n),n}}]),t}(y),m.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(33).AbstractDeliveryEngine,g=n(12).DatetimeUtil,y=n(5).SVMXObject,S={name:"com.servicemax.client.sfmsearchdelivery.engine"},E=function(){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};S.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__isContainerExternal=!1,g.setAmPmText(E().T("FSA016_TAG005","AM"),E().T("FSA016_TAG006","PM")),e.__searchMetamodel=null,e.__searchRoot=null,e.__loadMask=null,e.__parent=null,e.__translation=null,e.__view=null,e.searchResultsMaxCount=null,e.defaultResultsMaxCount=null,e}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){var t=m.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=m.create("com.servicemax.client.sfmsearchdelivery.impl.SFMSearchDeliveryEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("SFMSEARCHDELIVERY.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"translate",value:function(e){return E().T(e)}},{key:"getAllTranslation",value:function(){return this.__translation}},{key:"changeApplicationState",value:function(e){this.__appCurrentState!==e&&(this.__appCurrentState=e,"block"==e?(this.__loadMask||(this.__loadMask=new com.servicemax.client.ui.components.utils.LoadMask({parent:this.__searchRoot})),this.__loadMask.show({}),this.__loadMask.setZIndex(5e4)):"unblock"==e&&null!==this.__loadMask&&null!==this.__loadMask&&this.__loadMask.hide())}},{key:"reset",value:function(){this.getRoot().destroy(),this.__searchRoot=null,this.__searchMetamodel.doCleanup(),this.__searchMetamodel=null,this.run(this.options)}},{key:"run",value:function(e){this.options=e||{},m.create("com.servicemax.client.sfmconsole.utils.EventCollection",this.getEventBus(),[m.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_SEARCH_INFO",this,{request:{}}),m.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_USERINFO",this,{request:{}}),m.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS",this,{request:{}})]).triggerAll(function(t){var n=t.items(),i=n.length,a=void 0;for(a=0;a<i;a++){var r=n[a];"SFMSEARCHDELIVERY.GET_SEARCH_INFO"==r.type()&&this.onGetSearchInfoCompleted(r.response),"SFMSEARCHDELIVERY.GET_USERINFO"==r.type()&&this.onGetUserInfoCompleted(r.response),"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS"==r.type()&&this.onGetSearchResultLimitSettingsCompleted(r.response)}this.__searchMetamodel.initialize(),this.__searchRoot=this.__view.createComponent("ROOTCONTAINER",{metamodel:this.__searchMetamodel,deliveryEngine:this,consoleAppInstance:e.consoleAppInstance}),m.getCurrentApplication().defaultSearchInstance=this;var o=m.getUrlParameter("SVMX_keyWord"),s=m.getUrlParameter("SVMX_SearchName"),l=m.getUrlParameter("SVMX_SearchId");this.__searchRoot&&(this.__searchRoot.run({keyWord:o,processId:s,processObjectId:l}),this.__searchRoot.render(m.getDisplayRootId(),this.__isContainerExternal)),this.options.onReady&&this.options.onReady.handler.call(this.options.onReady.context||this)},this)}},{key:"getRoot",value:function(){return this.__searchRoot}},{key:"getSearchType",value:function(){return"SFMSEARCHDELIVERY"}},{key:"onGetSearchInfoCompleted",value:function(e){this.__searchMetamodel=m.create("com.servicemax.client.sfmsearchdelivery.engine.SFMSearchMetaModel",this,e)}},{key:"onGetUserInfoCompleted",value:function(e){var t=m.getClient(),n=m.create("com.servicemax.client.lib.api.Event","GLOBAL.HANDLE_USER_INFO",this,e);t.triggerEvent(n)}},{key:"getMetaModel",value:function(){return this.__searchMetamodel.searchInfo}},{key:"onGetSearchResultLimitSettingsCompleted",value:function(e){var t=e.maxLimit,n=e.defaultLimit;this.searchResultsMaxCount=t,this.defaultResultsMaxCount=n}},{key:"onResize",value:function(e){this.getRoot().resize(e)}},{key:"doCleanup",value:function(){return this.setPropertyForCleanup(["__searchMetamodel","__eventBus"]),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),S.SFMSearchMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.searchInfo=[],i.defaultSearchOperator=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){var e=this.__data.lstSearchInfo||[],t=void 0,n=e.length,i=void 0;for(this.defaultSearchOperator=this.__extractDefaultSearchOperator(),t=0;t<n;t++)i=m.create("com.servicemax.client.sfmsearchdelivery.engine.SFMSearchProcessMetaModel",this,e[t]),i.initialize(),this.searchInfo.push(i)}},{key:"__extractDefaultSearchOperator",value:function(){var e=this.__data.stringMap||[],t=void 0,n=e.length,i="Contains";for(t=0;t<n;t++)if("SEARCH_OPERATOR"==e[t].key){i=e[t].value;break}return i}},{key:"getSearchInfoFor",value:function(e){var t=this.searchInfo||[],n=void 0,i=t.length,a=null;for(n=0;n<i;n++)if(t[n].processObjectId==e){a=t[n];break}return a}},{key:"doCleanup",value:function(){return this.setPropertyForCleanup("searchInfo",!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(y),S.SFMSearchProcessMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.name=null,i.description=null,i.processId=null,i.isDefault=!1,i.processObjectId=null,i.searchDetails=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){this.name=this.__data.searchDef[m.OrgNamespace+"__Name__c"],this.processId=this.__data.searchDef[m.OrgNamespace+"__ProcessID__c"],this.processObjectId=this.__data.searchDef.Id,this.description=this.__data.searchDef[m.OrgNamespace+"__Description__c"],this.isDefault=this.__data.searchDef[m.OrgNamespace+"__IsDefault__c"],this.searchDetails=[];var e=this.__data.searchDetails||[],t=void 0,n=e.length,i=void 0;for(t=0;t<n;t++)i=m.create("com.servicemax.client.sfmsearchdelivery.engine.SFMSearchDetailMetaModel",this,e[t]),i.initialize(),this.searchDetails.push(i);this.searchDetails=this.searchDetails.sort(function(e,t){return e.objectDisplaySequence-t.objectDisplaySequence})}},{key:"doCleanup",value:function(){return this.setPropertyForCleanup("searchDetails",!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(y),S.SFMSearchDetailMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.targetObjectName=null,i.targetObjectLabel=null,i.objectDisplaySequence=null,i.fields=null,i.detailObjectId=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){this.targetObjectLabel=this.__data.objectLable,this.targetObjectName=this.__data.objectDetails[m.OrgNamespace+"__Target_Object_Name__c"],this.detailObjectId=this.__data.objectDetails.Id,this.objectDisplaySequence=this.__data.objectDetails[m.OrgNamespace+"__Sequence__c"],this.fields=[];var e=this.__data.fields||[],t=void 0,n=e.length,i=void 0;for(t=0;t<n;t++)i=m.create("com.servicemax.client.sfmsearchdelivery.engine.SFMSearchDetailFieldMetaModel",this,e[t]),i.initialize(this.__data.fieldsLable),this.fields.push(i);this.fields=m.sort(this.fields,"sequence")}},{key:"doCleanup",value:function(){return this.setPropertyForCleanup("fields",!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(y),S.SFMSearchDetailFieldMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.fieldName=null,i.displayType=null,i.sequence=0,i.fieldLabel=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e){this.fieldName=this.__data[m.OrgNamespace+"__Field_Name__c"],this.displayType=this.__data[m.OrgNamespace+"__Display_Type__c"],this.sequence=this.__data[m.OrgNamespace+"__Sequence__c"],this.parentName=this.__data[m.OrgNamespace+"__Object_Name2__c"],this.parentReferenceName=this.__data[m.OrgNamespace+"__Lookup_Field_API_Name__c"];var t=void 0,n=e.length;for(t=0;t<n;t++)if(e[t].value1==this.getId()){this.fieldLabel=e[t].value;break}}},{key:"getId",value:function(){return this.__data.Id}},{key:"getFullFieldName",value:function(){return this.parentName&&this.parentName!=this.__parent.targetObjectName?this.parentReferenceName+"-"+this.fieldName:this.fieldName}},{key:"getScale",value:function(){return this.__data&&this.__data.fldDescribe&&this.__data.fldDescribe.scale?this.__data.fldDescribe.scale:0}},{key:"getObjectApiName",value:function(){return this.__parent.targetObjectName}},{key:"getReferenceFieldObjectApiName",value:function(){return this.__data[m.OrgNamespace+"__Object_Name__c"]}}]),t}(y),m.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.sfmsearchdelivery.commands"};m.GetSearchInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_INFO"})}}]),t}(p),m.GetSearchResults=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_RESULTS"})}}]),t}(p),m.GetSearchResultCount=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_COUNT"})}}]),t}(p),m.GetUserInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.GET_USERINFO"})}}]),t}(p),m.ChangeApplicationState=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){e.deliveryEngine.changeApplicationState(e.state)}}]),t}(p),m.GetOnlineResults=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.GET_ONLINE_RESULTS"})}}]),t}(p),m.DownloadRecordOnDemand=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.DOWNLOAD_RECORD_ON_DEMAND"})}}]),t}(p),m.GetSearchResultLimitSettings=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.sfmsearchdelivery.responders"};m.GetSearchInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetSearchInfoCompleted(e)}},{key:"fault",value:function(e){}}]),t}(p),m.GetSearchResultResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){}},{key:"fault",value:function(e){}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m=n(186).columnfactory,v={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.impl"};v.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){v.init(),v.init(),v.init(),v.init(),m.init()}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){var i=n(0).utils,a=n(12).DatetimeUtil,r={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.api.columnfactory"},o=r.name,s=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},l=function(e,t){var n=0===e.index,i=t.get("isRecordInConflict"),a=n&&"true"===i;return{conflictIndicatorHtml:a?"<i class='icon-sync-error sfmsearch-conflict-icon'></i>":"",hasConflict:a}},c=function(e,t){var n="0,000";if(t>0){n+=".";for(var i=0;i<t;i++)n+="0"}return Ext.util.Format.number(e,n)};Ext.define(o+".ColumnFactory",{alias:"sfmsearch.columnfactory",constructor:function(e){this.uiConfig=e.uiConfig,this.index=e.index,this.fld=e.fld},createColumn:function(e){var t=void 0;switch(e){case"DATETIME":t=new d({fld:this.fld,uiConfig:this.uiConfig,objectName:this.fld.getObjectApiName(),index:this.index,timeColumn:!0});break;case"DATE":t=new _({fld:this.fld,uiConfig:this.uiConfig,objectName:this.fld.getObjectApiName(),index:this.index});break;case"TEXT":t=new h({fld:this.fld,uiConfig:this.uiConfig,index:this.index});break;case"ONLINE_COLUMN":t=new f({fld:this.fld,uiConfig:this.uiConfig,index:this.index});break;case"TEMPLATE":t=new u({fld:this.fld,uiConfig:this.uiConfig,index:this.index})}return t}});var u=function(e){var t={columnObj:e,cls:"info-icon-column",cell:{xtype:"widgetcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner sfmsearch-info-icon-cell",widget:{xtype:"button",cls:"sfmsearch-info-icon-button",iconCls:"icon-info-i",bind:{handler:"onInfoColumnClicked"}}}};return t=Ext.apply(t,e.uiConfig)},d=function(e){var t={columnObj:e,cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},timeColumn:e.timeColumn,renderer:function(t,n,i,r,o){var s=l(e,n),c="";if(t){var u=a.convertToTimezone(t);c=a.getFormattedDatetime(u)}else c="";return s.hasConflict&&(c=s.conflictIndicatorHtml+c),c}};return t=Ext.apply(t,e.uiConfig)},_=function(e){var t={columnObj:e,cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},renderer:function(t,n,i,r,o){var s=l(e,n),c="";return c=t?a.getFormattedDatetime(t,a.getDefaultDateFormat()):"",s.hasConflict&&(c=s.conflictIndicatorHtml+c),c}};return t=Ext.apply(t,e.uiConfig)},h=function(e){var t={cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},columnObj:e,renderer:function(t,n,i,a,r){var o=Ext.String.htmlEncode(n.get(e.fld.getFullFieldName())),s=l(e,n),u=o;s.hasConflict&&(u=s.conflictIndicatorHtml+o);var d=e&&e.fld&&e.fld.getScale?e.fld.getScale():0;return d>0&&(u=c(u,d)),u}};return t=Ext.apply(t,e.uiConfig)},f=function(e){var t={cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},columnObj:e,renderer:function(e,t,n,i,a){var r="",o=t.get("dodstatus"),l=!Ext.isEmpty(t.get("online"));return l&&"offline"===o?r='<div class="icon-cloud-download sfmsearch-dod-disabled"></div>':l&&"error"===o?r='<div class="icon-cloud-error sfmsearch-dod-error"></div>':l&&"downloading"===o?r='<div class="sfmsearch-dod-downloading-text"><span class="sfmsearch-dod sfmsearch-dod-downloading">'+s().T("FSA008_TAG044","Downloading...")+' </span> | <span><a class="sfmsearch-dod sfmsearch-dod-cancel-link">'+s().T("FSA008_TAG045","Cancel Download ")+"</a></span></div>":l&&!o&&(r='<a><div class="icon-cloud-download sfmsearch-download-icon"></div></a>'),"<div class='sfmsearch-dod-cell '>"+r+"</div>"}};return t=Ext.apply(t,e.uiConfig)};i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(10),a=n(0).utils,r=n(22).View,o={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.listview"},s=function(){return a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},l=r,c=a.getLoggingService().getLogger("sfmsearch-ui"),u=o.name;Ext.define(u+".SearchListView",{extend:l,alias:"widget.sfm.search.home",__selected:null,__store:null,config:{model:null},initialize:function(){this.callParent();var e=a.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance(),this.bind(this.__syncManager,"SYNC_COMPLETED",this.syncCompleteRefresh,this)},unBindSyncCompleted:function(){this.__syncManager&&(c.info("UNBIND Refresh ::for View Id: "+this.id),this.unbind(this.__syncManager,"SYNC_COMPLETED",this.syncCompleteRefresh,this))},onShow:function(){this.__selected=!1,c.info("Home View showing"),this.searchDef&&this.refreshSearchListView(),this.callParent()},onHide:function(){c.info("Home View hiding"),this.callParent()},ready:function(){var e=this,t=e.getOptions();e.setModel(e.getDeliveryEngine().getMetaModel()),e.__selected=!1,e.searchDef=a.array.get(e.getModel(),function(e){return e.processObjectId==t.searchId}),e.getTotalCountForSearches(this.searchDef).always(function(t){e.displaySearchList(t)})},getTotalCountForSearches:function(e){var t=0,n=e.searchDetails,r=n.length,o=[],s=i.Deferred(),l=this;for(t;t<r;t++){request={ProcessId:e.processObjectId,ProcessName:e.processId,queryCountOnly:!0,KeyWord:"",Operator:"Contains"};var c=n[t],u=c.detailObjectId;request.ObjectId=u,request.searchDetail=c,o.push(a.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_SEARCH_RESULT_COUNT",this,{request:request}))}return a.create("com.servicemax.client.sfmconsole.utils.EventCollection",l.getDeliveryEngine().getEventBus(),o).triggerAll(function(e){var t=e.items(),n=t.length,i=0,a=[];for(i;i<n;i++)a.push(t[i].response);i==n&&s.resolve(a)}),s},displaySearchList:function(e){var t=this,n=t.getOptions(),i="svmx.sfmsearchdelivery.runtime.searchResultList.model"+a.generateGUID();Ext.ClassManager.classes[i]||Ext.define(i,{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"name"},{name:"detailObjectId"},{name:"searchId"},{name:"count"}]});var r=a.array.map(this.searchDef.searchDetails,function(t){var i=a.array.filter(e,function(e){return e.searchDetailId===t.detailObjectId})[0];return{name:Ext.String.htmlEncode(t.targetObjectLabel),detailObjectId:t.detailObjectId,searchId:n.searchId,count:i.totalCount}});t.__store=Ext.widget("svmx.store",{model:i,data:r});var o=[{itemId:"list",cls:"sfmsearch-lineup-list-view",xtype:"svmx.list",itemCls:"sfmsearch-lineup-list-view-item",store:t.__store,itemTpl:"<div class='listitem-sfmsearch-lineup-list-item-name'>{name} ({count})</div>",emptyText:s().T("FSA004_TAG0234","No Objects Found In this search"),listeners:{select:a.proxy(this,"onSearchSelect"),disclose:a.proxy(this,"onSearchSelect")}}];this.add(o)},updateOptions:function(e){var t=e.name;this.setViewInfo({windowTitle:t,backText:t,subTitle:"",hideContextMenu:!0})},syncCompleteRefresh:function(e){if(this.__syncManager&&this.__syncManager.getSyncType){var t=this.__syncManager.getSyncType();"ONECALLSYNC"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t||this.refreshSearchListView()}},refreshSearchListView:function(){var e=this;this.getTotalCountForSearches(this.searchDef).always(function(t){e.updateSearchList(t)})},updateSearchList:function(e){if(this.__store){var t=this.getOptions(),n=a.array.map(this.searchDef.searchDetails,function(n){var i=a.array.filter(e,function(e){return e.searchDetailId===n.detailObjectId})[0];return{name:Ext.String.htmlEncode(n.targetObjectLabel),detailObjectId:n.detailObjectId,searchId:t.searchId,count:i.totalCount}});this.__store.removeAll(),this.__store.setData(n)}},onSearchSelect:function(e,t){this.__selected||(this.__selected=!0,this.changeView({view:"searchresults",options:{searchId:t.get("searchId"),detailObjectId:t.get("detailObjectId"),record:t}}))},doDestroy:function(){this.unBindSyncCompleted(),this.__store&&this.__store.removeAll(),this.callParent()}}),a.defineGlobal(o.name,o),e.exports=o},function(e,t,n){var i=n(0).utils,a=n(22).View,r=n(186).PIQSearchUtilityHelper,o=n(131).CacheHelper,s={name:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.homeview"},l=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},c=a,u=i.getLoggingService().getLogger("sfmsearch-ui"),d=s.name;s.PIQSearchUtilityHelper=r,s.CacheHelper=o,Ext.define(d+".KeyValueStore",{extend:"com.servicemax.client.ui.components.modern.data.SVMXStore",alias:"widget.sfmsearch.keyvaluestore",constructor:function(e){this.callParent(arguments)},fields:["opLabel","opValue"]}),Ext.define(d+".HomeView",{extend:c,alias:"widget.sfm.search.home",__selected:null,config:{model:null},__syncManager:null,__syncImpl:null,getSyncManager:function(){var e=i.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");return this.__syncManager=e.getInstance(),this.__syncManager},syncCompleteRefresh:function(e){if(this.__syncManager&&this.__syncManager.getSyncType){var t=this.__syncManager.getSyncType();"ONECALLSYNC"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t||(this.refreshView(),u.info("Refreshing SFM Result View ID:"+this.id))}},bindSyncCompleted:function(){this.__syncManager&&(u.info("BIND Refresh ::for View Id: "+this.id),this.bind(this.__syncManager,"SYNC_COMPLETED",this.syncCompleteRefresh,this))},unBindSyncCompleted:function(){this.__syncManager&&(u.info("UNBIND Refresh ::for View Id: "+this.id),this.unbind(this.__syncManager,"SYNC_COMPLETED",this.syncCompleteRefresh,this))},updateOptions:function(e){this.__syncManager=this.getSyncManager(),this.bindSyncCompleted(),this.setViewInfo({windowTitle:l().T("FSA004_TAG022","Explore"),backText:l().T("FSA004_TAG022","Explore"),subTitle:"",hideContextMenu:!0})},refreshView:function(){s.CacheHelper.refreshView()},onShow:function(){this.bindSyncCompleted(),this.__selected=!1,u.info("Home View showing"),this.callParent()},onHide:function(){this.unBindSyncCompleted(),u.info("Home View hiding");var e=Ext.ComponentQuery.query("sfmsearch\\.sfmsearchbar")[0];e&&e.enable(),this.callParent()},ready:function(){this.setModel(this.getDeliveryEngine().getMetaModel()),this.__selected=!1;var e=d+".svmx.sfmsearchdelivery.runtime.result.model"+i.generateGUID();Ext.ClassManager.classes[e]||Ext.define(e,{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"name"},{name:"description"},{name:"searchId"}]}),Ext.StoreManager.lookup("operatorStore")||Ext.create(d+".KeyValueStore",{storeId:"operatorStore",data:[{opValue:"Contains",opLabel:l().T("FSA004_TAG024","Contains")},{opValue:"Starts With",opLabel:l().T("FSA004_TAG025","Starts With")},{opValue:"Ends With",opLabel:l().T("FSA004_TAG026","Ends With")},{opValue:"Exact Match",opLabel:l().T("FSA004_TAG012","Exactly")}]});var t=i.array.map(this.getModel(),function(e){return{name:e.name,description:e.description,searchId:e.processObjectId}}),n=Ext.widget("svmx.store",{model:e,data:t}),a=[{itemId:"list",cls:"sfmsearch-lineup-list-view",xtype:"svmx.list",itemCls:"sfmsearch-lineup-list-view-item",store:n,itemTpl:"<div class='listitem-sfmsearch-lineup-list-item-name'>{name}</div><div class='sfmsearch-lineup-list-item-description'>{description}</div>",emptyText:l().T("FSA004_TAG023","No searches found.  Contact your administrator"),listeners:{select:i.proxy(this,"onSearchSelect"),disclose:i.proxy(this,"onSearchSelect")}}];this.add(a)},onSearchSelect:function(e,t){if(!this.__selected){var n=t.get("searchId"),a="searchListView",r=i.array.get(this.getModel(),function(e){return e.processObjectId==n}),o={searchId:n,name:t.get("name"),record:t};r&&1===r.searchDetails.length&&(a="searchresults",o.detailObjectId=r.searchDetails[0].detailObjectId),this.__selected=!0,this.changeView({view:a,options:o})}},doDestroy:function(){s.CacheHelper.refreshView(),this.unBindSyncCompleted(),this.callParent()}}),i.defineGlobal(s.name,s),e.exports=s},function(e,t,n){n(187),n(771),n(775),n(780);var i=n(786),a=n(787),r=n(791),o=n(792),s=n(793),l=n(794),c=n(795),u=n(796),d=n(797),_=n(798),h=n(799),f=n(800),p=n(801),m=n(802),v=n(803),g=n(804),y=n(189),S=n(0).utils;S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"MODEL","data":[{"operationId":"SFMDELIVERY.SAVE_TARGETRECORD_WARNING","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.operations.SaveTargetRecordWarning"}]}}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMDELIVERY.SCAN_BARCODE","command":"com.servicemax.client.sfmdelivery.ui.largemodern.commands.ScanBarcode"}]}}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMDELIVERY.CAPTURE_PHOTO","command":"com.servicemax.client.sfmdelivery.ui.largemodern.commands.CapturePhoto"}]}}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.consoleapp","config":{"app":{"id":"sfmdelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},"views":[{"id":"home","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.homeview.HomeView","default-view":true},{"id":"edit","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.editview.EditView"},{"id":"checklisthomeview","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.checklisthomeview.CheckListHomeView","default-view":true},{"id":"completedchecklistview","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.completedchecklistview.CompletedCheckListView"},{"id":"checklistedit","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.checklistview.CheckListEditView"},{"id":"linedetails","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.homeview.LineDetailsView"},{"id":"editdetails","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.editview.EditDetailsView"},{"id":"documentitems","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.AttachmentDocumentView"},{"id":"imageitems","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.AttachmentDocumentView"},{"id":"lookup","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.lookupview.LookupView"},{"id":"multilookup","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.lookupview.MultiLookupView"},{"id":"viewtext","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.homeview.TextView"},{"id":"edittext","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.editview.TextView"}, {"id":"syncconflict","class-name":"com.servicemax.client.toolspages.ui.largemodern.conflictlistview.SyncConflictView"}],"controller":{"class-name":"com.servicemax.client.sfmdelivery.engine.DeliveryEngineImpl"},"discover":false,"multiple":true}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.settings","config":{"setting-title":"TAG080","setting-class":"com.servicemax.client.sfmdelivery.ui.largemodern.settings.UserInterface"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.settings","config":{"setting-title":"TAG081","setting-class":"com.servicemax.client.sfmdelivery.ui.largemodern.settings.LogConfig"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmdelivery.slaclock","config":{"class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.slaclock.slaClockTimer"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmdelivery.productiq","config":{"class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.productiq.ProductIQ"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmdelivery.mobileinventory","config":{"class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.mobileinventory.MobileInventory"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"SFM002","local-id":"SFMDELIVERY"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA008","local-id":"FSA"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA002","local-id":"FSA"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA007","local-id":"FSA"}}')),S.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"FSA016","local-id":"FSA"}}')),e.exports={impl:i,api:a,checklisthomeview:r,completedchecklistview:o,homeview:s,attachments:l,editview:c,checklistview:u,lookupview:d,commands:_,operations:h,slaclock:f,columndeffactory:p,history:m,productiq:v,mobileinventory:g,utils:y}},function(e,t,n){var i=n(765),a=n(766);n(0).utils;e.exports={impl:i,formulafield:a}},function(module,exports,__webpack_require__){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _typeof2=__webpack_require__(18),_typeof3=_interopRequireDefault(_typeof2),_get2=__webpack_require__(14),_get3=_interopRequireDefault(_get2),_getPrototypeOf=__webpack_require__(1),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(2),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(6),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(3),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(4),_inherits3=_interopRequireDefault(_inherits2),SVMX=__webpack_require__(0).utils,ModuleActivator=__webpack_require__(5).ModuleActivator,SVMXObject=__webpack_require__(5).SVMXObject,DatetimeUtil=__webpack_require__(12).DatetimeUtil,TS=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SFMDELIVERY"),appImpl={name:"com.servicemax.client.sfmbizrules.impl"};appImpl.Module=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).call(this))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(ModuleActivator),appImpl.BusinessRuleValidator=function(_SVMXObject){function _class2(){return(0,_classCallCheck3.default)(this,_class2),(0,_possibleConstructorReturn3.default)(this,(_class2.__proto__||(0,_getPrototypeOf2.default)(_class2)).apply(this,arguments))}return(0,_inherits3.default)(_class2,_SVMXObject),(0,_createClass3.default)(_class2,[{key:"evaluateBusinessRules",value:function(e){var t=e.rules,n=e.data;this.fields=e.fields,this.recordTypeMaps=e.recordTypeMaps;var i=e.pageModel;this.errors=[],this.warnings=[];var a={header:{lines:[n]}};for(var r in n.details)a[r]=n.details[r];for(var o in a)this.__evaluateBusinessRulesOnItems(a[o].lines,o,t,i);this.errors=this.__removeDuplicates(this.errors),this.warnings=this.__removeDuplicates(this.warnings),this.errors.sort(this.__sortObjectsBySequence),this.warnings.sort(this.__sortObjectsBySequence);var s={errors:this.errors,warnings:this.warnings};return delete this.errors,delete this.warnings,delete this.fields,s}},{key:"evaluateEntryCriteriaBusinessRules",value:function(e){var t=e.rules,n=e.data;this.fields=e.fields,this.errors=[],this.warnings=[],this.skipSectionList=[];var i=(this.__evaluateBusinessRulesOnItem(n,"header",t,null),{errors:this.errors,warnings:this.warnings,skipSections:this.skipSectionList});return delete this.errors,delete this.warnings,delete this.fields,delete this.skipSectionList,i}},{key:"__sortObjectsBySequence",value:function(e,t){return e.sequence=parseInt(e.sequence),t.sequence=parseInt(t.sequence),e.sequence-t.sequence}},{key:"__removeDuplicates",value:function(e){for(var t={},n=[],i=0;i<e.length;i++){var a=e[i];t[a.message]||(n.push(a),t[a.message]=!0)}return n}},{key:"__evaluateBusinessRulesOnItems",value:function(e,t,n,i){SVMX.array.forEach(e,function(e){if(e=i?i.getRawValues({data:e,referenceValue:"value",fieldTypes:this.fields}):e,this.__evaluateBusinessRulesOnItem(e,t,n,i)&&"header"!==t)return!1},this)}},{key:"__evaluateBusinessRulesOnItem",value:function(e,t,n,i){var a=void 0,r=void 0,o=void 0,s=void 0,l=!1;for(o in n){r=n[o];var c=r.key||"header";if(c===t){a=c,s=r.name;break}}if(e.RecordTypeId&&this.recordTypeMaps&&r.rules.length){var u=r.rules[0].ruleInfo.bizRule[SVMX.OrgNamespace+"__Source_Object_Name__c"],d=SVMX.array.get(this.recordTypeMaps[u],function(t){return t.recordTypeId==e.RecordTypeId||t.name==e.RecordTypeId||t.fixedName==e.RecordTypeId});d&&(e.RecordTypeId=d.fixedName)}return a&&SVMX.array.forEach(r.rules,function(n,i){var a=this.__evaluateBusinessRuleOnItem(n,e);if(a){var r=SVMX.cloneObject(n);if("header"!==t&&(r.context="details."+t,r.internalId=e.id),this.__reportIssue(r,a,e,s),"Error"==a){if("header"!==t)return!1;l=!0}}else this.skipSectionList&&this.skipSectionList.push(SVMX.cloneObject(n))},this),l}},{key:"__reportIssue",value:function(e,t,n,i){i&&(e.message=i+": "+e.message),e.recordId=n.Id,e.message=e.message?e.message:"",e.message=e.message.replace(/\<.*?\>/g,function(e){return e.replace(/\s.*$/,">")}).replace(/\<(object|script|style|link|embed).*?\>/gi,"").replace(/\<li\>/g,"<li style='list-style:inherit;margin-left:20px !important;margin-top:5px !important;'>").replace(/\<ol\>/g,"<ol style='margin-top:10px;margin-bottom:10px;'/>").replace(/\<ul\>/g,"<ul style='margin-top:10px;margin-bottom:10px;'/>").replace(/\{\{.*?\}\}/g,SVMX.proxy(this,function(t){try{var i=t.substring(2,t.length-2);i=i.replace(/\s/g,"_");var a=SVMX.OrgNamespace+"__"+i+"__c";!(a in n)&&i in n&&(a=i);var r=n[a];switch(this.fields[e.ruleInfo.bizRule[SVMX.OrgNamespace+"__Source_Object_Name__c"]][a]){case"date":case"datetime":return"Ext"in window?Ext.Date.format(n[a],Ext.Date.defaultFormat):n[a];case"int":case"double":var o=n[a];return"Ext"in window?Ext.util.Format.number(o,",0")+String(o).indexOf(".")==-1?"":String(o).replace(/^.*\./,"."):o;default:return r}}catch(e){return"{error}"}})),"Error"==t?this.errors.push(e):this.warnings.push(e)}},{key:"__evaluateBusinessRuleOnItem",value:function __evaluateBusinessRuleOnItem(inRule,inDataOriginal){for(var inData=this.__assignNullForNonAvailableFields(inDataOriginal,inRule),ruleElements=inRule.ruleInfo.bizRuleDetails,results=[],expressions=[],i=0;i<ruleElements.length;i++){var element=ruleElements[i];expressions[i]=this.__generateExpression(element,inData,inRule.ruleInfo.bizRule[SVMX.OrgNamespace+"__Source_Object_Name__c"])}if(expressions.length>0)try{results=SVMX.executeExpressions(expressions,inData),results=SVMX.array.map(results,function(e){return!SVMX.executeExpressionsResultInvalid(e)&&e})}catch(e){}var advancedExpr=inRule.ruleInfo.bizRule[SVMX.OrgNamespace+"__Advance_Expression__c"],evalResults=!1,isError=!1;if(results&&0!==results.length)if(advancedExpr)try{advancedExpr=advancedExpr.replace(/OR/gi,"||").replace(/AND/gi,"&&").replace(/NOT\s*/gi,"!").replace(/\d+/g,function(e){return results[e-1]}),evalResults=eval(advancedExpr)}catch(e){SVMX.getLoggingService().getLogger("SVMX-businessrules").error("EXPR:"+advancedExpr+" fails to compile to javascript"),isError=!0}else evalResults=SVMX.array.every(results,function(e){return e});else isError=!0;if(isError||evalResults)return inRule.ruleInfo.bizRule[SVMX.OrgNamespace+"__Message_Type__c"]}},{key:"__assignNullForNonAvailableFields",value:function(e,t){if(this.fields&&t&&t.ruleInfo&&t.ruleInfo.bizRule&&t.ruleInfo.bizRule[SVMX.OrgNamespace+"__Source_Object_Name__c"]){var n={},i=this.fields[t.ruleInfo.bizRule[SVMX.OrgNamespace+"__Source_Object_Name__c"]];for(var a in i)e.hasOwnProperty(a)?n[a]=e[a]:n[a]=null;return n}return e}},{key:"__generateExpression",value:function(e,t,n){var i={fieldName:e[SVMX.OrgNamespace+"__Field_Name__c"],operand:e[SVMX.OrgNamespace+"__Operand__c"],operator:e[SVMX.OrgNamespace+"__Operator__c"],parameterType:e[SVMX.OrgNamespace+"__Parameter_Type__c"]},a=void 0,r=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0;if(null==n&&t.attributes.type===SVMX.OrgNamespace+"__Checklist__c"&&(n=SVMX.OrgNamespace+"__Checklist__c"),"question"===(l=this.fields[n][i.fieldName])){l=e[SVMX.OrgNamespace+"__Display_Type__c"].toLowerCase()}if("date"===l?u=!0:"datetime"===l&&(d=!0),"Constant"===i.parameterType)switch(i.operand){case"Today":case"Tomorrow":case"Yesterday":c="date",u=!0;break;case"Now":c="datetime",d=!0;break;default:c=l}else"Field Value"==i.parameterType?(c=this.fields[n][i.operand],"date"===c?u=!0:"datetime"===c&&(d=!0)):"Value"==i.parameterType&&(("date"===l||"datetime"===l)&&i.operand?i.operand.length>10?(c="datetime",d=!0):(c="date",u=!0):c=l);o=this.__getOperandExpression(l,i.fieldName,"","",i.operand);var _={NOTCONTAIN:"NOTCONTAINS"};return r=i.operator.toUpperCase(),r=_[r]||r,r=(u||d)&&"date"===c&&-1!=SVMX.array.indexOf(["ne","eq","lt","le","gt","ge"],i.operator)?"$DATE"+r:"$"+r,"$ISNULL"==r||"$ISNOTNULL"==r?a=r+"("+o+")":(s=this.__getOperandExpression(c,i.operand,i.parameterType,l),a=r+"("+o+","+s+")"),a}},{key:"__getOperandExpression",value:function(e,t,n,i,a){return n&&"Field Value"!==n?this.__prepLiteralOperand(i,t,e):this.__prepOperand(e,t,a)}},{key:"__prepLiteralOperand",value:function(e,t,n){switch(e){case"double":case"int":case"currency":case"percent":case"number":return"$NUMBER("+t+")";case"boolean":return"$BOOLEAN("+("string"==typeof t?"'"+t+"'":t)+")";case"date":case"datetime":return this.__prepDateOperand(t,n);default:return null===t||void 0===t?"null":'"'+t.replace(/('|")/g,"\\$1")+'"'}}},{key:"__prepDateOperand",value:function(e,t){switch(e){case"Tomorrow":return"$DATETOMORROW()";case"Today":return"$DATETODAY()";case"Yesterday":return"$DATEYESTERDAY()";case"Now":return"$DATENOW()";default:return null===e?"null":e&&"date"===t?"$TIMEZONEDATE('"+e+"')":"string"==typeof e?"$DATE('"+e+"')":"$DATE("+e+")"}}},{key:"__prepOperand",value:function(e,t,n){if((null===t||""===t)&&"boolean"!=e)return"null";switch(e){case"double":case"int":case"currency":case"percent":case"number":return"$NUMBER("+t+")";case"boolean":return"$BOOLEAN("+t+")";case"date":return"$DATE("+t+")";case"datetime":switch(n){case"Today":case"Tomorrow":case"Yesterday":return"$TIMEZONEDATE($DATE("+t+"))";default:return"$DATE("+t+")"}default:return t}}}]),_class2}(SVMXObject),appImpl.FieldUpdateRuleValidator=function(e){function t(){return(0,_classCallCheck3.default)(this,t),(0,_possibleConstructorReturn3.default)(this,(t.__proto__||(0,_getPrototypeOf2.default)(t)).apply(this,arguments))}return(0,_inherits3.default)(t,e),(0,_createClass3.default)(t,[{key:"doCleanup",value:function(){return this.__updatableFields&&this.__updatableFields.details&&(this.__updatableFields.details=null),(0,_get3.default)(t.prototype.__proto__||(0,_getPrototypeOf2.default)(t.prototype),"doCleanup",this).call(this)}},{key:"evaluateFieldUpdateRules",value:function(e){var t=this,n=e.rules,i=e.data,a=e.pageModel,r=/[\\\]\[\-~!@#$%^&*()+=\|\/{}:"';<>,.? ]/g,o=SVMX.create("com.servicemax.client.sfmbizrules.formulafield.FormulaFieldEngine");this.__aliasMap={},this.__headerContext={},this.__updatableFields={details:{}},this.__fieldTypes=e.fields,this.errors=[],this.warnings=[];for(var s in n)this.__aliasMap[n[s].key]=n[s].id.replace(r,"_");o.initialize({contextRoots:["$D"]});var l=n.header.id.replace(r,"_"),c=a?this.getRawData(i,a,!0):i;this.__headerContext[l]=c,o.addContext(this.__headerContext,"$D");for(var u in c.details)this.__evaluateFieldUpdateRulesOnItems(c.details[u].lines,u,n,a,o);o.addContext(this.__headerContext,"$D"),SVMX.array.forEach(n.header.rules,function(e){var n=e.ruleInfo.bizRuleDetails;SVMX.array.forEach(n,function(e){var n=e[SVMX.OrgNamespace+"__Field_Name__c"],i=e[SVMX.OrgNamespace+"__Formula__c"],a=void 0;if(n&&i){if(t.__updatableFields[n]=!0,(a=o.resolveFormula(i))&&"object"===(void 0===a?"undefined":(0,_typeof3.default)(a))&&"error"in a)return void(t.warnings[0]={message:a.error});(void 0===a||"number"==typeof a&&!isFinite(a)||"number"==typeof a&&isNaN(a))&&(a=""),c[n]=a,o.updateValue(l,n,a)}})});var d={response:c,errors:this.errors,warnings:this.warnings};return o.doCleanup(),d}},{key:"__evaluateFieldUpdateRulesOnItems",value:function(e,t,n,i,a){var r=void 0,o=void 0;for(var s in n)if(n[s].key===t){o=n[s];break}r=this.__aliasMap[t],this.__headerContext[r]=[],this.__updatableFields.details[t]={},SVMX.array.forEach(e,function(e){this.__evaluateFieldUpdateRulesOnItem(e,o,r,this.__updatableFields.details[t],i,a)},this)}},{key:"__evaluateFieldUpdateRulesOnItem",value:function(e,t,n,i,a,r){var o={};o[n]=e,r.addContext(o,"$D"),t&&SVMX.array.forEach(t.rules,function(t,a){this.__evaluateFieldUpdateRuleOnItem(e,t,n,i,r)},this),this.__headerContext[n].push(r.getContext(n))}},{key:"__evaluateFieldUpdateRuleOnItem",value:function(e,t,n,i,a){var r=t.ruleInfo.bizRuleDetails,o=void 0,s=void 0;SVMX.array.forEach(r,function(t){if(s=t[SVMX.OrgNamespace+"__Field_Name__c"],formula=t[SVMX.OrgNamespace+"__Formula__c"],s&&formula){if(i[s]=!0,(o=a.resolveFormula(formula))&&"object"===(void 0===o?"undefined":(0,_typeof3.default)(o))&&"error"in o)return void(this.warnings[0]={message:o.error});e[s]=o,a.updateValue(n,s,o)}},this)}},{key:"getUpdatableFields",value:function(){return this.__updatableFields||{details:{}}}},{key:"getRawData",value:function(e,t,n){var i=void 0;if(i=t?this.getRawValues(e,this.__fieldTypes,n):e,!e.details)return i;i.details={};for(var a in e.details)i.details[a]={lines:[]},this.__getChildRawData(e.details[a].lines,i.details[a].lines,t,n);return i}},{key:"__getChildRawData",value:function(e,t,n,i){var a=0;SVMX.array.forEach(e,function(e){var r=n?this.getRawValues(e,this.__fieldTypes,i):e;e.Id||(e.Id=r.Id="tempChildId_"+a++),t.push(r)},this)}},{key:"getRawValues",value:function(e,t,n){var i={},a=void 0,r=void 0,o=e.attributes&&e.attributes.type,s=t[o]||{};for(a in e)r=e[a],"details"!==a&&(r&&"object"===(void 0===r?"undefined":(0,_typeof3.default)(r))&&"fieldvalue"in r&&"value"in r.fieldvalue&&(r=r.fieldvalue.value),n&&(r=this.__convertFieldValue(r,s[a],!1))),i[a]=r;return i}},{key:"parseResult",value:function(e,t,n){var i={},a=void 0,r=e.attributes&&e.attributes.type,o=n[r]||{};for(a in e)i[a]="details"!==a&&a in t?this.__convertFieldValue(e[a],o[a],!0):e[a];return i}},{key:"__convertFieldValue",value:function(e,t,n){if(""===e)return e;switch(t){case"date":case"datetime":var i=DatetimeUtil;"datetime"===t&&(e=n?i.convertToTimezone(e,null,!0):i.convertToTimezone(e,null,!1)),e="datetime"===t?i.resetSecondsAndFormat(e,"YYYY-MM-DD HH:mm:ss"):i.getFormattedDatetime(e,i.getSaveFormat(t));break;case"string":case"textarea":e=e?new String(e).valueOf():""}return e}}]),t}(SVMXObject),SVMX.defineGlobal(appImpl.name,appImpl),module.exports=appImpl},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(14),p=i(f),m=n(4),v=i(m),g=n(0).utils,y=n(12).DatetimeUtil,S=n(5).SVMXObject,E={name:"com.servicemax.client.sfmbizrules.formulafield"},b=y;E.FormulaFieldEngine=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,d.default)(t,[{key:"doCleanup",value:function(){return window.$F&&delete window.$F,window.$D&&delete window.$D,(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(e){var t={},n=0,i=e.contextRoots,a=i.length;for(n=0;n<a;n++)window[i[n]]={};this.addContext=function(e,t){var n=window[t];for(var i in e){var a=e[i];n[i]=a}},this.updateValue=function(e,t,n){window.$D[e]&&t in window.$D[e]&&(window.$D[e][t]=n)},this.getContext=function(e){return window.$D[e]},this.setProperty=function(e,n){t[e]=n},this.getProperty=function(e){return t[e]},this.resolveFormula=function(e,t){function i(e,t){return l(e)+l(t)}function a(e,t){return l(e)-l(t)}function o(e,t){return l(e)*l(t)}function s(e,t){return l(e)/l(t)}function l(e){var t=parseFloat(e);return isNaN(t)&&(t=0),t}function c(e){return/((?:(?:[1]{1}\d{1}\d{1}\d{1})|(?:[2]{1}\d{3}))[-:\/.](?:[0]?[1-9]|[1][012])[-:\/.](?:(?:[0-2]?\d{1})|(?:[3][01]{1})))(?![\d])/.test(e.toString())}function u(e){if(!e)return!1;if(c(e))return!1;var t=!1;if("string"==typeof e){var n=/^[+-]?(0[oO])[0-7]+$|^[+-]?(0[xX])?[\da-fA-F]+$|^[+-]?(\d+\.?\d*)$|(\d*\.?\d+)$/,i=e.match(n);i&&i.length>0&&i[0]===e&&(t=!0)}else{t=/^-?(\d+\.?\d*)$|(\d*\.?\d+)$/.test(e.toString())}return t}function d(e,t){return u(e)&&u(t)?l(e)===l(t):(void 0===e?"undefined":(0,r.default)(e))===(void 0===t?"undefined":(0,r.default)(t))?e===t:"boolean"==typeof e||"boolean"==typeof t?(t=Boolean(t),(e=Boolean(e))===t):e===t}function _(e,t){return u(e)&&u(t)?l(e)!==l(t):e!==t}function h(e,t){return u(e)&&u(t)?l(e)<l(t):e<t}function f(e,t){return u(e)&&u(t)?l(e)>l(t):e>t}function p(e,t){return u(e)&&u(t)?l(e)<=l(t):e<=t}function m(e,t){return u(e)&&u(t)?l(e)>=l(t):e>=t}function v(e,t,n){if(!e||!t||!n)return"";var i=("0000"+e).slice(-4)+"-"+("00"+t).slice(-2)+"-"+("00"+n).slice(-2);return b.getFormattedDatetime(i,b.getSaveFormat("date"))}function g(e){return e?b.getFormattedDatetime(e,b.getSaveFormat("date")):""}function y(e){return e?b.getFormattedDatetime(e,b.getSaveFormat("datetime")):""}function S(e){return e?(e=b.getFormattedDatetime(e,b.getSaveFormat("date")),b.parseDate(e).getDate()):""}function E(e){return e?(e=b.getFormattedDatetime(e,b.getSaveFormat("date")),b.parseDate(e).getMonth()+1):""}function T(e){return e?(e=b.getFormattedDatetime(e,b.getSaveFormat("date")),b.parseDate(e).getFullYear()):""}function M(){var e=b.macroDrivenDatetime("Today","YYYY-MM-DD","HH:mm:ss");return e=b.getFormattedDatetime(e,b.getSaveFormat("date"))}function I(){var e=b.getCurrentDatetime(b.getSaveFormat("datetime"));return e=b.getFormattedDatetime(e,b.getSaveFormat("datetime"))}function C(e,t,n){var i=b.getDurationBetween(e,t);switch(n){case"INDAYS":return i.asDays();case"INWEEKS":return i.asWeeks();case"INMONTHS":return i.asMonths();case"INYEARS":return i.asYears();default:return 0}}function A(){var e=0,t=arguments.length;for(e=0;e<t;e++)if(!0!==arguments[e])return!1;return!0}function D(){var e=0,t=arguments.length;for(e=0;e<t;e++)if(!0===arguments[e])return!0;return!1}function x(e){return!e}function R(e,t,n){return e?t:n}function O(e,t){e=e||[];var i=0;for(n=0;n<e.length;n++)i+=l(e[n][t]);return i}function L(e,t){return e=e||[],O(e,t)/e.length}function k(e,t){e=e||[];var n=void 0,i=(e.length,0),a=void 0;for(n=0;n<e.length;n++)(a=l(e[n][t]))>i&&(i=a);return i}function N(e,t){e=e||[];var n=void 0,i=e.length,a=i?e[0][t]:0,r=void 0;for(n=0;n<e.length;n++)(r=l(e[n][t]))<a&&(a=r);return a}function w(e,t,n){if(!e||!t||!n)return"";var i=b.getFormattedDatetime(e,b.getSaveFormat("date")),a=b.manipulateDatetime(i,t,n);return b.getFormattedDatetime(a,b.getSaveFormat("date"))}window.$F=window.$F||{ADD:i,SUBTRACT:a,MULTIPLY:o,DIVIDE:s,EQUAL:d,NOTEQUAL:_,LESSTHAN:h,GREATERTHAN:f,LESSTHANEQUAL:p,GREATERTHANEQUAL:m,DATE:v,DATEVALUE:g,DATETIMEVALUE:y,DAY:S,MONTH:E,YEAR:T,TODAY:M,NOW:I,DATEDIFF:C,AND:A,OR:D,NOT:x,IF:R,SUMOF:O,AVGOF:L,MAXOF:k,MINOF:N,ADDTODATE:w};try{return window.eval(e)}catch(e){return{error:"Warning: Error found in configured formula. "+e.message}}}}}]),t}(S),g.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).SVMXObject,y=n(5).EventDispatcher,S={name:"com.servicemax.client.sfmdelivery.impl"};S.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){S.init(),S.init(),S.init(),S.init()}},{key:"initialize",value:function(){S.init(),S.init()}},{key:"afterInitialize",value:function(){var e=m.getClient().getServiceRegistry().getService("com.servicemax.client.preferences").getInstance();e.addPreferenceKey("SFMD-EXT-TEXT-AREA"),e.addPreferenceKey("SFMD-EXT-EDIT"),e.addPreferenceKey("SFMD-LUP-WINDOW")}}]),t}(v),S.SFMUIElementsCreationHelper=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"doCreate",value:function(e,t){var n=Ext.create(e,t);return n.__self=Ext.ClassManager.getClass(n),n}}]),t}(g),S.SFMDeliveryEngineEventBus=function(e){function t(e){(0,c.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return n.__de=e,n}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFMDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}},{key:"getDeliveryEngine",value:function(){return this.__de}}]),t}(y),m.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(18),r=i(a),o=n(16),s=i(o),l=n(14),c=i(l),u=n(1),d=i(u),_=n(2),h=i(_),f=n(6),p=i(f),m=n(3),v=i(m),g=n(4),y=i(g),S=n(0).utils,E=n(13).Command,b=n(13).CommandWithResponder,T=n(12).DatetimeUtil,M={name:"com.servicemax.client.sfmdelivery.commands"},I=function(){return S.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};M.GetPageLayout=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){if(e&&e.additionalInfo&&e.additionalInfo.targetId){var n=null,i=S.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");n=i&&!0===i?S.create("com.servicemax.client.sfmdelivery.responders.GetExistingCheckListPageLayoutResponder",t):n=S.create("com.servicemax.client.sfmdelivery.responders.GetExistingCheckListPageLayoutResponderOffline",t);var a={recordId:e.recordId,targetId:e.additionalInfo.targetId,processId:e.processId,qualify:!1,refreshData:!1};this._executeOperationAsync(a,n,{operationId:"SFMDELIVERY.GET_PAGEDATA"})}else e&&!e.processId&&e.additionalInfo&&"CHECKLIST"===e.additionalInfo.sfwActionType?t&&t.result(this._generateStaticChecklistSelection()):this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_PAGELAYOUT"})}},{key:"_generateStaticChecklistSelection",value:function(){var e=I().T("FSA002_TAG002","Checklists"),t={response:{stringMap:[{value1:null,value:"CHECKLIST LIST",key:"PROCESSTYPE",fieldsToNull:null}],sfmProcessType:"CHECKLIST LIST"},page:{processTitle:e,header:{sourceRecordId:null,sections:[{sectionDetail:{attributes:{type:S.OrgNamespace+"__Page_Layout_Detail__c",url:"/services/data/v33.0/sobjects/SVMXC__Page_Layout_Detail__c/"},Name:"LIST_SECTION",Id:""},fieldsToNull:null,fields:[{fieldsToNull:null,fieldEvents:[],fieldDetail:{attributes:{type:S.OrgNamespace+"__Page_Layout_Detail__c",url:"/services/data/v33.0/sobjects/"+S.OrgNamespace+"__Page_Layout_Detail__c/"},Name:"LIST_SECTION_FIELD",Id:"LIST_SECTION_FIELD_ID"},bubbleinfo:{response:{tagId:null,success:null,stringMap:[],StringLstMap:[],stringFieldMap:[],sobjectMap:[],resultIds:[],records:[],profileData:null,msgDetails:null,messageType:null,messages:[],message:null,MapStringMap:[],lstQuestionBank:[],lstFieldSetWithSorting:[],lstChecklistInfo:[],lstBizRuleInfo:[],logMsg:null,eventType:null,docTemplate:null},fieldvalue:{value1:null,value:null,key:null,fieldsToNull:null},fieldapiname:null,bubbleinfo:[]}}]}],pageEvents:[],headerLayout:{attributes:{type:S.OrgNamespace+"__Page_Layout__c",url:"/services/data/v33.0/sobjects/"+S.OrgNamespace+"__Page_Layout__c/xxxxxxxxxxxx"},OwnerId:"",Name:"9999999999",LastModifiedDate:"2015-03-18T11:18:46.000+0000",LastModifiedById:"",IsDeleted:!1,Id:"xxx",CreatedDate:"2015-03-01T12:58:46.000+0000",CreatedById:""},hdrLayoutId:"xxx",hdrData:null,fieldsToNull:null,enableAttachment:!1,buttons:[]},fieldsToNull:null,details:[],businessRules:[]},processTitle:e},n={__Field_Mapping__c:null,__Show_In_iPad__c:!1,__Width__c:null,__Section__r:null,__Show_In_Web__c:!1,__Related_Object_Name_Field__c:null,__Context_Source_Object__c:null,__Title__c:"List",__IsStandard__c:!1,__Sequence__c:1,__Section__c:null,__Page_Layout_Detail_Id__c:null,__Required__c:!1,__Related_Object_Name__c:null,__Readonly__c:!1,__Page_Layout__c:"",__Override_Related_Lookup__c:!1,__Named_Search__c:null,__Named_Search__r:null,__Lookup_Query_Field__c:null,__Lookup_Context__c:null,__Field_API_Name__c:"Virtual_Field_1",__Display_Row__c:null,__Display_Column__c:null,__Detail_Type__c:"Section",__DataType__c:null,__No_Of_Columns__c:1,__Enable_Chatter__c:!1,__Control_Type__c:"Standard",__Maximum_Value__c:null,__Minimum_Value__c:null,__Use_For_SLA_Clock__c:!1,__Enable_Comments__c:!1,__Expression__c:null,__Question__c:null,__QuestionInfoJSON__c:null},i={__Field_Mapping__c:null,__Show_In_iPad__c:!1,__Width__c:null,__Section__r:{attributes:{type:S.OrgNamespace+"__Page_Layout_Detail__c",url:"/services/data/v33.0/sobjects/"+S.OrgNamespace+"__Page_Layout_Detail__c/"}},__Show_In_Web__c:!1,__Related_Object_Name_Field__c:null,__Context_Source_Object__c:null,__Title__c:null,__IsStandard__c:!1,__Sequence__c:1,__Section__c:"",__Page_Layout_Detail_Id__c:null,__Required__c:!1,__Related_Object_Name__c:null,__Readonly__c:!1,__Page_Layout__c:"",__Override_Related_Lookup__c:!1,__Named_Search__c:null,__Named_Search__r:null,__Lookup_Query_Field__c:null,__Lookup_Context__c:null,__Field_API_Name__c:null,__Display_Row__c:null,__Display_Column__c:null,__Detail_Type__c:"List",__DataType__c:"reference",__No_Of_Columns__c:null,__Enable_Chatter__c:!1,__Control_Type__c:"Standard",__Maximum_Value__c:null,__Minimum_Value__c:null,__Use_For_SLA_Clock__c:!1,__Enable_Comments__c:!1,__Expression__c:null},a={__No_Of_Columns__c:1},r={__Type__c:"Header",__Sequence__c:null,__Prompt_For_New_Event__c:!1,__Enable_Attachments__c:!1,__Enable_Chatter__c:!1,__Show_Account_History__c:!1,__Show_All_Sections_By_Default__c:!1,__Show_Product_History__c:!1,__Hide_Save__c:!1,__Hide_Quick_Save__c:!1,__Page_Layout_ID__c:"Checklist",__Page_Help__c:null,__Object_Name__c:S.OrgNamespace+"__Checklist__c",__Multi_Add_Search_Object__c:null,__Multi_Add_Search_Field__c:null,__Multi_Add_Configuration__c:null,__IsStandard__c:!1,__Enable_Service_Report_View__c:!1,__Enable_Troubleshooting__c:!1,__Enable_Service_Report_Generation__c:!1,__Help_URL__c:"http://userdocs.servicemax.com:8080/ServiceMaxHelp/Summer14/en_us/svmx_redirector.htm?uid=SFM01_16",__Header_Reference_Field__c:null,__Header_Page_Layout__c:null,__Action_On_Zero_Lines__c:null,__Name__c:"Default Checklist Layout",__Allow_New_Lines__c:!1,__Allow_Delete_Lines__c:!1};return this.__createOrgProperties(t.page.header.sections[0].sectionDetail,n),this.__createOrgProperties(i.__Section__r,a),this.__createOrgProperties(t.page.header.sections[0].fields[0].fieldDetail,i),this.__createOrgProperties(t.page.header.headerLayout,r),t}},{key:"__createOrgProperties",value:function(e,t){for(var n in t)e[S.OrgNamespace+n]=t[n]}}]),t}(E),M.GetLookupConfig=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_LOOKUPCONFIG"})}}]),t}(E),M.DescribeObject=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.DESCRIBE_OBJECT"})}}]),t}(E),M.GetRecordTypes=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_RECORD_TYPES"})}}]),t}(E),M.GetPageData=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_PAGEDATA"})}}]),t}(E),M.GetTemplateData=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_TEMPLATEDATA"})}}]),t}(E),M.CloseProcess=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CLOSE_PROCESS"})}}]),t}(E),M.RetrieveSettings=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.RETRIEVE_SETTINGS"})}}]),t}(E),M.GetUserInfo=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_USERINFO"})}}]),t}(E),M.GetRecordConflicted=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,n){(0,c.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"executeAsync",this).call(this,e,n),this._executeOperationAsync(e,this,{operationId:"SFMDELIVERY.GET_RECORD_CONFLICTED"})}}]),t}(b),M.GetViewProcesses=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,n){(0,c.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"executeAsync",this).call(this,e,n),this._executeOperationAsync(e,this,{operationId:"SFMDELIVERY.GET_VIEW_PROCESSES"})}}]),t}(b),M.GetRecordAlreadyOpen=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_RECORD_ALREADY_OPEN"})}}]),t}(E),M.SaveTargetRecordWarning=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"doCleanup",value:function(){return this.setPropertyForCleanup(["__businessRuleValidator","__fieldUpdateRuleValidator"]),(0,c.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"doCleanup",this).call(this)}},{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.SAVE_TARGETRECORD_WARNING"})}}]),t}(b),M.SaveTargetRecord=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return e.__logger=S.getLoggingService().getLogger("SFMDELIVERY-COMMAND-SAVE_TARGETRECORD"),e.__businessRuleValidator=S.create("com.servicemax.client.sfmbizrules.impl.BusinessRuleValidator"),e.__fieldUpdateRuleValidator=S.create("com.servicemax.client.sfmbizrules.impl.FieldUpdateRuleValidator"),e.__request=null,e.__responder=null,e.__inProgress="",e.__saveResult=null,e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){e.deliveryEngine.getRoot()&&(e.deliveryEngine.getRoot().doBeforeSave(),e.deliveryEngine.getRoot().hideErrorUI(!0,!0)),this.__request=e,this.__responder=t,this.saveToModel(e,t)}},{key:"saveToModel",value:function(e,t){var n=this,i=e.additionalInfo.toModelOnly;void 0!=i&&null!=i||(i=!1);var a=e.deliveryEngine.saveToModel(!0),r=e.additionalInfo.returnWarningsWithErrors;if(!a.canContinue||r&&a.hasWarnings&&!e.fieldValidatioConfirmed){var o,s=e.deliveryEngine.getEventBus();e.deliveryEngine.getRoot()?(e.deliveryEngine.getRoot().unblockApplication(),o=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_APP_ERROR",this,{request:{deliveryEngine:e.deliveryEngine,message:a.errors},responder:{}}),s.triggerEvent(o)):(o=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.VALIDATION_ERROR",this,{message:a.errors,warnings:a.warnings,request:{result:{errors:a.errors,warnings:a.warnings},original:{request:e,responder:t,context:n}},responder:n}),s.triggerEvent(o))}else if(!1!==i||r)n.__decideWhatToResolveBeforeSave(e,t);else{var l=void 0,c=a.validations,u=c.length,d=void 0,_=void 0,h=[];for(l=0;l<u;l++)d=c[l],_=d.additionalInfo,_&&!0===_.isWarning&&h.push(d.message);if(h.length>0){e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().unblockApplication(),u=h.length;var f=S.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");if(f&&!0===f&&e.deliveryEngine.getRoot().__oldDetailWarningMessages){var p=[],m=0;if(e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().__oldDetailWarningMessages.length>0)for(var v=e.deliveryEngine.getRoot().__oldDetailWarningMessages,g=0;g<u;g++)for(var y=0;y<v.length;y++)if(v[y]==h[g]){m++;break}if(m!=u){for(e.deliveryEngine.getRoot()&&(e.deliveryEngine.getRoot().__oldDetailWarningMessages=[]),l=0;l<u;l++){var E={};E.message=h[l],E.type="warning",p.push(E),e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().__oldDetailWarningMessages.push(h[l])}var s=e.deliveryEngine.getEventBus();o=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_APP_ERROR",this,{request:{deliveryEngine:e.deliveryEngine,message:p},responder:{}}),s.triggerEvent(o)}else e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().blockApplication(),this.__doResolveValuesBeforeSave(e,t)}else{var b="";for(l=0;l<u;l++)b+="<div>"+h[l]+"</div>";var s=e.deliveryEngine.getEventBus(),o=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SAVE_TARGETRECORD_WARNING",this,{request:{message:b,original:{request:e,responder:t,context:n}},responder:n});s.triggerEvent(o)}}else n.__decideWhatToResolveBeforeSave(e,t)}}},{key:"__decideWhatToResolveBeforeSave",value:function(e,t){var n=S.getClient().getApplicationParameter("svmx-sfm-disable-lookup-autoresolve");n=!!n,n?this.__doResolveBusinessRulesBeforeSave(e,t):this.__doResolveValuesBeforeSave(e,t)}},{key:"__doResolveValuesBeforeSave",value:function(e,t){var n=e.deliveryEngine.resolveModel(),i=void 0,a=void 0,r=[],o=[],s=[];if(n.length>0){for(a=n.length,i=0;i<a;i++)n[i].isResolved||(n[i].isDetailsSection?s.push(n[i]):n[i].context.__metamodel&&n[i].context.__metamodel.lookupContext?o.push(n[i]):r.push(n[i]));this.__resolveHeaderLookup(r,o,s,e,t)}else this.__doResolveBusinessRulesBeforeSave(e,t)}},{key:"__resolveHeaderLookup",value:function(e,t,n,i,a){var r=this;if(e.length>0||t.length>0||n.length>0){var o=[],s=[],l=this.__cycleResolveValuesBeforeSave(r,e,o);l=l.then(function(e){return r.__cycleResolveValuesBeforeSave(r,t,e)}),l=l.then(function(e){return r.__cycleResolveValuesBeforeSave(r,n,e)}),l=l.done(function(e){var t={me:r,paramsArray:e,errorDetails:s,canContinueAfterResolve:!0,request:i,responder:a};r.__doResolveValuesBeforeSaveFinished(t)})}else this.__doResolveBusinessRulesBeforeSave(i,a)}},{key:"__cycleResolveValuesBeforeSave",value:function(e,t,n){var i=t.length,a=i,r=S.Deferred();if(i>0)for(var o=0;o<i;o++)t[o].resolver.call(t[o].context,{handler:function(e,t){e&&n.push(e),t&&a--,a<=0&&r.resolve(n)}});else r.resolve(n);return r}},{key:"__doResolveValuesBeforeSaveFinished",value:function(e){for(var t=0;t<e.paramsArray.length;t++){if(1==e.paramsArray[t].countIsZero)if(e.paramsArray[t].errorDetails instanceof Array)for(var n=0;n<e.paramsArray[t].errorDetails.length;n++)e.errorDetails.push(e.paramsArray[t].errorDetails[n]);else e.errorDetails.push(e.paramsArray[t].errorDetails);0==e.paramsArray[t].canContinueAfterResolve&&(e.canContinueAfterResolve=!1)}if(!0===e.request.additionalInfo.toModelOnly)return e.request.deliveryEngine.saveToModel(!1),void e.request.deliveryEngine.getRoot().unblockApplication();if(0==e.errorDetails.length&&e.canContinueAfterResolve){var i=e.request.deliveryEngine.getRoot().getDiscardUnresolvedLUPIndicatorAction();i&&i.isVisible()&&i.hide(),e.request.deliveryEngine.saveToModel(!1),e.me.__doResolveBusinessRulesBeforeSave(e.request,e.responder)}else{var a=e.request.deliveryEngine.getRoot().getDiscardUnresolvedLUPIndicatorAction();if(a&&!a.isVisible()&&a.show(),e.request.deliveryEngine.getRoot().unblockApplication(),e.errorDetails.length>0){var r=e.request.deliveryEngine.getEventBus(),o=void 0;o=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_APP_ERROR",this,{request:{deliveryEngine:e.request.deliveryEngine,message:e.errorDetails},responder:{}}),r.triggerEvent(o)}}}},{key:"__doResolveFieldUpdateRulesBeforeSave",value:function(e,t){if(e.deliveryEngine.isFieldUpdatesEnabled()){var n=e.deliveryEngine.getMetaModel().getFieldUpdateRulesHash();if(S.array.map(n,function(e){return e.rules}).length){var i=e.deliveryEngine.getMetaModel().getFieldTypes(),a=e.deliveryEngine.getTargetData().getData(),r=a.getRawValues(),o=this.__fieldUpdateRuleValidator.evaluateFieldUpdateRules({rules:n,data:r,fields:i,pageModel:a}),s=o.errors.length||o.warnings.length&&!e.confirmed;if(s){var l=e.deliveryEngine.getEventBus(),c=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.FIELD_UPDATE_VALIDATION_ERROR",this,{request:{original:{request:e,responder:t},deliveryEngine:e.deliveryEngine,result:o,eventType:"onsave"},responder:{}});l.triggerEvent(c)}else{var u=this.__fieldUpdateRuleValidator.getUpdatableFields(n);e.deliveryEngine.getMetaModel().applyFieldUpdateResults(r,o.response,u,i),e.deliveryEngine.getTargetData().executeBinding()}return s}}}},{key:"__evalauteBusinessRules",value:function(e){var t=e.deliveryEngine.__page.getFieldTypes(),n=e.deliveryEngine.getTargetData().getData(),i=n.getRawValues(),a=e.deliveryEngine.__page.getBusinessRulesHash(),r=e.deliveryEngine.getPageMetaData().__recordTypesMap;return this.__businessRuleValidator.evaluateBusinessRules({rules:a,data:i,fields:t,pageModel:n,recordTypeMaps:r})}},{key:"__formatBizzRuleResults",value:function(e,t){var n={};return n.errors=this.__getFormattedBizzRuleResult(e,t.errors,"error"),n.warnings=this.__getFormattedBizzRuleResult(e,t.warnings,"warning"),n}},{key:"__getFormattedBizzRuleResult",value:function(e,t,n){var i=[],a=0,r=t.length,o=e.deliveryEngine.__page.getDataModel(),l=o.__allBindings,c=e.deliveryEngine.__page.getChildNode("details")&&e.deliveryEngine.__page.getChildNode("details").getChildNode("details");for(a;a<r;a++){(function(){var r=t[a].ruleInfo.bizRuleDetails[0][S.OrgNamespace+"__Field_Name__c"],o=S.array.filter(l,function(e){return e.__path===r}),u=t[a].message;if(o&&o.length){var d=o[0],_={type:n,message:u};if(d.__bizzRuleValidator&&d.__bizzRuleValidator.handler)return i.push(d.__bizzRuleValidator.handler.call(d.__bizzRuleValidator.context,_)),"continue";if(!t[a].context)return i.push({message:u}),"continue"}else if(!t[a].context)return i.push({message:u}),"continue";if(c&&c.length){var h=e&&e.deliveryEngine&&e.deliveryEngine.__page&&e.deliveryEngine.__page.getBusinessRulesHash(),f=S.array.filter(t,function(e){return e&&e.message&&e.message===u}),p=(0,s.default)(h).length&&f.length&&f[0].aliasName&&h[f[0].aliasName].name,m=S.array.filter(c,function(e){return e&&e.__allColumnDataBindingsHash&&p&&e.__allColumnDataBindingsHash[r]&&e.title===p});if(m.length){var v=m[0].__dataBinding.__path,g=S.array.filter(l,function(e){return e.__path===v}),y={type:n,message:u,recordId:t[a].recordId};g[0]&&g[0].__bizzRuleValidator&&g[0].__bizzRuleValidator.handler?i.push(g[0].__bizzRuleValidator.handler.call(g[0].__bizzRuleValidator.context,y)):i.push({message:u})}else i.push({message:u})}else i.push({message:u})})()}return i}},{key:"__doResolveBusinessRulesBeforeSave",value:function(e,t){if(!this.__doResolveFieldUpdateRulesBeforeSave(e,t)){var n=S.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr"),i=this.__evalauteBusinessRules(e);(!n||n&&"CHECKLIST"===e.deliveryEngine.getMetaModel().getProcessType())&&(i=this.__formatBizzRuleResults(e,i));if(i.errors.length||i.warnings.length&&!e.confirmed){var a=e.deliveryEngine.getEventBus(),r=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ADV_VALIDATION_ERROR",this,{request:{original:{request:e,responder:t},deliveryEngine:e.deliveryEngine,result:i},responder:{}});return a.triggerEvent(r)}this.__doSave(e,t)}}},{key:"__doSave",value:function(e,t){var n={startSave:!0,eventType:e.additionalInfo.eventType};e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().updateQuickSaveIcon(n);var i=!S.getClient().getApplicationParameter("svmx-sfm-disable-events")&&e.deliveryEngine.getPageMetaData().getHeaderMetaModel().getPageEventInfoFor("Before Save");if(i){this.__inProgress="Before Save",this.__logger.info("Performing => "+this.__inProgress);var a=this.getEventBus(),r=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:[i],data:e.deliveryEngine.getTargetData().getData(),metadata:e.deliveryEngine.getPageMetaData().getRawPageMetaData(),deliveryEngine:e.deliveryEngine,bypassSave:!0,additionalInfo:{processId:e.deliveryEngine.processId,nextStepId:e.deliveryEngine.nextStepId},invokedFrom:"Befor Save"},responder:S.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)});a.triggerEvent(r)}else this.__inProgress="Save",this.__logger.info("Performing => "+this.__inProgress),this.__executeOperation(e)}},{key:"__executeOperation",value:function(e){this._executeOperationAsync(e,this,{operationId:"SFMDELIVERY.SAVE_TARGETRECORD"})}},{key:"result",value:function(e){if("Before Save"==this.__inProgress)this.__inProgress="Save",this.__logger.info("Performing => "+this.__inProgress),this._executeOperationAsync(this.__request,this,{operationId:"SFMDELIVERY.SAVE_TARGETRECORD"});else if("Save"==this.__inProgress){this.__saveResult=e;var t=!this.__saveResult.error&&(!S.getClient().getApplicationParameter("svmx-sfm-disable-events")&&this.__request.deliveryEngine.getPageMetaData().getHeaderMetaModel().getPageEventInfoFor("After Save"));if(t){this.__inProgress="After Save",this.__logger.info("Performing => "+this.__inProgress);var n=this.getEventBus(),i=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:[t],data:this.__request.deliveryEngine.getTargetData().getData(),metadata:this.__request.deliveryEngine.getPageMetaData().getRawPageMetaData(),deliveryEngine:this.__request.deliveryEngine,bypassSave:!0,additionalInfo:{processId:this.__request.deliveryEngine.processId,nextStepId:this.__request.deliveryEngine.nextStepId},invokedFrom:"After Save"},responder:S.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)});n.triggerEvent(i)}else this.__responder.result(this.__saveResult)}else this.__responder.result(this.__saveResult)}},{key:"fault",value:function(e){}}]),t}(b),M.SaveTargetAttachmentRecord=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.SAVE_TARGETATTACHMENTRECORD"})}}]),t}(b),M.SaveChecklistTargetRecord=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"saveToModel",value:function(e,t){var n=e.additionalInfo.toModelOnly;if(void 0!=n&&null!=n||(n=!1),n){if(!e.deliveryEngine.saveToModel(!1).canContinue)return;this.__doSave(e,t)}else this.__executeValidationsAndBusinessRules(e,t)}},{key:"__isSubmitEvent",value:function(e){return"validated save"===e.additionalInfo.eventType||"submit"===e.additionalInfo.eventType}},{key:"removeSkippedQuestionsFromSFMData",value:function(e){for(var t=e.deliveryEngine.getTargetData().getData().getRawData().sfmData,n=e.deliveryEngine.skippedSectionsQuestions,i=0;i<n.length;i++){delete t[n[i]]}}},{key:"removeSkippedQuestionValidationWarningErrors",value:function(e,t){var n=e.deliveryEngine.skippedSectionsQuestions;return t.errors=this.filterSkippedQuestionValidationResults(n,t.errors),t.validations=this.filterSkippedQuestionValidationResults(n,t.validations),t.warnings=this.filterSkippedQuestionValidationResults(n,t.warnings),t}},{key:"filterSkippedQuestionValidationResults",value:function(e,t){for(var n=e,i=t,a=0;a<n.length;a++){var r=i.length-1;for(r;r>=0;r--){var o=i[r].fieldName||i[r].questionNumber;n[a].indexOf(o)>-1&&i.splice(r,1)}}return i}},{key:"__executeValidationsAndBusinessRules",value:function(e,t){var n=e.deliveryEngine.saveToModel(!0);this.removeSkippedQuestionsFromSFMData(e),n=this.removeSkippedQuestionValidationWarningErrors(e,n);var i=this.__evalauteBusinessRules(e);if(0===n.errors.length&&0===i.errors.length&&(0===i.warnings.length||i.warnings.length&&e.confirmed))if(!0===S.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr"))this.__doSave(e,t);else{var a=e.deliveryEngine.getEventBus();if(a){var r={request:e,responder:t,commands:this},o=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CHECKLIST_VALIDATION_SUCCESS",r);a.triggerEvent(o)}}else{var s=this.__formatBizzRuleResults(e,i),l=e.deliveryEngine.getEventBus(),c=this.__mergeValidationAndBizzRuleResults(n,s),u=S.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ADV_VALIDATION_ERROR",this,{message:c.errors,warnings:c.warnings,request:{result:{errors:c.errors,warnings:c.warnings},original:{request:e,responder:t,context:this}},responder:this});l.triggerEvent(u)}}},{key:"__mergeValidationAndBizzRuleResults",value:function(e,t){var n=this.__removeDuplicatesFromBizzRulesResults(e.errors,t.errors);e.errors.push.apply(e.errors,n);var i=this.__removeDuplicatesFromBizzRulesResults(e.warnings,t.warnings);e.warnings.push.apply(e.warnings,i);var a=S.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");return(a&&!1===a||void 0===a)&&(S.sort(e.errors,"questionNumber"),S.sort(e.warnings,"questionNumber")),e}},{key:"__removeDuplicatesFromBizzRulesResults",value:function(e,t){var n=0,i=e.length;for(n;n<i;n++){var a=e[n].questionNumber;if(S.array.filter(t,function(e){return e.questionNumber===a}).length){var r=S.array.map(t,function(e,t){if(e.questionNumber===a)return t});r.length&&t.splice(r[0],1)}}return t}},{key:"__doSave",value:function(e,t){e=e||{},e.additionalInfo=e.additionalInfo||{};var n=this.__isSubmitEvent(e);e.deliveryEngine.getPageMetaData().getChildNode("header").getData().activeSectionIndex=n?0:e.additionalInfo.activeSectionIndex;var i=e.deliveryEngine.getPageMetaData().getRawPageMetaData();i=i?S.toJSON(i):"";var a=e.deliveryEngine.getTargetData().getData().getRawData().sfmData,r=e.deliveryEngine.getMetaModel().getQuestionData(a),o=e.deliveryEngine.lastVisitedSectionIndex>e.additionalInfo.activeSectionIndex?e.deliveryEngine.lastVisitedSectionIndex:e.additionalInfo.activeSectionIndex,s=e.deliveryEngine.__page.getChildNode("header").getChildNode("sections"),l=S.toObject(a[S.OrgNamespace+"__ChecklistJSON__c"])||{},c=s.length,u=0,d=0;for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&u++;for(var h=0;h<=o&&o<=c;h++){var f=[];s[h]&&(f=s[h].getChildNode("fields"));for(var p=0;p<f.length;p++)f&&f[p]&&f[p].fieldName&&(l[f[p].fieldName]=r[f[p].fieldName],d++)}if(u>d&&o<c-1&&"submit"!==e.additionalInfo.eventType&&(f=s[o+1]&&s[o+1].getChildNode("fields")))for(var p=0;p<f.length;p++)f&&f[p]&&f[p].fieldName&&(l[f[p].fieldName]=r[f[p].fieldName]);if(e.deliveryEngine.skippedSectionsQuestions&&e.deliveryEngine.skippedSectionsQuestions.length>0)for(var m=0;m<e.deliveryEngine.skippedSectionsQuestions.length;m++)if(l.hasOwnProperty(e.deliveryEngine.skippedSectionsQuestions[m])){var v=e.deliveryEngine.skippedSectionsQuestions[m];v&&e.data&&e.data.__attachementData&&e.data.__attachementData.__attachementDataHash&&e.data.__attachementData.__attachementDataHash.hasOwnProperty(v)&&this.__resetChecklistAttachmentQuestion(e,v),delete l[e.deliveryEngine.skippedSectionsQuestions[m]]}r=r?S.toJSON(l):"",a[S.OrgNamespace+"__ChecklistMetaJSON__c"]=i,a[S.OrgNamespace+"__ChecklistJSON__c"]=r,a[S.OrgNamespace+"__What_Id__c"]||(a[S.OrgNamespace+"__What_Id__c"]=e.sourceRecordId),a[S.OrgNamespace+"__ChecklistProcessID__c"]=e.additionalInfo.sfProcessId,e.skipAggressiveSync=!n,e.doSourceObjectUpdate=n,e.skipStatusMsg=!0,a[S.OrgNamespace+"__Status__c"]=n?"Completed":"In Process";var g=e.additionalInfo.newChecklist,y=e.additionalInfo.trackLocation,E=e.additionalInfo.locationDetails;if(n||g&&y){var b=null;e.deliveryEngine&&e.deliveryEngine.getMetaModel()&&e.deliveryEngine.getMetaModel().getUserInfo()&&(b=e.deliveryEngine.getMetaModel().getUserInfo());var M=void 0;if(b){M=T.macroDrivenDatetime("Now","YYYY-MM-DD","HH:mm:ss");var I=S.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");I&&!0===I&&(M=T.convertToTimezone(M,b.TimezoneOffset,!1))}n&&(a[S.OrgNamespace+"__Completed_By__c"]=b&&b.UserId,a[S.OrgNamespace+"__Completed_On__c"]=M,y&&(a[S.OrgNamespace+"__SM_Checklist_End_Latitude__c"]=E&&E.lat,a[S.OrgNamespace+"__SM_Checklist_End_Longitude__c"]=E&&E.lng)),y&&(a[S.OrgNamespace+"__SM_Started_By__c"]=a[S.OrgNamespace+"__SM_Started_By__c"]||b&&b.UserId,a[S.OrgNamespace+"__SM_Started_On__c"]=a[S.OrgNamespace+"__SM_Started_On__c"]||M,a[S.OrgNamespace+"__SM_Checklist_Start_Latitude__c"]=a[S.OrgNamespace+"__SM_Checklist_Start_Latitude__c"]||E&&E.lat,a[S.OrgNamespace+"__SM_Checklist_Start_Longitude__c"]=a[S.OrgNamespace+"__SM_Checklist_Start_Longitude__c"]||E&&E.lng)}e.deliveryEngine.getMetaModel().removeQuestionData(a),this.__inProgress="Save",this.__logger.info("Performing => "+this.__inProgress),this._executeOperationAsync(e,this,{operationId:"SFMDELIVERY.SAVE_TARGETRECORD"})}},{key:"__resetChecklistAttachmentQuestion",value:function(e,t){var n=e.data.__attachementData.__attachementDataHash[t];n&&(e.deliveryEngine.getTargetData().__allBindingsHash[t].__context.resetAttachmentValue(),e.data.__attachementData.__deletedRecords.push(n))}}]),t}(M.SaveTargetRecord),M.GetNextStepInfo=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_NEXTSTEPINFO"})}}]),t}(E),M.InvokeEvents=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return e.__logger=S.getLoggingService().getLogger("SFMDELIVERY-COMMAND-INVOKE_EVENTS"),e.__currentEventIndex=0,e.__allEvents=null,e.__responder=null,e.__request=null,e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){if(e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().doBeforeSave(),e.deliveryEngine.getRoot()&&e.deliveryEngine.getRoot().hideErrorUI(!0,!0),this.__allEvents=e.events,this.__currentEventIndex=-1,this.__request=e,this.__responder=t,!e.bypassSave&&e.deliveryEngine){if(!e.deliveryEngine.saveToModel().canContinue)return}else S.getLoggingService().getLogger().warning("Ignoring saveToModel() because either request.bypassSave is true OR deliveryEngine instance is missing");this.__invokeNextEvent()}},{key:"__invokeNextEvent",value:function(){this.__currentEventIndex++;var e=this.__allEvents[this.__currentEventIndex];this.__logger.info("Invoking event => "+S.toJSON(e)),this.__request&&this.__request.deliveryEngine&&(this.__request.deliveryEngine.customSnippetSource=this.__request.invokedFrom),this._executeOperationAsync({event:e,data:this.__request.data,metadata:this.__request.metadata,additionalInfo:this.__request.additionalInfo},this,{operationId:"SFMDELIVERY.INVOKE_EVENT"})}},{key:"result",value:function(e){this.__currentEventIndex==this.__allEvents.length-1?this.__responder.result():this.__invokeNextEvent()}},{key:"fault",value:function(e){}}]),t}(b),M.AddRecords=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.ADD_RECORDS"})}}]),t}(E),M.DeleteRecords=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.DELETE_RECORDS"})}}]),t}(E),M.CopyRecords=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.COPY_RECORDS"})}}]),t}(E),M.GetBubbleData=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_BUBBLEDATA"})}}]),t}(E),M.GetDetailMappedInfo=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_DETAIL_MAPPEDINFO"})}}]),t}(E),M.LookupItemSelected=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.LOOKUP_ITEM_SELECTED"})}}]),t}(E),M.ChangeApplicationState=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){if(e.deliveryEngine)e.deliveryEngine.changeApplicationState(e.state);else{S.getCurrentApplication().getApplicationStateHandler().changeApplicationState(e.state)}}}]),t}(E),M.NotifyApplicationError=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){if(e.deliveryEngine)e.deliveryEngine.notifyApplicationError(e);else{S.getCurrentApplication().getApplicationErrorHandler().notifyApplicationError(e)}}}]),t}(E),M.NotifyQuickMessage=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){if(e.deliveryEngine)e.deliveryEngine.showQuickMessage(e.state);else{S.getCurrentApplication().getApplicationQuickMessageHandler().showQuickMessage(e.message,e.duration,e.type)}}}]),t}(E),M.GetProductHistory=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_PRODUCT_HISTORY"})}}]),t}(E),M.GetOnlineProductHistory=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_ONLINE_PRODUCT_HISTORY"})}}]),t}(E),M.GetAccountHistory=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_ACCOUNT_HISTORY"})}}]),t}(E),M.GetOnlineAccountHistory=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_ONLINE_ACCOUNT_HISTORY"})}}]),t}(E),M.DownloadRecordOnDemand=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.DOWNLOAD_RECORD_ON_DEMAND"})}}]),t}(E),M.ListAttachments=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.LIST_ATTACHMENTS"})}}]),t}(E),M.ListOutputDocAttachments=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.LIST_OUTPUTDOC_ATTACHMENTS"})}}]),t}(E),M.EditAttachment=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EDIT_ATTACHMENT"})}}]),t}(E),M.DeleteAttachments=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.DELETE_ATTACHMENTS"})}}]),t}(E),M.AttachFile=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.ATTACH_FILE"})}}]),t}(E),M.OpenAttachment=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.OPEN_FILE"})}}]),t}(E),M.ShareAttachments=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.SHARE_ATTACHMENTS"})}}]),t}(E),M.OpenBrowser=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.OPEN_BROWSER"})}}]),t}(E),M.GetUrlAndParameters=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_URL_AND_PARAMETERS"})}}]),t}(E),M.OpenTelephone=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.OPEN_TELEPHONE"})}}]),t}(E),M.OpenSMS=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.OPEN_SMS"})}}]),t}(E),M.OpenEmail=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.OPEN_EMAIL"})}}]),t}(E),M.CheckIfConflict=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CHECK_IF_CONFLICT"})}}]),t}(E),M.IsDodRecord=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.IS_DOD_RECORD"})}}]),t}(E),M.ChecklistEntryCriteria=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return e.__logger=S.getLoggingService().getLogger("SFMDELIVERY-EVALUATE_ENTRY_CRITERIA"),e.__businessRuleValidator=S.create("com.servicemax.client.sfmbizrules.impl.BusinessRuleValidator"),e.__request=null,e.__responder=null,e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"doCleanup",value:function(){return this.setPropertyForCleanup("__businessRuleValidator"),(0,c.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"doCleanup",this).call(this)}},{key:"executeAsync",value:function(e,t){this.__request=e,this.__responder=t,this.__executeEntryCriteriaBusinessRules(e,t)}},{key:"__executeEntryCriteriaBusinessRules",value:function(e,t){var n=e.data,i=e.deliveryEngine.__page.getEntryCriteriaBusinessRuleHash(e.additionalInfo.eventType);if(i.header.rules.length>0){for(var a=i.header.rules,o=0;o<a.length;o++)a[o].ruleInfo.bizRule[S.getCustomFieldName("Message_Type")]="Error";if(i.header&&a&&a.length>0&&(sourceObjectName=i.header.rules[0].ruleInfo.bizRule[S.getCustomFieldName("Source_Object_Name")]),sourceObjectName){var s={},l={},c={};if(n.getRawValues)for(var u in n._fields.fields){var d=n.getRawValues()[u],_=n.getFieldType(u);n.setValue(u,this.__convertFieldValue(d,_)),l[u]=d,s[u]=_}else for(var h in n._fields.fields){var f=n[h],p=n._fields.fields[h].dataType;"object"===(void 0===f?"undefined":(0,r.default)(f))&&(f=f&&f.fieldvalue&&f.fieldvalue.value),f=this.__convertFieldValue(f,p),l[h]=f,s[h]=p}c[sourceObjectName]=s}var m=this.__businessRuleValidator.evaluateEntryCriteriaBusinessRules({rules:i,data:l,fields:c});if(m.skipSections.length>0){var v=this.__processSectionListToRemoveEntryCriteriaUnQualifiedSections(m.skipSections);this.deleteRulesofDeletedQuestions(e.deliveryEngine.__page,v,m.skipSections)}}this.__responder.result(e.additionalInfo.eventType)}},{key:"__convertFieldValue",value:function(e,t){switch(t){case"date":if(!e)return e;var n=T.parseDate(e);return this.__isDateObject(n)&&n.setHours(0,0,0),n;case"datetime":if(!e)return e;var n=T.parseGMTDate(e);return n;case"boolean":return"true"===e||!0===e;case"double":case"percent":case"currency":return"string"==typeof e?Number(e):e;default:return e}}},{key:"__isDateObject",value:function(e){return e instanceof Date&&!isNaN(e.getTime())||(this.__logger.error("Invalid Date Object;",e),!1)}},{key:"__processSectionListToRemoveEntryCriteriaUnQualifiedSections",value:function(e){for(var t=[],n=[],i=0;i<e.length;i++)t.push(e[i].ruleInfo.bizRule[S.getCustomFieldName("SM_Section")]);var a=this.__request.deliveryEngine.getPageMetaData().getRawPageMetaData(),r=a.page.header.sections;if(a&&a.page&&a.page.header&&r&&r.length>0)for(var o=a.page.header.sections.length-1;o>=0;o--)if(section=r[o],section&&section.sectionDetail&&section.sectionDetail.Id&&section.sectionDetail.Id.length>0&&t.indexOf(section.sectionDetail.Id)>-1){section.sectionDetail[S.OrgNamespace+"__Entry_Criteria__c"]=!0;for(var s=0;s<section.fields.length;s++){var l=section.fields[s].fieldDetail;if(l){var c=S.toObject(l[S.getCustomFieldName("QuestionInfoJSON")]);n.push(c.question.questionID)}}}return n}},{key:"deleteRulesofDeletedQuestions",value:function(e,t,n){for(var i=e._data.page.businessRules,a=[],r=0;r<n.length;r++)a.push(n[r].ruleInfo.bizRule[S.getCustomFieldName("SM_Section")]);for(var o=i.length-1;o>=0;o--){var s=i[o];(s.ruleInfo&&s.ruleInfo.bizRuleDetails.length>0&&t.indexOf(s.ruleInfo.bizRuleDetails[0][S.getCustomFieldName("Field_Name")])>-1||s.ruleInfo.bizRule&&a.indexOf(s.ruleInfo.bizRule[S.getCustomFieldName("SM_Target_Section")])>-1)&&i.splice(o,1)}}}]),t}(b),M.ChecklistExitCriteria=function(e){function t(){(0,h.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return e.__logger=S.getLoggingService().getLogger("SFMDELIVERY-EVALUATE_CHECKLIST_EXIT_CRITERIA"),e.__businessRuleValidator=S.create("com.servicemax.client.sfmbizrules.impl.BusinessRuleValidator"),e.__request=null,e.__responder=null,e}return(0,y.default)(t,e),(0,p.default)(t,[{key:"doCleanup",value:function(){return this.setPropertyForCleanup("__businessRuleValidator"),(0,c.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"doCleanup",this).call(this)}},{key:"executeAsync",value:function(e,t){this.__request=e,this.__responder=t,this.__executeExitCriteriaBusinessRules(e,t)}},{key:"__executeExitCriteriaBusinessRules",value:function(e,t){var n={};n.header={},n.header.rules=e.deliveryEngine.__page.__getEntryExitCriteriaBusinessRule("exitCriteria"),n.header.rules=this.__getCurrentSectionExitCriteriaRules(e.sectionExitRules,n.header.rules);var i=null;if(n.header.rules.length>0){var a=e.deliveryEngine.__page.getFieldTypes(),r=e.deliveryEngine.getTargetData().getData(),o=r.getRawValues(),s=this.__convertFieldValuesToDataTypes(a,o),l=e.deliveryEngine.getPageMetaData().__recordTypesMap;i=this.__businessRuleValidator.evaluateBusinessRules({rules:n,data:s,fields:a,pageModel:r,recordTypeMaps:l})}this.__responder.result(i?i.errors:[])}},{key:"__convertFieldValuesToDataTypes",value:function(e,t){var n=e[S.getCustomObjectName("Checklist")],i={};for(var a in n){var r=t[a],o=n[a],s=this.__convertFieldValue(r,o);i[a]=s}return i}},{key:"__convertFieldValue",value:function(e,t){switch(t){case"date":if(!e)return e;var n=T.parseDate(e);return this.__isDateObject(n)&&n.setHours(0,0,0),n;case"datetime":if(!e)return e;var n=T.parseGMTDate(e);return n;case"boolean":return"true"===e||!0===e;case"double":case"percent":case"currency":return"string"==typeof e?Number(e):e;default:return e}}},{key:"__isDateObject",value:function(e){return e instanceof Date&&!isNaN(e.getTime())||(this.__logger.error("Invalid Date Object;",e),!1)}},{key:"__getCurrentSectionExitCriteriaRules",value:function(e,t){for(var t=t,n=e&&e.records||[],i=[],a=[],r=0;r<n.length;r++)for(var o=n[r],s=0;s<t.length;s++)t[s].ruleInfo.bizRule.Id===o[S.getCustomFieldName("Process3")]&&"Checklist_Section_Exit_Criteria"===t[s].ruleInfo.bizRule[S.getCustomFieldName("Rule_Type")]&&-1===a.indexOf(t[s].ruleInfo.bizRule.Id)&&(a.push(t[s].ruleInfo.bizRule.Id),t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Section")]=null===t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Section")]||void 0===t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Section")]?o[S.getCustomFieldName("SM_Section")]:t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Section")],t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Target_Section")]=null===t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Target_Section")]||void 0===t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Target_Section")]?o[S.getCustomFieldName("SM_Target_Section")]:t[s].ruleInfo.bizRule[S.getCustomFieldName("SM_Target_Section")],t[s].ruleInfo.bizRule[S.getCustomFieldName("Sequence")]=null===t[s].ruleInfo.bizRule[S.getCustomFieldName("Sequence")]||void 0===t[s].ruleInfo.bizRule[S.getCustomFieldName("Sequence")]?o[S.getCustomFieldName("Sequence")]:t[s].ruleInfo.bizRule[S.getCustomFieldName("Sequence")],i.push(t[s]));return i}}]),t}(b),M.ChecklistFileAttachment=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CHECKLIST_FILE_ATTACHMENT"})}}]),t}(E),M.GetChecklistAttachmentFilePath=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.GET_CHECKLIST_ATTACHMENT_FILE_PATH"})}}]),t}(E),M.GetDataForQueryObject=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_DATA_FOR_QUERY_OBJECT"})}}]),t}(E),M.GetClientType=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_CLIENT_TYPE"})}}]),t}(E),M.GetUserLanguage=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_USER_LANGUAGE"})}}]),t}(E),M.GetSfmRecord=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_RECORD"})}}]),t}(E),M.GetCustomEvtInfo=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_EVENT_INFO"})}}]),t}(E),M.GetPicklistValuesForCustomSnippet=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.GET_SFM_PICKLIST_VALUES"})}}]),t}(E),M.SetFieldValueForCustomSnippet=function(e){function t(){return(0,h.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this))}return(0,y.default)(t,e),(0,p.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.CUSTOMSNIPPET.SET_SFM_FIELD_VALUE"})}}]),t}(E),S.defineGlobal(M.name,M),e.exports=M},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.sfmdelivery.responders"};m.GetPageLayoutResponder=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){alert("Done!")}},{key:"fault",value:function(e){}}]),t}(p),m.GetExistingCheckListPageLayoutResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parentResponder=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){e=e||{},e.__data=e.__data||{},e.__data.sfmData=e.__data.sfmData||{};var t=e.__data.sfmData[f.OrgNamespace+"__ChecklistMetaJSON__c"],n=null;if(t)try{n=f.toObject(t)}catch(e){console.warn("Unable to parse Checklist page layout.")}this.__parentResponder&&n?(this.__parentResponder.result(n),this.doCleanup()):this.fault(e)}},{key:"fault",value:function(e){this.__parentResponder&&(this.__parentResponder.fault(e),this.doCleanup())}}]),t}(p),m.GetExistingCheckListPageLayoutResponderOffline=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parentResponder=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){e=e||{},e.__data=e.__data||{},e.__data.sfmData=e.__data.sfmData||{},e.__data.multiVersionRequest&&e.__data.multiVersionRequest.getChecklistMetaJson?(e.__data.multiVersionRequest.getChecklistMetaJson(e,this.__parentResponder,this.fault),this.doCleanup()):this.fault(e)}},{key:"fault",value:function(e){this.__parentResponder&&(this.__parentResponder.fault(e),this.doCleanup())}}]),t}(p),m.GetPageDataResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetPageDataCompleted(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.GetUpdatedSourceObjectRecordResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.ongetUpdatedSourceObjectRecordComplete(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.ReloadPageDataAndNavigateResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onReloadPageDataAndNavigateCompleted(e,this.__params),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.GetUserInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetUserInfoCompleted(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.GetLookupConfigResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetLookupConfigComplete(e),this.doCleanup()}},{key:"fault",value:function(e){this.__parent.onGetLookupConfigError(e)}}]),t}(p),m.GetNextStepInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetNextStepInfoComplete(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.DescribeObjectResponder=function(e){function t(e,n,i){(0,s.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return a.__parent=n,a.__objectName=e,a.__params=i,a}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onDescribeObjectComplete(this.__objectName,e,this.__params),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.SaveTargetRecordResponder=function(e){function t(e,n,i){(0,s.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return a.__parent=e,a.__actionType=n,a.__additionalInfo=i,a}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onSaveTargetRecordComplete({data:e,actionType:this.__actionType,additionalInfo:this.__additionalInfo,error:e.error}),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.QuickSaveTargetRecordResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onQuickSaveTargetRecordComplete(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.InvokeEventsResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e,t){t?this.__parent.onInvokeCustomEventsComplete(e):this.__parent.onInvokeEventsComplete?this.__parent.onInvokeEventsComplete():this.__parent.result(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.AddRecordsResponder=function(e){function t(e,n,i){(0,s.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return a.__parent=e,a.__multiSelectData=n,a.__sfmdetail=i,a}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onAddRecordsComplete(e,this.__multiSelectData,this.__sfmdetail),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.DeleteRecordsResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onDeleteRecordsComplete(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.CopyRecordsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__sfmdetail=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onCopyRecordsCompleted(e,this.__sfmdetail),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.GetBubbleDataResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__request=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetBubbleDataComplete(e,this.__request),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.GetDetailMappedInfoResponder=function(e){function t(e,n,i,a){(0,s.default)(this,t);var o=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return o.__parent=e,o.__params=n,o.__bindingPath=i,o.__callback=a,o}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetDetailMappedInfoComplete(e,this.__params,this.__bindingPath,this.__callback),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.ListAttachmentsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onListAttachmentsComplete(e,this.__params),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.DeleteAttachmentsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onDeleteAttachmentsSuccess(e,this.__params),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.CancelAttachmentsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.refreshAttachments(),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.SelectFileToUploadResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent&&this.__parent.__context?this.__parent.__context.onFileSelectedForUpload(e,this.__params):this.__parent.onFileSelectedForUpload(e,this.__params),this.doCleanup()}},{key:"fault",value:function(e){this.__parent&&this.__parent.__context?this.__parent.__context.onFileSelectedForUploadError(e):this.__parent.onFileSelectedForUploadError(e)}}]),t}(p),m.ChecklistEntryResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onEntryCriteriaExecutionComplete(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.ChecklistExitResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onExitCriteriaExecutionComplete(e),this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.ChecklistFileToUploadResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){(this.__parent.__context||this.__parent).onFileSelectedForUpload(e,this.__params),this.doCleanup()}},{key:"fault",value:function(e){(this.__parent.__context||this.__parent).onFileSelectedForUploadError(e)}}]),t}(p),m.ChecklistAttachmentOperationsResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.doCleanup()}},{key:"fault",value:function(e){}}]),t}(p),m.GetChecklistAttachmentFilePathResponder=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.__parent=e,i.__params=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent&&(this.__parent.onCompletionAttachmentFileReader(e),this.doCleanup())}},{key:"fault",value:function(){}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(98),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10);!function(e){!function(e){function t(e){if(e instanceof Date)return e;if(String(e).match(o))return String(e).match(/^[0-9]*$/)&&(e=Number(e)),String(e).match(/\-/)&&(e=String(e).replace(/\-/g,"/")),new Date(e);throw new Error("Couldn't cast `"+e+"` to a date object.")}function n(e){return function(t){var n=t.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(n)for(var a=0,r=n.length;a<r;++a){var o=n[a].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),l=new RegExp(o[0]),c=o[1]||"",u=o[3]||"",d=null;o=o[2],s.hasOwnProperty(o)&&(d=s[o],d=Number(e[d])),null!==d&&("!"===c&&(d=i(u,d)),""===c&&d<10&&(d="0"+d.toString()),t=t.replace(l,d.toString()))}return t=t.replace(/%%/,"%")}}function i(e,t){var n="s",i="";return e&&(e=e.replace(/(:|;|\s)/gi,"").split(/\,/),1===e.length?n=e[0]:(i=e[0],n=e[1])),1===Math.abs(t)?i:n}var r=[],o=[];o.push(/^[0-9]*$/.source),o.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),o.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),o=new RegExp(o.join("|"));var s={Y:"years",m:"months",w:"weeks",d:"days",D:"totalDays",H:"hours",M:"minutes",S:"seconds"},l=function(t,n,i){this.el=t,this.$el=e(t),this.interval=null,this.offset={},this.instanceNumber=r.length,r.push(this),this.$el.data("countdown-instance",this.instanceNumber),i&&(this.$el.on("update.countdown",i),this.$el.on("stoped.countdown",i),this.$el.on("finish.countdown",i)),this.setFinalDate(n),this.start()};e.extend(l.prototype,{start:function(){null!==this.interval&&clearInterval(this.interval);var e=this;this.update(),this.interval=setInterval(function(){e.update.call(e)},100)},stop:function(){clearInterval(this.interval),this.interval=null,this.dispatchEvent("stoped")},pause:function(){this.stop.call(this)},resume:function(){this.start.call(this)},remove:function(){this.stop(),r[this.instanceNumber]=null,delete this.$el.data().countdownInstance},setFinalDate:function(e){this.finalDate=t(e)},update:function(){if(0===this.$el.closest("html").length)return void this.remove();this.totalSecsLeft=this.finalDate.getTime()-(new Date).getTime(),this.totalSecsLeft=Math.ceil(this.totalSecsLeft/1e3),this.totalSecsLeft=this.totalSecsLeft<0?0:this.totalSecsLeft,this.offset={seconds:this.totalSecsLeft%60,minutes:Math.floor(this.totalSecsLeft/60)%60,hours:Math.floor(this.totalSecsLeft/60/60)%24,days:Math.floor(this.totalSecsLeft/60/60/24)%7,totalDays:Math.floor(this.totalSecsLeft/60/60/24),weeks:Math.floor(this.totalSecsLeft/60/60/24/7),months:Math.floor(this.totalSecsLeft/60/60/24/30),years:Math.floor(this.totalSecsLeft/60/60/24/365)},0===this.totalSecsLeft?(this.stop(),this.dispatchEvent("finish")):this.dispatchEvent("update")},dispatchEvent:function(t){var i=e.Event(t+".countdown");i.finalDate=this.finalDate,i.offset=e.extend({},this.offset),i.strftime=n(this.offset),this.$el.trigger(i)}}),e.fn.countdown=function(){var t=Array.prototype.slice.call(arguments,0);return this.each(function(){var n=e(this).data("countdown-instance");if(void 0!==n){var i=r[n],o=t[0];l.prototype.hasOwnProperty(o)?i[o].apply(i,(0,a.default)(t.slice(1))):null===String(o).match(/^[$A-Z_][0-9A-Z_$]*$/i)?(i.setFinalDate.call(i,o),i.start()):e.error("Method %s does not exist on jQuery.countdown".replace(/\%s/gi,o))}else new l(this,t[0],t[1])})}}(r)}()},function(e,t,n){n(187);var i=n(772),a=n(773),r=n(774),o=n(0).utils;o.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"CONTROLLER",data:[{event:"SFMDELIVERY.SAVE_TARGETRECORD_IN_BACKGROUND",command:"com.servicemax.client.sfmdelivery.background.commands.SaveTargetRecordInBackground"}]}}}),o.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"MODEL",data:[{operationId:"SFMDELIVERY.SAVE_TARGETRECORD_IN_BACKGROUND",operation:"com.servicemax.client.sfmdelivery.background.operations.SaveTargetRecordInBackground"}]}}}),e.exports={api:i,commands:a,operations:r}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g=m.getLoggingService().getLogger("sfmdelivery.background.api"),y={name:"com.servicemax.client.sfmdelivery.background"};n(12).DatetimeUtil,n(7).MetaData;y.SFMExecutor=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return g.info("SFMExecutor constructor called"),e.__mainDeferred=m.Deferred(),e}return(0,p.default)(t,e),(0,c.default)(t,[{key:"executeSFMInBg",value:function(e,t,n){return this.__engineOptions={SVMX_processId:e,SVMX_recordId:t,SVMX_record:n,SVMX_action:"BG_SFM",onLoadFailed:{handler:function(){console.log("Engine failed to load"),this.rejectMainPromise()},context:this}},this.initializeEngine(),this.__mainDeferred}},{key:"doCleanup",value:function(){return this.__engine.doCleanup(),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initializeEngine",value:function(){this.__engine=m.create("com.servicemax.client.sfmdelivery.engine.DeliveryEngineImpl"),this.__engine.initAsync({context:this,handler:this.onEngineReadyToRun})}},{key:"onEngineReadyToRun",value:function(){console.log("Engine is ready to run");var e=this.__engine.getEventBus();e.bind("DATA_LOADED",this.onEngineDataLoaded,this),e.bind("SFMDELIVERY.FIELD_UPDATE_VALIDATION_ERROR",this.onFieldUpdateValidationError,this),e.bind("SFMDELIVERY.NOTIFY_APP_ERROR",this.onAppError,this),e.bind("SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",this.onSnippetError,this),this.__engine.run(this.__engineOptions)}},{key:"onEngineDataLoaded",value:function(){console.log("Engine completed loading data"),this.startSaveAction()}},{key:"startSaveAction",value:function(){var e=this,t=this.__engine;t.getEventBus().triggerEvent(m.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SAVE_TARGETRECORD_IN_BACKGROUND",this,{request:{data:t.getTargetData().getData(),sourceRecordId:t.getSourceRecordId(),metadata:t.getPageMetaData().getRawPageMetaData(),deliveryEngine:t,additionalInfo:this._getSaveRecordAdditionalInfo(),fieldValidatioConfirmed:!0},responder:{result:m.proxy(this,function(n){console.log(n);var i=t.getPageMetaData().getRawPageMetaData();e.__checkIfNavtoTargetRecordNeeded(t,i),e.resolveMainPromise(n)}),fault:m.proxy(this,function(t){console.log(t),e.rejectMainPromise(t)})}}))}},{key:"__checkIfNavtoTargetRecordNeeded",value:function(e,t){if(t&&t.response&&t.response.sfmProcessType&&"SOURCE TO TARGET ALL"===t.response.sfmProcessType){var n=e.getRecordId();m.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance().showRecord({key:n,objectName:""})}}},{key:"_getSaveRecordAdditionalInfo",value:function(e){return{processId:this.__engine.processId,eventType:"save",toModelOnly:!1,returnWarningsWithErrors:!0}}},{key:"onFieldUpdateValidationError",value:function(e){var t=e.data.request.result;if(t.errors.length);else if(t.warnings.length){for(var n=[],i=0;i<t.warnings.length;i++)n.push(t.warnings[i].message);var a=n.length>0?n.join("\n"):"Warning: Error found in configured formula.";this.rejectMainPromise({message:a})}}},{key:"onAppError",value:function(e){var t=e.data.request.message;this.rejectMainPromise({message:t})}},{key:"onSnippetError",value:function(e){e.data.request&&e.data.request.error_msg&&this.rejectMainPromise({message:e.data.request.error_msg})}},{key:"resolveMainPromise",value:function(e){var t=this;this.__mainDeferred.resolve(e),setTimeout(function(){t.doCleanup()},2e3)}},{key:"rejectMainPromise",value:function(e){var t=this;this.__mainDeferred.reject(e),setTimeout(function(){t.doCleanup()},2e3)}}]),t}(v),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(187).commands.SaveTargetRecord,m={name:"com.servicemax.client.sfmdelivery.background.commands"};m.SaveTargetRecordInBackground=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=f.getLoggingService().getLogger("SFMDELIVERY-COMMAND-SAVE_TARGETRECORD_IN_BACKGROUND"),console.log("SaveTargetRecordInBackground called"),e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"saveToModel",value:function(e,t){e.deliveryEngine.saveToModel(!1),this.__decideWhatToResolveBeforeSave(e,t)}},{key:"__executeOperation",value:function(e){this._executeOperationAsync(e,this,{operationId:"SFMDELIVERY.SAVE_TARGETRECORD_IN_BACKGROUND"})}},{key:"__doResolveBusinessRulesBeforeSave",value:function(e,t){this.__doResolveFieldUpdateRulesBeforeSave(e,t)||this.__doSave(e,t)}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(382).SaveTargetRecord,g={name:"com.servicemax.client.sfmdelivery.background.operations"};g.SaveTargetRecordInBackground=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,n){e.skipStatusMsg=!0,(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"performAsync",this).call(this,e,n)}}]),t}(v),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){var i=n(776),a=n(777),r=n(778),o=n(779),s=n(0).utils;s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.translation-tags","config":{"module-id":"SFM003","local-id":"SFWDELIVERY"}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"SFWDELIVERY.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"sfwdelivery","class-name":"com.servicemax.client.sfwdelivery.engine.DeliveryEngineImpl"}}}')),s.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"CONTROLLER",data:[{event:"SFWDELIVERY.GET_WIZARD_INFO",command:"com.servicemax.client.sfwdelivery.commands.GetWizardInfo"}]}}}),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.sfwdelivery.impl"};y.Module=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e._logger=m.getLoggingService().getLogger("SFW-IMPL"),e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){y.init(),y.init(),y.init()}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(v),y.SFWDeliveryEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFWDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(33).AbstractDeliveryEngine,g=n(5).SVMXObject,y={name:"com.servicemax.client.sfwdelivery.engine"};y.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=m.getLoggingService().getLogger("SFW-ENGINE-IMPL"),e.__root=null,e.__eventBus=null,e.__dataModel=null,e.__loadMask=null,e.__translation=null,e.__view=null,e.__getRecord=null,e.__initASyncCalled=!1,e}return(0,p.default)(t,e),(0,c.default)(t,[{key:"doCleanup",value:function(){return this.setPropertyForCleanup(["__dataModel","__eventBus","__root"]),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initAsync",value:function(e){if(this.__initASyncCalled)e.handler.call(e.context);else{this.__initASyncCalled=!0,e.getRecord&&(this.__getRecord=m.proxy(e.context,e.getRecord));var t=m.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("SFWDELIVERY.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.getEventBus()}})}}},{key:"getEventBus",value:function(){return this.__eventBus||(this.__eventBus=m.create("com.servicemax.client.sfwdelivery.impl.SFWDeliveryEngineEventBus",{})),this.__eventBus}},{key:"getDataModel",value:function(){return this.__dataModel||(this.__dataModel=m.create("com.servicemax.client.sfwdelivery.engine.WizardInfoModel",this)),this.__dataModel}},{key:"getRoot",value:function(){return this.__root}},{key:"run",value:function(e){var t=this;this.__logger.debug("Wizard is running!!!"),this.options=e||{},this.__root=this.__view.createComponent("ROOTCONTAINER",{deliveryEngine:this,dataModel:this.getDataModel(),msgInit:this.options.msgInit,msgEmpty:this.options.msgEmpty}),null==this.options.onReady&&(this.__root.render(m.getDisplayRootId()),this.options.recordId=m.getUrlParameter("RecordId"),m.getClient().getApplicationParameter("svmx-sfm-no-window-resize")||m.onWindowResize(function(){var e={width:Ext.getBody().getViewSize().width,height:Ext.getBody().getViewSize().height};this.onResize(e)},this)),this.options.recordId?this.update(this.options.recordId):this.options.onReady&&setTimeout(function(){t.options.onReady.handler.call(t.options.onReady.context||t)})}},{key:"translate",value:function(e){var t=this.__translation[e];return void 0===t&&(t=e),t}},{key:"reload",value:function(){this.update(this.options.recordId,this.options.objectName)}},{key:"update",value:function(e,t){function n(){var n=m.create("com.servicemax.client.lib.api.Event","SFWDELIVERY.GET_WIZARD_INFO",r,{request:{RecordId:e,Record:r.__getRecord?r.__getRecord():null,objectName:t,ActionTypes:a},responder:m.create("com.servicemax.client.sfwdelivery.responders.GetWizardInfoResponder",r)});r.getRoot()&&r.getRoot().setSpinnerMsg(),r.getEventBus().triggerEvent(n)}if(e){this.options.recordId=e,this.options.objectName=t;var i=m.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance(),a=i.getSupportedActionTypes(),r=this;"laptop"!==m.getClient().getApplicationParameter("client-type").toLowerCase()||i.__ApiKey?n():i.__getApiKey().then(function(){n()})}}},{key:"clearContent",value:function(){var e=this.getRoot();e&&e.clearMessagePanel()}},{key:"onGetWizardInfoCompleted",value:function(e){this.getDataModel().processData(e),this.getRoot()&&(this.getRoot().run(),e.SFWs.length&&this.getRoot().clearMessagePanel()),this.options.onReady&&this.options.onReady.handler.call(this.options.onReady.context||this);var t=m.create("com.servicemax.client.lib.api.Event","SFW_DATA_LOADED",this,this.getDataModel());this.getEventBus().triggerEvent(t)}},{key:"onGetWizardInfoFailed",value:function(e){this.getRoot().setEmptyMsg()}},{key:"onResize",value:function(e){this.getRoot()&&this.getRoot().resize(e)}}]),t}(v),y.WizardInfoModel=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__deliveryEngine=e,n.__wizardModels=null,n.record=null,n.recordId=null,n.availableActions=null,n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"processData",value:function(e){this.recordId=e.RecordId,this.record=e.Record,this.availableActions=e.availableActions||[],this.__wizardModels=[];for(var t=0;t<e.SFWs.length;t++)this.__wizardModels[t]=m.create("com.servicemax.client.sfwdelivery.engine.SFWDetailModel",this,e.SFWs[t])}},{key:"getWizards",value:function(){return this.__wizardModels}},{key:"getDeliveryEngine",value:function(){return this.__deliveryEngine}},{key:"doCleanup",value:function(){return this.setPropertyForCleanup("__wizardModels"),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),y.SFWDetailModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));i.__parent=e,i.__data=n,i.__data.SFWDef[m.OrgNamespace+"__Name__c"]&&(i.__data.SFWDef[m.OrgNamespace+"__Name__c"]=Ext.String.htmlEncode(i.__data.SFWDef[m.OrgNamespace+"__Name__c"]));for(var a=[],o=0;o<n.actions.length;o++)a[o]=m.create("com.servicemax.client.sfwdelivery.engine.SFWActionModel",i,n.actions[o]);return i.__actionModels=a,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"getId",value:function(){return this.__data.SFWDef.Id}},{key:"getName",value:function(){return this.__data.SFWDef[m.OrgNamespace+"__Name__c"]}},{key:"getActions",value:function(){return this.__actionModels}},{key:"getRoot",value:function(){return this.__parent}},{key:"doCleanup",value:function(){return this.setPropertyForCleanup("__actionModels"),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),y.SFWActionModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,!1===n.Enabled?i.enabled=!1:i.enabled=!0,i.__data.actionDef[m.OrgNamespace+"__Name__c"]&&(i.__data.actionDef[m.OrgNamespace+"__Name__c"]=Ext.String.htmlEncode(i.__data.actionDef[m.OrgNamespace+"__Name__c"])),i.__data.actionDef[m.OrgNamespace+"__Description__c"]&&(i.__data.actionDef[m.OrgNamespace+"__Description__c"]=Ext.String.htmlEncode(i.__data.actionDef[m.OrgNamespace+"__Description__c"])),i.__data.actionDef[m.OrgNamespace+"__Confirmation_Message__c"]&&(i.__data.actionDef[m.OrgNamespace+"__Confirmation_Message__c"]=Ext.String.htmlEncode(i.__data.actionDef[m.OrgNamespace+"__Confirmation_Message__c"])),i.actionType=n.actionDef[m.OrgNamespace+"__Action_Type__c"],i.customActionType=n.actionDef[m.OrgNamespace+"__Custom_Action_Type__c"],i.enableConfirmationDialog=n.actionDef[m.OrgNamespace+"__Enable_Confirmation_Dialog__c"],i.modeOfExecution=n.actionDef[m.OrgNamespace+"__Mode_Of_Execution__c"],i.handOver=n.actionDef[m.OrgNamespace+"__Handover__c"],i.confirmationMessage=n.actionDef[m.OrgNamespace+"__Confirmation_Message__c"],i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"getId",value:function(){return this.__data.actionDef.Id}},{key:"getName",value:function(){return this.__data.actionDef[m.OrgNamespace+"__Name__c"]}},{key:"getData",value:function(){return this.__data}},{key:"getRoot",value:function(){return this.__parent.getRoot()}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.sfwdelivery.commands"};m.GetWizardInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFWDELIVERY.GET_WIZARD_INFO"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.sfwdelivery.responders"};m.GetWizardInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetWizardInfoCompleted(e)}},{key:"fault",value:function(e){this.__parent.onGetWizardInfoFailed(e)}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(781),a=n(782),r=n(783),o=n(784),s=n(785),l=n(0).utils;l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmdelivery.extension","config":{"extension-type":"MOBILEVIEWSUMMARY","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.api.WOSummaryCard","validator":"validator","options":{"title":"Summary","button-sequence":0,"updater":"onDataUpdate"}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_CONTACT","command":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands.GetContact"},{"event":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_EVENT","command":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands.GetEvent"},{"event":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_LOCATION","command":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands.GetLocation"},{"event":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.SMS_CONTACT","command":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands.SMSContact"},{"event":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.TEL_CONTACT","command":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands.TELContact"},{"event":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GEO_LOCATION","command":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands.GEOLocation"}]}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"MODEL","data":[{"operationId":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_CONTACT","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations.GetContact"},{"operationId":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_EVENT","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations.GetEvent"},{"operationId":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_LOCATION","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations.GetLocation"},{"operationId":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.SMS_CONTACT","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations.SMSContact"},{"operationId":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.TEL_CONTACT","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations.TELContact"},{"operationId":"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GEO_LOCATION","operation":"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations.GEOLocation"}]}}}')),e.exports={impl:i,api:a,widgets:r,commands:o,operations:s}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){m.init(),m.init(),m.init(),m.init()}},{key:"afterInitialize",value:function(){}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(18),s=i(o),l=n(0).utils,c=(n(12).DatetimeUtil,n(24).navigation,n(24).data,n(19).impl),u=(n(60).Constants,{name:"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.api"}),d=function(){return l.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},_=c,h=l.getLoggingService().getLogger("sfmdelivery.ui.summaryview");Ext.define(u.name+".WOSummaryCard",{extend:_.name+".SVMXPanel",alias:"widget.sfm.delivery.summary",config:{delivery:null},cls:"panel-sfmdelivery-summary sfm-delivery-section",statics:{validator:function(e,t){return e.getHeaderMetaModel().objectName==l.OrgNamespace+"__Service_Order__c"}},getDeliveryEngine:function(){return this._delivery},initialize:function(){var e=this.getDeliveryEngine().getPageMetaData().getChildNode("header"),t=e._data.headerLayout,n=e.getAllFields(),i={};l.array.forEach(n,function(e){i[e.name]=e},this);var a=[];if(t[l.getCustomFieldName("SM_Include_Summary")]){this.setTitle(d().T("FSA008_TAG058","Summary"));var r=t[l.getCustomFieldName("SM_Summary_Title")];r&&i[r]&&a.push({xtype:"svmx.label",itemId:"summaryTitleLabel",baseCls:"sfm-delivery-location-name",cls:"sfm-wo-title",fit:1}),t[l.getCustomFieldName("SM_Include_Time_and_Place")]&&a.push({xtype:"sfm.delivery.eventlocation",itemId:"eventLocation",width:"100%",geoHandler:l.proxy(this,"onLocationGEO")}),t[l.getCustomFieldName("SM_Include_Contact")]&&a.push({xtype:"sfm.delivery.contactbox",itemId:"contactBox",label:d().T("FSA008_TAG100","Contact"),cls:"sfm-wo-summary-field",labelAlign:"top",readOnly:!0,width:"100%",contactHandler:l.proxy(this,"onContactSelect"),smsHandler:l.proxy(this,"onContactSMS"),telHandler:l.proxy(this,"onContactTEL")});var o=t[l.getCustomFieldName("SM_Include_Field1")];if(o){var s=i[o];s&&("email"===s.dataType?a.push(this.getEmailSummaryField("includeField1",s)):a.push({xtype:"sfm.field.textareaextended",itemId:"includeField1",label:s&&s.label||"",labelAlign:"top",moreLink:" ",readOnly:!0,width:"100%",cls:"sfm-wo-summary-include-field sfm-wo-summary-field",listeners:{onreadonlytap:l.proxy(this,"onTextAreaTap"),buffer:500}}))}var c=t[l.getCustomFieldName("SM_Include_Field2")];if(c){var u=i[c];u&&("email"===u.dataType?a.push(this.getEmailSummaryField("includeField2",u)):a.push({xtype:"sfm.field.textareaextended",itemId:"includeField2",label:u&&u.label||"",labelAlign:"top",moreLink:" ",readOnly:!0,width:"100%",cls:"sfm-wo-summary-include-field sfm-wo-summary-field",listeners:{onreadonlytap:l.proxy(this,"onTextAreaTap"),buffer:500}}))}var _=t[l.getCustomFieldName("SM_Include_Field3")];if(_){var h=i[_];h&&("email"===h.dataType?a.push(this.getEmailSummaryField("includeField3",h)):a.push({xtype:"sfm.field.textareaextended",itemId:"includeField3",label:h&&h.label||"",labelAlign:"top",moreLink:" ",readOnly:!0,width:"100%",cls:"sfm-wo-summary-include-field sfm-wo-summary-field",listeners:{onreadonlytap:l.proxy(this,"onTextAreaTap"),buffer:500}}))}this.add(a);var f=this.query("#includeField1"),p=this.query("#includeField2"),m=this.query("#includeField3"),v=this.query("#contactBox"),g=this.query("#eventLocation"),y=this.query("#summaryTitleLabel");this.__includeField1=f.length?f[0]:null,this.__includeField2=p.length?p[0]:null,this.__includeField3=m.length?m[0]:null,this.__contactBox=v.length?v[0]:null,this.__eventLocation=g.length?g[0]:null,this.__summaryTitleLabel=y.length?y[0]:null}else this.hide()},getEmailSummaryField:function(e,t){return{xtype:"sfm.field.email",itemId:e,label:t&&t.label||"",labelAlign:"top",moreLink:" ",readOnly:!0,width:"100%",cls:"sfm-wo-summary-include-field sfm-wo-summary-field",listeners:{onreadonlytap:l.proxy(this,"onEmailTap"),buffer:500}}},onDataUpdate:function(e){if(e&&e.getData){var t=d().T("FSA008_TAG063","more"),n=e.getData(),i="svmx-empty-editor",a=this.getDeliveryEngine().getPageMetaData().getChildNode("header"),r=a._data.headerLayout,o=r[l.getCustomFieldName("SM_Include_Summary")];if(o){if(this.__summaryTitleLabel){var c=r[l.getCustomFieldName("SM_Summary_Title")];if(c){var u=n.getValueFromPath(c),_="object"===(void 0===u?"undefined":(0,s.default)(u))?u&&u.fieldvalue.value||"":u;"string"!=typeof _&&(_=_.toString()),_.length&&this.__summaryTitleLabel.setHtml(_)}}if(this.__includeField1){var h=r[l.getCustomFieldName("SM_Include_Field1")];if(h){var f=n.getValueFromPath(h),p="object"===(void 0===f?"undefined":(0,s.default)(f))?f&&f.fieldvalue.value||"":f;p&&"string"!=typeof p&&(p=p.toString()),p&&p.length?(p.length>250&&(this.__includeField1._moreLink=t),this.__includeField1.setValue(p),this.__includeField1.removeCls(i)):this.__includeField1.addCls(i)}}if(this.__includeField2){var m=r[l.getCustomFieldName("SM_Include_Field2")];if(m){var v=n.getValueFromPath(m),g="object"===(void 0===v?"undefined":(0,s.default)(v))?v&&v.fieldvalue.value||"":v;g&&"string"!=typeof g&&(g=g.toString()),g&&g.length?(g.length>250&&(this.__includeField2._moreLink=t),this.__includeField2.setValue(g),this.__includeField2.removeCls(i)):this.__includeField2.addCls(i)}}if(this.__includeField3){var y=r[l.getCustomFieldName("SM_Include_Field3")];if(y){var S=n.getValueFromPath(y),E="object"===(void 0===S?"undefined":(0,s.default)(S))?S&&S.fieldvalue.value||"":S;E&&"string"!=typeof E&&(E=E.toString()),E&&E.length?(E.length>250&&(this.__includeField3._moreLink=t),this.__includeField3.setValue(E),this.__includeField3.removeCls(i)):this.__includeField3.addCls(i)}}}var b=this.getDeliveryEngine().getEventBus(),T=e.getData().getRawValues();if(b){var M=l.create("com.servicemax.client.sfmconsole.utils.EventCollection",b,[]);if(M.addEvent(l.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_EVENT",this,{request:{workOrderId:T.Id}})),o){if(this.__contactBox){var I=T[l.getCustomFieldName("Contact")];if(I&&"object"===(void 0===I?"undefined":(0,s.default)(I))&&I.fieldvalue.key){var C=I.fieldvalue.key,A=I.fieldvalue.value;M.addEvent(l.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_CONTACT",this,{request:{contactId:C,contactName:A}}))}}if(this.__eventLocation){var D=T[l.getCustomFieldName("Company")],x="";D&&"object"===(void 0===D?"undefined":(0,s.default)(D))&&(x=D.fieldvalue.value);var R={name:x,street:T[l.getCustomFieldName("Street")],city:T[l.getCustomFieldName("City")],state:T[l.getCustomFieldName("State")],zipcode:T[l.getCustomFieldName("Zip")],country:T[l.getCustomFieldName("Country")],latitude:T[l.getCustomFieldName("Latitude")],longitude:T[l.getCustomFieldName("Longitude")]};R.country&&"object"===(0,s.default)(R.country)&&(R.country=R.country.fieldvalue.value),this.__eventLocation.setLocation(R)}}M.triggerAll(l.proxy(this,"onCustomDataUpdated"))}}},onCustomDataUpdated:function(e){var t=e.items(),n=!1,i=!1;l.array.forEach(t,function(e){switch(e.type()){case"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_CONTACT":var t=e.response||{};this.__contactBox&&(this.__contactBox.setValue(t),n=!0);break;case"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_EVENT":var a=e.response;if(this.__eventLocation){var o="";if((0,r.default)(a).length){var s="";if(a.isAllDay)s=d().T("FSA008_TAG121","All Day"),o="<span class = 'sfm-delivery-event-wo-summary-date'>"+a.date+"</span> <br/> <span class = 'sfm-delivery-event-wo-summary-allDay'>"+s+"</span>";else if(a.isMultiDay)s=d().T("FSA008_TAG122","through"),o="<span class = 'sfm-delivery-event-wo-summary-date'>"+a.startDate+"</span> <br/> <span class = 'sfm-delivery-event-wo-summary-multiDay'>"+s+"</span> <br/> <span class = 'sfm-delivery-event-wo-summary-date'>"+a.endDate+"</span>";else{var l=a.time&&a.time.split(" "),c=l.shift(0),u=l.join(" ");o="<span class = 'sfm-delivery-event-wo-summary-time' >"+c+"</span>",u&&(o+="<span class = 'sfm-delivery-event-wo-summary-multiDay'>"+u+"</span>"),o+="<br/> <span class = 'sfm-delivery-event-wo-summary-singleEvent'>"+a.date+"</span>"}}else o=d().T("FSA008_TAG109","Not Scheduled");this.__eventLocation.setEventTime(o),i=!0}}},this),this.__contactBox&&!n&&this.__contactBox.setValue(null),this.__eventLocation&&!i&&this.__eventLocation.setEvent(null)},onContactSelect:function(){var e=l.Deferred(),t=this.__contactBox.getFullValue();if(t&&t.Id){l.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.sfmsearch.platformspecifics").__getProcessId(t.Id,"Contact").done(function(n){l.getCurrentApplication().getCurrentView().changeConsoleApp({app:"sfmdelivery",options:{SVMX_processId:n,SVMX_recordId:t.Id}}),e.resolve()}).fail(function(){h.warn("No view process found for Contact"),e.reject()})}},onContactSMS:function(e){var t=this;e=e||"";var n=t.getDeliveryEngine().getEventBus();if(n){var i=l.create("com.servicemax.client.sfmconsole.utils.EventCollection",n,[]);i.addEvent(l.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EXTENSION.SUMMARYVIEW.SMS_CONTACT",this,{request:{phone:e}})),i.triggerAll()}},onContactTEL:function(e){var t=this;e=e||"";var n=t.getDeliveryEngine().getEventBus();if(n){var i=l.create("com.servicemax.client.sfmconsole.utils.EventCollection",n,[]);i.addEvent(l.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EXTENSION.SUMMARYVIEW.TEL_CONTACT",this,{request:{phone:e}})),i.triggerAll()}},onTextAreaTap:function(e){var t=l.getCurrentApplication().getCurrentView();t.__disabled||(t.__disabled=!0,e._value&&t.showViewInDialog({view:"viewtext",options:{title:e._label,text:e._value}}))},onLocationGEO:function(e){var t=this;e=e||"";var n=t.getDeliveryEngine().getEventBus();if(n){var i=l.create("com.servicemax.client.sfmconsole.utils.EventCollection",n,[]);i.addEvent(l.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EXTENSION.SUMMARYVIEW.GEO_LOCATION",this,{request:{location:e}})),i.triggerAll()}},onEmailTap:function(e){var t=this,n=t.getDeliveryEngine().getEventBus();if(n&&e&&e.getValue&&e.getValue()){var i=l.create("com.servicemax.client.sfmconsole.utils.EventCollection",n,[]),a=l.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_EMAIL",this,{request:{address:e.getValue()}});i.addEvent(a),i.triggerAll()}}}),l.defineGlobal(u.name,u),e.exports=u},function(e,t,n){var i=n(0).utils,a=n(12).DatetimeUtil,r=n(19).impl,o=n(19).form,s=(n(24).data,{name:"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.widgets"}),l=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},c=a,u=r,d=o;i.getLoggingService().getLogger("sfmdelivery.ui.summarywidgets");Ext.define(s.name+".DeliveryDateBox",{extend:u.name+".SVMXVertPanel",alias:"widget.sfm.delivery.datebox",__locale:c.setLocale({weekdaysShort:[c.getWeekDayNameInUserLocale(0),c.getWeekDayNameInUserLocale(1),c.getWeekDayNameInUserLocale(2),c.getWeekDayNameInUserLocale(3),c.getWeekDayNameInUserLocale(4),c.getWeekDayNameInUserLocale(5),c.getWeekDayNameInUserLocale(6)]}),setValue:function(e){e?(this.__timeLabel.setHtml(e.time),this.__dayLabel.setHtml(e.date),this.__timeLabel.setHidden(!1),this.__timeContainer.setHidden(!1),this.__dayLabel.setHidden(!1),this.__noEventLabel.setHidden(!0)):(this.__timeLabel.setHidden(!0),this.__timeContainer.setHidden(!0),this.__dayLabel.setHidden(!0),this.__noEventLabel.setHidden(!1))},initialize:function(){var e=[{xtype:"svmx.horizontalpanel",baseCls:"sfm-sfm-delivery-event-time-panel",itemId:"timeContainer",halign:"full",hidden:!0,items:[{xtype:"svmx.label",baseCls:"sfm-delivery-event-time",itemId:"timeLabel",hidden:!0}]},{xtype:"svmx.label",baseCls:"sfm-delivery-event-day",itemId:"dayLabel",hidden:!0},{xtype:"svmx.label",baseCls:"svmx-empty-editor",itemId:"noEventLabel",html:l().T("FSA008_TAG109","Not Scheduled"),hidden:!0}];this.add(e),this.__timeLabel=this.query("#timeLabel")[0],this.__timeContainer=this.query("#timeContainer")[0],this.__dayLabel=this.query("#dayLabel")[0],this.__noEventLabel=this.query("#noEventLabel")[0]}}),Ext.define(s.name+".DeliveryLocationBox",{extend:u.name+".SVMXContainer",alias:"widget.sfm.delivery.locationbox",setValue:function(e){e=e||{};var t={street:e.street?e.street:"",city:e.city?e.city:"",state:e.state?e.state:"",zipcode:e.zipcode?e.zipcode:"",country:e.country?e.country:"",latitude:e.latitude?e.latitude:"0",longitude:e.longitude?e.longitude:"0"};this.__location=t;var n={street:t.street,city:t.city,state:t.state,country:t.country,zipcode:t.zipcode,latitude:t.latitude,longitude:t.longitude},a="";if(n.street=n.street.replace("\n","<br/>"),n.street||t.city||t.state||t.zipcode){a=i.string.substitute(l().T("FSA008_TAG110","{{street}}<br/>{{city}}<br/>{{state}} {{zipcode}}"),n);for(var r=a.split(","),o=[],s=0;s<r.length;s++){var c=r[s];""!==c.trim()&&o.push(c)}a=o.join(","),this.__locationLabel.setHidden(!1),this.__locationIcon.setHidden(!1)}else this.__locationLabel.setBaseCls("svmx-empty-editor sfm-delivery-location");this.__locationLabel.setHtml(a)},initialize:function(){var e=[{xtype:"svmx.label",baseCls:"sfm-delivery-address",itemId:"locationLabel"},{xtype:"svmx.spacer"},{xtype:"svmx.iconbutton",cls:"svmx-map-button icon-folded-map",itemId:"locationIcon",hidden:!0,handler:i.proxy(this,function(){this.config.geoHandler&&this.handleLocationClick.call(this,this.config.geoHandler)})}];this.add(e),this.__locationLabel=this.query("#locationLabel")[0],this.__locationIcon=this.query("#locationIcon")[0]},handleLocationClick:function(e){var t=this.__location;e&&t&&e.call(this,t)}}),Ext.define(s.name+".DeliveryLocationEventBox",{extend:u.name+".SVMXVertPanel",alias:"widget.sfm.delivery.eventlocation",cls:"container-sfmdelivery-eventlocation",setLocation:function(e){e=e||{},this.__locationBox.setValue(e),e.name||this.__locationBox.setBaseCls("svmx-empty-editor")},setEventTime:function(e){this.__eventBox.setHtml(e),this.__eventBox.addCls("sfm-delivery-event-WoSummary")},initialize:function(){var e=[{xtype:"svmx.horizontalpanel",itemId:"eventLocationBox",baseCls:"sfm-delivery-location-event",fit:1,items:[{xtype:"svmx.label",itemId:"eventBox",baseCls:"sfm-delivery-event"},{xtype:"sfm.delivery.locationbox",itemId:"locationBox",baseCls:"sfm-delivery-location",flex:1,geoHandler:this.config.geoHandler}]}];this.add(e),this.__eventLocationName=this.query("#eventLocationName")[0],this.__eventBox=this.query("#eventBox")[0],this.__locationBox=this.query("#locationBox")[0]}}),Ext.define(s.name+".DeliveryContactBox",{extend:d.name+".SVMXTextField",alias:"widget.sfm.delivery.contactbox",__phoneDialog:null,config:{fullValue:null,cls:"sfm-contact-widget",contactHandler:null,smsHandler:null,telHandler:null},setValue:function(e){this.setFullValue(e);var t=e&&e.Name?e.Name:null;this.callParent([t]),this.updateReadOnlyValue(this,t||""),t?this.removeCls("svmx-empty-editor"):this.addCls("svmx-empty-editor");var n=i.getClient().getApplicationParameter("device-info"),a=n["device-platform"]||"";"ios"===a.toLowerCase()?this.__callButton.setHidden(!0):this.__callButton.setHidden(!(e&&e.phoneContacts&&e.phoneContacts.length)),"windows"===a.toLowerCase()?this.__textButton.setHidden(!0):this.__textButton.setHidden(!(e&&e.phoneContacts&&e.phoneContacts.length)),e&&e.Id?this.addCls("svmx-lookup-navigate"):this.removeCls("svmx-lookup-navigate")},generateReadOnlyLabel:function(){if(!this.__readOnlyLabel){this.config.handlerContext;this.enableBubble("transientState");var e=i.create(u.name+".SVMXHorizPanel",{width:"100%",halign:"full",cls:"sfm-readonly-label",items:[{xtype:"svmx.label",itemId:"contactLabel",html:"<a></a>",listeners:{onsingletap:i.proxy(this,function(){this.handleContactClick.call(this,this.config.contactHandler)})}},{xtype:"svmx.container",cls:"container-sfmdelivery-summary-contact-buttons",items:[{xtype:"svmx.iconbutton",itemId:"textButton",hidden:!0,cls:"svmx-message-button icon-chat",handler:i.proxy(this,function(){this.handlePhoneClick.call(this,this.config.smsHandler)})},{xtype:"svmx.iconbutton",itemId:"callButton",hidden:!0,cls:"svmx-call-button icon-phone",handler:i.proxy(this,function(){this.handlePhoneClick.call(this,this.config.telHandler)})}]}]});e.setLayoutSizeFlags(this.getSizeFlags()),e.renderTo(this.innerElement),this.__readOnlyLabel=e.query("#contactLabel")[0],this.__readOnlyLabel.element.on("singletap",i.proxy(this,function(){this.handleContactClick.call(this,this.config.contactHandler)})),this.__callButton=e.query("#callButton")[0],this.__textButton=e.query("#textButton")[0]}},handleContactClick:function(e){e.call(this)},handlePhoneClick:function(e){if(e&&this.getFullValue().phoneContacts&&this.getFullValue().phoneContacts.length>0){var t=this;if(this.getFullValue().phoneContacts.length>1){this.__phoneDialog=i.create(s.name+".PhonePopup"),this.fireEvent("transientState",{state:t,type:"open",handler:t.closeDialog,scope:t});var n=t.__phoneDialog.show({itemId:"phoneDialog",data:this.getFullValue().phoneContacts});n.done(function(n){e.call(t,n),t.fireEvent("transientState",{state:t,type:"close"})}),n.fail(function(){t.fireEvent("transientState",{state:t,type:"close"})})}else e.call(t,this.getFullValue().phoneContacts[0].value)}},closeDialog:function(){this.__phoneDialog&&(this.__phoneDialog.hide(),this.__phoneDialog=null)},doDestroy:function(){this.__phoneDialog&&this.__phoneDialog.hide(),this.callParent()}}),Ext.define(s.name+".PhonePopup",{extend:"com.servicemax.client.ui.components.modern.popups.SVMXMessageBox",alias:"widget.sfm.delivery.phonenumbers",__store:null,__deferred:null,config:{cls:"sfm-summary-phone-dialog",centered:!0,modal:!0,hideOnMaskTap:!0,buttons:[],title:l().T("FSA008_TAG111","Select Number"),scrollable:!1,listeners:{hide:function(e,t){"pending"==this.__deferred.state()&&this.__deferred.reject(),this.destroy()}}},show:function(e){this.__deferred=new i.Deferred,e=Ext.apply(this.config,e||{});var t=e.data||[];if(0===t.length)return this.__deferred.reject(),this.__deferred;var n=this.getStore();n.removeAll(),n.setData(t);var a=[{itemId:"list",xtype:"svmx.list",cls:"sfm-summary-phone-list",itemCls:"sfm-summary-phone-item",itemTpl:"<div class='sfm-summary-phone-result-value'>{value}</div><div class='sfm-summary-phone-result-label'>{label}</div>",itemHeight:"2em",emptyText:"",scrollable:!1,disableContainerScrollable:!0,navOnSelect:!1,store:n,listeners:{select:i.proxy(this,function(e,t,n,i){this.__deferred.resolve(t.get("value")),this.hide()})}},{xtype:"svmx.button",itemId:"phoneDialogCancel",text:l().T("FSA016_TAG004","Cancel"),handler:i.proxy(this,function(){this.hide()})}];return this.add(a),this.callParent(e),this.list=this.query("#list")[0],this.list.refresh(),this.__deferred},initialize:function(){var e=s.name+".phone.model"+i.generateGUID();Ext.define(e,{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",config:{fields:[{name:"label"},{name:"value"}]}});var t=Ext.widget("svmx.store",{model:e,data:[]});this.setStore(t)},setStore:function(e){this.__store=e},getStore:function(){return this.__store},getAction:function(){return this.__deferred},doDestroy:function(){this.getStore&&this.getStore()&&(Ext.data.StoreManager.unregister(this.getStore()),this.getStore().destroy(),this.__store=null),this.callParent()}}),Ext.define(s.name+".DeliveryContactBox1",{extend:u.name+".SVMXVertPanel",alias:"widget.sfm.delivery.contactbox1",config:{value:null,label:"",halign:"stretch",cls:"x-field",height:78},initialize:function(){var e=[{xtype:"svmx.label",baseCls:"x-form-label",html:"<span>"+this.getLabel()+"</span>",flex:1,height:43},{xtype:"svmx.horizontalpanel",baseCls:"sfm-readonly-label",halign:"full",height:35,items:[{xtype:"svmx.label",itemId:"valueNode",flex:1},{xtype:"svmx.iconbutton",transparent:!0,itemId:"textButton",cls:"svmx-message-button",width:32},{xtype:"svmx.iconbutton",transparent:!0,itemId:"callButton",cls:"svmx-call-button",width:32},{xtype:"svmx.label",cls:"x-list-disclosure",width:32}]}];this.add(e)},updateValue:function(e){this.query("#valueNode")[0].setHtml("<span>"+e.Name+"</span>")}}),i.defineGlobal(s.name,s),e.exports=s},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.commands"};m.GetContact=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_CONTACT"})}}]),t}(p),m.GetLocation=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_LOCATION"})}}]),t}(p),m.GetEvent=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GET_EVENT"})}}]),t}(p),m.SMSContact=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EXTENSION.SUMMARYVIEW.SMS_CONTACT"})}}]),t}(p),m.TELContact=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EXTENSION.SUMMARYVIEW.TEL_CONTACT"})}}]),t}(p),m.GEOLocation=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMDELIVERY.EXTENSION.SUMMARYVIEW.GEO_LOCATION"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=(n(8),n(0).utils),m=n(7).Data,v=n(7).MetaData,g=n(12).DatetimeUtil,y=n(13).Operation,S=n(11).Facade,E={name:"com.servicemax.client.sfmdelivery.ui.largemodern.summaryview.operations"},b=m,T=v,M=g;p.getLoggingService().getLogger("sfmdelivery.ui.summaryview.operations");E.GetContact=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e=e||{};var n={Name:e.contactName};if(e.contactId){var i=T.getTableForId(e.contactId),a=T.describeObject({objectName:i}),r=b.getRecord({Id:e.contactId,loadReferences:!1,convertPicklists:!1});p.when([r,a]).then(p.proxy(this,function(e,n){var i=[];p.array.forEach(n.fields,function(t){"phone"===t.type&&e[t.name]&&""!=e[t.name]&&i.push({label:t.label,value:e[t.name]})},this),i=i.sort(function(e,t){return e.label.localeCompare(t.label)}),e.phoneContacts=i,t.result(e)})).fail(p.proxy(this,function(e){t.result(n)}))}else t.result(n)}}]),t}(y),E.GetLocation=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e=e||{},t.result({name:e.name,street:e.street,city:e.city,state:e.state,zipcode:e.zipcode,country:e.country,latitude:e.latitude,longitude:e.longitude})}}]),t}(y),E.GetEvent=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e=e||{workOrderId:""};var n=this,i=M.getCurrentDatetimeGMT("YYYY-MM-DD HH:mm:ss"),a="SELECT ActivityDate FROM Event WHERE WhatId = '"+e.workOrderId+"' AND IsAllDayEvent = 'true' UNION SELECT SVMXC__ActivityDate__c AS ActivityDate FROM SVMXC__SVMX_Event__c WHERE SVMXC__WhatId__c = '"+e.workOrderId+"' AND SVMXC__IsAllDayEvent__c = 'true' LIMIT 1";a=a.replace(/SVMXC/g,p.OrgNamespace),this.__executeQuery(a).then(function(a){if(a[0]){var r=n.convertDisplayDate(a[0].ActivityDate),o={isAllDay:!0,isMultiDay:!1,startDate:"",endDate:"",date:r&&r.date||"",time:r&&r.time||""};t.result(o)}else{var s="SELECT Id, ActivityDateTime, StartDateTime, EndDateTime FROM Event WHERE WhatId = '{{workOrderId}}' UNION SELECT Id, SVMXC__ActivityDateTime__c AS ActivityDateTime, SVMXC__StartDateTime__c AS StartDateTime, SVMXC__EndDateTime__c AS EndDateTime FROM SVMXC__SVMX_Event__c WHERE SVMXC__WhatId__c = '{{workOrderId}}' ORDER BY StartDateTime ASC LIMIT 1;";s=s.replace(/SVMXC/g,p.OrgNamespace);var l={workOrderId:e.workOrderId,now:i};n.__executeQuery(s,l).then(function(e){if(e.length){var i=M.convertToTimezone(e[0].StartDateTime),a=M.convertToTimezone(e[0].EndDateTime),r=M.parseDate(i),o=M.parseDate(a),s=Math.abs(o.getTime()-r.getTime()),l=Math.floor(s/864e5),c={isAllDay:!1,isMultiDay:!1,startDate:"",endDate:"",date:"",time:""};if(l){var u={time:M.getFormattedDatetime(i,"LT"),date:M.getFormattedDatetime(i,"ddd MMM D")},d={time:M.getFormattedDatetime(a,"LT"),date:M.getFormattedDatetime(a,"ddd MMM D")};c.isMultiDay=!0,c.startDate=u&&u.date||"",c.endDate=d&&d.date||""}else{var _=e.length>0?e[0].ActivityDateTime:e[0].StartDateTime,h=n.convertDisplayDate(_);c.date=h&&h.date||"",c.time=h&&h.time||""}}t.result(c||{})})}})}},{key:"convertDisplayDate",value:function(e){var t={};if(e){var n=M.convertToTimezone(e);t.time=M.getFormattedDatetime(n,"LT"),t.date=M.getFormattedDatetime(n,"ddd MMM D")}else t=!1;return t}},{key:"__executeQuery",value:function(e,t){var n=f.Deferred();t&&(e=p.string.substitute(e,t));var i=S,a=i.createSQLRequest();return a.bind("REQUEST_COMPLETED",function(e){n.resolve(e.data.data)},this),a.bind("REQUEST_ERROR",function(e){n.reject()},this),a.execute({query:e,async:!0}),n.promise()}}]),t}(y),E.SMSContact=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){if(e=e||{},e.phone){S.createSMSRequest().execute({phone:e.phone})}}}]),t}(y),E.TELContact=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){if(e=e||{},e.phone){S.createTELRequest().execute({phone:e.phone})}}}]),t}(y),E.GEOLocation=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){if(e=e||{},e.location){S.createGEORequest().execute(e.location)}}}]),t}(y),p.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.sfmdelivery.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){m.init(),m.init()}},{key:"afterInitialize",value:function(){m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init(),m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(50),s=i(o),l=n(18),c=i(l),u=n(788),d=i(u),_=n(0).utils,h=n(24).navigation,f=n(19).impl,p=n(19).form,m=n(60).Constants,v=(n(19).impl.SVMXPanel,n(19).form.SVMXPicklistModel),g=n(7).SystemData,y=n(179).nativeservice,S=n(7).Data,E=n(7).ServerInfo,b=n(189).Utils,T=n(7).Attachments,M=n(7).Cache,I={name:"com.servicemax.client.sfmdelivery.ui.largemodern.api"},C=E,A=_.getLoggingService().getLogger("sfmdelivery.ui.largemodern.api"),D=function(){return _.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};Ext.define(I.name+".DetailSection",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.sfm.delivery.editlineitems",config:{sectionModel:null,dataModel:null,objectName:"",objectLabel:"",detailId:"",deliveryEngine:null,readOnly:!1,view:null,store:null,senchaModel:null,maxCols:4,showLastColumn:!0,isDesktop:!1,cls:["sfm-process-edit"],scrollReferenceFromParent:!0},initialize:function(){var e=this,t=this.getSectionModel();this.setSenchaModel(this.buildSenchaModel(t)),this.createStore(),this.setDetailId(t.layoutId),this.setObjectName(t.objectName),this.setObjectLabel(this.getDeliveryEngine().getMetaModel().getObjectLabel(t.objectName));var n=t.createBinding(this.setValueHandler,this.getValueHandler,this);n.setValidator({handler:e.validationHandler,context:this}),n.setBizRuleValidator({handler:e.businessRuleHandler,context:this})},createStore:function(){this.setStore(Ext.widget("svmx.store",{model:this.getSenchaModel(),pageSize:_.getClient().getApplicationParameter("sfm-delivery-max-childlines-per-page"),autoLoad:!0,data:{pagingChildLines:[]},proxy:{type:"memory",enablePaging:!0,reader:{type:"json",rootProperty:"pagingChildLines"}},listeners:{datachanged:_.proxy(this,"onStoreChange")}}))},updateStoreData:function(e){this.updateProxyData(e),this.__contentCmp||this.__grid?this.updateUI(!1):this.updateUI(!0)},updateProxyData:function(e,t){var n=this.getStore(),i=this.getStoreProxy().getData(),a=this.getStoreProxyData(),r=void 0;if(t){switch(t){case"ADDED":case"COPY":r=e.concat(a),this.setStoreProxyData(r),i.total+=e.length,n.loadPage(1);break;case"DELETED":for(var o=0;o<a.length;o++)if(a[o].Id===e||a[o].id===e){a.splice(o,1),i.total--,n.load();break}}this.updateTitleBar(i.total||0)}else e.length!=i.total&&(i.total=e.length,this.updateTitleBar(i.total||0)),this.setStoreProxyData(e),n.load()},updateTitleBar:function(e){var t=this.getSectionModel(),n=Ext.String.htmlEncode(t.title);this.setTitle(n+" ("+e+")")},buildSenchaModel:function(e){var t="svmx.sfmdelivery.runtime.detail."+this.getDetailId();if(!Ext.ClassManager.isCreated(t)){var n=e.getChildNode("fields"),i=[{name:"Id"}],a=void 0;_.array.forEach(n,function(e){i.push({name:e.fieldName,defaultValue:""}),i.push({name:e.fieldName+"__key"}),"Name"==e.fieldName&&(a=!0)},this),a||i.push({name:"Name"}),Ext.define(t,{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:i})}return t},buildColumns:function(e){var t=this.getSectionModel(),n=t.getChildNode("fields"),i=[],a=Ext.create("com.servicemax.client.sfmdelivery.ui.largemodern.columndeffactory.ColumnDefFactory",this.getView()),r=!1,o=this.getLinkedProcesses();return(t.allowDeleteLines&&!this.getReadOnly()||t.allowNewLines&&!this.getReadOnly()||o&&o.length>0)&&(r=!0),!this.getReadOnly()&&this.getIsDesktop()&&r&&i.push(this.createInfoMenu(50,50,a,!0,t)),_.array.forEach(n,function(t){if(i.length>=e)return!1;var n={text:t.fieldLabel,dataIndex:t.fieldName,flex:1,sortable:!0};this.getIsDesktop()||(n.cell={ui:"gridcell-sfmdelivery-details"});var r=this.createColumnDefinition(t,n,a,this.getIsDesktop());i.push(r),i.length==e&&(r.hidden=!this.getShowLastColumn())},this),this.getReadOnly()||this.getIsDesktop()||!r||i.push(this.createInfoMenu(50,50,a,!1,t)),i},createInfoMenu:function(e,t,n,i,a){var r={width:e,maxWidth:t,minWidth:50,sortable:!1,resizable:!1,isDesktop:i,allowDeleteLines:a.allowDeleteLines&&!this.getReadOnly(),allowAddNewLines:a.allowNewLines&&!this.getReadOnly(),sectionModel:a};return n.createActionColumnWithNavigationBtnDefinition(r,this)},createColumnDefinition:function(e,t,n){return n.createColumnDefinition(e,t,n,this.getIsDesktop())},getData:function(){return this.getSectionModel().getData()},getLinkedProcesses:function(){return this.getData().linkedProcesses},getStoreProxy:function(){return this.getStore().getProxy()},getStoreProxyData:function(){var e=this.getStoreProxy(),t=e.getData(),n=e.reader,i=n._rootProperty;return t?t[i]:[]},setStoreProxyData:function(e){var t=this.getStoreProxy();t.getData()[t.reader._rootProperty]=e||[]},validationHandler:function(){var e=this,t={isValid:!0},n=this.getSectionModel(),i=n.actionOnZeroLines,a=this.getStoreProxy(),r=a.getData(),o=r.total;if("Disallow"==i&&0===o)t.isValid=!1,t.message=(n.title||this.getObjectLabel())+D().T("FSA008_TAG131",": You must add at least one line to save this record."),t.errorCorrectionhandler=_.proxy(e,e.errorCorrectionhandler);else if("Warn"==i&&0===o)t.additionalInfo={isWarning:!0},t.message=(n.title||this.getObjectLabel())+D().T("FSA008_TAG132",": You have not created any lines. Do you still want to save?"),t.errorCorrectionhandler=_.proxy(e,e.errorCorrectionhandler);else if(o>0){for(var s=n._children.fields.filter(function(e){return e.required&&!e.readOnly}),l=r.pagingChildLines,c=[],u=l.length-1;u>=0;u--)for(var d=l[u],h=s.length-1;h>=0;h--){var f=s[h].fieldName,p=d[f];if(("number"!=typeof p||0!==p)&&(!p||""===p)){var m=D().T("FSA008_TAG061","The field {{fieldName}} is required");m=(this._title||this.getObjectLabel())+" "+_.string.substitute(m,{fieldName:s[h].fieldLabel}),c.push({message:m,recordId:l[u].Id,recordIndex:u,fieldName:f})}}c.length>0&&(t=c.reverse().map(function(t){return{isValid:!1,message:t.message,errorCorrectionhandler:_.proxy(e,e.errorCorrectionhandler),additionalInfo:{recordId:t.recordId,recordIndex:t.recordIndex,fieldName:t.fieldName}}}))}return t},errorCorrectionhandler:function(e){var t=this,n=this.getView();n.errorCorrectionhandler&&n.errorCorrectionhandler(t,e)},businessRuleHandler:function(e){var t=this,n={};return n.message=e.message||"",n.recordId=e.recordId||"",n.errorCorrectionhandler=function(e){for(var n=t.getStoreProxyData(),i=t.getStore(),a=n.length,r=-1,o=null,s=a-1;s>=0;s--){if(n[s].Id===e.recordId){r=s;break}}var l=void 0;if(-1!=r){r+=1,l=Math.ceil(r/_.getClient().getApplicationParameter("sfm-delivery-max-childlines-per-page")),i.currentPage!=l&&i.loadPage(l),r=-1;for(var c=i.data.items,u=0;u<c.length;u++)if(c[u].data.Id===e.recordId){r=u,o=c[u];break}}else A.error("SEVER ERROR :: record that does not meet the validation rules or biz rules does not exist in the proxyData");t.onDetailRecordSelect&&o&&-1!=r?(t.scrollIntoView(),t.onDetailRecordSelect(o,r)):t.scrollIntoView?t.scrollIntoView():t.focus()},n},setValueHandler:function(e,t){if(t){if("ADDED"==t.type||"COPY"==t.type)this.updateProxyData(e.lines,t.type);else if("DELETED"==t.type)for(var n=e.length-1;n>=0;n--){var i=this.getStore(),a=i.getAt(e[n].rowIndex).getData().Id||i.getAt(e[n].rowIndex).getData().id;a?this.updateProxyData(a,"DELETED"):console.log("Failed to delete record since recordId doesnt exists")}}else this.updateStoreData(e.lines)},__sortAllLines:function(e,t,n){var i=this.getStoreProxyData(),a=[{queryField:t.getDataIndex(),sortingOrder:n}],r=this.__sortLines(i,a);this.setStoreProxyData(r),this.getStore().load()},__sortLines:function(e,t){if(null==t)return e;var n=function e(n,i,a){var r=t[a],o=r.queryField,s=n[o],l=i[o];return(0,d.default)(parseFloat(s))&&(s=parseFloat(s)),(0,d.default)(parseFloat(l))&&(l=parseFloat(l)),s===l&&a!=t.length-1?e(n,i,a+1):"ASC"==r.sortingOrder?s<l?-1:1:l<s?-1:1};return t.length>0&&e.sort(function(e,t){return n(e,t,0)}),e},onStoreChange:function(){this.updateUI(!1)},totalRecords:function(e,t){for(var n=0,i=0;i<e.length;i++){var a=e[i];if(a.aliasName===t){n=a.pageDataSet.length||0;break}}return n},updateUI:function(e){var t=this.getStore();if(t&&(e||!this.__contentCmp||!this.__grid)){this.__contentCmp&&(this.remove(this.__contentCmp,!0),this.__contentCmp=null),this.__grid&&(this.__grid=null);var n=this.getSectionModel(),i=Ext.String.htmlEncode(n.title),a=this.getDeliveryEngine().getMetaModel().getDataModel(),r=a.__data.__data.detailDataSet,o=this.getSectionModel().getData().dtlLayoutId,s=this.totalRecords(r,o);this.setTitle(i+" ("+s+")");var l=t.getProxy();t.totalCount=Number(s),l.getData().total=Number(s);var c=[],u={xtype:"svmx.grid",layout:"fit",cls:"sfm-delivery-detail-grid",minWidth:"100%",pinHeaders:!1,autoHeight:!0,bufferSize:t.getCount(),itemConfig:{cls:"listitem-sfmdelivery-details",viewModel:!0},columns:this.buildColumns(this.getMaxCols()),store:t,plugins:"svmxgridpagingtoolbar",pagingBarDockPosition:"bottom",alignPagingToolBar:"left",totalPage:s,pageSize:t.pageSize,scrollOffset:-50,listeners:{itemtap:_.proxy(this,this.doItemTap),columnsort:_.proxy(this,this.__sortAllLines)}};this.getIsDesktop()||(u.width="100%"),this.getIsDesktop()||this.getReadOnly()||!n.allowDeleteLines||(u.listeners.deleterow=_.proxy(this,this.doDeleteRow)),Ext.isWindows&&(u.tooltip={target:Ext.getBody(),delegate:".x-gridcell",anchor:"left",maxHeight:"200px",maxWidth:"50%",autoHide:!1,scrollable:"y",defaultAlign:"b-l",listeners:{beforeshow:function(e,t){var n=e.currentTarget,i=n.dom.lastChild;e._autoHide=!0;var a=e.innerElement;e.tipElement;return a.setStyle({backgroundColor:"#fff",color:"#333",fontSize:"16px",fontWeight:"300",lineHeight:"1.2em",maxHeight:"200px",overflowY:"auto"}),i.scrollWidth>i.clientWidth&&i.lastChild&&"#text"===i.lastChild.nodeName?(e.setHtml(i.innerText),e.element.dom.style.display="block",!0):(e.setHtml(""),e.element.dom.style.display="none",!1)},show:function(e,t){e._autoHide=!1},blur:function(e,t,n){e.element.dom.style.display="none"}}}),this.__grid=Ext.create(u),c.push(this.__grid);var d=n.allowNewLines;!this.getReadOnly()&&d&&c.push({xtype:"svmx.button",cls:"button-sfmdelivery-edit-line-add",iconCls:"icon-plus",html:D().T("FSA008_TAG060","Add"),handler:_.proxy(this,"addNew",this,this.getSectionModel())}),this.__contentCmp=Ext.widget("svmx.verticalpanel",{items:c}),this.add(this.__contentCmp)}},addNew:function(e,t){this.getView().addNew(e,t)},doItemTap:function(e,t,n,i,a,r){a.target.className.indexOf("icon-close")>=0||a.target.className.indexOf("svmx-grid-swipe-delete-button")>=0||a.target.parentElement.className.indexOf("svmx-grid-swipe-delete-button")>=0||this.onDetailRecordSelect(i,t)},updateMaxCols:function(e){console.log("NewMaxCols: "+e),this.updateUI(!0)},updateShowLastColumn:function(e){if(console.log("ShowLastColumn: "+e),this.__grid){var t=this.__grid.getColumns();t[t.length-1].setHidden(!e)}},doDeleteRow:function(e,t,n,i){var a=this;a.getView().deleteRecord(a.getDetailId(),t,i)},doCopyRow:function(e,t,n,i){var a=this;a.getView().copyDetailRecord(a.getDetailId(),i,a)},__getRecordData:function(e){var t=e.getData();if(void 0!==t&&null!==t)for(var n in t)-1!==n.indexOf("__key",n.length-"__key".length)&&void 0===t[n]&&(t[n]="");return t},getValueHandler:function(){var e=this,t=[],n=this.getSectionModel().getChildNode("fields"),i=this.getStoreProxyData();if(i)for(var a=i.length,r=a-1;r>=0;r--)!function(a){var r=i[a],o=_.cloneObject(r);t.push(o),_.array.forEach(n,function(e){if("picklist"!=e.datatype&&"multipicklist"!=e.datatype||o[e.fieldName+"__key"]&&o[e.fieldName+"__key"].value!=m.NO_VALUE){if("datetime"==e.datatype||"date"==e.datatype){var t=(e.datatype,o[e.fieldName+"__key"]?o[e.fieldName+"__key"].value:null),n=o[e.fieldName],i=t||n;o[e.fieldName+"__key"]={key:i,value:i}}else if("id"==e.datatype)delete o[e.fieldName+"__key"];else if("currency"==e.datatype||"percent"==e.datatype||"double"==e.datatype||"int"==e.datatype)"string"==typeof o[""+e.fieldName]&&""===o[""+e.fieldName]&&(o[""+e.fieldName]=null),delete o[e.fieldName+"__key"];else if("boolean"==e.datatype||"booleanmobile"==e.datatype){var a=o[e.fieldName+"__key"],r="false";void 0!==a&&null!==a&&void 0!==a.value&&null!==a.value&&(r=!0===a.value||"true"===a.value?"true":"false"),o[e.fieldName+"__key"]={key:r,value:r}}}else o[e.fieldName+"__key"]={key:null,value:null}},e)}(r);return{lines:t}},onAddRecordsComplete:function(e,t){if(e>1||this.getSectionModel().multiAddSearchField)return void(this.getView()&&this.getView().updateIsBillable());for(var n=this.getStore().getData().items,i=null,a=0,r=0;r<n.length;r++)if(n[r].raw.Id==t[0].sobjectinfo.Id){i=n[r],a=r;break}this.getView().getConsole().editRecordStore=i,this.getView().showViewInDialog({view:"editdetails",options:{detailId:this.getDetailId(),rowIndex:a,detailStore:i.store.getData().items}})},onCopyRecordsComplete:function(e,t){if(e>1||this.getSectionModel().multiAddSearchField)this.getView()&&this.getView().updateIsBillable();else{for(var n=this.getStore().getData().items,i=null,a=0;a<n.length;a++)if(n[a].raw.Id==t[0].sobjectinfo.Id){i=n[a],a;break}i&&i.data.__copy&&(delete i.data.__copy,this.getView()&&this.getView().updateIsBillable())}},onDetailRecordSelect:function(e,t,n){var i=this.getView();i.__selected||(i.__selected=!0,i.getConsole().editRecordStore=e,i.showViewInDialog({view:this.getReadOnly()?"linedetails":"editdetails",options:{detailId:this.getDetailId(),recordId:e.get("Id"),rowIndex:t,detailStore:e.store.getData().items,additionalInfo:n}}))},doDestroy:function(){if(this.getStore&&this.getStore()){var e=this.getStoreProxy(),t=e.getData();for(var n in t)delete t[n];t=null,e.destroy(),Ext.data.StoreManager.unregister(this.getStore()),this.getStore().destroy()}this.callParent()}}),Ext.define(I.name+".DeliveryDetails",{extend:h.name+".SVMXNavContainer",alias:"widget.sfm.delivery.sections",config:{model:null,readOnly:!0,deliveryEngine:null,view:null},plugins:[{ptype:"sfm.delivery.sectionbuilder",type:"sfm.delivery.sectionbuilder",pluginId:"sectionBuilder"}],flex:1,width:"100%",bubbleEvents:["inputblur"],initialize:function(){this.callParent(),this.__sectionBuilder=this.__getSectionBuilder()},__getSectionBuilder:function(){if(!this.__sectionBuilder)for(var e=this.getPlugins(),t=0;t<e.length;t++)if("sectionBuilder"===e[t].pluginId){this.__sectionBuilder=e[t];break}return this.__sectionBuilder},applyModel:function(e){if(void 0!==e.getChildNode("header")&&this.__applyHeaderModel(e.getChildNode("header")),void 0!==e.getChildNode("details")){var t=e.getChildNode("details"),n=t.getChildNode("details");this.__applyDetailModel(n)}!e.getHeaderMetaModel().getAttachmentsHidden()&&!this.config.hideAttachments&&this.__buildAttachmentSection();var i=null;if(e.getData()&&e.getData().response&&e.getData().response.sfmProcessType&&(i=e.getData().response.sfmProcessType),i&&"VIEW RECORD"===i){var a=null;if(this.getView().getOption("SVMX_record")&&(a=this.getView().getOption("SVMX_record").attributes.type),a&&a===_.OrgNamespace+"__Service_Order__c"){var r=!1,o=!1,s=e.getData().page.header.headerLayout;r=s[_.OrgNamespace+"__Show_Product_History__c"],o=s[_.OrgNamespace+"__Show_Account_History__c"],(r||o)&&this.__buildHistorySection({showProductHistory:r,showAccountHistory:o})}}return _.getClient().isLaptop()||this.__buildSpaceSection(),e},__buildSpaceSection:function(){Ext.ClassManager.isCreated(I.name+".SpaceSection")||Ext.define(I.name+".SpaceSection",{extend:f.name+".SVMXPanel",alias:"widget.sfm.delivery.spacesection",height:35});var e=Ext.widget("sfm.delivery.spacesection",{});this.addPanel(e)},__buildHistorySection:function(e){var t=this.getDeliveryEngine(),n=this.getView().getOption("SVMX_record"),i=[];if(e.showProductHistory){var a=this.__createProductHistorySection(t,{record:n});i.push(a)}if(e.showAccountHistory){var r=this.__createAccountHistorySection(t,{record:n});i.push(r)}i&&i.length>0&&(_.array.map(i,function(e){e.ready()}),this.addPanels(i))},__createProductHistorySection:function(e,t){var n=Ext.widget("sfm.delivery.producthistorysection",{cls:["sfm-process-edit","sfm-delivery-section"],deliveryEngine:e});return n.updateOptions(t),n},__createAccountHistorySection:function(e,t){var n=Ext.widget("sfm.delivery.accounthistorysection",{cls:["sfm-process-edit","sfm-delivery-section"],deliveryEngine:e});return n.updateOptions(t),n},__buildAttachmentSection:function(){var e=this.getDeliveryEngine(),t=this.getView().getOption("SVMX_recordId"),n=this.getReadOnly(),i=[],a=this.__createAttachmentSection(e,{showDocuments:!0,showImages:!1,detailId:t,allowAttachmentDelete:!n,from:"sfmdelivery-documents"});i.push(a);var r=this.__createAttachmentSection(e,{showDocuments:!1,showImages:!0,detailId:t,allowAttachmentDelete:!n,from:"sfmdelivery-images"});i.push(r),_.array.map(i,function(e){e.ready()}),this.addPanels(i)},__createAttachmentSection:function(e,t){var n=["sfm-process-edit","sfm-delivery-section"];t&&t.showImages&&n.push("sfm-attachment-images-section"),t&&t.showDocuments&&n.push("sfm-attachment-documents-section");var i=Ext.widget("sfm.delivery.attachmentdocumentsection",{halign:"full",cls:n,deliveryEngine:e});return i.updateOptions(t),i},__applyDetailModel:function(e){var t=_.getClient().isLaptop(),n=_.array.map(e,function(e){var n={xtype:"sfm.delivery.editlineitems",cls:"sfm-delivery-section",title:Ext.String.htmlEncode(e.title),detailId:e.layoutId,sectionModel:e,itemId:"Detail_"+e.layoutId,deliveryEngine:this.getDeliveryEngine(),readOnly:this.getReadOnly(),view:this.getView(),isDesktop:t,layout:"fit"},i={};return i=t?{maxCols:200,showLastColumn:!0,scrollable:"horizontal"}:{plugins:"responsive",responsiveConfig:{narrowScreen:{showLastColumn:!0},wideScreen:{showLastColumn:!0}},maxCols:4,width:"100%"},Ext.apply(n,i),n},this);this.addPanels(n)},addSectionContent:function(e,t,n){var i=t.getData().sectionDetail[_.getCustomFieldName("Use_For_SLA_Clock")];if(i){if(!_.getClient().getApplicationParameter("enable-sla-clock"))return}var a={xtype:"svmx.panel",cls:"sfm-delivery-section",width:"100%",layout:"auto",itemId:"section_"+n,title:Ext.String.htmlEncode(t.title)};i||(a.items=[e]),this.addPanel(a)},__applyHeaderModel:function(e){var t=e.getChildNode("sections"),n=this.__getSectionBuilder();if(t)for(var i=0;i<t.length;i++)n.buildSection(t[i],i);else n.buildSection(e,0);var a=this.getView();a.addAfterListener("show",_.proxy(this,function(e,t){e.__disabled=!1,e.__selected=!1})),a.addAfterListener("svmx-unmasked",_.proxy(this,function(e,t){e.__disabled=!1,e.__selected=!1}))},addSLAClocks:function(e){if(this.getModel()){var t=this.getModel().getChildNode("header"),n=t.getChildNode("sections");this.__getSectionBuilder();if(n)for(var i=0;i<n.length;i++)if(n[i].getData().sectionDetail[_.getCustomFieldName("Use_For_SLA_Clock")]){var a=this.__getSection(i);a.getInnerItems().length>0&&a.removeInnerAt(0,!0);var r=e.createSLAClockView();r&&a.add(r)}}},__getSection:function(e){return this.query("#section_"+e)[0]},doDestroy:function(){this.getStore&&this.getStore()&&(Ext.data.StoreManager.unregister(this.getStore()),this.getStore().destroy(),this._store=null),this.setDeliveryEngine(null),this.callParent()}}),Ext.define(I.name+".SectionDetails",{extend:f.name+".SVMXContainer",alias:"widget.sfm.delivery.sectiondetails",config:{model:null,readOnly:!0,view:null},plugins:[{ptype:"sfm.delivery.sectionbuilder",type:"sfm.delivery.sectionbuilder",pluginId:"sectionBuilder"}],style:"width:100% !important;",layout:"auto",bubbleEvents:["inputblur"],initialize:function(){this.callParent(),this.__sectionBuilder=this.__getSectionBuilder()},__getSectionBuilder:function(){if(!this.__sectionBuilder){var e=this;_.array.map(this.getPlugins(),function(t){if("sectionBuilder"==t.pluginId)return e.__sectionBuilder=t,!1}),console.log(this.__sectionBuilder)}return this.__sectionBuilder},addSectionContent:function(e,t){this.add(e)},applyModel:function(e){var t=e.getChildNode("sections"),n=this.__getSectionBuilder();if(t)for(var i=0;i<t.length;i++)n.buildSection(t[i],i);else n.buildSection(e,0);var a=this.getView();return a.addAfterListener("show",_.proxy(this,function(e,t){e.__disabled=!1})),a.addAfterListener("svmx-unmasked",_.proxy(this,function(e,t){e.__disabled=!1})),e}}),Ext.define(I.name+".SectionBuilderPlugin",{extend:Ext.plugin.Abstract,alias:"plugin.sfm.delivery.sectionbuilder",init:function(e){this.__container=e,this.__view=e.getView(),this.__isBarCodeEnabled=_.getClient().isBarCodeEnabled()},getView:function(){return this.__view},buildSection:function(e,t){this.__sectionIndex=t;var n=_.sort(e.getChildNode("fields"),"sequence"),i=_.array.map(n,this.createFieldItem,this);try{var a={xtype:"svmx.fieldset",cls:"sfm-delivery-fieldset",layout:"auto",width:"100%",itemId:e.getData().dtlLayoutId||e.getData().sectionDetail.Id,items:"details"===this.__container.getItemId()?i:this.buildRowColumnLayout(i),overrideFieldLabelAlign:!1,labelAlign:"top"};this.__container.addSectionContent(a,e,t)}catch(e){A.error(e),A.error("Failed to build section: "+e)}},buildRowColumnLayout:function(e){for(var t=[],n=0;n<e.length;){var i=e[n].compositionMetamodel;if(1===i.column){var a=e[n].compositionMetamodel,r=n<e.length-1&&e[n+1].compositionMetamodel;r&&2===r.column&&r.row===a.row?(t.push(this.createColumnLayout(e[n],e[n+1],"left")),n+=2):(t.push(this.createColumnLayout(e[n],!1,"left")),n+=1)}else 2===i.column&&(t.push(this.createColumnLayout(!1,e[n],"right")),n+=1)}return t},createColumnLayout:function(e,t,n){var i=[];return e&&i.push(e),t&&i.push(t),{xtype:"svmx.container",cls:"svmx-field-row-layout",width:"100%",layout:{type:"hbox",pack:n,align:"start"},items:i}},reset:function(){},__fieldToEditorMap:{double:{handler:"createNumber",xtype:"sfm.field.double",emptyReadonlyTag:"TAGTODO1"},reference:{handler:"createLookup",xtype:"sfm.field.lookup",emptyReadonlyTag:"TAGTODO2"},id:{handler:"createText",xtype:"sfm.field.text",emptyReadonlyTag:"TAGTODO1"},string:{handler:"createText",xtype:"sfm.field.text",emptyReadonlyTag:"TAGTODO1"},datetime:{xtype:"sfm.field.datetime",emptyReadonlyTag:"TAGTODO1"},date:{xtype:"sfm.field.date",emptyReadonlyTag:"TAGTODO1"},picklist:{handler:"createPicklist",xtype:"sfm.field.picklist",emptyReadonlyTag:"TAGTODO2"},recordtype:{handler:"createRecordType",xtype:"sfm.field.recordtype",emptyReadonlyTag:"TAGTODO2"},boolean:{handler:"createCheckbox",xtype:"sfm.field.checkbox",emptyReadonlyTag:"TAGTODO1"},booleanmobile:{handler:"createTogglebox",xtype:"sfm.field.togglefield",emptyReadonlyTag:"TAGTODO1"},textarea:{handler:"createTextArea",xtype:"sfm.field.textarea",emptyReadonlyTag:"TAGTODO1"},textareaextended:{handler:"createTextAreaExtended",xtype:"sfm.field.textareaextended",emptyReadonlyTag:"TAGTODO1"},hidden:{xtype:"sfm.field.text",emptyReadonlyTag:"TAGTODO1"},currency:{handler:"createNumber",xtype:"sfm.field.currency",emptyReadonlyTag:"TAGTODO1"},email:{handler:"createEmail",xtype:"sfm.field.email",emptyReadonlyTag:"TAGTODO1"},phone:{handler:"createPhone",xtype:"sfm.field.phone",emptyReadonlyTag:"TAGTODO1"},percent:{handler:"createNumber",xtype:"sfm.field.percent",emptyReadonlyTag:"TAGTODO1"},url:{handler:"createUrl",xtype:"sfm.field.url",emptyReadonlyTag:"TAGTODO1"},multipicklist:{handler:"createMultiPicklist",xtype:"sfm.field.multipicklist",emptyReadonlyTag:"TAGTODO1"},attachment:{handler:"createChecklistMediaFieldAttachment",xtype:"sfm.field.mediafileupload",emptyReadonlyTag:""},int:{handler:"createNumber",xtype:"sfm.field.number",emptyReadonlyTag:"TAGTODO1"}},createFieldItem:function(e){if(e.isFieldAccessible()){var t=e.datatype;return e.attachMoreIcon=!1,"string"!=t&&"textarea"!=t||("string"==t&&e.charLength<256?(e.attachMoreIcon=!0,t="string"):t="textareaextended",e.datatype=t),"boolean"!==t||_.getClient().isLaptop()||(t="booleanmobile"),this.__createFieldItemForDataType(e,t)}},onInvokeEventsComplete:function(e){},onInvokeCustomEventsComplete:function(e){var t="",n={};"success"!=e.status?(A.error("Validation_Error for custom snippet : ",e.error_message),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",n.error_msg=e.error_message):(console.log("Response from snippet: No errors found"),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETSUCCESS");var i=_.getCurrentApplication().getCurrentView().getDeliveryEngine().getEventBus(),a=_.create("com.servicemax.client.lib.api.Event",t,this,{request:n,responder:{}});i.triggerEvent(a)},invokeFieldEvent:function(e,t,n){var i=this.__view.getDeliveryEngine()||this.__view.__rootView.getDeliveryEngine(),a=i.getEventBus(),r=void 0,o=t&&t._compositionMetamodel&&t._compositionMetamodel.fieldName,s=t&&t._compositionMetamodel&&t._compositionMetamodel._parent&&t._compositionMetamodel._parent.recordId;_.getClient().getApplicationParameter("svmx-sfm-disable-events")||(r=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:[e],data:i.getTargetData().getData(),metadata:i.getPageMetaData().getRawPageMetaData(),deliveryEngine:i,additionalInfo:{processId:i.processId,nextStepId:i.nextStepId,fieldData:{fieldName:o,detailRecordId:s}},invokedFrom:"Field"},responder:_.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)}),a.triggerEvent(r))},bindCmpChangeEvent:function(e,t){var n=this;t.listeners.change=function(t,i,a){var r=e.getEventInfoFor("Field Exit");r&&n.invokeFieldEvent(r,this,20)},t.listeners.destroy=function(t){e.unbind("PARENT_CHANGED",i,n)};var i=function(t){var n=this.__container.query("#field_"+e.fieldName)[0];if(n){var i=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:String(n.getChecked())});e.triggerEvent(i)}};e.bind("PARENT_CHANGED",i,this)},__createFieldItemForDataType:function(e,t){var n=this.__fieldToEditorMap[t];n||(n=this.__fieldToEditorMap.textarea);var i=n.handler,a=D().T(n.emptyReadonlyTag,""),r="",o=e&&e._data&&e._data.fieldDetail&&e._data.fieldDetail[_.getCustomFieldName("QuestionInfoJSON")];if(o){var s=_.toObject(o);if(s&&s.question&&s.question.helpURL){r=s.question.helpURL;-1==r.indexOf("://")&&(r="http://"+r)}}var l=this,c={initialize:function(){var t=e.createBinding(this.setValueHandler||this.setValue,this.getValueHandler||this.getValue,this);t.setValidator({handler:l.validationHandler,context:this}),t.setBizRuleValidator({handler:l.businessRuleHandler,context:this}),e&&e.__fieldInfo&&"Attachment"===e.__fieldInfo.question.responseType&&e.createAttachmentBinding(this.setAttachmentValue,this.getAttachmentValue,this)},blur:function(){l.__container.fireEvent("inputblur",l.__container,l.__container,this)},clearicontap:function(){l.__container.fireEvent("valueChanged",this)},valueChanged:function(){l.__container.fireEvent("valueChanged",this)},focus:function(){l.__container.fireEvent("focus",this)}},u=!1;e&&"textarea"==e.datatype&&(u=!0);var d=[];e.fieldEvents&&e.fieldEvents.length&&(d=d.concat(e.fieldEvents));var h=e._parent&&e._parent.getData()&&e._parent.getData().sectionDetail&&e._parent.getData().sectionDetail[_.OrgNamespace+"__No_Of_Columns__c"]||2,f={xtype:n.xtype,label:e.fieldLabel,labelAlign:"top",listeners:c,readOnly:l.__container.getReadOnly(),disabled:!l.__container.getReadOnly()&&e.readOnly,emptyReadonlyTag:"",__emptyReadonlyTag:a,required:e.required,itemId:"field_"+e.fieldName,isBarCodeAppendEnabled:u,compositionMetamodel:e,barcodeHandler:_.proxy(this,"barcodeScanned"),helpUrl:r,eventsToExecute:d},p=e._parent;return p&&2==p.colCount&&(f.cls="svmx-twocolumn sfmdelivery-column-height",f.cls+=" svmx-field-col-"+e.column),i&&l[i](e,f),2===h?this.__addResponsiveConfig(t,f):f.width="100%",f},barcodeScanned:function(e,t){try{this.fireEvent("valueChanged",e)}catch(t){this.__container.fireEvent("valueChanged",e)}},__addResponsiveConfig:function(e,t){t.plugins="responsive",t.responsiveConfig={narrowScreen:{width:"100%"},wideScreen:{width:"50%"}}},validationHandler:function(){var e=this,t=this.isValid?this.isValid():{isValid:!0},n=this.getCompositionMetamodel();if(n&&n.isFieldAccessible()&&!n.readOnly)if(t.isRequired||t.isInvalid){var i=void 0;t.isRequired?i=D().T("FSA008_TAG061","The field {{fieldName}} is required"):t.isInvalid&&(i=D().T("FSA008_TAG062","The field {{fieldName}} is invalid")),t.message=_.string.substitute(i,{fieldName:this.getCompositionMetamodel().fieldLabel}),t.fieldLabel=this.getCompositionMetamodel().fieldLabel,t.fieldName=this.getCompositionMetamodel().fieldName}else t.isValid=!0;else t.isValid=!0;return t.errorCorrectionhandler=function(){e.scrollIntoView?e.scrollIntoView():e.focus()},t},businessRuleHandler:function(e){var t=this,n={};return n.fieldLabel=this.getCompositionMetamodel().fieldLabel,n.fieldName=this.getCompositionMetamodel().fieldName,n.message=e.message||"",n.errorCorrectionhandler=function(e){t.scrollIntoView?t.scrollIntoView():t.focus()},n},createLookup:function(e,t){t.listeners.ontap=_.proxy(this,"onLookupTap",e),this.bindCmpChangeEvent(e,t)},createUrl:function(e,t){t.listeners.onreadonlytap=_.proxy(this,"onUrlTap",e),t.enableBarcode=this.__isBarCodeEnabled,this.bindCmpChangeEvent(e,t)},createEmail:function(e,t){t.listeners.onreadonlytap=_.proxy(this,"onEmailTap",e),t.enableBarcode=this.__isBarCodeEnabled,this.bindCmpChangeEvent(e,t)},createPhone:function(e,t){t.listeners.onreadonlytap=_.proxy(this,"onTelephoneTap",e),t.enableBarcode=this.__isBarCodeEnabled,this.bindCmpChangeEvent(e,t)},createNumber:function(e,t){t.precision=e.scale,e.scale>0&&(t.stepValue="any"),t.len=e.precision-e.scale,t.enableBarcode=this.__isBarCodeEnabled,this.bindCmpChangeEvent(e,t)},createMultiPicklist:function(e,t){var n=e.getPicklistValues();return this._createMultiPicklistWithPLValues(e,t,n)},_createMultiPicklistWithPLValues:function(e,t,n){n.splice(0,1);var i=Ext.widget("svmx.store",{model:v,data:n});t.store=i,t.readOnly||(t.disabled=e.readOnly||e.isDependentPickList),e.isDependentPickList&&(t.cls=t.cls?t.cls+" sfm-delivery-dependent-field":"sfm-delivery-dependent-field");var a=function(t){var n=this.__view.query("#field_"+e.fieldName)[0];if(n){n.getReadOnly()||e.readOnly||n.setDisabled(t.data.value===m.NO_VALUE);var a=e.getPicklistValues(t.data);a.splice(0,1);var r=n.getCurrentValue()||[],o=[],s=[];if(null!==r&&void 0!==r){r instanceof Array||(r="string"==typeof r?r.split(n.getDelimiter()):[r]);var l=r.length,c=void 0;for(c=0;c<l;c++)r[c]&&(s[c]="string"==typeof r[c]?r[c]:r[c].get("value"))}if(i.setData(a),a.length>0&&null!=s&&void 0!=s){var u=void 0,d=void 0;for(u=0;u<s.length;u++)(d=i.find("value",s[u],0,!1,!0,!0))>-1&&o.push(i.getAt(d).get("value"));n.setValue(o),n.triggerValueChangedEvent(o,t)}}},r=function(){var t=this.__view.query("#field_"+e.fieldName)[0];t&&t.updateCurrentValue()},o=this;return t.listeners.destroy=function(t){e.unbind("PARENT_CHANGED",a,o),e.unbind("AFTER_CHANGED",r,o)},e.bind("PARENT_CHANGED",a,this),e.bind("AFTER_CHANGED",r,this),null},createPicklist:function(e,t){var n=e.getPicklistValues();return this._createPicklistWithPLValues(e,t,n)},_createPicklistWithPLValues:function(e,t,n){var i=Ext.widget("svmx.store",{model:v,data:n});t.store=i,t.emptyValue=m.NO_VALUE,t.readOnly||(t.disabled=e.readOnly||e.isDependentPickList),e.isDependentPickList&&(t.cls=t.cls?t.cls+" sfm-delivery-dependent-field":"sfm-delivery-dependent-field");var a=function(t){var n=this.__container.query("#field_"+e.fieldName)[0];if(n&&(!this.__container._view||"linedetails"!==this.__container._view.getViewConfig())){n.getReadOnly()||e.readOnly||n.setDisabled(t.data.value===m.NO_VALUE);var a=e.getPicklistValues(t.data),r=n.getCurrentValue(),o=void 0;if(null!==r&&void 0!==r&&(r instanceof Array?r=r[0].get("value"):"object"===(void 0===r?"undefined":(0,c.default)(r))&&(r=r.get("value"))),i.setData(a),a.length>0){var s=i.find("value",r,0,!1,!0,!0);o=s>-1?i.getAt(s).get("value"):a[0].value,n.setValue(o),n.triggerValueChangedEvent(o,t)}}},r=function(){var t=this.__view.query("#field_"+e.fieldName)[0];t&&t.updateCurrentValue()},o=this;t.listeners.change=function(t,n,i){var a=e.getEventInfoFor("Field Change");a&&o.invokeFieldEvent(a,this,20)},t.listeners.destroy=function(t){e.unbind("PARENT_CHANGED",a,o),e.unbind("AFTER_CHANGED",r,o)},e.bind("PARENT_CHANGED",a,this),e.bind("AFTER_CHANGED",r,this)},createRecordType:function(e,t){return this.createPicklist(e,t)},createCheckbox:function(e,t){var n="false",i=this;t.listeners.change=function(t,a,r){a=!0===a?"true":"false",n=a,t.triggerValueChangedEvent(a),t.triggerAfterValueChangedEvent();var o=e.getEventInfoFor("Field Change");o&&i.invokeFieldEvent(o,this,20)},t.listeners.destroy=function(t){e.unbind("PARENT_CHANGED",a,i)},t.labelAlign=t.readOnly?"left":"right",t.labelWidth=null;var a=function(t){var n=this.__container.query("#field_"+e.fieldName)[0];if(n){var i=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:String(n.getChecked())});e.triggerEvent(i)}};e.bind("PARENT_CHANGED",a,this)},createTogglebox:function(e,t){var n="false",i=this;!0===e.readOnly&&(t.readOnly=!0),t.listeners.change=function(t,a,r){a=!0===a?"true":"false",n=a,t.triggerValueChangedEvent(a),t.triggerAfterValueChangedEvent();var o=e.getEventInfoFor("Field Change");o&&i.invokeFieldEvent(o,this,20)},t.listeners.destroy=function(t){e.unbind("PARENT_CHANGED",a,i)},t.labelAlign=t.readOnly?"left":"right",t.labelWidth=null;var a=function(t){var n=this.__container.query("#field_"+e.fieldName)[0];if(n){var i=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:String(n.getValue())});e.triggerEvent(i)}};e.bind("PARENT_CHANGED",a,this)},createText:function(e,t){t.maxLength=e.charLength,t.enableBarcode=this.__isBarCodeEnabled,t.attachMoreIcon=e.attachMoreIcon,t.listeners.onreadonlytap=_.proxy(this,"onTextAreaTapWidget",e),this.bindCmpChangeEvent(e,t)},onTextAreaTapWidget:function(e,t,n,i){var a=this.__getScrollerActualOffset(this.cmp),r=this.getView();if(t.getValue().length&&(t.getReadOnly()||t.getDisabled())){Ext.widget("svmx.panel",{left:0,top:0,modal:!0,hideOnMaskTap:!0,cls:"sfm-delivery-textPopup-widget",html:"<div class = 'sfm-delivery-textPopup-widget-title sfm-delivery-textPopup-widget-style'> "+t.getLabel()+" </div><div class = 'sfm-delivery-textPopup-widget-style'> "+t.getValue()+"</div>"}).showBy(r,"c-c")}this.__setScrollerActualOffset(this.cmp,a)},createTextArea:function(e,t){t.maxLength=e.charLength,t.enableBarcode=this.__isBarCodeEnabled,this.__container&&"details"!==this.__container.getItemId()&&"question"!==e.datatype&&(t.expandible=!0,t.maxHeight="240px"),this.bindCmpChangeEvent(e,t)},createTextAreaExtended:function(e,t){var n=D().T("FSA008_TAG063","more"),i=D().T("FSA008_TAG064","edit");t.listeners.onreadonlytap=_.proxy(this,"onTextAreaTap",e),t.moreLink=n,t.editLink=i,this.createTextArea(e,t)},onTextAreaTap:function(e,t,n,i){var a=this.__getScrollerActualOffset(this.cmp),r=this.getView();r.__disabled||(r.__disabled=!0,t.getReadOnly()||t.getDisabled()?r.showViewInDialog({view:"viewtext",options:{title:e.fieldLabel,text:t.getValue(),fieldName:e.fieldName}}):r.showViewInDialog({view:"edittext",options:{title:e.fieldLabel,text:t.getValue(),maxLength:e.charLength,fieldName:e.fieldName,isBarCodeAppendEnabled:t.isBarCodeAppendEnabled,parentScroller:this.cmp,scrollerOffsetValue:a}})),this.__setScrollerActualOffset(this.cmp,a)},onUrlTap:function(e,t,n){if(t.getReadOnly()&&t&&t.getValue()){var i=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_BROWSER",this,{request:{link:t.getValue()}});_.getCurrentApplication().triggerEvent(i)}},onTelephoneTap:function(e,t,n){if(t.getReadOnly()&&t&&t.getValue()){var i=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_TELEPHONE",this,{request:{phone:t.getValue()}});_.getCurrentApplication().triggerEvent(i)}},onSMSTap:function(e,t,n){if(t.getReadOnly()&&t&&t.getValue()){var i=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_SMS",this,{request:{phone:t.getValue()}});_.getCurrentApplication().triggerEvent(i)}},onEmailTap:function(e,t,n){if(t.getReadOnly()&&t&&t.getValue()){var i=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_EMAIL",this,{request:{address:t.getValue()}});_.getCurrentApplication().triggerEvent(i)}},onLookupTap:function(e,t,n){if(!this.__lookupDisabled){var i=this.__getScrollerActualOffset(this.cmp);t.blur();var a=_.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.sfmsearch.platformspecifics"),r=this.getView();if(t.getReadOnly()){if(n&&n.key&&!n.isNameSyncData){if(r.__rootView&&(r.done(),r=r.__rootView),r.getId()!==_.getCurrentApplication().getCurrentView().getId())return;if(r.__disabled)return;r.__disabled=!0,a.showRecord({key:n.key}).always(function(){r.__disabled=!1})}}else r.__disabled||(r.__disabled=!0,e.__sourceFieldInvokedFrom=r.getDeliveryEngine()&&r.getDeliveryEngine().getRecordId()||"",r.currentLookupField=e,r.showViewInDialog({view:"lookup",options:{currentLookupField:e,value:n}}));this.__setScrollerActualOffset(this.cmp,i)}},createChecklistMediaFieldAttachment:function(e,t){t.fieldDef=e},__getScrollerActualOffset:function(e){var t=0;if("IPAD"===_.getClientTypeForUnifiedApp()&&e){var n=e.getScrollable();if(n){var i=n.getElement();i&&(t=i.el.dom.scrollTop)}}return t},__setScrollerActualOffset:function(e,t){if("IPAD"===_.getClientTypeForUnifiedApp()&&e){var n=e.getScrollable();if(n){var i=n.getElement();i&&(i.el.dom.scrollTop=t)}}}}),Ext.define(I.name+".SFMMenuButton",{extend:f.name+".SVMXButton",alias:"widget.sfm.menubutton",config:{menuItems:[],menuCls:"",menuPosition:"tl-bl?"},constructor:function(e){this.callParent(arguments),this.__createMenu(),this.on("tap",this.onTap,this)},onTap:function(e){var t=this,n=this.element.dom.offsetParent.id;if(n){var i=Ext.getCmp(n);i&&(i.getGrid().deselectAll(),i.setCls("x-selected"))}return e.stopEvent&&(e.stopEvent(),t.menu.record=t.parent.parent.getRecord(),t.menu.showBy(t,t.getMenuPosition())),!1},__createMenu:function(){var e=Ext.widget("svmx.panel",{items:this.getMenuItems(),cls:this.getMenuCls(),left:0,modal:!1,hideOnMaskTap:!0,listeners:{show:this.__onShowHandlerWrapper,hide:this.__onHideHandlerWrapper,scope:this}});this.menu=e},__onShowHandlerWrapper:function(){this.onShowHandler()},onShowHandler:function(){},__onHideHandlerWrapper:function(){this.onHideHandler()},onHideHandler:function(){var e=this.element.dom.offsetParent.id;if(e){var t=Ext.getCmp(e);t&&t.removeCls("x-selected")}},getMenu:function(){return this.menu},applyMenuItems:function(e){return this.menu&&(this.menu.removeAll(),this.menu.add(e)),e}}),Ext.define(I.name+".SFMPropertyMenuButton",{extend:I.name+".SFMMenuButton",alias:"widget.sfm.propertymenubutton",iconCls:"x-fa fa-list",menuPosition:"tl-bl?"}),Ext.define(I.name+".MultiPicklistField",{extend:p.name+".SVMXMultiPicklistField",alias:"widget.sfm.field.multipicklist",__currentValue:null,config:{compositionMetamodel:null,placeHolder:D().T("FSA008_TAG065","--None--")},isValid:function(){var e=this.callParent();return this.getRequired()&&!e.isRequired&&this.getValue()==m.NO_VALUE&&(e.isRequired=!0),e},setValue:function(e){this.callParent([e]),e&&e[0]!==m.NO_VALUE&&(this.__currentValue=e)},onDoneButtonTap:function(){this.callParent(),this.fireEvent("valueChanged")},getCurrentValue:function(){return this.__currentValue},updateCurrentValue:function(){this.__currentValue=this.getValue()},triggerValueChangedEvent:function(e,t){var n=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:e});t&&(n.data.passOnInformation=t.data.passOnInformation);var i=this.getCompositionMetamodel();i&&i.triggerEvent(n)},triggerAfterValueChangedEvent:function(){var e=_.create("com.servicemax.client.lib.api.Event","AFTER_CHANGED",this,{}),t=this.getCompositionMetamodel();t&&t.triggerEvent(e)},setValueHandler:function(e){null!==e&&void 0!==e&&""!==e||(e=m.NO_VALUE),this.setValue(e),e=this.getValue(),this.triggerValueChangedEvent(e)},getValueHandler:function(){var e=this.getValue(),t={};return e==m.NO_VALUE&&(e=""),e&&e instanceof Array&&(e=e.join(this.getDelimiter())),t.key=e,t.value=e,t},updateValue:function(e){this.callParent([e]),this.triggerValueChangedEvent(this.getValue())}}),Ext.define(I.name+".PicklistField",{extend:p.name+".SVMXPicklistField",alias:"widget.sfm.field.picklist",__currentValue:null,config:{compositionMetamodel:null},isValid:function(){var e=this.callParent();return this.getRequired()&&!e.isRequired&&this.getValue()==m.NO_VALUE&&(e.isRequired=!0),e},onListSelect:function(e,t){this.callParent([e,t]),this.fireEvent("valueChanged")},selectedFromNativePicker:function(e){this.callParent([e]),this.fireEvent("valueChanged")},setValue:function(e){null!==e&&void 0!==e&&""!==e||(e=m.NO_VALUE),this.callParent([e]),e!==m.NO_VALUE&&(this.__currentValue=e)},getValueHandler:function(){var e=this.getValue(),t={};return e==m.NO_VALUE&&(e=""),t.key=e,t.value=e,t},getCurrentValue:function(){return this.__currentValue},updateCurrentValue:function(){this.__currentValue=this.getValue()},triggerValueChangedEvent:function(e,t){var n=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:e});t&&(n.data.passOnInformation=t.data.passOnInformation);var i=this.getCompositionMetamodel();i&&i.triggerEvent(n)},triggerAfterValueChangedEvent:function(){var e=_.create("com.servicemax.client.lib.api.Event","AFTER_CHANGED",this,{}),t=this.getCompositionMetamodel();t&&t.triggerEvent(e)},updateValue:function(e){this.callParent([e]),this.triggerValueChangedEvent(this.getValue())}}),Ext.define(I.name+".RecordTypeField",{extend:I.name+".PicklistField",alias:"widget.sfm.field.recordtype",updateValue:function(e){this.callParent([e]);var t=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:this.getValue()});this.getCompositionMetamodel().triggerRecordTypeChanged(t),this.triggerAfterValueChangedEvent()}}),Ext.define(I.name+".CheckboxField",{extend:p.name+".SVMXCheckboxField",alias:"widget.sfm.field.checkbox",config:{compositionMetamodel:null},useReadOnlyLabel:!0,constructor:function(e){e||(e={}),Ext.apply(e,{labelAlign:"top",labelTextAlign:"top"}),this.callParent([e])},onMaskTap:function(e,t){this.callParent([e,t]);var n=this.getObjectForEventValueChaged();n&&n.fireEvent("valueChanged")},getObjectForEventValueChaged:function(){var e=void 0;return this.events&&this.events.hasOwnProperty("valuechanged")?e=this:this.parent&&this.parent.events&&this.parent.events.hasOwnProperty("valuechanged")&&(e=this.parent),e},triggerValueChangedEvent:function(){var e=this.getChecked(),t=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:String(e)});this.getCompositionMetamodel().triggerEvent(t)},triggerAfterValueChangedEvent:function(){var e=_.create("com.servicemax.client.lib.api.Event","AFTER_CHANGED",this,{});this.getCompositionMetamodel().triggerEvent(e)},getReadOnlyValue:function(e){return e?D().T("FSA016_TAG001","Yes"):D().T("FSA016_TAG002","No")},getValue:function(){return this.getChecked()},getValueHandler:function(){return this.getChecked()},setValue:function(e){this.setValueHandler(e)},setValueHandler:function(e){this.emptyReadonlyTag=this.__emptyReadonlyTag,this.setChecked(!0===e||"true"===e)}}),Ext.define(I.name+".ToggleField",{extend:p.name+".SVMXToggleField",alias:"widget.sfm.field.togglefield",compositionMetamodel:null,useReadOnlyLabel:!0,constructor:function(e){e||(e={}),Ext.apply(e,{labelAlign:"top",labelTextAlign:"top"}),this.callParent([e])},onMaskTap:function(e,t){this.callParent([e,t]),this.fireEvent("valueChanged")},triggerValueChangedEvent:function(){var e=this.getValue(),t=_.create("com.servicemax.client.lib.api.Event","CHANGED",this,{value:String(e)});this.getCompositionMetamodel().triggerEvent(t)},triggerAfterValueChangedEvent:function(){var e=_.create("com.servicemax.client.lib.api.Event","AFTER_CHANGED",this,{});this.getCompositionMetamodel().triggerEvent(e)},getReadOnlyValue:function(e){return e?D().T("FSA016_TAG001","Yes"):D().T("FSA016_TAG002","No")},getValue:function(){return this.callParent()},getValueHandler:function(){return this.getValue()},setValueHandler:function(e){this.emptyReadonlyTag=this.__emptyReadonlyTag,this.setValue(!0===e||"true"===e)}}),Ext.define(p.name+".RadioField",{extend:p.name+".SVMXRadioField",alias:"widget.sfm.field.radio",onMaskTap:function(e,t){this.callParent([e,t]);var n=this.getObjectForEventValueChaged();n&&n.fireEvent("valueChanged")},getObjectForEventValueChaged:function(){var e=void 0;return this.events&&this.events.hasOwnProperty("valuechanged")?e=this:this.parent&&this.parent.events&&this.parent.events.hasOwnProperty("valuechanged")&&(e=this.parent),e},initialize:function(){this.callParent()}}),Ext.define(p.name+".CheckboxForGroupField",{extend:p.name+".SVMXCheckboxField",alias:"widget.sfm.field.checkboxForGroup",onMaskTap:function(e,t){this.callParent([e,t]);var n=this.getObjectForEventValueChaged();n&&n.fireEvent("valueChanged")},getObjectForEventValueChaged:function(){var e=void 0;return this.events&&this.events.hasOwnProperty("valuechanged")?e=this:this.parent&&this.parent.events&&this.parent.events.hasOwnProperty("valuechanged")&&(e=this.parent),e},initialize:function(){this.callParent()}}),Ext.define(I.name+".DateTimeField",{extend:p.name+".SVMXDateTimeField",alias:"widget.sfm.field.datetime",config:{compositionMetamodel:null},invokeEventForField:function(){var e=this.getInitialConfig().eventsToExecute,t=e[0];if(t&&t.eventRawData){var n=t.eventRawData[_.OrgNamespace+"__Code_Snippet__c"],i=this.parent&&this.parent.getItemId();if(t&&n){var a=_.getCurrentApplication().getCurrentView();a.invokeCustomSnippet&&a.invokeCustomSnippet(t,i)}}},handlePickerResponse:function(e,t){this.updateValue(t,this._value),this.fireEvent("valueChanged"),this.invokeEventForField()},nativeDatePickerOnSuccess:function(e){e&&(this.setValue(e),this.fireEvent("valueChanged"),this.invokeEventForField())}}),Ext.define(I.name+".DateField",{extend:p.name+".SVMXDateField",alias:"widget.sfm.field.date",config:{compositionMetamodel:null},handlePickerResponse:function(e,t){this.updateValue(t,this._value),this.fireEvent("valueChanged")},nativeDatePickerOnSuccess:function(e){e&&(this.setValue(e),this.fireEvent("valueChanged"))}}),Ext.define(I.name+".RadioGroupField",{extend:p.name+".SVMXRadioGroup",alias:"widget.sfm.field.radiogroup",config:{compositionMetamodel:null,label:null,defaults:{xtype:"sfm.field.radio"}},initConfig:function(e){e&&(e.title=e.title||e.label),this.callParent(arguments)},getQuestionField:function(){return this.parent},setValue:function(e){null!==e&&void 0!==e&&""!==e||(e=m.NO_VALUE),this.callParent([e])},getValueHandler:function(){var e=this.getValue(),t={};return e==m.NO_VALUE&&(e=""),t.key=e,t.value=e,t}}),Ext.define(I.name+".CheckboxGroupField",{extend:p.name+".SVMXCheckboxGroup",alias:"widget.sfm.field.checkboxgroup",config:{compositionMetamodel:null,label:null,defaults:{xtype:"sfm.field.checkboxForGroup"}},initConfig:function(e){e&&(e.title=e.title||e.label),this.callParent(arguments)},getQuestionField:function(){return this.parent},setValueHandler:function(e){null!==e&&void 0!==e&&""!==e||(e=m.NO_VALUE),this.setValue(e)},getValueHandler:function(){var e=this.getValue(),t={};return e==m.NO_VALUE&&(e=""),e&&e instanceof Array&&(e=e.join(this.getDelimiter())),t.key=e,t.value=e,t}}),Ext.define(I.name+".LookupField",{extend:p.name+".SVMXLookupField",alias:"widget.sfm.field.lookup",config:{compositionMetamodel:null},setValueHandler:function(e){e&&"object"===(void 0===e?"undefined":(0,c.default)(e))&&e.key&&e.key.match("_local_")&&!e.value&&(e.value=e.key),console.log("!!!setValueHandler called for:"+this.getItemId()),console.log(e),this.__lookupDisabled=!e||!e.value||e.isNameSyncData,this.__lookupDisabled?this.addCls("sfm-lookupfield-disabled"):this.removeCls("sfm-lookupfield-disabled"),this.callParent([e])}}),Ext.define(I.name+".TextField",{extend:p.name+".SVMXTextField",alias:"widget.sfm.field.text",config:{compositionMetamodel:null}}),Ext.define(I.name+".DoubleField",{extend:p.name+".SVMXDoubleField",alias:"widget.sfm.field.double",config:{compositionMetamodel:null},setValue:function(e){this.callParent([e])}}),Ext.define(I.name+".TextAreaField",{extend:p.name+".SVMXTextAreaField",alias:"widget.sfm.field.textarea",config:{compositionMetamodel:null}}),Ext.define(I.name+".TextAreaFieldExtended",{extend:p.name+".SVMXTextAreaFieldExtended",alias:"widget.sfm.field.textareaextended",config:{compositionMetamodel:null}}),Ext.define(I.name+".CurrencyField",{extend:p.name+".SVMXCurrencyField",alias:"widget.sfm.field.currency",config:{compositionMetamodel:null},setValue:function(e){this.callParent([e])}}),Ext.define(I.name+".EmailField",{extend:p.name+".SVMXEmailField",alias:"widget.sfm.field.email",config:{compositionMetamodel:null},isValid:function(){var e=this.callParent();if(e&&!e.isInvalid){var t=this.getValue();if(void 0!==t&&null!==t&&""!==t){_.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance().isEmailValid(t)||(e.isValid=!1,e.isInvalid=!0,e.message=D().T("FSA008_TAG066","Invalid value in field: ")+this.getLabel())}}return e}}),Ext.define(I.name+".PhoneField",{extend:p.name+".SVMXPhoneField",alias:"widget.sfm.field.phone",config:{compositionMetamodel:null}}),Ext.define(I.name+".PercentField",{extend:p.name+".SVMXPercentField",alias:"widget.sfm.field.percent",config:{compositionMetamodel:null},setValue:function(e){this.callParent([e])}}),Ext.define(I.name+".UrlField",{extend:p.name+".SVMXUrlField",alias:"widget.sfm.field.url",config:{compositionMetamodel:null}}),Ext.define(I.name+".NumberField",{extend:p.name+".SVMXNumberField",alias:"widget.sfm.field.number",config:{compositionMetamodel:null},setValue:function(e){this.callParent([e])}}),Ext.define(I.name+".MediaFileUpload",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.sfm.field.mediafileupload",__fieldInfo:null,__parent:null,__record:null,__deliveryEngine:null,config:{compositionMetamodel:null,header:!1,store:null,layout:{type:"vbox",align:"left"},itemId:"MediaFileUploadField",items:[]},constructor:function(e){this.__bindings=[],this.__fieldInfo=e.fieldDef||null,this.__deliveryEngine=this.__fieldInfo._parent._parent._parent.__deliveryEngine||null,this.callParent(arguments),this.__syncService=_.getClient().getService("com.servicemax.client.syncmanager").getInstance(),this.__syncManager=_.getCurrentApplication().getSyncImpl().getSyncManager(),this.__attachmentUtils=_.create("com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.Utils",this);var t=_.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.bind(t,"ATTACHMENT_ON_DEMAND.STARTING",this.__updateData,this),this.bind(t,"ATTACHMENT_ON_DEMAND.DOWNLOADING",this.__updateData,this),this.bind(t,"ATTACHMENT_ON_DEMAND.FINISHED",this.__updateData,this),this.bind(t,"ATTACHMENT_ON_DEMAND.CANCELLED",this.__updateData,this),this.bind(t,"ATTACHMENT_ON_DEMAND.ERROR",this.__updateData,this),this.bind(this.__syncService,"SYNC_ATTACHMENTS_COMPLETED",this.refreshData,this),this.bind(this.__syncService,"SYNC_ATTACHMENTS_STOPPED",this.refreshData,this),this.bind(this.__syncService,"SYNC_ATTACHMENTS_STARTED",this.refreshData,this)},bind:function(e,t,n,i){this.__bindings.push({eventBus:e,eventName:t,fn:n,context:i}),e.bind(t,n,i)},doDestroy:function(){_.array.forEach(this.__bindings,function(e){e.eventBus.unbind(e.eventName,e.fn,e.context)}),this.__connectionTimer&&(clearInterval(this.__connectionTimer),this.__connectionTimer=null),this.__attachmentUtils&&this.__attachmentUtils.destroy&&(this.__attachmentUtils.destroy(),this.__attachmentUtils=null),this.callParent()},__updateData:function(e){var t=e.data.request.recordId,n=C.getMultiServerVersionRequest(),i=n.isSalesForceFilesEnabled()?_.OrgNamespace+"__SM_ContentVersion_ID__c":_.OrgNamespace+"__SM_Attachment_ID__c",a=this.__record.AttachmentData;if(a&&a[i]==t)switch(e.type){case"ATTACHMENT_ON_DEMAND.STARTING":a.status="waiting",this.showStatusOnImage();break;case"ATTACHMENT_ON_DEMAND.DOWNLOADING":a.status="downloading",this.showStatusOnImage();break;case"ATTACHMENT_ON_DEMAND.FINISHED":this.getAttachmentRealPath(a);break;case"ATTACHMENT_ON_DEMAND.ERROR":a.status="error",this.showStatusOnImage()}},refreshData:function(){var e=this.__record.AttachmentData;e.downloaded||this.setAttachmentValue(e)},initialize:function(){var e=this,t=g.getUserInfo(),n=e.__preventChooseLibrary(),i=_.getClient().getApplicationParameter("client-type");this.__record={OwnerId:t.UserId,IsDownloaded:!1,Name:"",QuestionId:this.__fieldInfo.__fieldInfo.question.id,ChecklistId:this.__deliveryEngine.recordId,InternalQuestionId:this.__fieldInfo.fieldName,IsMobile:"laptop"!==_.getClient().getApplicationParameter("client-type"),AttachmentData:{}};var a=[{xtype:"svmx.panel",width:"98%",height:64,layout:{type:"hbox",align:"middle"},header:!1,cls:"sfm-checklist-media-field",items:[{xtype:"label",html:D().T("FSA002_TAG028","Attach"),align:"left",hidden:this.__fieldInfo.readOnly||!1||"laptop"===i&&n,flex:9,cls:"sfm-checklist-attach-label",itemId:"checklistAttachLabel",style:{fontSize:"14px",fontWeight:"bold"},listeners:{click:{element:"element",fn:function(t,n){e.onAttachNewSelect(t,n)},scope:e}}},{xtype:"image",src:"",height:64,width:64,right:0,itemId:"checklistThumbnailImage",cls:"sfm-checklist-attach-image",html:"",style:{backgroundSize:"64px 64px",backgroundRepeat:"no-repeat",backgroundPosition:"right",top:"5px",textAlign:"center",fontSize:"10px"},listeners:{tap:{element:"element",fn:function(t,n){if(e.onTapHold)return void(e.onTapHold=!1);e.onAttachmentImageSelect(t)},scope:e},taphold:{element:"element",fn:function(t,n){e.onTapHold=!0,e.onAttachmentImageTapHold(t,n)},scope:e}}},{xtype:"video",height:36,width:64,hidden:!0,align:"right",right:0,url:"",itemId:"checklistThumbnailVideo",cls:"sfm-checklist-attach-video",html:"",posterUrl:"",style:{backgroundPosition:"right",top:"10px",lineHeight:"36px",fontSize:"10px"},listeners:{tap:{element:"element",fn:function(t,n){if(e.onTapHold)return void(e.onTapHold=!1);e.onAttachmentImageSelect(t)},scope:e},taphold:{element:"element",fn:function(t,n){e.onTapHold=!0,e.onAttachmentImageTapHold(t,n)},scope:e}}}]},{xtype:"svmx.panel",hidden:!0,itemId:"attachmentDecriptionPanel",layout:{type:"vbox",align:"middle"},header:!1,width:"99%",items:[{xtype:"sfm.field.text",enableBarcode:!1,itemId:"attachmentDecriptionField",width:"99%",cls:"sfm-checklist-attach-description-field",disabled:this.__fieldInfo.readOnly||!1,listeners:{blur:{fn:function(){var t=_.getClient().getApplicationParameter("device-info");if(t&&t["device-platform"]&&"android"===t["device-platform"].toLowerCase()){var n=Ext.query(".sfm-checklistsection-container")[0];if(n&&n.id){var i=Ext.getCmp(n.id);i.setHeight("0"),i.setHeight("100%")}}e.triggerValueChange()}},focus:{fn:function(){e.clearError()}}}}]}];this.add(a),this.imageThumbnail=this.query("#checklistThumbnailImage")[0],this.videoThumbnail=this.query("#checklistThumbnailVideo")[0],this.attachmentDescription=this.query("#attachmentDecriptionField")[0],this.attachmentDescriptionPanel=this.query("#attachmentDecriptionPanel")[0]},clearError:function(){var e=this.attachmentDescription;if(e){var t=e.getComponent("x-textfield");t&&(t.removeCls("cheklist-warning-field"),t.removeCls("cheklist-error-field"))}var n=this.parent&&this.parent.getComponent("errorPanel")&&this.parent.getComponent("errorPanel").getComponent("errorField");n&&(n.setHidden(!0),n.removeCls("cheklist-error-message"),n.removeCls("cheklist-warning-message"));var i=this.parent&&this.parent.getComponent("errorPanel")&&this.parent.getComponent("errorPanel").getComponent("warningConfirm");i&&i.setHidden(!0)},triggerValueChange:function(){this.fireEvent("valueChanged")},__preventChooseLibrary:function(){var e=C.getMultiServerVersionRequest();return!!e&&e.preventChooseFromLibrary()},onAttachNewSelect:function(e,t){var n=this,i=_.getClient().getApplicationParameter("client-type"),a=_.getClient().getApplicationParameter("device-info"),r=(a["device-platform"],n.__preventChooseLibrary());this.__completedChecklistPicker=Ext.widget("svmx.panel",{left:0,top:0,modal:!0,hideOnMaskTap:!0,cls:"sfm-checklist-attachment-control-popup",items:[{xtype:"svmx.button",width:"250px",text:D().T("FSA002_TAG037","Take Photo"),hidden:"laptop"===i,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"CAMERA"})},scope:n}}},{xtype:"svmx.button",width:"250px",text:D().T("FSA002_TAG033","Take Video"),hidden:"laptop"===i,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"VIDEO"})},scope:n}}},{xtype:"svmx.button",width:"250px",text:D().T("FSA002_TAG036","Choose from Library"),hidden:"laptop"===i||r,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"GALLERY"})},scope:n}}},{xtype:"svmx.button",width:"250px",text:D().T("FSA002_TAG036","Choose from Library"),hidden:"laptop"!==i||r,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"DOCUMENT"})},scope:n}}}]}),this.__completedChecklistPicker.showBy(e.target,"tl-tl?")},__getImageCompressionSetting:function(){var e=M.readFromJSCache("IMG_COMPRESSION_MODE","IMG_COMPRESSION_MODE"),t=_.getClient().getApplicationParameter("image-compression");e=e||t.defaultMode;var n=t.modes[e];return n.enabled="none"!==e,n},onAttachOptionMenu:function(e){this.__completedChecklistPicker.hide();var t=this.__deliveryEngine;if("CAMERA"===e.option||"VIDEO"===e.option){var n=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CAPTURE_PHOTO",this,{request:{context:this,deliveryEngine:this.__deliveryEngine,additionalInfo:"CAMERA"===e.option?{mode:"FROMCAMERA",imageCompression:this.__getImageCompressionSetting()}:{mode:"FROMVIDEO",duration:30}}});_.getCurrentApplication().triggerEvent(n)}else{var i=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ATTACH_FILE",this,{request:{deliveryEngine:t,recordId:t.getRecordId(),checklistUpload:!0,record:this.__record,imageCompression:this.__getImageCompressionSetting()},responder:_.create("com.servicemax.client.sfmdelivery.responders.ChecklistFileToUploadResponder",this)});_.getCurrentApplication().triggerEvent(i)}},onAttachmentImageTapHold:function(e,t){if(t._extData.visibilityMode){var n=this,i={xtype:"svmx.button",width:"200px",text:D().T("FSA008_TAG023","Delete"),listeners:{click:{element:"element",fn:function(e,t){this.shareDeleteMenu.hide(),n.deleteChecklistAttachment()},scope:n}}},a={xtype:"svmx.button",width:"200px",text:D().T("FSA008_TAG022","Share"),listeners:{click:{element:"element",fn:function(e,t){this.shareDeleteMenu.hide(),n.shareChecklistAttachment()},scope:n}}};this.shareDeleteMenu=Ext.widget("svmx.panel",{left:0,top:0,modal:!0,hideOnMaskTap:!0,cls:"sfm-attachment-control-popup",items:[]}),this.__fieldInfo.readOnly||this.shareDeleteMenu.add(i),this.shareDeleteMenu.add(a),this.shareDeleteMenu.showBy(e.target,"tl-tr?")}},shareChecklistAttachment:function(){var e=this,t=this.__record.AttachmentData.file_path;t=t.replace(/''/g,"'"),t=new y.File(t),t.info().then(_.proxy(this,function(t,n){var i=n.filePath||FILEIO.__convertBaseDirectory(inResponse.fileDataToStore.file.__path);i=decodeURIComponent(i);var a=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SHARE_ATTACHMENTS",e,{request:{deliveryEngine:e.__deliveryEngine,attachments:[i]},responder:_.create("com.servicemax.client.sfmdelivery.responders.ChecklistAttachmentOperationsResponder",e)});e.__deliveryEngine.getEventBus().triggerEvent(a)}))},deleteChecklistAttachment:function(){var e=this,t=D().T("FSA016_TAG004","Cancel"),n=D().T("FSA008_TAG023","Delete"),i=D().T("FSA008_TAG072","Delete Attachments?"),a=D().T("FSA008_TAG073","The attachments will be removed from {{name}} and will be deleted from the server at the next sync. This action cannot be undone.");a=_.string.substitute(a,{name:"question"}),_.Msg.confirm({title:i,text:a,buttons:[{text:t,itemId:"CANCEL",ui:"svmx-button-square"},{text:n,itemId:"DELETE",ui:"svmx-button-square"}]}).done(_.proxy(this,function(t){if("DELETE"===t){if(e.__record&&e.__record.AttachmentData&&e.__record&&e.__record.AttachmentData){e.__fieldInfo.isDescriptionRequired=!1,e.__record.AttachmentData.isDeleted=!0,e.imageThumbnail.setSrc(""),e.imageThumbnail.setCls(""),e.videoThumbnail.setUrl(""),e.videoThumbnail.setCls(""),e.setImageVideoThumbnail(!1,!0),e.attachmentDescriptionPanel.setHidden(!0);e.query("#checklistAttachLabel")[0].setHtml(D().T("FSA002_TAG028","Attach")),e.attachmentDescription.setValue(""),e.clearError(),e.triggerValueChange()}}}))},createChecklistJSON:function(e){var t,n=S.__generateId(_.OrgNamespace+"__SM_Checklist_Attachment__c"),i="attach_local_"+(new Date).getTime(),a=this.__fieldInfo,r=this.getFileType(e.fileInfo),o=e.fileDataToStore.file.__path;o="laptop"===_.getClient().getApplicationParameter("client-type")?o.replace("{UploadDirectory}\\",""):o.replace("{UploadDirectory}/","");var l=this.__record.AttachmentData.deletedFiles||[],c=this.__record.AttachmentData.deletedAttachmentId||null,u=this.__record.AttachmentData.deletedCdlId||null;(e.fileDataToStore.file.__path!==this.__record.AttachmentData.file_path&&this.__record.AttachmentData.file_path&&this.__record.AttachmentData.file_path.length>0||this.__record&&this.__record.AttachmentData&&this.__record.AttachmentData.isDeleted)&&(l.push(this.__record.AttachmentData.file_path),c=this.__record.AttachmentData[_.OrgNamespace+"__SM_Attachment_ID__c"],u=this.__record.AttachmentData[_.OrgNamespace+"__SM_ContentDocumentLink_ID__c"]);var d=e.fileInfo.FileSizeInBytes,h=a.__fieldInfo&&a.__fieldInfo.question.id,f=T.getAttachmentFieldNameInCATable();return t={Id:n,fileName:o,file_path:e.fileDataToStore.file.__path},(0,s.default)(t,_.OrgNamespace+"__SM_Attachment_Name__c",o),(0,s.default)(t,_.OrgNamespace+"__SM_Question__c",h),(0,s.default)(t,f,i),(0,s.default)(t,_.OrgNamespace+"__SM_File_Type__c",r),(0,s.default)(t,_.OrgNamespace+"__SM_File_Size__c",d),(0,s.default)(t,_.OrgNamespace+"__SM_Checklist__c",this.__deliveryEngine.recordId),(0,s.default)(t,_.OrgNamespace+"__SM_Internal_Question_ID__c",a.fieldName),(0,s.default)(t,"saveRequired",!0),(0,s.default)(t,"isDeleted",!1),(0,s.default)(t,"downloaded",!0),(0,s.default)(t,"deletedFiles",l),(0,s.default)(t,"deletedAttachmentId",c),(0,s.default)(t,"deletedCdlId",u),t},getFileType:function(e){var t=void 0,n=e&&e.FileExtention&&e.FileExtention.toLowerCase()||e&&e.FileExtension&&e.FileExtension.toLowerCase();switch(n=n.replace(".","")){case"jpg":case"png":case"jpeg":case"gif":case"bmp":case"tif":case"tiff":t="image";break;case"mp4":case"mov":case"wmv":case"avi":case"mpeg":case"mpg":case"3gp":case"flv":case"mkv":t="video";break;default:t="document"}return t},onFileSelectedForUpload:function(e){var t=this;this.clearError(),this.__record.AttachmentData=this.createChecklistJSON(e);var n=this.__record.AttachmentData.file_path;n=n.replace("Upload/","{UploadDirectory}/"),n=n.replace(/''/g,"'"),new y.File(n).info().then(_.proxy(this,function(n,i){var a=i.filePath||FILEIO.__convertBaseDirectory(e.fileDataToStore.file.__path);t.showImageVideoThumbnail(a,!0),t.attachmentDescriptionPanel.setHidden(!1),t.query("#checklistAttachLabel")[0].setHtml(D().T("FSA002_TAG029","Attach New")),t.triggerValueChange()}))},onFileSelectedForUploadError:function(e){e.data&&e.data.data&&e.data.data.error&&e.data.data.errorCode&&e.data.data.errorMessage?_.getCurrentApplication().showMessage({type:"ERROR",text:e.data.data.errorMessage,buttons:[{text:D().T("FSA016_TAG003","OK"),itemId:"OK"}],closable:!1}):e.fileSizeExceeded&&this.onFileSizeExceededError(e)},onFileSizeExceededError:function(e){var t=D().T("FSA008_TAG071","File size is greater than maximum allowed file size.")+" ("+e.fileSizeLimitName+")";_.getCurrentApplication().showMessage({type:"ERROR",text:t,buttons:[{text:D().T("FSA016_TAG003","OK"),itemId:"OK"}],closable:!1})},onAttachmentImageSelect:function(e){var t=this,n=this.__record.AttachmentData;if(n.downloaded){var i=this.__record.AttachmentData.file_path;i=i.replace(/''/g,"'"),i=new y.File(i),i.info().then(_.proxy(this,function(e,n){t.openChecklistAttachment(i)}),_.proxy(this,function(e){var n=t.__record.AttachmentData[_.OrgNamespace+"__SM_Checklist__c"],i=t.__record.InternalQuestionId,a=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_CHECKLIST_ATTACHMENT_FILE_PATH",t,{request:{checklistId:n,questionId:i},responder:_.create("com.servicemax.client.sfmdelivery.responders.GetChecklistAttachmentFilePathResponder",t)});_.getCurrentApplication().triggerEvent(a)}))}else if(n&&!n.downloaded&&"true"===n.connected&&this.isFilePathAvailable(n)&&!this.showStatus()){var a=C.getMultiServerVersionRequest(),r=a.isSalesForceFilesEnabled()?_.OrgNamespace+"__SM_ContentVersion_ID__c":_.OrgNamespace+"__SM_Attachment_ID__c";this.__syncManager.downloadAttachmentOnDemand(n[r])}else if(n&&this.isFilePathAvailable(n)&&this.showStatus()&&"waiting"===n.status){var o=_.OrgNamespace+"__SM_Attachment_ID__c";this.__syncManager.cancelAttachmentDownloadOnDemand(n[o]),n.status="",this.showStatusOnImage()}},isFilePathAvailable:function(e){var t=!1;return e&&e.file_path&&e.file_path.length>0&&(t=!0),t},onCompletionAttachmentFileReader:function(e){var t=this;if(e&&e.file_path&&e.file_path.length>0){var n=e.file_path.replace(/''/g,"'");n=new y.File(n),n.info().then(_.proxy(this,function(e,i){t.openChecklistAttachment(n)}))}},openChecklistAttachment:function(e){var t=this.__deliveryEngine,n=t.getEventBus(),i=_.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_ATTACHMENT",this,{request:{deliveryEngine:t,file:e}});n.triggerEvent(i)},showImageVideoThumbnail:function(e,t){if(t){var n=e.substring(e.lastIndexOf("."),e.length).toLowerCase(),i=this.getFileType({FileExtention:n});"video"===i?(this.setImageVideoThumbnail(!0,!1),this.videoThumbnail.setUrl(e),this.videoThumbnail.setCls("sfm-checklist-attachment-thumb"),this.videoThumbnail.el.dom.setAttribute("extension",n.replace(".",""))):"image"===i&&".tif"!==n?(this.imageThumbnail.setCls(""),this.imageThumbnail.setHtml(""),this.setImageVideoThumbnail(!1,!0),this.getCanvasThumbnailImage(e)):(this.setImageVideoThumbnail(!1,!0),this.imageThumbnail.setSrc(e),n.length>0&&(this.imageThumbnail.setCls("sfm-attachment-thumb"),this.imageThumbnail.setStyle({backgroundSize:0}),this.imageThumbnail.el.dom.setAttribute("extension",n.replace(".",""))))}else{var a=this.getStatusCls();this.imageThumbnail.setCls(a),this.showStatus()?this.imageThumbnail.setHtml(e):this.imageThumbnail.setHtml(""),this.setImageVideoThumbnail(!1,!0)}},getStatusCls:function(){var e=this.__record.AttachmentData,t="";return this.isFilePathAvailable(e)&&(this.showStatus()?(t+="sfm-attachment-text",e.connected&&"false"!==e.connected||(t+=" sfm-attachment-icon-inactive")):(t="sfm-attachment-cloud-icon","error"===e.status&&(t="sfm-attachment-cloud-error-icon"),"false"===e.connected&&(t+=" sfm-attachment-cloud-disabled"))),t},showStatus:function(){var e=this.__record.AttachmentData,t=!1;return this.isFilePathAvailable(e)&&"true"==e.connected&&(this.__syncManager.__attachmentInProgress&&!e.downloaded&&"error"!==e.status?t=!0:e.downloaded||"error"===e.status||""===e.status||(t=!0)),t},getCanvasThumbnailImage:function(e){var t=this;t.canvas=document.createElement("canvas"),t.canvas.width=64,t.canvas.height=64;var n=t.canvas.getContext("2d"),i=new Image;i.onload=function(){n.drawImage(i,0,0,64,64),t.imageThumbnail.setSrc(t.canvas.toDataURL("image/jpeg",.5)),t.imageThumbnail.setStyle({backgroundSize:"64px 64px"}),i.src="",delete t.canvas},i.src=b.getEncodedFileName(e)},setImageVideoThumbnail:function(e,t){this.imageThumbnail.setHidden(e),this.videoThumbnail.setHidden(t)},setAttachmentValue:function(e){this.populateExtraFields(e)},populateExtraFields:function(e){var t=this,n=this;if(e){var i=_.OrgNamespace+"__SM_Attachment_ID__c";e.status=this.__syncService.downloadAttachmentOnDemandStatus(e[i]),n.__record.AttachmentData=e,this.__attachmentUtils.checkConnectivity().done(_.proxy(this,function(i){n.__lastConnected=i,e.connected=i?"true":"false",n.getAttachmentRealPath(e),n.isFilePathAvailable(e)&&!n.__connectionTimer&&(n.__connectionTimer=setInterval(_.proxy(t,t.__checkConnection),5e3))}))}else n.getAttachmentRealPath(e)},__checkConnection:function(){var e=this,t=this.__record&&this.__record.AttachmentData||{};t.downloaded?this.__connectionTimer&&(clearInterval(this.__connectionTimer),this.__connectionTimer=null):this.__attachmentUtils.checkConnectivity().done(_.proxy(this,function(n){n!=e.__lastConnected&&(e.__lastConnected=n,t.connected=n?"true":"false","false"===t.connected&&(e.__syncManager.clearAttachmentDownload(),t.status=""),e.showStatusOnImage())}))},getAttachmentRealPath:function(e){var t=this;if(this.isFilePathAvailable(e)){e.hasOwnProperty("isDeleted")||(e.isDeleted=!1),t.__record.AttachmentData=e;var n=t.__record.AttachmentData.file_path;if(new y.File(n).info().then(_.proxy(this,function(e,n){var i=n.filePath||FILEIO.__convertBaseDirectory(inResponse.fileDataToStore.file.__path);t.__record.AttachmentData.downloaded=!0,t.__record.AttachmentData.realPath=i,t.showStatusOnImage()}),_.proxy(this,function(e){t.__record.AttachmentData.downloaded=!1,t.showStatusOnImage()})),n){this.attachmentDescriptionPanel.setHidden(!1);this.query("#checklistAttachLabel")[0].setHtml(D().T("FSA002_TAG029","Attach New"))}else{this.attachmentDescriptionPanel.setHidden(!0);this.query("#checklistAttachLabel")[0].setHtml(D().T("FSA002_TAG028","Attach"))}}},showStatusOnImage:function(){var e=this.__record.AttachmentData;if(e.downloaded)this.showImageVideoThumbnail(e.realPath,!0);else{var t=this.getStatusText(e);this.showImageVideoThumbnail(t,!1)}},getStatusText:function(e){var t="";if(this.isFilePathAvailable(e)){var n=D().T("FSA008_TAG067","Waiting..."),i=D().T("FSA008_TAG069","Error"),a=D().T("FSA008_TAG044","Downloading..."),r=D().T("FSA016_TAG004","Cancel"),o=e.status,s=e.connected;e.downloaded;o&&"true"==s?"waiting"===o?t=n+r:"downloading"===o?t=a:"error"===o&&(t=i):"true"===s&&this.__syncManager.__attachmentInProgress&&(t=a)}return t},getAttachmentValue:function(){return this.__record.AttachmentData},setValueHandler:function(e){if(e){var t=e;this.attachmentDescription.setValue(t)}},getValueHandler:function(){return this.attachmentDescription.getValue()||""},isValid:function(){var e={},t=this.getAttachmentValue(),n=this.__fieldInfo&&this.__fieldInfo.__fieldInfo&&this.__fieldInfo.__fieldInfo.question;if(this.__fieldInfo.required&&(null===t||void 0===t||""===t||0===(0,r.default)(t).length||t.isDeleted?e.isRequired=!0:e.isRequired=!1),this.__fieldInfo.isDescriptionRequired||n.descriptionRequired||n.DescriptionRequired){var i=this.getValueHandler();(0,r.default)(t).length>0&&t.hasOwnProperty("isDeleted")&&!t.isDeleted&&(null===i||void 0===i||""===i||0===i.length)?(this.attachmentDescription.setRequired(!0),e.isRequired=!0):this.attachmentDescription.setRequired(!1)}return e},resetAttachmentValue:function(){this.__record.AttachmentData={},this.__fieldInfo.isDescriptionRequired=!1,this.imageThumbnail.setSrc(""),this.imageThumbnail.setCls(""),this.videoThumbnail.setUrl(""),this.setImageVideoThumbnail(!1,!0),this.attachmentDescription.setValue(""),this.attachmentDescriptionPanel.setHidden(!0),this.query("#checklistAttachLabel")[0].setHtml(D().T("FSA002_TAG028","Attach"))}}),_.defineGlobal(I.name,I),e.exports=I},function(e,t,n){e.exports={default:n(789),__esModule:!0}},function(e,t,n){n(790),e.exports=n(28).Number.isFinite},function(e,t,n){var i=n(34),a=n(48).isFinite;i(i.S,"Number",{isFinite:function(e){return"number"==typeof e&&a(e)}})},function(e,t,n){var i=n(0).utils,a=n(12).DatetimeUtil,r={name:"com.servicemax.client.sfmdelivery.ui.largemodern.checklisthomeview"},o=i.getLoggingService().getLogger("sfmdelivery.ui.checklisthomeview"),s=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};Ext.define(r.name+".CheckListHomeView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.checklisthomeview",__selected:null,__additionalInfo:null,__isCreate:null,__modelName:null,__data:null,__store:null,__list:null,config:{pageModel:null,dataModel:null,halign:"full",cls:["sfm-process-edit"]},height:"100%",layout:"fit",onShow:function(){this.__selected=!1,o.info("CheckList Home View showing"),this.getDeliveryEngine().blockSyncPopUp()},onHide:function(){o.info("CheckList Home View hiding"),this.getDeliveryEngine().allowSyncPopUp()},doDestroy:function(){this.__syncManager.unbind("SYNC_PROGRESS",this.__onSyncProgress,this),this.__syncManager.unbind("SYNC_STARTED",this.__onSyncStarted,this),this.toastTimeout&&clearTimeout(this.toastTimeout),this.callParent()},getLeftButton:function(){var e=this.__backButtonText;return e||(e=s().T("FSA016_TAG015","Back")),{xtype:"svmx.button",html:"< "+e,handler:i.proxy(this,"cancel"),ui:"svmx-toolbar-btn svmx-cancel-btn",itemId:"cancelButton"}},getRightButton:function(e){var t=this;return{xtype:"svmx.button",html:s().T("FSA002_TAG001","Show Completed"),ui:"svmx-button-square svmx-save-btn",cls:"sfm-checklist-completed-btn",itemId:"saveButton",disabled:e,listeners:{tap:{fn:function(e,n){t.__showCompleted()},scope:t,buffer:500}}}},updateOptions:function(e){this.__backButtonText=e.SVMX_backButtonText,e&&e.additionalInfo?(this.__additionalInfo=e.additionalInfo,this.__isCreate=e.additionalInfo):(this.__additionalInfo=null,this.__isCreate=null);var t=i.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=t.getInstance(),this.bind(i.getCurrentApplication().getSyncImpl(),"SYNC_COMPLETED_IMPL",this.__onSyncCompleted,this),this.__syncManager.bind("SYNC_PROGRESS",this.__onSyncProgress,this),this.__syncManager.bind("SYNC_STARTED",this.__onSyncStarted,this)},__onSyncProgress:function(e){!this._remoteMappedRecords&&e.target&&e.target.__syncEventCol&&(this._remoteMappedRecords=e.target.__syncEventCol.getState("MAP_REMOTE_IDS"))},__onSyncStarted:function(e){this._remoteMappedRecords=null},ready:function(){this.__isReady=!0,this.__selected=!1;var e=this.getDeliveryEngine().getMetaModel();this.setPageModel(e),e.getDataModel().createBinding("LIST_SECTION_FIELD_ID",i.proxy(this,"setCheckListList"),null,null);var t=e.getData().page.header.headerLayout[i.OrgNamespace+"__Object_Name__c"];this.getDeliveryEngine().getMetaModel().getObjectLabel(t);this.setViewInfo({windowTitle:s().T("FSA002_TAG002","Checklists"),subTitle:null,backText:s().T("FSA002_TAG002","Checklists"),leftHeader:this.getLeftButton(),rightHeader:this.getRightButton(!0),disableNavMenu:!0,hideBackButton:!0,hideContextMenu:!0}),this.__modelName="svmx.sfmchecklistdelivery.list.result.model",Ext.ClassManager.classes[this.__modelName]||Ext.define(this.__modelName,{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"processName"},{name:"processId"},{name:"description"},{name:"sfProcessId"},{name:"recordId"},{name:"statusLabel"},{name:"status"},{name:"compleationDate"},{name:"targetId"},{name:"allowNew"},{name:"actionLabel"},{name:"completedCount"},{name:"internalLabel"}]}),this.__store=Ext.widget("svmx.store",{model:this.__modelName,data:this.__data,autoDestroy:!0});var n=[{itemId:"list",xtype:"svmx.list",itemCls:"checklist-list-view-item",store:this.__store,itemTpl:this.__getItemTpl(),emptyText:s().T("FSA002_TAG003","No Checklist Process available."),listeners:{itemtap:i.proxy(this,"__onCheckListProcessSelect")}}];this.add(n),this.__list=this.query("#list")[0]},__onSyncCompleted:function(e){var t=e.data.syncType,n={isSuccess:!0};"checklistedit"!==i.getCurrentApplication().getCurrentView().getViewConfig()&&"edit"!=i.getCurrentApplication().getCurrentView().getViewConfig()&&("DATA"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t&&"ONECALLSYNC"!=t||(this.__onRefreshFromServerComplete(n),this.toastTimeout=setTimeout(function(){i.Msg.toast({text:s().T("FSA002_TAG004","Refreshing View")})},2e3)))},__onRefreshFromServerComplete:function(e){if(e.isSuccess)this.getDeliveryEngine().notifyDataChange({recordId:this.getOption("SVMX_recordId")});else{var t=e.error.error||e.error||s().T("FSA002_TAG005","Unknown error. ");i.Msg.toast({text:t})}this.unblockApplication()},__getItemTpl:function(){var e=s().T("FSA008_TAG118","Completed");return new Ext.XTemplate('<div class="checklist-lineup-list-item-name">{processName}</div>','<div class="checklist-lineup-list-item-description">{description}</div>','<tpl if="this.getCompletedCount(completedCount, status)">','<div class="checklist-lineup-list-item-completedcount">{completedCount}&nbsp;'+e+"</div>","</tpl>",'<tpl if="this.getActionLabel(internalLabel)">','<a id="actionId" class="checklist-lineup-list-item-actionlable" href="javascript:void(0);">{actionLabel}</a>',"</tpl>",'<tpl if="this.getStatusLabel(status)">','<div class="checklist-lineup-list-item-statuslabel">{statusLabel}</div>',"</tpl>",{getCompletedCount:function(e,t){return result=!1,e>0&&"In Process"!==t&&(result=!0),result},getActionLabel:function(e){var t=!1;return void 0!==e&&"Start New"===e&&(t=!0),t},getStatusLabel:function(e){var t=!1;return"Completed"!==e&&(t=!0),t}})},__createFormattedDataForCheckList:function(e){this.__allChecklists=[],this.__processIdChecklistRecord={},this.__uniqueCheckListProcessId=[],this.__processIdCompletedCheckListRecord={},this.__isRightbuttonDisabled=!0;var t=[];if(e.length>0){this.__allChecklists=e;var n=0,r=this.__allChecklists.length,o=[];for(n=0;n<r;n++)e[n].completionDate=a.getFormattedDatetime(a.convertToTimezone(e[n].completionDate)),o.push(e[n].sfProcessId);this.__uniqueCheckListProcessId=Ext.Array.unique(o);var l=0,c=this.__uniqueCheckListProcessId.length;for(l=0;l<c;l++)this.__processIdChecklistRecord[this.__uniqueCheckListProcessId[l]]=[],this.__processIdCompletedCheckListRecord[this.__uniqueCheckListProcessId[l]]=[];var u=0,d=this.__allChecklists.length;for(u=0;u<d;u++){var _=this.__allChecklists[u],h=this.__processIdChecklistRecord[_.sfProcessId];h.push(_),this.__processIdChecklistRecord[_.sfProcessId]=h}for(var n=0,r=this.__uniqueCheckListProcessId.length,n=0;n<r;n++){for(var f=this.__uniqueCheckListProcessId[n],p=0,m=null,h=this.__processIdChecklistRecord[f],c=h.length,l=0;l<c;l++)"Completed"===h[l].status?(this.__isRightbuttonDisabled=!1,p++,this.__processIdCompletedCheckListRecord[f].push(h[l])):m=h[l];m||(m=h[c-1]),m.completedCount=p,t.push(m)}}this.setViewInfo({windowTitle:s().T("FSA002_TAG002","Checklists"),subTitle:null,backText:s().T("FSA002_TAG002","Checklists"),leftHeader:this.getLeftButton(),rightHeader:this.getRightButton(this.__isRightbuttonDisabled),disableNavMenu:!0,hideBackButton:!0,hideContextMenu:!0});var v={SVMX_processIdCompletedCheckListRecord:this.__processIdCompletedCheckListRecord,SVMX_backButtonText:s().T("FSA002_TAG002","Checklists"),SVMX_uniqueCheckListProcessId:this.__uniqueCheckListProcessId},g=i.create("com.servicemax.client.lib.api.Event","CHECKLISTDATA_LOADED",this,v);return this.getDeliveryEngine().getEventBus().triggerEvent(g),t},setCheckListList:function(e){this.__data=[],this.__data=this.__createFormattedDataForCheckList(e),i.sort(this.__data,"processName"),this.__store.setData(this.__data)},__onCheckListProcessSelect:function(e,t,n,i,a,r){"checklist-lineup-list-item-actionlable"===a.target.className?this.__launchChecklistInstance(i.raw,"NEW"):this.__launchChecklistInstanceInternal(i.raw)},__launchChecklistInstanceInternal:function(e){var t=[];"Completed"===e.status?(t=this.__processIdCompletedCheckListRecord[e.sfProcessId],t.length>1?this.__getCompletedChecklistPicker(t):this.__launchChecklistInstance(e,"VIEW")):"Qualified"===e.status?this.__launchChecklistInstance(e,"NEW"):this.__launchChecklistInstance(e)},__launchChecklistInstance:function(e,t){var n={},a={},r=e.targetId,o=void 0;"NEW"===t&&(r=null),"VIEW"===t&&(o=t),n={sfwActionType:"CHECKLIST",targetId:r,sfProcessId:e.sfProcessId,qualify:!1,specialProcessType:o,sourceRecord:this._deliveryEngine.additionalInfo.parent,checklistStatus:t},this.updateSFID(),a={additionalInfo:n,SVMX_recordId:e.recordId,SVMX_processId:e.processId},i.getCurrentApplication().getCurrentView().changeConsoleApp({app:"sfmdelivery",view:"checklistedit",options:a})},updateSFID:function(){var e=this._deliveryEngine.recordId;if(e.indexOf("local")>-1&&this._remoteMappedRecords){var t=this._remoteMappedRecords[e];t&&(this._deliveryEngine.recordId=t)}},__getCompletedChecklistPicker:function(e){var t=i.string.substitute(s().T("FSA002_TAG023","There are {{completedCount}} copies of {{processName}}. Select one to view."),{completedCount:e.length,processName:e[0].processName}),n=this.__getCompletedDateList(e);n.unshift({xtype:"svmx.label",text:t,cls:"checklist-processName-lable"}),n.push({xtype:"svmx.button",text:s().T("FSA016_TAG004","Cancel"),cls:"checklist-completedDate-item-cancelbtn",handler:i.proxy(this,this.__closeCompletedChecklistDialog)}),this.__completedChecklistPicker=Ext.create({xtype:"svmx.sheet",modal:!0,scrollable:!0,hideOnMaskTap:!0,width:"40%",height:"40%",items:n}),this.__completedChecklistPicker.show()},__closeCompletedChecklistDialog:function(){this.__completedChecklistPicker&&this.__completedChecklistPicker.destroy()},__getCompletedDateList:function(e){e.sort(function(e,t){return a.getDurationBetween(e.completionDate,t.completionDate).asMilliseconds()});var t=[],n=this;return e.forEach(function(e,a,r){var o="checklist-completedDate-item";a==r.length-1&&(o+=" checklist-completedDate-item-last");var s=Ext.create({xtype:"svmx.button",text:e.completionDate,cls:o,handler:i.proxy(n,n.__onCompletedDateTap,e)});t.push(s)}),t},__onCompletedDateTap:function(e){this.__launchChecklistInstance(e,"VIEW"),this.__closeCompletedChecklistDialog()},cancel:function(){this.done();var e=this._options&&this._options.parent&&this._options.parent.__page,t=e&&e.getDeliveryEngine();t&&t.notifyDataChange({recordId:t.getRecordId()})},__showCompleted:function(e){this.changeView({view:"completedchecklistview",options:{SVMX_processIdCompletedCheckListRecord:this.__processIdCompletedCheckListRecord,SVMX_backButtonText:s().T("FSA002_TAG002","Checklists"),SVMX_uniqueCheckListProcessId:this.__uniqueCheckListProcessId}})}});i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.sfmdelivery.ui.largemodern.completedchecklistview"},r=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},o=i.getLoggingService().getLogger("sfmdelivery.ui.checklisthomeview");Ext.define(a.name+".CompletedCheckListView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.completedchecklistview",__selected:null,__additionalInfo:null,__isCreate:null,__modelName:null,__data:null,__store:null,__list:null,showAnimation:{type:"popIn",duration:250,easing:"ease-out"},config:{pageModel:null,dataModel:null,halign:"full",cls:["sfm-process-edit"]},height:"100%",layout:"fit",__saveButton:null,__cancelButton:null,onShow:function(){this.__selected=!1,o.info("Completed Checklist View showing"),this.getDeliveryEngine().blockSyncPopUp()},onHide:function(){o.info("Completed Checklist View hiding"),this.getDeliveryEngine().allowSyncPopUp()},getLeftButton:function(){return{xtype:"svmx.button",html:"< "+this.__backButtonText,handler:i.proxy(this,"cancel"),ui:"svmx-toolbar-btn svmx-cancel-btn",itemId:"cancelButton"}},updateOptions:function(e){this.__backButtonText=e.SVMX_backButtonText,this.__processIdCompletedCheckListRecord=e.SVMX_processIdCompletedCheckListRecord,this.__uniqueCheckListProcessId=e.SVMX_uniqueCheckListProcessId;var t=this.getDeliveryEngine().getEventBus();this.bind(t,"CHECKLISTDATA_LOADED",this.onCheckListDataUpdated,this)},onCheckListDataUpdated:function(e){this.updateOptions(e.data),this.__refreshView()},ready:function(){that=this,this.__isReady=!0,this.__selected=!1;var e=this.getDeliveryEngine().getMetaModel();this.setPageModel(e);var t,n=e.getData().page.header.headerLayout[i.OrgNamespace+"__Object_Name__c"];this.getDeliveryEngine().getMetaModel().getObjectLabel(n);this.setViewInfo({windowTitle:r().T("FSA002_TAG017","Completed Checklists"),subTitle:null,backText:null,leftHeader:this.getLeftButton(),disableNavMenu:!0,hideBackButton:!0,hideContextMenu:!0}),this.__modelName="svmx.sfmchecklistdelivery.completed.list.result.model",Ext.ClassManager.classes[this.__modelName]||Ext.define(this.__modelName,{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"processName"},{name:"processId"},{name:"description"},{name:"sfProcessId"},{name:"recordId"},{name:"statusLabel"},{name:"status"},{name:"compleationDate"},{name:"targetId"},{name:"allowNew"},{name:"actionLabel"},{name:"completedCount"}]}),this.__createStore();var t=[{itemId:"list",xtype:"svmx.list",itemCls:"checklist-list-view-item",store:this.store,itemTpl:this.__getItemTpl(),emptyText:r().T("FSA002_TAG003","No Checklist Process available."),listeners:{itemtap:i.proxy(this,"__onCheckListProcessSelect")}}];this.add(t),this.__list=this.query("#list")[0]},__createStore:function(){if(this.__uniqueCheckListProcessId){var e=void 0,t=this.__uniqueCheckListProcessId.length,n=[];for(e=0;e<t;e++){var i=[];if(i=this.__processIdCompletedCheckListRecord[this.__uniqueCheckListProcessId[e]],i.length>0){var a,r=i.length;for(a=0;a<r;a++)n.push(i[a])}}}this.store=this.store||Ext.widget("svmx.store",{model:this.__modelName,autoDestroy:!0}),this.store.setData(n),this.store.sort("completionDate","DESC")},__refreshView:function(){this.__createStore()},__getItemTpl:function(){return new Ext.XTemplate('<div class="checklist-lineup-list-item-name">{processName}</div>','<div class="checklist-lineup-list-item-description">{description}</div>','<div class="checklist-lineup-list-item-completionDate">{completionDate}</div>')},__onCheckListProcessSelect:function(e,t,n,a,r,o){var s={},l={};s={sfwActionType:"CHECKLIST",targetId:a.raw.targetId,sfProcessId:a.raw.sfProcessId,qualify:!1,specialProcessType:"VIEW"},l={additionalInfo:s,SVMX_recordId:a.raw.recordId,SVMX_processId:a.raw.processId},i.getCurrentApplication().getCurrentView().changeConsoleApp({app:"sfmdelivery",view:"checklistedit",options:l})},cancel:function(){this.done()}});i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10),o=n(0).utils,s=(n(12).DatetimeUtil,n(24).navigation,n(24).data,n(102).Facade),l=n(7).MetaData,c=n(89).ConnectionUtil,u=n(104).SVMXModel,d={name:"com.servicemax.client.sfmdelivery.ui.largemodern.homeview"},_=function(){return o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},h=o.getLoggingService().getLogger("sfmdelivery.ui.homeview");Ext.define(d.name+".HomeView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.homeview",config:{pageModel:null,dataModel:null,sfw:null,cls:["sfm-process-view"]},extensionCards:null,__isProcessSelected:null,getViewLoadMask:function(){return{xtype:"svmx.loadmask",transparent:!1,indicator:!1,message:"",cls:"loadmask-sfmdelivery-animation",html:'<script><\/script><style>.timeline-wrapper {width: 100%;display: table;position:absolute;}.timeline-wrapper-row {width: 100%;display: table-row;padding: 12px;position:relative;}.timeline-item-left {display: table-cell;position: absolute;left: 0px;background: #fff;border-radius: 3px;margin: 0 auto;width: 20%;}.timeline-item-right {display: table-cell;position: absolute;right: 0px;background: #fff;border-radius: 3px;margin: 0 auto;width: 80%;}@keyframes placeHolderShimmer{0% {background-position: -468px 0}100% {background-position: 468px 0}}.animated-background-left-topics {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function:linear;background: #f6f7f8;background: linear-gradient(to right, #cccccc 8%, #aaaaaa 18%, #cccccc 33%);background-size: 800px 104px;height: 15px;position: relative;width: 120px;margin-left: 5px;}.animated-background-right-panel-topics {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function:linear;background: #f6f7f8;background: linear-gradient(to right, #cccccc 8%, #aaaaaa 18%, #cccccc 33%);background-size: 800px 104px;height: 20px;position: relative;width: 150px;margin-left: 5px;}.animated-background-right-field-label {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function:linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 10px;position: relative;width: 90px;margin-left: 5px;}.animated-background-right-field-value {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 10px;position: relative;width: 210px;margin-left: 5px;}.background-masker-left-panel-labels {background:#fff;height: 31px;position:relative;}.background-masker-left-panel-top-padding {background:#fff;position:relative;left: 0px;height: 16px;}.background-masker-left-panel-remaining {background:#fff;position:relative;height: 2000px;}.background-masker-right-panel-field {background:#fff;height: 9px;position:relative;}.background-masker-right-panel-field-label-value {background:#fff;height: 4px;position:relative;}.panel-header {background-color: #f4f1f0;background-image: none;color: #333;border: 0 solid #005cb9;height: 39px;}.background-masker-right-panel-annimation {height: 10px;background-color: #f4f1f0;position:relative;}.hr {border:0;border-top: 1px solid #b0b0b0;height: 0;background: #b0b0b0;}.field-label {height:22px;}.field-component {background: #fff;height: 50px;width: 100%;display: table;}.field-component-row {width: 100%;height: 50%;display: table-row;}.field-component-cell-left {width: 50%;display: table-cell;}.field-component-cell-right {display: table-cell;width: 50%;}</style><div class="timeline-wrapper"><div class="timeline-wrapper-row"><div class="timeline-item-left"><div class="background-masker-left-panel-top-padding"></div><div class="animated-background-left-topics"></div><div class="background-masker-left-panel-labels"></div><div class="animated-background-left-topics"></div><div class="background-masker-left-panel-labels"></div><div class="animated-background-left-topics"></div><div class="background-masker-left-panel-labels"></div><div class="animated-background-left-topics"></div><div class="background-masker-left-panel-labels"></div><div class="animated-background-left-topics"></div><div class="background-masker-left-panel-labels"></div><div class="animated-background-left-topics"></div><div class="background-masker-left-panel-remaining">&nbsp;</div></div><div class="timeline-item-right"><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="background-masker-right-panel-field"></div></div></div></div>'}},updateOptions:function(e){this.__isProcessSelected=!1;var t=this.getDeliveryEngine().getEventBus();this.bind(t,"DATA_LOADED",this.onDataUpdated,this),this.bind(t,"SFMDELIVERY.CHANGE_APP_STATE",this.changeApplicationState,this),this.blockApplication(this.getViewLoadMask()),this.__productIQObject=this.__createProductIQObject(),this.__mobileInventoryObject=this.__createMobileInventoryObject(),this.setViewInfo({windowTitle:"...",subTitle:"",backText:_().T("FSA016_TAG015","Back"),disableActionMenu:!0,menuItems:[{xtype:"svmx.verticalpanel",width:Math.floor(.8*Ext.Viewport.element.getWidth()),height:"100%"}]});var n="vertical";"laptop"==o.getClient().getApplicationParameter("client-type").toLowerCase()&&(n="both");var i=[{xtype:"svmx.horizontalpanel",halign:"full",width:"100%",items:[{itemId:"tabbar",xtype:"svmx.buttonset",pressedIndices:[0],hidden:!0,flex:1,items:[{text:_().T("FSA008_TAG089","Details"),flex:1,ui:"svmx-segmented-button",handler:o.proxy(this,"__doSelectCardForButton","details-button"),itemId:"details-button"}],listeners:{selected:o.proxy(this,"tabButtonSelected")}}]},{itemId:"cards",xtype:"svmx.cards",items:[{itemId:"details-card",xtype:"svmx.card",items:[{xtype:"sfm.delivery.sections",itemId:"deliverySections",cls:"sfm-delivery-sections",view:this,readOnly:!0,contentScrollable:n}]}]}];this.add(i),this.__detailsCard=this.query("#details-card")[0],this.__deliverySections=this.query("#deliverySections")[0],this.__tabBar=this.query("#tabbar")[0],this.__cards=this.query("#cards")[0];var a=o.create("com.servicemax.client.sfwdelivery.engine.DeliveryEngineImpl",{});this.bind(a.getEventBus(),"SFW_DATA_LOADED",this.sfwDataLoaded,this),this.setSfw(a);var r=o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=r.getInstance(),this.bind(this.__syncManager,"SYNC_STOPPED",this.__onSyncStop,this),this.bind(o.getCurrentApplication().getSyncImpl(),"SYNC_COMPLETED_IMPL",this.__onSyncCompleted,this),this.bind(this.__syncManager,"SYNC_PROGRESS",this.__onSyncProgress,this),Ext.Viewport.onAfter("orientationchange","changeScrollProperty",this)},__onSyncCompleted:function(e){var t=e.data.syncType,n={isSuccess:!0};"edit"!=o.getCurrentApplication().getCurrentView().getViewConfig()&&"checklistedit"!==o.getCurrentApplication().getCurrentView().getViewConfig()&&("DATA"!=t&&"AGGRESSIVE"!=t&&"TARGETEDSYNC"!=t&&"ONECALLSYNC"!=t||(this.__onRefreshFromServerComplete(n),setTimeout(function(){o.Msg.toast({text:_().T("FSA002_TAG004","Refreshing View")})},2e3)))},__onSyncProgress:function(e){!this._remoteMappedRecords&&e.target&&e.target.__syncEventCol&&(this._remoteMappedRecords=e.target.__syncEventCol.getState("MAP_REMOTE_IDS"))},__onSyncStarted:function(e){this._remoteMappedRecords=null},__onSyncStop:function(e){var t=this;t.evt=e;this.getDeliveryEngine().getTargetData().getData().getRawData().sfmData.getNameValue(),this.getObjectLabel();"SYNC_STOPPED"==e.type&&setTimeout(function(){!t.evt.data||"AGGRESSIVE"!=t.evt.data.syncType&&"TARGETEDSYNC"!=t.evt.data.syncType||(t.evt.data.checkSyncFlag=!0,t.onDataUpdated(t.evt))},1e3)},changeApplicationState:function(e){var t=null;"string"!=typeof e&&(t=e,e=t.newState,t.target,t.additionalInfo),"block"==e?this.blockApplication():this.unblockApplication()},getRecord:function(){return this.getDataModel().__data.__data.sfmData},sfwRunner:function(){this.getSfw().run({translation:"",onReady:{context:this,handler:this.sfwReady}})},sfwReady:function(){this.__isSfwReady=!0,this.loadSFWData()},loadSFWData:function(){if(this.__isSfwReady&&this.__isReady&&!this.__isWizardLoaded){this.__isWizardLoaded=!0;var e=this.getOption("SVMX_recordId"),t=this.getPageModel().getChildNode("header").objectName;this.getSfw().update(e,t)}},sfwDataLoaded:function(e){var t=e.data;this.getDeliveryEngine().loadViewProcesses(this.getDataModel().__data.__data.sfmData,o.proxy(this,"__processMenuItems",t),!0)},__processMenuItems:function(e,t){var n=this,i=n.isRecordDownloadedOnDemand(),a=n.__mobileInventoryObject.isLocatePartEnabled();i.then(function(i){a.then(function(a){var r=o.array.map(e.getWizards(),function(e){var t=o.array.map(e.getActions(),function(e){var t="app-to-app"==e.customActionType.toLowerCase();return"OTHERS"!=e.actionType||t?{xtype:"svmx.button",ui:"svmx-menu-button",html:e.getName(),handler:o.proxy(n,"wizardClicked",e),disabled:!e.enabled}:{xtype:"svmx.button",ui:"svmx-menu-button",html:e.getName(),cls:"x-iconalign-right",iconCls:"icon-online-sfm",handler:o.proxy(n,"wizardClicked",e),disabled:!e.enabled}},n);return t.length&&t.unshift({xtype:"svmx.label",cls:"svmx-wizard-label",html:e.getName(),docked:"top"}),{xtype:"svmx.verticalpanel",halign:"full",items:t}},n);if(r.length>0&&i){var c=[],u={xtype:"svmx.label",cls:"svmx-wizard-label",html:_().T("FSA008_TAG001","Refresh from Salesforce"),docked:"top"};c.push(u);var d={xtype:"svmx.button",ui:"svmx-menu-button",html:_().T("FSA008_TAG001","Refresh from Salesforce"),handler:o.proxy(n,"wizardClicked",{actionType:"REFRESH_PROM_SERVER"}),disabled:!1};c.push(d);var h={xtype:"svmx.verticalpanel",halign:"full",items:c};r.unshift(h)}var f=n.getRecord(),p=n.__productIQObject.shouldEnableOpenTreeViewForSelectedObject(f),m=s,v=m.getVersionClass();if(n.__productIQObject&&n.__productIQObject.isProductIQEnabled()&&p&&v.isProductIQEnabled()){var g=[],y=null;if(y=n.__productIQObject.getProductIQActionWizardData(f,n)){var S={xtype:"svmx.label",cls:"svmx-wizard-label",html:_().T("FSA008_TAG090","ProductIQ"),docked:"top"};g.push(S);var E={xtype:"svmx.button",ui:"svmx-menu-button",html:_().T("FSA008_TAG091","Open tree view"),handler:o.proxy(n,"wizardClicked",y),disabled:!1};g.push(E);var b={xtype:"svmx.verticalpanel",halign:"full",items:g};r.unshift(b)}}if(t.length>1){var T=o.array.map(t,function(e){var t={xtype:"svmx.button",ui:"svmx-menu-button",html:e.process_name,handler:o.proxy(n,function(){l.setDefaultView({objectName:this.getPageModel().getChildNode("header").objectName,defaultProcess:e.process_unique_id}).then(o.proxy(n,function(){var t={SVMX_processId:e.process_unique_id,SVMX_recordId:this.getRecord().Id,SVMX_record:this.getRecord()};o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.statemanager").replaceState({app:"sfmdelivery",options:t})}))})};return e.isCurrentView&&(t.cls="sfm-delivery-current-menu-item"),t},n);T.length&&T.unshift({xtype:"svmx.label",cls:"svmx-wizard-label",html:_().T("FSA008_TAG002","Views"),docked:"top"}),r.push({xtype:"svmx.verticalpanel",halign:"full",items:T})}if(r.length>0){if(e.record&&e.record._fields&&e.record._fields.tableName){var M=e.record,I="",C=o.OrgNamespace;if(M){var A=M._fields.tableName,D=o.OrgNamespace,x=D+"__Service_Order__c",R=!!(A&&A.indexOf(x)>=0),O=!(!M[C+"__Product__c"]||!M[C+"__Product__c"].fieldvalue);if(R){var L=[];if(a){var k={xtype:"svmx.button",ui:"svmx-menu-button",html:"Locate Part",cls:"x-iconalign-right",iconCls:"icon-online-sfm",itemId:"locatePartWizardStep",handler:o.proxy(n,"wizardClicked",{actionType:"LOCATE_PART"})};L.push(k)}if(O&&n.isTroubleShootingEnabled()&&(I=M[C+"__Product__c"].fieldvalue.key,M[C+"__Product__c"].fieldvalue.value,I&&A&&A.indexOf(x)>=0)){var N={xtype:"svmx.button",ui:"svmx-menu-button",html:_().T("FSA008_TAG005","Troubleshooting"),handler:o.proxy(n,"wizardClicked",{actionType:"TROUBLE_SHOOTING"}),disabled:!1};L.push(N)}if(L.length>0){var w={xtype:"svmx.verticalpanel",halign:"full",items:L};r.unshift(w)}}}}r[0].items.unshift({xtype:"svmx.label",cls:"svmx-actions-menu-label",html:_().T("FSA008_TAG006","Actions"),docked:"top"})}n.setViewInfo({disableActionMenu:!1,menuItems:r,nameMenuItems:"wizards"})})})},isTroubleShootingEnabled:function(){try{return!!this.getDeliveryEngine().getMetaModel().getData().page.header.headerLayout[o.OrgNamespace+"__Enable_Troubleshooting__c"]}catch(e){return!1}},isRecordDownloadedOnDemand:function(){return this.getDeliveryEngine().isRecordDownloadedOnDemand()},wizardClicked:function(e){switch(e.actionType){case"CHECKLIST":this.__performChecklistAction(e);break;case"SFM":"Background"===e.modeOfExecution?this.__performBackgroundSFMAction(e):this.__performSFMAction(e);break;case"OUTPUT_DOCUMENT":this.__performOUTPUTDOCUMENTAction(e);break;case"TROUBLE_SHOOTING":this.launchTroubleShootingApp(e);break;case"NONSFM_NEW_EVENT":this.__performCreateNewEventAction(e);break;case"REFRESH_PROM_SERVER":this.__refreshFromServer(e);break;case"OTHERS":this.__performOthersAction(e);break;case"OPEN_TREE_VIEW":this.__performOpenTreeViewAction(e);break;case"LOCATE_PART":this.__openCatalog(e);break;default:o.getCurrentApplication().showMessage({text:_().T("FSA008_TAG092","This type of wizard is not yet supported"),buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"OK"}]})}},launchTroubleShootingApp:function(e){var t=this.getRecord(),n={SVMX_recordId:this.getOption("SVMX_recordId"),SVMX_record:t};o.getCurrentApplication().launchConsoleApp("troubleshootdelivery",n)},__performChecklistAction:function(e){this.getRecord(),e.actionType,this.getPageModel().getChildNode("header").objectName;this.__loadSFMProcess(null,"checklisthomeview",e)},__refreshFromServer:function(){this.blockApplication();var e=this.getRecord(),t=this.getPageModel().getChildNode("header").objectName,n={recordId:this.getOption("SVMX_recordId"),record:e,objectName:t};this.getDeliveryEngine().refreshFromServer(n,o.proxy(this,"__onRefreshFromServerComplete"))},__onRefreshFromServerComplete:function(e){if(e.isSuccess){if(this.refreshView(),e.refreshAttachments){var t=o.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),n=o.create("com.servicemax.client.lib.api.Event","ATTACHMENT_ON_DEMAND.RELOAD",this,{request:{}});t.triggerEvent(n)}var i=o.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),a=o.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CHANGED",this,{request:{attachmentActionName:"refreshAllAttachments"}});i.triggerEvent(a)}else{var r=e.error.error||e.error||_().T("FSA002_TAG005","Unknown error. "),s=o.toObject(e.error.error);0==(void 0!=s.error?s.error:s).length?c.checkConnectivity().then(function(e){"false"===e.toLowerCase()&&o.Msg.toast({text:_().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available.")})}):o.Msg.toast({text:r})}this.unblockApplication()},refreshView:function(){this.getDeliveryEngine().notifyDataChange({recordId:this.getOption("SVMX_recordId")})},__performCreateNewEventAction:function(e){var t=this.getRecord();this.changeConsoleApp({app:"sfmeventdelivery",view:"createevent",options:{SVMX_recordId:t.Id,SVMX_recordName:t.Name}})},__performOpenTreeViewAction:function(e){!window.cordova||"portrait-primary"!==screen.orientation&&"portrait-secondary"!==screen.orientation||o.adjustViewportToOrientation("piqviewport");for(var t=this.getRecord(),n=this.getSFID(t.Id),i=e.message.recordIds,a=0;a<i.length;a++){var r=i[a];i[a]=this.getSFID(r)}this.changeConsoleApp({app:"productIQ",view:"homeview",options:{SVMX_recordId:n,SVMX_recordName:t.Name,message:e.message,SVMX_processId:""}})},__openCatalog:function(e){var t=this;o.getCurrentApplication().showSpinner();var n=c,i=n.checkConnectivity();i.then(function(e){if("string"==typeof e&&(e="false"!=e.toLowerCase()),e)t.changeConsoleApp({app:"mobileinventorydelivery",view:"home",options:{activeTab:"catalog"}});else{var n={text:_().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."),type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};o.getCurrentApplication().showMessage(n)}}),i.always(function(){o.getCurrentApplication().hideSpinner()})},getSFID:function(e){if(4==e.indexOf("local")&&this._remoteMappedRecords){var t=this._remoteMappedRecords[e];t&&(e=t)}return e},__createProductIQObject:function(){var e=null,t=o.getClient().getDeclaration("com.servicemax.client.sfmdelivery.productiq");if(t){var n=o.getClient().getDefinitionsFor(t);if(n&&n.length>0){var i=n[0],a=i.config["class-name"];e=o.create(a,{})}}return e},__createMobileInventoryObject:function(){var e=null,t=o.getClient().getDeclaration("com.servicemax.client.sfmdelivery.mobileinventory");if(t){var n=o.getClient().getDefinitionsFor(t);if(n&&n.length>0){var i=n[0],a=i.config["class-name"];e=o.create(a,{})}}return e},__performOUTPUTDOCUMENTAction:function(e){var t=this;if(!this.__isProcessSelected){this.__isProcessSelected=!0;var n=this.getOption("SVMX_recordId"),i=e.getData().actionDef[o.OrgNamespace+"__Process__r"][o.OrgNamespace+"__ProcessID__c"],a=this.getRecord();if(!n)return o.getCurrentApplication().showMessage({text:_().T("FSA008_TAG093","You can not generate a document until this record has synced"),buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"OK"}]}),void(this.__isProcessSelected=!1);var r=l,s=(o.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance(),e.getData().actionDef[o.OrgNamespace+"__Select_Template_At_Runtime__c"]),c=e.getRoot().getDeliveryEngine();r.getProcess({salesforceProcessId:i,onSuccess:o.proxy(this,function(e){var i=e.data.data[0],r={SVMX_processId:i.process_unique_id,SVMX_recordId:n,SVMX_record:a,SVMX_selectTplAtRuntime:s,SVMX_processName:i.process_name,de:c};o.getCurrentApplication().launchConsoleApp("sfmopdocdelivery",r),setTimeout(function(){t.__isProcessSelected=!1},300,t)})})}},__performOthersAction:function(e){var t=this;o.getCurrentApplication().showSpinner();var n=o.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().performAction(e);n=n.done(o.proxy(this,function(){t.__onRefreshFromServerComplete({isSuccess:!0}),setTimeout(function(){o.Msg.toast({text:_().T("FSA002_TAG004","Refreshing View")})},2e3)})),n=n.fail(o.proxy(this,function(e){"string"==typeof e||e.buttons||(e.buttons=[{text:_().T("FSA016_TAG003","OK"),itemId:"OK"}]),o.getCurrentApplication().showMessage(e)})),n=n.always(o.proxy(this,function(){o.getCurrentApplication().hideSpinner()}))},__performSFMAction:function(e){var t=e.getData().actionDef[o.OrgNamespace+"__Process__r"][o.OrgNamespace+"__ProcessID__c"];o.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().__getRealProcessId(t,o.proxy(this,function(t){if(t)this.__loadSFMProcess(t.inProcessId,"edit",e);else{o.getCurrentApplication().getApplicationErrorHandler().notifyApplicationError({message:_().T("FSA008_TAG094","Process not found; check your configuration")})}}))},__loadSFMProcess:function(e,t,n){o.getClient().getApplicationParameter("enable-sfm-profiling-logs")&&(window.editProcessStart=performance.now());var i=this.getOption("SVMX_recordId"),a=this.getRecord(),r="",s=null;void 0!==n&&void 0!==n.actionType&&(r=n.actionType),"CHECKLIST"===n.actionType&&(s=this._deliveryEngine),this.changeConsoleApp({app:"sfmdelivery",view:t,options:{SVMX_processId:e,SVMX_recordId:i,SVMX_record:a,SVMX_action:r,SVMX_backButtonText:this.getObjectLabel(),parent:s,pageFrom:"SFMDelivery"}})},__performBackgroundSFMAction:function(e){var t=this,n=this.getOption("SVMX_recordId"),i=e.getData().actionDef[o.OrgNamespace+"__Process__r"][o.OrgNamespace+"__ProcessID__c"];o.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().__getRealProcessId(i,o.proxy(this,function(i){var a=this;if(i){o.create("com.servicemax.client.sfmdelivery.background.SFMExecutor").executeSFMInBg(i.inProcessId,n,this.getRecord()).then(function(n){o.getCurrentApplication().triggerEvent(o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_QUICK_MESSAGE",a,{request:{message:e.getName()+"  "+_().T("FSA008_TAG112","Saved Succesfully"),type:"SVMX_SUCCESS"},responder:{}})),t.refreshView()}).catch(function(t){t.message=t.message?t.message+"\n"+e.getName()+" could not be completed successfully":e.getName()+" could not be completed successfully";var n={text:_().T("FSA016_TAG003","OK"),itemId:"ok",ui:"svmx-button-square"};o.Msg.alert({text:t.message,buttons:[n]})}).always(function(){o.getCurrentApplication().hideSpinner()}),o.getCurrentApplication().showSpinner({},{xtype:"svmx.loadmask",message:"Please wait..."})}else{o.getCurrentApplication().getApplicationErrorHandler().notifyApplicationError({message:_().T("FSA008_TAG094","Process not found; check your configuration")})}}))},getObjectLabel:function(){var e=this.getDeliveryEngine().getMetaModel(),t=e.getData().page.header.headerLayout[o.OrgNamespace+"__Object_Name__c"];return this.getDeliveryEngine().getMetaModel().getObjectLabel(t)},ready:function(){this.__isReady=!0;var e=this.getDeliveryEngine().getMetaModel();this.setPageModel(e),this.__deliverySections.addCls("sfm-delivery-loading-data"),this.__deliverySections.setDeliveryEngine(this.getDeliveryEngine()),this.__deliverySections.setModel(e),this.setViewInfo({windowTitle:this.getObjectLabel()}),this.loadSFWData(),this.__extensionCards=[];var t=this.getDeliveryEngine().getExtensions("MOBILEVIEWSUMMARY");t=t.sort(function(e,t){var n=e.options&&"button-sequence"in e.options?e.options["button-sequence"]:1e4,i=t.options&&"button-sequence"in t.options?t.options["button-sequence"]:1e4;return n>i?-1:n==i?0:1}),o.array.forEach(t,function(e,t){var n=e.config,i=o.create(n["class-name"],{delivery:this.getDeliveryEngine(),itemId:"extension-card-"+t,extension:e});this.__extensionCards.push(i),this.__deliverySections.insertPanel(0,i)},this)},__updateSLAClockSection:function(){o.getClient().getApplicationParameter("enable-sla-clock")&&this.__deliverySections.addSLAClocks(this)},createSLAClockView:function(){var e=this.getDataModel().getData(),t=this.getDeliveryEngine().getMetaModel();if(e&&e.__data){var n=e.__data.pageDataSet.sobjectinfo.attributes.type;if(this.showSLAForType(n)){var i=o.getClient().getDeclaration("com.servicemax.client.sfmdelivery.slaclock");if(i){var a=o.getClient().getDefinitionsFor(i);if(a&&a.length>0){var r=a[0],s=r.config["class-name"];return o.create(s,{rootId:this.id,object_data:e,objectType:n,user_info:t.__userInfo,object_settings:this.getDeliveryEngine().getSettings()}).createSlaView()}}}}return null},showSLAForType:function(e){return e==o.OrgNamespace+"__Service_Order__c"||"Case"==e},tabButtonSelected:function(e,t){var n=e.getItemId();this.__doSelectCardForButton(n)},__doSelectCardForButton:function(e){var t=e.replace(/button/,"card");this.__doSelectCard(t)},__doSelectCard:function(e){this.query("#"+e)[0].activate()},onDataUpdated:function(e){this.__deliverySections.removeCls("sfm-delivery-loading-data");var t=e.data,n=this.getOptions(),i=n.SVMX_recordId,a=this.getDeliveryEngine().getRecordId();i&&i.indexOf("_local")>0&&a&&a.indexOf("_local")<0&&(n.SVMX_recordId=this.getDeliveryEngine().getRecordId()),e.data.checkSyncFlag||this.setDataModel(t),this.__extensionCards&&o.array.forEach(this.__extensionCards,function(e){var n=e.config.extension.config.options?e.config.extension.config.options.updater:null,i=n?e[n]:null;i&&i.call(e,t)},this),this.__updateSLAClockSection(),this.__screenHide&&(this.__dataUpdated=!0),this.updateSubtitle();var r=this.getDeliveryEngine().getTargetData().getData().getRawData().sfmData.getNameValue(),s=this.getObjectLabel(),l=this.__getSubTitle();this.__checkConflictStatus(s,r,l),this.unblockApplication(),this.__isWizardLoaded=!1,this.getSfw().initAsync({context:this,getRecord:this.getRecord,handler:this.sfwRunner}),o.getClient().getApplicationParameter("enable-sfm-profiling-logs")&&window.viewProcessStart&&(console.log("Time taken for view:"+(performance.now()-window.viewProcessStart)),delete window.viewProcessStart),this.changeScrollProperty()},changeScrollProperty:function(){if(Ext.isiOS){var e=this.query("#navcontainer")[0],t=e&&e.bodyElement.dom;t.style.setProperty("-webkit-overflow-scrolling","auto"),setTimeout(function(){t.style.setProperty("-webkit-overflow-scrolling","touch")},1e3)}},__getSubTitle:function(){var e=this.getDeliveryEngine().getPageMetaData();if(!e)return"";var t=e.getChildNode("header"),n=t._data.headerLayout,i=n[o.getCustomFieldName("SM_Title_Bar")],r=this.getDeliveryEngine().getTargetData().getData().getRawData().sfmData,s=i&&r[i]||r.getNameValue(),l=s&&("object"===(void 0===s?"undefined":(0,a.default)(s))?s.fieldvalue.value||"":s);return"string"!=typeof l&&(l=s.toString()),l},updateSubtitle:function(){var e=this.__getSubTitle();this.setViewInfo({subTitle:e})},onShow:function(){if(this.__dataUpdated&&(this.updateSubtitle(),this.refreshView()),this.__dataUpdated=!1,this.__screenHide=!1,this.getDeliveryEngine()&&this.getDeliveryEngine().getDataUpdated()){this.getDeliveryEngine().setDataUpdated(!1);var e=this.getDeliveryEngine().getEventBus(),t=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PAGEDATA",this,{request:{recordId:this.getDeliveryEngine().recordId,processId:this.getDeliveryEngine().processId,qualify:!0,objectNameMap:this.getDeliveryEngine().getObjectNameMap(),requesterId:this.getDeliveryEngine().getRootContainerId(),layout:this.getDeliveryEngine().__page.getData()},responder:o.create("com.servicemax.client.sfmdelivery.responders.GetPageDataResponder",this.getDeliveryEngine())});e.triggerEvent(t)}this.callParent()},onHide:function(){this.__screenHide=!0,this.callParent()},doDestroy:function(){var e=this.getSfw();e&&e.doCleanup&&"function"==typeof e.doCleanup&&e.doCleanup(),this.__syncManager.unbind("SYNC_PROGRESS",this.__onSyncProgress,this),this.__productIQObject&&this.__productIQObject.doCleanup(),this.__mobileInventoryObject&&this.__mobileInventoryObject.doCleanup(),this.callParent()},__checkConflictStatus:function(e,t,n){var i=this,a=this.getDeliveryEngine().recordId,r=this.getDeliveryEngine().getEventBus(),s=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CHECK_IF_CONFLICT",this,{request:{recordId:a},responder:{result:function(r){var s={windowTitle:Ext.String.htmlEncode(e),backText:e},l=r.length>0;s.centerItem=l?i.__getConflictCenterItem(a,e,t,n):null,i.setViewInfo(s),l&&o.Msg.toast({text:_().T("FSA008_TAG008","Changes to this item cannot be synchronized. Tap the sync error icon to resolve this issue.")}),i.unblockApplication()}}});r.triggerEvent(s)},__getConflictCenterItem:function(e,t,n,i){var a=this;return[{xtype:"svmx.button",itemId:"titleLabel",cls:"sfm-console-titlelabel x-iconalign-right sfm-delivery-title-conflicted",transparent:!0,iconCls:"icon-sync-error",text:Ext.String.htmlEncode(t),listeners:{tap:o.proxy(a,function(){a.__getConflicts(e).then(function(t){if(t&&t.length>0)if(t.length>1)a.changeView({view:"syncconflict",windowTitle:o.string.substitute(_().T("FSA010_TAG137","Sync Conflicts ({{conflictCount}})"),{conflictCount:t.length}),options:{SVMX_conflictId:e},disableNavMenu:!1,ui:"svmx-default"});else{var n=t[0],i=Ext.create({xtype:"tools.conflictresolvemsgbox",ui:"svmx-default",record:n,objectType:n.label,name:n.nameValue,syncDetails:n.error_message,showViewInfo:!1});i.show()}})})}},{xtype:"svmx.label",itemId:"subTitle",cls:"sfm-console-subtitle",text:i}]},__getConflicts:function(e){var t=new r.Deferred,n=this;return n.blockApplication(),o.getCurrentApplication().getSyncImpl().getSyncManager().getDetailedSyncConflicts(function(e){e=e||{},n.unblockApplication(),t.resolve(e)},e),t.promise()}}),Ext.define(d.name+".DeliverySectionsModel",{extend:u,fields:[{name:"name"},{name:"count"},{name:"Id"},{name:"sectionType"}]}),Ext.define(d.name+".LineDetailsView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.linedetails",config:{dataModel:null,sectionModel:null,cls:["sfm-delivery-linedetails-view","sfm-process-view"]},layout:"auto",scrollable:"vertical",width:"100%",updateOptions:function(e){var t=this.getOption("detailId"),n=this.getOption("recordId"),i=this.getDeliveryEngine().getTargetData(),a=i.getDetailValueFromPath("details."+t).lines,r=o.array.get(a,function(e){return e.Id==n},this);this.setDataModel(r);var s=this.getDeliveryEngine().getMetaModel(),l=s.getChildNode("details"),c=l.getDetail("details."+t);this.setSectionModel(c),Ext.Viewport.onAfter("resize",o.proxy(this,this.__doResize))},__doResize:function(){var e=this;if(e.__detailsPanel&&e.__toolbar&&e.__toolbar.element){var t=e.__toolbar.element.getHeight();t<=0&&(t=44),e.__detailsPanel.setMaxHeight(.8*Ext.Viewport.element.getHeight()-t)}},ready:function(){var e=Ext.String.htmlEncode(this.getSectionModel().title);this.setViewInfo({windowTitle:e}),this.add({xtype:"svmx.toolbar",title:e,width:"100%",docked:"top",position:"absolute",items:[{xtype:"svmx.button",itemId:"toolbar",ui:"svmx-toolbar-btn",html:_().T("FSA016_TAG004","Cancel"),handler:o.proxy(this,"cancel"),left:"0",cls:"sfm-delivery-linedetails-view-toolbar-button"},{xtype:"svmx.button",itemId:"toolbar",ui:"svmx-toolbar-btn",html:_().T("FSA004_TAG003","Open"),handler:o.proxy(this,"open"),right:"0",cls:"sfm-delivery-linedetails-view-toolbar-button"}]}),this.__toolbar=this.query("#toolbar")[0];var t=[{xtype:"sfm.delivery.sectiondetails",itemId:"details",view:this,layout:"auto",cls:"sfm-delivery-linedetails-item-view",width:"100%"}];this.add(t),this.__detailsPanel=this.query("#details")[0];var n=this.getSectionModel();this.__detailsPanel.setModel(n),n.setExtendedEditRowBindingContext({data:this.getDataModel()||n.__currentRowContext.data}),n.executeBindings(),this.__doResize()},cancel:function(){this.done()},open:function(){h.info("open sfmdelivery of child record");var e=this.getDataModel(),t=e&&e.Id;if(t){o.getClient().getServiceRegistry().getService("com.servicemax.client.sfmsearch.platformspecifics").getInstance().showRecord({key:t,objectName:""})}this.done()},getDialogConfig:function(){return{height:"auto",layout:{type:"auto"},hideOnMaskTap:!0,maskTapHandler:o.proxy(this,this.cancel)}}}),Ext.define(d.name+".TextView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.textview",config:{title:"",text:"",cls:["sfm-process-view"],scrollable:"vertical"},ready:function(){var e=[{xtype:"svmx.verticalpanel",itemId:"editorPanel",flex:1,width:"100%",height:"100%",items:[{xtype:"svmx.field.textarea",value:this.getOption("text"),readOnly:!0,enableBarcode:!1,alwaysShowBarcode:!1,itemId:"editor",width:"100%",height:"100%",flex:1}]},{xtype:"svmx.toolbar",width:"100%",docked:"top",ui:"svmx-toolbar-grey",title:this.getOption("title"),items:[{docked:"left",xtype:"svmx.button",html:_().T("FSA016_TAG004","Cancel"),handler:o.proxy(this,"cancel"),ui:"svmx-toolbar-btn",itemId:"textCancelButton"}]}];this.add(e),this.setViewInfo({windowTitle:this.getOption("title"),menuItems:"wizards"})},cancel:function(){this.done()},getDialogConfig:function(){return{hideOnMaskTap:!0,maskTapHandler:o.proxy(this,this.cancel)}}}),o.defineGlobal(d.name,d),e.exports=d},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(19).impl,m=n(5).SVMXObject,v=n(11).Facade,g=n(104).SVMXModel,y=n(7).Cache,S=n(7).ServerInfo,E=n(189).Utils,b={name:"com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview"},T=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},M=p;b.Utils=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__syncService=f.getClient().getService("com.servicemax.client.syncmanager").getInstance(),e.__logger=f.getLoggingService().getLogger("SFM-DEL-UTILS-ATTACHMENTS"),e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"isImageOrVideo",value:function(e){return this.isImage(e)||this.isVideo(e)}},{key:"isImage",value:function(e){var t=!1;return e&&(e.match(/\.(jpg|jpeg|png|gif|bmp)$/i)||e.match(/\.(tif|tiff|jif|jfif|jp2|jpx|j2k|j2c|fpx|pcd)$/i))&&(t=!0),t}},{key:"isVideo",value:function(e){var t=!1;return e&&(e.match(/\.(avi|divx|flv|mov|mp4|mpeg4|mpg4|mpeg|mpg|m4v|wmv|swf|webm)$/i)||e.match(/\.(mkv|vob|ogg|ogv|drc|rm|rmvb|asf|m4p|mp2|mpe|mpv|svi|3gp|3g2|mxf|roq|nsv)$/i))&&(t=!0),t}},{key:"checkConnectivity",value:function(){var e=f.Deferred();return this.__syncService.checkConnectivity().done(f.proxy(this,function(){e.resolve(!0)})).fail(f.proxy(this,function(){e.resolve(!1)})),e.promise()}},{key:"getRealPath",value:function(e){var t=f.Deferred(),n={};return e&&(n.downloaded=e.get("downloaded"),n.file=e.get("file"),n.Id=e.get("Id")),this.getFileInfo(n).done(f.proxy(this,function(e){e=e||{},t.resolve(e.realPath,e.downloaded)})),t.promise()}},{key:"getFileInfo",value:function(e){var t=f.Deferred(),n=this;if(e&&e.file&&e.file.__path){e.realPath=e.realPath||null,e.dataURL=e.dataURL||null;var i=v,a=i.createFileRequest();a.bind("REQUEST_COMPLETED",function(i){i.data.success&&i.data.data&&i.data.data.FilePath?(e.downloaded="true",e.realPath=i.data.data.FilePath,i.data.data.FileSizeInBytes&&(e.size=i.data.data.FileSizeInBytes),"true"===e.isImage?n.getImageDataURL(e.realPath).then(f.proxy(this,function(n){e.dataURL=n,t.resolve(e)})):t.resolve(e)):e.Id&&-1==e.Id.indexOf("attach_local")?(e.downloaded="false",t.resolve(e)):this.__logger?(this.__logger.warn("SFAttachments table mismatch, record exists without matching file: "+e.Id),t.resolve(e)):(console.warn("SFAttachments table mismatch, record exists without matching file: "+e.Id),t.resolve(e))},this),a.bind("REQUEST_ERROR",function(n){e.Id&&-1==e.Id.indexOf("attach_local")?e.downloaded="false":this.__logger?this.__logger.warn("SFAttachments table mismatch, record exists without matching file: "+e.Id):console.warn("SFAttachments table mismatch, record exists without matching file: "+e.Id),t.resolve(e)},this),a.execute({operation:"INFO",file:e.file.__path})}else t.resolve(e);return t.promise()}},{key:"populateExtraFields",value:function(e){var t=f.Deferred();if(e){var n=f.Deferred();n.resolve(),n=n.then(f.proxy(this,this.checkConnectivity));for(var i=0;i<e.length;i++){var a=e[i];n=n.then(f.proxy(this,this.__populateFileInfo,a))}n=n.done(f.proxy(this,function(){t.resolve(e)}))}else t.reject();return t.promise()}},{key:"__populateFileInfo",value:function(e,t){var n=f.Deferred();return e.connected=t?"true":"false",e.status=this.__syncService.downloadAttachmentOnDemandStatus(e.Id),e.realPath=e.realPath||null,"true"===e.downloaded?this.getFileInfo(e).always(f.proxy(this,function(){n.resolve(t)})):n.resolve(t),n.promise()}},{key:"getImageDataURL",value:function(e){var t=f.Deferred(),n=document.createElement("canvas");n.width=68,n.height=68;var i=n.getContext("2d"),a=new Image;return a.onload=function(){i.drawImage(a,0,0,68,68);var e=n.toDataURL("image/jpeg",.5);t.resolve(e),a=null},a.onerror=function(){t.resolve(),a=null},a.src=E.getEncodedFileName(e),t}}]),t}(m),Ext.define(b.name+".AttachmentModel",{extend:g,fields:[{name:"Id"},{name:"author"},{name:"downloaded",defaultValue:"false"},{name:"status",defaultValue:""},{name:"connected"},{name:"file"},{name:"last_modified"},{name:"name"},{name:"size"},{name:"type"},{name:"isImage",defaultValue:"false"},{name:"isVideo",defaultValue:"false"},{name:"realPath",defaultValue:""},{name:"isSelectMode",defaultValue:"false"},{name:"isSelected",defaultValue:"false"},{name:"allowSelect",defaultValue:"true"},{name:"dataURL",defaultValue:""}]}),Ext.define(b.name+".AttachmentDocumentSection",{extend:M.name+".SVMXPanel",alias:"widget.sfm.delivery.attachmentdocumentsection",__lastConnectedStatus:!1,__connectionTimer:null,__showImages:!1,__showDocuments:!1,__allowAttachmentDelete:!1,__toolbar:null,__attachmentUtils:null,__inSelectMode:!1,__isSalesForceFilesEnabled:!1,__currentlySelected:{},halign:"full",scrollable:!1,cls:["sfm-process-edit"],config:{store:null,deliveryEngine:null},constructor:function(){this.__bindings=[],this.callParent(arguments),this.__isSalesForceFilesEnabled=!1,S.getMultiServerVersionRequest().isSalesForceFilesEnabled()&&(this.__isSalesForceFilesEnabled=!0)},bind:function(e,t,n,i){this.__bindings.push({eventBus:e,eventName:t,fn:n,context:i}),e.bind(t,n,i)},doDestroy:function(){f.array.forEach(this.__bindings,function(e){e.eventBus.unbind(e.eventName,e.fn,e.context)}),this.__connectionTimer&&(clearInterval(this.__connectionTimer),this.__connectionTimer=null),this.__attachmentUtils&&this.__attachmentUtils.destroy&&(this.__attachmentUtils.destroy(),this.__attachmentUtils=null),this.callParent()},buildUI:function(){this.setStore(Ext.widget("svmx.store",{model:b.AttachmentModel})),this.getHeader().add({xtype:"svmx.button",ui:"svmx-default",html:T().T("FSA008_TAG012","Select"),cls:"sfmdelivery-attachment-multi-select",handler:f.proxy(this,function(){this.__selectAttachments()})});var e=this.__preventChooseLibrary(),t=f.getClient().getApplicationParameter("client-type"),n=T().T("FSA008_TAG067","Waiting..."),i=(T().T("FSA008_TAG068","Retrying..."),T().T("FSA008_TAG069","Error")),a=T().T("FSA008_TAG044","Downloading..."),r=T().T("FSA016_TAG004","Cancel"),o=(T().T("FSA010_TAG058","No Connectivity"),f.getLoggingService().getLogger("SFM-DEL-UTILS-ATTACHMENTS"),this),s=new Ext.XTemplate('<div class="sfm-attachment-row {[this.getSelectorCls(values.downloaded, values.allowSelect, values.isSelectMode, values.isSelected, values.realPath)]}">','   <div style="display: inline-block" class="sfm-attachment-icon-wrap">','       <tpl if="this.showImage(downloaded, isImage, realPath)">','           <div style="display: inline" class="sfm-attachment-thumb-preview">','               <img src="{[values.dataURL]}"> ',"           </div>","       </tpl>",'       <tpl if="this.showMissingImage(downloaded, isImage, realPath)">','           <div style="display: inline" class="sfm-attachment-thumb-inactive sfm-attachment-image-icon sfm-attachment-icon-inactive" extension="{[this.getExtension(values.name)]}"></div>',"       </tpl>",'       <tpl if="this.showVideo(downloaded, isVideo, realPath)">','           <div style="display: inline" class="sfm-attachment-thumb-inactive sfm-attachment-play-icon sfm-attachment-icon-inactive"></div>',"       </tpl>",'       <tpl if="this.showMissingVideo(downloaded, isVideo, realPath)">','           <div style="display: inline" class="sfm-attachment-thumb-inactive sfm-attachment-video-icon sfm-attachment-icon-inactive" extension="{[this.getExtension(values.name)]}"></div>',"       </tpl>",'       <tpl if="this.showIcon(isImage, isVideo)">','           <div style="display: inline" class="sfm-attachment-thumb sfm-attachment-file-icon sfm-attachment-icon-inactive" downloaded="{[values.downloaded]}" extension="{[this.getExtension(values.name)]}"></div>',"       </tpl>",'       <br /><span class="sfm-delivery-detail-size">{[this.bytesToSize(values.size)]}</span>',"   </div>",'   <div style="display: inline-block">','       <div class="sfm-delivery-detail-name sfm-list-header sfm-attachment-header-name {[this.getHeaderInactiveCls(values.connected, values.downloaded, values.isSelectMode)]}">{name}</div>','       <div class="sfm-delivery-detail-description sfm-list-details">','           <span class="sfm-delivery-detail-description-header">{description}</span>',"       </div>",'       <tpl if="this.showProgressBar(status, connected)">','           <div class="sfm-attachment-progress"></div>',"       </tpl>",'       <tpl if="this.showStatus(status, downloaded, connected)">','           <div id="actionbtn" class="{[this.getStatusCls(values.status, values.connected, values.downloaded, values.isSelectMode)]}">',"               <span>{[this.getStatusText(values.status, values.connected, values.downloaded)]}</span>",'               <tpl if="this.isCancellable(status)">','                   <span class="sfm-attachment-cancel-text">{[this.getCancelMsg()]}</span>',"               </tpl>","           </div>","       </tpl>",'       <tpl if="this.showCloudButton(status, downloaded, connected)">','           <div id="actionbtn" class="{[this.getCloudCls(values.status, values.downloaded, values.connected)]}"></div>',"       </tpl>","   </div>","</div>",{getSelectorCls:function(e,t,n,i,a){var r="";return"true"===n&&("true"!==e||""===a||null==a||"true"!==t?r+=" sfm-attachment-blank-selector":"true"===i?r+=" sfm-attachment-checked-selector":"false"===i&&(r+=" sfm-attachment-unchecked-selector")),r},getCancelMsg:function(){return r},bytesToSize:function(e){var t=["Bytes","KB","MB","GB","TB"];if(0==e)return"n/a";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return 0==n?e+" "+t[n]:(e/Math.pow(1024,n)).toFixed(1)+" "+t[n]},getExtension:function(e){var t=e.split(".");return t[t.length-1]},showImage:function(e,t,n){return"true"===e&&"true"===t},showMissingImage:function(e,t,n){return"true"!==e&&"true"===t},showVideo:function(e,t,n){return"true"===e&&"true"===t},showMissingVideo:function(e,t,n){return"true"!==e&&"true"===t},showIcon:function(e,t){return"true"!==e&&"true"!==t},getHeaderInactiveCls:function(e,t,n){var i="";return"true"===t||"true"===e&&"true"!==n||(i+=" sfm-attachment-icon-inactive"),i},showProgressBar:function(e,t){return"downloading"===e&&"true"===t},showCloudButton:function(e,t,n){return"true"===t||"false"===n||("error"===e||""===e)&&!o.__syncImpl.__attachmentInProgress},getCloudCls:function(e,t,n){var i="sfm-attachment-options-icon";return"error"===e?i="sfm-attachment-cloud-error-icon":""!==e||t&&"false"!==t||(i="sfm-attachment-cloud-icon","false"===n&&(i+=" sfm-attachment-cloud-disabled")),i},showStatus:function(e,t,n){return"true"===n&&"true"!=t&&"error"!=e},getStatusCls:function(e,t,n,i){var a="sfm-attachment-text";return"true"!==t&&(a+=" sfm-attachment-icon-inactive"),a},getStatusText:function(e,t,r){var s="";return e&&"true"==t?"waiting"===e?s=n:"downloading"===e?s=a:"error"===e&&(s=i):"true"===t&&o.__syncImpl.__attachmentInProgress&&(s=a),s},isCancellable:function(e){return"waiting"===e}}),l=[{xtype:"svmx.toolbar",width:"100%",docked:"top",ui:"svmx-toolbar-grey",itemId:"toolbar",hidden:!0,items:[{docked:"right",xtype:"svmx.iconbutton",itemId:"trashButton",hidden:!this.__allowAttachmentDelete,cls:"svmx-trash-button attachment-selected-actions ",handler:f.proxy(this,this.__deleteSelectedAttachments),disabled:!0,disabledCls:"svmx-inactive"},{docked:"right",xtype:"svmx.iconbutton",itemId:"mailButton",cls:"svmx-mail-button attachment-selected-actions",handler:f.proxy(this,this.__shareSelectedAttachments),disabled:!0,disabledCls:"svmx-inactive"},{docked:"left",xtype:"svmx.button",html:T().T("FSA016_TAG004","Cancel"),handler:f.proxy(this,this.__cancelSelectAttachments),ui:"svmx-toolbar-btn",itemId:"textCancelButton"}]},{xtype:"svmx.list",deferEmptyText:!0,itemTpl:s,disableContainerScrollable:!0,store:this.getStore(),emptyText:T().T("FSA008_TAG070","No records found"),listeners:{itemtap:f.proxy(this,"onDetailRecordSelect"),itemswipe:f.proxy(this,"doItemSwipe")}},{xtype:"svmx.button",cls:"sfm-attachment-add-button",text:T().T("FSA008_TAG060","Add"),iconCls:"icon-plus",hidden:!this.__allowAttachmentDelete||"laptop"===t&&e,handler:f.proxy(this,"onAttachNewSelect")}];this.add(l),this.__toolbar=this.query("#toolbar")[0],this.__mailButton=this.query("#mailButton")[0],this.__trashButton=this.query("#trashButton")[0]},onShow:function(){},onHide:function(){},updateOptions:function(e){var t=void 0;this.__showImages=e.showImages,this.__showDocuments=e.showDocuments,this.__from=e.from,this.__allowAttachmentDelete=!!e.allowAttachmentDelete,t=1==this.__showImages?T().T("FSA008_TAG015","Attached Images/Videos"):T().T("FSA008_TAG016","Attached Documents"),this.setTitle(t)},__getMenuItems:function(){var e=[],t=T().T("FSA008_TAG017","Attachment Actions"),n=T().T("FSA008_TAG012","Select"),i=T().T("FSA008_TAG060","Add");return e.push({xtype:"svmx.label",cls:"svmx-wizard-label",html:t}),e.push({xtype:"svmx.button",ui:"svmx-menu-button",html:n,handler:f.proxy(this,"__selectAttachments")}),e.push({xtype:"svmx.button",ui:"svmx-menu-button",html:i,hidden:!this.__allowAttachmentDelete,handler:f.proxy(this,"__attachNewFile")}),e},__selectAttachments:function(){this.__toolbar.setHidden(!1),this.__mailButton.setDisabled(!0),this.__trashButton.setDisabled(!0),this.__inSelectMode=!0,this.getStore()&&this.getStore().each(function(e,t,n){e.set("isSelectMode","true"),e.set("isSelected","false")},this)},__cancelSelectAttachments:function(){this.__mailButton.setDisabled(!0),this.__trashButton.setDisabled(!0),this.__toolbar.setHidden(!0),this.__inSelectMode=!1,this.getStore()&&this.getStore().each(function(e,t,n){e.set("isSelectMode","false"),e.set("isSelected","false")},this)},__shareSelectedAttachments:function(){var e=this,t=[];if(this.getStore()&&this.getStore().each(function(n,i,a){if("true"===n.get("isSelected")){var r=e.getDecodeURIComponent(n.get("realPath"));r&&t.push(r)}},this),t){var n=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SHARE_ATTACHMENTS",this,{request:{deliveryEngine:this.getDeliveryEngine(),attachments:t},responder:f.create("com.servicemax.client.sfmdelivery.responders.DeleteAttachmentsResponder",this)});this.getDeliveryEngine().getEventBus().triggerEvent(n)}else this.__cancelSelectAttachments()},getDecodeURIComponent:function(e){var t=e;try{t=decodeURIComponent(e)}catch(e){}return t},__shareAttachment:function(e){var t=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SHARE_ATTACHMENTS",this,{request:{deliveryEngine:this.getDeliveryEngine(),attachments:[this.getDecodeURIComponent(e.get("realPath"))]},responder:f.create("com.servicemax.client.sfmdelivery.responders.DeleteAttachmentsResponder",this)});this.getDeliveryEngine().getEventBus().triggerEvent(t)},__attachNewFile:function(){var e=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ATTACH_FILE",this,{request:{deliveryEngine:this.getDeliveryEngine(),recordId:this.getDeliveryEngine().getRecordId(),isSalesForceFilesEnabled:this.__isSalesForceFilesEnabled},responder:f.create("com.servicemax.client.sfmdelivery.responders.SelectFileToUploadResponder",this)});this.getDeliveryEngine().getEventBus().triggerEvent(e)},__preventChooseLibrary:function(){var e=S.getMultiServerVersionRequest();return!!e&&e.preventChooseFromLibrary()},onAttachNewSelect:function(e,t){var n=this,i=f.getClient().getApplicationParameter("client-type"),a=f.getClient().getApplicationParameter("device-info"),r=(a["device-platform"],n.__preventChooseLibrary());this.__attachmentOptionPicker=Ext.widget("svmx.panel",{left:0,top:0,modal:!0,hideOnMaskTap:!0,cls:"sfm-checklist-attachment-control-popup",items:[{xtype:"svmx.button",width:"250px",text:T().T("FSA002_TAG037","Take Photo"),hidden:"laptop"===i,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"CAMERA"})},scope:n}}},{xtype:"svmx.button",width:"250px",text:T().T("FSA002_TAG033","Take Video"),hidden:"laptop"===i,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"VIDEO"})},scope:n}}},{xtype:"svmx.button",width:"250px",text:T().T("FSA002_TAG036","Choose from Library"),hidden:"laptop"===i||r,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"GALLERY"})},scope:n}}},{xtype:"svmx.button",width:"250px",text:T().T("FSA002_TAG036","Choose from Library"),hidden:"laptop"!==i||r,listeners:{click:{element:"element",fn:function(){n.onAttachOptionMenu({option:"DOCUMENT"})},scope:n}}}]}),this.__attachmentOptionPicker.showBy(e,"tl-tl?"),Ext.Viewport.onAfter("orientationchange","handleChecklistAttachmentMenuOrientationChange",this,{delay:200,buffer:50})},handleChecklistAttachmentMenuOrientationChange:function(){var e=document.querySelector(".sfm-checklist-attachment-control-popup:not(.x-hidden)");if(e&&window.cordova){var t=window.document.body.offsetHeight,n=e.getBoundingClientRect();if(n.top>=t){var i=Math.round(n.x),a=Math.round(t-n.height);e.style="transform: translate3d("+i+"px,"+a+"px, 0px);"}}},onAttachOptionMenu:function(e){this.__attachmentOptionPicker.hide();var t=this.__isSalesForceFilesEnabled?45:30;if("CAMERA"===e.option||"VIDEO"===e.option){var n=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CAPTURE_PHOTO",this,{request:{context:this,deliveryEngine:this._deliveryEngine,additionalInfo:"CAMERA"===e.option?{mode:"FROMCAMERA"}:{mode:"FROMVIDEO",duration:t},process:"WOATTACHMENT",isSalesForceFilesEnabled:this.__isSalesForceFilesEnabled}});f.getCurrentApplication().triggerEvent(n)}else this.__attachNewFile()},onFileSelectedForUpload:function(e){},onFileSelectedForUploadError:function(e){e.data&&e.data.data&&e.data.data.error&&e.data.data.errorCode&&e.data.data.errorMessage?f.getCurrentApplication().showMessage({type:"ERROR",text:e.data.data.errorMessage,buttons:[{text:T().T("FSA016_TAG003","OK"),itemId:"OK"}],closable:!1}):e.fileSizeExceeded&&this.onFileSizeExceededError(e)},onFileSizeExceededError:function(e){var t=T().T("FSA008_TAG071","File size is greater than maximum allowed file size.")+" ("+e.fileSizeLimitName+")";f.getCurrentApplication().showMessage({type:"ERROR",text:t,buttons:[{text:T().T("FSA016_TAG003","OK"),itemId:"OK"}],closable:!1})},__deleteSelectedAttachments:function(){var e=T().T("FSA016_TAG004","Cancel"),t=T().T("FSA008_TAG023","Delete"),n=T().T("FSA008_TAG072","Delete Attachments?"),i=T().T("FSA008_TAG073","The attachments will be removed from {{name}} and will be deleted from the server at the next sync. This action cannot be undone.");i=f.string.substitute(i,{name:this.getDeliveryEngine().getTargetData().getData().getValueFromPath("Name")}),f.Msg.confirm({title:n,text:i,buttons:[{text:e,itemId:"CANCEL",ui:"svmx-button-square"},{text:t,itemId:"DELETE",ui:"svmx-button-square"}]}).done(f.proxy(this,function(e){var t=this;"DELETE"===e&&(this.getStore()&&this.getStore().each(function(e,n,i){"true"===e.get("isSelected")&&t.__storeDeletedAttachmentInfo(e.get("Id"),e.get("file"),e.get("fileType"),e.get("contentDocumentId"),e.get("parentId"))},this),this.refreshData("deleteAttachment"))}))},__deleteAttachment:function(e,t,n,i,a){var r=T().T("FSA016_TAG004","Cancel"),o=T().T("FSA008_TAG023","Delete"),s=T().T("FSA008_TAG072","Delete Attachment?"),l=T().T("FSA008_TAG073","The attachment will be removed from {{name}} and will be deleted from the server at the next sync. This action cannot be undone.");l=f.string.substitute(l,{name:this.getDeliveryEngine().getTargetData().getData().getValueFromPath("Name")}),f.Msg.confirm({title:s,text:l,buttons:[{text:r,itemId:"CANCEL",ui:"svmx-button-square"},{text:o,itemId:"DELETE",ui:"svmx-button-square"}]}).done(f.proxy(this,function(r){"DELETE"===r&&(this.__storeDeletedAttachmentInfo(e,t,n,i,a),this.refreshData("deleteAttachment"))}))},__storeDeletedAttachmentInfo:function(e,t,n,i,a){if("SFILE"===n&&-1===e.indexOf("attach_local")){y.registerJSCache("attachedFileDetails",10);var r=y.readFromJSCache("attachedFileDetails","deletedContentVersions");r=r||{};var o=r.cVIds||[],s=r.cDIds||[],l=r.parentIdMap||{};o.push({Id:e}),s.push(i),l[e]=a,r.cVIds=o,r.cDIds=s,r.parentIdMap=l,y.writeToJSCache("attachedFileDetails","deletedContentVersions",r)}else{var c={Id:e,parentId:a,file:{__path:t.__path}};y.registerJSCache("attachedFileDetails",10);var u=y.readFromJSCache("attachedFileDetails","deletedAttachments");u?u.push(c):u=[c],y.writeToJSCache("attachedFileDetails","deletedAttachments",u)}},ready:function(){this.__attachmentUtils=f.create("com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.Utils",this),this.buildUI(),this.refreshData(),this.__connectionTimer=setInterval(f.proxy(this,this.__checkConnection),5e3),this.__syncImpl=f.getCurrentApplication().getSyncImpl().getSyncManager();var e=f.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.bind(e,"ATTACHMENT_ON_DEMAND.STARTING",this.__updateData,this),this.bind(e,"ATTACHMENT_ON_DEMAND.DOWNLOADING",this.__updateData,this),this.bind(e,"ATTACHMENT_ON_DEMAND.FINISHED",this.__updateData,this),this.bind(e,"ATTACHMENT_ON_DEMAND.CANCELLED",this.__updateData,this),this.bind(e,"ATTACHMENT_ON_DEMAND.ERROR",this.__updateData,this);var t=this.__from;"productIQ-documents"!==t&&"productIQ-images"!==t&&this.bind(e,"ATTACHMENT_ON_DEMAND.RELOAD",this.__reloadFromPIQ,this),this.bind(e,"ATTACHMENTS_CHANGED",this.onAttachmentsChange,this),this.bind(e,"ATTACHMENTS_RENAMED",this.onAttachmentsRename,this),this.bind(e,"ATTACHMENTS_CANCELLED",this.onAttachmentsChange,this),this.__syncbus=f.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),this.bind(this.__syncbus,"SYNC_ATTACHMENTS_COMPLETED",this.refreshData,this)},__reloadFromPIQ:function(e){this.refreshData()},__checkConnection:function(){this.__attachmentUtils.checkConnectivity().done(f.proxy(this,function(e){e!=this.__lastConnectedStatus&&(this.__lastConnectedStatus=e,this.__lastConnectedStatus||this.__syncbus.clearAttachmentDownload(),this.getStore()&&this.getStore().each(function(e,t,n){this.__lastConnectedStatus||e.set("status",""),e.set("connected",this.__lastConnectedStatus?"true":"false")},this))}))},__updateData:function(e){var t=this.getStore()&&this.getStore().findRecord("Id",e.data.request.recordId);if(t)switch(e.type){case"ATTACHMENT_ON_DEMAND.STARTING":t.set("status","waiting");break;case"ATTACHMENT_ON_DEMAND.DOWNLOADING":t.set("status","downloading");break;case"ATTACHMENT_ON_DEMAND.FINISHED":this.refreshData().then(f.proxy(this,function(){t=this.getStore()&&this.getStore().findRecord("Id",e.data.request.recordId),this.__attachmentUtils.getRealPath(t).done(f.proxy(this,function(e,n){t.set("status",""),void 0!==n?t.set("downloaded",n):t.set("downloaded",!1),t.set("realPath",e)}))}));break;case"ATTACHMENT_ON_DEMAND.ERROR":t.set("status","error")}},onAttachmentsChange:function(e){"refreshAllAttachments"===e.data.request.attachmentActionName?this.refreshData("refreshAllAttachments"):e.data.request.recordId==this.getDeliveryEngine().getRecordId()&&this.refreshData(e.data.request.attachmentActionName)},onAttachmentsRename:function(){this.refreshData()},onDeleteAttachmentsSuccess:function(e){this.refreshData(),this.__cancelSelectAttachments()},refreshData:function(e){var t=this.getDeliveryEngine().getEventBus();if(t){var n=f.create("com.servicemax.client.sfmconsole.utils.EventCollection",t,[f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.LIST_ATTACHMENTS",this,{request:{deliveryEngine:this.getDeliveryEngine(),recordId:this.getDeliveryEngine().getRecordId(),attachmentActionName:"string"==typeof e?e:"refreshAllAttachments"}}),f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.LIST_OUTPUTDOC_ATTACHMENTS",this,{request:{deliveryEngine:this.getDeliveryEngine(),recordId:this.getDeliveryEngine().getRecordId()}})]),i=f.Deferred();return n.triggerAll(function(e){for(var t=e.items(),n=[],a=[],r=0;r<t.length;r++){var o=t[r];switch(o.type()){case"SFMDELIVERY.LIST_ATTACHMENTS":a=o.response;break;case"SFMDELIVERY.LIST_OUTPUTDOC_ATTACHMENTS":n=o.response}}this.__mergeAndDisplayAttachments(a,n).then(function(){i.resolve()})},this),i.promise()}},__mergeAndDisplayAttachments:function(e,t){return f.when([this.__onListAttachmentsComplete(e),this.__onListOutputDocAttachmentsComplete(t)]).then(f.proxy(this,function(e,t){var n=t.concat(e),i=this.getStore();i&&i.setData(n)}))},__onListAttachmentsComplete:function(e){for(var t=f.Deferred(),n=[],i=0;i<e.length;i++){var a=e[i].name,r=this.__attachmentUtils.isImage(a),o=this.__attachmentUtils.isVideo(a);((r||o)&&this.__showImages||!r&&!o&&this.__showDocuments)&&(e[i].isImage=r?"true":"false",e[i].isVideo=o?"true":"false",e[i].isSelectMode=this.__inSelectMode?"true":"false",e[i].isSelected=this.__selectAttachments[e[i].Id]?"true":"false",e[i].allowSelect="true",n.push(e[i]))}return this.__attachmentUtils.populateExtraFields(n).done(f.proxy(this,function(e){t.resolve(e)})).fail(function(){t.reject()}),t.promise()},__onListOutputDocAttachmentsComplete:function(e){for(var t=f.Deferred(),n=[],i=0;i<e.length;i++){e[i].name;this.__showDocuments&&(e[i].isImage="false",e[i].isVideo="false",e[i].isSelectMode="false",e[i].isSelected="false",e[i].allowSelect="false",n.push(e[i]))}return this.__attachmentUtils.populateExtraFields(n).done(f.proxy(this,function(e){t.resolve(e)})).fail(function(){t.reject()}),t.promise()},__showRecordViewEdit:function(e){var t=this;null!==t.__editDialog&&void 0!==t.__editDialog&&(t.__editDialog.hide(),t.__editDialog.destroy());var n=Ext.widget("svmx.field.text",{itemId:"attachmentName",cls:"sfmdelivery-attachment-edit-name-field",label:T().T("FSA008_TAG018","Name"),labelCls:"sfmdelivery-attachment-edit-name-field-label",labelAlign:"top",readOnly:!0,enableBarcode:!1,value:e.data.name}),i=Ext.widget("svmx.field.textarea",{itemId:"attachmentDescription",cls:"sfmdelivery-attachment-edit-desc-field",label:T().T("FSA008_TAG019","Description"),labelCls:"sfmdelivery-attachment-edit-desc-field-label",labelAlign:"top",readOnly:!0,enableBarcode:!1,value:e.data.description});t.__editDialog=f.showDialog({xtype:"svmx.panel",cls:"sfmdelivery-attachment-edit-dialog-panel",itemId:"svmxAttachmentEditDialog",items:[{xtype:"svmx.headerbar",cls:"sfmdelivery-attachment-edit-dialog-headerbar",leftItem:[{xtype:"svmx.button",cls:"sfmdelivery-attachment-edit-dialog-cancel",text:T().T("FSA016_TAG004","Cancel"),handler:function(){t.__editDialog.hide(),t.__editDialog.destroy()}}],centerItem:[{xtype:"svmx.label",cls:"sfmdelivery-attachment-edit-dialog-title",text:T().T("FSA008_TAG020","File Description")}]},{xtype:"svmx.panel",cls:"sfmdelivery-attachment-dialog-inner-wrap",items:[n,i]}]},{height:null,width:null,cls:"sfmdelivery-attachment-dialog-wrapper"})},onDetailRecordSelect:function(e,t,n,i,a,r){var o=this,s=this,l=i.get("Id"),c=i.get("connected"),u=i.get("downloaded"),d=i.get("status"),_=i.get("realPath"),h=i.get("file"),p=(i.get("isSelectMode"),i.get("isSelected")),m=i.get("allowSelect"),v=i.get("fileType"),g=i.get("contentDocumentId"),y=i.get("parentId");if("sfm-attachment-options-icon"==a.target.className){var S=[{xtype:"svmx.button",text:T().T("FSA008_TAG021","View Name and Description"),handler:function(){s.__btnContainer.hide(),s.__btnContainer.destroy(),s.__showRecordViewEdit(i)}},{xtype:"svmx.button",text:T().T("FSA008_TAG022","Share"),handler:function(){s.__btnContainer.hide(),s.__btnContainer.destroy(),s.__shareAttachment(i)}}];this.__allowAttachmentDelete&&S.push({xtype:"svmx.button",text:T().T("FSA008_TAG023","Delete"),handler:function(){s.__btnContainer.hide(),s.__btnContainer.destroy(),s.__deleteAttachment(l,h,v,g,y)}}),s.__btnContainer=Ext.widget("svmx.panel",{left:0,top:0,modal:!0,hideOnMaskTap:!0,cls:"sfm-attachment-control-popup",items:S}),s.__btnContainer.showBy(n,"c-br?",[0,0])}else if("sfm-attachment-delete-icon"==a.target.className)s.__deleteAttachment(l,h,v,g,y);else if("sfm-attachment-cancel-text"==a.target.className)l&&"waiting"===d&&(this.__syncbus.cancelAttachmentDownloadOnDemand(l),i.set("status",""));else if(l&&this.__inSelectMode){if("true"===m&&"true"===u&&_){"true"===p?(i.set("isSelected","false"),delete this.__selectAttachments[l]):(i.set("isSelected","true"),this.__selectAttachments[l]=!0);var E=!0;this.getStore()&&this.getStore().each(function(e,t,n){"true"===e.get("isSelected")&&(E=!1)},this),this.__mailButton.setDisabled(E),this.__trashButton.setDisabled(E)}}else if(l&&"true"===u)this.openAttachment(i);else if(l&&"true"===c&&""===d&&!this.__syncImpl.__attachmentInProgress)this.__syncbus.downloadAttachmentOnDemand(l);else if(!l||"false"!==c||""!==d&&"downloading"!==d){if(l&&"true"===c&&"error"===d){var b={text:T().T("FSA008_TAG076","Retry"),itemId:"retry",ui:"svmx-button-square"},M={text:T().T("FSA016_TAG004","Cancel"),itemId:"cancel",ui:"svmx-button-square"};f.Msg.alert({title:T().T("FSA008_TAG077","Warning"),text:T().T("FSA008_TAG078","Unable to download this item."),buttons:[b,M]}).done(f.proxy(this,function(e){"retry"===e?o.__syncbus.downloadAttachmentOnDemand(l):o.__syncbus.downloadAttachmentOnDemandClearError(l)}))}}else f.getCurrentApplication().showMessage({type:"WARN",title:T().T("FSA008_TAG074","No connection"),text:T().T("FSA008_TAG075","No connection. Try again later.")})},doItemSwipe:function(e,t,n,i,a,r){if(this.__allowAttachmentDelete&&"true"==i.getData().downloaded){if("left"==a.direction){var o=null;n.element.dom.querySelector("#actionbtn")&&"sfm-attachment-delete-icon"!==n.element.dom.querySelector("#actionbtn").className&&(o=n.element.dom.querySelector("#actionbtn").className);var s=function(){n.element.dom.querySelector("#actionbtn")&&o&&(n.element.dom.querySelector("#actionbtn").className=o),n.element.removeCls("svmx-list-row-swiped")};e.on({single:!0,buffer:250,itemtouchstart:s}),Ext.Viewport.element.on({single:!0,buffer:250,touchstart:s}),n.element.dom.querySelector("#actionbtn")&&o&&(n.element.dom.querySelector("#actionbtn").className="sfm-attachment-delete-icon"),n.element.addCls("svmx-list-row-swiped")}}},openAttachment:function(e){var t=this.getDeliveryEngine().getEventBus(),n=e.get("file"),i=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_ATTACHMENT",this,{request:{deliveryEngine:this.getDeliveryEngine(),file:n}});t.triggerEvent(i)},setRecordIDToEngine:function(e){this.__cancelSelectAttachments(),this.getDeliveryEngine().recordId=e}}),f.defineGlobal(b.name,b),e.exports=b},function(e,t,n){var i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10),o=n(0).utils,s=n(7).MetaData,l=n(12).DatetimeUtil,c=(n(60).Constants,n(19).impl),u=(n(24).navigation,n(24).data,n(7).Cache),d=n(5).ExtensionRunner,_=n(7).Data,h={name:"com.servicemax.client.sfmdelivery.ui.largemodern.editview"},f=s,p=function(){return o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},m=l,v=o.getLoggingService().getLogger("sfmdelivery.ui.editview"),g=c;h.EditView=Ext.define(h.name+".EditView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.editview",__selected:null,__additionalInfo:null,__isCreate:null,config:{pageModel:null,dataModel:null,halign:"full",cls:["sfm-process-edit"]},height:"100%",layout:"fit",__saveButton:null,__cancelButton:null,__quickSaveButton:null,onShow:function(){this.__selected=!1,v.info("Edit View showing"),this.getDeliveryEngine().blockSyncPopUp(),this.callParent()},onHide:function(){v.info("Edit View hiding"),this.getDeliveryEngine().allowSyncPopUp(),this.callParent()},doDestroy:function(){o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().unbind("SYNC_COMPLETED",this.__onSyncCompleted,this),this.callParent()},getLeftButton:function(){var e={xtype:"svmx.button",html:this._getLeftButtonText(),handler:o.proxy(this,"cancel"),ui:"svmx-toolbar-btn svmx-cancel-btn",itemId:"cancelButton"},t=this.getDeliveryEngine().getNavigationStack();if(t&&t.length>0){var n=t[t.length-1];n.sfmProcessTitle&&n.sfmProcessTitle.length>0&&(e.html=n.sfmProcessTitle,e.ui="svmx-toolbar-btn svmx-cancel-btn svmx-linked-sfm-process-back-btn",e.iconCls="icon-chevron-left",e.iconAlign="left")}return e},_getLeftButtonText:function(){return p().T("FSA016_TAG004","Cancel")},getRightButton:function(){var e=this;return{xtype:"svmx.button",html:p().T("FSA008_TAG079","Save"),ui:"svmx-button-square svmx-save-btn",itemId:"saveButton",listeners:{tap:{fn:function(t,n){e.save()},scope:e,buffer:500}}}},getButtons:function(e){var t=[],n=0,i=e?e.length:0;for(n=0;n<i;n++){var a=e[n];if(a.events&&a.events.length>0){var r={xtype:"svmx.button",html:a.title,handler:o.proxy(this,"customAction",a),cls:"svmx-custom-btn",itemId:"actionButton_"+n};t.push(r)}}t.push({xtype:"svmx.spacer",flex:1});var s=this.getPageModel(),l=s._data.response.sfmProcessType,c=s.getHeaderMetaModel().hideQuickSave;return"STANDALONE CREATE"!=l&&"SOURCE TO TARGET ALL"!=l&&"SOURCE TO TARGET CHILD"!=l||(c=!0),c||t.push({xtype:"svmx.button",html:p().T("FSA008_TAG080","Quick Save"),handler:o.proxy(this,"quickSave"),cls:"svmx-quicksave-btn",iconCls:"icon-save",itemId:"quickSaveButton"}),t},updateOptions:function(e){this.__pageFrom=e.pageFrom,e&&e.additionalInfo?(this.__additionalInfo=e.additionalInfo,this.__isCreate=e.additionalInfo):(this.__additionalInfo=null,this.__isCreate=null);var t=this.getDeliveryEngine().getEventBus();o.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.bind(t,"DATA_LOADED",this.onDataUpdated,this),this.bind(t,"SFMDELIVERY.ADV_VALIDATION_ERROR",this.onAdvancedValidationError,this),this.bind(t,"SFMDELIVERY.VALIDATION_ERROR",this.onValidationError,this),this.bind(t,"SFMDELIVERY.FIELD_UPDATE_VALIDATION_ERROR",this.onFieldUpdateValidationError,this),this.bind(t,"SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",this.onSnippetError,this),this.bind(t,"SFMDELIVERY.CUSTOMSNIPPET.SNIPPETSUCCESS",this.onSnippetSuccess,this),this.blockApplication(),this.setViewInfo({windowTitle:"...",backText:p().T("FSA016_TAG015","Back"),hideContextMenu:!0,disableNavMenu:!0})},ready:function(){this.__isReady=!0,this.__selected=!1;var e=this.getDeliveryEngine().getMetaModel();this.setPageModel(e);var t=e.getData().page.header.headerLayout[o.getCustomObjectName("Object_Name")],n=(this.getDeliveryEngine().getMetaModel().getObjectLabel(t),e.getData()),i=n.processTitle||n.page.processTitle;this.setViewInfo({windowTitle:i,backText:p().T("FSA016_TAG015","Back"),leftHeader:this.getLeftButton(),rightHeader:this.getRightButton(),disableNavMenu:!0,hideBackButton:!0,hideContextMenu:!0}),this.createIssueIndicator(),this.createSectionContainer(e),Ext.Viewport.onAfter("orientationchange","changeScrollProperty",this),Ext.Viewport.onAfter("orientationchange","handleInlineMenuOrientation",this,{delay:200,buffer:50}),o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().bind("SYNC_COMPLETED",this.__onSyncCompleted,this)},onSnippetError:function(e){if(e.data.request&&e.data.request.error_msg){var t=this,n=[{message:e.data.request.error_msg,errorCorrectionhandler:function(e,n){t.scrollIntoView()}}];this.issueIndicator.setIssues({errors:n,warnings:[]},!0),this.issueIndicator.showIssues(),this.__saveButton.disable()}},onSnippetSuccess:function(){this.issueIndicator.hide(),this.__saveButton.enable()},__onSyncCompleted:function(e){var t=e.data.syncType;if("edit"==o.getCurrentApplication().getCurrentView().getViewConfig()&&("DATA"==t||"AGGRESSIVE"==t||"ONECALLSYNC"==t)){var n=this.getDeliveryEngine(),i=n.getTargetData().getData().__data.sfmData,a=e.data.syncData.mapRecordIds;a&&n.getSourceRecordId().indexOf("local")>0&&a[n.getSourceRecordId()]&&i.sourceRecordId&&i.sourceRecordId.indexOf("local")>0&&a[i.sourceRecordId]&&(n.__sourceRecordId=a[n.__sourceRecordId],i.sourceRecordId=a[i.sourceRecordId])}},createIssueIndicator:function(){this.issueIndicator=o.create(h.name+".IssueIndicator",{}),this.add(this.issueIndicator)},createSectionContainer:function(e){var t="vertical",n=this;"laptop"==o.getClient().getApplicationParameter("client-type").toLowerCase()&&(t="both");var n=this,i={xtype:"sfm.delivery.sections",itemId:"deliverySections",view:this,readOnly:!1,cls:"sfm-delivery-sections sfm-delivery-section-edit",scrollable:!1,contentScrollable:t,deliveryEngine:this.getDeliveryEngine(),model:e,listeners:{inputblur:function(e,t){var i=Ext.create({itemId:"tmppanel",height:10,xtype:"svmx.panel"});n.add(i),setTimeout(function(){i.destroy()},1e3)}}};this.add(i),this.__deliverySections=this.query("#deliverySections")[0],this.__deliverySections.addPanel({xtype:"svmx.toolbar",layout:{pack:"full",type:"hbox"},width:"100%",items:this.getButtons(e.getChildNode("header").getChildNode("actions")),docked:"top",cls:"sfm-delivery-toolbar"})},restore:function(e){if(e){var t=e.data,n=e.viewOptions;switch(e.viewId){case"lookup":t=e.data;var i,a=this.currentLookupField,r=a.getLookupModel();if(r){i=t[r.getDefaultColumnName()]}null!==i&&void 0!==i||(i=t[a.nameFieldName]);this.getDeliveryEngine().getTargetData().__allBindingsHash[a.fieldName].setValue({key:t.Id,value:i}),this.executeFieldMappings(a,t);break;case"edittext":var o=n.fieldName;this.getDataModel().__allBindingsHash[o].setValue(t)}}},executeFieldMappings:function(e,t){for(var n=e;!n.executeFieldMappings;)n=n._parent;n.executeFieldMappings&&n.executeFieldMappings(e,t)},onAttachmentsChange:function(){this.__deliverySections.onAttachmentsChange()},onDataUpdated:function(e){var t=e.data;if(this.setDataModel(t),"CHECKLIST"==this._deliveryEngine.getPageMetaData().getProcessType()&&void 0===this._options.additionalInfo.checklistStatus){var n=t.__data.__data,i=this._deliveryEngine.getMetaModel().getQuestionData(n);if(this.__deliverySections.answeredJson=o.toObject(t.__data.__data.sfmData[o.getCustomFieldName("ChecklistJSON")]),this._deliveryEngine.skippedSectionsQuestions,this.__getExitCriteriaBizRules&&this.__getExitCriteriaBizRules().length>0)for(key in i)this.__deliverySections.answeredJson.hasOwnProperty(key)||this._deliveryEngine.skippedSectionsQuestions.push(key)}if("CHECKLIST"==this._deliveryEngine.getPageMetaData().getProcessType()){var a=this;setTimeout(function(){a.__onSectionDataUpdated()},500)}this.unblockApplication(),this.refreshAttachments(),this.changeScrollProperty(),o.getClient().getApplicationParameter("enable-sfm-profiling-logs")&&window.editProcessStart&&(console.log("Time taken for edit:"+(performance.now()-window.editProcessStart)),delete window.editProcessStart)},changeScrollProperty:function(){if(Ext.isiOS){var e=this.query("#navcontainer")[0],t=e&&e.bodyElement.dom;t&&(t.style.setProperty("-webkit-overflow-scrolling","auto"),setTimeout(function(){t.style.setProperty("-webkit-overflow-scrolling","touch")},1e3))}},handleInlineMenuOrientation:function(){var e=document.querySelector(".sfm-delivery-property-menu:not(.x-hidden)");if(e&&window.cordova){var t=window.document.body.offsetWidth,n=this.element.dom.querySelector(".x-gridrow.x-selected .sfm-delivery-linked-grid-cell").getBoundingClientRect(),i=n.top+n.height,a=e.getBoundingClientRect();if(i=i+a.height>window.innerHeight?window.innerHeight-Math.round(a.height):i,t>0&&i>0&&a){var r=Math.round(t-a.width),o=Math.round(i);e.style="transform: translate3d("+r+"px,"+o+"px, 0px);"}}},refreshAttachments:function(){for(var e=this.query("sfm\\.delivery\\.attachmentdocumentsection"),t=0;t<e.length;t++){var n=e[t];n&&n.refreshData()}},onAdvancedValidationError:function(e){this.__handleValidationError(e,!0)},updateIsBillable:function(){if(this.isWebServiceConfiguredForIsBillable()){this.getDeliveryEngine()&&this.getDeliveryEngine().saveToModel(!1);var e=this.isBillableAfterRespectingTheSettings(),t=!1;if(this.getDeliveryEngine()&&this.getDeliveryEngine().getTargetData()&&this.getDeliveryEngine().getTargetData().getData()&&this.getDeliveryEngine().getTargetData().getData().__data&&this.getDeliveryEngine().getTargetData().getData().__data.sfmData&&this.getDeliveryEngine().getTargetData().getData().__data.sfmData.details){var n=this.getDeliveryEngine().getTargetData().getData().__data.sfmData.details;for(var i in n){var r=n[i],s=r.lines;if(s)for(var l=0;l<s.length;l++){var c=s[l],u=c[o.OrgNamespace+"__Is_Billable__c"];u&&"object"===(void 0===u?"undefined":(0,a.default)(u))&&(t=!0,u.fieldvalue={key:e.toString(),value:e.toString()}),c.__new&&delete c.__new,c.__copy&&delete c.__copy}}}t&&this.getDataModel()&&this.getDataModel().executeBinding()}},isWebServiceConfiguredForIsBillable:function(){var e=!1;if(this.getPageModel()&&this.getPageModel()._children&&this.getPageModel()._children.details&&this.getPageModel()._children.details.getData()){var t=this.getPageModel()._children.details.getData();if(t.length>0)for(var n=0;n<t.length;n++){for(var i=t[n],a=i.events?i.events.length:0,r=0;r<a;r++){var s=i.events[r],l=s[o.OrgNamespace+"__Event_Type__c"],c=s[o.OrgNamespace+"__Target_Call__c"];if(l&&"After Add Record"===l&&c&&c.includes("INTF_WebServicesDef.INTF_WO_SetIsBillable_WS")){e=!0;break}}if(e)break}}return e},isBillableAfterRespectingTheSettings:function(){var e=!1,t=this.getDeliveryEngine()&&this.getDeliveryEngine().__settings;if(t&&t.__data){var n=t.__data,i=n.WORD005_SET015,a=n.WORD005_SET016;if(i)if("Entitlement"===i){if(a){var r=a?a.split(","):[],o=this.getHeaderBillingType();if(e=!0,o){var s=r.indexOf(o);s>-1&&(e=!1)}}}else e="string"==typeof i&&"true"===i.toLowerCase()||"boolean"==typeof i&&1==i}return e},getHeaderBillingType:function(){var e="";if(this.getPageModel()&&this.getPageModel().getDataModel()){var t=this.getPageModel().getDataModel().__allBindingsHash;if(t){var n=t[o.OrgNamespace+"__Billing_Type__c"];if(n&&n.getValue){var i=n.getValue();"string"==typeof i?e=i:"object"===(void 0===i?"undefined":(0,a.default)(i))&&(e=i.value)}}}return e},__handleValidationError:function(e,t){var n=e.data.request.result,i=n.errors.length,a=n.warnings.length;this.unblockApplication(),this.__enableSubmit&&this.__enableSubmit(),(i||a)&&(this.clearWarnings(n),this.issueIndicator.setIssues(n),this.issueIndicator.hasUnconfirmedIssues()||i?this.issueIndicator.showIssues():(this.issueIndicator.hide(),this.confirmValidationWarning(e.data.request.original,t)))},clearWarnings:function(e){var t=this;if(e.warnings&&e.warnings.length){for(var n in this.issueIndicator.__issueConfirmations)!function(n){e.warnings.findIndex(function(e){return e.message===n})<0&&delete t.issueIndicator.__issueConfirmations[n]}(n)}},confirmValidationWarning:function(e,t){this.blockApplication();var n=e.request;t?(n.confirmed=!0,n.fieldValidatioConfirmed=this.fieldValidationConfirmed||!1):(n.fieldValidatioConfirmed=!0,this.fieldValidationConfirmed=!0);var i=void 0;i="CHECKLIST"===this.getDeliveryEngine().getMetaModel().getProcessType()?"SFMDELIVERY.SAVE_CHECKLISTRECORD":"SFMDELIVERY.SAVE_TARGETRECORD";var a=o.create("com.servicemax.client.lib.api.Event",i,this,{request:n,responder:e.responder});this.getDeliveryEngine().getEventBus().triggerEvent(a)},onFieldUpdateValidationError:function(e){var t=this,n=e.data.request.result;if(n.errors.length);else if(n.warnings.length){for(var i="Warning: Error found in configured formula.",a=0;a<n.warnings.length;a++)n.warnings[a].message=i;var r={text:p().T("FSA016_TAG003","OK"),itemId:"ok",ui:"svmx-button-square"},s={text:p().T("FSA016_TAG004","Cancel"),itemId:"cancel",ui:"svmx-button-square"};o.Msg.alert({text:i,buttons:[r,s]}).done(o.proxy(this,function(n){"ok"===n&&"onload"!==e.data.request.eventType&&t.confirmValidationWarning(e.data.request.original)})),this.unblockApplication()}},onValidationError:function(e){this.__handleValidationError(e,!1)},onValidationErrorAndroid:function(e){var t=e.data.message,n=e.data.warnings||[];this.unblockApplication(),o.array.forEach(t,function(e){v.error(e.message)}),1===t.length&&0===n.length?o.Msg.alert({title:p().T("FSA008_TAG081","Missing or Incorrect Entry"),text:t[0].message,buttons:[{text:p().T("FSA008_TAG082","Review and Update"),itemId:"OK",ui:"svmx-button-square"}]}):(this.issueIndicator.setIssues({errors:t,warnings:n}),this.issueIndicator.hasUnconfirmedIssues()||t.length?this.issueIndicator.showIssues():(this.issueIndicator.hide(),this.confirmValidationWarning(e.data.request.original)))},handleHardwareBack:function(){return this.callParent()||this.cancel(),!0},cancel:function(){(this._needConfirmCancel()?h.EditView.confirmCancel():r.Deferred().resolve("DISCARD")).then(o.proxy(this,function(e){"DISCARD"==e&&(this.__additionalInfo=null,this.__cancelAttachments(),this.__doneCheckNavigationStack())}))},__cancelAttachments:function(){var e=u.readFromJSCache("attachedFileDetails","filesAttached"),t=o.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),n=o.create("com.servicemax.client.lib.api.Event","ATTACHMENTS_CANCELLED",this,{request:{recordId:this.getDeliveryEngine().getRecordId(),attachmentActionName:"cancelAttachments"}});t.triggerEvent(n),this.__deleteAttachments(e)},_needConfirmCancel:function(){return!0},save:function(e){v.info("Performing Save action"),o.getClient().getApplicationParameter("enable-sfm-profiling-logs")&&(window.saveStart=performance.now());var t=this;this.issueIndicator.hide(),u.readFromDBCache("USER_INFO").done(function(n){n=n||{},n=o.toObject(n);var i=n.UserTechId,a=t.getDeliveryEngine().getTargetData().getData();if(a.__data&&a.__data.sfmData&&a.__data.sfmData.attributes&&a.__data.sfmData.attributes.type&&a.__data.sfmData.attributes.type===o.OrgNamespace+"__SVMX_Event__c"&&(void 0===i||null===i||0===i.length))return void o.getCurrentApplication().showMessage({text:p().T("FSA001_TAG062","Unable to create event since there is no technician associated."),buttons:[{text:p().T("FSA016_TAG003","OK"),itemId:"OK"}],itemId:"svmxEventAlertWindow"});t.__triggerSaveRecordEvent("save","com.servicemax.client.sfmdelivery.responders.SaveTargetRecordResponder",e);var r=u.readFromJSCache("attachedFileDetails","deletedAttachments");t.__deleteAttachments(r);var s=u.readFromJSCache("attachedFileDetails","deletedContentVersions");if(s){var l=s.cDIds,c=s.parentIdMap;l&&l.length>0&&_.deleteContentVersions(l,c)}u.clearJSCache("attachedFileDetails")})},quickSave:function(e){v.info("Performing QuickSave action "+new Date),this.issueIndicator.hide(),this.__triggerSaveRecordEvent("quick save","com.servicemax.client.sfmdelivery.responders.QuickSaveTargetRecordResponder",e);var t=u.readFromJSCache("attachedFileDetails","deletedAttachments");this.__deleteAttachments(t);var n=u.readFromJSCache("attachedFileDetails","deletedContentVersions");if(n){var i=n.cDIds,a=n.parentIdMap;i&&i.length>0&&_.deleteContentVersions(i,a)}u.clearJSCache("attachedFileDetails")},__disableSaveButton:function(){this.__saveButton=this.__saveButton||Ext.ComponentQuery.query("#saveButton")[0],this.__quickSaveButton=this.__quickSaveButton||Ext.ComponentQuery.query("#quickSaveButton")[0],this.__cancelButton=this.__cancelButton||Ext.ComponentQuery.query("#cancelButton")[0],this.__cancelButton&&this.__cancelButton.setDisabled(!0),this.__saveButton&&this.__saveButton.setDisabled(!0),this.__quickSaveButton&&this.__quickSaveButton.setDisabled(!0)},__enableSaveButton:function(){this.__saveButton=this.__saveButton||Ext.ComponentQuery.query("#saveButton")[0],this.__quickSaveButton=this.__quickSaveButton||Ext.ComponentQuery.query("#quickSaveButton")[0],this.__cancelButton=this.__cancelButton||Ext.ComponentQuery.query("#cancelButton")[0],this.__cancelButton&&this.__cancelButton.setDisabled(!1),this.__saveButton&&this.__saveButton.setDisabled(!1),this.__quickSaveButton&&this.__quickSaveButton.setDisabled(!1)},__deleteAttachments:function(e){if(e){var t=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DELETE_ATTACHMENTS",this,{request:{deliveryEngine:this.getDeliveryEngine(),recordId:this.getDeliveryEngine().getRecordId(),data:e},responder:o.create("com.servicemax.client.sfmdelivery.responders.CancelAttachmentsResponder",this)});this.getDeliveryEngine().getEventBus().triggerEvent(t)}},__triggerSaveRecordEvent:function(e,t,n){var i=this.getDeliveryEngine(),a=i.getEventBus(),r=void 0;this.blockApplication(),r=o.create("com.servicemax.client.lib.api.Event",this._getSaveRecordEventName(),this,{request:{data:i.getTargetData().getData(),sourceRecordId:i.getSourceRecordId(),metadata:i.getPageMetaData().getRawPageMetaData(),deliveryEngine:i,additionalInfo:this._getSaveRecordAdditionalInfo(e,n),fieldValidatioConfirmed:this.fieldValidationConfirmed||!1},responder:o.create(t,this,"",n)}),a.triggerEvent(r)},_getSaveRecordEventName:function(){return"SFMDELIVERY.SAVE_TARGETRECORD"},_getSaveRecordAdditionalInfo:function(e,t){return{processId:this.getDeliveryEngine().processId,eventType:e,toModelOnly:t&&t.toModelOnly,returnWarningsWithErrors:!0,trackLocation:t&&t.trackLocation,locationDetails:t&&t.locationDetails,newChecklist:t&&t.newChecklist}},customAction:function(e){v.info("Performing Custom Action");var t=this.getDeliveryEngine(),n=t.getEventBus(),i=void 0;this.blockApplication(),i=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:e.events,data:t.getTargetData().getData(),metadata:t.getPageMetaData().getRawPageMetaData(),deliveryEngine:t,additionalInfo:{processId:t.processId,nextStepId:t.nextStepId},invokedFrom:"Button"},responder:o.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)}),n.triggerEvent(i)},onInvokeEventsComplete:function(){this.unblockApplication()},onInvokeCustomEventsComplete:function(e){var t="",n={};"success"!=e.status?(v.error("Validation_Error for custom snippet : ",e.error_message),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",n.error_msg=e.error_message):(console.log("Response from snippet: No errors found"),t="SFMDELIVERY.CUSTOMSNIPPET.SNIPPETSUCCESS");var i=o.getCurrentApplication().getCurrentView().getDeliveryEngine().getEventBus(),a=o.create("com.servicemax.client.lib.api.Event",t,this,{request:n,responder:{}});i.triggerEvent(a),this.unblockApplication()},_needTriggerAddRecentsEvent:!0,onSaveTargetRecordComplete:function(e){v.info("Save action completed"),this.__doSaveComplete(e,!0),this._needTriggerAddRecentsEvent&&this._triggerAddRecentsEvent(e),o.getClient().getApplicationParameter("enable-sfm-profiling-logs")&&window.saveStart&&(console.log("Time taken for save:"+(performance.now()-window.saveStart)),delete window.saveStart)},_triggerAddRecentsEvent:function(e){var t=void 0,n=void 0,i=void 0,a=void 0,r=void 0;r=e.data.data.Id;var s=e.data.processType;t=this.__isCreate&&!0===this.__isCreate.launchRecordInViewMode||"SOURCE TO TARGET ALL"===s||"STANDALONE CREATE"===s?"CREATE":"EDIT",n=m.getCurrentDatetimeGMT(m.getSaveFormat("dateTime")),i=f.getTableForId(r),a=f.getNameField(i);var l=o.create("com.servicemax.client.lib.api.Event","RECENTS.ADD_RECENTS",this,{request:{recordId:r,objectName:i,lastAccessed:n,nameField:a,type:t},responder:{result:function(){}}});o.getCurrentApplication().triggerEvent(l)},onQuickSaveTargetRecordComplete:function(e){v.info("Quick Save action completed "+new Date),this.__doSaveComplete(e,!1);var t=this.getDeliveryEngine().getEventBus();this.blockApplication();var n=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PAGEDATA",this,{request:{recordId:this.getDeliveryEngine().recordId,processId:this.getDeliveryEngine().processId,qualify:!0,objectNameMap:this.getDeliveryEngine().getObjectNameMap(),requesterId:this.getDeliveryEngine().getRootContainerId(),layout:this.getDeliveryEngine().__page.getData(),quickSave:!0},responder:o.create("com.servicemax.client.sfmdelivery.responders.GetPageDataResponder",this.getDeliveryEngine())});t.triggerEvent(n)},__doSaveComplete:function(e,t){if(this.unblockApplication(),e.error)return void this.getDeliveryEngine().showMessage({type:"ERROR",text:e.error});this.notifyDataChange();var n=this.getDeliveryEngine();if(n.getPageMetaData()&&n.getPageMetaData().getData()&&"SOURCE TO TARGET ALL"===n.getPageMetaData().getData().response.sfmProcessType&&this.notifySourceDataChange(),this.notifyChangesToProductIQ(e),t&&this.getDeliveryEngine().closeProcess(),t){if(e.additionalInfo&&e.additionalInfo.inPlaceNavigation)return void this.__reloadDataAndPerformInplaceNavigation(e);this.__doneCheckNavigationStack(e)}},notifyChangesToProductIQ:function(e){var t=void 0,n=void 0;if(e){var i=e.data;i&&(t=i.objectName,n=i.processType)}var a=this.getDeliveryEngine().recordId,r={recordId:a};t&&(r.objectName=t),n&&(r.processType=n);var s=o.getCurrentApplication(),l=s.findConsoleAppByAppId("productIQ"),c=l&&l.__controller&&l.__controller.__eventBus;if(c){var u=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DATA_SAVED",r);c.triggerEvent(u)}},__doneCheckNavigationStack:function(e){var t=this.getDeliveryEngine().getNavigationStack(),n=this.getDeliveryEngine().additionalInfo;"SFMDelivery"===this.__pageFrom&&e&&e.data&&"SOURCE TO TARGET ALL"===e.data.processType&&n&&void 0!==n.isLinkedSFM&&!0===n.isLinkedSFM&&t.length>0?this.__navigateBackward():"SFMDelivery"===this.__pageFrom&&e&&e.data&&"SOURCE TO TARGET ALL"===e.data.processType?this.__navigateToTarget():t.length>0?this.__navigateBackward():this.__additionalInfo&&!0===this.__additionalInfo.launchRecordInViewMode?(this.__additionalInfo=null,this.__navigateToTarget()):this.__additionalInfo&&this.__additionalInfo.calenderCreateEvent?this.done({refreshEvents:!0}):this.done()},__navigateToTarget:function(){var e=this,t=this.getDeliveryEngine().getRecordId(),n=o.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance(),i=n.createNavigation({recordId:t});i.done(function(e){}),i.fail(function(t){e.done()})},__navigateForward:function(e){var t=this;t.removeAll(),t.getDeliveryEngine().handleInplaceForwardNavigation(e.additionalInfo)},__navigateBackward:function(){var e=this;e.removeAll(),e.getDeliveryEngine().handleInplaceBackwardNavigation()},__reloadDataAndPerformInplaceNavigation:function(e){var t=this.getDeliveryEngine().getEventBus();this.blockApplication();var n=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PAGEDATA",this,{request:{recordId:this.getDeliveryEngine().recordId,processId:this.getDeliveryEngine().processId,qualify:!0,objectNameMap:this.getDeliveryEngine().getObjectNameMap(),requesterId:this.getDeliveryEngine().getRootContainerId(),layout:this.getDeliveryEngine().__page.getData()},responder:o.create("com.servicemax.client.sfmdelivery.responders.ReloadPageDataAndNavigateResponder",this,e)});t.triggerEvent(n),v.info("Reloading the data before performing inplace navigation")},onReloadPageDataAndNavigateCompleted:function(e,t){var n=this;this.getDeliveryEngine().getPageMetaData().getDataModel().setData(e,!0),setTimeout(function(){n.__navigateForward(t)},50)},deleteRecord:function(e,t,n){o.Msg.confirm({title:p().T("FSA008_TAG083","Remove"),text:p().T("FSA008_TAG027","Are you sure you want to delete this record? (Save still needed to commit these changes)"),buttons:[{text:p().T("FSA016_TAG002","No"),itemId:"NO",ui:"svmx-button-square"},{text:p().T("FSA016_TAG001","Yes"),itemId:"YES",ui:"svmx-button-square"}]}).then(o.proxy(this,function(i){if("YES"==i){var a=n&&n.getData(),r=a&&a.Id;this.deleteRecordAndUpdate(e,t,r)}}))},deleteRecordAndUpdate:function(e,t,n){var i=this.getDeliveryEngine().getTargetData().getData(),a=this.getDeliveryEngine().getEventBus(),r=void 0;r=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DELETE_RECORDS",this,{request:{alias:e,data:i,records:[{rowIndex:t,recordId:n}]},responder:o.create("com.servicemax.client.sfmdelivery.responders.DeleteRecordsResponder",this)}),a.triggerEvent(r)},onDeleteRecordsComplete:function(e){},notifyDataChange:function(){var e=this.getDeliveryEngine(),t=e.getTargetData(),n=t.getData().__data.sfmData,i=[n];o.forEachProperty(n.details,function(e,t){for(var n=0;n<t.lines.length;n++)i.push(t.lines[n])}),d.run(this,"com.servicemax.client.onDataChange",{type:"EDIT",engine:this.getDeliveryEngine(),changedData:i})},notifySourceDataChange:function(){var e=this.getDeliveryEngine(),t=e.getSourceRecordId();_.getRecord({Id:t,loadReferences:!0,convertPicklists:!0}).then(o.proxy(this,function(e){var t=[e];o.forEachProperty(e.details,function(e,n){for(var i=0;i<n.lines.length;i++)t.push(n.lines[i])}),d.run(this,"com.servicemax.client.onDataChange",{type:"EDIT",engine:this.getDeliveryEngine(),changedData:t})}))},errorCorrectionhandler:function(e,t){if(this.__deliverySections.scrollToItem(e),t&&t.additionalInfo&&t.additionalInfo.recordId&&e.onDetailRecordSelect){var n=t.additionalInfo,i=o.getClient().getApplicationParameter("sfm-delivery-max-childlines-per-page"),a=Math.ceil((n.recordIndex+1)/i),r=e.getStore();r.currentPage!=a&&r.loadPage(a);for(var s=void 0,l=void 0,c=r.data.items,u=0;u<c.length;u++)c[u].data.Id===n.recordId&&(s=u,l=c[u]);e.onDetailRecordSelect(l,s,{fieldName:n.fieldName}),this.issueIndicator.hide()}},addNew:function(e,t){var n=this;if(!n.__selected){n.__selected=!0;var i=t.multiAddSearchField;if(null==i)this.__addNewRecord(e,t);else{var a=t.getFieldInfo(i);this.showViewInDialog({view:"multilookup",options:{currentLookupField:a,addSingleLineHandlerCallback:o.proxy(this,this.__addNewRecord,e,t),addMultpleNewHandlerCallback:o.proxy(this,this.__addMultipleNew,e,t)}})}}},__addNewRecord:function(e,t){t.addNew(e)},__addMultipleNew:function(e,t,n,i){t.addMultipleNew(e,n,i)},copyDetailRecord:function(e,t,n){this.getDeliveryEngine().getMetaModel().getChildNode("details").getDetail("details."+e).copyDetailRecord(e,t,n)},blockApplication:function(e){this.__disableSaveButton(),this.callParent()},unblockApplication:function(){this.__enableSaveButton(),this.callParent()},invokeCustomSnippet:function(e,t){var n=o.getCurrentApplication().getCurrentView().getDeliveryEngine();if(t){for(var i=n.getMetaModel(),a=i&&i.getDetailMetaModel(),r=a&&a._children&&a._children.details,s="",l=void 0,c=0;c<r.length;c++)if(r[c].layoutId===t){if(l=r[c].__allColumnDataBindingsHash,i.getDataModel()&&i.getDataModel().__data&&i.getDataModel().__data.__data&&i.getDataModel().__data.__data.sfmData&&i.getDataModel().__data.__data.sfmData&&i.getDataModel().__data.__data.sfmData.details){var d=i.getDataModel().__data.__data.sfmData.details[t]&&i.getDataModel().__data.__data.sfmData.details[t].lines;if(d){var _=d[d.length-1];s=_.Id}}break}var h={};if(l)for(var f in l)l[f].getValue&&"function"==typeof l[f].getValue&&(h[f]=l[f].getValue());else{var p=i.getDataModel(),m=p&&p.__allBindingsHash;if(m){for(var v in m)h[v]=m[v].getValue();s=p.__data&&p.__data.__data&&p.__data.__data.sfmData&&p.__data.__data.sfmData.Id}}s.length>0&&(h.Id=s),u.registerJSCache("customSnippet","currentRecord"),u.writeToJSCache("customSnippet","currentRecord",h)}var g=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.INVOKE_EVENTS",this,{request:{events:[e],data:n.getTargetData().getData(),metadata:n.getPageMetaData().getRawPageMetaData(),deliveryEngine:n,additionalInfo:{processId:n.processId,nextStepId:n.nextStepId},invokedFrom:"Field"},responder:o.create("com.servicemax.client.sfmdelivery.responders.InvokeEventsResponder",this)});o.getCurrentApplication().triggerEvent(g)},statics:{confirmCancel:function(){return o.Msg.confirm({title:p().T("FSA008_TAG084","Discard Changes?"),text:p().T("FSA008_TAG085","You have unsaved changes. Do you wish to discard the changes or continue editing?"),buttons:[{text:p().T("FSA008_TAG086","Continue Editing"),cls:"svmx-msg-button-default",itemId:"CONTINUE"},{text:p().T("FSA008_TAG087","Discard Changes"),cls:"svmx-msg-button",itemId:"DISCARD"}]})}}});var y=h.EditView;Ext.define(h.name+".EditDetailsView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.editdetails",config:{dataModel:null,localData:null,sectionModel:null,store:null,recordId:"",isNew:!1,allowDelete:!0,cls:["sfm-delivery-editdetails","sfm-process-edit"]},layout:"auto",width:"100%",updateOptions:function(e){var t=this.getOption("detailId"),n=this.getOption("rowIndex"),i=this.getOption("detailStore"),a=i[n];this.setRecordId(a.get("Id")),this.setIsNew(a.data.__new),this.setDataModel(a);var r=this.getDeliveryEngine().getMetaModel(),s=r.getChildNode("details"),l=s.getDetail("details."+t);this.setSectionModel(l),this.setAllowDelete(l.allowDeleteLines),this.setStore(a),this.additionalInfo=e.additionalInfo,Ext.Viewport.onAfter("resize",o.proxy(this,this.__doResize));var c=(a.getData(),o.getCurrentApplication()),u=c&&c.getCurrentView();u&&u.getDeliveryEngine()},__doResize:function(){var e=this;if(e.__detailsPanel&&e.__toolbar&&e.__toolbar.element){var t=e.__toolbar.element.getHeight();t<=0&&(t=44),e.__detailsPanel.setMaxHeight(.8*Ext.Viewport.element.getHeight()-t)}},ready:function(){var e=this.getDeliveryEngine().getEventBus();this.bind(e,"SFMDELIVERY.CUSTOMSNIPPET.SNIPPETERROR",this.onSnippetError,this),this.bind(e,"SFMDELIVERY.CUSTOMSNIPPET.SNIPPETSUCCESS",this.onSnippetSuccess,this);var t=this.getSectionModel();t.recordId=this.getRecordId();var n=Ext.String.htmlEncode(this.getSectionModel().title);this.add({xtype:"svmx.toolbar",itemId:"toolbar",title:n,docked:"top",items:[{xtype:"svmx.button",itemId:"toolbar-done-button",ui:"svmx-toolbar-btn",html:p().T("FSA016_TAG004","Cancel"),handler:o.proxy(this,"cancel",!0),align:"right"},{xtype:"spacer"},{xtype:"svmx.button",itemId:"toolbar-done-button",ui:"svmx-toolbar-btn",html:p().T("FSA008_TAG028","Done"),handler:o.proxy(this,"update",!0),align:"right"}]}),this.__toolbar=this.query("#toolbar")[0],this.__doneButton=this.query("#toolbar-done-button")[0];var i=[];t.allowNewLines&&(i.push({xtype:"svmx.button",itemId:"copydetailline",ui:"svmx-toolbar-btn",html:p().T("FSA008_TAG145","Copy"),handler:o.proxy(this,"doNextPrev","Copy"),align:"left"}),i.push({xtype:"spacer"}),i.unshift({xtype:"svmx.button",itemId:"newbtn",ui:"svmx-toolbar-btn",html:p().T("FSA008_TAG031","+ New"),handler:o.proxy(this,"doNextPrev","AddNew"),align:"left"})),this.add({xtype:"svmx.toolbar",itemId:"newcopytoolbar",docked:"top",cls:"sfm-delivery-ext-edit-prevnext-toolbar",items:i}),this.issueIndicator=o.create(h.name+".IssueIndicator",{width:"100%",docked:"top"}),this.add(this.issueIndicator);var a=[{xtype:"svmx.verticalpanel",itemId:"detailsContainer",halign:"full",valign:"full",width:"100%",height:"auto",items:[{xtype:"sfm.delivery.sectiondetails",width:"100%",scrollable:"vertical",itemId:"details",readOnly:!1,view:this}]}];if(this.add(a),this.add({xtype:"svmx.panel",width:"100%",height:"20px",items:[]}),this.add({xtype:"svmx.toolbar",itemId:"bottomToolbar",cls:"sfm-delivery-editdetails-toolbar",docked:"bottom",items:[{xtype:"svmx.button",itemId:"prevbtn",ui:"svmx-toolbar-btn",iconCls:"fa fa-long-arrow-up",html:p().T("FSA008_TAG029","Previous"),handler:o.proxy(this,"doNextPrev","Previous"),align:"left"},{xtype:"spacer"},{xtype:"svmx.button",hidden:this.getIsNew()||!this.getAllowDelete(),html:p().T("FSA008_TAG026","Remove Item"),handler:o.proxy(this,"removeItem"),itemId:"removebtn"},{xtype:"spacer"},{xtype:"svmx.button",itemId:"nextbtn",ui:"svmx-toolbar-btn",iconCls:"fa fa-long-arrow-down",iconAlign:"right",html:p().T("FSA008_TAG030","Next"),handler:o.proxy(this,"doNextPrev","Next"),align:"right"}]}),this.__prevbtn=this.query("#prevbtn")[0],this.__nextbtn=this.query("#nextbtn")[0],this.__newButton=this.query("#newbtn")[0],this.__removeButton=this.query("#removebtn")[0],this.__disablePrevBtn(),this.__disableNextBtn(),this.__bottomToolbar=this.query("#bottomToolbar")[0],this.__detailsPanel=this.query("#details")[0],this.__detailsContainer=this.query("#detailsContainer")[0],t.setExtendedEditRowBindingContext(this.getStore()),this.__detailsPanel.setModel(t),t.executeBindings(),this.setViewInfo({windowTitle:n,disableNavMenu:!0,hideContextMenu:!0}),this.__doResize(),this.additionalInfo&&this.additionalInfo.fieldName){var r=this.additionalInfo.fieldName,s=this.__detailsPanel.items.items[0].items.items.filter(function(e){return e._itemId==="field_"+r});if(s&&1===s.length){var l=s[0];o.doLater(function(){l.scrollIntoView?l.scrollIntoView():l.focus&&l.focus()})}}},onSnippetError:function(e){if(e.data.request&&e.data.request.error_msg){var t=this,n=[{message:e.data.request.error_msg,errorCorrectionhandler:function(){t.scrollIntoView()}}];this.issueIndicator.setIssues({errors:n,warnings:[]},!0),this.issueIndicator.showIssues(),this.__doneButton&&this.__doneButton.disable(),this.__newButton&&this.__newButton.disable(),this.__nextbtn&&this.__nextbtn.disable(),this.__prevbtn&&this.__prevbtn.disable()}},onSnippetSuccess:function(){this.issueIndicator.hide(),this.__doneButton&&this.__doneButton.enable(),this.__newButton&&this.__newButton.enable(),this.__disableNextBtn(),this.__disablePrevBtn()},restore:function(e){if(e){var t=e.viewOptions,n=e.data,i=void 0;switch(e.viewId){case"lookup":var a=this.currentLookupField;i=this.getSectionModel().__allColumnDataBindingsHash[a.fieldName];var r,o=(this.getDeliveryEngine().getTargetData(),a.getLookupModel());if(o){r=n[o.getDefaultColumnName()]}null!==r&&void 0!==r||(r=n[a.nameFieldName]),i.setValue({key:n.Id,value:r}),this.executeFieldMappings(a,n);break;case"edittext":i=this.getSectionModel().__allColumnDataBindingsHash[t.fieldName],i.setValue(n)}}},onAddRecordsComplete:function(e,t){e>1||this.__performAction("NextAfterAddNew",t)},onCopyRecordsComplete:function(e,t){this.onAddRecordsComplete(e,t)},doNextPrev:function(e){var t=this;u.readObjectFromDBCache("SHOW_EXT_EDIT_ADDNEXTPREV_CONFIRM").then(function(n){if(n&&"true"!=n)t.update(!1,e);else{var i=!1;o.Msg.alert({title:null,itemId:"extEditNxtPrevMsgAlert",text:"",items:[{xtype:"svmx.label",text:p().T("FSA008_TAG032","Changing line items will preserve any updates")},{xtype:"svmx.field.checkbox",cls:"sfm-delivery-ext-edit-prevnext-msg-confirm",labelAlign:"right",label:p().T("FSA008_TAG025","Don't show this again"),checked:i,listeners:{check:o.proxy(this,function(e,t){i=e._checked})}}],buttons:[{text:p().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"svmx-button-square"},{text:p().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square-highlight"}]}).then(function(n){"OK"==n&&(u.writeToDBCache("SHOW_EXT_EDIT_ADDNEXTPREV_CONFIRM",!i),t.update(!1,e))})}})},__performAction:function(e,t){var n=this.getOption("rowIndex"),i=this.getOption("recordId");if("NextAfterAddNew"==e&&void 0!==t)for(var a=t[0].sobjectinfo.Id,r=this.getOption("detailStore"),o=0;o<r.length;o++)r[o].raw.Id==a&&(n=o,i=a);if("AddNew"==e)this.__hideBottomToolbar(),this.getSectionModel().addNew(this);else if("Copy"===e){var s={},l=this.getOption("detailStore"),c=this.getOption("rowIndex");l&&l.length>=c&&(s=l[c]),this.__hideBottomToolbar(),this.getSectionModel().copyDetailRecord(this.getOption("detailId"),s,this)}else{"Next"==e?(this.__showBottomToolbar(),n=this.__goToNext(n)):"Previous"==e&&(this.__showBottomToolbar(),n=this.__goToPrevious(n));var u={detailId:this.getOption("detailId"),recordId:i,rowIndex:n,detailStore:this.getOption("detailStore")};this.setOptions(u),this.__refreshView()}},__goToNext:function(e){if(e<this.getOption("detailStore").length-1)e++;else if(!this.__isLastPage()){var t=this.__getGridStore();t.nextPage(),e=0}return e},__goToPrevious:function(e){if(0!==e)e--;else if(!this.__isFirstPage()){var t=this.__getGridStore();t.previousPage(),e=t.pageSize-1}return e},__refreshView:function(){this.__disablePrevBtn(),this.__disableNextBtn();var e=this.getSectionModel();e.setExtendedEditRowBindingContext(this.getStore()),e.executeBindings()},__showBottomToolbar:function(){this.__removeButton&&this.__removeButton.setHidden(!1)},__hideBottomToolbar:function(){this.__removeButton&&this.__removeButton.setHidden(!0)},__disablePrevBtn:function(){0==this.getOption("rowIndex")&&this.__isFirstPage()?this.__prevbtn.setDisabled(!0):this.__prevbtn.setDisabled(!1)},__disableNextBtn:function(){this.getOption("rowIndex")==this.getOption("detailStore").length-1&&this.__isLastPage()?this.__nextbtn.setDisabled(!0):this.__nextbtn.setDisabled(!1)},__getGridStore:function(){return this.getStore().store},__isLastPage:function(){var e=!0,t=this.__getGridStore();return t.currentPage<t.totalPages&&(e=!1),e},__isFirstPage:function(){var e=!1;return 1===this.__getGridStore().currentPage&&(e=!0),e},executeFieldMappings:function(e,t){for(var n=e;!n.executeFieldMappings;)n=n._parent;n.executeFieldMappings&&n.executeFieldMappings(e,t)},removeItem:function(){o.Msg.confirm({text:p().T("FSA008_TAG034","Remove this item?"),buttons:[{text:p().T("FSA016_TAG002","No"),itemId:"NO",ui:"svmx-button-square"},{text:p().T("FSA016_TAG001","Yes"),itemId:"YES",ui:"svmx-button-square"}]}).then(o.proxy(this,function(e){"YES"==e&&this.deleteRecord()}))},deleteRecord:function(){var e=o.string.substitute(p().T("FSA008_TAG035"," Changes to this item won't be effective until you select Save on the {{processTitle}} screen"),{processTitle:this.getDeliveryEngine().getMetaModel().getData().processTitle}),t=this;u.readObjectFromDBCache("SHOW_EXT_EDIT_REMOVE_ITEM_CONFIRM").then(function(n){if(n&&"true"!=n)t.deleteRecordAndUpdate();else{var i=!1;o.Msg.alert({title:null,itemId:"removeItemConfirm",text:"",items:[{xtype:"svmx.label",text:e},{xtype:"svmx.field.checkbox",cls:"sfm-delivery-ext-edit-remove-item-msg-confirm",labelAlign:"right",label:p().T("FSA008_TAG025","Don't show this again"),checked:i,listeners:{check:o.proxy(this,function(e,t){i=e._checked})}}],buttons:[{text:p().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square-highlight"}]}).then(function(e){"OK"==e&&(u.writeToDBCache("SHOW_EXT_EDIT_REMOVE_ITEM_CONFIRM",!i),t.deleteRecordAndUpdate())})}})},deleteRecordAndUpdate:function(){var e=this.getDeliveryEngine().getTargetData().getData(),t=this.getRecordId(),n=this.getOption("rowIndex"),i=this.getDeliveryEngine().getEventBus(),a=void 0;a=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DELETE_RECORDS",this,{request:{alias:this.getOption("detailId"),data:e,records:[{rowIndex:n,recordId:t}]},responder:o.create("com.servicemax.client.sfmdelivery.responders.DeleteRecordsResponder",this)}),i.triggerEvent(a)},onDeleteRecordsComplete:function(e){this.done()},cancel:function(){y.confirmCancel().then(o.proxy(this,function(e){if("DISCARD"==e){this.getIsNew()?this.deleteRecordAndUpdate():this.done();var t=o.getCurrentApplication(),n=t&&t.getCurrentView();n&&n.getDeliveryEngine();u.removeFromJSCache("customSnippet","currentRecord"),this.__rootView&&this.__rootView.issueIndicator&&this.__rootView.issueIndicator.hide&&this.__rootView.issueIndicator.isCustomeSnippetError&&this.__rootView.issueIndicator.isCustomeSnippetError()&&this.__rootView.issueIndicator.hide()}}))},handleHardwareBack:function(){return this.callParent()||this.cancel(),!0},resetCustomSnippetCacheValues:function(){var e=o.getCurrentApplication(),t=e&&e.getCurrentView();t&&t.getDeliveryEngine();u.removeFromJSCache("customSnippet","currentRecord")},update:function(e,t){this.issueIndicator&&this.issueIndicator.hide();var n=this.getSectionModel().validateFields();if(n.length)o.array.forEach(n,function(e){v.error(e.message)}),this.issueIndicator.setIssues({errors:n,warnings:[]}),this.issueIndicator.show();else{this.getSectionModel().__allColumnDataBindings[0].__validator.handler.call(this.getSectionModel().__allColumnDataBindings[0].__validator.context);var i=this.getStore(),a=!1;i.raw&&((i.data.__new||i.data.__copy)&&(a=!0),delete i.data.__new,delete i.data.__copy);this.getDataModel();this.getSectionModel().extendedEditPersistBindings(),e?(this.resetCustomSnippetCacheValues(),this.done(),this.triggerRecordSaved()):!e&&t&&(this.resetCustomSnippetCacheValues(),this.__performAction(t)),a&&this.__rootView&&this.__rootView.updateIsBillable()}},triggerRecordSaved:function(){var e=o.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.RECORD_SAVED");this.getDeliveryEngine().getEventBus().triggerEvent(e)},getDialogConfig:function(){return{height:"auto",layout:{type:"auto"},hideOnMaskTap:!0,maskTapHandler:o.proxy(this,this.cancel)}}}),Ext.define(h.name+".TextView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.texteditview",config:{title:"",text:"",cls:["sfm-process-edit"],scrollModifier:6.5},ready:function(){var e=[{xtype:"svmx.verticalpanel",itemId:"editorPanel",flex:1,width:"100%",height:"100%",items:[{xtype:"svmx.field.textarea",value:this.getOption("text"),enableBarcode:o.getClient().isBarCodeEnabled(),alwaysShowBarcode:!0,itemId:"editor",width:"100%",height:"100%",maxLength:this.getOption("maxLength"),flex:1,isBarCodeAppendEnabled:this.getOption("isBarCodeAppendEnabled")}]},{xtype:"svmx.toolbar",width:"100%",docked:"top",ui:"svmx-toolbar-grey",title:this.getOption("title"),items:[{docked:"right",xtype:"svmx.button",html:p().T("FSA008_TAG088","Update"),handler:o.proxy(this,"update"),ui:"svmx-toolbar-btn",itemId:"textSaveButton"},{docked:"left",xtype:"svmx.button",html:p().T("FSA016_TAG004","Cancel"),handler:o.proxy(this,"cancel"),ui:"svmx-toolbar-btn",itemId:"textCancelButton"}]}];this.add(e),this.editor=this.query("#editor")[0],this.textArea=this.editor.element.down("textarea"),Ext.isiOS&&this.editor.addCls("sfm-text-view-textarea-ios"),this.editorPanel=this.query("#editorPanel")[0],this.editorPanel.on("painted",this.onEditorPanelPainted,this),this.editorPanel.element.on("drag",this.onTouchMove,this),this.setViewInfo({windowTitle:this.getOption("title"),disableNavMenu:!0,hideContextMenu:!0})},onEditorPanelPainted:function(){this.editor.setHeight(this.editorPanel.getHeight()),this.editor.setWidth(this.editorPanel.getWidth())},onTouchMove:function(e){this.textArea.dom.scrollTop-=e.deltaY/this.getScrollModifier()},update:function(){this.__setScrollerActualOffset(),this.done(this.editor.getValue())},cancel:function(){y.confirmCancel().then(o.proxy(this,function(e){"DISCARD"==e&&(this.done(),this.__setScrollerActualOffset())}))},handleHardwareBack:function(){return this.callParent()||this.cancel(),!0},getDialogConfig:function(){return{hideOnMaskTap:!0,maskTapHandler:o.proxy(this,this.cancel)}},__setScrollerActualOffset:function(){var e=this.getOptions().parentScroller,t=this.getOptions().scrollerOffsetValue;if("IPAD"===o.getClientTypeForUnifiedApp()&&e){var n=e.getScrollable();if(n){var i=n.getElement();i&&(i.el.dom.scrollTop=t)}}}}),Ext.define(h.name+".IssueIndicator",{extend:g.name+".SVMXLabel",alias:"widget.sfm.delivery.issueindicator",config:{cls:"sfm-sfmdelivery-issue-label",hidden:!0,issueIndicatorItemType:"sfm.delivery.issueindicatoritem",showAnimation:{type:"fadeIn"}},initialize:function(){this.__issues={},this.__issueCount=0,this.__issueConfirmations={},this.__issueSectionIndex,this.callParent(),this.addListener("tap",this.__onTap,this,{element:"element"})},setIssues:function(e,t){e&&(this.__issues=e,this.__issueCount=0,this.__issueSectionIndex=null,this.populateIssueItems(t),this.__isCustomSnippet=t)},isCustomeSnippetError:function(){return this.__isCustomSnippet},showIssues:function(e){this.show()},populateIssueItems:function(e){var t=this;this.__issuePanel&&this.__issuePanel.destroy();var n=[],i=[],a=this.__issueConfirmations||{};this.__checklistEditView=!1,n.push({xtype:"svmx.button",itemId:"firstItem",transparent:!0,width:"100%",border:0,cls:"sfm-sfmdelivery-issue-panel-firstitem",handler:o.proxy(this,function(){this.__issuePanel.hide()})}),e||n.push({xtype:"svmx.panel",html:p().T("FSA008_TAG036","Tap/Click on issue to see it on form"),cls:"sfm-sfmdelivery-issue-item-text"});var r=this;o.array.forEach(this.__issues.errors,function(e){e.checklist&&(t.__checklistEditView=!0),i.push(r.__getErrorIssueItemConfig(e)),r.__issueCount++}),o.array.forEach(this.__issues.warnings,function(e){a[e.message]=r.__issueConfirmations[e.message]||!1,e.checklist&&(t.__checklistEditView=!0),i.push(r.__getWarningIssueItemConfig(e,a)),r.__issueCount++}),n=this.groupIssueListItem(i,n);var s;for(s in a)void 0===this.__issueConfirmations[s]&&(this.__issueConfirmations[s]=a[s]);for(s in this.__issueConfirmations)void 0===a[s]&&delete this.__issueConfirmations[s];this.__issuePanel=Ext.create({modal:!0,xtype:"svmx.panel",itemId:"issuePanel",hideOnMaskTap:!0,scrollable:!0,left:0,width:"80%",cls:"sfm-sfmdelivery-issue-panel",layout:"fit",items:n,collapsed:!0,collapsible:!0,listeners:{show:function(){}}});var s="";s=1==this.__issueCount?p().T("FSA008_TAG037","Issue Found"):p().T("FSA008_TAG038","Issues Found");var l=o.string.substitute("{{count}} {{message}}",{count:this.__issueCount,message:s});this.setHtml(l),this.__issuePanel.getItems().items[0].setText(l)},groupIssueListItem:function(e,t){var n=e;this.__checklistEditView&&(n=e.sort(function(e,t){return e.sequence-t.sequence}));for(var i=0;i<n.length;i++)this.__checklistEditView&&this.__issueSectionIndex!==n[i].sectionIndex&&(t.push({xtype:"svmx.panel",html:n[i].sectionTitle,cls:"sfm-delivery-issue-item-section-title"}),this.__issueSectionIndex=n[i].sectionIndex),t.push(n[i]);return t},_getIssueItemConfig:function(e,t){var n=this;return{xtype:n.getIssueIndicatorItemType(),handler:n,issueType:e,message:t.message,issueHandler:o.proxy(n,n.issueHandlerWrap,t.errorCorrectionhandler,t)}},__getErrorIssueItemConfig:function(e){return this._getIssueItemConfig("error",e)},__getWarningIssueItemConfig:function(e,t){var n=this._getIssueItemConfig("warning",e);return n.confirmed=t[e.message],n},issueHandlerWrap:function(e,t){var n=this;e&&(n.__issuePanel.hide(),e(t))},confirmWarning:function(e,t){this.__issueConfirmations[e]=t},hasUnconfirmedIssues:function(){var e=!0;for(var t in this.__issueConfirmations)this.__issueConfirmations[t]||(e=!1);return!e},__onTap:function(e){this.__issuePanel.showBy(this,"tc-tc")}}),Ext.define(h.name+".IssueIndicatorItem",{extend:g.name+".SVMXContainer",alias:"widget.sfm.delivery.issueindicatoritem",config:{handler:null,issueHandler:null},cls:"sfm-sfmdelivery-issue-item",width:"100%",padding:10,layout:"hbox",initialize:function(){this.callParent();var e=[this._getButtonConfig()];if("warning"===this.config.issueType){var t=this.config.handler,n=this.config.message;e.push({xtype:"svmx.field.checkbox",cls:"sfm-sfmdelivery-issue-item-span",align:"right",labelWidth:"89%",checked:this.config.confirmed,listeners:{check:function(){t.confirmWarning(n,!0)},uncheck:function(){t.confirmWarning(n,!1)}}})}this.add(e)},_getButtonConfig:function(){var e=this;return{xtype:"svmx.button",cls:"sfm-sfmdelivery-issue-item-icon-"+this.config.issueType,flex:4,html:this.config.message,listeners:{tap:{fn:function(t,n){n.stopEvent(),e.config.issueHandler.apply()}}}}}}),o.defineGlobal(h.name,h),e.exports=h},function(e,t,n){var i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=n(24).navigation,s=n(11).Facade,l=n(7).Cache,c=n(102).Facade,u={name:"com.servicemax.client.sfmdelivery.ui.largemodern.checklistview"},d=r.getLoggingService().getLogger("sfmdelivery.ui.editview"),_=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};Ext.define(u.name+".CheckListEditView",{extend:"com.servicemax.client.sfmdelivery.ui.largemodern.editview.EditView",alias:"widget.sfm.delivery.checklisteditview",__selected:null,__additionalInfo:null,__isCreate:null,config:{pageModel:null,dataModel:null,halign:"full",cls:["sfm-process-edit"]},height:"100%",layout:{type:"vbox",align:"middle",pack:"full"},onShow:function(){this.__selected=!1,d.info("CheckList Edit View showing"),this.getDeliveryEngine().blockSyncPopUp()},onHide:function(){d.info("CheckList Edit View hiding"),this.getDeliveryEngine().allowSyncPopUp()},doDestroy:function(){this.__businessRuleValidator.doCleanup(),this.callParent()},updateOptions:function(e){this.callParent(arguments),this.__businessRuleValidator=r.create("com.servicemax.client.sfmbizrules.impl.BusinessRuleValidator"),this.bind(r.getCurrentApplication().getSyncImpl(),"SYNC_COMPLETED_IMPL",this.__onSyncCompleted,this);var t=this.getDeliveryEngine().getEventBus();this.bind(t,"SFMDELIVERY.CHECKLIST_VALIDATION_SUCCESS",this.onChecklistValidationSuccess,this)},__onSyncCompleted:function(e){this.__syncManager=r.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance();var t=this.__syncManager.getState("MAP_REMOTE_IDS"),n=this.getDeliveryEngine().recordId;t&&t[n]&&n.indexOf("_local")>0&&(this.getDeliveryEngine().recordId=t[n])},_getLeftButtonText:function(){return"< "+(r.getCurrentApplication().getRoot()._getPriorStateBackText()||_().T("FSA002_TAG007","Back"))},_needConfirmCancel:function(){return!this.getPageModel().isDisplayOnly},cancel:function(){(this._needConfirmCancel()?this.confirmCancel():r.Deferred().resolve("DISCARD")).then(r.proxy(this,function(e){"DISCARD"==e?(this.__additionalInfo=null,this.__quickSaveCalled&&this.notifyDataChange(),this.__doneCheckNavigationStack()):"SAVE"==e&&this.saveNoValidation()}))},confirmCancel:function(){return r.Msg.confirm({title:_().T("FSA002_TAG008","Save Changes?"),text:_().T("FSA002_TAG009","Tap Save to keep changes so you can work on this checklist later. Tap Discard Changes to lose changes."),buttons:[{text:_().T("FSA002_TAG019","Discard Changes"),cls:"svmx-msg-button",itemId:"DISCARD",flex:1},{text:_().T("FSA002_TAG020","Save"),cls:"svmx-msg-button-default",itemId:"SAVE",flex:1}]})},getRightButton:function(){var e=this,t=this._deliveryEngine&&this._deliveryEngine.getPageMetaData()&&this._deliveryEngine.getPageMetaData().__getEntryExitCriteriaBusinessRule("Checklist_Section_Exit_Criteria")||[];return{xtype:"svmx.button",html:_().T("FSA002_TAG021","Submit"),ui:"svmx-button-square svmx-save-btn",cls:"sfm-checklist-completed-btn",itemId:"checklistToolbarSubmitButton",disabled:t.length>0&&!0||!1,listeners:{tap:{fn:function(t,n){e.doSubmitCheckList()},scope:e,buffer:500}},hidden:this.getPageModel().isDisplayOnly}},getSubmitButton:function(){var e=this;return{xtype:"svmx.button",html:_().T("FSA002_TAG021","Submit"),cls:"sfm-checklistsection-submit-btn",itemId:"submitButton",listeners:{tap:{fn:function(t,n){e.doSubmitCheckList()},scope:e,buffer:500}},hidden:this.getPageModel().isDisplayOnly}},__enableSubmit:function(){r.getCurrentApplication().hideSpinner(),this.__submitButton=this.__submitButton||Ext.ComponentQuery.query("#submitButton")[0],this.__toolBarSubmitButton=this.__toolBarSubmitButton||Ext.ComponentQuery.query("#checklistToolbarSubmitButton")[0],this.__submitButton&&this.__submitButton.setDisabled(!1),this.__toolBarSubmitButton&&this.__toolBarSubmitButton.setDisabled(!1)},__disableSubmit:function(){r.getCurrentApplication().showSpinner(),this.__submitButton=this.__submitButton||Ext.ComponentQuery.query("#submitButton")[0],this.__toolBarSubmitButton=this.__toolBarSubmitButton||Ext.ComponentQuery.query("#checklistToolbarSubmitButton")[0],this.__submitButton&&this.__submitButton.setDisabled(!0),this.__toolBarSubmitButton&&this.__toolBarSubmitButton.setDisabled(!0)},onChecklistValidationSuccess:function(e){this.__enableSubmit();var t=this,n=e&&e.target;r.Msg.confirm({title:_().T("FSA002_TAG038","Validation Successful"),text:_().T("FSA002_TAG040","Checklist will be uploaded and marked as completed. You will not be able to make further changes."),buttons:[{text:_().T("FSA016_TAG004","Cancel"),cls:"svmx-msg-button",flex:1},{text:_().T("FSA002_TAG021","Submit"),cls:"svmx-msg-button-default",flex:1,itemId:"SUBMIT"}]}).then(r.proxy(this,function(e){if("SUBMIT"==e){n.commands.__doSave(n.request,n.responder)}else t.unblockApplication()}))},launchHelpUrl:function(){var e=this.__deliverySections.__activeIndex,t=this.getPageModel().getChildNode("header").getChildNode("sections"),n=t[e]._data.sectionDetail[r.getCustomFieldName("SM_Help_URL")],i=s.createBrowserRequest();i.bind("REQUEST_ERROR",function(e){var t={text:_().T("FSA003_TAG005","The application does not exist. Please contact your system administrator to update the application path or install the necessary software."),type:"INFO"};r.getCurrentApplication().showMessage(t)},this),i.execute({link:n})},getSectionNavBarItems:function(e,t){var n=this,i=[];i.push({xtype:"svmx.button",text:_().T("FSA002_TAG010","Previous"),handler:r.proxy(this,"doPreviousSection"),cls:"svmx-prev-btn",iconCls:"icon-chevron-left",itemId:"prevButton",align:"left",iconAlign:"left",hidden:0==t});var a=e?e.length:0;this.getPageModel().isDisplayOnly;t<e.length&&(n.helpUrl=e[t]._data.sectionDetail[r.getCustomFieldName("SM_Help_URL")]);var o={xtype:"svmx.container",items:[{xtype:"svmx.label",html:"",cls:"svmx-label-checklist-total-question",itemId:"sectionToolbarQuestionNumberCount",hidden:!0},{xtype:"svmx.label",html:_().T("FSA002_TAG039","Answered"),cls:"svmx-label-checklist-question-status",itemId:"sectionToolbarQuestionStatus",hidden:!0}],width:"100%",scrollable:!1,layout:{type:"vbox",align:"center",pack:"center"},cls:"sfm-checklistsection-navbar-questionnumbers"};return i.push(o),i.push({xtype:"svmx.button",cls:"svmx-help-url",align:"right",itemId:"sectionHelpUrl",hidden:!n.helpUrl,listeners:{tap:{fn:function(){n.launchHelpUrl()},scope:n}}}),i},doNextSection:function(){this.__doSectionNavigation(!0)},doPreviousSection:function(){this.__doSectionNavigation(!1)},__doSectionNavigation:function(e){e&&this.__deliverySections.showNextItem(),this.getPageModel().isDisplayOnly||this.__deliverySections.__errorOnPage||this.quickSave()},updateSectionNavBar:function(){if(this.__sectionNavBarRendered){var e=this.getPageModel()&&this.getPageModel().getChildNode("header")&&this.getPageModel().getChildNode("header").getChildNode("sections")||[];e.length>0&&this.__activeSectionNavigationListIndex;this.__sectionNavBarTitle&&this.__sectionNavBarTitle.setHtml(this.__deliverySections.getActiveSectionTitle()),this.__sectionHelpUrl.setHidden(this.__deliverySections.showingSectionHelpUrl())}},createIssueIndicator:function(){this.issueIndicator=Ext.widget("sfm.delivery.checklistissueindicator",{}),this.add(this.issueIndicator)},createSectionContainer:function(e){var t=this;this.__mapBusinessRules(e);var n=this.getSectionModels(e);if(this._needConfirmCancel&&n&&0===n.length)return void this.__showNoQuestionsConfiguredMessage();this.__tappedNavigationIndex=-1,this.__onSectionEditAnsweredFields={};var i={xtype:"sfm.delivery.checklistsections",itemId:"deliverySections",view:this,readOnly:!1,width:"100%",height:"100%",cls:"sfm-delivery-sections sfm-delivery-section-edit",scrollable:!1,deliveryEngine:this.getDeliveryEngine(),model:e,listeners:{inputblur:function(e,n,i){t.__valueModified=!0,t.evaluateBusinessRules(i),this.__disableSubmitButton(),i._compositionMetamodel&&this._view&&this._view.__onSectionEditToolBarQuestionCount(i)},valueChanged:function(e){t.__valueModified=!0,t.evaluateBusinessRules(e),this.__disableSubmitButton(),e._compositionMetamodel&&this._view&&this._view.__onSectionEditToolBarQuestionCount(e),e.removeCls("sfm-question-container-invalid")},focus:function(e){t.__clearErrorWarnings(e)}}};this.getPageModel().isDisplayOnly||(i.submitButton=this.getSubmitButton());var a={xtype:"svmx.container",items:[this._getSectionNavBar(this.getSectionModels(e),this.getActiveSectionIndex(e))],width:"100%",scrollable:!1,layout:{pack:"center",align:"center"},cls:"sfm-checklistsection-navbar-container"},r={xtype:"svmx.container",itemId:"checklistSectionNavigationPanel",layout:"vbox",items:this.getSectionNavigationListItems(n),scrollable:"vertical",flex:1,cls:"svmx-checklist-section-list-navbar"},o={xtype:"svmx.container",layout:"vbox",items:[a,i],scrollable:"vertical",cls:"svmx-navcontainer-content",flex:4,itemId:"navcontainer"},s={xtype:"svmx.container",items:[r,o],layout:"hbox",height:"100%",width:"100%",cls:"sfm-checklistsection-container"};this.add(s),this.__deliverySections=this.query("#deliverySections")[0],this.__sectionNavBar=this.query("#sectionNavBar")[0],this.__sectionNavBarTitle=this.query("#sectionNavBarTitle")[0],this.__prevButton=this.query("#prevButton")[0],this.__sectionNavToolbarQuestionNumberElement=this.query("#sectionToolbarQuestionNumberCount")[0],this.__sectionToolbarQuestionStatus=this.query("#sectionToolbarQuestionStatus")[0],this.__sectionHelpUrl=this.query("#sectionHelpUrl")[0],this.__checklistSectionNavigationPanel=this.query("#checklistSectionNavigationPanel")[0],this.__initizeSectionContainer(e)},__clearErrorWarnings:function(e){var t=e.getComponent("x-textfield");t&&(t.removeCls("cheklist-warning-field"),t.removeCls("cheklist-error-field"));var n=e.parent&&e.parent.getComponent("errorPanel")&&e.parent.getComponent("errorPanel").getComponent("errorField");n&&(n.setHidden(!0),n.removeCls("cheklist-error-message"),n.removeCls("cheklist-warning-message"));var i=e.parent&&e.parent.getComponent("errorPanel")&&e.parent.getComponent("errorPanel").getComponent("warningConfirm");i&&i.setHidden(!0),e.removeCls("sfm-question-container-invalid")},__mapBusinessRules:function(e){if(e&&e._data&&e._data.page&&e._data.page.businessRules){var t=e._data.page.businessRules;this.mappedBusinessRules={};for(var n=0;n<t.length;n++){var i=t[n],a=i&&i.ruleInfo,o=a&&a.bizRuleDetails,s=a&&a.bizRule;if(s&&"Checklist_Section_Exit_Criteria"!==s[r.OrgNamespace+"__Rule_Type__c"]&&"Checklist_Section_Entry_Criteria"!==s[r.OrgNamespace+"__Rule_Type__c"]&&o&&o.length>0){var l=o[0][r.OrgNamespace+"__Field_Name__c"];l&&(this.mappedBusinessRules[l]=this.mappedBusinessRules[l]||[],this.mappedBusinessRules[l].push(i))}}}},__initizeSectionContainer:function(e){var t=e.getChildNode("header")&&e.getChildNode("header").getData()||{};this.__checklistSectionNavigationListItems=this.__checklistSectionNavigationPanel&&this.__checklistSectionNavigationPanel.items&&this.__checklistSectionNavigationPanel.items.items,this.__activeSectionNavigationListIndex=this.__deliverySections.getActiveIndex(),this.__checklistSectionView=this.__additionalInfo&&"VIEW"===this.__additionalInfo.specialProcessType?"VIEW":"EDIT",this.__topSectionNavigationListIndex=t.topSectionNavigationListIndex||("VIEW"===this.__checklistSectionView?this.__checklistSectionNavigationListItems.length:this.__activeSectionNavigationListIndex),this.__skippedSectionsQuestions=t.skippedSectionsQuestions||[],this.__getEnableDisableSectionNavigationList(this.__activeSectionNavigationListIndex,!0),this.__setActiveSectionNavigationListItem(this.__activeSectionNavigationListIndex,!0),this.__sectionNavBarRendered=!0,this.__topSectionNavigationIndex,this.__setValidationErrorCountOnSections(this.__activeSectionNavigationListIndex),this.updateSectionNavBar()},__getEnableDisableSectionNavigationList:function(e,t,n){var i=this.__activeSectionNavigationListIndex;if(!(e>this.__checklistSectionNavigationListItems.length)){var a=this.__checklistSectionNavigationListItems;if(t){this.__inProgressSections=this.getPageModel()&&this.getPageModel().getChildNode("header")&&this.getPageModel().getChildNode("header").getChildNode("sections")||[];for(var r=0;r<=this.__topSectionNavigationListIndex&&r<=a.length&&r<a.length;r++)a[r].setHidden(!1),"VIEW"!==this.__checklistSectionView&&(r>e?this.__enableDisableNavlistButton(r,"disable"):this.__skippedSectionsQuestions.length>0&&this.__checkSkippedSectionQuestions(r)&&this.__enableDisableNavlistButton(r,"disable"))}else if("VIEW"!==this.__checklistSectionView){for(var o=i+1;o<=e&&o<a.length;o++)a[o]&&a[o].setHidden(!1);if(this.__valueModified){for(var s=this.__topSectionNavigationListIndex>n?this.__topSectionNavigationListIndex:n;this.__topSectionNavigationListIndex>n?s>n:s>i&&s<a.length;)this.__enableDisableNavlistButton(s,"disable"),s--;var l=n-i;if(l>0)for(;l;)this.__enableDisableNavlistButton(i+l,"disable"),l--}}this.__setActiveSectionNavigationListItem(e,t)}},__enableDisableNavlistButton:function(e,t){var n=this.__checklistSectionNavigationListItems[e]&&e<this.__checklistSectionNavigationListItems.length&&this.__checklistSectionNavigationListItems[e];if("enable"===t&&n){n.enable();var i=n.parent&&n.parent.getScrollable()&&n.element&&n.parent.getScrollable().isInView&&n.parent.getScrollable().isInView(n.element)||!1;i&&!i.y&&n.scrollIntoView()}else this.__getExitCriteriaBizRules().length>0&&n&&(n.disable(),this.__removeValidationBadge(e))},__setValidationErrorCountOnSections:function(e){for(var t=0;t<e;t++)this.__skippedSectionsQuestions.length>0&&!this.__checkSkippedSectionQuestions(t)&&(this.__checklistSectionNavigationListItems[t]&&this.__checklistSectionNavigationListItems[t].setBadgeCls("sfm-checklist-validation-badge"),this.__checklistSectionNavigationListItems[t]&&this.__checklistSectionNavigationListItems[t].setBadgeText(""))},__setValidationErrorCount:function(e,t,n){n?(this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].setBadgeCls("sfm-checklist-validation-error-badge"),this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].updateBadgeText(t)):(this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].updateBadgeText(" "),this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].setBadgeCls("sfm-checklist-validation-badge"))},__removeValidationBadge:function(e){this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].updateBadgeText(" "),this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].setBadgeCls("")},__checkSkippedSectionQuestions:function(e){var t=!1,n=this.__inProgressSections||[],i=n.length>0&&n[e]._children&&n[e]._children.fields.length>0&&n[e]._children.fields[0].fieldName;return i&&this.__skippedSectionsQuestions.indexOf(i)>-1&&(t=!0),t},__setActiveSectionNavigationListItem:function(e,t){if(!(e>this.__checklistSectionNavigationListItems.length)){e===this.__checklistSectionNavigationListItems.length&&this.__activeSectionNavigationListIndex>0&&this.__checklistSectionNavigationListItems[this.__activeSectionNavigationListIndex-1].removeCls("nav-list-active"),e>this.__topSectionNavigationListIndex&&(this.__topSectionNavigationListIndex=e),e===this.__activeSectionNavigationListIndex&&e!==this.__checklistSectionNavigationListItems.length?this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].addCls("nav-list-active"):(this.__activeSectionNavigationListIndex<this.__checklistSectionNavigationListItems.length&&this.__checklistSectionNavigationListItems[this.__activeSectionNavigationListIndex].removeCls("nav-list-active"),this.__checklistSectionNavigationListItems[e]&&this.__checklistSectionNavigationListItems[e].addCls("nav-list-active"),this.__activeSectionNavigationListIndex=e),this.__enableDisableNavlistButton(e,"enable"),t||this.__onSectionDataUpdated();0===this.__getExitCriteriaBizRules().length&&this.__deliverySections.updateSkippedSectionsQuestions(e)}},getSectionNavigationListItems:function(e){for(var t=[],n=this,i=this.__getExitCriteriaBizRules(),a=0;a<e.length;a++){var r={xtype:"svmx.button",ui:"button-nav-sidebar",cls:"checklist-button-nav-sidebar",html:this.getSectionNavTitle(e,a),hidden:i.length>0&&!0||!1,sectionIndex:a,hasValidationErrors:!1,listeners:{tap:function(e,t,n){var i=e.sectionIndex;this.__navigationButtonTap="list",this._deliveryEngine.lastVisitedSectionIndex=this.__topSectionNavigationListIndex,this.__tappedNavigationIndex=i,this.__valueModified&&!this.__deliverySections._model.isDisplayOnly&&this.__getExitCriteriaBizRules().length>0?this.doNextSection():this.__deliverySections.continueShowNext(i)},scope:n}};t.push(r)}return t},__updateSectionToolBarQuestionCount:function(e){for(var t=this.getSectionModels(this.getPageModel()),n=t[e]&&t[e].getChildNode("fields")||[],i=0,o=void 0,s=0;s<n.length;s++){var l=n[s],c=l.fieldName;l&&l.__dataBinding&&l.__fieldInfo&&l.__fieldInfo.question&&"Attachment"===l.__fieldInfo.question.responseType?(o=l.__dataBinding&&l.__dataBinding.getValue())&&o.hasOwnProperty("file_path")&&(i++,this.__onSectionEditAnsweredFields[c]=r.cloneObject(o)):l&&(o=l.__dataBinding&&l.__dataBinding.getValue(),o&&"object"===(void 0===o?"undefined":(0,a.default)(o))&&o.value.length>0?(i++,this.__onSectionEditAnsweredFields[c]=o.value):(o&&"object"!==(void 0===o?"undefined":(0,a.default)(o))&&""!==o||"number"==typeof o)&&(i++,this.__onSectionEditAnsweredFields[c]=o))}e<t.length?(this.__sectionNavToolbarQuestionNumberElement&&this.__sectionNavToolbarQuestionNumberElement.setHidden(!1),this.__sectionToolbarQuestionStatus&&this.__sectionToolbarQuestionStatus.setHidden(!1),this.__sectionNavToolbarQuestionNumberElement.setHtml(i+"/"+n.length)):(this.__sectionNavToolbarQuestionNumberElement&&this.__sectionNavToolbarQuestionNumberElement.setHidden(!0),this.__sectionToolbarQuestionStatus&&this.__sectionToolbarQuestionStatus.setHidden(!0))},__onSectionDataUpdated:function(){this.__updateSectionToolBarQuestionCount(this.__activeSectionNavigationListIndex)},__onSectionEditToolBarQuestionCount:function(e){if(this.__sectionNavToolbarQuestionNumberElement){var t=e._compositionMetamodel.fieldName,n=void 0,i=void 0,a=void 0;if(n=this.__sectionNavToolbarQuestionNumberElement&&this.__sectionNavToolbarQuestionNumberElement.getHtml(),n=n.split("/"),i=Number(n[0]),a=Number(n[1]),e&&e.__fieldInfo&&e.__fieldInfo.__fieldInfo&&e.__fieldInfo.__fieldInfo.question&&"Attachment"===e.__fieldInfo.__fieldInfo.question.responseType){var o=e.__record&&e.__record.AttachmentData,s=o&&o.isDeleted;if(this.__onSectionEditAnsweredFields.hasOwnProperty(t)){var l=this.__onSectionEditAnsweredFields[t];o&&o.hasOwnProperty("file_path")&&(!s&&l.isDeleted?i++:s&&!l.isDeleted&&i--)}else i++;this.__onSectionEditAnsweredFields[t]=r.cloneObject(o)}else{var c=e.getValue();c="number"==typeof c||c?c.toString():"",e.getEmptyValue&&(c=e.getEmptyValue()===c?"":c),this.__onSectionEditAnsweredFields.hasOwnProperty(t)?""!==this.__onSectionEditAnsweredFields[t]&&""===c?i--:""===this.__onSectionEditAnsweredFields[t]&&""!==c&&i++:c&&i++,this.__onSectionEditAnsweredFields[t]=c}i=i>a?a:i,a&&this.__sectionNavToolbarQuestionNumberElement.setHtml(i+"/"+a)}},__getExitCriteriaBizRules:function(){return this._deliveryEngine&&this._deliveryEngine.getPageMetaData()&&this._deliveryEngine.getPageMetaData().__getEntryExitCriteriaBusinessRule("Checklist_Section_Exit_Criteria")||[]},getSectionModels:function(e){return e.getChildNode("header").getChildNode("sections")},getActiveSectionIndex:function(e){var t=e.getChildNode("header").getData().activeSectionIndex;return isNaN(t)?0:Number(t)},_getSectionNavBar:function(e,t){var n=this.getSectionNavTitle(e,t),i=this.getSectionNavBarItems(e,t);e.length<t&&this.getSectionDescription(e[t]);return{xtype:"svmx.headerbar",width:"100%",flex:0,itemId:"sectionNavBar",leftItem:[{xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.container",width:"100%",layout:{type:"vbox",align:"left",pack:"start"},items:[{xtype:"svmx.container",width:"100%",layout:{type:"hbox",align:"left",pack:"start"},items:[{xtype:"svmx.label",itemId:"sectionNavBarTitle",cls:"label-checklist-title",html:n},i[2]]}]}]}],rightItem:[i[1]],cls:"sfm-checklistdelivery-toolbar sfm-checklist-section-detail-toolbar"}},getSectionNavTitle:function(e,t){var n=void 0;return n=e.length<=0?_().T("FSA002_TAG012","No Section is configured"):t>=e.length?_().T("FSA002_TAG013","Checklist Complete"):e[t].title,n=Ext.htmlEncode(n)},getSectionDescription:function(e){var t=e&&e._data&&e._data.sectionDetail[r.getCustomFieldName("SM_Description")]?e._data.sectionDetail[r.getCustomFieldName("SM_Description")]:"";return t=Ext.htmlEncode(t)},__showNoQuestionsConfiguredMessage:function(){var e=r.Deferred();e=this.__showConfirmMessage(),e.then(r.proxy(this,function(e){this.__additionalInfo=null,this.__doneCheckNavigationStack()}))},__showConfirmMessage:function(){return r.Msg.confirm({title:"",text:_().T("FSA002_TAG012","No Section is configured"),buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"OK",flex:1}]})},_getSaveRecordEventName:function(){return"SFMDELIVERY.SAVE_CHECKLISTRECORD"},_getSaveRecordAdditionalInfo:function(e,t){var n=this.callParent(arguments),i=this.getDeliveryEngine().additionalInfo,a=i?i.sfProcessId:null;return n.sfProcessId=a,n.activeSectionIndex=this.__deliverySections.getActiveIndex(),n.topSectionNavigationListIndex=this.__topSectionNavigationListIndex||n.activeSectionIndex,n},_needTriggerAddRecentsEvent:!1,doSubmitCheckList:function(e){this.__disableSubmit();var t=this;this.getLocationDetails(!1).then(function(n){d.info("Performing Submit action"),t.issueIndicator.hide(),e=e||{},e.trackLocation=t.isLocationTrackEnabled(),e.locationDetails=n&&n.location;var i=t.getSectionsLength();i&&0===t.__getExitCriteriaBizRules().length&&(t._deliveryEngine.lastVisitedSectionIndex=i),t._deliveryEngine.saveToModel(!1),t.__triggerSaveRecordEvent("submit","com.servicemax.client.sfmdelivery.responders.SaveTargetRecordResponder",e)})},getSectionsLength:function(){var e=this.getPageModel()&&this.getPageModel().getChildNode("header")&&this.getPageModel().getChildNode("header").getChildNode("sections");return e?e.length:0},saveNoValidation:function(e){this.__disableSubmit();var t=this,n=this.getPageModel().getChildNode("header").getData();n.skippedSectionsQuestions=this.getDeliveryEngine()&&this.getDeliveryEngine().skippedSectionsQuestions||[],n.topSectionNavigationListIndex=this.__topSectionNavigationListIndex||this.__activeSectionNavigationListIndex,this.getLocationDetails(!0).then(function(n){d.info("Performing Submit action"),t.issueIndicator.hide(),e=e||{},e.toModelOnly=null==e.toModelOnly||e.toModelOnly,e.trackLocation=t.isLocationTrackEnabled(),e.locationDetails=n&&n.location,e.newChecklist=t.isNewChecklist(),t.__triggerSaveRecordEvent("saveNoValidation","com.servicemax.client.sfmdelivery.responders.SaveTargetRecordResponder",e)})},quickSave:function(e){this.__disableSubmit();var t=this;this.getLocationDetails(!0).then(function(n){d.info("Performing Checklist QuickSave action"),e=e||{},e.toModelOnly=null==e.toModelOnly||e.toModelOnly,e.trackLocation=t.isLocationTrackEnabled(),e.locationDetails=n&&n.location,e.newChecklist=t.isNewChecklist(),t.issueIndicator.hide(),t.__triggerSaveRecordEvent("checklist quick save","com.servicemax.client.sfmdelivery.responders.QuickSaveTargetRecordResponder",e)})},getLocationDetails:function(e){var t=r.Deferred(),n=!0;if((!this.isLocationTrackEnabled()||e&&!this.isNewChecklist())&&(n=!1),n){this.__nativeService=s;var i=this.__nativeService.createLocationTrackingRequest();if(i.bind("REQUEST_COMPLETED",function(e){var n=void 0;e&&e.data&&e.data.data&&(n=r.toObject(e.data.data)),t.resolve(n)},this),i.bind("REQUEST_ERROR",function(e){t.resolve({})},this),r.getClient().isLaptop()){l.readObjectFromDBCache("LOCATION_TRACKING_ENABLED").then(function(e){e&&"ALLOW"===e?i.execute():t.resolve({})})}else i.execute()}else t.resolve({});return t},isLocationTrackEnabled:function(){var e=!1;return c.getVersionClass().shouldChecklistLocationAndTimeTracked()&&(e=!0),e},isNewChecklist:function(){return this.getDeliveryEngine()&&this.getDeliveryEngine().getTargetData()&&this.getDeliveryEngine().getTargetData().getData()&&this.getDeliveryEngine().getTargetData().getData().getRawData().sfmData&&this.getDeliveryEngine().getTargetData().getData().getRawData().sfmData.__new},onGetPageDataCompleted:function(e){this.unblockApplication(),this.getDeliveryEngine().getPageMetaData().getDataModel().setData(e,!0),this._deliveryEngine.saveToModel(!1)},onQuickSaveTargetRecordComplete:function(e){this.__enableSubmit(),this.__quickSaveCalled=!0,d.info("Quick Save action completed"),e=e||{},e.data=e.data||{};var t=this.getDeliveryEngine(),n=t.getEventBus(),i=t.recordId||e.data&&e.data.Id||e.resultIds&&e.resultIds[0],a=r.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PAGEDATA",this,{request:{recordId:t.getSourceRecordId(),targetId:i,processId:t.processId,qualify:!1,refreshData:!0,objectNameMap:t.getObjectNameMap(),requesterId:t.getRootContainerId(),layout:t.__page.getData()},responder:r.create("com.servicemax.client.sfmdelivery.responders.GetPageDataResponder",this)});n.triggerEvent(a),d.info("Reloading the data")},evaluateBusinessRules:function(e){var t=0,n=this.getQuestionID(e);if(n){var i=void 0,a=!1,o=!1,s=!1,l=!1,c="sfm.field.mediafileupload"===e.xtype,u=void 0;c?(s=e.required,e.attachmentDescriptionPanel&&!e.attachmentDescriptionPanel._hidden&&(s=e.attachmentDescription&&e.attachmentDescription.getRequired()||e.fieldDef&&e.fieldDef.__fieldInfo&&e.fieldDef.__fieldInfo.question&&e.fieldDef.__fieldInfo.question.DescriptionRequired,u=e.attachmentDescription)):(u=e,e.getRequired&&(s=e.getRequired()),e.getIsInvalid&&(l=e.getIsInvalid()));var d=u&&u.getValue(),h="";if(u&&u.getEmptyValue&&(h=u.getEmptyValue()),s&&(void 0===d||null===d||""===d||d===h)||l)a=!0,s?i=_().T("FSA002_TAG015","required field"):l&&(i=_().T("FSA002_TAG016","the value entered is invalid"));else if(!c){var f=this.getDeliveryEngine(),p=f.__page.getFieldTypes(),m=f.getTargetData().getData(),v={},g=r.getCustomFieldName("Checklist"),y=e.getValue();p[g]&&p[g][n]&&(y=m.getConvertedValue(y,p[g][n])),v[n]=y;var S=this.getMappedBusinessRules(n);if(S){S=this.formatRules(S);var E=this.__businessRuleValidator.evaluateBusinessRules({rules:S,data:v,fields:p,pageModel:m});E.errors&&E.errors.length>0?(i=E.errors[0].message,a=!0):E.warnings&&E.warnings.length>0&&(i=E.warnings[0].message,o=!0)}}if(a||o){t=1;var b=void 0;b=c?e.attachmentDescription.getComponent("x-textfield"):e.getComponent("x-textfield");var T=e.parent&&e.parent.getComponent("errorPanel")&&e.parent.getComponent("errorPanel").getComponent("errorField");if(b&&T)if(T.setHidden(!1),T.setHtml(i),o){var M=e.parent&&e.parent.getComponent("errorPanel")&&e.parent.getComponent("errorPanel").getComponent("warningConfirm");if(M&&this.issueIndicator){var I="<span class='sfm-delivery-issue-item-question-error'> "+i+"<span>";this.issueIndicator.__issueConfirmations[I]?(t=0,M.setHidden(!0)):M.setHidden(!1)}b.addCls("cheklist-warning-field"),T.addCls("cheklist-warning-message")}else b.addCls("cheklist-error-field"),T.addCls("cheklist-error-message");else e.addCls("sfm-question-container-invalid")}else this.__clearErrorWarnings(e);e._message=i}return t},formatRules:function(e){for(var t={header:{key:"",rules:[]}},n=0;n<e.length;n++){var i=e[n],a=i.aliasName;t[a]?t[a].rules.push(i):t.header.rules.push(i)}return t},getQuestionID:function(e){var t=void 0;if(e){var n=e.getItemId();if(n){var i=n.split("field_");i&&i.length>1&&(t=i[1])}}return t},getMappedBusinessRules:function(e){var t=this.mappedBusinessRules,n=void 0;return t&&(n=t[e]),n}}),Ext.define(u.name+".ChecklistIssueIndicator",{extend:"com.servicemax.client.sfmdelivery.ui.largemodern.editview.IssueIndicator",alias:"widget.sfm.delivery.checklistissueindicator",issueIndicatorItemType:"sfm.delivery.checklistissueindicatoritem",_getIssueItemConfig:function(e,t){var n=this.callParent(arguments);return n.questionNumber=t.questionIndex,n.sectionIndex=t.sectionIndex,n.sectionTitle=t.sectionTitle,n.sequence=t.sectionIndex.toString()+t.questionNumber.toString(),n}}),Ext.define(u.name+".ChecklistIssueIndicatorItem",{extend:"com.servicemax.client.sfmdelivery.ui.largemodern.editview.IssueIndicatorItem",alias:"widget.sfm.delivery.checklistissueindicatoritem",cls:"sfmdelivery-checklist-issue-item",constructor:function(e){this.callParent(arguments),this.addCls(e.issueType)},_getButtonConfig:function(){var e=this.callParent(arguments);return e=Ext.apply(e,{xtype:"sfm.delivery.checklistissueindicatorbutton",cls:" sfm-checklist-issueitem-button",questionNumber:this.config.questionNumber})}});var h=[{tag:"span",reference:"questionNumberElement",hidden:!0,className:"sfm-checklistdelivery-issue-button-question-number"}].concat(com.servicemax.client.ui.components.modern.controls.impl.SVMXButton.prototype.template);Ext.define(u.name+".ChecklistIssueIndicatorItemButton",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXButton",alias:"widget.sfm.delivery.checklistissueindicatorbutton",config:{questionNumber:null},template:h,constructor:function(e){this.callParent(arguments)},updateQuestionNumber:function(e){var t=this.questionNumberElement;t&&(e?(t.show(),t.setHtml(e)):t.hide(),this.refreshIconAlign())}}),Ext.define(u.name+".CheckListSections",{extend:o.name+".SVMXCardPanel",alias:"widget.sfm.delivery.checklistsections",config:{model:null,readOnly:!0,deliveryEngine:null,submitButton:null,view:null},plugins:[{ptype:"sfm.delivery.checklistsectionbuilder",type:"sfm.delivery.checklistsectionbuilder",pluginId:"sectionBuilder"}],bubbleEvents:["inputblur"],__activeIndex:0,initialize:function(){this.callParent(),this.__sectionBuilder=this.__getSectionBuilder(),this.entryExitCriteriaChecklistInitialize()},entryExitCriteriaChecklistInitialize:function(){this.pageMetaData=this._deliveryEngine.getPageMetaData().getRawPageMetaData(),this.checklistStatus=this._deliveryEngine.additionalInfo.checklistStatus,this.answeredJson=null,this.topSectionIndex=0,this._deliveryEngine.skippedSectionsQuestions=[],this._deliveryEngine._previousIndex=null},showNextItem:function(){var e=this._model.getChildNode("header").getChildNode("sections");if(this.__sectionErrorCount=this.validateFieldsOnNext(e[this.__activeIndex]),this.__errorOnPage=!!this.__sectionErrorCount,this.__errorOnPage)return void(this._view&&this._view.__setValidationErrorCount(this.__activeIndex,this.__sectionErrorCount,!0));if(this._view&&this._view.__setValidationErrorCount(this.__activeIndex,"",!1),this._deliveryEngine._previousIndex=this.__activeIndex,this._deliveryEngine.saveToModel(!1),this._model.isDisplayOnly)this.continueShowNext(this.__activeIndex);else if(this.__activeIndex<e.length-1){var t=e[this.__activeIndex]._data.sectionDetail[r.OrgNamespace+"__ServiceMax_Processes__r"],n=this.getDeliveryEngine().getEventBus(),i=r.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.EVALUATE_EXIT_CRITERIA",this,{request:{data:this._deliveryEngine.getTargetData().getData(),metadata:this.pageMetaData,deliveryEngine:this._deliveryEngine,sectionExitRules:t,additionalInfo:{toModelOnly:!1,eventType:"Checklist_Section_Exit_Criteria"}},responder:r.create("com.servicemax.client.sfmdelivery.responders.ChecklistExitResponder",this)});d.info("SFMDELIVERY.EVALUATE_EXIT_CRITERIA"),n.triggerEvent(i)}else this.continueShowNext(++this.__activeIndex)},validateFieldsOnNext:function(e){var t=0;if(e&&e._children&&e._children.fields)for(var n=e._children.fields,i=!1,a=0;a<n.length;a++){var r=n[a],o=r.fieldName,s=this.query("#field_"+o);if(s&&s.length>0){var l=s[0],c=this.getView();if(c&&(t+=c.evaluateBusinessRules(l))&&!i){i=!0;var u=l.el.dom;u&&u.scrollIntoView()}}}return t},onExitCriteriaExecutionComplete:function(e){this.currentSectionIndex=this.__activeIndex,this.notifyUserMessage=!1;var t=void 0;t=e&&e.length>0?this.getTargetSectionIndex(e):this.__activeIndex+1,this.checkAlreadyAnsweredSection(this.currentSectionIndex,t)?this.showSectionSkipUserNotifyMsg(this.currentSectionIndex,t):this.continueExitCriteriaExecution(this.currentSectionIndex,t)},continueExitCriteriaExecution:function(e,t){this.skippingChecklistSections(e,t),this.updateSkippedSectionsQuestions(t),this.continueShowNext(t)},checkAlreadyAnsweredSection:function(e,t){var n=this._deliveryEngine.getTargetData().getData().getRawData().sfmData;if(n&&n[r.OrgNamespace+"__ChecklistJSON__c"])for(var i=r.toObject(n[r.OrgNamespace+"__ChecklistJSON__c"]),a=e+1;a<t;a++){var o=this.getPageSectionQuestionFieldsId(a),s=o[0];if(i&&i.hasOwnProperty(s))return!0}return!1},showSectionSkipUserNotifyMsg:function(e,t){var n=this;this.__showSkippedSectionNotifyMessage().then(r.proxy(this,function(i){"OK"===i&&(n.updateNotifyUserMessageFlag(),n.continueExitCriteriaExecution(e,t))}))},__showSkippedSectionNotifyMessage:function(){return r.Msg.confirm({title:"",text:_().T("FSA002_TAG026","You are going to lose previously entered data. Press OK to confirm."),buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"OK"},{text:_().T("FSA016_TAG004","Cancel"),itemId:"CANCEL"}]})},skippingChecklistSections:function(e,t){for(var n=e+1;n<t;n++)n!==t&&this.resetAnsweredSectionQuestionFields(n)},updateNotifyUserMessageFlag:function(){this.notifyUserMessage=!1,d.info("Deleting skipped section question fields value")},getTargetSectionIndex:function(e){for(var t=999,n=999,i=[],a={},o=0;o<e.length;o++)if(e[o].ruleInfo.bizRule[r.OrgNamespace+"__Sequence__c"]<t){t=e[o].ruleInfo.bizRule[r.OrgNamespace+"__Sequence__c"];var s=e[o].ruleInfo.bizRule[r.OrgNamespace+"__SM_Target_Section__c"];i.push(s),a[s]=t}var l=this._model.getChildNode("header").getChildNode("sections");t=999;for(var c=0;c<l.length;c++)i.indexOf(l[c]._data.sectionDetail.Id)>-1&&a[l[c]._data.sectionDetail.Id]<t&&(t=a[l[c]._data.sectionDetail.Id],n=c);return n},getPageSectionQuestionFieldsId:function(e){var t=this._model.getChildNode("header").getChildNode("sections"),n=t[e]._data.sectionDetail,i=[];if(!n[r.OrgNamespace+"__Entry_Criteria__c"])for(var a=t[e]._data.fields,o=0;o<a.length;o++)i.push(r.toObject(a[o].fieldDetail[r.OrgNamespace+"__QuestionInfoJSON__c"]).question.questionID);return i},resetAnsweredSectionQuestionFields:function(e){for(var t=this.getPageSectionQuestionFieldsId(e),e=0;e<t.length;e++){var n=t[e],i=this._deliveryEngine.getTargetData().__allBindingsHash;i&&i[n]&&i[n].setValue("")}for(var a=0;a<t.length;a++)-1===this._deliveryEngine.skippedSectionsQuestions.indexOf(t[a])&&this._deliveryEngine.skippedSectionsQuestions.push(t[a])},updateSkippedSectionsQuestions:function(e){if(this._deliveryEngine.skippedSectionsQuestions.length>0){var t=this._deliveryEngine.skippedSectionsQuestions;if(t.length>0&&e<this._deliveryEngine.__page._children.header._children.sections.length)for(var n=this._deliveryEngine.__page._children.header._children.sections[e]._children.fields,i=0;i<n.length;i++){var a=n[i].fieldName;t.indexOf(a)>-1&&this._deliveryEngine.skippedSectionsQuestions.splice(t.indexOf(a),1)}}},continueShowNext:function(e){var t=this.getIndexToMove(e),n=t!==e?this.__activeIndex:t;this.__sectionBuilder&&this.__sectionBuilder.__view&&this.__sectionBuilder.__view.__getEnableDisableSectionNavigationList(t,!1,n),this._view.__valueModified=!1,this.setActiveItem(t)},__disableSubmitButton:function(){this._view&&this._view.__getExitCriteriaBizRules()&&this._view.__getExitCriteriaBizRules().length>0&&(this.topSubmitBtn=this.topSubmitBtn||Ext.ComponentQuery.query("#checklistToolbarSubmitButton")[0],this.topSubmitBtn&&!this.topSubmitBtn.getDisabled()&&this.topSubmitBtn.setDisabled(!0))},getIndexToMove:function(e){var t=e;if("list"===this._view.__navigationButtonTap){var n=this._view.__tappedNavigationIndex;n<this.__activeIndex&&(t=n)}return t},setActiveItem:function(e){if(this.__activeIndex=e,this.callParent(arguments),e){var t=this._view.getSectionsLength();if(t>0&&e>=t){var n=Ext.ComponentQuery.query("#checklistToolbarSubmitButton");n&&n.length>0&&n[0].setDisabled(!1)}}},getActiveIndex:function(){return this.__activeIndex},onSectionContentShow:function(){this.getView().updateSectionNavBar()},getActiveSectionTitle:function(){var e=this.getView().getSectionModels(this.getModel());return this.getView().getSectionNavTitle(e,this.__activeIndex)},showingFirstSection:function(){return 0===this.__activeIndex},showingLastSection:function(){return this.__activeIndex===this.getInnerItems().length-1},showingSectionHelpUrl:function(){var e=this.getModel().getChildNode("header").getChildNode("sections");if(this.__activeIndex<e.length)var t=e[this.__activeIndex]._data.sectionDetail[r.getCustomFieldName("SM_Help_URL")];return!t},__getSectionBuilder:function(){if(!this.__sectionBuilder){var e=this;r.array.map(this.getPlugins(),function(t){if("sectionBuilder"==t.pluginId)return e.__sectionBuilder=t,!1}),console.log(this.__sectionBuilder)}return this.__sectionBuilder},applyModel:function(e){this.__applyHeaderModel(e.getChildNode("header")),this.getSubmitButton()&&this.addSubmitSection(this.getSubmitButton());var t=this.getView().getActiveSectionIndex(e);return this.setActiveItem(Number(t)),e},addSectionContent:function(e,t,n){var i=this;this.__sectionBuilder._fieldIndex=0;var a=this._getSectionContentContainer(n);a.items=[{xtype:"svmx.container",cls:"container-checklist-inner",layout:{type:"vbox",align:"left",pack:"full"},items:[{xtype:"svmx.label",itemId:"sectionDetailDescription",cls:"sfm-checklist-toolbar-section-desc",textLength:255,collapse:!0,width:"100%",showMore:"Show More",showLess:"Show Less",html:this.getDescriptionText(t,{textLength:255,showMore:"Show More"}),descriptionLabel:this.getSectionDescription(t),listeners:{click:{element:"element",fn:function(e,t){var n=e&&e.target,a=Ext.getCmp(e&&e.currentTarget&&e.currentTarget.id)||!1;n&&"truncatedStringReadMore"===n.className&&a&&(i.setDescriptionText(a),a.collapse=!a.collapse)},scope:i}}},e,{xtype:"svmx.container",height:40}]}],this.add(a)},getDescriptionText:function(e,t){var n=this.getSectionDescription(e);return n.length>t.textLength?"<p>"+n.substr(0,t.textLength)+'...</p><span class="truncatedStringReadMore">'+t.showMore+"</span>":n.length>0?'<p class="descriptionText">'+n+"</p>":n},setDescriptionText:function(e){var t="";t=e.collapse?"<p>"+e.descriptionLabel+'</p><span class="truncatedStringReadMore">'+e.showLess+"</span>":"<p>"+e.descriptionLabel.substr(0,e.textLength)+'...</p><span class="truncatedStringReadMore">'+e.showMore+"</span>",e.setHtml(t)},getSectionDescription:function(e){var t=e._data.sectionDetail[r.getCustomFieldName("SM_Description")]?e._data.sectionDetail[r.getCustomFieldName("SM_Description")]:"";return t=Ext.htmlEncode(t)},_getSectionContentContainer:function(e){var t=this;return{xtype:"svmx.container",cls:"sfm-delivery-section container-checklist",width:"100%",layout:{type:"vbox",align:"center",pack:"start"},height:"100%",scrollable:"vertical",listeners:{show:function(){t.onSectionContentShow()}},itemId:"section_"+e}},addSubmitSection:function(e){var t=this._getSectionContentContainer("submit");t.cls="sfm-delivery-section sfm-checklistsection-submit-card",t.items=[{xtype:"svmx.label",itemId:"checklistSubmitDesc",cls:"sfm-checklistsection-submit-desc",width:"40%",html:_().T("FSA002_TAG014","If you are satisfied with your answers, press the Submit button.")},e],this.add(t)},__applyHeaderModel:function(e){var t=e.getChildNode("sections"),n=this.__getSectionBuilder();if(t)for(var i=0;i<t.length;i++)n.buildSection(t[i],i);else n.buildSection(e,0);var a=this.getView();a.addAfterListener("show",r.proxy(this,function(e,t){e.__disabled=!1,e.__selected=!1})),a.addAfterListener("svmx-unmasked",r.proxy(this,function(e,t){e.__disabled=!1,e.__selected=!1}))},__getSection:function(e){return this.query("#section_"+e)[0]}}),Ext.define(u.name+".SFMQuestion",{extend:"Ext.Container",alias:"widget.sfm.question",width:"100%",cls:"sfm-question-container",layout:{type:"hbox",align:"top",pack:"start"},config:{fieldIndex:1,sectionIndex:1,field:{}},constructor:function(e){e.bodyCfg=Ext.apply(e.bodyCfg,{cls:"svmx-list-question-body"}),this.callParent(arguments)},initialize:function(){this.callParent(arguments);var e=this.getField(),t=[],n=e&&e.helpUrl||e.items&&e.items.length&&e.items[0].helpUrl;n&&t.push({xtype:"svmx.button",cls:"svmx-help-url",listeners:{tap:function(){var e=n,t=s.createBrowserRequest();t.bind("REQUEST_ERROR",function(e){var t={text:_().T("FSA003_TAG005","The application does not exist. Please contact your system administrator to update the application path or install the necessary software."),type:"INFO"};r.getCurrentApplication().showMessage(t)},this),t.execute({link:e})}}});var i=[{xtype:"label",cls:"svmx-list-question",html:""+this.getFieldIndex()},{xtype:"svmx.spacer",width:"20"},e];t&&t.length>0&&i.push({xtype:"svmx.container",cls:"container-helpurl",items:t}),this.add(i)}}),Ext.define(u.name+".CheckListSectionBuilderPlugin",{extend:"com.servicemax.client.sfmdelivery.ui.largemodern.api.SectionBuilderPlugin",alias:"plugin.sfm.delivery.checklistsectionbuilder",_fieldIndex:0,constructor:function(e){this._fieldIndex=0,this.callParent(arguments),this.__fieldToEditorMap=Ext.apply({},this.superclass.__fieldToEditorMap),this.__fieldToEditorMap["multi-select picklist"]={handler:"createCheckListMultiPicklistField",xtype:"sfm.field.multipicklist",emptyReadonlyTag:"TAGTODO1"},this.__fieldToEditorMap.picklist={handler:"createCheckListPicklistField",xtype:"sfm.field.picklist",emptyReadonlyTag:"TAGTODO2"},this.__fieldToEditorMap.checkbox={handler:"createCheckboxGroupField",xtype:"sfm.field.checkboxgroup",emptyReadonlyTag:"TAGTODO2"},this.__fieldToEditorMap["radio button"]={handler:"createRadioGroupField",xtype:"sfm.field.radiogroup",emptyReadonlyTag:"TAGTODO2"},this.__fieldToEditorMap.number={handler:"createNumber",xtype:"sfm.field.number",emptyReadonlyTag:"TAGTODO1"}},buildSection:function(e,t){var n=this;this.__sectionIndex=t,this.__checklistStatus=this.__view&&this.__view.__additionalInfo&&"VIEW"===this.__view.__additionalInfo.specialProcessType?"VIEW":"EDIT";var i=r.array.map(e.getChildNode("fields"),this.createFieldItem,this),a={xtype:"svmx.button",html:_().T("FSA008_TAG030","Next"),cls:"sfm-checklistsection-submit-btn",align:"center",listeners:{tap:function(e,t,n){this.__view&&(this.__view.__navigationButtonTap="next",this.__view.__valueModified=!0,this.__view.doNextSection())},scope:n}};i.push({xtype:"svmx.container",layout:{type:"hbox",align:"middle",pack:"center"},height:100,padding:10,hidden:"VIEW"===this.__checklistStatus||!1,items:[a]});try{var o={xtype:"svmx.fieldset",cls:"sfm-delivery-fieldset fieldset-checklist",layout:"auto",width:"100%",itemId:e.getData().dtlLayoutId||e.getData().sectionDetail.Id,items:i,overrideFieldLabelAlign:!1,labelAlign:"top"};this.__container.addSectionContent(o,e,t)}catch(e){d.error(e),d.error("Failed to build section: "+e)}},createFieldItem:function(e){var t={};return this.createQuestionField(e,t)},__addResponsiveConfig:function(e,t){t.width="100%"},validationHandler:function(){var e=this,t=this.callParent(arguments),n=t.errorCorrectionhandler,i=this.getQuestionField&&this.getQuestionField();i=i||this.parent.parent;var a=this.getCompositionMetamodel();if(a&&a.fieldName&&(t.questionNumber=a.fieldName),t.questionIndex=i.getFieldIndex(),t.sectionIndex=this.sectionIndex,t.sectionTitle=a._parent.title,t.checklist=!0,t.isRequired||t.isInvalid){var o=void 0;t.isRequired?o=_().T("FSA002_TAG015","required field"):t.isInvalid&&(o=_().T("FSA002_TAG016","the value entered is invalid"));t.message=r.string.substitute("<span class='sfm-delivery-issue-item-question-error'> {{errorMessage}}<span>",{question:this.getCompositionMetamodel().fieldLabel,errorMessage:o});var s=r.getCurrentApplication().getCurrentView();s&&s.evaluateBusinessRules&&s.evaluateBusinessRules(e)}return t.errorCorrectionhandler=function(){var t=r.getCurrentApplication().getCurrentView(),a=e.getInitialConfig().sectionIndex;t.__deliverySections.setActiveItem(a),t.__setActiveSectionNavigationListItem(a),e.scrollableIntoViewByFocus?n():i.scrollIntoView&&i.scrollIntoView()},t},businessRuleHandler:function(e){var t=this,n=this.getQuestionField&&this.getQuestionField(),i=this.callParent(arguments),a=i.errorCorrectionhandler;n=n||this.parent.parent;var o=this.getCompositionMetamodel();if(o&&o.fieldName&&(i.questionNumber=o.fieldName),i.questionIndex=n.getFieldIndex(),i.sectionIndex=this.sectionIndex,i.sectionTitle=o._parent.title,i.checklist=!0,"error"===e.type||"warning"===e.type){var s=r.getCurrentApplication().getCurrentView();s&&s.evaluateBusinessRules&&s.evaluateBusinessRules(t)}return i.message=r.string.substitute("<span class='sfm-delivery-issue-item-question-error'> {{errorMessage}}<span>",{errorMessage:e.message}),i.errorCorrectionhandler=function(){var e=r.getCurrentApplication().getCurrentView(),i=t.getInitialConfig().sectionIndex;e.__deliverySections.setActiveItem(i),e.__setActiveSectionNavigationListItem(i),t.scrollableIntoViewByFocus?a():n.scrollIntoView&&n.scrollIntoView()},i},createQuestionField:function(e,t){var n=this;++this._fieldIndex,e.charLength=e.charLength||255;var i=e.getQuestionType&&e.getQuestionType(),a=void 0;switch(t=Ext.apply(t,{labelAlign:"top",flex:12}),i){case"checkbox":case"multi-select picklist":case"picklist":a=this.__createFieldItemForDataType(e,i);break;case"number":e.scale=4,a=this.__createFieldItemForDataType(e,i);break;case"datetime":case"date":case"radio button":case"attachment":a=this.__createFieldItemForDataType(e,i);break;case"text":a=this.__createFieldItemForDataType(e,"textarea");break;default:a=this.__createFieldItemForDataType(e,"text")}a.sectionIndex=this.__sectionIndex;var r={xtype:"svmx.panel",width:"100%",layout:"hbox",itemId:"errorPanel",items:[{xtype:"label",itemId:"errorField",hidden:!0,width:"85%"},{xtype:"svmx.button",html:_().T("FSA008_TAG099","Confirm"),cls:"checklist-warning-submit",itemId:"warningConfirm",fieldName:e.fieldName,hidden:!0,listeners:{tap:function(){n.confirmWarning(this,!0)}}}]};switch(i){case"checkbox":case"radio button":a.title=a.label,delete a.label;break;default:var o={xtype:"svmx.fieldset",title:a.label,items:[a,r]};delete a.label,a=o}return e.required&&(a.title+=" *"),a.title=Ext.htmlEncode(a.title),delete t.listeners,t.xtype="sfm.question",t.fieldIndex=this._fieldIndex,t.sectionIndex=this.__sectionIndex,t.field=a,a.flex=1,t},confirmWarning:function(e,t){var n=e.fieldName;if(this.__view){var i=this.__view.query("#field_"+n);if(i&&i.length>0){var a=i[0],r=this.__view.issueIndicator,o=a&&a._message;if(o){var s="<span class='sfm-delivery-issue-item-question-error'> "+o+"<span>";r.confirmWarning(s,t),e.setHidden(!0)}}}},createCheckListMultiPicklistField:function(e,t){var n=e.getPicklistValues(),i=[];i.push({label:_().T("FSA002_TAG022","--None--"),value:"noValue"});for(var a=0;a<n.length;a++)i.push({label:n[a].response,value:n[a].response});return i||(i=e.getPicklistValues(),null,i.splice(0,1)),this._createMultiPicklistWithPLValues(e,t,i)},createCheckboxGroupField:function(e,t){for(var n=e.getPicklistValues(),i=[],a=0;a<n.length;a++)i.push({label:Ext.htmlEncode(n[a].response),value:n[a].response,labelWidth:null});return i||(i=e.getPicklistValues(),i.splice(0,1)),t.items=i,t.labelAlign="right",t},createRadioGroupField:function(e,t){for(var n=e.getPicklistValues(),i=[],a=0;a<n.length;a++)i.push({label:Ext.htmlEncode(n[a].response),value:n[a].response,labelWidth:null});return i||(i=e.getPicklistValues(),i.splice(0,1)),t.items=i,t.labelAlign="right",t},createCheckListPicklistField:function(e,t){var n=e.getPicklistValues(),i=[];i.push({label:_().T("FSA002_TAG022","--None--"),value:"noValue"});for(var a=0;a<n.length;a++)i.push({label:n[a].response,value:n[a].response});return this._createPicklistWithPLValues(e,t,i)}}),r.defineGlobal(u.name,u),e.exports=u},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(376),r=i(a),o=n(18),s=i(o),l=n(0).utils,c=(n(24).navigation,n(24).data,n(60).Constants),u=n(11).Facade,d={name:"com.servicemax.client.sfmdelivery.ui.largemodern.lookupview"},_=c,h=function(){return l.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};l.getLoggingService().getLogger("sfmdelivery.ui.lookupview");Ext.define(d.name+".OperatorModel",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:["opLabel","opValue"]}),Ext.define(d.name+".Filter",{extend:"com.servicemax.client.sfmdelivery.ui.largemodern.api.SFMMenuButton",alias:"widget.sfm.delivery.lookupfilter",config:{showOverrideContext:!0,allowOverrideContext:!0,contextLabel:"Override context",advancedFilters:[]},menuPosition:"tc-tc",menuCls:"sfm-delivery-lookup-filter-menu",__applied:!1,__advanceFliterStatus:{},constructor:function(e){this.callParent(arguments),this.__applied=!1,this.__advanceFliterStatus={},this.__buildMenu(this.getAdvancedFilters())},updateAdvancedFilters:function(e){this.initialized&&this.__buildMenu(e)},onShowHandler:function(){var e=this.menu.items.items;this.__advanceFliterStatus={},this.__applied=!1;for(var t=0;t<e.length;t++)(e[t].getItemId().indexOf("advancedFilterCb_")>-1||"contextCheckBox"==e[t].getItemId())&&(this.__advanceFliterStatus[e[t].getItemId()]=e[t]._checked)},onHideHandler:function(){if(!this.__applied)for(var e=this.menu.items.items,t=0;t<e.length;t++)if("applyButton"!==e[t].getItemId()){var n=e[t].getItemId();this.__advanceFliterStatus.hasOwnProperty(n)&&e[t].setChecked(this.__advanceFliterStatus[n])}},__buildMenu:function(e){var t=[];if(this.getShowOverrideContext()){var n=this.getContextLookupChecked();t.push({xtype:"svmx.field.checkbox",itemId:"contextCheckBox",label:this.getContextLabel(),readOnly:!this.getAllowOverrideContext(),checked:n,labelWidth:"90%",labelAlign:"right",cls:"sfm-delivery-lookup-overridecontext"})}for(var i=this.getFiltersToQuery(),a=0;a<e.length;a++){var r=e[a],o=i.indexOf(r.key)>=0;t.push({xtype:"svmx.field.checkbox",itemId:"advancedFilterCb_"+a,label:r.filterName,readOnly:!r.allowOverride,checked:o,labelWidth:"90%",labelAlign:"right",cls:"sfm-delivery-lookup-advancefilter"})}if(e.length>0||this.getShowOverrideContext()){var s=this,l=Ext.widget("svmx.button",{itemId:"applyButton",html:h().T("FSA008_TAG049","Apply"),cls:"sfm-delivery-lookup-advancefilter-apply-btn",listeners:{tap:function(){s.__applied=!0,s.getMenu().hide(),s.fireEvent("applyFilter")}}});t.push(l)}this.setHidden(t.length<=0),this.setMenuItems(t),this.__contextCheckBox=this.getMenu().query("#contextCheckBox")[0]},getContextLookupChecked:function(){return!this.__contextCheckBox||this.__contextCheckBox.isChecked()},getFiltersToQuery:function(){var e=this.getAdvancedFilters();if(!(e.length<=0)){for(var t=[],n=0;n<e.length;n++){var i=e[n],a=this.getMenu().query("#advancedFilterCb_"+n)[0];(!a&&i.defaultOn||a&&a.isChecked())&&t.push(i.key)}return t}}}),Ext.define(d.name+".LookupView",{extend:"com.servicemax.client.sfmconsole.ui.largemodern.console.View",alias:"widget.sfm.delivery.lookupview",config:{lookupModel:null,fieldDef:null,halign:"center"},layout:"fit",__firstColumnText:null,__searchCanceled:!1,__checkSelection:!1,__objectLabel:null,__infoClicked:!1,__bindings:null,__selectedItems:null,constructor:function(e){this.callParent(arguments),this.__syncManager=l.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),this.__bindings=[],this.__selectedItems=[]},updateOptions:function(e){this.operatorStore=Ext.widget("svmx.store",{model:d.name+".OperatorModel",data:[{opValue:"contains",opLabel:h().T("FSA008_TAG095","Contains")},{opValue:"sw",opLabel:h().T("FSA008_TAG096","Starts With")},{opValue:"ew",opLabel:h().T("FSA008_TAG097","Ends With")},{opValue:"eq",opLabel:h().T("FSA008_TAG050","Exactly")}]}),this.setFieldDef(e.currentLookupField),this.defaultSearchOperator="contains",this.deliverySettings=this.getDeliveryEngine().getSettings();var t=this.deliverySettings.getSetting("GBL017")||"";if(t){var n={"Ends With":"ew","Starts With":"sw",Contains:"contains","Exact Match":"eq"};this.defaultSearchOperator=n[t]}l.getLoggingService().getLogger("SFMDELIVERY-LOOKUP-UI").info("Default search operator is =>"+t+"("+this.defaultSearchOperator+")")},ready:function(){var e=this;this.bind(this.__syncManager,"CONNECTIVITY_CHANGED",this.__connectionHandler,this),this.setLookupModel(e.getFieldDef().getLookupModel());var t=e.getFieldDef().objectName;this.getLookupModel().getReferenceMetaModel().getRoot().describeObject(t,{handler:function(){this.__objectLabel=this.getLookupModel().getReferenceMetaModel().getRoot().objMetadataMap[t].label,this.setViewInfo({windowTitle:l.string.substitute(h().T("FSA008_TAG051","<span class='sfm-titlebar-fieldname'>{{fieldName}}</span> Lookup"),{fieldName:this.__objectLabel})})},context:this});var n=this.getContentItems();this.add(n),this.initializeComponent(),this.__hideLookupComps(),this.__searchBtn.setHidden(!1),this.__resetBtn.setHidden(!0),this.doLookup(""),this.__checkConnectivity().done(function(t){e.__updateIncludeOnlineComp(t)})},__updateIncludeOnlineComp:function(e){if(this.getItems()){var t=this.query("#includeOnline")[0],n=this.query("#includeOnlineLabel")[0];e?(t.setDisabled(!1),n.setDisabled(!1)):(t.setChecked(!1),t.setDisabled(!0),n.setDisabled(!0))}},bind:function(e,t,n,i){this.__bindings.push({eventBus:e,eventName:t,fn:n,context:i}),e.bind(t,n,i)},doDestroy:function(){if(this.__destroyInfoBubble(),l.array.forEach(this.__bindings,function(e){e.eventBus.unbind(e.eventName,e.fn,e.context)}),this.getStore&&this.getStore()&&(Ext.data.StoreManager.unregister(this.getStore()),this.getStore().destroy(),this._store=null),this.__list&&this.__list.getStore){var e=this.__list.getStore();Ext.data.StoreManager.unregister(e),e&&e.destroy(),this.__list._store=null}this.callParent()},__connectionHandler:function(e){var t=e.data.isConnected;this.__updateIncludeOnlineComp(t)},initializeComponent:function(){this.__lookupToolBar=this.query("#lookupToolBar")[0],this.__searchBtn=this.query("#searchBtn")[0],this.__resetBtn=this.query("#resetBtn")[0],this.__list=this.query("#list")[0],this.__listContainer=this.query("#listContainer")[0],this.__operator=this.query("#operator")[0],this.__lookupText=this.query("#lookupText")[0],this.__toolbarCancelButton=this.query("#toolbarCancelButton")[0],this.__lookupCriteriaPanel=this.query("#lookupCriteriaPanel")[0],this.__lookupFilterBtn=this.query("#lookupFilterBtn")[0],this.__searchOnlineRecord=this.query("#includeOnline")[0],this.__cancelSearchBtn=this.query("#cancelSearchBtn")[0]},getContentItems:function(){var e=this;return[{xtype:"svmx.toolbar",itemId:"lookupToolBar",width:"100%",docked:"top",ui:"svmx-toolbar-grey",title:l.string.substitute(h().T("FSA008_TAG051","<span class='sfm-titlebar-fieldname'>{{fieldName}}</span> Lookup"),{fieldName:this.__objectLabel}),items:this.getToolbarItems()},{xtype:"svmx.horizontalpanel",valign:"middle",cls:"sfm-delivery-lookup-criteriapanel",width:"100%",itemId:"lookupCriteriaPanel",items:[{xtype:"svmx.field.picklist",itemId:"operator",cls:"sfm-delivery-lookup-operator-picklist",inputCls:"sfmsearch-picklist-borderless",value:this.defaultSearchOperator||"contains",store:this.operatorStore,queryMode:"local",displayField:"opLabel",valueField:"opValue"},{xtype:"svmx.field.text",placeHolder:h().T("FSA008_TAG052","Search"),changeOnKey:!0,itemId:"lookupText",label:"",flex:1,cls:"svmx-search-field",showReadOnlyLabel:!1,listeners:{keyup:l.proxy(this,"doKeyUp")},enableBarcode:l.getClient().isBarCodeEnabled(),alwaysShowBarcode:!0,barcodeHandler:function(t,n){e.doLookup(n)}},this.getLookupFilterButtonConfig(),{xtype:"svmx.field.checkbox",itemId:"includeOnline",name:"includeOnline",disabledCls:"sfm-delivery-lookup-include-online-checkbox-disabled",cls:"sfm-delivery-lookup-include-online-checkbox",listeners:{change:l.proxy(this,"includOnlineChange")}},{xtype:"svmx.label",ui:"svmx-default",itemId:"includeOnlineLabel",disabledCls:"sfm-delivery-lookup-include-online-field-disabled",cls:"sfm-delivery-lookup-include-online-label",html:h().T("FSA008_TAG041","Include Online")},{xtype:"svmx.button",html:h().T("FSA008_TAG052","Search"),itemId:"searchBtn",cls:"sfm-delivery-lookup-search-btn",handler:function(){e.__searchCanceled=!1,e.__hideLookupComps(),e.doLookup(e.__lookupText.getValue())}},{xtype:"svmx.button",html:h().T("FSA008_TAG053","Reset"),cls:"sfm-delivery-lookup-reset-btn",hidden:!0,itemId:"resetBtn",handler:function(){e.__lookupText.setValue(""),e.__operator.setValue(e.defaultSearchOperator),e.__searchOnlineRecord.setChecked(!1),e.__searchBtn.setHidden(!1),e.__resetBtn.setHidden(!0),e.doLookup(e.__lookupText.getValue())}}]},this.getGrid()]},getGrid:function(){return{xtype:"svmx.container",itemId:"listContainer",width:"100%",layout:"fit",flex:1,items:[{xtype:"svmx.grid",itemId:"list",cls:"sfmsearch-result-grid-panel",emptyText:h().T("FSA008_TAG098","No data found"),minWidth:"100%",layout:"fit",columns:[],listeners:{itemtap:l.proxy(this,"handleItemTap")}},{xtype:"svmx.button",text:h().T("FSA008_TAG054","Cancel Search"),itemId:"cancelSearchBtn",cls:"sfm-delivery-lookup-cancel-search-btn",hidden:!1,listeners:{tap:l.proxy(this,"cancelSearch")}}]}},includOnlineChange:function(){this.__resetBtn.isHidden()||this.__resetBtn.setHidden(!0),this.__searchBtn.isHidden()&&this.__searchBtn.setHidden(!1)},createColumns:function(e){var t=[];this.__firstColumnText=e[0].fieldLabel,"single"!==this.__list.getMode().toLowerCase()&&t.push({xtype:"checkcolumn",sortable:!1,cell:{xtype:"checkcell",innerCls:"icon-checkbox-circle"}});for(var n=0;n<e.length;n++)t.push({text:e[n].fieldLabel,dataIndex:e[n].fieldName,flex:1,cls:"sfmsearch-result-column",tooltip:e[n].fieldLabel,hidden:n>=4});return t.push(this._getInfoColumn()),t},getListMode:function(){return"SIMPLE"},getDisableSelection:function(){return!0},getToolbarItems:function(){return[this.getCancelButton()]},getCancelButton:function(){return{docked:"left",xtype:"svmx.button",html:h().T("FSA016_TAG004","Cancel"),handler:l.proxy(this,"cancel"),ui:"svmx-toolbar-btn",itemId:"toolbarCancelButton"}},cancel:function(){this.done()},cancelSearch:function(){this.__searchCanceled=!0,this.__unhideLookupComps(),this.__cancelSearchBtn.isHidden()||this.__cancelSearchBtn.setHidden(!0),this.__resetBtn.isHidden()||this.__resetBtn.setHidden(!0),this.__searchBtn.isHidden()&&this.__searchBtn.setHidden(!1)},getLookupFilterButtonConfig:function(){var e="",t="",n=!1,i=this.getShowOverrideContext();if(i){var a=this.getLookupModel().getReferenceMetaModel();n=a.bOverrideRelatedLookup;try{var r=a.lookupContextFieldInfo.getDataBinding().getValue();r&&"object"===(void 0===r?"undefined":(0,s.default)(r))&&r.value?t=r.value:r&&"string"==typeof r&&(t=r)}catch(e){}e=a.lookupContextFieldInfo.fieldLabel}return{xtype:"sfm.delivery.lookupfilter",itemId:"lookupFilterBtn",text:h().T("FSA008_TAG055","Filters"),showOverrideContext:i,cls:"sfm-delivery-lookup-filter-btn",allowOverrideContext:n,contextLabel:h().T("TAG008")+" "+e+": "+t,advancedFilters:this.getAdvancedFilters(),listeners:{applyFilter:l.proxy(this,"applyFilter")}}},applyFilter:function(){this.__searchCanceled=!1,this.__hideLookupComps(),this.doLookup(this.__lookupText.getValue())},__hideLookupComps:function(){this.__lookupToolBar.setTitle(h().T("FSA004_TAG015","Searching...")),this.__lookupCriteriaPanel.setHidden(!0),this.__list.setHidden(!0),this.__searchBtn.setHidden(!0),this.__resetBtn.setHidden(!1),this.__cancelSearchBtn.setHidden(!1),this.__toolbarCancelButton.setDisabled(!0),void 0!==this.__addSelectedBtn&&this.__addSelectedBtn.setHidden(!0)},__unhideLookupComps:function(){var e=l.string.substitute(h().T("FSA008_TAG051","<span class='sfm-titlebar-fieldname'>{{fieldName}}</span> Lookup"),{fieldName:this.__objectLabel});this.__lookupToolBar.setTitle(e),this.__lookupCriteriaPanel.isHidden()&&this.__lookupCriteriaPanel.setHidden(!1),this.__list.isHidden()&&this.__list.setHidden(!1),this.__toolbarCancelButton.setDisabled(!1),void 0!==this.__addSelectedBtn&&this.__addSelectedBtn.setHidden(!1)},__destroyInfoBubble:function(){this.__bubbleUI&&(this.__bubbleUI.destroy(),this.__bubbleUI=null,this.__infoClicked=!1)},getShowOverrideContext:function(){return null!=this.getLookupModel().getReferenceMetaModel().lookupContext},getAdvancedFilters:function(){var e=this.getLookupModel().__lookupData;return e?e.advFilters:[]},updateLookupFilter:function(){this.__lookupFilterBtn.setAdvancedFilters(this.getAdvancedFilters())},__checkConnectivity:function(){var e=l.Deferred(),t=u,n=t.createConnectivityRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data.toLowerCase(),i="true"===n;e.resolve(i)},this),n.bind("REQUEST_ERROR",function(t){e.resolve(!1)},this),n.execute(),e},doLookup:function(e){var t=this.getFieldDef(),n=t.__sourceFieldInvokedFrom;this.getLookupModel().invoke({keyword:e,searchOperator:this.__operator.getValue(),bOverrideRelatedLookup:!this.getShowOverrideContext()||!this.__lookupFilterBtn.getContextLookupChecked(),filtersToQuery:this.__lookupFilterBtn.getFiltersToQuery(),userTrunk:this.getDeliveryEngine().getUserTrunk(),callType:_.LOOKUP_CALL_TYPE_DATA,searchOnlineRecord:this.__searchOnlineRecord.isChecked(),currentRecordId:n},{handler:this.renderData,context:this}),this.setViewInfo({windowTitle:l.string.substitute(h().T("FSA008_TAG051","<span class='sfm-titlebar-fieldname'>{{fieldName}}</span> Lookup"),{fieldName:this.__objectLabel})})},searchChanged:function(e,t){this.doLookup(t)},doKeyUp:function(e,t){if(this.__searchBtn.isHidden()&&this.__searchBtn.setHidden(!1),this.__resetBtn.isHidden()||this.__resetBtn.setHidden(!0),13===t.browserEvent.keyCode){var n=this;n.__hideLookupComps(),n.doLookup(n.__lookupText.getValue())}},renderData:function(){if(this.__list.getSelectionCount()>0&&this.__list.deselectAll(),!this.__searchOnlineRecord.isChecked()||!this.__searchCanceled){window.cordova&&"IPAD"===l.getClientTypeForUnifiedApp()&&Ext.isiOS&&this.__list.setInfinite(!1);var e=this.getLookupModel();this.updateLookupFilter();var t=e.getResultData(),n=e.getResultFieldsInfo();e.getReferenceMetaModel();if(void 0==n||void 0!=n&&0==n.length){n=[];var i=e.getNameColumnName(),a=e.getNameColumnNameLabel(e.getLookupObjectName(),i),r={fieldLabel:a,fieldName:i};n.push(r)}var o=void 0,s=n.length,c=[];for(o=0;o<s;o++)c.push({name:n[o].fieldName,defaultValue:""});this.__list.setColumns(this.createColumns(n));var u=l.create("Ext.data.Store",{fields:c,data:t});this.__unhideLookupComps(),this.__updateFirstColumn(this.__firstColumnText,t.length),this.__cancelSearchBtn.isHidden()||this.__cancelSearchBtn.setHidden(!0),this.__list.setStore(u),this.selectItemsOnRefresh()}},selectItemsOnRefresh:function(){var e=this.__list.getStore().data.items,t=[],n=!0,i=!1,a=void 0;try{for(var o,s=(0,r.default)(this.__selectedItems);!(n=(o=s.next()).done);n=!0){var l=o.value,c=!0,u=!1,d=void 0;try{for(var _,h=(0,r.default)(e);!(c=(_=h.next()).done);c=!0){var f=_.value;if(f.data.Id===l.data.Id){t.push(f);var p=e.indexOf(f),m=this.__list.getItemAt(p),v=this.__list.getColumns()[0];m.getCellByColumn(v);break}}}catch(e){u=!0,d=e}finally{try{!c&&h.return&&h.return()}finally{if(u)throw d}}}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}t.length&&this.__list.select(t)},__updateFirstColumn:function(e,t){var n=e+" ("+t+")";this.__list.getColumns()[0].setText(n)},__getFieldType:function(e){return"datetime"==e.fieldType?"date":"string"},_getInfoColumn:function(){var e={fieldType:"TEMPLATE",fieldLabel:"",fieldName:"",parentName:"",data:{Info:""},parentReferenceName:"",getFullFieldName:function(){return this.fieldName}};return this.__createInfoColumn(e,{text:"",dataIndex:"Info",cls:"sfmsearch-result-info-icon-column",flex:1,skipInViewRecord:!0,sortable:!1})},__createInfoColumn:function(e,t,n){var i={fld:e,uiConfig:t,index:n};return this.__infoColumnDefinition(i)},__infoColumnDefinition:function(e){var t={columnObj:e,cls:"info-icon-column",cell:{xtype:"widgetcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",widget:{xtype:"button",cls:"sfmsearch-info-icon-button",iconCls:"x-fa fa-info"}}};return t=Ext.apply(t,e.uiConfig)},handleItemTap:function(e,t,n,i,a,r){this.doItemTap(e,t,n,i,a,r)},doItemTap:function(e,t,n,i,a,r){a.stopEvent(),this.__destroyInfoBubble();var o=a.target.className;if(this.__checkSelection=!1,o.indexOf("fa-info")>=0){if(this.__checkSelection=!0,this.__infoClicked)return;return this.__infoClicked=!0,this.onBubbleClick(e,i,a),void(a.stopSelection=!0)}if("single"!==this.__list.getMode().toLowerCase()){var s=e.getItemAt(t),l=e.getColumns()[0];s.getCellByColumn(l)}e.isSelected(i)?(this.handleDeselect(e,i),this.__removeDeselectedItem(i)):(this.__addSelectedItem(i),this.handleSelect(e,i))},__addSelectedItem:function(e){this.__selectedItems.push(e)},__removeDeselectedItem:function(e){var t=this.__selectedItems.map(function(e){return e.data.Id}).indexOf(e.data.Id);this.__selectedItems.splice(t,1)},handleSelect:function(e,t,n){this.doSelect(e,t,n)},doSelect:function(e,t,n){this.done(this.getFormFillSafeRawData(t))},handleDeselect:function(e,t,n,i){this.doDeselect(e,t,n,i)},doDeselect:function(e,t,n,i){},onBubbleClick:function(e,t,n){var i=this.queryById(n.currentTarget.id);this.__bubbleCmp=i.element.query(".fa-info",!1)[0];var a=this.getLookupModel(),r=a.getReferenceMetaModel(),o=a.getResultFieldsInfo(),s=[];if(o)for(var c=0;c<o.length;c++){var u=o[c];t.data[u.fieldName]&&s.push({key:u.fieldName,value:t.data[u.fieldName]})}else s.push({key:"",value:h().T("FSA008_TAG014","Info not available")});s=l.array.filter(s,function(e){return!e.key.match(/__r$/)&&!e.key.match(/__key$/)&&(!e.value||"string"==typeof e.value||e.value instanceof String)}),this.showBubble(s,r.objectName)},showBubble:function(e,t){var n=null;this.__bubbleCmp&&this.__bubbleCmp.component&&this.__bubbleCmp.component.parent&&this.__bubbleCmp.component.parent.parent&&this.__bubbleCmp.component.parent.parent.parent&&(n=this.__bubbleCmp.component.parent.parent.parent);var i=this.__getScrollerActualOffset(n),a=this.__createBubble(e,t);a.showBy(this.__bubbleCmp,"tr-tl?"),this.__bubbleUI=a,this.__setScrollerActualOffset(n,i,n)},__createBubble:function(e,t){var n=void 0,i=e.length,a=[],r=null,o=void 0,s=void 0,l=0;for(n=0;n<i;n++)null!==(s=e[n].value)&&void 0!==s&&""!==s&&(o=this.getLookupModel().getReferenceMetaModel().getRoot().getLabel(t,e[n].key),r={xtype:"svmx.field.text",value:e[n].value,readOnly:!0,labelAlign:"top",label:o,fieldBodyCls:"sfm-bubble-content-value"},a.push(r));for(n=0;n<i;n++)null!==(s=e[n].value)&&void 0!==s&&""!==s&&l++;var c=64*l;c=c<128?128:c>256?256:c;return Ext.widget("svmx.panel",{itemId:"bubblePanel",layout:{type:"vbox"},header:!1,hideOnMaskTap:!0,border:0,modal:!0,floated:!0,height:c,top:"-45px",left:"-25px",scrollable:"vertical",cls:"sfm-bubble-content-background",items:a})},onDisclose:function(e,t,n,i,a,r){return n.toggleCls("expanded"),!1},getFormFillSafeRawData:function(e){var t=l.cloneObject(e.data);return l.forEachProperty(e.data,function(e,n){e.match(/__key$/)&&"object"!==(void 0===n?"undefined":(0,s.default)(n))&&(t[e]={key:n,value:t[e.replace(/__key$/,"")]})}),t},__getScrollerActualOffset:function(e){var t=0;if("IPAD"===l.getClientTypeForUnifiedApp()&&e){var n=e.getScrollable();if(n){var i=n.getElement();i&&(t=i.el.dom.scrollTop)}}return t},__setScrollerActualOffset:function(e,t){if("IPAD"===l.getClientTypeForUnifiedApp()&&e){var n=e.getScrollable();if(n){var i=n.getElement();i&&(i.el.dom.scrollTop=t)}}}}),Ext.define(d.name+".MultiLookupView",{extend:d.name+".LookupView",alias:"widget.sfm.delivery.multilookupview",getListMode:function(){return"MULTI"},getDisableSelection:function(){return!1},getGrid:function(){return{xtype:"svmx.container",itemId:"listContainer",width:"100%",layout:"fit",flex:1,items:[{xtype:"svmx.grid",itemId:"list",cls:"sfmsearch-result-grid-panel",emptyText:h().T("FSA008_TAG098","No data found"),minWidth:"100%",columns:[],mode:this.getListMode(),listeners:{itemtap:l.proxy(this,"handleItemTap"),selectionchange:l.proxy(this,"handleSelectionChange")},plugins:{type:"gridmultiselection",selectionColumn:{hidden:!1,cls:"sfm-delivery-lookup-multiadd-firstcolumn"}}},{xtype:"svmx.button",text:h().T("FSA008_TAG054","Cancel Search"),itemId:"cancelSearchBtn",cls:"sfm-delivery-lookup-cancel-search-btn",hidden:!1,listeners:{tap:l.proxy(this,"cancelSearch")}}]}},__updateFirstColumn:function(e,t){var n=e+" ("+t+")";this.__list.getColumns()[1].setText(n)},updateOptions:function(e){this.callParent([e]),this.__addSingleLineHandlerCallback=e.addSingleLineHandlerCallback,this.__addMultpleNewHandlerCallback=e.addMultpleNewHandlerCallback,this.selectedRecordData=[]},getToolbarItems:function(){return[this.getCancelButton(),{xtype:"svmx.button",itemId:"addSelectedBtn",docked:"right",html:h().T("FSA008_TAG057","Add Selected"),handler:l.proxy(this,"addSelected"),disabled:!0}]},addSelected:function(){for(var e=[],t=[],n=this.getLookupModel(),i=this.__selectedItems,a=0;a<i.length;a++){var r=i[a],o=this.getFormFillSafeRawData(r);t.push(o),e[a]=this.__getSelectedItemData(n,o)}this.__addMultpleNewHandlerCallback(e,t),this.done()},getContentItems:function(){return this.callParent()},addSingleLineHandler:function(){this.done(),this.__addSingleLineHandlerCallback()},__getSelectedItemData:function(e,t){var n=e.getDefaultColumnName(),i=void 0,a=void 0;return i=t[n],a=t.Id,void 0!==i&&null!==i||(n=e.getNameColumnName(),void 0!==(i=t[n])&&null!==i||(i=h().T("TAG031"))),!i&&t.Id.match("_local_")&&(i=t.Id),{key:a,value:i}},handleSelectionChange:function(e,t,n){this.__addSelectedBtn.setDisabled(this.__selectedItems.length<=0),1==this.__checkSelection&&e.deselect(t)},initializeComponent:function(){this.callParent(),this.__addSelectedBtn=this.query("#addSelectedBtn")[0]},doDeselect:function(e,t,n,i){},doSelect:function(e,t,n){}}),l.defineGlobal(d.name,d),e.exports=d},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m=n(11).Facade,v={name:"com.servicemax.client.sfmdelivery.ui.largemodern.commands"};v.ScanBarcode=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){var n=m.createScanRequest();n.bind("REQUEST_COMPLETED",function(t){if(e&&e.onSuccess&&t.data.data&&!t.data.data.cancelled){var n=t.data.data.text||"";/^([0-9a-zA-Z+\/]{4})*(([0-9a-zA-Z+\/]{2}==)|([0-9a-zA-Z+\/]{3}=))?$/.test(n)&&(n=atob(n)),n=n.replace(/[\x00-\x1F\x7F-\x9F]/g,""),e.onSuccess.call(e.context,n)}else t.data.data&&t.data.data.cancelled&&f.getCurrentApplication().getRoot().setEnableHardwareBack(!1)}),n.bind("REQUEST_ERROR",function(e){f.Msg.confirm({title:"",text:"Camera Not Found",buttons:[{text:"OK"}]})}),n.execute({})}}]),t}(p),v.CapturePhoto=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__parent=null,e.__context=null,e.__deliveryEngine=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__context=e.context;var n=m.createCapturePhotoRequest();n.bind("REQUEST_COMPLETED",function(t){var n=JSON.parse(t.data.data),i=void 0;if("WOATTACHMENT"===e.process){i=e.deliveryEngine;var a=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.ATTACH_FILE",this,{request:{deliveryEngine:i,recordId:i.getRecordId(),process:"WOATTACHMENT",data:n,isSalesForceFilesEnabled:e.isSalesForceFilesEnabled||!1},responder:f.create("com.servicemax.client.sfmdelivery.responders.SelectFileToUploadResponder",this)});f.getCurrentApplication().triggerEvent(a)}else{i="mobile"===f.getClient().getApplicationParameter("client-type")?this.__controller.__eventBus.__currentView._deliveryEngine:this.parent.parent.parent.parent._deliveryEngine;var r=f.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CHECKLIST_FILE_ATTACHMENT",this,{request:{data:n,deliveryEngine:i||{},checklistUpload:!0,additionalInfo:{context:e.context}},responder:f.create("com.servicemax.client.sfmdelivery.responders.ChecklistFileToUploadResponder",this)});f.getCurrentApplication().triggerEvent(r)}},this),n.bind("REQUEST_ERROR",function(e){t.fault(e)}),n.execute({request:e,additionalInfo:{context:e.context}},this)}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Operation,m={name:"com.servicemax.client.sfmdelivery.ui.largemodern.operations"},v=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};m.SaveTargetRecordWarning=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){f.Msg.confirm({title:v().T("FSA008_TAG099","Confirm"),text:e.message,buttons:[{text:v().T("FSA016_TAG004","Cancel"),ui:"svmx-button-square",itemId:"no"},{text:v().T("FSA008_TAG079","Save"),ui:"svmx-button-square",itemId:"yes"}]}).then(f.proxy(this,function(n){"yes"==n?t.__doResolveValuesBeforeSave(e.original.request,e.original.responder):f.getCurrentApplication().getCurrentView().unblockApplication()}))}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=n(12).DatetimeUtil,v=n(5).SVMXObject,g={name:"com.servicemax.client.sfmdelivery.ui.largemodern.slaclock"},y=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},S=m;g.slaClockTimer=function(e){function t(e){(0,s.default)(this,t),e||(e={});var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__resolutionCustomerBy=null,n.__resolutionInternalBy=null,n.__restorationCustomerBy=null,n.__restorationInternalBy=null,n.__actualResolution=null,n.__actualRestoration=null,n.__isClockPaused=null,n.__clockPausedTime=null,n.__commitmentType=null,n.__sfmData=null,n.__settings=null,n.__objectType=null,n.__currentClockId=null,n.__container=null,n.__slaClockPanel=null,n.initialize(e),n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e){this.__rootId=e.rootId,this.__sfmData=e.object_data,this.__settings=e.object_settings,this.__container=e.container,this.__objectType=e.objectType,this.__userInfo=e.user_info,this.__currentClockId=e.rootId,this.__objectType==p.OrgNamespace+"__Service_Order__c"?this.__commitmentType=this.__settings.getSetting("SLAT003_SET001"):"Case"==this.__objectType&&(this.__commitmentType=this.__settings.getSetting("SLAT002_SET001")),this.readSlaFields()}},{key:"getSLAFieldValue",value:function(e){var t=null;return this.__sfmData.__data.sfmData[p.OrgNamespace+e]&&(t=this.__sfmData.__data.sfmData[p.OrgNamespace+e].fieldvalue?this.__sfmData.__data.sfmData[p.OrgNamespace+e].fieldvalue.key:this.__sfmData.__data.sfmData[p.OrgNamespace+e])&&(t=S.parseGMTDate(t)),t}},{key:"getSLAClockPausedValue",value:function(e){var t=null;return this.__sfmData.__data.sfmData[p.OrgNamespace+e]&&(t=this.__sfmData.__data.sfmData[p.OrgNamespace+e].fieldvalue?this.__sfmData.__data.sfmData[p.OrgNamespace+e].fieldvalue.key:this.__sfmData.__data.sfmData[p.OrgNamespace+e]),t}},{key:"readSlaFields",value:function(){this.__resolutionCustomerBy=this.getSLAFieldValue("__Resolution_Customer_By__c"),this.__resolutionInternalBy=this.getSLAFieldValue("__Resolution_Internal_By__c"),this.__restorationCustomerBy=this.getSLAFieldValue("__Restoration_Customer_By__c"),this.__restorationInternalBy=this.getSLAFieldValue("__Restoration_Internal_By__c"),this.__actualResolution=this.getSLAFieldValue("__Actual_Resolution__c"),this.__actualRestoration=this.getSLAFieldValue("__Actual_Restoration__c"),this.__isClockPaused=this.getSLAClockPausedValue("__SLA_Clock_Paused__c"),this.__clockPausedTime=this.getSLAFieldValue("__SLA_Clock_Pause_Time__c")}},{key:"createSlaView",value:function(){if(this.__slaClockPanel)return null;var e=this,t=Ext.widget("svmx.container",{layout:{type:"vbox",align:"full",pack:"full"},cls:"sfm-delivery-slaclock-grid",items:[{xtype:"svmx.container",layout:{type:"hbox",align:"stretch",pack:"full"},cls:"sfm-delivery-slaclock-grid-header",items:[{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:y().T("FSA009_TAG001","Status")},{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:y().T("FSA009_TAG002","Deadline")},{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:y().T("FSA009_TAG003","Remain")}]},{xtype:"svmx.container",layout:{type:"hbox",align:"stretch",pack:"full"},cls:"sfm-delivery-slaclock-grid-row",items:[{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:y().T("FSA009_TAG004","Resolution")},{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",text:"",flex:1,id:e.__currentClockId+"resolution"},{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",text:"",flex:1,id:e.__currentClockId+"resolution_remain"}]},{xtype:"svmx.container",layout:{type:"hbox",align:"stretch",pack:"start"},cls:"sfm-delivery-slaclock-grid-row",items:[{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:y().T("FSA009_TAG005","Restoration")},{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:"",id:e.__currentClockId+"restoration"},{xtype:"svmx.label",cls:"sfm-delivery-slaclock-label",flex:1,text:"",id:e.__currentClockId+"restoration_remain"}]}],listeners:{added:function(t,n,i,a){if(e.__commitmentType){var r=void 0,o=void 0;"customer commitment"==e.__commitmentType.toLowerCase()?(r=e.__resolutionCustomerBy,o=e.__restorationCustomerBy):"internal commitment"==e.__commitmentType.toLowerCase()&&(r=e.__resolutionInternalBy,o=e.__restorationInternalBy),e.__updateTimer(e.__actualResolution,r,e.__isClockPaused,e.__clockPausedTime,"resolution"),e.__updateTimer(e.__actualRestoration,o,e.__isClockPaused,e.__clockPausedTime,"restoration")}}}});return this.__slaclockPanel=t,this.__slaclockPanel}},{key:"__updateTimer",value:function(e,t,n,i,a){var r=this;""!=e?r.showStilTimer(e,t,a):"false"!=n&&null!=n?r.showStilTimer(i,t,a):r.showRunningTimer(t,a)}},{key:"showStilTimer",value:function(e,t,n){if(e&&t){this.__updateEndTime(t,n);var i=S.getDurationBetween(e,t);seconds=this.__zeroPad(i.seconds()),minutes=this.__zeroPad(i.minutes()),hours=this.__zeroPad(i.hours()),days=i.days(),days<0&&(days=0);var a=1==days?y().T("FSA009_TAG006","day"):y().T("FSA009_TAG007","days"),r=days+" "+a+" "+hours+":"+minutes+":"+seconds;f("#"+this.__currentClockId+n+"_remain").text(r)}}},{key:"__zeroPad",value:function(e){return e<=0?e="00":e<10&&(e="0"+e.toString()),e}},{key:"showRunningTimer",value:function(e,t){if(e){this.__updateEndTime(e,t);var n=f("#"+this.__currentClockId+t+"_remain"),i="%-D %!D:"+y().T("FSA009_TAG006","day")+","+y().T("FSA009_TAG007","days")+"; %H:%M:%S";n.countdown(e,function(e){var t=e.strftime(i);n.text(t)})}}},{key:"__updateEndTime",value:function(e,t){var n=S.humanizeRelativeDate(e,1);f("#"+this.__currentClockId+t).text(n)}}]),t}(v),p.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(6),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(12).DatetimeUtil,m=(n(24).navigation,n(24).data,n(60).Constants,n(5).SVMXObject),v=n(7).Cache,g={name:"com.servicemax.client.sfmdelivery.ui.largemodern.columndeffactory"},y=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};f.getLoggingService().getLogger("sfmdelivery.ui.columndffactory");Ext.define(g.name+".EditableWidgetCell",{extend:"Ext.grid.cell.Widget",alias:"widget.sfm.editablewidgetcell",element:{reference:"element",cls:Ext.baseCSSPrefix+"grid-cell",children:[{reference:"innerElement",cls:Ext.baseCSSPrefix+"grid-cell-inner"},{reference:"editorElement",cls:Ext.baseCSSPrefix+"grid-cell-editor"}]},config:{fieldName:"name"},constructor:function(e){var t=this;t.callParent([e]);var n=t.getWidget();n.on("show",function(e){var i=t.getRecord(),a=i.get(t.getFieldName());n.setValue(a)}),n.getComponent().on("blur",function(){var e=t.getRecord(),i=n.getValue();e.set(t.getFieldName(),i),n.setReadOnly(!0)}),t.element.on("tap",function(e,i){n.getReadOnly()&&(e.stopEvent(),n.setReadOnly(!1),n.focus(),t.fireEvent("celltap",this,e,i))})}}),g.ColumnDefFactory=function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.isDisplayOnly=!1,e}return(0,h.default)(t,e),(0,d.default)(t,[{key:"__constructer",value:function(e){this.__parent=e}},{key:"createColumnDefinition",value:function(e,t,n,i){return this.createColumnDefinitionReadOnly(e,t,n,i)}},{key:"createColumnDefinitionReadOnly",value:function(e,t,n,i){t=Ext.applyIf(t,{text:e.fieldLabel,dataIndex:e.fieldName});var a=e.datatype;return"double"==a?this.createNumberColumnDefinition(e,t):"int"==a?this.createIntegerColumnDefinition(e,t):"reference"==a?this.createLookupColumnDefinition(e,t):"string"==a?this.createTextColumnDefinition(e,t):"datetime"==a?this.createDatetimeColumnDefinition(e,t):"date"==a?this.createDateColumnDefinition(e,t):"picklist"==a?this.createPicklistColumnDefinition(e,t):"boolean"==a?i?this.createCheckboxColumnDefinition(e,t):this.createToggleFieldColumnDefinition(e,t):"textarea"==a?this.createTextAreaColumnDefinition(e,t):"currency"==a?this.createCurrencyColumnDefinition(e,t):"percent"==a?this.createPercentColumnDefinition(e,t):"url"==a?this.createUrlColumnDefinition(e,t):"recordtype"==a?this.createRecordTypeColumnDefinition(e,t):"multipicklist"==a?this.createMultiPicklistColumnDefinition(e,t):this.createTextColumnDefinition(e,t)}},{key:"createColumnDefinitionWidget",value:function(e,t){t=Ext.applyIf(t,{text:e.fieldLabel,dataIndex:e.fieldName});var n=e.datatype;return"double"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.double"):"int"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.number"):"reference"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.lookup"):"string"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.text"):"datetime"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.datetime"):"date"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.date"):"picklist"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.picklist"):"boolean"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.checkbox"):"textarea"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.textarea"):"currency"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.currency"):"percent"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.number"):"url"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.url"):"recordtype"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.recordtype"):"multipicklist"==n?this.createWidgetColumnDefinition(e,t,"sfm.field.multipicklist"):this.createWidgetColumnDefinition(e,t,"sfm.field.text")}},{key:"createActionColumnWithNavigationBtnDefinition",value:function(e,t){return e.isDesktop?this.createActionColumnWithNavigationBtnDefinitionDesktop(e,t):this.createActionColumnWithNavigationBtnDefinitionMobile(e,t)}},{key:"createActionColumnWithNavigationBtnDefinitionDesktop",value:function(e,t){var n=t.getDeliveryEngine().getPageMetaData().getData().processTitle,i=f.proxy(t,"doDeleteRow"),a=f.proxy(t.getView(),"save"),r=f.proxy(t,"doCopyRow"),o=(e.sectionModel,[]);e.allowAddNewLines&&o.push({xtype:"svmx.button",text:y().T("FSA008_TAG144","Copy Item"),handler:function(e,t){t.stopEvent(),e.parent.hide();var n=this.parent.record;r(null,n.store.indexOf(n),null,n)}}),e.allowDeleteLines&&o.push({xtype:"svmx.button",text:y().T("FSA008_TAG026","Remove Item"),handler:function(e,t){e.parent.hide(),t.stopEvent();var n=this.parent.record;i(null,n.store.indexOf(n),null,n)}});var s=[],l=t.getLinkedProcesses();if(l&&l.length>0)for(var c=0;c<l.length;c++){var u={xtype:"svmx.button",text:l[c].title,processId:l[c].processId,handler:function(e,t){var i=this,r=e.parent.record;v.readObjectFromDBCache("SHOW_ACTION_COLUMN_DIALOG").then(function(t){var o=!1,s=r.raw.Id,l=e.processId,c={recordId:s,processId:l,inPlaceNavigation:!0,store:r.store,recordIndex:r.store.indexOf(r),isLinkedSFM:!0};t&&"true"!=t?(e.parent.hide(),a(c)):f.Msg.alert({title:null,text:"",items:[{xtype:"svmx.label",text:f.string.substitute(y().T("FSA008_TAG024","Changes to {{name}} are automatically saved when you select a linked action."),{name:n})},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelAlign:"right",label:y().T("FSA008_TAG025","Don't show this again"),checked:o,listeners:{check:f.proxy(i,function(e,t){o=e.getChecked()})}}],buttons:[{text:y().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"svmx-button-square"},{text:y().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square-highlight"}]}).then(function(t){"OK"==t&&(v.writeToDBCache("SHOW_ACTION_COLUMN_DIALOG",!o),e.parent.hide(),a(c))})})}};o.push(u)}o.length>0&&s.push({xtype:"sfm.menubutton",menuItems:o,menuCls:"sfm-delivery-property-menu",cls:"sfm-delivery-detail-actions-button",iconCls:"icon-list"});var d={header:"",cell:{xtype:"widgetcell",widget:{xtype:"svmx.horizontalpanel",cls:"sfm-delivery-detail-actions-container",items:s}}};return d=Ext.apply(d,e),d.width=this.__calculateActionColumnWithNavigationBtnWith(e,t),d.maxWidth=d.width,d}},{key:"__calculateActionColumnWithNavigationBtnWith",value:function(e,t){var n=e.width,i=0,a=t.getLinkedProcesses();return a&&a.length>0&&(i+=n),e.allowDeleteLines&&(i+=n),i}},{key:"createActionColumnWithNavigationBtnDefinitionMobile",value:function(e,t){var n=t.getDeliveryEngine().getPageMetaData().getData().processTitle,i=f.proxy(t,"doDeleteRow"),a=f.proxy(t.getView(),"save"),r=f.proxy(t,"doCopyRow"),o=[],s=t.getLinkedProcesses();if(e.allowAddNewLines&&o.push({xtype:"svmx.button",text:y().T("FSA008_TAG144","Copy Item"),handler:function(e,t){t.stopEvent(),this.parent.hide();var n=this.parent.record;r(null,n.store.indexOf(n),null,n)}}),e.allowDeleteLines&&o.push({xtype:"svmx.button",text:y().T("FSA008_TAG026","Remove Item"),handler:function(e,t){t.stopEvent(),this.parent.hide();var n=this.parent.record;i(null,n.store.indexOf(n),null,n)}}),s&&s.length>0)for(var l=0;l<s.length;l++){var c={xtype:"svmx.button",text:s[l].title,processId:s[l].processId,handler:function(e,t){var i=this,r=e.parent.record;v.readObjectFromDBCache("SHOW_ACTION_COLUMN_DIALOG").then(function(t){var o=!1,s=r.raw.Id,l=e.processId,c={recordId:s,processId:l,inPlaceNavigation:!0,store:r.store,recordIndex:r.store.indexOf(r),isLinkedSFM:!0};t&&"true"!=t?(e.parent.hide(),a(c)):f.Msg.alert({title:null,text:"",items:[{xtype:"svmx.label",text:f.string.substitute(y().T("FSA008_TAG024","Changes to {{name}} are automatically saved when you select a linked action."),{name:n})},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelAlign:"right",label:y().T("FSA008_TAG025","Don't show this again"),checked:o,listeners:{check:f.proxy(i,function(e,t){o=e.getChecked()})}}],buttons:[{text:y().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"svmx-button-square"},{text:y().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square-highlight"}]}).then(function(t){"OK"==t&&(v.writeToDBCache("SHOW_ACTION_COLUMN_DIALOG",!o),e.parent.hide(),a(c))})})}};o.push(c)}var u={header:"",cell:{encodeHtml:!1,cls:"sfm-delivery-linked-grid-cell",xtype:"widgetcell",widget:{xtype:"sfm.propertymenubutton",menuCls:"sfm-delivery-property-menu",cls:"sfm-delivery-detail-actions-button",menuItems:o}}};return u=Ext.apply(u,e)}},{key:"createWidgetColumnDefinition",value:function(e,t,n){var i={cell:{xtype:"sfm.editablewidgetcell",fieldName:e.fieldName,widget:{xtype:n,readOnly:!0},listeners:{celltap:function(e,t,n){}}},minWidth:130,maxWidth:300,contentAlign:"center"};return i=Ext.apply(i,t)}},{key:"createUrlColumnDefinition",value:function(e,t){this.isDisplayOnly&&(t.renderer=f.proxy(this,"__urlRenderer"));var n={cell:{encodeHtml:!1}};return n=Ext.apply(n,t)}},{key:"__urlRenderer",value:function(e,t,n,i,a){return f.string.substitute("<a href='{{value}}'  TARGET='_blank'>{{value}}</a>",{value:e})}},{key:"createPercentColumnDefinition",value:function(e,t){t.renderer=f.proxy(this,"__percentRenderer",e);var n={tooltip:e.fieldLabel};return n=Ext.apply(n,t)}},{key:"__formatNumber",value:function(e,t){var n="0,000";if(t>0){n+=".";for(var i=0;i<t;i++)n+="0"}return e=Ext.util.Format.number(e,n)}},{key:"__percentRenderer",value:function(e,t,n,i,a,r){var o="",s=e&&e.scale?e.scale:0,l=t||0==t?parseFloat(t):null;return isNaN(l)||(l=null!=l?this.__formatNumber(l,s):null,o=null!=l?l+"%":""),o}},{key:"createCurrencyColumnDefinition",value:function(e,t){t.renderer=f.proxy(this,"__currencyRenderer",e);var n={tooltip:e.fieldLabel};return n=Ext.apply(n,t)}},{key:"__currencyRenderer",value:function(e,t,n,i,a,r){var o=e&&e.scale?e.scale:0,s=this.__formatNumber(t,o);return null!=t?s:""}},{key:"createPicklistColumnDefinition",value:function(e,t){var n={renderer:f.proxy(this,"__pickListRenderer",e)};return n=Ext.apply(n,t)}},{key:"createMultiPicklistColumnDefinition",value:function(e,t){var n={renderer:f.proxy(this,"__multiPickListRenderer",e)};return n=Ext.apply(n,t)}},{key:"__pickListRenderer",value:function(e,t,n,i,a,r){return e.getPicklistEntryLabelFor(t)||t}},{key:"__multiPickListRenderer",value:function(e,t,n,i,a,r){return e.getPicklistEntryLabelFor(t)}},{key:"createRecordTypeColumnDefinition",value:function(e,t){var n={renderer:f.proxy(this,"__pickListRenderer",e)};return n=Ext.apply(n,t)}},{key:"createTextAreaColumnDefinition",value:function(e,t){var n={};return n=Ext.apply(n,t)}},{key:"createTextColumnDefinition",value:function(e,t){var n={};return n=Ext.apply(n,t)}},{key:"createNumberColumnDefinition",value:function(e,t){t.renderer=f.proxy(this,"__numberRenderer",e);var n={};return n=Ext.apply(n,t)}},{key:"__numberRenderer",value:function(e,t,n,i,a,r){var o=e&&e.scale?e.scale:0,s=this.__formatNumber(t,o);return null!=t?s:""}},{key:"createIntegerColumnDefinition",value:function(e,t){t.renderer=f.proxy(this,"__integerRenderer",e);var n={};return n=Ext.apply(n,t)}},{key:"__integerRenderer",value:function(e,t,n,i,a,r){var o=isNaN(t)||""==t||!t&&0!=t?null:parseFloat(t);return o=null!=o?o.toFixed(0):null,null!=o?o:""}},{key:"createToggleFieldColumnDefinition",value:function(e,t){t.renderer=function(e,t,n,i,a){return i.setEncodeHtml(!1),e="true"===e||!0===e?'<i class="fa fa-toggle-on fa-2x" aria-hidden="true" ></i>':'<i class="fa fa-toggle-off fa-2x" aria-hidden="true" ></i>'};var n={cell:{encodeHtml:!1}};return n=Ext.apply(n,t)}},{key:"createCheckboxColumnDefinition",value:function(e,t){t.renderer=function(e,t,n,i,a){return i.setEncodeHtml(!1),e="true"===e||!0===e?'<i class="fa fa-check-square-o fa-2x" aria-hidden="true" ></i>':'<i class="fa fa-square-o fa-2x" aria-hidden="true" ></i>'};var n={cell:{encodeHtml:!1},contentAlign:"center"};return n=Ext.apply(n,t)}},{key:"createDatetimeColumnDefinition",value:function(e,t){var n=(e.getRoot().getUserInfo().TimeFormat,{dataType:e.datatype,renderer:function(e,t,n,i,a){return e=p.convertToTimezone(e),p.getFormattedDatetime(e)}});return Ext.isWindows&&(t.minWidth=190),n=Ext.apply(n,t)}},{key:"createDateColumnDefinition",value:function(e,t){var n={dataType:e.datatype,renderer:function(e,t,n,i,a){return p.getFormattedDatetime(e,p.getDefaultDateFormat())}};return Ext.isWindows&&(t.minWidth=150),n=Ext.apply(n,t)}},{key:"createLookupColumnDefinition",value:function(e,t){var n=this,i={renderer:f.proxy(n,"__lookupRenderer",e),cell:{encodeHtml:!1}};return i=Ext.apply(i,t)}},{key:"__lookupRenderer",value:function(e,t,n,i,a,r){if(null==t&&(t=""),this.isDisplayOnly){var o=e.fieldName,s=n.raw[o+"__key"];if(s&&s.key&&!s.isNameSyncData){t="<a href='javascript:void(0)' onclick='"+('SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.sfmevent.platformspecifics").getInstance().showRecord({key : "'+s.key+'"});return false;')+"'>"+t+"</a>"}}return t}}]),t}(m),f.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=(n(22).View,n(19).impl),v=n(12).DatetimeUtil,g=n(5).SVMXObject,y=n(104).SVMXModel,S={name:"com.servicemax.client.sfmdelivery.ui.largemodern.historyview"},E=m,b=v,T=p.getLoggingService().getLogger("sfmdelivery-history"),M=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},I=0;S.Utils=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getIncludeOnlineBtn",value:function(e){var t=null,n=Ext.ComponentQuery.query("#"+e);return Ext.isEmpty(n)||(t=n),t}},{key:"disableButton",value:function(e){e&&(this.isArray(e)?(e||[]).forEach(function(e){e.setDisabled(!0)}):e.setDisabled(!0))}},{key:"enableButton",value:function(e){e&&(this.isArray(e)?(e||[]).forEach(function(e){e.setDisabled(!1)}):e.setDisabled(!1))}},{key:"isArray",value:function(e){return void 0!==e&&e&&e.constructor===Array}},{key:"disableGridDownloadIcon",value:function(e){(e||[]).each(function(e){"true"===e.get("online")&&(e.beginEdit(),e.set("dodstatus","offline"),e.endEdit())})}},{key:"enableGridDownloadIcon",value:function(e){(e||[]).each(function(e){"offline"===e.get("dodstatus")&&(e.beginEdit(),e.set("dodstatus",""),e.endEdit())})}},{key:"updateOnlineSearchOptionStatus",value:function(e,t){var n=this,i=this.getIncludeOnlineBtn(e),a=this.getIncludeOnlineBtn("productHistoryGridId"),r=this.getIncludeOnlineBtn("accountHistoryGridId");!1===t?(i&&this.disableButton(i),this.isArray(a)?(a||[]).forEach(function(e){n.disableGridDownloadIcon(e.getStore())}):n.disableGridDownloadIcon(a.getStore()),this.isArray(r)?(r||[]).forEach(function(e){n.disableGridDownloadIcon(e.getStore())}):n.disableGridDownloadIcon(r.getStore())):(i&&this.enableButton(i),this.isArray(a)?(a||[]).forEach(function(e){n.enableGridDownloadIcon(e.getStore())}):n.enableGridDownloadIcon(a.getStore()),this.isArray(r)?(r||[]).forEach(function(e){n.enableGridDownloadIcon(e.getStore())}):n.enableGridDownloadIcon(r.getStore()))}},{key:"filterRecords",value:function(e,t){if(e&&e.length>0&&t&&t.length>0){var n=[],i=t.map(function(e){return e.Id});e.forEach(function(e){i.indexOf(e.Id)<0&&n.push(e)}),e=n}return e}},{key:"displayToast",value:function(e){p.Msg.toast({text:e.message,duration:e.duration})}},{key:"sort",value:function(e,t){return e.sort(function(e,n){var i=e[t],a=n[t];return i>a?-1:i<a?1:0})}},{key:"getFormatedDate",value:function(e){return Ext.Date.dateFormat(new Date(e.replace(/-/g,"/")),"F d, Y")}}]),t}(g),Ext.define(S.name+".HistoryModel",{extend:y,fields:[{name:"name"},{name:"productDesc"},{name:"createdDate"}]}),Ext.define(S.name+".SFMDeliveryDownloadOnDemandHelper",{alias:"widget.sfm.delivery.dodhelper",triggerDownloadStatusEvent:function(e,t){var n=p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DOWNLOAD_STATUS_CHANGED",this,{});n.data={status:e,record:t},p.getCurrentApplication().triggerEvent(n)},downloadRecord:function(e,t){var n=this;e.beginEdit(),e.set("dodstatus","downloading"),e.endEdit(),n.triggerDownloadStatusEvent("downloading",e);var i=function(t){e.beginEdit(),e.set("dodstatus","downloaded"),e.set("online",""),e.endEdit(),I--,n.triggerDownloadStatusEvent("downloaded",e)},a=function(){e.beginEdit(),e.set("dodstatus","error"),e.set("online","true"),e.endEdit(),I--,n.triggerDownloadStatusEvent("error",e)};if(!Ext.isEmpty(e.get("Id"))){if(3===I)return p.Msg.toast({text:p.string.substitute(M().T("FSA008_TAG039"," You can download maximum of {{maxParallelDownloadCount}} record(s) at a time."),{maxParallelDownloadCount:3})}),void n.cancelDownloadRecord(e);var r=p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DOWNLOAD_RECORD_ON_DEMAND",this,{request:{data:{recordId:e.get("Id"),objectName:p.OrgNamespace+"__Service_Order__c"},dodDefer:e._dodDefer=f.Deferred()},responder:{result:p.proxy(this,i),fault:p.proxy(this,a)}});return I++,void p.getCurrentApplication().triggerEvent(r)}T.error("Record Id is not found for the Current Record ")},cancelDownloadRecord:function(e){e._dodDefer&&e._dodDefer.reject(function(e){e.success}),e.beginEdit(),e.set("dodstatus",""),e.set("online","true"),e.endEdit(),I--,this.triggerDownloadStatusEvent("cancel",e)},openRecord:function(e){var t=e.get("Id");if(Ext.isEmpty(t))T.error("Record Id not found in Field List to open the record:"+e.get("Id"));else{p.getClient().getServiceRegistry().getService("com.servicemax.client.platformspecifics").getInstance().showRecord({key:t,objectName:""})}}}),Ext.define(S.name+".ProductHistorySection",{extend:E.name+".SVMXPanel",alias:"widget.sfm.delivery.producthistorysection",cls:["sfm-process-edit"],__bindings:null,__utils:null,__syncManager:null,config:{store:null,deliveryEngine:null,woRecord:null},constructor:function(e){this.callParent(arguments),this.__utils=p.create("com.servicemax.client.sfmdelivery.ui.largemodern.historyview.Utils",this),this.__syncManager=p.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),this.__bindings=[]},bind:function(e,t,n,i){this.__bindings.push({eventBus:e,eventName:t,fn:n,context:i}),e.bind(t,n,i)},doDestroy:function(){p.array.forEach(this.__bindings,function(e){e.eventBus.unbind(e.eventName,e.fn,e.context)}),this.__bindings.setLength=null,this.setWoRecord(null),this.getStore()&&this.getStore().destroy(),this.__syncManager=null,this.config=null,this.__utils.doCleanup(),this.__utils=null,this.callParent()},updateOptions:function(e){this.setWoRecord(e.record),this.setTitle(M().T("FSA008_TAG040","Product History"))},ready:function(){this.getHeader().add(this.__getHeaderButton()),this.__buildUI(),this.__searchProdHistoryRecords({includeOnlineResult:!1,callback:p.proxy(this,"__onloadButtonStatus")}),this.bind(this.__syncManager,"CONNECTIVITY_CHANGED",this.__connectionHandler,this)},__getHeaderButton:function(){return{xtype:"svmx.button",ui:"svmx-default",itemId:"includeOnlineButtonProd",disabledCls:"sfmdelivery-history-include-online-disabled",html:M().T("FSA008_TAG041","Include Online"),cls:"sfmdelivery-history-include-online-enabled",handler:p.proxy(this,function(){this.__searchProdHistoryRecords({includeOnlineResult:!0})})}},__onloadButtonStatus:function(){var e=this;this.__syncManager.checkConnectivity().then(function(){},function(t){var n=e.__utils.getIncludeOnlineBtn("includeOnlineButtonProd");e.__utils.disableButton(n),console.log("Product History, there is no connectivity, disabling Include Online button. Disabled Include Online button")})},__connectionHandler:function(e){var t=e.data.isConnected;this.__utils.updateOnlineSearchOptionStatus("includeOnlineButtonProd",t)},__buildUI:function(){var e=this;this.setStore(Ext.widget("svmx.store",{model:S.HistoryModel}));var t={xtype:"svmx.grid",layout:"fit",cls:"sfm-delivery-detail-grid",width:"100%",pinHeaders:!1,autoHeight:!0,itemHeight:60,itemId:"productHistoryGridId",store:this.getStore(),listeners:{itemtap:p.proxy(this,this.doItemTap)},columns:[{text:M().T("FSA008_TAG042","Service Date"),itemId:"createdDate",dataIndex:"createdDate",renderer:e.__utils.getFormatedDate,flex:.3,cell:{xtype:"gridcell",cls:"sfmdelivery-history-grid-cell",innerCls:"sfmdelivery-history-grid-cell-inner",encodeHtml:!1}},{text:M().T("FSA008_TAG043","Work Order Number"),itemId:"name",dataIndex:"name",flex:.3,cell:{xtype:"gridcell",cls:"sfmdelivery-history-grid-cell",innerCls:"sfmdelivery-history-grid-cell-inner",encodeHtml:!1}},{text:M().T("FSA008_TAG019","Description"),itemId:"productDesc",dataIndex:"productDesc",flex:.3,cell:{xtype:"gridcell",cls:"sfmdelivery-history-grid-cell-desc",innerCls:"sfmdelivery-history-grid-cell-desc-inner",encodeHtml:!1}},{text:"",flex:.1,align:"right",dataIndex:"dodstatus",cell:{xtype:"gridcell",align:"right",cls:"sfmdelivery-history-grid-cell",innerCls:"sfmdelivery-history-grid-cell-inner",encodeHtml:!1},renderer:function(e,t,n,i,a){var r="",o=t.get("dodstatus"),s=!Ext.isEmpty(t.get("online"));return s&&"offline"===o?r='<i class="icon-cloud-download sfmdelivery-history-dod-disabled"></i>':s&&"error"===o?r='<i class="icon-cloud-error sfmdelivery-history-dod-error"></i>':s&&"downloading"===o?r='<span class="sfmdelivery-history-dod sfmdelivery-history-dod-downloading">'+M().T("FSA008_TAG044","Downloading...")+' </span> | <span><a class="sfmdelivery-history-dod sfmdelivery-history-dod-cancel-link">'+M().T("FSA008_TAG045","Cancel Download ")+"</a></span>":s&&!o&&(r='<a></a><i class="icon-cloud-download sfmdelivery-history-download-icon"></i></a>'),"<div class='sfmdelivery-history-dod-cell'>"+r+"</div>"}}]};this.add(t)},__searchProdHistoryRecords:function(e){var t=this,n=null,i=this.getDeliveryEngine().getEventBus();e&&e.includeOnlineResult&&(n=this.__utils.getIncludeOnlineBtn("includeOnlineButtonProd"),this.__utils.disableButton(n));var a=p.create("com.servicemax.client.sfmconsole.utils.EventCollection",i,[]);a.addEvent(p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_PRODUCT_HISTORY",this,{request:{deliveryEngine:this.getDeliveryEngine(),woRecord:this.getWoRecord()}})),e&&e.includeOnlineResult&&(t.__utils.displayToast({message:M().T("FSA008_TAG033","Searching Online History"),duration:6e4}),a.addEvent(p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_ONLINE_PRODUCT_HISTORY",this,{request:{deliveryEngine:this.getDeliveryEngine(),woRecord:this.getWoRecord()}}))),a.triggerAll(p.proxy(this,function(i){var a=i.items(),r=[],o=[],s=[],l=0;p.array.forEach(a,function(e){switch(e.type()){case"SFMDELIVERY.GET_PRODUCT_HISTORY":e.response&&(o=e.response||[]);break;case"SFMDELIVERY.GET_ONLINE_PRODUCT_HISTORY":e.response&&(s=e.response||[])}},this);var c=t.__utils.filterRecords(s,o);c&&c.length>0&&c.forEach(function(e){e.createdDate=b.convertToTimezone(e.createdDate),r.push(e)}),o&&o.length>0&&o.forEach(function(e){e.createdDate=b.convertToTimezone(e.createdDate),r.push(e)}),r&&r.length>0&&(r=t.__utils.sort(r,"name"),r&&r.length>50&&r.slice(0,50),this.getStore().setData(r)),l=r?r.length:0,this.getHeader()&&this.getHeader().setTitle(p.string.substitute(M().T("FSA008_TAG046"," Product History ( {{recordCount}} )"),{recordCount:l})),e&&e.includeOnlineResult&&(t.__utils.enableButton(n),t.__utils.displayToast({message:M().T("FSA008_TAG047","Online History search Complete"),duration:5e3})),e&&e.callback&&e.callback.call()}))},doItemTap:function(e,t,n,i,a,r){var o=Ext.get(a.target),s=Ext.valueFrom(i.get("dodstatus"),""),l="true"===i.get("online"),c=Ext.create(S.name+".SFMDeliveryDownloadOnDemandHelper",{});l&&"downloading"===s||o.hasCls("sfmdelivery-history-dod-cancel-link")?c.cancelDownloadRecord(i):l&&Ext.isEmpty(s)&&"error"!=s&&"offline"!=s&&o.hasCls("sfmdelivery-history-download-icon")?c.downloadRecord(i,e.currentSearchDetails):l||c.openRecord(i)}}),Ext.define(S.name+".AccountHistorySection",{extend:E.name+".SVMXPanel",alias:"widget.sfm.delivery.accounthistorysection",cls:["sfm-process-edit"],__bindings:null,__utils:null,__syncManager:null,config:{store:null,deliveryEngine:null,woRecord:null},constructor:function(e){this.callParent(arguments),this.__utils=p.create("com.servicemax.client.sfmdelivery.ui.largemodern.historyview.Utils",this),this.__syncManager=p.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance(),this.__bindings=[]},bind:function(e,t,n,i){this.__bindings.push({eventBus:e,eventName:t,fn:n,context:i}),e.bind(t,n,i)},doDestroy:function(){p.array.forEach(this.__bindings,function(e){e.eventBus.unbind(e.eventName,e.fn,e.context)}),this.__bindings.setLength=null,this.setWoRecord(null),this.getStore()&&this.getStore().destroy(),this.__syncManager=null,this.config=null,this.__utils.doCleanup(),this.__utils=null,this.callParent()},updateOptions:function(e){this.setWoRecord(e.record),this.setTitle(M().T("FSA008_TAG048","Account History"))},ready:function(){this.getHeader().add(this.__getHeaderButton()),this.__buildUI(),this.__searchAcctHistoryRecords({includeOnlineResult:!1,callback:p.proxy(this,"__onloadButtonStatus")}),this.bind(this.__syncManager,"CONNECTIVITY_CHANGED",this.__connectionHandler,this)},__getHeaderButton:function(){return{xtype:"svmx.button",ui:"svmx-default",itemId:"includeOnlineButtonAcct",disabledCls:"sfmdelivery-history-include-online-disabled",html:M().T("FSA008_TAG041","Include Online"),cls:"sfmdelivery-history-include-online-enabled",handler:p.proxy(this,function(){this.__searchAcctHistoryRecords({includeOnlineResult:!0})})}},__onloadButtonStatus:function(){var e=this;this.__syncManager.checkConnectivity().then(function(){},function(t){var n=e.__utils.getIncludeOnlineBtn("includeOnlineButtonAcct");e.__utils.disableButton(n),console.log("Account History, there is no connectivity, disabling Include Online button. Disabled Include Online button")})},__connectionHandler:function(e){var t=e.data.isConnected;this.__utils.updateOnlineSearchOptionStatus("includeOnlineButtonAcct",t)},__buildUI:function(){var e=this;this.setStore(Ext.widget("svmx.store",{model:S.HistoryModel}));var t={xtype:"svmx.grid",layout:"fit",cls:"sfm-delivery-detail-grid",width:"100%",pinHeaders:!1,itemHeight:60,autoHeight:!0,itemId:"accountHistoryGridId",store:this.getStore(),listeners:{itemtap:p.proxy(this,this.doItemTap)},columns:[{text:M().T("FSA008_TAG042","Service Date"),itemId:"createdDate",dataIndex:"createdDate",renderer:e.__utils.getFormatedDate,flex:.3,cell:{xtype:"gridcell",cls:"sfmdelivery-history-grid-cell",innerCls:"sfmdelivery-history-grid-cell-inner",encodeHtml:!1}},{text:M().T("FSA008_TAG043","Work Order Number"),itemId:"name",dataIndex:"name",flex:.3,cell:{xtype:"gridcell",cls:"sfmdelivery-history-grid-cell",innerCls:"sfmdelivery-history-grid-cell-inner",encodeHtml:!1}},{text:M().T("FSA008_TAG019","Description"),itemId:"productDesc",dataIndex:"productDesc",flex:.3,cell:{xtype:"gridcell",cls:["sfmdelivery-history-grid-cell-desc"],innerCls:["sfmdelivery-history-grid-cell-desc-inner"],encodeHtml:!1}},{text:"",flex:.1,dataIndex:"dodstatus",cell:{xtype:"gridcell",cls:"sfmdelivery-history-grid-cell",innerCls:"sfmdelivery-history-grid-cell-inner",encodeHtml:!1},renderer:function(e,t,n,i,a){var r="",o=t.get("dodstatus"),s=!Ext.isEmpty(t.get("online"));return s&&"offline"===o?r='<i class="icon-cloud-download sfmdelivery-history-dod-disabled"></i>':s&&"error"===o?r='<i class="icon-cloud-error sfmdelivery-history-dod-error"></i>':s&&"downloading"===o?r='<span class="sfmdelivery-history-dod sfmdelivery-history-dod-downloading">'+M().T("FSA008_TAG044","Downloading...")+' </span> | <span><a class="sfmdelivery-history-dod sfmdelivery-history-dod-cancel-link">'+M().T("FSA008_TAG045","Cancel Download ")+"</a></span>":s&&!o&&(r='<a></a><i class="icon-cloud-download sfmdelivery-history-download-icon"></i></a>'),"<div class='sfmdelivery-history-dod-cell'>"+r+"</div>"}}]};this.add(t)},__searchAcctHistoryRecords:function(e){var t=this,n=null,i=this.getDeliveryEngine().getEventBus();e&&e.includeOnlineResult&&(n=this.__utils.getIncludeOnlineBtn("includeOnlineButtonAcct"),this.__utils.disableButton(n));var a=p.create("com.servicemax.client.sfmconsole.utils.EventCollection",i,[]);a.addEvent(p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_ACCOUNT_HISTORY",this,{request:{deliveryEngine:this.getDeliveryEngine(),woRecord:this.getWoRecord()}})),e&&e.includeOnlineResult&&(t.__utils.displayToast({message:M().T("FSA008_TAG033","Searching Online History"),duration:6e4}),a.addEvent(p.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.GET_ONLINE_ACCOUNT_HISTORY",this,{request:{deliveryEngine:this.getDeliveryEngine(),woRecord:this.getWoRecord()}}))),a.triggerAll(p.proxy(this,function(i){var a=i.items(),r=[],o=[],s=[],l=0;p.array.forEach(a,function(e){switch(e.type()){case"SFMDELIVERY.GET_ACCOUNT_HISTORY":e.response&&(o=e.response||[]);break;case"SFMDELIVERY.GET_ONLINE_ACCOUNT_HISTORY":e.response&&(s=e.response||[])}},this);var c=t.__utils.filterRecords(s,o);c&&c.length>0&&c.forEach(function(e){e.createdDate=b.convertToTimezone(e.createdDate),r.push(e)}),o&&o.length>0&&o.forEach(function(e){e.createdDate=b.convertToTimezone(e.createdDate),r.push(e)}),r&&r.length>0&&(r=t.__utils.sort(r,"name"),r&&r.length>50&&r.slice(0,50),this.getStore().setData(r)),l=r?r.length:0,this.getHeader()&&this.getHeader().setTitle(p.string.substitute(M().T("FSA008_TAG115"," Account History ( {{recordCount}} )"),{recordCount:l})),e&&e.includeOnlineResult&&(console.log("Enabling Include Online Button"),t.__utils.enableButton(n),t.__utils.displayToast({message:M().T("FSA008_TAG047","Online History search Complete"),duration:5e3})),e&&e.callback&&e.callback.call()}))},doItemTap:function(e,t,n,i,a,r){var o=Ext.get(a.target),s=Ext.valueFrom(i.get("dodstatus"),""),l="true"===i.get("online"),c=Ext.create(S.name+".SFMDeliveryDownloadOnDemandHelper",{});l&&"downloading"===s||o.hasCls("sfmdelivery-history-dod-cancel-link")?c.cancelDownloadRecord(i):l&&Ext.isEmpty(s)&&"error"!=s&&"offline"!=s&&o.hasCls("sfmdelivery-history-download-icon")?c.downloadRecord(i,e.currentSearchDetails):l||c.openRecord(i)}}),p.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(10),p=n(0).utils,m=(n(12).DatetimeUtil,n(11).Facade),v=n(7).MetaData,g=n(5).SVMXObject,y={name:"com.servicemax.client.sfmdelivery.ui.largemodern.productiq"},S=function(){return p.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},E=m,b=v;y.ProductIQ=function(e){function t(e){(0,s.default)(this,t),e||(e={});var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__serviceFlowWizardDisplay=null,n.initialize(e),n.__serviceFlowWizardDisplay=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(e){this.initializeProductIQServiceFlowWizardData()}},{key:"execQuery",value:function(e){var t=f.Deferred(),n=E.createSQLRequest();return n.bind("REQUEST_COMPLETED",function(e){t.resolve(e.data.data)}),n.bind("REQUEST_ERROR",function(e){t.reject(e.data.data)}),n.execute({query:e.query,queryParams:e.queryParams}),t}},{key:"__queryAccountID",value:function(e){var t=p.Deferred();return this.execQuery({query:e.query,queryParams:e.queryParams}).then(p.proxy(this,function(n){if(n&&0!=n.length){var i=n[0][e.accountFieldName];t.resolve(i)}else t.resolve(null)})),t}},{key:"isProductIQEnabled",value:function(){return p.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance().isProductIQEnabled()}},{key:"initializeProductIQServiceFlowWizardData",value:function(){var e=this;e.__getUserConfig().done(p.proxy(this,function(t){e.__serviceFlowWizardDisplay=t.serviceFlowWizardDisplay}))}},{key:"shouldEnableOpenTreeViewForSelectedObject",value:function(e){var t=this,n=!0,i=e&&e.attributes&&e.attributes.type,a=p.getCustomObjectName("Service_Order"),r=p.getCustomObjectName("Installed_Product"),o=p.getCustomObjectName("Site"),s=t.__serviceFlowWizardDisplay;return s&&(i===a?n=s.isOpenTreeViewActionEnabledForWO:i===r?n=s.isOpenTreeViewActionEnabledForInstallBase:i===o&&(n=s.isOpenTreeViewActionEnabledForLocation)),n}},{key:"__getUserConfig",value:function(){var e=p.Deferred();return this.execQuery({query:"SELECT c.Value  FROM  Configuration AS c  WHERE c.Type = '{{type}}' ",queryParams:{type:"user"}}).then(p.proxy(this,function(t){var n={};t&&t[0]&&t[0].Value&&(n=p.toObject(t[0].Value)),e.resolve(n)})),e}},{key:"__getUserState",value:function(){var e=p.Deferred();return this.execQuery({query:"SELECT c.Value  FROM  Configuration AS c  WHERE c.Type = '{{type}}' ",queryParams:{type:"state"}}).then(p.proxy(this,function(t){var n={};t&&t[0]&&t[0].Value&&(n=p.toObject(t[0].Value)),e.resolve(n)})),e}},{key:"launchProductIQ",value:function(e){window.cordova?SVMXPlugin.setOrientation("LANDSCAPE",p.proxy(this,this.onInit(e))):this.onInit(e)}},{key:"onInit",value:function(e){var t=null;t="laptop"==p.getClient().getApplicationParameter("client-type").toLowerCase()?"installigence-index.html":"installigence-embedded-index.html";var n={};n.back=S().T("FSA002_TAG007","Back"),n.productiq=S().T("FSA008_TAG090","ProductIQ");var i=Ext.create({xtype:"svmx.productiqwindow",itemId:"productIQSheetAsWindow",src:t,message:e.message,tags:n});Ext.Viewport.add(i).show()}},{key:"getProductIQActionWizardData",value:function(e,t){var n=this,i=null,a=p.OrgNamespace+"__Service_Order__c",r=e&&e.attributes&&e.attributes.type,o=p.OrgNamespace+"__Installed_Product__c",s=p.OrgNamespace+"__Site__c";if(a===r){var l=this.__checkHaveProductsServiced(e);l&&(i={action_description:S().T("TODO",""),action_id:"",action_name:S().T("FSA008_TAG091","Open tree view"),class_name:"",expressionPassed:l,expression_id:"",local_id:"999999",method_name:"",perform_sync:"false",process_id:"Products Serviced",sequence:"1.00",wizard_id:"",actionType:"OPEN_TREE_VIEW",productIQObject:n})}return r!==o&&r!==s||(i={action_description:S().T("TODO",""),action_id:"",action_name:S().T("FSA008_TAG091","Open tree view"),class_name:"",expressionPassed:l,expression_id:"",local_id:"999999",method_name:"",perform_sync:"false",process_id:"View",sequence:"1.00",wizard_id:"",actionType:"OPEN_TREE_VIEW",productIQObject:n}),i&&n.__getProductIQExternaActionlData(i,t),i}},{key:"__getProductIQExternaActionlData",value:function(e,t){var n=this,i=t.getOption("SVMX_recordId"),a=t.getRecord(),r=a.attributes.type,o=null,s=a.Id,l=e.process_id;n.__getAccountID({objectName:r,record:a}).done(p.proxy(this,function(t){null!=t&&t.length>0&&(o=t),n.__getAccountName(t).done(function(t){var c=void 0;t&&t.length>0&&(c=t[0].Name);var u={action:"VIEW",recordIds:[i],object:r,accountId:o,accountName:c,recordID:s};if(e.message=u,"Products Serviced"!==l)return e;n.getProductsServicedSerials(a).done(function(t){if(t&&t.length)return u={action:"VIEW",recordIds:t,object:r,sourceRecordName:a.Name||"",accountId:o,accountName:c,recordID:s},e.message=u,e})})}))}},{key:"__checkHaveProductsServiced",value:function(e){var t=!1,n=(p.OrgNamespace,void 0),i=void 0;if(t||(t=this.__hasInstalledProductField(e)),!t&&e.details)for(var a in e.details)for(i=e.details[a].lines.length,n=0;!t&&n<i;n++){var r=e.details[a].lines[n];t=this.__hasInstalledProductField(r)}return t}},{key:"__hasInstalledProductField",value:function(e){var t=void 0,n=void 0,i=!1,a=p.OrgNamespace+"__Installed_Product__c";if(e&&e._fields&&e._fields.fields){n=e._fields.fields;for(var r in n)if(n.hasOwnProperty(r)&&(t=n[r])&&t.referenceTo&&t.referenceTo instanceof Array)for(var o=0;o<t.referenceTo.length;o++)if(t.referenceTo[o]==a){var s=t.name,l=e[s];if(l&&l.fieldvalue&&l.fieldvalue.key){i=!0;break}}}return i}},{key:"__getAccountID",value:function(e){var t=p.Deferred(),n=e.objectName;return n==p.OrgNamespace+"__Service_Order__c"?this.__getAccountIDFromWorkOrder(e).done(p.proxy(this,function(e){t.resolve(e)})):n==p.OrgNamespace+"__Installed_Product__c"?this.__getAccountIDFromIB(e).done(p.proxy(this,function(e){t.resolve(e)})):n==p.OrgNamespace+"__Site__c"?this.__getAccountIDFromLocation(e).done(p.proxy(this,function(e){t.resolve(e)})):t.resolve(null),t}},{key:"__getAccountName",value:function(e){var t=p.Deferred();return this.execQuery({query:"SELECT c.Name  FROM  Account AS c  WHERE c.Id = '{{accountId}}' ",queryParams:{accountId:e}}).then(p.proxy(this,function(e){t.resolve(e)})),t}},{key:"__getAccountIDFromWorkOrder",value:function(e){var t=p.Deferred(),n=e.record,i=e.objectName,a=p.OrgNamespace+"__Component__c",r=p.OrgNamespace+"__Site__c",o=p.OrgNamespace+"__Account__c",s=p.OrgNamespace+"__Company__c",l=p.OrgNamespace+"__Site__c";if(i==p.OrgNamespace+"__Service_Order__c")if(n[a]&&n[a].fieldvalue.key){var c=n[a].fieldvalue.key,u=p.OrgNamespace+"__Installed_Product__c";this.__queryAccountID({query:"SELECT c.Id,  c."+s+" FROM "+u+" AS c  WHERE  c.Id = '{{woComponentID}}' ",queryParams:{woComponentID:c},accountFieldName:s}).done(p.proxy(this,function(e){e&&e.length>0?t.resolve(e):this.execQuery({query:"SELECT c.Id,  c."+l+" FROM "+u+" AS c  WHERE  c.Id = '{{woComponentID}}' ",queryParams:{woComponentID:c}}).then(p.proxy(this,function(e){if(e&&0!=e.length){var n=e[0][l],i=p.OrgNamespace+"__Site__c";this.__queryAccountID({query:"SELECT c.Id,  c."+o+" FROM "+i+" AS c  WHERE  c.Id = '{{locId}}' ",queryParams:{locId:n},accountFieldName:o}).done(p.proxy(this,function(e){t.resolve(e)}))}else t.resolve(null)}))}))}else if(n[r]&&n[r].fieldvalue.key){var d=n[r].fieldvalue.key,_=p.OrgNamespace+"__Site__c";this.__queryAccountID({query:"SELECT c.Id,  c."+o+" FROM "+_+" AS c  WHERE  c.Id = '{{locId}}' ",queryParams:{locId:d},accountFieldName:o}).done(p.proxy(this,function(e){t.resolve(e)}))}else t.resolve(null);else t.resolve(null);return t}},{key:"__getAccountIDFromIB",value:function(e){var t=p.Deferred(),n=e.record,i=e.objectName,a=p.OrgNamespace+"__Company__c",r=p.OrgNamespace+"__Site__c";if(i==p.OrgNamespace+"__Installed_Product__c")if(n[a]&&n[a].fieldvalue.key){var o=n[a].fieldvalue.key;t.resolve(o)}else if(n[r]&&n[r].fieldvalue.key){var s=n[r].fieldvalue.key,l=p.OrgNamespace+"__Site__c",c=p.OrgNamespace+"__Account__c";this.__queryAccountID({query:"SELECT c.Id,  c."+c+" FROM "+l+" AS c  WHERE  c.Id = '{{locId}}' ",queryParams:{locId:s},accountFieldName:c}).done(p.proxy(this,function(e){t.resolve(e)}))}else t.resolve(null);else t.resolve(null);return t}},{key:"__getAccountIDFromLocation",value:function(e){var t=p.Deferred(),n=null,i=p.OrgNamespace+"__Account__c",a=e.record;return e.objectName===p.OrgNamespace+"__Site__c"&&a[i]&&a[i].fieldvalue.key?(n=a[i].fieldvalue.key,t.resolve(n)):t.resolve(null),t}},{key:"getProductsServicedSerials",value:function(e){var t=this,n=p.Deferred(),i=void 0,a=this.__extractInstalledProductField(e),r=p.OrgNamespace+"__Service_Order_Line__c",o=E.createSQLRequest();return o.bind("REQUEST_COMPLETED",function(e){var o=e.data.data;o.length||n.resolve(a),b.describeObject({objectName:r,onSuccess:function(e){for(var r=0;r<o.length;r++){var s=o[r];s._fields={fields:e.fields};var l=t.__extractInstalledProductField(s);for(i=0;i<l.length;i++)-1==a.indexOf(l[i])&&a.push(l[i])}n.resolve(a)}})}),o.bind("REQUEST_ERROR",function(e){p.getLoggingService().getLogger("Error retrieving details")}),o.execute({query:"SELECT * FROM "+p.OrgNamespace+"__Service_Order_Line__c WHERE "+p.OrgNamespace+"__Service_Order__c = '"+e.Id+"'"}),n}},{key:"__extractInstalledProductField",value:function(e){var t=void 0,n=void 0,i=p.OrgNamespace+"__Installed_Product__c",a=[];if(e&&e._fields&&e._fields.fields){n=e._fields.fields;for(var r in n)if(n.hasOwnProperty(r)&&(t=n[r])&&t.referenceTo&&t.referenceTo instanceof Array)for(k=0;k<t.referenceTo.length;k++)if(t.referenceTo[k]==i){var o=t.name,s=e[o],l="string"==typeof s?s:s&&s.fieldvalue&&s.fieldvalue.key;l&&-1==a.indexOf(l)&&a.push(l)}}return a}}]),t}(g),p.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=(n(11).Facade,n(5).SVMXObject),m={name:"com.servicemax.client.sfmdelivery.ui.largemodern.mobileinventory"},v=f.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance();m.MobileInventory=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"isLocatePartEnabled",value:function(){var e=f.Deferred();if(v.isMobileInventoryEnabled()){var t=f.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_META_DATA",this,{request:{},responder:{result:function(t){var n=!!(t&&t.metaData&&t.metaData.locatepartsetup&&t.metaData.locatepartsetup.isenabled)&&("string"==typeof t.metaData.locatepartsetup.isenabled?"true"===t.metaData.locatepartsetup.isenabled.toLowerCase():t.metaData.locatepartsetup.isenabled);e.resolve(n)},fault:function(){e.resolve(!1)}}});f.getCurrentApplication().triggerEvent(t)}else f.doLater(function(){e.resolve(!1)});return e}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(806),a=n(811),r=n(812),o=n(813),s=n(814),l=n(0).utils;l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.consoleapp","config":{"app":{"id":"sfmopdocdelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},"views":[{"id":"opdochome","class-name":"com.servicemax.client.sfmopdocdelivary.ui.largemodern.opdocview.OPDocView","default-view":true}],"discover":false,"multiple":false}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"MODEL","data":[{"operationId":"SFMOPDOCDELIVERY.CAPTURE_HTML_SIGNATURE","operation":"com.servicemax.client.sfmopdocdelivery.ui.largemodern.operations.CaptureHtmlSignature"},{"operationId":"SFMOPDOCDELIVERY.PURGE_ORPHAN_SIGNATURES","operation":"com.servicemax.client.sfmopdocdelivery.ui.largemodern.operations.PurgeOrphanSignatures"}]}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMOPDOCDELIVERY.MISSING_TEMPLATE","command":"com.servicemax.client.sfmopdocdelivery.ui.largemodern.commands.MissingTemplate"}]}}}')),e.exports={impl:i,opdocview:a,api:r,commands:o,operations:s}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m=(n(807).opdocview,{name:"com.servicemax.client.sfmopdocdelivery.ui.largemodern.impl"});m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(p),window.opDocImg=function(e){var t=e||event.currentTarget;if(t&&t.offsetHeight){t.offsetHeight/t.offsetWidth>1.29?t.offsetHeight>=905&&(t.style.height="905px"):t.offsetWidth>=650&&(t.style.width="650px")}},f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(808),a=n(809),r=n(810),o=n(419),s=n(418),l=n(190),c=n(0).utils;c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"sfmopdocdelivery","class-name":"com.servicemax.client.sfmopdocdelivery.engine.DeliveryEngineImpl"}}}')),c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMOPDOCDELIVERY.GET_TEMPLATE","command":"com.servicemax.client.sfmopdocdelivery.commands.GetTemplate"},{"event":"SFMOPDOCDELIVERY.SUBMIT_DOCUMENT","command":"com.servicemax.client.sfmopdocdelivery.commands.SubmitDocument"},{"event":"SFMOPDOCDELIVERY.CREATE_PDF","command":"com.servicemax.client.sfmopdocdelivery.commands.CreatePDF"},{"event":"SFMOPDOCDELIVERY.VIEW_DOCUMENT","command":"com.servicemax.client.sfmopdocdelivery.commands.ViewDocument"},{"event":"SFMOPDOCDELIVERY.GET_USERINFO","command":"com.servicemax.client.sfmopdocdelivery.commands.GetUserInfo"},{"event":"SFMOPDOCDELIVERY.GET_DOCUMENT_METADATA","command":"com.servicemax.client.sfmopdocdelivery.commands.GetDocumentMetadata"},{"event":"SFMOPDOCDELIVERY.GET_DOCUMENT_DATA","command":"com.servicemax.client.sfmopdocdelivery.commands.GetDocumentData"},{"event":"SFMOPDOCDELIVERY.DESCRIBE_OBJECT","command":"com.servicemax.client.sfmopdocdelivery.commands.DescribeObject"},{"event":"SFMOPDOCDELIVERY.CAPTURE_SIGNATURE","command":"com.servicemax.client.sfmopdocdelivery.commands.CaptureSignature"},{"event":"SFMOPDOCDELIVERY.CAPTURE_HTML_SIGNATURE","command":"com.servicemax.client.sfmopdocdelivery.commands.CaptureHtmlSignature"},{"event":"SFMOPDOCDELIVERY.PURGE_ORPHAN_SIGNATURES","command":"com.servicemax.client.sfmopdocdelivery.commands.PurgeOrphanSignatures"},{"event":"SFMOPDOCDELIVERY.FINALIZE","command":"com.servicemax.client.sfmopdocdelivery.commands.Finalize"},{"event":"SFMOPDOCDELIVERY.TARGET_UPDATES","command":"com.servicemax.client.sfmopdocdelivery.commands.TargetUpdates"},{"event":"SFMOPDOCDELIVERY.NOTIFY_DATA_CHANGE","command":"com.servicemax.client.sfmopdocdelivery.commands.NotifyDataChange"},{"event":"SFMOPDOCDELIVERY.GET_DISPLAY_TAGS","command":"com.servicemax.client.sfmopdocdelivery.commands.GetDisplayTags"}]}}}')),c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"NODE_PROCESSOR","type":"com.servicemax.client.sfmopdocdelivery.engine.NodeProcessor"}}}')),c.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"NODE_PROCESSOR","data":[{"nodeType":"DIV","processor":"com.servicemax.client.sfmopdocdelivery.engine.DivNodeProcessor"},{"nodeType":"TABLE","processor":"com.servicemax.client.sfmopdocdelivery.engine.TableNodeProcessor"},{"nodeType":"IMG","processor":"com.servicemax.client.sfmopdocdelivery.engine.ImageNodeProcessor"},{"nodeType":"TD","processor":"com.servicemax.client.sfmopdocdelivery.engine.TdNodeProcessor"},{"nodeType":"ILDIV","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineDivNodeProcessor"},{"nodeType":"ILSTRONG","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineStrongNodeProcessor"},{"nodeType":"ILU","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineUnderlineNodeProcessor"},{"nodeType":"ILI","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineItalicNodeProcessor"},{"nodeType":"ILP","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineParaNodeProcessor"},{"nodeType":"ILPRE","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlinePreNodeProcessor"},{"nodeType":"ILH","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineHeadingNodeProcessor"},{"nodeType":"ILS","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineStyleNodeProcessor"},{"nodeType":"ILSP","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineSpanNodeProcessor"},{"nodeType":"ILEM","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineEMNodeProcessor"},{"nodeType":"ILSTRIKE","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineStrikeNodeProcessor"},{"nodeType":"ILSUB","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineSubNodeProcessor"},{"nodeType":"ILSUP","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineSupNodeProcessor"},{"nodeType":"ILOL","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineOlNodeProcessor"},{"nodeType":"ILLI","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineLiNodeProcessor"},{"nodeType":"ILUL","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineUlNodeProcessor"},{"nodeType":"ILB","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineBoldNodeProcessor"},{"nodeType":"ILTD","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineTDNodeProcessor"},{"nodeType":"ILTH","processor":"com.servicemax.client.sfmopdocdelivery.engine.InlineTHNodeProcessor"}]}}}')),e.exports={impl:i,engine:a,commands:r,jsel:o,constants:s,utils:l}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.sfmopdocdelivery.impl"};y.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){y.init(),y.init(),y.init(),y.init()}}]),t}(v),y.SFMOPDOCDeliveryEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFMOPDOCDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function a(e){return e&&e.__esModule?e:{default:e}}var r=n(18),o=a(r),s=n(16),l=a(s),c=n(50),u=a(c),d=n(1),_=a(d),h=n(2),f=a(h),p=n(3),m=a(p),v=n(6),g=a(v),y=n(4),S=a(y),E=n(14),b=a(E),T=n(10),M=n(0).utils,I=n(418).Constants,C=n(419).JSExpressionEngine,A=n(33).AbstractDeliveryEngine,D=(n(190).SFMOPDOCUtils,n(0).api),x=n(12).DatetimeUtil,R=n(5).SVMXObject,O=n(372),L=n(129).AbstractNamedInstance,k={name:"com.servicemax.client.sfmopdocdelivery.engine"},N=I;k.DeliveryEngineImpl=function(e){function t(){(0,f.default)(this,t);var e=(0,m.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments));return e.__nodeProcessor=null,e.__orgNamespace=null,e.styleNodeValue=null,e.__timeFormat=null,e.__dateFormat=null,e.__uniqueObjects=null,e.__depthCount=2,e.__jsee=null,e.__pendingNodeItems=null,e.__metadata=null,e.__data=null,e.__processedMetadata=null,e.__recsInfo=null,e.__aliasObjectName=null,e.__aliasDescribeInfo=null,e.__imageIds=null,e.__eventBus=null,e.__signaturesPending=null,e.__allowSignatures=null,e.__allowDraft=null,e.__spinner=null,e.__displayTags=null,e.__settings=null,e.__recordId=null,e.__processId=null,e.__sourceRecord=null,e.__objectLabel=null,e.__isCheckListProcess=!1,e.__isLightning=null,e.__isSalesForceIsInLightning=null,e.__generatedRecordId=null,e}return(0,S.default)(t,e),(0,g.default)(t,[{key:"initAsync",value:function(e){var t=M.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=M.create("com.servicemax.client.sfmopdocdelivery.impl.SFMOPDOCDeliveryEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(t){n.setModel(t),e.handler.call(e.context)},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"doCleanup",value:function(){this.setPropertyForCleanup(["__eventBus","__jsee","__pendingNodeItems","__signaturesPending","__nodeProcessor","__metadata","__data","__displayTags"],!0),delete window.$D,delete window.$M,delete this.__spinner,(0,b.default)(t.prototype.__proto__||(0,_.default)(t.prototype),"doCleanup",this).call(this)}},{key:"run",value:function(e){void 0!==e&&null!==e&&void 0!==e.options&&null!==e.options&&(this.__processId=e.options.SVMX_processId,this.__recordId=e.options.SVMX_recordId,this.__processName=e.options.SVMX_processName,this.changeStyleSignature=e.changeStyleSignature,this.removeSignatureButtons=e.removeSignatureButtons,this.createSignatureButtons=e.createSignatureButtons,this.addReplaceCapturedSignature=e.addReplaceCapturedSignature,this.onEngineRendered=e.onRendered,this.__sourceRecord=e.options.SVMX_record),this.__isLightning=M.getClient().getApplicationParameter("lightning"),this.__isSalesForceIsInLightning=M.getClient().getApplicationParameter("isSalesforceLightning"),void 0!==this.__processId&&null!==this.__processId||(this.__processId=M.getUrlParameter("SVMX_processId")),void 0!==this.__recordId&&null!==this.__recordId||(this.__recordId=M.getUrlParameter("SVMX_recordId")),M.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance().createNamedInstanceAsync("NODE_PROCESSOR",{handler:function(t){this.__nodeProcessor=t,this.__orgNamespace=M.getClient().getApplicationParameter("org-name-space"),this.__allowSignatures=M.getClient().getApplicationParameter("allow-signatures"),this.__allowDraft=M.getClient().getApplicationParameter("allow-draft"),this.__runInternal(e)},context:this})}},{key:"__runInternal",value:function(e){this.__rootNode=e.container?e.container.body.dom:T("#"+M.getDisplayRootId()),this.__rootNode.css("width","100%"),T(T("body")[0]).css("background-image","none");var t=M.getClient().getServiceRegistry().getService("com.servicemax.client.sfmopdoc.platformspecifics").getInstance();this.returnUrl=M.getUrlParameter("SVMX_retURL");t.getQualificationInfo(this.__recordId,this.__processId,this.__process,this);this.__requestClose=e.requestClose,this.__requestCancel=e.requestCancel,this.__settings=t.getSettingsInfo()}},{key:"__process",value:function(e){if(e.isQualified){this.__includeSpinner(),this.__jsee=new C(this),this.__pendingNodeItems=new k.PendingNodeProcessCollection,this.__signaturesPending=new k.PendingSignatures(this),M.getClient().triggerEvent(new D.Event("SFMOPDOCDELIVERY.JSEE_CREATED",this,{jsee:this.__jsee})),this.__jsee.initialize({contextRoots:["$D","$M"]});var t=this.getEventBus();M.create("com.servicemax.client.sfmconsole.utils.EventCollection",t,[M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.GET_TEMPLATE",this,{request:{context:this,processId:this.__processId}}),M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.GET_USERINFO",this,{request:{context:this}}),M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.GET_DOCUMENT_METADATA",this,{request:{context:this,processId:this.__processId}}),M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.GET_DOCUMENT_DATA",this,{request:{context:this,returnUrl:this.returnUrl,processId:this.__processId,recordId:this.__recordId}}),M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.GET_DISPLAY_TAGS",this,{request:{context:this}})]).triggerAll(function(e){var n=e.items(),i=n.length,a=void 0,r=null;for(a=0;a<i;a++){var o=n[a];"SFMOPDOCDELIVERY.GET_DOCUMENT_METADATA"==o.type()?this.__metadata=o.response:"SFMOPDOCDELIVERY.GET_DOCUMENT_DATA"==o.type()?this.__data=o.response:"SFMOPDOCDELIVERY.GET_USERINFO"==o.type()?this.__onGetUserInfoComplete(o.response):"SFMOPDOCDELIVERY.GET_TEMPLATE"==o.type()?r=o.response:"SFMOPDOCDELIVERY.GET_DISPLAY_TAGS"==o.type()&&(this.__displayTags=o.response)}if(r)this.__onGetTemplateComplete(r),this.__getObjectDescribeInfo();else{M.create("com.servicemax.client.sfmconsole.utils.EventCollection",t,[M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.MISSING_TEMPLATE",this,{request:{context:this}})]).triggerAll()}},this)}else{var n=M.getClient().getServiceRegistry().getService("com.servicemax.client.sfmopdoc.platformspecifics").getInstance();n.alert(e.errorMessage,this.__requestCancel),n.navigateBack(this.returnUrl)}}},{key:"__makeAttachmentProperty",value:function(){var e=this.__data;if(this.__isChecklistAttachmentHasPermission())for(var t=e.DocumentData.length,n=0;n<t;n++){var i=e.DocumentData[n].Key;if(void 0!=i&&i.indexOf("Checklist")>=0){this.__jsee.setProperty("allChecklistAttachment",this.__getObjectHashMapFromArray(e.DocumentData[n].relatedRecords));break}}else this.__jsee.setProperty("allChecklistAttachment",[])}},{key:"__isChecklistAttachmentHasPermission",value:function(){if(this.__aliasDescribeInfo&&this.__aliasDescribeInfo.Checklist_Attachment){for(var e=this.__aliasDescribeInfo.Checklist_Attachment,t=this.__orgNamespace,n=!0,i=[t+"__SM_Internal_Question_ID__c",t+"__SM_Attachment_ID__c",t+"__SM_Attachment_Name__c",t+"__SM_Checklist__c"],a=0;a<i.length;a++){var r=e[i[a]];if(!r||r&&!r.accessible){n=!1;break}}return n}return!1}},{key:"__getObjectHashMapFromArray",value:function(e){var t={};if(e&&e.length>0)for(var n=e.length,i=0;i<n;i++){var a=e[i];t[a.headerRecordId]=a.records}return t}},{key:"__evaluateBusinessRule",value:function(){for(var e=this.__metadata,t=this.__data,n=t.DocumentData.length,i=0;i<n;i++){var a=t.DocumentData[i].Records,r=(t.DocumentData[i].SpecialFields,t.DocumentData[i].Key);if(void 0!=r&&r.indexOf("Checklist")>=0){for(var o=a.length,s=[],l=0;l<o;l++){var c=a[l],d=this.getRuleFormId(e,c[M.OrgNamespace+"__ChecklistProcessID__c"]);if(d){var _=(M.OrgNamespace,(0,u.default)({},M.OrgNamespace+"__Checklist__c",this.getField(c))),h=M.toObject(c[M.OrgNamespace+"__ChecklistJSON__c"]),f=this.addingNullForSkipSection(h,d);h.attributes={type:M.OrgNamespace+"__Checklist__c",url:""};var p=M.create("com.servicemax.client.sfmbizrules.impl.BusinessRuleValidator"),m=p.evaluateEntryCriteriaBusinessRules({rules:d,fieldValueData:f,fields:_,data:f});m&&m.errors&&m.errors.length>0&&s.push(c)}else s.push(c)}t.DocumentData[i].Records=s}}}},{key:"addingNullForSkipSection",value:function(e,t){var n=t.header,i={};if(n)for(var a=n.rules,r=a.length,o=0;o<r;o++){var s=a[o],l=s.ruleInfo;if(l){var c=l.bizRuleDetails;if(c)for(var u=(c.length,0);u<r;u++){var d=c[u],_=d[M.OrgNamespace+"__Field_Name__c"];e.hasOwnProperty(_)?i[_]=e[_]:i[_]=null}}}return i}},{key:"getRuleFormId",value:function(e,t){for(var n=e.outputDocConfigurationObject.lstSelectedChecklistProcess,i=n.length,a=void 0,r=0;r<i;r++){var o=n[r];if(o.checklistProcessSFId===t){var s=o.businessRules?o.businessRules:o;s.ruleInfo&&s.ruleInfo.bizRule&&s.ruleInfo.bizRuleDetails&&(a=this.getBusinessRule(s));break}}return a}},{key:"getBusinessRule",value:function(e){var t={aliasName:null,message:null,sequence:null,ruleInfo:null};t.ruleInfo=e.ruleInfo,t.ruleInfo.bizRule[M.OrgNamespace+"__Message_Type__c"]="Error",t.ruleInfo.bizRule[M.OrgNamespace+"__Source_Object_Name__c"]=M.OrgNamespace+"__Checklist__c",t.ruleInfo.bizRule[M.OrgNamespace+"__Advance_Expression__c"]=this.getAdvanceExpression(e.ruleInfo.bizRuleDetails);var n=[];n.push(t);var i={};return i.header={key:null,rules:n},i}},{key:"getAdvanceExpression",value:function(e){if(e&&e.length>1){for(var t=e.length,n="1",i=0;i<t;i++){var a=i+1;i>0&&(n=n+" OR "+a)}return"("+n+")"}return null}},{key:"getField",value:function(e){var t={};if(e&&e[M.OrgNamespace+"__ChecklistJSON__c"])for(var n=(0,l.default)(M.toObject(e[M.OrgNamespace+"__ChecklistJSON__c"])),i=n.length,a=0;a<i;a++)t[n[a]]="question";return t}},{key:"__getObjectDescribeInfo",value:function(){this.__uniqueObjects={},this.__processMetaDataCollection(),this.__parseForImageIds();var e=[],t=0;for(var n in this.__uniqueObjects){var i=M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.DESCRIBE_OBJECT",this,{request:{objectName:this.__uniqueObjects[n]}});e[t]=i,t++}if(t>0){var a=this.getEventBus();M.create("com.servicemax.client.sfmconsole.utils.EventCollection",a,e).triggerAll(this.onDescribeObjectsComplete,this)}else this.__processTemplate()}},{key:"onDescribeObjectsComplete",value:function(e){this.__aliasDescribeInfo={},this.__objectLabel="";var t=e.items(),n=t.length,i=void 0,a={},r="";for(void 0!==this.__sourceRecord&&null!==this.__sourceRecord&&void 0!==this.__sourceRecord.attributes&&null!==this.__sourceRecord.attributes&&void 0!==this.__sourceRecord.attributes.type&&null!==this.__sourceRecord.attributes.type&&(r=this.__sourceRecord.attributes.type),i=0;i<n;i++){var o=t[i],s=o.getEventObj().data.request.objectName,l=o.response.fields;a[s]=this.__processObjectDescribe(l),s===r&&(this.__objectLabel=o.response.label)}var c=this.__depthCount;for(var u in this.__aliasObjectName){var d=this.__aliasObjectName[u];if(a[d]){var _={};_[u]=this.__processRefFieldsObjectDescribe(d,a,c),this.__aliasDescribeInfo[u]=_[u],this.__jsee.addContext(_,"$M")}}this.__processTemplate()}},{key:"__processRefFieldsObjectDescribe",value:function(e,t,n){var i=t[e];for(var a in i)(i[a].dataType&&"reference"===i[a].dataType||i[a].type&&"reference"===i[a].type)&&i[a].referenceTo&&t[i[a].referenceTo]&&(n>0&&this.__processRefFieldsObjectDescribe(i[a].referenceTo,t,n-1),this.__assignFields(i[a],t[i[a].referenceTo]));return i}},{key:"__assignFields",value:function(e,t){var n=e;for(var i in t)n[i]=t[i];return n}},{key:"__processObjectDescribe",value:function(e){var t={};for(var n in e)t[e[n].name]=e[n];return t}},{key:"__processChecklist",value:function(){this.__isCheckListProcess&&(this.__metadata.outputDocConfigurationObject&&this.__metadata.outputDocConfigurationObject.processOutputDoc&&this.__jsee.setProperty("includeSkippedSections",this.__metadata.outputDocConfigurationObject.processOutputDoc[this.__orgNamespace+"__SM_Include_Skipped_Sections__c"]),this.__makeAttachmentProperty(),this.__evaluateBusinessRule())}},{key:"__processTemplate",value:function(){this.__processChecklist(),this.__processDataCollection(),this.__processReferenceData(),this.__onDataFetchComplete()}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"__onDataFetchComplete",value:function(){var e=T("[svmx-data]",T(this.__rootNode)),t=void 0,n=0,i=e.length;for(n=0;n<i;n++)t=e[n],this.__nodeProcessor.process({engine:this,node:t,jsee:this.__jsee,pendingNodeItems:this.__pendingNodeItems});var a=[{type:"div",name:"ILDIV"},{type:"strong",name:"ILSTRONG"},{type:"u",name:"ILU"},{type:"i",name:"ILI"},{type:"p",name:"ILP"},{type:"pre",name:"ILPRE"},{type:"h1",name:"ILH"},{type:"h2",name:"ILH"},{type:"h3",name:"ILH"},{type:"h4",name:"ILH"},{type:"h5",name:"ILH"},{type:"h6",name:"ILH"},{type:"style",name:"ILS"},{type:"span",name:"ILSP"},{type:"em",name:"ILEM"},{type:"strike",name:"ILSTRIKE"},{type:"sub",name:"ILSUB"},{type:"sup",name:"ILSUP"},{type:"ol ",name:"ILOL"},{type:"li",name:"ILLI"},{type:"ul",name:"ILUL"},{type:"b",name:"ILB"},{type:"td",name:"ILTD"},{type:"th",name:"ILTH"}],r=void 0,o=a.length;for(r=0;r<o;r++)for(e=T(a[r].type,T(this.__rootNode)),i=e.length,n=0;n<i;n++)t=e[n],this.__nodeProcessor.process({engine:this,node:t,jsee:this.__jsee,name:a[r].name});T("#"+N.DOCUMENT_PAGE,T(this.__rootNode)).show(),this.__spinner.stop();var s=document.getElementById("svmx_draft");if(s&&(s.disabled=!1,s.style.opacity=1),document.getElementById("svmx_finalize")&&(document.getElementById("svmx_finalize").disabled=!1,document.getElementById("svmx_finalize").style.opacity=1),this.onEngineRendered){var l=(this.__sourceRecord&&this.__sourceRecord._fields&&this.__sourceRecord._fields.getNameField()&&this.__sourceRecord._fields.getNameField().name,this.__objectLabel),c=this.__processName;this.onEngineRendered.handler.apply(this.onEngineRendered.context,[l,c])}}},{key:"getRoot",value:function(){return this.__rootNode}},{key:"__checkForPendingNodeItems",value:function(){var e=this;if(this.__pendingNodeItems.isPending())setTimeout(function(){e.__checkForPendingNodeItems()},100);else{var t=T("#"+N.DOCUMENT_PAGE,T(this.__rootNode)).html();t=t.replace(this.__processedStyleNodeValue,""),null!==this.__processedStyleNodeValue&&void 0!==this.__processedStyleNodeValue&&this.__processedStyleNodeValue.length>0&&(t=this.__processedStyleNodeValue+t);var n=M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.SUBMIT_DOCUMENT",e,{request:{context:e,document:t}}),i=document.getElementById("svmx_draft");i&&(i.disabled=!0,i.style.opacity=.3),e.getEventBus().triggerEvent(n)}}},{key:"__onGetUserInfoComplete",value:function(e){this.__jsee.setProperty(N.TODAY,e.Today),this.__jsee.setProperty(N.TOMORROW,e.Tomorrow),this.__jsee.setProperty(N.YESTERDAY,e.Yesterday),this.__jsee.setProperty(N.NOW,e.Now),this.__jsee.setProperty(N.USERNAME,e.UserName),this.__jsee.setProperty(N.ADDRESS,e.Address),this.__jsee.setProperty(N.LOCALE,e.Locale),this.__timeFormat=e.TimeFormat,this.__dateFormat=e.DateFormat,this.__jsee.setProperty("userTimezoneOffset",e.TimezoneOffset),x.setAmPmText(e.amText,e.pmText)}},{key:"__onGetTemplateComplete",value:function(e){null!=this.__allowDraft&&!0===this.__allowDraft?this.__createDraftButton():this.__createFinalizeButton();var t=this.__metadata.AllObjectInfo,n=void 0,i=t.length,a=void 0,r="classic-root-opdoc";for(this.__isSalesForceIsInLightning&&(r="lightning-root-opdoc"),n=0;n<i;n++)"Detail_Object"===t[n][this.__orgNamespace+"__Type__c"]&&t[n][this.__orgNamespace+"__Object_Name__c"]===this.__orgNamespace+"__Checklist__c"&&(a=t[n][this.__orgNamespace+"__Alias__c"]);e.Template=e.Template.replace("{{$F.CHECKLIST()}}",'<div class="part-details"><table border="0" cellpadding="0" cellspacing="0" style="width: 100%" svmx-data="{{$D.'+a+'}}"><thead><tr><th class="theader" svmx-data="{{$F.CHECKLIST($D.'+a+"."+this.__orgNamespace+"__ChecklistJSON__c,$D."+a+"."+this.__orgNamespace+"__ChecklistMetaJSON__c,$D."+a+'.Id)}}"> &nbsp;</th></tr></thead></table></div>'),this.styleNodeValue=this.__parseforStyle(e.Template);var o="document-page-container";this.__isLightning&&this.__isSalesForceIsInLightning&&(o="opdoc-document-page-container"),T(this.__rootNode).append("<div class='"+o+"'><div style='border-radius:5px; margin-top: 5px;padding: 5px' id='"+N.DOCUMENT_PAGE+"'></div></div>"),T(this.__rootNode).addClass(r),document.getElementById(T(this.__rootNode)[0].id).style.overflow="auto",T("#"+N.DOCUMENT_PAGE,T(this.__rootNode)).append(e.Template),T("#"+N.DOCUMENT_PAGE,T(this.__rootNode)).hide()}},{key:"__includeSpinner",value:function(){var e={lines:17,length:40,width:10,radius:59,corners:1,rotate:85,direction:1,color:"#da5e28",speed:2.2,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"};this.__isLightning?(e.className="spinner-lightning",e.line=0,e.length=0,e.radius=0,e.speed=0,e.top=-10,e.left=-10,T(this.__rootNode).append("<div id='"+N.DOCUMENT_SPINNER+"' class='spinner-lightning-container'></div>")):T(this.__rootNode).append("<div style='position:fixed;top:50%;left:50%' id='"+N.DOCUMENT_SPINNER+"'></div>");var t=T("#"+N.DOCUMENT_SPINNER,T(this.__rootNode))[0];this.__spinner=new O(e).spin(t)}},{key:"handleFinalizeButtonClick",value:function(){var e=this,t=M.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");if(document.getElementById("svmx_finalize")&&(document.getElementById("svmx_finalize").disabled=!0,document.getElementById("svmx_finalize").style.opacity=.3),e.removeSignatureButtons)e.removeSignatureButtons.handler.apply(e.removeSignatureButtons.context);else{var n=T("#"+N.DOCUMENT_PAGE,T(e.__rootNode)),i=T(n).find("button");if(i&&i.length>0)for(var a=0;a<i.length;a++){var r=void 0!=T(i[0]).attr("signature-name");!0===r&&T(i[a]).remove()}}var o=T("#"+N.DOCUMENT_PAGE,T(e.__rootNode)).html();if(t)e.__executeFinalizeOnOutputString(o);else{for(var s=(new DOMParser).parseFromString(o,"text/html"),l=e.__getChecklistImageSizeMap(),c=s.getElementsByClassName("opdoc-img"),u=T("#"+N.DOCUMENT_PAGE,T(e.__rootNode)).html().length,d=25e6-(u+.2*u+1e6),_=[],h=0,f=0;f<c.length;f++){var p=c[f].getAttribute("svmx-data"),m=l[p];if(!(h+m<d))break;_.push(c[f]),h+=m}if(_.length===c.length)e.__executeFinalizeOnOutputString(o);else{var v=function(){for(var t=e.__getTagValue("FSA005_TAG018"),n=_.length;n<c.length;n++){var i=c[n];i.style.display="none";var a=document.createElement("DIV");a.setAttribute("style","padding:5px; border: 0.5px solid lightgray;");var r=document.createTextNode(t+" : "+i.getAttribute("svmx-data"));a.appendChild(r),i.parentNode.appendChild(a)}e.__executeFinalizeOnOutputString(s.body.innerHTML)},g=function(){document.getElementById("svmx_finalize")&&(document.getElementById("svmx_finalize").disabled=!1,document.getElementById("svmx_finalize").style.opacity=1)},y=M.getClient().getServiceRegistry().getService("com.servicemax.client.sfmopdoc.platformspecifics").getInstance(),S=this.__getTagValue("FSA005_TAG017");if(t&&!0===t){y.confirm(S)?v():g()}else y.confirm(S,function(e){e?v():g()})}}}},{key:"__getChecklistImageSizeMap",value:function(){for(var e=this.__getAllChecklistImageAttachments(),t={},n=e.length-1;n>=0;n--){var i=e[n];t[i.attachmentName]=i[M.OrgNamespace+"__SM_File_Size__c"]}return t}},{key:"__getAllChecklistImageAttachments",value:function(){for(var e=[],t=this.__data.DocumentData,n=0;n<t.length;n++){var i=t[n];if(i.Key&&"Checklist__Work_Order_"===i.Key){var a=i.relatedRecords;if(a&&a.length>0)for(var r=0;r<a.length;r++)a[r].records&&a[r].records.length>0&&(e=e.concat(a[r].records));break}}return e=e.filter(function(e){return"image"===e[M.OrgNamespace+"__SM_File_Type__c"].toLowerCase()})}},{key:"__executeFinalizeOnOutputString",value:function(e){if(e=e.replace(this.__processedStyleNodeValue,""),null!==this.__processedStyleNodeValue&&void 0!==this.__processedStyleNodeValue&&this.__processedStyleNodeValue.length>0&&(e=this.__processedStyleNodeValue+e),this.__generatedRecordId!==this.__recordId){this.__generatedRecordId=this.__recordId;var t=M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.FINALIZE",this,{request:{processId:this.__processId,recordId:this.__recordId,htmlContent:e,sourceRecord:this.__sourceRecord,requestClose:this.__requestClose,mappedRecordIds:this.__mappedRemotedIds||{}}});this.getEventBus().triggerEvent(t)}}},{key:"__createFinalizeButton",value:function(){var e=this.__getTagValue("SFM004_TAG006"),t=this.__getTagValue("SFM004_TAG013");null==e&&(e=N.FINALIZE),null==t&&(t=N.CANCEL);var n="<input style='background:#f16138; -moz-border-radius:3px; -webkit-border-radius:3px; border-radius:3px; font: normal 13px tahoma,arial,verdana,sans-serif; border: 1px solid #db3202; color:#FFFFFF; font-weight:bold; padding:3px 15px; cursor:pointer; width: 20%; height: 50px' type='button' id='svmx_finalize' value='"+e+"'>",i="<input style='background:#f16138; -moz-border-radius:3px; -webkit-border-radius:3px; border-radius:3px; font: normal 13px tahoma,arial,verdana,sans-serif; border: 1px solid #db3202; color:#FFFFFF; font-weight:bold; padding:3px 15px; cursor:pointer; width: 20%; height: 50px' type='button' id='svmx_finalize' value='"+t+"'>";T(this.__rootNode).append("<div style='background:#a4d0e7; -moz-border-radius:5px; -webkit-border-radius:5px; border-radius:5px; border: 1px solid #72b3d5;padding: 5px' id='"+N.FINALIZE_DIV+"'></div>"),T("#"+N.FINALIZE_DIV,T(this.__rootNode)).append(n),T("#"+N.FINALIZE_DIV,T(this.__rootNode)).append(i),T("#svmx_finalize",T(this.__rootNode)).on("click",M.proxy(this,this.handleFinalizeButtonClick)),document.getElementById("svmx_finalize")&&(document.getElementById("svmx_finalize").disabled=!0,document.getElementById("svmx_finalize").style.opacity=.3)}},{key:"__onCaptureSignature",value:function(e){var t=T("#"+e.uniqueName,T(this.__rootNode));if(void 0!=t&&t&&void 0!=e.path&&e.path.length>0){var n=t.find("img");n&&n.remove();var i="",a=e.path,r=a.split("/");i=r[r.length-1],this.addReplaceCapturedSignature?this.addReplaceCapturedSignature.handler.apply(this.addReplaceCapturedSignature.context,[e,i,t]):t.prepend("<img style='width:"+e.width+"; height:"+e.height+";' svmx-data='"+i+"' src='"+e.path+"'/>"),this.__signaturesPending.removeItem(e.uniqueName)}}},{key:"__createDraftButton",value:function(){var e=this,t=M.getClient().getServiceRegistry().getService("com.servicemax.client.sfmopdoc.platformspecifics").getInstance(),n=function(){var n=!0;e.__signaturesPending.isPending()&&(void 0!==e.__settings.SET001&&"Allow"===e.__settings.SET001?n=!0:void 0!==e.__settings.SET001&&"Warn"===e.__settings.SET001?n=t.confirm(e.__getTagValue("SFM004_TAG007")):void 0!==e.__settings.SET001&&"Disallow"===e.__settings.SET001&&(t.alert(e.__getTagValue("SFM004_TAG008")),n=!1)),1==n&&e.__checkForPendingNodeItems()},i=this.__getTagValue("SFM004_TAG006");null==i&&(i=N.DRAFT);var a="<input style='background:#f16138; -moz-border-radius:3px; -webkit-border-radius:3px; border-radius:3px; font: normal 13px tahoma,arial,verdana,sans-serif; border: 1px solid #db3202; color:#FFFFFF; font-weight:bold; padding:3px 15px; cursor:pointer' type='button' id='svmx_draft' value='"+i+"'>";this.__isLightning?a=this.__makeLightningComponents():T(this.__rootNode).append("<div style='background:#a4d0e7; -moz-border-radius:5px; -webkit-border-radius:5px; border-radius:5px; border: 1px solid #72b3d5;padding: 5px' id='"+N.DRAFT_DIV+"'></div>"),T("#"+N.DRAFT_DIV,T(this.__rootNode)).append(a),T("#svmx_draft",T(this.__rootNode)).on("click",M.proxy(this,n));var r=document.getElementById("svmx_draft");r&&(r.disabled=!0,r.style.opacity=.3)}},{key:"__makeLightningComponents",value:function(){var e=this.__getTagValue("SFM004_TAG013");null==e&&(e=N.CANCEL);var t=this.__getTagValue("SFM004_TAG014");null==t&&(t=N.SAVE);var n=function(){if(this.returnUrl&&this.returnUrl.length>0){M.getClient().getServiceRegistry().getService("com.servicemax.client.sfmopdoc.platformspecifics").getInstance().navigateBack(this.returnUrl)}else window.history.back()};T(this.__rootNode).append("<div class='opdoc-header-container' id='"+N.DRAFT_DIV+"'></div>");var i="<div class='opdoc-header-title' id='"+N.OBJECT_HEADER+"'></div>";T("#"+N.DRAFT_DIV,T(this.__rootNode)).append(i);var a=M.getClient().getApplicationParameter("objectIconURL"),r=10,o=M.getClient().getApplicationParameter("colorCodeForIcon");a&&a.length>0&&(r=42);var s=window.svmx_is_launch_designer_enabled,l='<img src="'+a+'" width="'+(r-10)+'" height="'+(r-10)+'" style="margin: 0 10px 10px 0; background:#'+o+'">',c="<label >"+M.getClient().getApplicationParameter("objectLabel")+"</label>",u="<label >"+M.getClient().getApplicationParameter("recordName")+"</label>",d='<table width="100%" border="0" cellpadding="0" cellspacing="0" style="table-layout:fixed">';if(d+='<tr><td rowspan="2" width="'+r+'" style="word-break:break-word;word-wrap:break-word">',d+=l,d+='</td><td style="word-break:break-word;word-wrap:break-word;"><span>',d+=c,d+="</span></td>",s){d+='<td rowspan="2" style=" text-align: right; vertical-align: bottom;">'+('<a class="new-window-icon" target="_blank" href="'+window.svmx_url_for_launch_designer+'">'+this.__getTagValue("SFM004_TAG015")+"</a>")+"</td>"}d+='</tr><tr><td width="50%" style="word-break:break-word;word-wrap:break-word;"><h1>',d+=u,d+="</h1></td></tr></table>",T("#"+N.OBJECT_HEADER,T(this.__rootNode)).append(d);var _="<input style='' type='button' id='svmx_cancelBTN' class='opdoc-btn' value='"+e+"'>";return T("#"+N.DRAFT_DIV,T(this.__rootNode)).append(_),T("#svmx_cancelBTN",T(this.__rootNode)).on("click",M.proxy(this,n)),"<input style='margin-left: 10px' type='button' id='svmx_draft' class='opdoc-btn opdoc-btn-brand' value='"+t+"'>"}},{key:"__getTagValue",value:function(e){var t=null;return null!=this.__displayTags&&void 0!==this.__displayTags[e]&&null!==this.__displayTags[e]&&(t=this.__displayTags[e]),t}},{key:"__parseforStyle",value:function(e){var t=void 0,n=void 0,i="";return e?(t=e.indexOf("<style"),n=e.indexOf("</style>"),-1!=t&&-1!=n&&(i=e.substring(t,n)),void 0!==i&&null!==i&&i.length>0&&(i+="</style>"),i):i}},{key:"onSubmitDocumentComplete",value:function(e){var t=e.DocumentId,n=M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.CREATE_PDF",this,{request:{context:this,returnUrl:this.returnUrl,documentId:t,recordId:M.getUrlParameter("SVMX_recordId"),processId:M.getUrlParameter("SVMX_processId")}});this.getEventBus().triggerEvent(n)}},{key:"onCreatePDFComplete",value:function(e){var t=M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.TARGET_UPDATES",this,{request:{context:this,processId:M.getUrlParameter("SVMX_processId"),recordId:M.getUrlParameter("SVMX_recordId"),pdf:e}});this.getEventBus().triggerEvent(t)}},{key:"onTargetUpdatesComplete",value:function(e){var t=M.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.VIEW_DOCUMENT",this,{request:{context:this,attachmentId:e.PDFAttachmentId,recordId:M.getUrlParameter("SVMX_recordId")}});this.getEventBus().triggerEvent(t)}},{key:"__processMetaDataCollection",value:function(){var e=this.__metadata.AllObjectInfo;this.__processedMetadata={},this.__recsInfo={},this.__aliasObjectName={};var t=void 0,n=void 0,i=e.length;if(this.__isCheckListExistInMata(e)){var a=this.__orgNamespace+"__SM_Checklist_Attachment__c";this.__addToUniqueObjects(a),this.__aliasObjectName.Checklist_Attachment=a}for(n=0;n<i;n++){t=[];var r=e[n][this.__orgNamespace+"__Fields__c"];r&&0!==r.length&&(t=this.__sortFieldsInformation(e[n][this.__orgNamespace+"__Fields__c"]),this.__processedMetadata[e[n][this.__orgNamespace+"__Alias__c"]]=t,this.__recsInfo[e[n][this.__orgNamespace+"__Alias__c"]]=e[n][this.__orgNamespace+"__Type__c"],this.__aliasObjectName[e[n][this.__orgNamespace+"__Alias__c"]]=e[n][this.__orgNamespace+"__Object_Name__c"])}}},{key:"__isCheckListExistInMata",value:function(e){for(var t=e.length,n=0;n<t;n++)if("Detail_Object"===e[n][this.__orgNamespace+"__Type__c"]&&e[n][this.__orgNamespace+"__Object_Name__c"]===this.__orgNamespace+"__Checklist__c"){this.__isCheckListProcess=!0;break}return this.__isCheckListProcess}},{key:"__parseForImageIds",value:function(){this.__imageIds={};var e=this.__metadata.TemplateRecord;if(null!=e&&e){var t=e[0][this.__orgNamespace+"__Media_Resources__c"];if(null!=t&&t.length>0){var n=M.toObject(t);for(i=0;i<n.length;i++)this.__imageIds[n[i].DeveloperName]=n[i].Id}}this.__jsee.setProperty(N.IMAGENAMEID,this.__imageIds)}},{key:"__processDataCollection",value:function(){if(void 0!==this.__data.DocumentData){var e=void 0,t=this.__data.DocumentData.length;this.__data.DocumentData;for(this.__processedData={},this.__specialFieldsData={},e=0;e<t;e++)this.__processedData[this.__data.DocumentData[e].Key]=this.__data.DocumentData[e].Records,this.__specialFieldsData[this.__data.DocumentData[e].Key]=this.__data.DocumentData[e].SpecialFields}}},{key:"__processReferenceData",value:function(){var e=this.__processedMetadata,t=this.__processedData,n=this.__specialFieldsData;for(var i in e){var a=t[i],r={};for(var o in n[i])r[n[i][o].Key]=n[i][o].Value;if(void 0!==a&&null!==a){var s,l,c=e[i],u=this.__aliasDescribeInfo&&this.__aliasDescribeInfo[i]||[],d=c.length,_=a.length;for(s=0;s<d;s++)for(l=0;l<_;l++){if(c[s][N.REF_OBJ_NAME_2]&&null!==a[l][c[s][N.RLN_NAME]]&&void 0!==a[l][c[s][N.RLN_NAME]]&&null!==a[l][c[s][N.RLN_NAME]][c[s][N.RLN_NAME_2]]&&void 0!==a[l][c[s][N.RLN_NAME]][c[s][N.RLN_NAME_2]]&&(a[l][c[s][N.RLN_NAME]][c[s][N.REF_FLD_NAME]]=a[l][c[s][N.RLN_NAME]][c[s][N.RLN_NAME_2]][c[s][N.REF_FLD_NAME_2]]),c[s][N.REF_OBJ_NAME]){"picklist"!==c[s][N.REF_FLD_TYP]&&"multipicklist"!==c[s][N.REF_FLD_TYP]||null===a[l][c[s][N.RLN_NAME]]||void 0===a[l][c[s][N.RLN_NAME]]||(a[l][c[s][N.RLN_NAME]][c[s][N.REF_FLD_NAME]]=this.__processPicklistValues(this.__aliasDescribeInfo[i][c[s][N.FLD_NAME]],c[s][N.REF_FLD_NAME],a[l][c[s][N.RLN_NAME]],c[s][N.REF_FLD_TYP]));var h="";h=a[l][c[s][N.FLD_NAME]]&&a[l][c[s][N.FLD_NAME]].Id?a[l][c[s][N.FLD_NAME]].Id:a[l][c[s][N.FLD_NAME]],a[l][c[s][N.FLD_NAME]]=a[l][c[s][N.RLN_NAME]],a[l][c[s][N.FLD_NAME]]&&(a[l][c[s][N.FLD_NAME]].Id=h)}"picklist"!==c[s][N.FLD_TYP]&&"multipicklist"!==c[s][N.FLD_TYP]||(a[l][c[s][N.FLD_NAME]]=this.__processPicklistValues(this.__aliasDescribeInfo[i],c[s][N.FLD_NAME],a[l],c[s][N.FLD_TYP]))}for(l=0;l<_;l++)a[l]=this.__processSpecialFields(r,a[l]),a[l]=this.__processFieldSecurity(a[l],u),a[l].aliasName=i}var f={};f[i]=a,this.__recsInfo[i]===N.TYPE_HEADER&&(f[i]=a[0]),this.__jsee.addContext(f,"$D")}}},{key:"__processPicklistValues",value:function(e,t,n,i){if(!e[t])return void console.warn("__processPicklistValues: Skipp field "+t+", which does not exist in object description, possibly limited by security setting.");var a=e[t].picklistValues,r=n&&n[t]?n[t]:"",o={label:r,value:r,toString:function(){return this.value}};if(void 0!==a&&a.length>0){var s=i&&"multipicklist"===i?r.split(";"):[r],l=0,c=s.length,u="";for(l=0;l<c;l++){var d=s[l];u.length>0&&(u+="; ");var _=a.filter(function(e){return e.value===d});u+=_[0]&&_[0].label?_[0].label:d}o.value=r,o.label=r,u.length>0&&(o.label=u)}return o}},{key:"__processFieldSecurity",value:function(e,t){for(var n in e)t&&t.accessible&&"reference"===t.dataType&&this.__checkFieldName(t,n)||("object"===(0,o.default)(e[n])&&void 0!==t[n]&&!0===t[n].accessible&&"Id"!==n&&"reference"===t[n].dataType?this.__processFieldSecurity(e[n],t[n]):null!=t[n]&&!1===t[n].accessible?e[n]="":void 0!==t[n]&&null!==t[n]||(e[n]=""));return e}},{key:"__checkFieldName",value:function(e,t){var n=void 0;n=e&&e.referenceTo&&e.referenceTo.length>0?e.referenceTo[0]:e.name;var i="Name";return"Case"===n?i="CaseNumber":"Event"===n||"Task"===n?i="Subject":"Solution"===n?i="SolutionName":"PartnerNetworkConnection"===n&&(i="ConnectionName"),t===i}},{key:"__processSpecialFields",value:function(e,t){var n=t.Id,i=e[n];if(!i)return t;for(var a=0;a<i.length;a++){var r=i[a].Key.split("."),o=i[a].Value;i[a].Info&&"datetime"===i[a].Info?o=x.getFormattedDatetime(i[a].Value,this.__dateFormat+" "+this.__timeFormat):i[a].Info&&"date"===i[a].Info&&(o=x.getFormattedDatetime(i[a].Value,this.__dateFormat)),2==r.length?t[r[0]][r[1]]=o:t[i[a].Key]=o}return t}},{key:"getProcessId",value:function(){return this.__processId}},{key:"getRecordId",value:function(){return this.__recordId}},{key:"__sortFieldsInformation",value:function(e){var t=[],n=[],i=[],a=0,r=0,o=0,s=M.toObject(e),l=s.Metadata;if(l.length>0)for(var c in l)l[c][N.REF_OBJ_NAME_2]?(t[a]=l[c],this.__addToUniqueObjects(l[c][N.REF_OBJ_NAME_2]),this.__addToUniqueObjects(l[c][N.REF_OBJ_NAME]),this.__addToUniqueObjects(l[c][N.OBJ_NAME]),a++):l[c][N.REF_OBJ_NAME]?(n[r]=l[c],this.__addToUniqueObjects(l[c][N.REF_OBJ_NAME]),this.__addToUniqueObjects(l[c][N.OBJ_NAME]),r++):l[c][N.OBJ_NAME]&&(i[o]=l[c],this.__addToUniqueObjects(l[c][N.OBJ_NAME]),o++);return t.concat(n,i)}},{key:"__addToUniqueObjects",value:function(e){void 0!=e&&e&&e.length>0&&(this.__uniqueObjects[e]=e)}},{key:"__processNode",value:function(e,t){var n=this.__jsee.evalExpression(T(e).attr(t));!0===M.getClient().getApplicationParameter("svmx_is_sanitizehtml_enabled")&&M.sanitizeHTML&&(n=M.sanitizeHTML(n)),T(e,T(this.__rootNode)).html(n)}}]),t}(A),k.AbstractNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return null}},{key:"_removeControlCharacters",value:function(e){return e.replace(/[\n\r\t]/g,"")}},{key:"_removeSVMXCharacters",value:function(e){return e.substring(2,e.length-2)}},{key:"format",value:function(e,t){for(var n=0,i=t.length,n=0;n<i;n++){var a=new RegExp("\\{"+n+"\\}","gi");e=e.replace(a,function(){return t[n]})}return e}},{key:"replaceExpressions",value:function(e,t,n){var i=void 0,a=e.items,r=a.length,o=void 0,s=void 0;for(i=0;i<r;i++)o=a[i],o=o.substring(2,o.length-2),o=this._removeControlCharacters(o),s=t.jsee.evalExpression(o,t),!0===M.getClient().getApplicationParameter("svmx_is_sanitizehtml_enabled")&&M.sanitizeHTML&&(s=M.sanitizeHTML(s)),n&&(void 0!==s&&null!==s&&""!==s||(s="")),a[i]=void 0!=s&&null!=s?s:"";return this.format(e.expression,a)}},{key:"parseforExpressions",value:function(e){var t={expression:e,found:!1,items:[]},n=void 0,i=void 0,a=void 0,r=void 0,o=void 0;if(!e)return t;for(o=0;;){if(n=e.indexOf("{{"),i=e.indexOf("}}"),-1==n||-1==i)break;a=e.substring(n,i+2),r=e.substring(0,n)+"{"+o+"}",i+2<e.length&&(r+=e.substring(i+2)),e=r,t.found=!0,t.expression=e,t.items[o]=a,o++}return t}},{key:"parseandreplaceExpressions",value:function(e,t){var n=this.parseforExpressions(e);return this.replaceExpressions(n,t)}}]),t}(R),k.NodeProcessor=function(e){function t(){(0,f.default)(this,t);var e=(0,m.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments));return e.__nodeTypeToProcessor={},e}return(0,S.default)(t,e),(0,g.default)(t,[{key:"initialize",value:function(e,t,n){var i=void 0,a=t.length;for(i=0;i<a;i++){var r,o=t[i],s=o.data,l=s.length;for(r=0;r<l;r++){var c=s[r];this.__nodeTypeToProcessor[c.nodeType]={processor:c.processor,inst:null}}}}},{key:"process",value:function(e){var t=e.name||T(e.node)[0].nodeName,n=this.__nodeTypeToProcessor[t],i=null,a=!1;if(n){if(!n.inst){var r=M.getClass(n.processor),o=new r;n.inst=o}i=n.inst}return i&&(a=i.process({engine:e.engine,jsee:e.jsee,node:e.node,pendingNodeItems:e.pendingNodeItems})),a}}]),t}(L),k.DivNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){var t=T(e.node).attr("svmx-data");t=this._removeControlCharacters(t);var n=this.parseandreplaceExpressions(t,e);return!0===M.getClient().getApplicationParameter("svmx_is_sanitizehtml_enabled")&&M.sanitizeHTML&&(n=M.sanitizeHTML(n)),T(e.node).html(n),!0}}]),t}(k.AbstractNodeProcessor),k.TableNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){var t=T(e.node).attr("svmx-data");t=this._removeSVMXCharacters(t);var n=e.jsee.evalExpression(t);if(null!=n&&n.length>0){var i=n.length,a=void 0,r=T("tbody",T(e.node));0==r.length&&T(e.node).append(document.createElement("tbody")),r=T("tbody",T(e.node))[0];var s=T("thead",T(e.node)),l=T(T(s[0]).children()[0]).children(),c=l.length,u=void 0;for(a=0;a<i;a++){var d=n[a],_=r.insertRow(a),h=t.substring(3);for(this.assignContext(e.jsee,h,d),u=0;u<c;u++){var f,p=T(l[u]).attr("svmx-data"),m=this._removeSVMXCharacters(p),v=_.insertCell(u),g=m.split("."),y=g.length,S=d;for(f=0;f<y;f++)S=S[g[f]]&&"object"===(0,o.default)(S[g[f]])&&S[g[f]].Id&&1===y?S[g[f]].Id:void 0!==S[g[f]]&&null!==S[g[f]]?S[g[f]]:"";if(0==S.length){var E=this._removeControlCharacters(p);S=this.parseandreplaceExpressions(E,e),!1}try{S&&"object"===(void 0===S?"undefined":(0,o.default)(S))&&void 0!==S.label&&null!==S.label&&void 0!==S.value&&null!==S.value&&(S=S.value),S=S.toString()}catch(e){}!0===M.getClient().getApplicationParameter("svmx_is_sanitizehtml_enabled")&&M.sanitizeHTML&&(S=M.sanitizeHTML(S)),T(v).html(S),v.align="center"}}this.assignContext(e.jsee,h,n)}return!0}},{key:"assignContext",value:function(e,t,n){var i={};i[t]=n,e.addContext(i,"$D")}}]),t}(k.AbstractNodeProcessor),k.ImageNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){var t=T(e.node).attr("svmx-data");t=this._removeSVMXCharacters(t);e.jsee.evalExpression(t,{node:e.node,pendingNodeItems:e.pendingNodeItems});return!0}}]),t}(k.AbstractNodeProcessor),k.TdNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){var t=T(e.node).attr("svmx-data");t=this._removeControlCharacters(t);var n=this.parseandreplaceExpressions(t,e);return e.node.innerText=n,!0}}]),t}(k.AbstractNodeProcessor),k.AbstractInlineNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"processChildNodes",value:function(e){var t=e.node,n=t.childNodes,i=void 0,a=n.length,r=void 0,o=void 0,s=void 0;for(i=0;i<a;i++)if(r=n[i],3==r.nodeType){o=r.nodeValue,s=this.parseforExpressions(o);var l=this.replaceExpressions(s,e,e.handleSpecialCharacters),c=this.processSignatureNodes(l,r);c||(r.nodeValue=l)}}},{key:"processSignatureNodes",value:function(e,t){var n=[],i=void 0,a=void 0,r=!1,o=T("<span></span>");if((n=this.processTextWithDelimiters(e,"svmx-signature-start","svmx-signature-end",20,18))&&n.length>0){for(a=n.length,T(o).insertBefore(t),r=!0,i=0;i<a;i++){var s=T("<span></span>").html(n[i]);T(o).append(s)}T(t).remove()}return r}},{key:"processTextWithDelimiters",value:function(e,t,n,i,a){for(var r=e,o=[],s=void 0,l=void 0;;){var c="";if(s=r.indexOf(t),l=r.indexOf(n),-1==s||-1==l){if(-1!=s){o.push(r.substring(0,s)),o.push(r.substring(s+i,r.length));break}if(-1!=l){o.push(r.substring(0,l)),o.push(r.substring(l+a,r.length));break}break}o.push(r.substring(0,s)),o.push(r.substring(s+i,l)),l+a<r.length&&(c=r.substring(l+a)),r=c}return o}}]),t}(k.AbstractNodeProcessor),k.InlineDivNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineStrongNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineUnderlineNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineItalicNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineParaNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlinePreNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineHeadingNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineStyleNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}},{key:"processChildNodes",value:function(e){if(null!=e.engine.styleNodeValue){var t=e.node,n=t.childNodes,i=n.length,a=void 0,r=void 0,o=void 0;r=e.engine.styleNodeValue,o=this.parseforExpressions(r);var s=this.replaceExpressions(o,e);if(e.engine.__processedStyleNodeValue=s,s&&s.length>0){var l=s.indexOf("<style"),c=0,u=s.indexOf("</style>"),d=0;-1!=l&&(c=s.indexOf(">",l)+1),-1!=u&&(d=u),-1!=l&&-1!=u&&(s=s.substring(c,d))}i>0?(a=n[0],a.nodeValue=s):t.nodeValue=s}}}]),t}(k.AbstractInlineNodeProcessor),k.InlineSpanNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineEMNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineStrikeNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineSubNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineSupNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineOlNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineLiNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return e.handleSpecialCharacters=!0,this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineUlNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineBoldNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineTDNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.InlineTHNodeProcessor=function(e){function t(){return(0,f.default)(this,t),(0,m.default)(this,(t.__proto__||(0,_.default)(t)).call(this))}return(0,S.default)(t,e),(0,g.default)(t,[{key:"process",value:function(e){return this.processChildNodes(e),!0}}]),t}(k.AbstractInlineNodeProcessor),k.PendingNodeProcessCollection=function(e){function t(){(0,f.default)(this,t);var e=(0,m.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments));return e.__pendingNodeItems={},e}return(0,S.default)(t,e),(0,g.default)(t,[{key:"addItem",value:function(e,t){this.__pendingNodeItems[e]=t}},{key:"removeItem",value:function(e){delete this.__pendingNodeItems[e]}},{key:"isPending",value:function(){for(var e in this.__pendingNodeItems)return!0;return!1}}]),t}(R),k.PendingSignatures=function(e){function t(e){(0,f.default)(this,t);var n=(0,m.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments));return n.__parent=e,n.__pendingSignatures={},n.__finBtnName="svmx_finalize",n.__draBtnDiv=N.DRAFT_DIV,n}return(0,S.default)(t,e),(0,g.default)(t,[{key:"addItem",value:function(e,t){this.__pendingSignatures[e]=t,T("#"+this.__finBtnName,T(this.__parent.__rootNode)).prop("disabled","true"),this.__parent.changeStyleSignature?this.__parent.changeStyleSignature.handler.apply(this.__parent.changeStyleSignature.context,["add",this.__finBtnName,T(this.__parent.__rootNode)]):T("#"+this.__finBtnName,T(this.__parent.__rootNode)).css({background:"#cecece",border:"1px solid #b1b1b1",color:"#a9a9a9","text-shadow":"-1px 0px 1px #ededed",cursor:"default",opacity:"1"})}},{key:"removeItem",value:function(e){this.__pendingSignatures[e]&&delete this.__pendingSignatures[e],this.isPending()||(T("#"+this.__finBtnName,T(this.__parent.__rootNode)).removeAttr("disabled"),this.__parent.changeStyleSignature?this.__parent.changeStyleSignature.handler.apply(this.__parent.changeStyleSignature.context,["remove",this.__finBtnName,T(this.__parent.__rootNode)]):T("#"+this.__finBtnName,T(this.__parent.__rootNode)).css({background:"#f16138",border:"1px solid #db3202",color:"#FFFFFF","text-shadow":"none",opacity:"1"}))}},{key:"isPending",value:function(){for(var e in this.__pendingSignatures)return!0;return!1}}]),t}(R),M.defineGlobal(k.name,k),e.exports=k},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).CommandWithResponder,m=n(13).Command,v={name:"com.servicemax.client.sfmopdocdelivery.commands"};v.GetUserInfo=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.GET_USERINFO"})}}]),t}(p),v.GetTemplate=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.GET_TEMPLATE"})}}]),t}(p),v.SubmitDocument=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.SUBMIT_DOCUMENT"})}},{key:"result",value:function(e){this.__cbContext.onSubmitDocumentComplete(e)}},{key:"fault",value:function(e){}}]),t}(p),v.CreatePDF=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.CREATE_PDF"})}},{key:"result",value:function(e){this.__cbContext.onCreatePDFComplete(e)}},{key:"fault",value:function(e){}}]),t}(p),v.ViewDocument=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.VIEW_DOCUMENT"})}},{key:"result",value:function(e){}},{key:"fault",value:function(e){}}]),t}(p),v.GetDocumentMetadata=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.GET_DOCUMENT_METADATA"})}}]),t}(m),v.GetDocumentData=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.GET_DOCUMENT_DATA"})}}]),t}(m),v.DescribeObject=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.DESCRIBE_OBJECT"})}}]),t}(m),v.CaptureSignature=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.CAPTURE_SIGNATURE"})}},{key:"result",value:function(e){this.__cbHandler(e)}},{key:"fault",value:function(e){}}]),t}(p),v.CaptureHtmlSignature=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.CAPTURE_HTML_SIGNATURE"})}},{key:"result",value:function(e){this.__cbHandler(e)}},{key:"fault",value:function(e){}}]),t}(p),v.PurgeOrphanSignatures=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.PURGE_ORPHAN_SIGNATURES"})}},{key:"result",value:function(e){this.__cbHandler(e)}},{key:"fault",value:function(e){}}]),t}(p),v.Finalize=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.FINALIZE"})}}]),t}(m),v.TargetUpdates=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"SFMOPDOCDELIVERY.TARGET_UPDATES"})}},{key:"result",value:function(e){this.__cbContext.onTargetUpdatesComplete(e)}},{key:"fault",value:function(e){}}]),t}(p),v.NotifyDataChange=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){var n=f.getCurrentApplication(),i=n.forEachConsoleApp;n.forEachConsoleApp&&i.call(n,function(t){var n=t.notifyDataChange;n&&n.call(t,e)})}}]),t}(m),v.GetDisplayTags=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,t,{operationId:"SFMOPDOCDELIVERY.GET_DISPLAY_TAGS"})}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){var i=n(10),a=n(0).utils,r=(n(19).impl,n(24).navigation,n(22).View),o=n(11).Facade,s=n(395),l=function(){return a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},c={name:"com.servicemax.client.sfmopdocdelivary.ui.largemodern.opdocview"},u=r;Ext.define(c.name+".OPDocView",{extend:u,alias:"widget.sfm.opdoc.home",config:{scrollable:"both"},onShow:function(){},updateOptions:function(e){this.blockApplication(),this.options=e||{},this.bindJseeImageInterceptor();var t=a.create("com.servicemax.client.sfmopdocdelivery.engine.DeliveryEngineImpl");this.engine=t.getInterface(),this.__options=e},ready:function(){if(this.setViewInfo({windowTitle:l().T("FSA005_TAG004","Smart Documents"),subTitle:"",backText:l().T("FSA005_TAG004","Smart Documents"),hideContextMenu:!1,disableNavMenu:!0,hideMenuBar:!0}),window.cordova){var e=this;setTimeout(function(){SVMXPlugin.setOrientation("LANDSCAPE",a.proxy(e,e.onInit),a.proxy(e,e.onInit))},300)}else this.onInit()},onInit:function(){this.blockApplication(),this.engine.__mappedRemotedIds={};var e=a.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.bind(e,"ATTACHMENTS_UPLOADED",this.onAttachmentsChange,this);var t={xtype:"svmx.verticalpanel",width:"100%",itemId:"docPanel",id:"smart-doc-panel",items:[]};this.add(t),this.__panel=this.query("#docPanel")[0],0==i("#"+a.getDisplayRootId()).length&&i("<div id='"+a.getDisplayRootId()+"'></div>").appendTo("body"),i("#"+a.getDisplayRootId()).detach().appendTo(i(".x-inner","#smart-doc-panel"));var n=a.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.PURGE_ORPHAN_SIGNATURES",this,{request:{handler:a.proxy(this,this.onPurgeSignatureComplete)}}),r=a.getCurrentApplication();i("#"+a.getDisplayRootId()).hide(),r.triggerEvent(n)},onAttachmentsChange:function(e){if(e&&e.data&&e.data.request&&e.data.request.attachmentLocalId){var t=e.data.request.attachmentLocalId,n=e.data.request.attachmentId;this.engine.__mappedRemotedIds=this.engine.__mappedRemotedIds||{},this.engine.__mappedRemotedIds[t]=n}},onPurgeSignatureComplete:function(){this.engine.initAsync({handler:a.proxy(this,"onEngineInit",this.__options),context:this})},onEngineInit:function(e){this.engine.run({onReady:{handler:this.onEngineReady,context:this},onRendered:{handler:this.onEngineRendered,context:this},requestCancel:{handler:this.requestCancel,context:this},requestClose:{handler:this.requestClose,context:this},changeStyleSignature:{handler:this.changeStyleSignature,context:this},removeSignatureButtons:{handler:this.removeSignatureButtons,context:this},createSignatureButtons:{handler:this.createSignatureButtons,context:this},addReplaceCapturedSignature:{handler:this.addReplaceCapturedSignature,context:this},options:e})},onEngineReady:function(){this.unblockApplication()},onEngineRendered:function(e,t){i("#finalize_div",i(this.engine.__rootNode)).replaceWith("<div class='opdoc-header-finalize-div' id='finalize_div'></div>");var n=l().T("FSA005_TAG005","Done"),r=l().T("FSA016_TAG004","Cancel"),o=l().T("FSA005_TAG014","Print"),s=t;s&&""!==s&&0!==s.length||(s=l().T("FSA005_TAG013","Service Report"));var c="<input class='opdoc-finalize-button-active' type='button' id='svmx_finalize' value='"+n+"'>",u='<input class="opdoc-cancel-button" type="button" id="svmx_finalize_cancel" value="'+r+'">',d='<label class="opdoc-title">'+s+"</label>",_="<input class='opdoc--button-print' type='button' id='svmx_print' value='"+o+"'>";i("#finalize_div",i(this.engine.__rootNode)).append(u),i("#finalize_div",i(this.engine.__rootNode)).append(d),"IPAD"===a.getClientTypeForUnifiedApp()&&i("#finalize_div",i(this.engine.__rootNode)).append(_),i("#finalize_div",i(this.engine.__rootNode)).append(c),i("#document_page",i(this.engine.__rootNode)).css({"border-radius":"5px",padding:"5px"}),i("#svmx_finalize_cancel",i("#"+a.getDisplayRootId())).on("click",a.proxy(this,this.exit)),"IPAD"===a.getClientTypeForUnifiedApp()&&i("#svmx_print",i("#"+a.getDisplayRootId())).on("click",a.proxy(this,this.printWebPage)),i("#svmx_finalize",i(this.engine.__rootNode)).on("click",a.proxy(this.engine,this.engine.handleFinalizeButtonClick)),this.engine.__signaturesPending.isPending()&&(i("#svmx_finalize",i(this.engine.__rootNode)).prop("disabled","true"),i("#svmx_finalize",i(this.engine.__rootNode)).addClass("opdoc-finalize-button-inactive")),i("#"+a.getDisplayRootId()).show(),this.unblockApplication()},requestClose:function(){document.getElementsByClassName("opdoc-finalize-button-active")[0].style.opacity=.5,a.Msg.toast({text:l().T("FSA012_TAG068","Your SmartDoc will be sent to the server for processing. Go to Attachments to see it."),duration:5e3}),this.exit()},requestCancel:function(){this.exit()},changeStyleSignature:function(e,t,n){"add"===e?(i("#"+t,n).prop("disabled","true"),i("#"+t,n).addClass("opdoc-finalize-button-inactive")):"remove"===e&&(i("#"+t,n).removeAttr("disabled"),i("#"+t,n).removeClass("opdoc-finalize-button-inactive").addClass("opdoc-finalize-button-active"))},removeSignatureButtons:function(){var e=i("#document_page",i(this.engine.__rootNode)),t=i(e).find("div");if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=!(void 0==i(t[n]).attr("signature-name")||"svmx-image-signature-div-taptosign"!==i(t[n]).attr("id"));!0===a&&i(t[n]).remove()}document.querySelectorAll("[id=image-signature-div]").forEach(function(e){if(e.children.length>0){var t=e.children[0];"label"===t.nodeName.toLowerCase()&&" (optional)"===t.innerHTML&&(t.innerHTML="")}})},createSignatureButtons:function(e,t,n,i,a,r,o){var s=i?i+"px":"96px",l=a?a+"px":"320px",c="svmx-signature-start<div id='"+e+t+"' style='display:table;width: 320px;height: 96px;'><div id='image-signature-div' signature-name='"+e+t+"' onclick='SVMX."+r+"(event);' imgHeight='"+s+"' imgWidth='"+l+"'><div id='svmx-image-signature-div-taptosign' style='display:table-cell; vertical-align: bottom; text-align: center;color: #2F70AB;' signature-name='"+e+t+"' imgHeight='"+s+"' imgWidth='"+l+"'><label signature-name='"+e+t+"' imgHeight='"+s+"' imgWidth='"+l+"'>(tap to sign)</label><br/><hr style = 'pointer-events : none !important;' /></div></div><div id='image-signature-div'>"+o;return void 0!==n&&"true"===n.toString().toLowerCase()?c+="</div>":c+="<label style='color: #a9a9a9;'> (optional)</label></div>",c+="</div>svmx-signature-end"},addReplaceCapturedSignature:function(e,t,n){var a=i("#svmx-image-signature-div-taptosign",n);void 0===a||void 0===a[0]?(a=i("#svmx-image-signature-div-signed",n),a.replaceWith("<div id='svmx-image-signature-div-signed'  style='display:table-cell;vertical-align: bottom; color: #a9a9a9;' signature-name='"+e.uniqueName+"'><img  style='width:"+e.width+";height:"+e.height+";' svmx-data='"+t+"' src='"+e.path+"' signature-name='"+e.uniqueName+"'></img><br/><hr/></div>")):a.replaceWith("<div id='svmx-image-signature-div-signed'  style='display:table-cell; vertical-align: bottom; color: #a9a9a9;' signature-name='"+e.uniqueName+"'><img  style='width:"+e.width+";height:"+e.height+";' svmx-data='"+t+"' src='"+e.path+"' signature-name='"+e.uniqueName+"'></img><br/><hr/></div>")},handleHardwareBack:function(){return this.exit(),!0},exit:function(e){this.blockApplication();var t=a.create("com.servicemax.client.lib.api.Event","SFMOPDOCDELIVERY.PURGE_ORPHAN_SIGNATURES",this,{request:{handler:a.proxy(this,function(){this.onExit()})}});a.getCurrentApplication().triggerEvent(t)},done:function(){this.unblockApplication(),this.unbindJseeImageInterceptor(),this.engine&&this.engine.doCleanup(),this.callParent(),this.destroy(),this.engine=null,this.__panel=null},printWebPage:function(){var e=o.createPrintHtmlContentRequest(),t={type:"PRINTHTMLCONTENT",parameters:{elementId:"document_page"}};e.bind("REQUEST_COMPLETED",function(e){},this),e.bind("REQUEST_ERROR",function(e){logger.error("Printing Failed")}),e.execute(t)},onExit:function(e){var t=document.getElementsByClassName("opdoc-cancel-button")[0];if(t&&(t.style.opacity=.5),window.cordova){var n="PORTRAIT";window.isTablet&&(n="BOTH"),SVMXPlugin.setOrientation(n,a.proxy(this,this.done),a.proxy(this,this.done))}else this.done()},__jseeImageInterceptorEventHandler:function(e){var t=e.data.jsee,n={},r=this;t.addInterceptor("$IMAGE",function(e,o){if(!o||!o.node)return null!=t&&t.getProperty("ImageNameId")&&t.getProperty("ImageNameId")[e]?"/servlet/servlet.FileDownload?file="+t.getProperty("ImageNameId")[e]:(a.getLoggingService().getLogger().error("Image was not found in collection: "+e),"");if(null!=n[e])i(o.node).attr("src",n[e]);else{var l=new s.SubmitQuery;o.pendingNodeItems.addItem(e,e);l._performInternal({queryConfig:{api:"Document",fields:"Id, Description, DeveloperName, Type",condition:"DeveloperName='"+e+"'"}},function(t){o.pendingNodeItems.removeItem(e),t&&(n[e]=t,i(o.node).attr("src",n[e]),i(o.node).attr("svmx-data",e))},r)}})},bindJseeImageInterceptor:function(){a.getClient().bind("SFMOPDOCDELIVERY.JSEE_CREATED",this.__jseeImageInterceptorEventHandler,this)},unbindJseeImageInterceptor:function(){a.getClient().unbind("SFMOPDOCDELIVERY.JSEE_CREATED",this.__jseeImageInterceptorEventHandler,this)}}),a.defineGlobal(c.name,c),e.exports=c},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.sfmopdocdelivery.ui.largemodern.api"},r=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};Ext.define(a.name+".SVMXSignatureDialog",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.sfmopdoc.signature",__deferred:null,__signaturePanel:null,config:{cls:"sfm-opdoc-signature-dialog",centered:!0,modal:!0,hideOnMaskTap:!1,height:"100%",width:"100%",left:0,id:"html_signature_panel",header:{titleAlign:"center"},title:"Customer Signature",tools:[{cls:"svmx-signature-refresh-button",type:"refresh",tooltip:"Clear",docked:"left",handler:function(e,t,n){this.toolOwner.clear()}}],listeners:{hide:function(e,t){"pending"==this.__deferred.state()&&this.__deferred.reject()}}},initialize:function(e){this.enableBubble("transientState"),this.__deferred=new i.Deferred,e=Ext.apply(this.config,e||{}),items=[{itemId:"signaturePanel",xtype:"svmx.signature",cls:"sfm-opdoc-signature-pad",waterMarkText:e.watermark||"",width:"100%",height:"100%"},{xtype:"svmx.toolbar",docked:"bottom",ui:"svmx-toolbar-grey",items:[{xtype:"svmx.button",ui:"svmx-toolbar-btn",text:r().T("FSA016_TAG004","Cancel"),itemId:"cancelSignature",style:{width:"50%"},handler:i.proxy(this,"cancel")},{xtype:"svmx.button",ui:"svmx-button-square",text:r().T("FSA005_TAG005","Done"),itemId:"doneSignature",style:{width:"50%","font-weight":"bold"},handler:i.proxy(this,"save")}]}],this.add(items),this.callParent([e]),this.__signaturePanel=this.query("#signaturePanel")[0],this.setTitle(e.title)},show:function(){i.showDialog(this,{height:219,width:542,padding:0});var e=document.querySelector("#global-floatWrap .x-mask");return e&&e.addEventListener("click",function(t){t.stopPropagation(),document.getElementById("html_signature_panel")||e.remove()}),this.__deferred},save:function(){if(this.__signaturePanel.__signature.isEmpty())return void this.cancel();if("pending"==this.__deferred.state()){var e=this.__signaturePanel?this.__signaturePanel.getSignature():null;e&&(e=e.replace(/^data:image\/(png|jpg);base64,/,"")),this.__deferred.resolve({data:e})}this.parent.destroy(),this.destroy()},clear:function(){this.__signaturePanel&&this.__signaturePanel.clearSignature()},cancel:function(){this.parent.destroy(),this.destroy()},destroy:function(){var e=this;e.fireEvent("transientState",{state:e,type:"close"}),this.callParent()}}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.sfmopdocdelivery.ui.largemodern.commands"},v=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};m.MissingTemplate=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){var n=[{text:v().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}];f.Msg.alert({title:v().T("FSA005_TAG002","Error"),text:v().T("FSA005_TAG003","Unable to open document. Template is missing!"),buttons:n}).then(f.proxy(this,function(e){f.getCurrentApplication().getCurrentView().exit()}))}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Operation,m={name:"com.servicemax.client.sfmopdocdelivery.ui.largemodern.operations"};m.CaptureHtmlSignature=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e=e||{};var n=f.create("com.servicemax.client.sfmopdocdelivery.ui.largemodern.api.SVMXSignatureDialog",{watermark:e.watermark,title:e.signatureTitle}),i=n.show();i.done(f.proxy(this,function(n){n&&n.data?(e.data=n.data,e.success=!0,e.isBase64Encoded=!0,t.result(e)):(e.success=!0,t.result(e))})),i.fail(function(){e.success=!1,t.result(e)})}}]),t}(p),m.PurgeOrphanSignatures=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"performAsync",value:function(e,t){e=e||{},f.create("com.servicemax.client.offline.sal.model.sfmopdocdeliveryutils.Utils").clearOrphanSignatures().always(f.proxy(this,function(){t&&t.result(e)}))}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){n(816);var i=n(821),a=n(822),r=n(823);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"sfmcreate","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},icon:{"large-css-class":"icon-circle-add","small-css-class":"icon-circle-add"},views:[{id:"view","class-name":"com.servicemax.client.sfmcreatedelivery.ui.largemodern.view.View","default-view":!0}],controller:{"class-name":"com.servicemax.client.sfmcreatedelivery.engine.DeliveryEngineImpl"},discover:!0,multiple:!1,positionWeight:3e3,"button-text":["FSA008_TAG129","Create New"]}}),e.exports={impl:i,view:a,api:r}},function(e,t,n){var i=n(817),a=n(818),r=n(819),o=n(820),s=n(0).utils;s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"SFMCREATEDELIVERY.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"sfmclientdelivery","class-name":"com.servicemax.client.sfmcreatedelivery.engine.DeliveryEngineImpl"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"SFMCREATEDELIVERY.GET_CREATE_PROCESSES_INFO","command":"com.servicemax.client.sfmcreatedelivery.commands.GetCreateInfo"},{"event":"SFMCREATEDELIVERY.GET_RECENTS_INFO","command":"com.servicemax.client.sfmcreatedelivery.commands.GetRecentsInfo"},{"event":"SFMCREATEDELIVERY.ADD_TO_RECENTS","command":"com.servicemax.client.sfmcreatedelivery.commands.AddToRecents"},{"event":"SFMCREATEDELIVERY.GET_PROCESS_ID","command":"com.servicemax.client.sfmcreatedelivery.commands.GetProcessId"}]}}}')),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.sfmcreatedelivery.impl"};y.Module=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e._logger=m.getLoggingService().getLogger("SFMCREATE-IMPL"),e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){y.init(),y.init(),y.init()}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){}}]),t}(v),y.EventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("SFMCreateDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(33).AbstractDeliveryEngine,m=n(5).SVMXObject,v={name:"com.servicemax.client.sfmcreatedelivery.engine"};v.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__logger=f.getLoggingService().getLogger("SFMCREATE-ENGINE-IMPL"),e.__root=null,e.__eventBus=null,e.__dataModel=null,e.__recentsModel=null,e.__loadMask=null,e.__options=null,e.__translations=null,e.__view=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){this.__options=e;var t=f.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("SFMCREATEDELIVERY.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.getEventBus()}})}},{key:"getEventBus",value:function(){return this.__eventBus||(this.__eventBus=f.create("com.servicemax.client.sfmcreatedelivery.impl.EventBus",{})),this.__eventBus}},{key:"onAppTitleChanged",value:function(e){this.__options.titleChangedHandler&&this.__options.titleChangedHandler.call(this.__options.context,e)}},{key:"reset",value:function(){this.run(this.options)}},{key:"run",value:function(e){this.__logger.debug("Create is running!!!"),this.options=e||{},f.create("com.servicemax.client.sfmconsole.utils.EventCollection",this.getEventBus(),[f.create("com.servicemax.client.lib.api.Event","SFMCREATEDELIVERY.GET_CREATE_PROCESSES_INFO",this,{request:{}})]).triggerAll(function(e){var t=e.items(),n=t.length,i=void 0,a=void 0,r=void 0;for(i=0;i<n;i++){var o=t[i];"SFMCREATEDELIVERY.GET_CREATE_PROCESSES_INFO"==o.type()?a=o.response:"SFMCREATEDELIVERY.GET_RECENTS_INFO"==o.type()&&(r=o.response)}this.__runInternal(a,r)},this)}},{key:"__runInternal",value:function(e,t){this.__root?this.__root.setDataModel(this.getDataModel()):(this.__root=this.__view.createComponent("ROOTCONTAINER",{deliveryEngine:this,dataModel:this.getDataModel(),recentsModel:this.getRecentsModel()}),this.__root&&(f.getClient().getApplicationParameter("svmx-sfm-no-window-resize")||f.onWindowResize(function(){var e={width:Ext.getBody().getViewSize().width,height:Ext.getBody().getViewSize().height};this.onResize(e)},this),this.__root.setHeight(Ext.getBody().getViewSize().height))),this.onGetCreateInfoCompleted(e,t)}},{key:"onGetCreateInfoCompleted",value:function(e,t){this.__dataModel.processData(e,t),this.__root&&this.__root.run(),this.options.onReady&&this.options.onReady.handler.call(this.options.onReady.context||this)}},{key:"onResize",value:function(e){this.getRoot().resize(e)}},{key:"getDataModel",value:function(){return this.__dataModel||(this.__dataModel=f.create("com.servicemax.client.sfmcreatedelivery.engine.CreateMetaModel",this)),this.__dataModel}},{key:"getRecentsModel",value:function(){return this.__recentsModel||(this.__recentsModel=this.getDataModel().getRecents()),this.__recentsModel}},{key:"getRoot",value:function(){return this.__root}}]),t}(p),v.CreateMetaModel=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__deliveryEngine=e,n.__createModels={sfm_processes:[]},n.__recents=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"getRecents",value:function(){return null===this.__recents&&(this.__recents=f.create("com.servicemax.client.sfmcreatedelivery.engine.CreateRecentsModel",this,this.__deliveryEngine)),this.__recents}},{key:"processData",value:function(e,t){var n=void 0,i=e.length;for(this.__createModels.sfm_processes=[],n=0;n<i;n++)this.__createModels.sfm_processes.push({id:e[n].id,name:"",title:e[n].name,desc:e[n].description,object:{name:e[n].objectName,label:e[n].objectLabel}})}},{key:"getData",value:function(){return this.__createModels}},{key:"getDataAsLookupHash",value:function(){for(var e={},t=0;t<this.__createModels.sfm_processes.length;t++){var n=this.__createModels.sfm_processes[t];e[n.id]=n}return e}}]),t}(m),v.CreateRecentsModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__deliveryEngine=n,i.__recentsModels={sfm_processes:[]},i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"processData",value:function(e){var t=void 0,n=e.length;for(t=0;t<n;t++)this.__recentsModels.sfm_processes.push({id:e[t].id,name:"",title:e[t].title,desc:e[t].desc})}},{key:"getData",value:function(){return this.__recentsModels}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m=n(13).CommandWithResponder,v={name:"com.servicemax.client.sfmcreatedelivery.commands"};v.GetCreateInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCREATEDELIVERY.GET_CREATE_PROCESSES_INFO"})}}]),t}(p),v.GetProcessId=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCREATEDELIVERY.GET_PROCESS_ID"})}}]),t}(p),v.GetRecentsInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"SFMCREATEDELIVERY.GET_RECENTS_INFO"})}}]),t}(p),v.AddToRecents=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,this,{operationId:"SFMCREATEDELIVERY.ADD_TO_RECENTS"})}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.sfmcreatedelivery.responders"};m.GetCreateInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__parent.onGetCreateInfoCompleted(e)}}]),t}(p),m.GetProcessId=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.sfmcreatedelivery.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"afterInitialize",value:function(){m.init(),m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(0).utils,a=(n(19).impl,n(24).navigation,n(22).View),r={name:"com.servicemax.client.sfmcreatedelivery.ui.largemodern.view"},o=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},s=a;Ext.define(r.name+".View",{extend:s,alias:"widget.sfm.createdelivery.view",__deliveryEngine:null,__store:null,initialize:function(){this.callParent()},ready:function(){this.setViewInfo({windowTitle:o().T("FSA008_TAG010","Create New Item"),subTitle:"",hideContextMenu:!1});var e=this.getDeliveryEngine().getDataModel().getData().sfm_processes,t=i.sort(e,"title");this.__store=Ext.widget("svmx.store",{model:"com.servicemax.client.sfmcreatedelivery.ui.largemodern.api.model.Create",data:t});var n=[{itemId:"list",xtype:"svmx.list",grouped:!0,store:this.__store,itemTpl:"<div class='listitem-sfm-search-result-name'>{title}</div><div class='sfm-search-result-description'>{desc} </div>",emptyText:o().T("FSA008_TAG059","No results found"),listeners:{itemtap:i.proxy(this,"__onCreateTap")}}];this.add(n)},__onCreateTap:function(e,t,n,a,r,o){var s=this.getDeliveryEngine().getEventBus(),l=i.create("com.servicemax.client.lib.api.Event","SFMCREATEDELIVERY.GET_PROCESS_ID",this,{request:{record:a},responder:function(e){var t={SVMX_processId:e};i.getCurrentApplication().getCurrentView().changeConsoleApp({app:"sfmdelivery",view:"edit",options:{SVMX_processId:t.SVMX_processId,additionalInfo:{launchRecordInViewMode:!0}}})}});s.triggerEvent(l)}}),i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(0).utils,a=(n(19).impl,n(24).navigation,n(22).View,{name:"com.servicemax.client.sfmcreatedelivery.ui.largemodern.api"});Ext.define(a.name+".model.Create",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"title"},{name:"desc"}]}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){n(825);var i=n(830),a=n(831);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"recentsdelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},views:[{id:"home","class-name":"com.servicemax.client.recents.ui.largemodern.api.RecentsContainer","default-view":!0}],icon:{"large-css-class":"icon-clock","small-css-class":"icon-clock"},controller:{"class-name":"com.servicemax.client.recents.engine.DeliveryEngineImpl"},discover:!0,multiple:!1,positionWeight:2001,"button-text":["FSA006_TAG011","Recent Items"]}}),e.exports={impl:i,api:a}},function(e,t,n){n(81),n(183);var i=n(826),a=n(827),r=n(828),o=n(829),s=n(0).utils;s.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{define:{name:"RECENTS.VIEW",type:"com.servicemax.client.mvc.impl.View"}}}),s.registerDefinition({type:"com.servicemax.client.sfmconsole.deliveryengine",config:{engine:{id:"recents","class-name":"com.servicemax.client.recents.engine.DeliveryEngineImpl"}}}),s.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"CONTROLLER",data:[{event:"RECENTS.ADD_RECENTS",command:"com.servicemax.client.recents.commands.AddRecents"},{event:"RECENTS.GET_RECENTS",command:"com.servicemax.client.recents.commands.GetRecents"}]}}}),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.recents.impl"};y.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){y.init(),y.init(),y.init()}},{key:"afterInitialize",value:function(){}}]),t}(v),y.RecentsDeliveryEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("RecentsDeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(33).AbstractDeliveryEngine,m=n(12).DatetimeUtil,v={name:"com.servicemax.client.recents.engine"},g=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};v.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__isContainerExternal=!1,m.setAmPmText(g().T("FSA016_TAG005","AM"),g().T("FSA016_TAG006","PM")),e.__loadMask=null,e.__parent=null,e.__translation=null,e.__view=null,e.__appCurrentState="",e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){var t=f.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=f.create("com.servicemax.client.recents.impl.RecentsDeliveryEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("RECENTS.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"translate",value:function(e){return g().T(e)}},{key:"getAllTranslation",value:function(){return this.__translation}},{key:"reset",value:function(){}},{key:"run",value:function(e){var t=this;this.options=e||{},setTimeout(function(){t.options.onReady&&t.options.onReady.handler.call(t.options.onReady.context||t)},15)}},{key:"getRoot",value:function(){return this.__troubleshootRoot}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m=n(13).Responder,v={name:"com.servicemax.client.recents.commands"};v.AddRecents=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"RECENTS.ADD_RECENTS"})}}]),t}(p),v.GetRecents=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"RECENTS.GET_RECENTS"})}}]),t}(p),v.AddRecentsResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__callback=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__callback&&this.__callback.handler&&this.__callback.handler.call(this.__callback.context,e)}}]),t}(m),v.GetRecentsResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__callback=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__callback&&this.__callback.handler&&this.__callback.handler.call(this.__callback.context,e)}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.recents.responders"};i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.recents.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10),o=n(0).utils,s=n(22).View,l=n(12).DatetimeUtil,c={name:"com.servicemax.client.recents.ui.largemodern.api"},u=function(){return o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},d=s,_=o.getLoggingService().getLogger("Recents-UI"),h=c.name;Ext.define(h+".RecentsContainer",{extend:d,alias:"widget.recents.recentscontainer",initialize:function(){this.callParent(),this.addListener("resize",this.__doResize,this),this.__syncManager=this.getSyncManager(),this.bind(this.__syncManager,"SYNC_COMPLETED",this.syncCompleteRefresh,this),this.fetchingRecents=!1},unBindSyncCompleted:function(){this.__syncManager&&(_.info("UNBIND Refresh ::for View Id: "+this.id),this.unbind(this.__syncManager,"SYNC_COMPLETED",this.syncCompleteRefresh,this))},__doResize:function(){if(window.cordova&&"IPAD"===o.getClientTypeForUnifiedApp()&&Ext.isiOS){var e=Ext.ComponentQuery.query("#recents-container")[0],t=e&&e.bodyElement.dom;t&&(t.style.setProperty("-webkit-overflow-scrolling","auto"),setTimeout(function(){t.style.setProperty("-webkit-overflow-scrolling","touch")},500))}},updateOptions:function(e){this.buildHeaderTabButtons(this.activeTab)},getSyncManager:function(){var e=o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");return this.__syncManager=e.getInstance(),this.__syncManager},refreshView:function(){},onShow:function(){var e=this;if(e.rendered){if(e.allRecentItems){if(!e.appLaunchButton){var t=Ext.ComponentQuery.query("svmx\\.button[consoleAppId=recentsdelivery]")[0];t&&(e.appLaunchButton=t)}e.fetchingRecents||this.renderRecentsResults().then(function(){e.buildHeaderTabButtons(e.activeTab);var t=e.parent.down("#recentsTabButtons");if(t){var n="all"===e.activeTab?t.down("#allTabButton"):t.down("#createdTabButton");e.recentsTabButtons=t,n&&e.switchTo(e.activeTab,n);var i=e.down("#recentsSearchBox"+e.activeTab),a=i&&Ext.valueFrom(i.getValue(),"");i&&a&&a.length>0&&e.searchHandler(e.activeTab,a)}e.__doResize(),_.info("Refreshed RecentsContainer View ")})}_.info("RecentsContainer View showing"),this.callParent()}},setCacheStateValue:function(e,t,n){t[n]={};for(var i=0;i<e.length;i++){var a=e[i],r=n+"-store-"+a;t[n][a]={};var s=Ext.data.StoreManager.lookup(r);if(s){var l=s.getState();l&&l.sorters.length>0&&(t[n][a].sorters=o.toJSON(l));var c=s.boundComponent||{};if(c){var u=c.collapsed;t[n][a].collapsed=u}}}},getMultiFieldSearchComparator:function(e){return e=e.toLowerCase(),new Ext.util.Filter({filterFn:function(t){var n=Ext.valueFrom(t.get("NameField"),""),i=Ext.valueFrom(t.get("LastAccessed"),"");if(n&&n.toLowerCase().indexOf(e)>=0||i&&i.toLowerCase().indexOf(e)>=0)return!0}})},searchInRecentsStores:function(e,t){var n=this;(t=t.trim())||n.clearFilterFromRecentsStore(e);for(var i=n.getMultiFieldSearchComparator(t),a=0;a<e.length;a++){var r=e[a],o=Ext.data.StoreManager.lookup(r);!o&&r&&(o=n.getGridStore(r)),o.clearFilter(),o.filter(i);var s=o.boundComponent;n.updateGridTitle(s)}},getGridStore:function(e){var t=e.replace("-store-","-grid-"),n=this.query("#"+t);return n&&n.length>0&&n[0].getStore()},clearFilterFromRecentsStore:function(e){for(var t=this,n=0;n<e.length;n++){var i=e[n],a=Ext.data.StoreManager.lookup(i);!a&&i&&(a=t.getGridStore(i)),a.clearFilter();var r=a.boundComponent;t.updateGridTitle(r)}},updateGridTitle:function(e){var t=e.objectLabel||"";t&&(t=t+" ("+e.getStore().getCount()+")"),e.setTitle(t)},storeStateInCache:function(){var e=this,t=e.CREATED_TAB_OBJECTS,n=e.ALL_TAB_OBJECTS,i={};this.setCacheStateValue(t,i,"created"),this.setCacheStateValue(n,i,"all"),this.cacheServ&&this.cacheServ.setItem("recentsStateCache",o.toJSON(i))},clearStateFromCache:function(e){var t=this,n=t.getCacheStateItemByKey();if(e)for(var i=0;i<e.length;i++){var a=e[i];n[a]=null}else n={};this.cacheServ&&this.cacheServ.setItem("recentsStateCache",o.toJSON(n))},getCacheStateItemByKey:function(e){var t=this.cacheServ.getItem("recentsStateCache");t=!t||Ext.Object.isEmpty(t)?{}:t;var n=o.toObject(t);return e?n&&n[e]?n[e]:{}:n},onHide:function(){this.storeStateInCache(),this.appLaunchButton,_.info("RecentsContainer View hiding"),this.callParent()},syncCompleteRefresh:function(e){if(this.__syncManager&&this.__syncManager.getSyncType){var t=this.__syncManager.getSyncType();"ONECALLSYNC"!=t&&"AGGRESSIVE"!=t||(this.clearStateFromCache(["all","created"]),this.appLaunchButton,this.fetchingRecents||this.renderRecentsResults().then(function(){this.appLaunchButton,_.info("Refreshed RecentsContainer View ")}),this.refreshView(),_.info("Refreshing RecentsContainer View ID:"+this.id))}},buildHeaderTabButtons:function(e){var t=this,n=t.recentsTabButtons;n||(n=t.parent.down("#recentsTabButtons"),e||(e="all"),t.setViewInfo({centerItem:t.__getCenterItem(e)}),t.recentsTabButtons=n)},updateStateConfig:function(e){return e.centerItem=this.__getCenterItem(this.activeTab),e},__getCenterItem:function(e){var t=this;return t.centerItem||(t.centerItem={xtype:"svmx.buttonset",itemId:"recentsTabButtons",cls:"sfmevent-nav-selector",allowMultiple:!1,items:[{text:u().T("FSA006_TAG002","All"),cls:"sfmevent-nav-selector-button",itemId:"allTabButton",pressed:"all"===e,handler:function(){t.switchTo("all",this)}},{text:u().T("FSA006_TAG003","Created"),itemId:"createdTabButton",cls:"sfmevent-nav-selector-button",pressed:"created"===e,handler:function(){this.pressed=!0,t.switchTo("created",this)}}]}),t.centerItem},switchTo:function(e,t){var n=this;switch(e){case"all":n.allRecentItems.show(),n.createdRecentItems.hide(),n.setActiveTabButton(0,t),n.showHideSearchForTab("created",!1),n.showHideSearchForTab("all",n.allTabHasResults),n.activeTab=e;break;case"created":n.createdRecentItems.show(),n.allRecentItems.hide(),n.setActiveTabButton(1,t),n.showHideSearchForTab("created",n.createdTabHasResults),n.showHideSearchForTab("all",!1),n.activeTab=e}},setActiveTabButton:function(e,t){var n=this;if(n.recentsTabButtons&&t)try{n.recentsTabButtons&&(n.recentsTabButtons.setPressedButtons([t]),n.recentsTabButtons.setValue(e))}catch(e){}},getRecentsGridForAnObject:function(e,t,n,i,a,r){var s=a+"-store-"+t,c=a+"-grid-"+t,d=[{property:"LastAccessed",direction:"DESC"}],_=null;if(!Ext.isEmpty(i)&&!Ext.isEmpty(i.sorters)){_=o.toObject(i.sorters).sorters}d=_||d;var h=Ext.create("Ext.data.Store",{fields:[{name:"RecordId"},{name:"ObjectName"},{name:"Type"},{name:"NameField"},{name:"LastAccessed",type:"date",calculate:function(e){var t=e[this.name],n="";if(t){var i=l.convertToTimezone(t);n=l.getFormattedDatetime(i)}else n="";return n}}],storeId:s,data:n,sorters:d,sortOnLoad:!0,remoteSort:!1,remoteFilter:!1,listeners:{},autoDestroy:!0}),f=Ext.create("com.servicemax.client.ui.components.modern.controls.impl.CollapsibleGrid",{store:h,title:e,objectLabel:r,itemId:c,stateful:!0,collapsed:!i||i.collapsed,flex:1,cls:"recents-grid",collapsible:!0,columns:[{text:u().T("FSA006_TAG004","Name"),dataIndex:"NameField",cls:"sfmsearch-result-column",flex:1},{text:u().T("FSA006_TAG005","Last Accessed"),dataIndex:"LastAccessed",cls:"sfmsearch-result-column",flex:1}],emptyText:u().T("FSA006_TAG006","No records to display."),onItemTapHandler:function(e,t){var n=t.get("RecordId");if(!Ext.isEmpty(n)){o.getClient().getServiceRegistry().getService("com.servicemax.client.sfmsearch.platformspecifics").getInstance().showRecord({key:n,objectName:""}).always(function(){t.recordOpening=null})}},defaultListenerScope:!0,listeners:{select:"onItemTapHandler"}});return h.boundComponent=f,f},ALL_TAB_OBJECTS:[],CREATED_TAB_OBJECTS:[],allTabHasResults:!1,createdTabHasResults:!1,getRecentResultsByTab:function(e,t){var n=this,i=[],r=n.getCacheStateItemByKey(t),o="";"all"===t?o="ALL_TAB_OBJECTS":"created"===t&&(o="CREATED_TAB_OBJECTS");var s=(0,a.default)(e||{}).length;for(var l in e){n[o].push(l);var c=r[l]||{};1===s&&(c.collapsed=!1);var u=e[l],d=n.getRecentsGridForAnObject(u.label+" ("+u.data.length+")",l,u.data,c,t,u.label);i.push(d)}return i},showHideSearchForTab:function(e,t){var n=this,i="#searchBar"+e,a=n.down(i);a&&(t?a.show():a.hide())},resetObjectList:function(){var e=this;e.ALL_TAB_OBJECTS&&(e.ALL_TAB_OBJECTS.length=0),e.CREATED_TAB_OBJECTS&&(e.CREATED_TAB_OBJECTS.length=0),e.ALL_TAB_OBJECTS=e.ALL_TAB_OBJECTS||[],e.CREATED_TAB_OBJECTS=e.CREATED_TAB_OBJECTS||[]},renderRecentsResults:function(){var e=r.Deferred(),t=this;return!1===t.fetchingRecents&&(t.fetchingRecents=!0),t.blockApplication(),t.getRecentsData().then(function(n){t.resetObjectList();try{t.allRecentItems.removeAll(),t.createdRecentItems.removeAll();var i=n.allRecords,a=n.createdRecords,r=!1;if(Ext.Object.isEmpty(i))r=!1,t.allTabHasResults=!1,t.allRecentItems.add({cls:"no-recents-items-message",html:u().T("FSA006_TAG007","No Recently Created, Viewed, Edited Items found")});else{r=!0,t.allTabHasResults=!0;var o=t.getRecentResultsByTab(i,"all");o.length>0&&t.allRecentItems.add(o)}if(Ext.Object.isEmpty(a))!1,t.createdTabHasResults=!1,t.createdRecentItems.add({cls:"no-recents-items-message",html:u().T("FSA006_TAG008","No Recently Created Items found")});else{!0,t.createdTabHasResults=!0;var s=t.getRecentResultsByTab(a,"created");s.length>0&&t.createdRecentItems.add(s)}t.showHideSearchForTab("all",r),t.showHideSearchForTab("created",!1)}catch(e){console.log("Tried to launch Recents by clicking/tapping twice???")}t.appLaunchButton&&t.appLaunchButton.enable(),t.unblockApplication(),t.fetchingRecents=!1,e.resolve()}),e},allRecentItems:null,createdRecentItems:null,recentsTabButtons:null,cacheServ:null,activeTab:"all",getSearchBarConfig:function(e,t){var n=this,i="recentsSearchBox"+e;return{xtype:"panel",layout:"hbox",docked:"top",hidden:!0,itemId:"searchBar"+e,cls:"sfmsearch-search-bar",items:[{xtype:"textfield",cls:"sfmsearch-keyword-field recents-search-keyword-field",itemId:i,width:"50%",placeHolder:u().T("FSA006_TAG009","Search"),associatedTab:e,ui:"svmx-default",listeners:{change:function(e,t){var i=Ext.valueFrom(e.getValue(),"");n.searchHandler(e.associatedTab,i)}}}]}},getStoreIdsByTab:function(e){var t=this,n="";"all"===e?n="ALL_TAB_OBJECTS":"created"===e&&(n="CREATED_TAB_OBJECTS");for(var i=[],a=t[n],r=0;r<a.length;r++)i.push(e+"-store-"+a[r]);return i},searchHandler:function(e,t){var n=this,i=e||"all",a=n.getStoreIdsByTab(i);n.searchInRecentsStores(a,t)},getRecentsData:function(){var e=r.Deferred(),t=o.create("com.servicemax.client.lib.api.Event","RECENTS.GET_RECENTS",this,{request:{},responder:{result:function(t){e.resolve(t)}}});return o.getCurrentApplication().triggerEvent(t),e},ready:function(){var e=this;e.cacheServ=o.getClient().getServiceRegistry().getService("com.servicemax.client.cache").getInstance(),e.setViewInfo({backText:u().T("FSA006_TAG011","Recent Items"),hideContextMenu:!0});var t={xtype:"svmx.verticalpanel",width:"100%",height:"100%",cls:"recents-container",itemId:"recents-container",ui:"svmx-default",scrollable:"y",items:[e.getSearchBarConfig("all"),e.getSearchBarConfig("created"),{xtype:"svmx.panel",cls:"sfmsearch-search-results-container all-recents-container",ui:"svmx-default",itemId:"allRecentsContainer"},{xtype:"svmx.panel",cls:"sfmsearch-search-results-container created-recents-container",ui:"svmx-default",hidden:!0,itemId:"createdRecentsContainer"}]};e.add(t)[0],e.allRecentItems=e.down("#allRecentsContainer"),e.createdRecentItems=e.down("#createdRecentsContainer"),e.recentsTabButtons=e.parent.down("#recentsTabButtons"),e.buildHeaderTabButtons(e.activeTab),e.fetchingRecents||e.renderRecentsResults().then(function(){setTimeout(function(){e.__doResize()},500);var t=e.cacheServ.getItem("recentsStatePreferences"),n=o.toObject(t);(!n||n&&1!=n.tutorialShownToUser)&&e.ALL_TAB_OBJECTS.length>1&&e.showTutorial()})},showTutorial:function(){var e=this,t=Ext.ComponentQuery.query("svmx\\.collapsibletitlebar")[0];t&&(Ext.widget("svmx.tutorialpopover",{arrowCls:"sfmsearch-tutorial-popover-arrow",containerCls:"sfmsearch-tutorial-popover",html:u().T("FSA006_TAG001","Tap on the titles to expand and collapse the tables ")}).showBy(t,"tl-tr?"),e.cacheServ.setItem("recentsStatePreferences",o.toJSON({tutorialShownToUser:!0})))},doDestroy:function(){this.unBindSyncCompleted(),this.callParent()}}),o.defineGlobal(c.name,c),e.exports=c},function(e,t,n){n(833);var i=n(838),a=n(839),r=n(840);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"tasks","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},icon:{"large-css-class":"icon-circle-check","small-css-class":"icon-circle-check"},views:[{id:"view","class-name":"com.servicemax.client.tasks.ui.largemodern.view.View","default-view":!0}],controller:{"class-name":"com.servicemax.client.tasks.engine.DeliveryEngineImpl"},discover:!0,multiple:!1,positionWeight:4e3,"button-text":["FSA011_TAG013","Tasks"]}}),e.exports={impl:i,view:a,api:r}},function(e,t,n){n(81),n(183);var i=n(834),a=n(835),r=n(836),o=n(837),s=n(0).utils;s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"TASKS.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"tasks","class-name":"com.servicemax.client.tasks.engine.DeliveryEngineImpl"}}}')),s.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"CONTROLLER",data:[{event:"TASKS.GET_TASKS_LIST",command:"com.servicemax.client.tasks.commands.GetTasksList"},{event:"TASKS.MANAGE_TASK",command:"com.servicemax.client.tasks.commands.ManageTask"}]}}}),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.tasks.impl"};y.Module=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e._logger=m.getLoggingService().getLogger("APP-IMPL"),e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){y.init(),y.init(),y.init()}},{key:"afterInitialize",value:function(){}}]),t}(v),y.TasksEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("TasksEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(33).AbstractDeliveryEngine,m=n(5).SVMXObject,v={name:"com.servicemax.client.tasks.engine"},g=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};v.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__isContainerExternal=!1,e.__eventBus=null,e.__view=null,e.__translation=null,e.__root=null,e.__metamodel=null,e.__consoleAppInstance=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){var t=f.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=f.create("com.servicemax.client.tasks.impl.TasksEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){t.createNamedInstanceAsync("TASKS.VIEW",{handler:function(t){n.setModel(i),this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"triggerEvent",value:function(e){this.__eventBus.triggerEvent(e)}},{key:"translate",value:function(e){return g().T(e)}},{key:"getAllTranslation",value:function(){return this.__translation}},{key:"reset",value:function(){this.getRoot()&&(this.getRoot().destroy(),this.__root=null),this.run(this.options)}},{key:"run",value:function(e){this.options=e||{},this.__consoleAppInstance=e.consoleAppInstance;var t=f.create("com.servicemax.client.lib.api.Event","TASKS.GET_TASKS_LIST",this,{request:{},responder:f.create("com.servicemax.client.tasks.responders.GetTasksListResponder",this)});this.triggerEvent(t)}},{key:"onGetTasksListCompleted",value:function(e){this.__metamodel=f.create("com.servicemax.client.tasks.engine.TasksMetaModel",this,e),this.__root=this.__view.createComponent("ROOTCONTAINER",{metamodel:this.__metamodel,deliveryEngine:this,consoleAppInstance:this.__consoleAppInstance}),this.options.onReady&&this.options.onReady.handler.call(this.options.onReady.context||this)}},{key:"getRoot",value:function(){return this.__root}},{key:"getMetaModel",value:function(){return this.__metamodel}}]),t}(p),v.TasksMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}},{key:"getData",value:function(){return this.__data}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.tasks.commands"};m.GetTasksList=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TASKS.GET_TASKS_LIST"})}}]),t}(p),m.ManageTask=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TASKS.MANAGE_TASK"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.tasks.responders"};m.GetTasksListResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__engine=e,n.__parent=null,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__engine.onGetTasksListCompleted(e)}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.tasks.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"afterInitialize",value:function(){m.init(),m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){n(400);var i=n(0).utils,a=n(22).View,r=n(12).DatetimeUtil,o=n(7).MetaData,s={name:"com.servicemax.client.tasks.ui.largemodern.view"},l=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},c=a,u=r,d=o;s.View=Ext.define(s.name+".View",{extend:c,alias:"widget.sfm.tasks.view",__deliveryEngine:null,__store:null,__list:null,__describeObject:null,__isActivityDateHidden:!0,__isSubjectHidden:!0,__isPriorityHidden:!0,__subjectLength:null,__listDeleteButton:null,__createable:null,__deletable:null,initialize:function(){var e=i.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance(),this.bind(this.__syncManager,"SYNC_STOPPED",this.__onSyncStop,this)},__onSyncStop:function(){this.__reset()},__reset:function(){this.__store.destroy(),this.__list.destroy(),this.getDeliveryEngine().reset()},ready:function(){d.describeObject({objectName:"Task",onSuccess:i.proxy(this,function(e){this.__describeObject=e,this.__createable=e.createable,this.__deletable=e.deletable;for(var t=e.fields,n=0;n<t.length;n++){var i=t[n];"Subject"==i.name?(this.__isSubjectHidden=!1,this.__subjectLength=i.length):"ActivityDate"==i.name?this.__isActivityDateHidden=!1:"Priority"==i.name&&(this.__isPriorityHidden=!1)}this.__setupView()}),onError:i.proxy(this,function(){i.getLoggingService().getLogger("TasksView").warn("Failed describeObject for Tasks, maybe needs a config sync or permission changes?"),i.Msg.confirm({title:l().T("FSA011_TAG011","Error"),text:l().T("FSA001_TAG030","Failed Object Describe for Tasks. Please check ServiceMax configuration."),buttons:[{text:l().T("FSA016_TAG003","OK"),ui:"svmx-button-square",itemId:"OK"}]}).then(function(){})})})},__setupStore:function(e){this.__store=i.create("com.servicemax.client.ui.components.modern.data.SVMXStore",{model:"com.servicemax.client.tasks.ui.largemodern.api.model.Tasks",data:e})},__setupList:function(){var e=this,t=this.__setupItemTpl(),n=[{itemId:"list",xtype:"svmx.list",cls:"tasks-list",itemConfig:{ui:"tasks-list-item",cls:"tasks-list-item-container"},grouped:!0,store:this.__store,itemTpl:t,emptyText:l().T("FSA011_TAG014","No tasks found. Try adding new task."),listeners:{itemtap:i.proxy(e,"__onTaskTap"),itemswipe:i.proxy(e,"__onTaskSwipe")}}];this.add(n),this.__list=this.query("#list")[0],this.__sortStore()},__setupView:function(){var e=this;this.setViewInfo({windowTitle:l().T("FSA011_TAG013","Tasks"),subTitle:"",hideContextMenu:!1,rightItem:{xtype:"svmx.button",itemId:"addTaskButton",text:l().T("FSA011_TAG012","+ Add"),handler:i.proxy(e,"__newTaskTap")}}),this.__setupStore(this.getDeliveryEngine().getMetaModel().getData()),this.__setupList()},__setupItemTpl:function(){var e=["<div class='tasks-list-item'>"];return this.__isSubjectHidden||e.push("<div class='tasks-list-item-subject'>{Subject:htmlEncode}</div>"),this.__isActivityDateHidden||e.push("<div class='tasks-list-item-date'>{[this.formatDate(values.ActivityDate)]}</div>"),this.__isPriorityHidden||e.push("<span class='{[this.getPriorityIcon(values.Priority)]} tasks-list-item-priority'></span>"),e.push("</div>"),e.push({getPriorityIcon:function(e){return"Low"==e?"icon-double-arrow":"High"==e?"icon-double-exclamation-points":""},formatDate:function(e){return"en"==u.getLocale()?u.getFormattedDatetime(e,"MMM D, YYYY"):u.getFormattedDatetime(e,"LL")}}),e},__newTaskTap:function(){this.__showTasksBox("new")},__onTaskTap:function(e,t,n,i,a,r){a.target&&a.target.parentElement.className.includes("button-tasks-list-item-swipe-delete")||this.__showTasksBox("edit",i)},__showTasksBox:function(e,t){Ext.widget("tasks.tasksbox",{type:e,record:t,saveButtonHandler:"new"==e?i.proxy(this,"__addRecordToStore"):i.proxy(this,"__updateRecordInStore",t),deleteButtonHandler:i.proxy(this,"__deleteRecordFromStore",t),isActivityDateHidden:this.__isActivityDateHidden,isSubjectHidden:this.__isSubjectHidden,isPriorityHidden:this.__isPriorityHidden,subjectLength:this.__subjectLength}).show()},__sortStore:function(){this.__store.sort([{sorterFn:function(e,t){var n={High:1,Normal:2,Low:3};return n[e.data.Priority]-n[t.data.Priority]}},{sorterFn:function(e,t){if(e.data.ActivityDate&&t.data.ActivityDate){var n=new Date(e.data.ActivityDate).getTime();return new Date(t.data.ActivityDate).getTime()-n}return 0},direction:"ASC"},{property:"Subject",direction:"ASC"}])},__addRecordToStore:function(e){this.__store.loadData([e],!0),this.__sortStore(),this.__list.refresh()},__updateRecordInStore:function(e){var t=this.__store.getById(e.id);t||(t=this.__store.data.items.find(function(t){return t.raw.Id===e.raw.Id})),t&&(t.data.ActivityDate=e.data.ActivityDate,t.data.Priority=e.data.Priority,t.data.Subject=e.data.Subject,this.__sortStore(),this.__list.refresh())},__deleteRecordFromStore:function(e){this.__store.remove(e),this.__list.refresh()},__deleteListItem:function(e){i.Msg.alert({title:null,text:l().T("FSA011_TAG009","Delete this task (this action cannot be undone)?"),buttons:[{text:l().T("FSA016_TAG004","Cancel"),itemId:"Cancel",ui:"svmx-button-square"},{text:l().T("FSA011_TAG010","Delete"),itemId:"Delete",ui:"svmx-button-square"}]}).then(i.proxy(this,function(t){if("Delete"==t){var n=i.getCurrentApplication(),a=i.create("com.servicemax.client.lib.api.Event","TASKS.MANAGE_TASK",this,{request:{type:"delete",recordId:e.data.Id},responder:{result:i.proxy(this,function(){this.__deleteRecordFromStore(e)})}});n.triggerEvent(a)}}))},__onTaskSwipe:function(e,t,n,a,r,o){if("left"==r.direction){this.__listDeleteButton=Ext.widget("svmx.button",{text:"",cls:"button-tasks-list-item-swipe-delete",ui:"button-swipe-delete",iconCls:"icon-trashcan",listeners:{tap:i.proxy(this,function(e,t){t.stopEvent(),this.__deleteListItem(a)})}});var s=this.__listDeleteButton,l=function(){Ext.Anim.run(s,"fade",{after:function(){s.destroy(),n.removeCls("tasks-list-row-swiped")},out:!0})};return s.renderTo(n.element.dom),e.on({single:!0,buffer:250,itemtouchstart:l}),Ext.Viewport.element.on({single:!0,buffer:250,touchstart:l}),n.addCls("tasks-list-row-swiped"),s}}}),i.defineGlobal(s.name,s),e.exports=s},function(e,t,n){var i,a=n(50),r=function(e){return e&&e.__esModule?e:{default:e}}(a),o=n(0).utils,s=(n(22).View,n(12).DatetimeUtil),l=n(19).form,c={name:"com.servicemax.client.tasks.ui.largemodern.api"},u=function(){return o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},d=s,_=l;Ext.define(c.name+".model.Tasks",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"Id"},{name:"Subject"},{name:"ActivityDate"},{name:"Priority"},{name:"OwnerId"}]}),Ext.define(c.name+".TasksBox",(i={extend:"com.servicemax.client.ui.components.modern.popups.SVMXSheet",alias:"widget.tasks.tasksbox",cls:"svmx-tasks-box",ui:"tasks-box",showAnimation:null,height:null,layout:{type:"vbox"}},(0,r.default)(i,"showAnimation",null),(0,r.default)(i,"__record",null),(0,r.default)(i,"__type",null),(0,r.default)(i,"__priority",null),(0,r.default)(i,"__description",null),(0,r.default)(i,"__date",null),(0,r.default)(i,"__calendarField",null),(0,r.default)(i,"__descriptionField",null),(0,r.default)(i,"__priorityField",null),(0,r.default)(i,"__priorityBoxes",null),(0,r.default)(i,"__isActivityDateHidden",null),(0,r.default)(i,"__isSubjectHidden",null),(0,r.default)(i,"__isPriorityHidden",null),(0,r.default)(i,"__subjectLength",null),(0,r.default)(i,"constructor",function(e){var t=e||{};this.__isActivityDateHidden=t.isActivityDateHidden,this.__isSubjectHidden=t.isSubjectHidden,this.__isPriorityHidden=t.isPriorityHidden,this.__subjectLength=t.subjectLength,this.__record=t.record||null,this.__type=t.type||"new","edit"==this.__type?(this.__priority=t.record.data.Priority,this.__description=t.record.data.Subject,this.__date=t.record.data.ActivityDate):this.__date=new Date;var n=[];this.__isActivityDateHidden||(this.__calendarField=this.__setupCalendarPanel(t),n.push(this.__calendarField)),this.__isSubjectHidden||(this.__descriptionField=this.__setupDescriptionPanel(t),n.push(this.__descriptionField)),this.__isPriorityHidden||(this.__priorityField=this.__setupPriorityPanel(t),n.push(this.__priorityField));var i=Ext.widget("svmx.panel",{cls:"tasks-form-body",items:n});"edit"==this.__type&&i.add({xtype:"svmx.button",ui:"button-tasks-box-delete",cls:"button-tasks-box-delete",text:u().T("FSA011_TAG001","Delete Task"),handler:o.proxy(this,this.__doDelete)}),t.items=[this.__setupHeaderbar(),i],this.callParent([t])}),(0,r.default)(i,"__setupHeaderbar",function(e){var t=void 0;return t="edit"==this.__type?u().T("FSA011_TAG002","Edit Task"):u().T("FSA011_TAG003","New Task"),{xtype:"svmx.headerbar",cls:"sfmevent-edit-dialog-headerbar",leftItem:[{xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-cancel",text:u().T("FSA016_TAG004","Cancel"),handler:o.proxy(this,function(){this.destroy()})}],rightItem:[{xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-save",text:u().T("FSA011_TAG005","Save"),handler:o.proxy(this,"__doSave")}],centerItem:[{xtype:"svmx.label",cls:"sfmevent-edit-dialog-title",text:t}]}}),(0,r.default)(i,"__setupDescriptionPanel",function(e){var t=this.__description||"";return Ext.widget("svmx.field.textarea",{xtype:"svmx.field.textarea",cls:"svmx-tasks-box-description-textarea",label:u().T("FSA011_TAG006","Description"),labelAlign:"top",value:t,enableBarcode:!1,alwaysShowBarcode:!1,clearIcon:!1,maxLength:this.__subjectLength})}),(0,r.default)(i,"__setupPriorityPanel",function(e){return this.__priority=this.__priority||"Normal",this.__priorityBoxes=[],Ext.widget("svmx.panel",{items:[{xtype:"svmx.label",cls:"label-tasks-box-priority",text:u().T("FSA011_TAG007","Priority")},{xtype:"svmx.fieldset",cls:"fieldset-tasks-box-priority",layout:"hbox",items:[this.__generateRadioInput(u().T("FSA016_TAG044","Low"),"Low",this.__priority),this.__generateRadioInput(u().T("FSA016_TAG045","Normal"),"Normal",this.__priority),this.__generateRadioInput(u().T("FSA016_TAG046","High"),"High",this.__priority)]}]})}),(0,r.default)(i,"__generateRadioInput",function(e,t,n){var i=t===n,a=this,r={xtype:"svmx.field.radio",value:t,label:e,name:"priority",checked:i,flex:1,labelWidth:null,cls:"radiofield-tasks-box-priority",listeners:{check:function(e,t){a.__priority=e.getValue()}}};return this.__priorityBoxes.push(r),r}),(0,r.default)(i,"__setupCalendarPanel",function(e){var t=Ext.create(_.name+".SVMXCalendarPanel",{value:this.__date});return t.addCls("tasks-datepicker-calendar"),t}),(0,r.default)(i,"__doSave",function(){if(this.__record=this.__record||{},this.__isSubjectHidden||(this.__description=this.__descriptionField.getValue()),null===this.__description||""===this.__description.replace(/\s/g,""))return void o.Msg.alert({title:null,text:u().T("FSA011_TAG008","A description is required to save a task"),buttons:[{text:u().T("FSA016_TAG003","OK"),ui:"svmx-button-square"}]});this.__isActivityDateHidden||(this.__date=this.__calendarField.getValue(),this.__date=d.getFormattedDatetime(this.__date,d.getSaveFormat("date")));var e=o.getCurrentApplication(),t=o.create("com.servicemax.client.lib.api.Event","TASKS.MANAGE_TASK",this,{request:{type:this.__type,record:this.__record,description:this.__description,date:this.__date,priority:this.__priority},responder:{result:o.proxy(this,function(e){this.saveButtonHandler(e),this.destroy()})}});e.triggerEvent(t)}),(0,r.default)(i,"__doDelete",function(){o.Msg.alert({title:null,text:u().T("FSA011_TAG009","Delete this task (this action cannot be undone)?"),buttons:[{text:u().T("FSA016_TAG004","Cancel"),itemId:"Cancel",ui:"svmx-button-square"},{text:u().T("FSA011_TAG010","Delete"),itemId:"Delete",ui:"svmx-button-square"}]}).then(o.proxy(this,function(e){if("Delete"==e){var t=o.getCurrentApplication(),n=o.create("com.servicemax.client.lib.api.Event","TASKS.MANAGE_TASK",this,{request:{type:"delete",recordId:this.__record.data.Id},responder:{result:o.proxy(this,function(){this.deleteButtonHandler(this.__record),this.destroy()})}});t.triggerEvent(n)}}))}),i)),o.defineGlobal(c.name,c),e.exports=c},function(e,t,n){n(842);var i=n(847),a=n(848),r=n(849),o=n(850),s=n(851);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"toolspages-largemodern","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},icon:{"large-css-class":"icon-gears","small-css-class":"icon-gears"},views:[{id:"svmx-toolspages-home","class-name":"com.servicemax.client.toolspages.ui.largemodern.homeview.HomeView","default-view":!0},{id:"syncconflict","class-name":"com.servicemax.client.toolspages.ui.largemodern.conflictlistview.SyncConflictView"},{id:"resetapp","class-name":"com.servicemax.client.toolspages.ui.largemodern.resetappview.ResetAppView"}],controller:{"class-name":"com.servicemax.client.toolspages.engine.DeliveryEngineImpl"},discover:!0,multiple:!1,positionWeight:5e3,"button-text":["FSA012_TAG012","Tools"],"conflict-badge-class":"svmx-conflict-badge","show-conflicts":!0}}),e.exports={impl:i,api:a,homeview:r,conflictlistview:o,resetappview:s}},function(e,t,n){var i=n(843),a=n(844),r=n(845),o=n(846),s=n(0).utils;s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"TOOLSPAGES.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"toolspages","class-name":"com.servicemax.client.toolspages.engine.DeliveryEngineImpl"}}}')),s.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"TOOLSPAGES.UPDATE_CONFLICT","command":"com.servicemax.client.toolspages.commands.UpdateConflict"},{"event":"TOOLSPAGES.GET_OUTPUT_DOCS_COUNT","command":"com.servicemax.client.toolspages.commands.GetOutputDocsCount"},{"event":"TOOLSPAGES.ALLOW_API_ACCESS","command":"com.servicemax.client.toolspages.commands.AllowApiAccess"}]}}}')),e.exports={impl:i,engine:a,commands:r,responders:o}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.toolspages.impl"};y.Module=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e._logger=m.getLoggingService().getLogger("APP-IMPL"),e}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){y.init(),y.init(),y.init()}},{key:"afterInitialize",value:function(){}}]),t}(v),y.ToolspagesEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("ToolspagesEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(33).AbstractDeliveryEngine,m=n(5).SVMXObject,v={name:"com.servicemax.client.toolspages.engine"},g=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};v.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__isContainerExternal=!1,e.__eventBus=null,e.__view=null,e.__translation=null,e.__adminRoot=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){var t=f.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=f.create("com.servicemax.client.toolspages.impl.ToolspagesEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){t.createNamedInstanceAsync("TOOLSPAGES.VIEW",{handler:function(t){n.setModel(i),this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"translate",value:function(e){return g().T(e)}},{key:"getAllTranslation",value:function(){return this.__translation}},{key:"reset",value:function(){this.getRoot().destroy(),this.__adminRoot=null,this.run(this.options)}},{key:"run",value:function(e){var t=this;this.options=e||{},this.__adminRoot=this.__view.createComponent("ROOTCONTAINER",{deliveryEngine:this,consoleAppInstance:e.consoleAppInstance}),setTimeout(function(){t.options.onReady&&t.options.onReady.handler.call(t.options.onReady.context||t)},15)}},{key:"getRoot",value:function(){return this.__adminRoot}}]),t}(p),v.ToolspagesMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.toolspages.commands"};m.UpdateConflict=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TOOLSPAGES.UPDATE_CONFLICT"})}}]),t}(p),m.GetOutputDocsCount=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TOOLSPAGES.GET_OUTPUT_DOCS_COUNT"})}}]),t}(p),m.AllowApiAccess=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TOOLSPAGES.ALLOW_API_ACCESS"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Responder,m={name:"com.servicemax.client.toolspages.responders"};m.UpdateConflictResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){}}]),t}(p),m.GetOutputDocsCountResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__parent=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.toolspages.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"afterInitialize",value:function(){m.init(),m.init(),m.init(),m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(10),a=n(0).utils,r=n(19).impl,o=(n(24).navigation,n(22).View),s={name:"com.servicemax.client.toolspages.ui.largemodern.api"},l=function(){return a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},c=r,u=o;Ext.define(s.name+".model.Conflicts",{extend:"com.servicemax.client.ui.components.modern.data.SVMXModel",fields:[{name:"Id"},{name:"parent_id"},{name:"operation"},{name:"error_type"},{name:"local_id"},{name:"override_flag"},{name:"object_name"},{name:"nameValue"},{name:"label"},{name:"detailId"},{name:"error_message"},{name:"displayValue",convert:function(e,t){var n=t.get("nameValue");return n=!1!==n?n||l().T("FSA012_TAG006","New Record"):l().T("FSA012_TAG007","--None--")}}]}),Ext.define(s.name+".SyncProgress",{extend:c.name+".SVMXPanel",alias:"widget.tools.sync.progress",cls:"panel-sync-progress",__subStep:0,config:{readOnly:!0,halign:"center",view:null},initConfig:function(e){e=e||{};var t=e.message||"";e.showSubProgress=e.showSubProgress||!1,e.items=[{xtype:"svmx.label",itemId:"syncProgressMessage",text:t,cls:"label-tools-initial-sync"},{xtype:"svmx.horizontalpanel",cls:"initial-sync-progress-panel",items:[{xtype:"svmx.progressbar",containerCls:"container-sfm-tools-small-progressbar",barCls:"sfm-tools-small-progressbar-bar",itemId:"syncProgressBar",flex:9}]},{xtype:"svmx.label",itemId:"syncProgressCurrent",text:"",cls:"label-tools-initial-sync-steps"},{xtype:"svmx.carousel",itemId:"syncTutorialPane",cls:"panel-tools-sync-tutorial",hidden:!1,config:{interval:5e3},items:[{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-001"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-002"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-003"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-004"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-005"}]}]}],this.callParent([e])},updateSubProgress:function(){var e=this.query("#subSyncProgressBar")[0];if(this.__subStep=this.__subStep>=100?0:this.__subStep+10,e){var t=Math.round(this.__subStep/100*100);e.updateProgress(t)}},updateProgress:function(e,t,n){var i=this.query("#syncProgressCurrent")[0],a=this.query("#syncProgressBar")[0];if(n)var r=l().T("FSA012_TAG008","Step")+" "+e+" "+l().T("FSA012_TAG009","of")+" "+t+" - "+n;else var r=l().T("FSA012_TAG008","Step")+" "+e+" "+l().T("FSA012_TAG009","of")+" "+t;if(i&&(i.setCls("label-tools-resetapp-progress-message"),i.setHtml(r)),a){var o=Math.round(e/t*100);a.updateProgress(o)}}}),Ext.define(s.name+".SyncConflictView",{extend:u,alias:"widget.sfm.tools.sync.conflict",onShow:function(){},updateOptions:function(e){},ready:function(){this.setViewInfo({windowTitle:l().T("FSA010_TAG052","Sync Conflicts"),subTitle:"",backText:l().T("FSA010_TAG125","Sync")});var e=[{html:"Sync Conflict Placeholder"}];this.add(e)},__getConflicts:function(){var e=new i.Deferred;return this.__syncManager.getDisplayableConflicts(function(t){t=t||{},e.resolve(t)}),e.promise()}}),Ext.define(s.name+".SVMXNavContainerToolsPanel",{extend:c.name+".SVMXPanel",alias:"widget.tools.navcontainertoolspanel",config:{header:{docked:!1,cls:"panel-tools-card-header"}},initConfig:function(e){var t=e||{};t.ui="panel-tools-card";var n={xtype:"svmx.horizontalpanel",title:t.title,cls:"panel-tools-card-container"};if(1==t.items.length){var i={xtype:"svmx.verticalpanel",width:"100%",height:"100%",items:t.items[0],cls:"panel-tools-card-leftsection"};t.applyClass&&t.applyClass.length>0&&(i.cls=t.applyClass),n.items=[i]}else{var a={xtype:"svmx.verticalpanel",items:t.items[0],cls:"panel-tools-card-leftsection"},r={xtype:"svmx.verticalpanel",valign:"right",items:t.items[1],cls:"panel-tools-card-rightsection"};n.items=[a,r]}t.items=[n],this.callParent([t])}}),Ext.define(s.name+".ConflictResolveMsgBox",{extend:"com.servicemax.client.ui.components.modern.popups.SVMXSheet",alias:"widget.tools.conflictresolvemsgbox",cls:"sheet-tools-sync-conflict",__action:null,__record:null,initConfig:function(e){var t=i.extend(!0,{},e);this.__record=t.record;var n=this.__createResolutionPanel(t),r=this.__createDisplayItemPanel(t),o=this.__createSyncDetailsPanel(t),s=e.name?e.name:l().T("FSA012_TAG007","--None--"),c=l().T("FSA010_TAG072","Sync Conflict")+": "+s,u={xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-cancel",text:l().T("FSA016_TAG004","Cancel"),handler:a.proxy(this,function(){this.__destroy()})},d={xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-save",text:l().T("FSA010_TAG071","Apply"),handler:a.proxy(this,"__doApply")};t.showViewInfo?t.items=[{xtype:"svmx.headerbar",cls:"sfmevent-edit-dialog-headerbar",leftItem:[u],rightItem:[d],centerItem:[{xtype:"svmx.label",cls:"sfmevent-edit-dialog-title",text:c}]},{xtype:"svmx.panel",cls:"tools-resolution-container",items:[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-sync-conflict-header label-tools-card-description",text:l().T("FSA010_TAG073",'This item could not be synchronized. Please refer to the details below and choose an option. If you need to review this item, choose "Decide later".')},r,o,n]}]:t.items=[{xtype:"svmx.headerbar",cls:"sfmevent-edit-dialog-headerbar",leftItem:[u],rightItem:[d],centerItem:[{xtype:"svmx.label",cls:"sfmevent-edit-dialog-title",text:c}]},{xtype:"svmx.panel",cls:"tools-resolution-container",items:[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-sync-conflict-header label-tools-card-description",text:l().T("FSA010_TAG073",'This item could not be synchronized. Please refer to the details below and choose an option. If you need to review this item, choose "Decide later"')},o,n]}],this.callParent([t])},__createSyncDetailsPanel:function(e){return{xtype:"svmx.panel",ui:"panel-tools-sync-conflict-details",cls:"panel-tools-sync-conflict-details",items:[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description label-tools-sync-conflict-details",text:e.syncDetails}]}},__createResolutionPanel:function(e){var t={};return"conflict"==this.__record.error_type?t={align:"vbox",xtype:"svmx.panel",ui:"panel-tools-sync-conflict-resolution",cls:"panel-tools-sync-conflict-resolution",id:"resolution-box-tools",items:[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-sync-conflict-resolution-section-title",text:l().T("FSA010_TAG074","Resolution")},{xtype:"svmx.fieldset",labelAlign:"right",items:[this.__generateRadioInput(l().T("FSA010_TAG075","Keep my changes and replace server version"),"CLIENT_OVERRIDE",this.__record.override_flag),this.__generateRadioInput(l().T("FSA010_TAG076","Lose my changes and use server version"),"SERVER_OVERRIDE",this.__record.override_flag),this.__generateRadioInput(l().T("FSA010_TAG077","Decide later"),"",this.__record.override_flag)]},{xtype:"svmx.label",ui:"svmx-default",cls:"tools-sync-resolution-largemodern-label label-tools-card-description",text:l().T("FSA010_TAG078","Resolution will be applied at next sync")}]}:"error"==this.__record.error_type&&"insert"==this.__record.operation||"error"==this.__record.error_type&&"delete"==this.__record.operation?t={align:"vbox",xtype:"svmx.panel",ui:"panel-tools-sync-conflict-resolution",cls:"panel-tools-sync-conflict-resolution",id:"resolution-box-tools",items:[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-sync-conflict-resolution-section-title",text:l().T("FSA010_TAG074","Resolution")},{xtype:"svmx.fieldset",labelAlign:"right",items:[this.__generateRadioInput(l().T("FSA012_TAG025","Retry"),"CLIENT_OVERRIDE",this.__record.override_flag),this.__generateRadioInput(l().T("FSA010_TAG079","Remove record permanently"),"CLIENT_DELETE",this.__record.override_flag),this.__generateRadioInput(l().T("FSA010_TAG077","Decide Later"),"",this.__record.override_flag)]},{xtype:"svmx.label",ui:"svmx-default",cls:"tools-sync-resolution-largemodern-label label-tools-card-description",text:l().T("FSA010_TAG078","Resolution will be applied at next sync")}]}:"error"==this.__record.error_type&&"update"==this.__record.operation&&(t={align:"vbox",xtype:"svmx.panel",ui:"panel-tools-sync-conflict-resolution",cls:"panel-tools-sync-conflict-resolution",id:"resolution-box-tools",items:[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-sync-conflict-resolution-section-title",text:l().T("FSA010_TAG074","Resolution")},{xtype:"svmx.fieldset",labelAlign:"right",items:[this.__generateRadioInput(l().T("FSA012_TAG025","Retry"),"CLIENT_OVERRIDE",this.__record.override_flag),this.__generateRadioInput(l().T("FSA010_TAG076","Lose my changes and use server version"),"SERVER_OVERRIDE",this.__record.override_flag),this.__generateRadioInput(l().T("FSA012_TAG010","Decide Later"),"",this.__record.override_flag)]},{xtype:"svmx.label",ui:"svmx-default",cls:"tools-sync-resolution-largemodern-label label-tools-card-description",text:l().T("FSA010_TAG078","Resolution will be applied at next sync")}]}),t},__createDisplayItemPanel:function(e){return{xtype:"svmx.panel",cls:"panel-tools-sync-conflict-obj-name",ui:"panel-tools-sync-conflict-obj-name",items:[{xtype:"svmx.verticalpanel",valign:"left",items:[{xtype:"svmx.label",ui:"svmx-default",text:e.objectType},{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:e.name}]},{xtype:"svmx.verticalpanel",valign:"right",id:"tools-right",cls:"panel-tools-card-rightsection",items:[{xtype:"svmx.button",ui:"button-tools",text:l().T("FSA010_TAG080","View"),handler:a.proxy(this,"__showRecord",e.record)}]}]}},__generateRadioInput:function(e,t,n){var i=t===n;i&&(this.__action=t);var a=this;return{xtype:"svmx.field.radio",name:"conflictOperation",value:t,label:e,checked:i,labelAlign:"right",labelWidth:"",cls:"tools-conflict-detail-action-radio",inputCls:"tools-conflict-detail-action-radio-input",labelCls:"label-tools-sync-conflict-action-radio",listeners:{check:function(e,t){a.__action=e._value}}}},__doApply:function(){var e=this;a.create("com.servicemax.client.sfmconsole.utils.EventCollection",a.getCurrentApplication(),[a.create("com.servicemax.client.lib.api.Event","TOOLSPAGES.UPDATE_CONFLICT",this,{request:{action:this.__action,record:this.__record}})]).triggerAll(function(t){e.applyHandler&&e.applyHandler(e.__action,e.__record),e.__showResolutionMessage()})},__showResolutionMessage:function(){var e=this,t=void 0;t="CLIENT_OVERRIDE"==this.__action?l().T("FSA010_TAG081","Your changes will be kept.</br></br>You can change the resolution at any time before the next sync."):"SERVER_OVERRIDE"==this.__action?l().T("FSA010_TAG082","All changes will be lost. If you make additional changes before the next sync, they will be lost too.</br></br>You can change the resolution at any time before the next sync."):"CLIENT_DELETE"==this.__action?l().T("FSA010_TAG083","This item will be deleted.</br></br>You can change the resolution at any time before the next sync."):l().T("FSA010_TAG084","This item will remain in conflict.</br></br>Changes will not be synchronized."),a.Msg.alert({title:null,text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:t}],buttons:[{text:l().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]}).then(function(){e.__destroy()})},__destroy:function(){this.destroy()},__showRecord:function(e){var t=e.Id;a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.sfmsearch.platformspecifics").showRecord({key:t}).then(a.proxy(this,function(){this.__destroy()}))}}),a.defineGlobal(s.name,s),e.exports=s},function(e,t,n){var i=n(10),a=n(0).utils,r=n(24).navigation,o=n(22).View,s=n(11).Facade,l=n(7).Cache,c=n(7).ImageCompression,u=n(12).DatetimeUtil,d=n(7).ServerInfo,_=n(8),h={name:"com.servicemax.client.toolspages.ui.largemodern.homeview"},f=function(){return a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},p=r,m=o;h.KeyValueStore=Ext.define(h.name+".KeyValueStore",{extend:"com.servicemax.client.ui.components.modern.data.SVMXStore",alias:"widget.mobileinventorysearch.keyvaluestore",constructor:function(e){this.callParent(arguments)},fields:["opLabel","opValue"]}),Ext.define(h.name+".HomeView",{extend:m,alias:"widget.sfm.tools.home",config:{layout:"fit"},record:null,__syncManager:null,__syncImpl:null,__progressTotal:0,resetMsgBox:null,msgbox:null,__displayParams:{version:"1.0",user:"",environment:"Production",conflictCount:0},__dataSyncStatus:null,__dataLastSync:null,__configSyncStatus:null,__configLastSync:null,__purgeSyncStatus:null,__purgeLastSync:null,__srSyncStatus:null,__dataSyncButton:null,__configSyncButton:null,__purgeSyncButton:null,__srSyncButton:null,__signOutButton:null,__resetAppButton:null,__apiKeyButton:null,__console:null,__navContainer:null,__deliveryEngine:null,__disableButtons:!1,__areButtonsDisabled:!1,__locationTrackingCheckBox:!1,__locationTrackingText:null,__isAppLocationTrackingEnabled:null,__isSystemLocationTrackingEnabled:null,__refreshTimeoutHandle:null,updateSyncStatus:function(){this.__console=this,this.__syncManager&&this.__syncManager.getIsRunning()&&(this.disableButtons(),Ext.ComponentQuery.query("#dataSyncTitle")[0].setTitle(f().T("FSA010_TAG011","Data Sync - In Progress"))),this.__dataSyncStatus&&this.__dataSyncStatus.el&&this.__dataSyncStatus.el.dom&&this.__dataSyncStatus.setHtml(f().T("FSA016_TAG007","Loading...")),this.__purgeSyncStatus&&this.__purgeSyncStatus.el&&this.__purgeSyncStatus.el.dom&&this.__purgeSyncStatus.setHtml(f().T("FSA016_TAG007","Loading...")),this.__configSyncStatus&&this.__configSyncStatus.el&&this.__configSyncStatus.el.dom&&this.__configSyncStatus.setHtml(f().T("FSA016_TAG007","Loading...")),this.__srSyncStatus&&this.__srSyncStatus.el&&this.__srSyncStatus.el.dom&&this.__srSyncStatus.setHtml(f().T("FSA016_TAG007","Loading...")),this.__processSyncStatus("ONECALLSYNC",!0,this.__syncManager.getIsRunning()),this.__processSyncStatus("CONFIG",!1,this.__syncManager.getIsRunning()),this.__processSyncStatus("PURGE",!1,this.__syncManager.getIsRunning()),this.__processsrStatus(),this.getProgramInformation(),this.runConnectivityMonitor()},__connectionHandler:function(e){this.__enableSyncButtonByConnectivity(e.data.isConnected)},__enableSyncButtonByConnectivity:function(e){var t=this;e&&t.__syncManager&&!t.__syncManager.getIsRunning()?t.__disableButtons||t.enableButtons():t.__areButtonsDisabled||t.disableButtons()},runConnectivityMonitor:function(){var e=this;!function(){if(!e.isDestroyed){e.__checkConnectivity().done(function(t){e.__enableSyncButtonByConnectivity(t)})}}(),e.bind(e.__syncManager,"CONNECTIVITY_CHANGED",e.__connectionHandler,e)},updateOptions:function(){this.__syncImpl=a.getCurrentApplication().getSyncImpl();var e=a.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance(),this.bind(this.__syncManager,"SYNC_STARTED",this.__onSyncStarted,this),this.bind(this.__syncManager,"SYNC_STOPPED",this.__onSyncStop,this),this.bind(this.__syncManager,"SYNC_CONNECTION_ERROR_DIALOG_CANCEL",this.__onSyncCanceled,this),this.bind(this.__syncImpl,"SYNC_FAILED_IMPL",this.__onSyncFailed,this),this.bind(this.__syncImpl,"SYNC_COMPLETED_IMPL",this.__onSyncCompleted,this),this.bind(this.__syncImpl,"SYNC_PROGRESS_IMPL",this.__onProgress,this),this.bind(this.__syncImpl,"SYNC_EVENT_REQUEST_STARTED_IMPL",this.__onSyncEventRequestStarted,this),this.bind(this.__syncImpl,"SYNC_EVENT_REQUEST_COMPLETED_IMPL",this.__onSyncEventRequestCompleted,this),this.bind(this.__syncManager,"SYNC_ATTACHMENTS_STOPPED",this.__processsrStatus,this),this.bind(this.__syncManager,"REFRESH_CONFLICT_BADGE",this.__refreshBadges,this),this.__syncManager.bind("SYNC_STOPPED",this.__onSyncStop,this);var t=a.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.bind(t,"ATTACHMENTS_INSERTED",this.__processsrStatus,this)},ready:function(){var e=this;this.__dataProgressBar=this.parent.progressBar,this.setViewInfo({windowTitle:f().T("FSA012_TAG012","Tools"),subTitle:"",backText:f().T("FSA012_TAG012","Tools"),hideContextMenu:!0});this.__syncManager.getIsRunning();this.__displayParams.conflictCount;var t=[],n=this;t.push(this.__checkAllowApiAccess()),t.push(c.loadImageCompressionSettingValue()),a.getClient().isLaptop()&&(t.push(this.__checkSystemLocationTrackingEnabled()),t.push(this.__checkAppLocationTrackingEnabled())),a.when(t).then(function(t){null!=t&&(n.__navContainer=n.__setupPanels(t),n.add(n.__navContainer),setTimeout(function(){var e=i(".tools-compression-picklist .x-input-body-el");(e=e.length>0?e[0]:null)&&(e.style.width="100px")},1e3),a.getClient().isLaptop()&&n.__updateLocationTrackingPanel(),n.hasListener("show")||n.on("show",n.updateSyncStatus),n.updateSyncStatus(),n.__syncImpl.getSyncManager().getConflictCount(a.proxy(e,function(e){if(e&&e.count>=0){var t=parseInt(e.count);n.__setConflictBadge(t)}})))})},doDestroy:function(){this.__refreshTimeoutHandle&&(clearTimeout(this.__refreshTimeoutHandle),this.__refreshTimeoutHandle=null),this.callParent()},__setupPanels:function(e){var t=a.getClient().getApplicationParameter("client-type").toLowerCase();Ext.ComponentQuery.query("#toolsPanel")[0]&&Ext.ComponentQuery.query("#toolsPanel")[0].destroy(),this.__dataSyncStatus=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description ",text:"--"}),this.__dataLastSync=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description"}),this.__dataSyncButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern",text:f().T("FSA010_TAG015","Sync Data Now"),handler:a.proxy(this,"startSync","ONECALLSYNC")}),this.__dataSyncResolveButton=Ext.create({xtype:"svmx.button",ui:"button-tools",style:"padding: 0px 0px 0px 10px",cls:"tools-sync-button-largemodern",text:f().T("FSA010_TAG012","Resolve"),hidden:!0,handler:a.proxy(this,"__resolveConflict")});var n={xtype:"svmx.horizontalpanel",ui:"svmx-default",id:"toolsHorizontalPanel",items:[this.__dataSyncStatus,this.__dataSyncResolveButton]},i={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",itemId:"dataSyncTitle",title:f().T("FSA010_TAG013","Data Sync"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG014",'Data Sync keeps work orders, appointments, and lists up-to-date. Data Sync runs according to a schedule set by your administrator. Use "Sync Data Now" after resolving conflicts or to sync new and updated items.')},{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA012_TAG013","Last Sync")},this.__dataLastSync,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA012_TAG014","Status")},n],[this.__dataSyncButton]]};this.__configSyncStatus=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:"--"}),this.__configLastSync=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description"}),this.__configSyncButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern",text:f().T("FSA010_TAG018","Sync Config Now"),handler:a.proxy(this,"startSync","CONFIG")});var r={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA010_TAG016","Config Sync"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG017","Config sync keeps forms, business rules, and actions up to date. You only need to use this option when instructed to do so by your administrator. You will be unable to use the application during this process.")},{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA012_TAG013","Last Sync")},this.__configLastSync,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA012_TAG014","Status")},this.__configSyncStatus],[this.__configSyncButton]]};this.__purgeSyncStatus=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:"--"}),this.__purgeLastSync=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description"}),this.__purgeSyncButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern",text:f().T("FSA010_TAG019","Purge Data Now"),handler:a.proxy(this,"startSync","PURGE")});var o={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA012_TAG015","Purge Data"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA012_TAG016","Purging data removes old appointments and work orders from your device. They are not deleted from the server. You will be unable to use the application while purging.<br></br>An Internet connection is required to purge data.")},{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA012_TAG017","Last Purge")},this.__purgeLastSync,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA012_TAG014","Status")},this.__purgeSyncStatus],[this.__purgeSyncButton]]};this.__locationTrackingCheckBox=Ext.create({xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-location-tracking",labelAlign:"right",label:f().T("FSA010_TAG022","<b>Allow this application to track your location.</b>"),labelWidth:"100%",checked:!1,listeners:{change:a.proxy(this,"locationTrackingSetting")}}),this.__locationTrackingText=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG021","Allow this application to track your location. Your location may be reported to your administrator for variety of purposes, including job scheduling and work tracking. <br/> <br/> Location tracking is currently disabled by your operating system. To enable this feature, see your device privacy settings, then return to this screen and check the box below.")});var s={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA010_TAG020","Location Tracking"),items:[[this.__locationTrackingText,this.__locationTrackingCheckBox]]};this.__srSyncStatus=Ext.create({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:"--"}),this.__srSyncButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern",text:f().T("FSA010_TAG026","Process Now"),handler:a.proxy(this,"startSync","REPORTS")});var c={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA010_TAG023","Smart Docs Queue"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG024","Smart Docs are sent to the server for processing then returned to work orders as .PDF attachments. Re-send unprocessed reports by tapping the button to the right.")},{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG025","Queue Status")},this.__srSyncStatus],[this.__srSyncButton]]};this.__signOutButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern",text:f().T("FSA012_TAG031","Sign Out"),handler:a.proxy(this,"signOut")});var u={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA012_TAG031","Sign Out"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG136","Sign out ends your session with ServiceMax Mobile. You will need to sign in again to regain access.")}],[this.__signOutButton]]};this.__resetAppButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern",text:f().T("FSA010_TAG029","App Reset"),handler:a.proxy(this,"startSync","INITIAL")});var d={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA010_TAG029","App Reset"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG030","Resetting the app will remove all local data and settings and re-sync to the server.")},{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:f().T("FSA010_TAG031","An Internet connection is required to reset the app.")}],[this.__resetAppButton]]};Ext.StoreManager.lookup("imageCompressionOptionStore")||Ext.create(h.name+".KeyValueStore",{storeId:"imageCompressionOptionStore",data:[{opValue:"none",opLabel:"None"},{opValue:"low",opLabel:"Low"},{opValue:"medium",opLabel:"Medium"},{opValue:"high",opLabel:"High"}]});var _={xtype:"svmx.field.picklist",itemId:"imageCompressionOptionPicklist",ui:"svmx-default",cls:"x-field-select tools-compression-picklist",value:this.__getImageCompressionSettingValue(),store:"imageCompressionOptionStore",queryMode:"local",displayField:"opLabel",valueField:"opValue",listeners:{change:function(e,t,n){l.writeToDBCache("IMG_COMPRESSION_MODE",t.data.opValue),l.writeToJSCache("IMG_COMPRESSION_MODE","IMG_COMPRESSION_MODE",t.data.opValue)}}},m={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:"Image Compression",items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-card-description",text:"Image compression defines the quality of image that is attached to Checklists. High compression images yield lowest size and quality"}],[_]]};this.__versionLabel=Ext.create({xtype:"svmx.label",ui:"svmx-default",id:"versionLabel",cls:"label-tools-card-description",text:"version"}),this.__userLabel=Ext.create({xtype:"svmx.label",ui:"svmx-default",id:"userLabel",cls:"label-tools-card-description",text:"user"}),this.__serverLabel=Ext.create({xtype:"svmx.label",ui:"svmx-default",id:"serverLabel",cls:"label-tools-card-description",text:"server"}),this.__serverVersionLabel=Ext.create({xtype:"svmx.label",ui:"svmx-default",id:"serverVersionLabel",cls:"label-tools-card-description",text:"server_version"}),this.__emailLabel=Ext.create({xtype:"svmx.label",ui:"svmx-default",id:"emailLabel",cls:"label-tools-card-description",text:"email"});var v={xtype:"tools.navcontainertoolspanel",ui:"svmx-default",title:f().T("FSA010_TAG032","About"),items:[[{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG033","Version")},this.__versionLabel,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG034","Server")},this.__serverLabel,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG148","Server Version")},this.__serverVersionLabel,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG035","User ID")},this.__userLabel,{xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG036","Username")},this.__emailLabel]]},g=[];return"true"==e&&"laptop"==t&&(this.__apiKeyButton=Ext.create({xtype:"svmx.button",ui:"button-tools",cls:"tools-sync-button-largemodern button-tools-view-api-key",text:f().T("FSA010_TAG038","View API Key"),handler:a.proxy(this,"__viewApiKey")}),v.items[0].push({xtype:"svmx.label",ui:"svmx-default",cls:"label-tools-subheader",text:f().T("FSA010_TAG037","API Key")}),v.items[0].push(this.__apiKeyButton)),g="laptop"==t?[i,r,o,s,c,m,u,d,v]:[i,r,o,c,m,u,d,v],a.create(p.name+".SVMXNavContainer",{xtype:"svmx.navcontainer",ui:"svmx-default",itemId:"toolsPanel",items:g})},__getImageCompressionSettingValue:function(){return l.readFromJSCache("IMG_COMPRESSION_MODE","IMG_COMPRESSION_MODE")||a.getClient().getApplicationParameter("image-compression").defaultMode},__checkAllowApiAccess:function(){var e=a.Deferred(),t=this.getDeliveryEngine().getEventBus(),n=a.create("com.servicemax.client.lib.api.Event","TOOLSPAGES.ALLOW_API_ACCESS",this,{request:{},responder:function(t){e.resolve(t)}});return t.triggerEvent(n),e},__checkSystemLocationTrackingEnabled:function(){var e=a.Deferred(),t=this;this.__nativeService=s;var n=this.__nativeService.createLocationTrackingRequest();return n.bind("REQUEST_COMPLETED",function(n){n.data.success?(t.__isSystemLocationTrackingEnabled=!0,e.resolve(!0)):(t.__isSystemLocationTrackingEnabled=!1,l.writeToDBCache("LOCATION_TRACKING_ENABLED","DONTALLOW",function(){e.resolve(!1)},t))},this),n.bind("REQUEST_ERROR",function(n){t.__isSystemLocationTrackingEnabled=!1,l.writeToDBCache("LOCATION_TRACKING_ENABLED","DONTALLOW",function(){e.resolve(!1)},t)},this),n.execute(),e},__checkAppLocationTrackingEnabled:function(){var e=this,t=a.Deferred();return l.readObjectFromDBCache("LOCATION_TRACKING_ENABLED").then(function(n){e.__isAppLocationTrackingEnabled=!1,n&&"ALLOW"===n&&(e.__isAppLocationTrackingEnabled=!0),t.resolve(e.__isAppLocationTrackingEnabled)}),t},startSync:function(e){this.__disableButtons=!0;var t=this,n=void 0;switch(t.disableButtons(),e){case"REPORTS":e="ONECALLSYNC",n=l.readObjectFromDBCache("SHOW_REPORTS_SYNC_CONFIRM"),n.then(function(n){if(n&&"true"!=n)t.__syncImpl.performSync(e),t.__dataSyncResolveButton.hide();else{var i=!1;a.Msg.alert({title:null,text:"",itemId:"toolsSyncWindow",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG039","This will initiate a data sync.<br><br>You can continue to use the ServiceMax app during this process.")},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelCls:"label-tools-msgbox-checkboxfield",label:f().T("FSA010_TAG040","Don't show this again"),labelAlign:"right",checked:i,listeners:{check:a.proxy(this,function(e,t){i=e._checked})}}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"Cancel",ui:"button-tools-msgbox"},{text:f().T("FSA010_TAG042","Start Sync"),itemId:"Start Sync",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){t.__disableButtons=!1,"START"==n||"Start Sync"==n?(t.__syncImpl.performSync(e),t.__dataSyncResolveButton.hide(),l.writeToDBCache("SHOW_REPORTS_SYNC_CONFIRM",!i)):t.enableButtons()})}});break;case"ONECALLSYNC":a.getCurrentApplication().enableProgressBar(),n=l.readObjectFromDBCache("SHOW_DATA_SYNC_CONFIRM"),n.then(function(n){if(n&&"true"!=n)t.__syncImpl.performSync(e),t.__dataSyncResolveButton.hide();else{var i=!1;a.Msg.alert({title:null,text:"",itemId:"toolsSyncWindow",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG041","Data Sync will retrieve the latest appointments, work orders and other information.<br><br>You can continue to use the ServiceMax app during data sync.")},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelCls:"label-tools-msgbox-checkboxfield",labelAlign:"right",label:f().T("FSA010_TAG040","Don't show this again"),checked:i,listeners:{check:a.proxy(this,function(e,t){i=e._checked})}}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"Cancel",ui:"button-tools-msgbox"},{text:f().T("FSA010_TAG042","Start Sync"),itemId:"Start Sync",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){t.__disableButtons=!1,"START"==n||"Start Sync"==n?(t.__syncImpl.performSync(e),t.__dataSyncResolveButton.hide(),t.__dataProgressBar.show(),l.writeToDBCache("SHOW_DATA_SYNC_CONFIRM",!i)):t.enableButtons()})}});break;case"CONFIG":n=l.readObjectFromDBCache("SHOW_CONFIG_SYNC_CONFIRM"),n.then(function(n){if(n&&"true"!=n)t.__performConfigSync(e);else{var i=!1;a.Msg.alert({title:null,itemId:"toolsSyncWindow",text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG043","Sync Configuration? You will not be able to use the app during this process.")},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelCls:"label-tools-msgbox-checkboxfield",labelAlign:"right",label:f().T("FSA008_TAG025","Don't show this again"),checked:i,listeners:{check:a.proxy(this,function(e,t){i=e._checked})}}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"button-tools-msgbox"},{text:f().T("FSA016_TAG003","OK"),itemId:"OK",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){t.__disableButtons=!1,"OK"==n?(l.writeToDBCache("SHOW_CONFIG_SYNC_CONFIRM",!i),t.__performConfigSync(e)):t.enableButtons()})}});break;case"PURGE":var i,r,o=[];t.__checkConnectivity().done(function(n){if(n)o.push(l.readFromDBCache("LAST_SYNC_TIME.INITIAL")),o.push(l.readFromDBCache("LAST_SYNC_TIME.CONFIG_SUCCESS")),o.push(t.__syncImpl.getSyncManager().getLastConfigModified()),a.when(o).then(a.proxy(this,function(n,o,s){if(i=o?_(o,"YYYY-MM-DD HH:mm:ss").toDate():null,r=_(s.data.valueMap[0].value,"YYYY-MM-DD HH:mm:ss").toDate(),null==i&&(i=_(n,"YYYY-MM-DD HH:mm:ss").toDate()),r.getTime()>i.getTime()){t.__syncImpl.stopSync();a.getCurrentApplication().checkForMessageId("configOutOfDateWindow")||a.Msg.alert({title:null,itemId:"configOutOfDateWindow",text:"",items:[{xtype:"svmx.label",text:f().T("FSA010_TAG044","Configuration must be updated before you can purge data")}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"button-tools-msgbox"},{text:f().T("FSA010_TAG045","Update"),itemId:"Update",ui:"button-tools-msgbox button-highlight"}]}).then(function(e){t.__disableButtons=!1,"Update"==e?t.__performConfigSync("CONFIG"):(l.writeToDBCache("IS_CONFIG_SYNC_DUE","true"),t.__syncImpl.getSyncManager().getConflictCount(a.proxy(this,function(e){if(e&&e.count>=0){var n=parseInt(e.count);t.__setConflictBadge(n)}})),t.enableButtons())})}else{l.readObjectFromDBCache("SHOW_PURGE_DATA_CONFIRM").then(function(n){if(n&&"true"!=n)t.__performPurgeData(e);else{var i=!1;a.getCurrentApplication().checkForMessageId("toolsSyncWindowPurge")||a.Msg.alert({title:null,itemId:"toolsSyncWindowPurge",text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG046","Purge Data? You will not be able to use the app during this process.")},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelCls:"label-tools-msgbox-checkboxfield",labelAlign:"right",label:f().T("FSA010_TAG040","Don't show this again"),checked:i,listeners:{check:a.proxy(this,function(e,t){i=e._checked})}}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"button-tools-msgbox"},{text:f().T("FSA010_TAG047","Start Purge"),itemId:"OK",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){t.__disableButtons=!1,"OK"==n?(l.writeToDBCache("SHOW_PURGE_DATA_CONFIRM",!i),t.__performPurgeData(e)):t.enableButtons()})}})}}));else{l.writeToDBCache("SYNC_STATUS."+e,"No Connectivity");var s=u.getTimestampWithSaveFormat();l.writeToDBCache("LAST_SYNC_TIME."+e,s),t.__syncImpl.showConnectionError(e),this.__refreshTimeoutHandle&&(clearTimeout(this.__refreshTimeoutHandle),this.__refreshTimeoutHandle=null),this.__refreshTimeoutHandle=setTimeout(function(){t.updateSyncStatus()},1e3)}});break;case"INITIAL":a.Msg.alert({title:null,itemId:"toolsSyncWindow",cls:"msgbox-tools",text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG048","Resetting the app will sign you out and delete all ServiceMax data on this device. This process cannot be undone.<br><br>Are you sure you want to do this?")}],buttons:[{text:f().T("FSA016_TAG002","No"),itemId:"CANCEL",ui:"button-tools-msgbox"},{text:f().T("FSA016_TAG001","Yes"),itemId:"Yes",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){t.__disableButtons=!1,"START"==n||"Yes"==n?t.__checkResetAppConnectivity(e):t.enableButtons()})}},__performConfigSync:function(e){var t=a.getClient().getApplicationParameter("client-type").toLowerCase(),n=void 0;"mobile"==t?(n="FSA010_TAG144",msgBoxText="Please do not switch to another application or press the home button while sync is in progress.<br></br>Doing so will cancel or interrupt the synchronization."):(n="FSA010_TAG049",msgBoxText="You will be notified when the sync is complete."),this.msgbox=a.create("com.servicemax.client.ui.components.modern.popups.SVMXMessageBox",{id:"tools-sync-msgbox",title:f().T("FSA010_TAG120","Config Sync in Progress"),ui:"svmx-default",buttons:[{xtype:"svmx.button",id:"configCancel",ui:"button-tools-msgbox",text:f().T("FSA016_TAG004","Cancel"),handler:a.proxy(this,"onCancel"),disabled:!0}],items:[{xtype:"svmx.progressbar",id:"toolssyncprogressbar",message:"",showSubProgress:!1,containerCls:"container-sfm-tools-small-progressbar",barCls:"sfm-tools-small-progressbar-bar",width:"100%"},{xtype:"svmx.panel",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T(n,msgBoxText)}]}]}),this.msgbox.show(),this.__syncImpl.performSync(e)},__performPurgeData:function(e){var t=a.getClient().getApplicationParameter("client-type").toLowerCase(),n=void 0,i=void 0;"mobile"==t?(n="FSA010_TAG119",i="Please do not switch to another application or press the home button during this process.<br></br>Doing so will cancel or interrupt the purge."):(n="FSA010_TAG049",i="You will be notified when the sync is complete."),this.msgbox=a.create("com.servicemax.client.ui.components.modern.popups.SVMXMessageBox",{id:"tools-sync-msgbox",title:f().T("FSA010_TAG118","Purge Data in Progress"),buttons:[{xtype:"svmx.button",id:"purgeCancel",ui:"button-tools-msgbox",text:f().T("FSA016_TAG004","Cancel"),handler:a.proxy(this,"onCancel"),disabled:!0}],items:[{xtype:"svmx.progressbar",id:"toolssyncprogressbar",message:"",showSubProgress:!1,containerCls:"container-sfm-tools-small-progressbar",barCls:"sfm-tools-small-progressbar-bar",width:"100%"},{xtype:"svmx.panel",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T(n,i)}]}]}),this.__syncImpl.performSync(e),this.msgbox.show()},__checkResetAppConnectivity:function(e){var t=this,n=t.__checkConnectivity();n.done(function(n){n?(t.__syncImpl.performSync(e),t.goToResetSyncPage()):a.Msg.alert({title:f().T("FSA012_TAG024","Connection Error"),text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG050","There is an issue with your connection to the server. Please try again later. If the problem persists, contact your system administrator.")}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"Cancel",ui:"button-tools-msgbox"},{text:f().T("FSA012_TAG025","Retry"),itemId:"OK",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){"OK"===n?t.__checkResetAppConnectivity(e):(t.__syncImpl.connectionErrorCancel(),t.enableButtons())})}),n.fail(function(){})},onCancel:function(){var e=a.getCurrentApplication().getSyncImpl(),t=e.getSyncManager().getSyncType();this.enableButtons(),this.msgbox&&(this.msgbox.destroy(),this.msgbox=null),l.writeToDBCache("SYNC_STATUS."+t,"Canceled");var n=u.getTimestampWithSaveFormat();l.writeToDBCache("LAST_SYNC_TIME."+t,n),e.getSyncManager().setLastFailedRequestId(!1,!0),e.getSyncManager().setLastFailedRequestId(!1,!0),e.stopSync()},__onSyncStarted:function(e){this.disableButtons();var t=void 0,n=["ONECALLSYNC","AGGRESSIVE","TARGETEDSYNC"];e.data&&e.data.__syncType&&("CONFIG"==e.data.__syncType?(this.__running=!0,this.__startTime=new Date,this.__progressTotal=this.__getSyncProgressStepTotal(),this.__progressStep=0,(t=Ext.getCmp("configCancel"))&&t.enable()):"PURGE"==e.data.__syncType?(this.__running=!0,this.__startTime=new Date,this.__progressTotal=this.__getSyncProgressStepTotal(),this.__progressStep=0,(t=Ext.getCmp("purgeCancel"))&&t.enable()):n.indexOf(e.data.__syncType)>-1&&Ext.ComponentQuery.query("#dataSyncTitle")[0]&&Ext.ComponentQuery.query("#dataSyncTitle")[0].setTitle(f().T("FSA010_TAG011","Data Sync - In Progress")))},__getConflicts:function(){var e=new i.Deferred,t=this;return this.__console.blockApplication(),this.__console.__syncManager.getDetailedSyncConflicts(function(n){n=n||{},Ext.widget("svmx.store",{model:"com.servicemax.client.toolspages.ui.largemodern.api.model.Conflicts",data:[]}).setData(n),t.__console.unblockApplication(),e.resolve(n)}),e.promise()},__resolveConflict:function(){var e=this;if(this.__displayParams.conflictCount>1)this.changeView({view:"syncconflict",windowTitle:a.string.substitute(f().T("FSA010_TAG137","Sync Conflicts ({{conflictCount}})"),this.__displayParams),disableNavMenu:!1,ui:"svmx-default"});else{var t=(this.__console,void 0);this.__getConflicts().then(function(n){if(n.length>0){record=n[0],t="conflict"==record.error_type?e.convertErrorMessageTimezone(record.error_message):record.error_message;Ext.create({xtype:"tools.conflictresolvemsgbox",ui:"svmx-default",record:record,objectType:record.label,name:record.nameValue,syncDetails:t,showViewInfo:!0}).show()}})}},convertErrorMessageTimezone:function(e){var t=void 0,n=void 0,i=void 0,r=void 0,o=void 0;return r=e?e.split(";"):[],o=a.getCurrentApplication().getUserInfo().SalesForceTimezoneOffset,t=r.length>0?r[0].substring(r[0].indexOf(":")+1)+o:"",n=r.length>1?r[1].substring(r[1].indexOf(":")+1)+o:"",i=r.length>2?r[2].substring(r[2].indexOf(":")+1)+o:"",r[0]=r.length>0?r[0].replace(r[0].substring(r[0].indexOf(":")+1),this.formatErrorTime(t)):"",r[1]=r.length>1?r[1].replace(r[1].substring(r[1].indexOf(":")+1),this.formatErrorTime(n)):"",r[2]=r.length>2?r[2].replace(r[2].substring(r[2].indexOf(":")+1),this.formatErrorTime(i)):"",e=r.join("")},formatErrorTime:function(e){return _(e).format("YYYY-MM-DD HH:mm:ss")},goToResetSyncPage:function(){this.changeView({view:"resetapp",windowTitle:f().T("FSA010_TAG053","Welcome to ServiceMax Field Service"),disableNavMenu:!0,ui:"svmx-default",backText:null,hideBackButton:!0})},__onSyncCanceled:function(e){this.enableButtons(),this.msgbox&&(this.msgbox.destroy(),this.msgbox=null);var t=this;this.__refreshTimeoutHandle&&(clearTimeout(this.__refreshTimeoutHandle),this.__refreshTimeoutHandle=null),this.__refreshTimeoutHandle=setTimeout(function(){t.updateSyncStatus()},1e3)},__getSyncProgressStepTotal:function(){for(var e=this.__syncManager.getEventConfig(),t=0,n=0;n<e.length;n++)t+=e[n].length;return t},__onSyncStop:function(e){var t=a.getClient().getApplicationParameter("client-type").toLowerCase();this.enableButtons(),this.msgbox&&(this.msgbox.destroy(),this.msgbox=null);var n=this;if(n.evt=e,"SYNC_STOPPED"==e.type||e.data&&(e.data.__syncType||e.data.syncType)){if(e.data&&("PURGE"==e.data.syncType||"CONFIG"==e.data.syncType)&&"laptop"==t&&!a.getCurrentApplication().checkForMessageId("comSyncWindow")){var i=void 0;"PURGE"==e.data.syncType?i=f().T("FSA010_TAG054","Purge data complete"):"CONFIG"==e.data.syncType&&(i=f().T("FSA010_TAG055","Config sync complete")),a.Msg.alert({text:"",itemId:"comSyncWindow",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:i}],buttons:[{text:f().T("FSA016_TAG003","OK"),itemId:"OK",ui:"button-tools-msgbox"}]})}"PURGE"==e.data.syncType&&l.writeToDBCache("IS_DATA_PURGE_DUE","false"),this.__refreshTimeoutHandle&&(clearTimeout(this.__refreshTimeoutHandle),this.__refreshTimeoutHandle=null),this.__refreshTimeoutHandle=setTimeout(function(){"CONFIG"==e.data.syncType?(n.ready(),l.writeToDBCache("IS_CONFIG_SYNC_DUE","false")):n.updateSyncStatus()},1e3)}},__onSyncCompleted:function(e){new Date,this.__startTime;this.__running=!1,this.__success=!0},__onProgress:function(e){this.__progressTotal=e.data.totalCount||this.__progressTotal,this.__progressStep=e.data.currentStep||this.__progressStep,this.updateProgressBar(),this.checkPurgeEventName(e.data.eventName)},checkPurgeEventName:function(e){var t=Ext.getCmp("purgeCancel"),n=["SyncGetEventsPurge","SyncGetDownloadCriteriaPurge","SyncGetAdvDownloadCriteriaPurge","SyncGetPriceDataPurge","SyncMobileInventoryDataPurge","SyncPiqDataPurge","SyncCleanUpSelect","DataPurge"];t&&n.indexOf(e)>-1&&t.disable()},updateProgressBar:function(){var e=Ext.getCmp("toolssyncprogressbar"),t=Math.round(this.__progressStep/this.__progressTotal*100);e&&e.updateProgress(t)},__onSyncEventRequestStarted:function(e){var t=e.data;t.time=(new Date).getTime(),t.status=f().T("FSA010_TAG101","Running...");a.toObject(a.toJSON(t))},__onSyncEventRequestCompleted:function(e){var t=e.data,n=new Date-t.startDate;t.logStoreRecord&&(t.error?t.logStoreRecord.set("status",f().T("FSA010_TAG093","Error")+" ("+n+" ms)"):t.logStoreRecord.set("status",f().T("FSA010_TAG102","Completed")+" ("+n+" ms)"),t.request&&t.logStoreRecord.set("request",t.request),t.result&&t.logStoreRecord.set("result",t.result),t.logStoreRecord.commit())},__onSyncFailed:function(e){this.__running=!1,this.__success=!1},getProgramInformation:function(){var e=this.__versionLabel,t=this.__userLabel,n=this.__serverLabel,i=this.__serverVersionLabel,r=this.__emailLabel,o=this;if(e&&t&&n&&r){this.blockApplication();var s=[this.__getAppInfo(),this.__getConflictCount(),l.readFromDBCache("LOCATION_TRACKING_ENABLED")];a.when(s).always(a.proxy(this,function(s,l,c){s=s||{},l=l||{},o.__displayParams=s,o.__displayParams.environment=f().T(s.org_tag,s.org_type),o.__displayParams.conflictCount=l.count||0;var u=d.getServerVersion(),_=a.string.substitute("{{version}}",o.__displayParams),h=_.split(".");if(h.length>3){var p=" Build "+h.pop(3);_=h.join(".")+p}e&&e.el&&e.el.dom&&e.setHtml(_),n&&n.el&&n.el.dom&&n.setHtml(a.string.substitute("{{environment}}",o.__displayParams)),i&&i.el&&i.el.dom&&i.setHtml(u),t&&t.el&&t.el.dom&&t.setHtml(a.string.substitute("{{user_name}}",o.__displayParams)),r&&r.el&&r.el.dom&&r.setHtml(a.string.substitute("{{user_login}}",o.__displayParams)),o.unblockApplication()}))}},goToSyncConflictPage:function(){this.changeView({view:"syncconflict"})},locationTrackingSetting:function(e,t,n,i){var a=!0===t?"ALLOW":"DONTALLOW";console.log(" Location Tracking value: "+a),l.writeToDBCache("LOCATION_TRACKING_ENABLED",a)},__updateLocationTrackingPanel:function(){console.log("Location tracking is: "+this.__isSystemLocationTrackingEnabled);var e="";!0===this.__isSystemLocationTrackingEnabled?(e=f().T("FSA010_TAG138","Allow this application to track your location. Your location may be reported to your administrator for variety of purposes, including job scheduling and work tracking."),!0===this.__isAppLocationTrackingEnabled&&this.__locationTrackingCheckBox.setChecked(!0),this.__locationTrackingCheckBox.setDisabled(!1)):(e=f().T("FSA010_TAG021","Allow this application to track your location. Your location may be reported to your administrator for variety of purposes, including job scheduling and work tracking. <br/> <br/> Location tracking is currently disabled by your operating system. To enable this feature, see your device privacy settings, then return to this screen and check the box below."),this.__locationTrackingCheckBox&&this.__locationTrackingCheckBox.setDisabled(!0)),this.__locationTrackingText&&this.__locationTrackingText.el&&this.__locationTrackingText.el.dom&&this.__locationTrackingText.setHtml(e)},signOut:function(){if(this.__syncManager.getIsRunning()){var e=this;a.Msg.alert({title:f().T("FSA012_TAG029","Warning"),text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA012_TAG030","Synchronization is in progress. If you sign out now, unsaved data may be lost and records may not be fully updated. Do you want to continue?")}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"button-tools-msgbox"},{text:f().T("FSA012_TAG031","Sign Out"),itemId:"SIGNOUT",ui:"button-tools-msgbox"}]}).then(function(t){"SIGNOUT"===t&&e.__signOutDialog()})}else this.__signOutDialog()},__signOutDialog:function(){var e=!1,t=this;l.readObjectFromDBCache("SHOW_SIGN_OUT_CONFIRM").then(function(n){n&&"true"!=n?t.__signOutFinally():a.Msg.alert({text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:f().T("FSA010_TAG057","You will need an internet connection to sign back in.")},{xtype:"svmx.field.checkbox",cls:"checkboxfield-tools-data-sync",labelCls:"label-tools-msgbox-checkboxfield",label:f().T("FSA010_TAG040","Don't show this again"),labelAlign:"right",checked:e,listeners:{check:a.proxy(this,function(t,n){e=t._checked})}}],buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"Cancel",ui:"button-tools-msgbox"},{text:f().T("FSA012_TAG031","Sign Out"),itemId:"SignOut",ui:"button-tools-msgbox button-highlight"}]}).then(function(n){"SignOut"==n&&(l.writeToDBCache("SHOW_SIGN_OUT_CONFIRM",!e),t.__signOutFinally())})})},__signOutConnCheck:function(){var e=this,t=this.__checkConnectivity();t.done(function(t){t?e.__signOutFinally():a.Msg.alert({title:f().T("FSA012_TAG029","Warning"),text:f().T("FSA012_TAG032","No Internet connection. You will not be able to sign back in."),buttons:[{text:f().T("FSA016_TAG004","Cancel"),itemId:"CANCEL",ui:"button-tools-msgbox"},{text:f().T("FSA012_TAG031","Sign Out"),itemId:"SIGNOUT",ui:"button-tools-msgbox"}]}).then(function(t){"SIGNOUT"===t&&e.__signOutFinally()})}),t.fail(function(){})},__signOutFinally:function(){var e=a.getCurrentApplication(),t=a.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.SIGNOUT",e,{request:null,responder:null});e.triggerEvent(t)},__checkConnectivity:function(){var e=a.Deferred(),t=s,n=t.createConnectivityRequest();return n.bind("REQUEST_COMPLETED",function(t){var n=t.data.data.toLowerCase(),i="true"===n;e.resolve(i)},this),n.bind("REQUEST_ERROR",function(t){e.reject(!1)},this),n.execute(),e},__getAppInfo:function(){var e=a.Deferred();return a.create("com.servicemax.client.sfmconsole.utils.EventCollection",a.getCurrentApplication(),[a.create("com.servicemax.client.lib.api.Event","SFMCONSOLE.GET_APP_INFO",this,{request:{}})]).triggerAll(function(t){var n=t.items()[0].response;e.resolve(n)}),e.promise()},__getConflictCount:function(){var e=a.Deferred();return this.__syncManager.getConflictCount(function(t){var n=0;t&&t.count&&(n=parseInt(t.count)),e.resolve({count:n})}),e.promise()},__processSyncStatus:function(e,t,n){var i=this,r=a.getCurrentApplication().getUserInfo();r.SalesForceTimezoneOffset;"CONFIG"!=e&&"PURGE"!=e&&(e="DATA"),a.create("com.servicemax.client.sfmconsole.utils.EventCollection",a.getCurrentApplication(),[a.create("com.servicemax.client.lib.api.Event","SYNC.GET_SYNC_STATUS",this,{request:{syncType:e}})]).triggerAll(function(a){for(var r=a.items(),o=0;o<r.length;o++){var s=r[o];console.warn(s.type(),s.response.statusToUpdate);var l=u,c=s.response.statusTime;c=l.humanizeRelativeDate(c,1),"DATA"==e?(i.__dataLastSync&&i.__dataLastSync.el&&i.__dataLastSync.el.dom&&i.__dataLastSync.setHtml(c),n?(Ext.ComponentQuery.query("#dataSyncTitle")[0]&&Ext.ComponentQuery.query("#dataSyncTitle")[0].setTitle(f().T("FSA010_TAG011","Data Sync - In Progress")),i.__dataSyncStatus&&i.__dataSyncStatus.el&&i.__dataSyncStatus.el.dom&&i.__dataSyncStatus.setHtml(s.response.statusToUpdate)):(Ext.ComponentQuery.query("#dataSyncTitle")[0]&&Ext.ComponentQuery.query("#dataSyncTitle")[0].setTitle(f().T("FSA010_TAG013","Data Sync")),i.__dataSyncStatus&&i.__dataSyncStatus.el&&i.__dataSyncStatus.el.dom&&i.__dataSyncStatus.setHtml(s.response.statusToUpdate))):"CONFIG"==e?(i.__configLastSync&&i.__configLastSync.el&&i.__configLastSync.el.dom&&i.__configLastSync.setHtml(c),i.__configSyncStatus&&i.__configSyncStatus.el&&i.__configSyncStatus.el.dom&&i.__configSyncStatus.setHtml(s.response.statusToUpdate)):"PURGE"==e&&(i.__purgeLastSync&&i.__purgeLastSync.el&&i.__purgeLastSync.el.dom&&i.__purgeLastSync.setHtml(c),i.__purgeSyncStatus&&i.__purgeSyncStatus.el&&i.__purgeSyncStatus.el.dom&&i.__purgeSyncStatus.setHtml(s.response.statusToUpdate)),n||i.__processSyncConflicts(t,i.__dataSyncStatus,s.response.statusToUpdate)}},this)},__processSyncConflicts:function(e,t,n){var i=" ";t&&t.el&&t.el.dom&&(t.removeCls("label-tools-sync-status-conflicts"),t.removeCls("label-tools-card-description")),n&&(i=n),e&&this.__syncImpl?this.__syncImpl.getSyncManager().getConflictCount(a.proxy(this,function(e){if(e){var n=parseInt(e.count);if(n>0){var r={conflictCount:n};this.__dataSyncResolveButton.show(),i=1==n&&"No Connectivity"==i?a.string.substitute(f().T("FSA010_TAG139","No Connectivity - {{conflictCount}} Conflict"),r):1==n&&"No Connectivity"!=i?a.string.substitute(f().T("FSA010_TAG140","Incomplete - {{conflictCount}} Conflict"),r):n>1&&"No Connectivity"==i?a.string.substitute(f().T("FSA010_TAG139","No Connectivity - {{conflictCount}} Conflicts"),r):a.string.substitute(f().T("FSA010_TAG140","Incomplete - {{conflictCount}} Conflicts"),r),t&&t.el&&t.el.dom&&t.setCls("label-tools-sync-status-conflicts")}else t&&t.el&&t.el.dom&&t.setCls("label-tools-card-description"),this.__dataSyncResolveButton&&this.__dataSyncResolveButton.hide();t&&t.el&&t.el.dom&&t.setHtml(i),this.__setConflictBadge(n)}})):t&&t.el&&t.el.dom&&t.setHtml(i)},disableButtons:function(){this.__dataSyncButton&&this.__dataSyncButton.disable(),this.__configSyncButton&&this.__configSyncButton.disable(),this.__purgeSyncButton&&this.__purgeSyncButton.disable(),this.__signOutButton&&this.__signOutButton.disable(),this.__resetAppButton&&this.__resetAppButton.disable(),this.__srSyncButton&&this.__srSyncButton.disable(),this.__areButtonsDisabled=!0},enableButtons:function(){this.__dataSyncButton&&this.__dataSyncButton.enable(),this.__configSyncButton&&this.__configSyncButton.enable(),this.__purgeSyncButton&&this.__purgeSyncButton.enable(),this.__signOutButton&&this.__signOutButton.enable(),this.__resetAppButton&&this.__resetAppButton.enable(),this.__srSyncButton&&this.__srSyncButton.enable(),this.__areButtonsDisabled=!1},__setConflictBadge:function(e){var t=Ext.ComponentQuery.query("svmx\\.button[consoleAppId=toolspages-largemodern]")[0],n=e;if(this.__navContainer){var i=this.__navContainer.getHeaderPanel();if(i){var r=i.innerItems[0];0==e?r&&r.el&&r.el.dom&&r.setBadgeText(""):r&&r.el&&r.el.dom&&r.setBadgeText(e);var o=i.innerItems[1];l.readFromDBCache("IS_CONFIG_SYNC_DUE").then(a.proxy(this,function(e){e&&"true"===e?(o&&o.el&&o.el.dom&&o.setBadgeText(1),n++):o&&o.el&&o.el.dom&&o.setBadgeText(""),t&&t.el&&t.dom&&t.setBadgeText(n)}));var s=i.innerItems[2];l.readFromDBCache("IS_DATA_PURGE_DUE").then(a.proxy(this,function(e){e&&"true"===e?(s&&s.el&&s.el.dom&&s.setBadgeText(1),n++):s&&s.el&&s.el.dom&&s.setBadgeText(""),t&&t.el&&t.dom&&t.setBadgeText(n)}))}}},__refreshBadges:function(e){if(this.__navContainer){var t=this.__navContainer.getHeaderPanel();if(t&&e&&e.data){if(e.data.isConfigSyncInPending){t.innerItems[1].setBadgeText(1)}if(e.data.isPurgeInPending){t.innerItems[2].setBadgeText(1)}}}},__viewApiKey:function(){var e=this;e.__apiKeyButton.disable();var t=s,n=t.createGenerateApiKeyRequest();n.bind("REQUEST_COMPLETED",function(t){console.warn("SUCCESS",t);var n=t.data.data;e.__apiKeyBox=a.create("com.servicemax.client.ui.components.modern.popups.SVMXMessageBox",{cls:"msgbox-tools-api",title:f().T("FSA010_TAG037","API Key"),items:[{xtype:"svmx.panel",items:[{xtype:"svmx.label",cls:"label-tools-msgbox-api-key",text:n}]}],buttons:[{text:f().T("FSA010_TAG062","Close and Copy to Clipboard"),itemId:"closeApiKeyBox",ui:"button-tools-msgbox",handler:function(){e.__copyToClipboard(n),e.__apiKeyBox.destroy(),e.__apiKeyButton.enable()}}]}),e.__apiKeyBox.show()},this),n.bind("REQUEST_ERROR",function(t){e.__apiKeyButton.enable()},this),n.execute()},__copyToClipboard:function(e){var t=e,n=document.createElement("textarea");n.contentEditable=!0,this.__apiKeyBox.el.appendChild(n),n.innerHTML=t,n.unselectable="off",n.focus(),document.execCommand("selectAll"),document.execCommand("copy",!1,null),this.__apiKeyBox.el.removeChild(n)},__processsrStatus:function(){var e=this,t=this.getDeliveryEngine().getEventBus(),n=a.create("com.servicemax.client.lib.api.Event","TOOLSPAGES.GET_OUTPUT_DOCS_COUNT",this,{request:{},responder:function(t){var n=t+" "+f().T("FSA010_TAG063","Report(s) queued");t>0?e.__srSyncStatus&&e.__srSyncStatus.el&&e.__srSyncStatus.el.dom&&e.__srSyncStatus.setHtml("<font color='red'>"+n+"</font>"):e.__srSyncStatus&&e.__srSyncStatus.el&&e.__srSyncStatus.el.dom&&e.__srSyncStatus.setHtml(n)}});t.triggerEvent(n)}}),a.defineGlobal(h.name,h),e.exports=h},function(e,t,n){var i=n(10),a=n(0).utils,r=(n(19).impl,n(24).navigation,n(22).View),o={name:"com.servicemax.client.toolspages.ui.largemodern.conflictlistview"},s=n(8),l=function(){return a.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},c=r;Ext.define(o.name+".SyncConflictView",{extend:c,alias:"widget.tools.sync.conflict.list",config:{metaModel:null,selectedModel:null,store:null,scrollable:"vertical",halign:"center"},__syncImpl:null,__syncManager:null,__list:null,__viewReady:!1,__msgbox:null,__record:null,onShow:function(){this.__viewReady&&this.getConflicts()},initialize:function(){this.callParent(),this.__syncImpl=a.getCurrentApplication().getSyncImpl();var e=a.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance(),this.bind(this.__syncManager,"SYNC_STOPPED",this.__onSyncStop,this)},ready:function(){this.setViewInfo({backText:l().T("FSA010_TAG052","Sync Conflicts"),hideContextMenu:!0});var e=Ext.widget("svmx.store",{model:"com.servicemax.client.toolspages.ui.largemodern.api.model.Conflicts",data:[]});this.setStore(e);var t=[{itemId:"list",xtype:"svmx.list",grouped:!0,itemTpl:"<div class='listitem-sfm-search-result-name'>{label}</div><div class='sfm-search-result-description'>{displayValue} </div> <div class ='listitem-tools-sync-conflict-status'>{status_label}</div>",emptyText:l().T("FSA010_TAG112","No results found"),listeners:{itemtap:a.proxy(this,"__onConflictTap")}}],n={xtype:"svmx.panel",width:"100%",fullscreen:!0,items:t};this.add(n),this.__list=this.query("#list")[0],this.getConflicts(),this.__viewReady=!0},__resolveItem:function(e,t){var n=void 0;"SERVER_OVERRIDE"==e?n=l().T("FSA012_TAG069","Changes will be lost"):"CLIENT_OVERRIDE"==e?n=l().T("FSA012_TAG070","Changes will be kept"):""==e&&(n=l().T("FSA012_TAG071","Unresolved")),this.__list.getStore().getAt(this.__list.getStore().indexOf(t)).data.override_flag=e,this.__list.getStore().getAt(this.__list.getStore().indexOf(t)).data.status_label=n,this.__list.refresh()},__onConflictTap:function(e,t,n,i,r,o){var s=this,l=void 0;this.__record=i,l="conflict"==i.data.error_type?s.convertErrorMessageTimezone(i.data.error_message):i.data.error_message,Ext.create({xtype:"tools.conflictresolvemsgbox",ui:"svmx-default",objectType:i.data.label,record:i.data,name:i.data.nameValue,syncDetails:l,showViewInfo:!0,applyHandler:a.proxy(this,function(e,t){this.__resolveItem(e,t)})}).show()},convertErrorMessageTimezone:function(e){var t=void 0,n=void 0,i=void 0,r=void 0,o=void 0;return r=e?e.split(";"):[],o=a.getCurrentApplication().getUserInfo().SalesForceTimezoneOffset,t=r.length>0?r[0].substring(r[0].indexOf(":")+1)+o:"",n=r.length>1?r[1].substring(r[1].indexOf(":")+1)+o:"",i=r.length>2?r[2].substring(r[2].indexOf(":")+1)+o:"",r[0]=r.length>0?r[0].replace(r[0].substring(r[0].indexOf(":")+1),this.formatErrorTime(t)):"",r[1]=r.length>1?r[1].replace(r[1].substring(r[1].indexOf(":")+1),this.formatErrorTime(n)):"",r[2]=r.length>2?r[2].replace(r[2].substring(r[2].indexOf(":")+1),this.formatErrorTime(i)):"",e=r.join("")},formatErrorTime:function(e){return s(e).format("YYYY-MM-DD HH:mm:ss")},getConflicts:function(){var e=this,t=new i.Deferred,n=this;n.blockApplication();var r=null;return this._options&&(r=this._options.SVMX_conflictId),this.__syncManager.getDetailedSyncConflicts(function(i){i=i||{},e.setViewInfo({windowTitle:a.string.substitute(l().T("FSA010_TAG137","Sync Conflicts ({{conflictCount}})"),{conflictCount:i.length})});var r=n.getStore();r.removeAll();var o=void 0;for(o=0;o<i.length;o++)"SERVER_OVERRIDE"==i[o].override_flag?i[o].status_label=l().T("FSA012_TAG069","Changes will be lost"):"CLIENT_OVERRIDE"==i[o].override_flag?i[o].status_label=l().T("FSA012_TAG070","Changes will be kept"):""==i[o].override_flag&&(i[o].status_label=l().T("FSA012_TAG071","Unresolved"));r.setData(i),n.__list.setStore(r),n.unblockApplication(),t.resolve(i)},r),t.promise()},__onSyncStop:function(){this.__viewReady&&this.getConflicts()}}),a.defineGlobal(o.name,o),e.exports=o},function(e,t,n){var i=n(0).utils,a=(n(19).impl,n(24).navigation,n(22).View),r={name:"com.servicemax.client.toolspages.ui.largemodern.resetappview"},o=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},s=a;Ext.define(r.name+".ResetAppView",{extend:s,alias:"widget.sfm.tools.sync.resetapp",__syncManager:null,__running:!1,__startTime:null,__success:!1,__requestLog:null,__progressTotal:0,__progressStep:0,__successMessage:"",__progressMessage:"",__progressDescriptions:null,__resetAppOnFinish:!1,__desc:null,initialize:function(){this.callParent();var e=i.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=e.getInstance(),this.__progressDescriptions=[];var t=i.getCurrentApplication().getSyncImpl();this.bind(t,"SYNC_STARTED_IMPL",this.__onSyncStarted,this),this.bind(t,"SYNC_FAILED_IMPL",this.__onSyncFailed,this),this.bind(t,"SYNC_COMPLETED_IMPL",this.__onSyncCompleted,this),this.bind(this.__syncManager,"SYNC_STOPPED",this.__onSyncStop,this),this.bind(t,"SYNC_PROGRESS_IMPL",this.__onProgress,this),this.bind(t,"SYNC_INFO_IMPL",this.__onInfo,this),this.bind(t,"SYNC_EVENT_REQUEST_STARTED_IMPL",this.__onSyncEventRequestStarted,this),this.bind(t,"SYNC_EVENT_REQUEST_COMPLETED_IMPL",this.__onSyncEventRequestCompleted,this),this.bind(t,"SYNC_EVENT_STARTED_IMPL",this.__onEventStarted,this)},ready:function(){this.setViewInfo({subTitle:"",hideContextMenu:!0});var e=i.getClient().getApplicationParameter("client-type").toLowerCase(),t=void 0,n=void 0;"mobile"==e?(t="FSA012_TAG018",n="<b>Please do not press the home button or switch to another application because this will stop the download process.</b>"):(t="TODO",n="");var a=[{xtype:"svmx.verticalpanel",ui:"svmx-default",type:"vbox",valign:"center",cls:"container-reset-app",items:[{xtype:"svmx.panel",ui:"svmx-default",cls:"panel-tools-reset-view-header",id:"resetMessagePane",align:"center",items:[{xtype:"svmx.label",ui:"svmx-default",text:o().T("FSA010_TAG100","We're downloading the latest work orders, appointments, and other information you need to deliver flawless field service. This process can take a few minutes."),cls:"label-tools-sync-success"},{xtype:"svmx.label",ui:"svmx-default",text:o().T(t,n),cls:"label-tools-sync-success"}]},{xtype:"svmx.panel",ui:"svmx-default",cls:"panel-tools-carousel",align:"center",items:[{xtype:"svmx.carousel",itemId:"syncTutorialPane",cls:"panel-tools-sync-tutorial",hidden:!1,items:[{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-001"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-002"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-003"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-004"}]},{xtype:"panel",cls:"panel-tools-sync-tutorial-image",items:[{xtype:"svmx.image",cls:"image-tools-sync-tutorial tools-sync-tutorial-image-005"}]}]}]},{xtype:"svmx.panel",ui:"svmx-default",cls:"panel-tools-progress",align:"center",items:[{xtype:"tools.sync.progress",ui:"svmx-default",id:"resetappprogressbar",showSubProgress:!1,cls:"container-tools-reset-progressbar",containerCls:"container-sfm-tools-small-progressbar",barCls:"sfm-tools-small-progressbar-bar"}]}]}];this.add(a)},updateOverallProgressBar:function(){var e=Ext.getCmp("resetappprogressbar");e&&e.updateProgress(this.__progressStep,this.__progressTotal,this.__desc)},updateSubProgressBar:function(){var e=Ext.getCmp("resetappprogressbar");e&&e.updateSubProgress()},__onEventStarted:function(e){var t=e.data.getName();"SyncInitServer"==t?this.__desc=o().T("FSA010_TAG003","Initializing..."):"SyncLocalMetadata"==t?this.__desc=o().T("FSA010_TAG004","Downloading Configuration"):"PopulateIgnoreList"==t?this.__desc=o().T("FSA010_TAG005","Validating configuration"):"SyncConfigDataInitial"==t||"SyncGetPriceMetadata"==t||"SyncSettings"==t||"SyncRecordTypes"==t||"SyncGetDeleteEvents"==t||"SyncGetDownloadCriteria"==t?this.__desc=o().T("FSA010_TAG006","Processing configuration"):"SyncGetPriceData"==t?this.__desc=o().T("FSA010_TAG007","Syncing pricebook"):"SyncLocalData"==t?this.__desc=o().T("FSA010_TAG008","Syncing data tables"):"UpdateServiceMaxEvents"==t?this.__desc=o().T("FSA010_TAG009","Updating calendar"):"SyncCleanUpSelect"==t&&(this.__desc=o().T("FSA010_TAG010","Finalizing configuration"))},syncFinished:function(){var e=null;this.__resetAppOnFinish&&(e=i.getClient().getApplicationParameter("sfmconsole-runtime-start")||null),e&&""!==e?i.getCurrentApplication().getRoot().launchConsoleApp(e):i.getCurrentApplication().__openFirstConsoleApp()},__getSyncProgressStepTotal:function(){for(var e=this.__syncManager.getEventConfig(),t=0,n=0;n<e.length;n++)t+=e[n].length;return t},__onSyncStarted:function(e){this.__running=!0,this.__startTime=new Date,this.__progressTotal=this.__getSyncProgressStepTotal(),this.__progressStep=0},__onSyncFailed:function(e){this.__running=!1,this.__success=!1,this.syncFinished()},__onSyncCompleted:function(e){new Date,this.__startTime;this.__running=!1,this.__success=!0,this.syncFinished()},__onSyncStop:function(e){new Date,this.__startTime;this.__running=!1,setTimeout(i.proxy(this,function(){this.__success||this.done()}),100)},__onProgress:function(e){this.__progressTotal=e.data.totalCount||this.__progressTotal,this.__progressStep=e.data.currentStep||this.__progressStep,this.updateOverallProgressBar()},__onInfo:function(e){this.updateSubProgressBar()},__onSyncEventRequestStarted:function(e){var t=e.data;t.time=(new Date).getTime(),t.status=o().T("FSA010_TAG101","Running...");i.toObject(i.toJSON(t))},__onSyncEventRequestCompleted:function(e){var t=e.data,n=new Date-t.startDate;t.logStoreRecord&&(t.error?t.logStoreRecord.set("status",o().T("FSA010_TAG093","Error")+" ("+n+" ms)"):t.logStoreRecord.set("status",o().T("FSA010_TAG102","Completed")+" ("+n+" ms)"),t.request&&t.logStoreRecord.set("request",t.request),t.result&&t.logStoreRecord.set("result",t.result),t.logStoreRecord.commit())}}),i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){n(853);var i=n(859),a=n(860);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"troubleshootdelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},icon:{"large-css-class":"icon-chat","small-css-class":"icon-chat"},views:[{id:"home","class-name":"com.servicemax.client.troubleshootdelivery.ui.largemodern.api.TroubleshootHomeView","default-view":!0}],controller:{"class-name":"com.servicemax.client.troubleshootdelivery.engine.DeliveryEngineImpl"},discover:!1,multiple:!1,positionWeight:2e3,"button-text":"Troubleshooting"}}),e.exports={impl:i,api:a}},function(e,t,n){var i=n(854),a=n(855),r=n(856),o=n(857),s=n(858),l=n(0).utils;l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"TROUBLESHOOTDELIVERY.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"troubleshootdelivery","class-name":"com.servicemax.client.troubleshootdelivery.engine.DeliveryEngineImpl"}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"TROUBLESHOOTDELIVERY.GET_FEED_INFO","command":"com.servicemax.client.troubleshootdelivery.commands.GetFeedInfo"},{"event":"TROUBLESHOOTDELIVERY.SAVE_FEED_INFO","command":"com.servicemax.client.troubleshootdelivery.commands.SaveFeedInfo"},{"event":"TROUBLESHOOTDELIVERY.GET_PRODUCT_DOCUMENTS","command":"com.servicemax.client.troubleshootdelivery.commands.GetProductDocuments"},{"event":"TROUBLESHOOTDELIVERY.GET_PRODUCT_MANUAL","command":"com.servicemax.client.troubleshootdelivery.commands.GetProductManual"},{"event":"TROUBLESHOOTDELIVERY.DOWNLOAD_DOCUMENT_ON_DEMAND","command":"com.servicemax.client.troubleshootdelivery.commands.DownloadDocumentOnDemand"},{"event":"TROUBLESHOOTDELIVERY.GET_ALL_DOCUMENTS","command":"com.servicemax.client.troubleshootdelivery.commands.GetAllDocuments"}]}}}')),e.exports={impl:i,engine:a,commands:r,responders:o,operations:s}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.troubleshootdelivery.impl"};y.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){y.init(),y.init(),y.init(),y.init()}},{key:"afterInitialize",value:function(){}}]),t}(v),y.TroubleshootDeliveryEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("TroubleshootDeliveryEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(33).AbstractDeliveryEngine,m=n(12).DatetimeUtil,v={name:"com.servicemax.client.troubleshootdelivery.engine"},g=function(){return f.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};v.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__isContainerExternal=!1,m.setAmPmText(g().T("FSA016_TAG005","AM"),g().T("FSA016_TAG006","PM")),e.__loadMask=null,e.__parent=null,e.__translation=null,e.__view=null,e.__appCurrentState="",e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"initAsync",value:function(e){var t=f.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=f.create("com.servicemax.client.troubleshootdelivery.impl.TroubleshootDeliveryEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("TROUBLESHOOTDELIVERY.VIEW",{handler:function(t){this.__view=t,e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"getView",value:function(){return this.__view}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"triggerEvent",value:function(e){this.getEventBus().triggerEvent(e)}},{key:"translate",value:function(e){return g().T(e)}},{key:"getAllTranslation",value:function(){return this.__translation}},{key:"reset",value:function(){}},{key:"run",value:function(e){var t=this;this.options=e||{},setTimeout(function(){t.options.onReady&&t.options.onReady.handler.call(t.options.onReady.context||t)},15)}},{key:"getFeedInfo",value:function(e){var t=f.create("com.servicemax.client.troubleshootdelivery.commands.GetFeedInfoResponder",{handler:e.callback,context:e.context||this}),n=f.create("com.servicemax.client.lib.api.Event","TROUBLESHOOTDELIVERY.GET_FEED_INFO",this,{request:e,responder:t});this.triggerEvent(n)}},{key:"saveFeedInfo",value:function(e){var t=f.create("com.servicemax.client.troubleshootdelivery.commands.SaveFeedInfoResponder",{handler:function(t){this.getFeedInfo(e)},context:this}),n=f.create("com.servicemax.client.lib.api.Event","TROUBLESHOOTDELIVERY.SAVE_FEED_INFO",this,{request:e,responder:t});this.triggerEvent(n)}},{key:"getTroubleshootDocuments",value:function(e){f.create("com.servicemax.client.sfmconsole.utils.EventCollection",this.getEventBus(),[f.create("com.servicemax.client.lib.api.Event","TROUBLESHOOTDELIVERY.GET_PRODUCT_DOCUMENTS",this,{request:e}),f.create("com.servicemax.client.lib.api.Event","TROUBLESHOOTDELIVERY.GET_PRODUCT_MANUAL",this,{request:e})]).triggerAll(function(t){for(var n=t.items(),i=n.length,a=0;a<i;a++)e.offlineRecordsOnly=!!n[a].response.isConnectivityError;var r=f.create("com.servicemax.client.troubleshootdelivery.commands.GetAllDocumentsResponder",{handler:function(t){e.callback&&e.callback.call(e.context,t||[],e.offlineRecordsOnly)},context:this}),o=f.create("com.servicemax.client.lib.api.Event","TROUBLESHOOTDELIVERY.GET_ALL_DOCUMENTS",this,{request:e,responder:r});this.triggerEvent(o)},this)}},{key:"downloadDocumentOnDemand",value:function(e){var t=f.create("com.servicemax.client.troubleshootdelivery.commands.DownloadDocumentOnDemandResponder",{handler:function(t){t.isSuccess?e.success(t):e.fault(t)},context:e.context||this}),n=f.create("com.servicemax.client.lib.api.Event","TROUBLESHOOTDELIVERY.DOWNLOAD_DOCUMENT_ON_DEMAND",this,{request:e,responder:t});this.triggerEvent(n)}}]),t}(p),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m=n(13).Responder,v={name:"com.servicemax.client.troubleshootdelivery.commands"};v.GetFeedInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TROUBLESHOOTDELIVERY.GET_FEED_INFO"})}}]),t}(p),v.SaveFeedInfo=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TROUBLESHOOTDELIVERY.SAVE_FEED_INFO"})}}]),t}(p),v.GetProductDocuments=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TROUBLESHOOTDELIVERY.GET_PRODUCT_DOCUMENTS"})}}]),t}(p),v.GetProductManual=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TROUBLESHOOTDELIVERY.GET_PRODUCT_MANUAL"})}}]),t}(p),v.GetAllDocuments=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TROUBLESHOOTDELIVERY.GET_ALL_DOCUMENTS"})}}]),t}(p),v.DownloadDocumentOnDemand=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this._executeOperationAsync(e,t,{operationId:"TROUBLESHOOTDELIVERY.DOWNLOAD_DOCUMENT_ON_DEMAND"})}}]),t}(p),v.GetAllDocumentsResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__callback=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__callback&&this.__callback.handler&&this.__callback.handler.call(this.__callback.context,e)}}]),t}(m),v.DownloadDocumentOnDemandResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__callback=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__callback&&this.__callback.handler&&this.__callback.handler.call(this.__callback.context,e)}}]),t}(m),v.GetFeedInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__callback=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__callback&&this.__callback.handler&&this.__callback.handler.call(this.__callback.context,e)}}]),t}(m),v.SaveFeedInfoResponder=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return n.__callback=e,n}return(0,h.default)(t,e),(0,c.default)(t,[{key:"result",value:function(e){this.__callback.handler.call(this.__callback.context,e)}}]),t}(m),f.defineGlobal(v.name,v),e.exports=v},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.troubleshootdelivery.responders"};i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.troubleshootdelivery.operations"};i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.troubleshootdelivery.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(50),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=n(22).View,s=n(12).DatetimeUtil,l=n(179).nativeservice,c={name:"com.servicemax.client.troubleshootdelivery.ui.largemodern.api"},u=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},d=o,_=r.getLoggingService().getLogger("sfmsearch-ui"),h=c.name,f=r.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance();Ext.define(h+".ChatterFeedRecordStore",{extend:"com.servicemax.client.ui.components.modern.data.SVMXStore",alias:"widget.troubleshoot.chatterfeedrecordstore",constructor:function(e){this.callParent(arguments)},fields:[{name:"id"},{name:"comments"},{message:"message"},{name:"timestamp",convert:function(e,t){var n=t.data.timestamps,i=n.createdDate,a=s.convertToTimezone(i);return s.getFormattedDatetime(a)}},{name:"user",convert:function(e,t){return e.displayName}}]}),Ext.define(h+".documentStore",{extend:"com.servicemax.client.ui.components.modern.data.SVMXStore",alias:"widget.troubleshoot.documentstore",constructor:function(e){this.callParent(arguments)},fields:[{name:"BodyLength"},{name:"Description"},{name:"Id"},{name:"Keywords"},{name:"Name"},{name:"Type"},{name:"attType"},{name:"attUrl"},{name:"docType"},{name:"online"},{name:"parentId"},{name:"path"}]}),Ext.define(h+".DocumentsView",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXGrid",alias:"widget.troubleshoot.documentsView",store:"documentRecordStore",minHeight:"100%",ui:"svmx-default",minWidth:"100%",autoHeight:!0,hideHeaders:!0,controller:"DocumentsController",itemConfig:{viewModel:"docs.DocumentsViewModel"},columns:[{text:"File Type",width:"100px",cell:{xtype:"gridcell",cls:"troubleshoot-documents-grid-cell file-type-cell",innerCls:"troubleshoot-documents-grid-cell-inner",encodeHtml:!1},dataIndex:"Id",renderer:function(e,t,n,i,a){return['<div class="troubleshoot-document-wrap">','<div class="troubleshoot-document"><div class="troubleshoot-document-icon '+function(e){var t="",n="";if(!e)return t="fa fa-file-o file-icon-default";var i=e.lastIndexOf("."),n=e.substr(i+1);return n.indexOf("pdf")>=0?t="fa-file-pdf-o file-icon-pdf":n.indexOf("txt")>=0?t="fa-file-text file-icon-txt":n.indexOf("doc")>=0?t="fa-file-word-o file-icon-word":n.indexOf("xls")>=0?t="fa-file-excel-o file-icon-xls":n.indexOf("zip")>=0?t="fa-file-zip-o file-icon-zip":(n.indexOf("jpg")>=0||n.indexOf("png")>=0||n.indexOf("tiff")>=0)&&(t="fa-file-photo-o file-icon-image"),t="fa "+(t||"fa-file-o file-icon-default")}(t.get("Name"))+'"></div></div>','<span class="troubleshoot-document-file-size" >'+Ext.util.Format.fileSize(t.get("BodyLength"))+"</span>","</div>"].join("")}},{text:"Name and Description",flex:2,cell:{xtype:"gridcell",cls:"troubleshoot-documents-grid-cell  file-desc-cell",innerCls:"troubleshoot-documents-grid-cell-inner",encodeHtml:!1},dataIndex:"Description",renderer:function(e,t,n,i,a){return['<div class="document-decription-wrapper">','<div class="description-line-name"><div class="document-name">'+(t.get("Name")||"&nbsp")+"</div></div>",'<span class="description-line-desc">'+t.get("Description")+"</span>","</div>"].join("")}},{text:"Online",width:"100px",cell:{xtype:"gridcell",cls:"troubleshoot-documents-grid-cell  file-dod-cell",innerCls:"troubleshoot-documents-grid-cell-inner",encodeHtml:!1},encodeHtml:!1,dataIndex:"online",renderer:function(e,t,n,i,a){return"true"==t.get("online")?finalValue='<a></a><i class="icon-cloud-download troubleshooting-download-icon"></i></a>':finalValue="<a></a>"}}],listeners:{itemtap:function(e,t,n,i,a,o){var s=Ext.get(a.target),c=this,d=Ext.ComponentQuery.query("troubleshoot\\.home");if(!Ext.isEmpty(d)){var _=d[0];if(s.hasCls("troubleshooting-download-icon"))"true"==i.get("online")?(i.set("online","downloading"),_.troubleShootDeliveryEngine.downloadDocumentOnDemand({Id:i.get("Id"),Name:i.get("Name"),docType:i.get("attType"),url:i.get("attUrl"),success:function(e){i.beginEdit(),i.set("online","false"),i.set("path",e.data),i.endEdit()},fault:function(e){i.beginEdit(),i.set("online","true"),i.endEdit(),e.isConnectivityError&&r.Msg.alert({title:u().T("FSA013_TAG001","Connectivity failure"),text:u().T("FSA013_TAG001","Connectivity failure"),buttons:[{text:u().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]})},context:c})):"downloading"==i.get("online")&&r.Msg.toast({text:u().T("FSA013_TAG002","Record downloading is in Progress")});else if("false"==i.get("online")){var a=r.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_ATTACHMENT",this,{request:{deliveryEngine:this.__deliveryEngine,file:new l.File("{TroubleshootDocumentDirectory}/"+i.get("Id")+"_"+i.get("Name"))}}),h=r.getCurrentApplication();h.triggerEvent(a)}}}},constructor:function(e){r.create(h+".documentStore",{storeId:"documentRecordStore",data:[]}),e.store=e.store||"documentRecordStore",this.callParent(arguments)}}),Ext.define(h+".viewmodel.DocumentsViewModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.docs.DocumentsViewModel"}),Ext.define(h+".view.documentsController",{extend:"Ext.app.ViewController",alias:"controller.DocumentsController",init:function(){}}),Ext.define(h+".ChatterFeedItemDataView",{extend:"Ext.dataview.DataView",alias:"widget.troubleshoot.chatterfeeditemdataview",cls:"troubleshooting-chatter-feed-item-data-view",selectedCls:"svmx-chatter-feed-data-view-select-item",itemTpl:"",height:"100%",width:"100%",scrollable:!1,constructor:function(e){var t=new Ext.XTemplate("<div class='thumb-wrap svmx-chatter-feeds-container'>","   <div class='svmx-feed-item-container'>","           <div class='svmx-feed-item-date-time-container'>","                 {timestamp}","           </div>","       <div class='svmx-feed-item-content-wrapper'>","           <div class='svmx-feed-item-actor-pic-container'>","           </div>","           <div class='svmx-feed-item-content-container'>","               <div class='svmx-feed-item-content-header'> ","                  {user}","               </div>","               <div class='svmx-feed-item-content-body'> ","                  {message.text}","               </div>","               <div class='svmx-feed-item-content-footer'>","               </div>","           </div>","       </div>","       <div class='svmx-feed-item-comments-container'>","           <tpl for='comments'>","           <div class='svmx-feed-item-comment'>","           <div class='svmx-feed-item-comment-date-time-container'>","                  {[this.formattedTimeStamp(values.timestamps)]}","           </div>","           <div class='svmx-feed-item-comment-wrapper'>","               <div class='svmx-feed-item-commentsuser-pic-container'>","               </div>","               <div class='svmx-feed-item-comment-content-container'>","                   <div class='svmx-feed-item-comment-header'>","                  {user.displayName}","                   </div>","                   <div class='svmx-feed-item-comment-body'>","                  {[this.formatMessageSegments(values.message.segments)]}","                   </div>","                   <div class='svmx-feed-item-comment-footer'>","                   </div>","               </div>","           </div>","           </div>","           </tpl>","           <div class='svmx-feed-item-comment'>","           <div class='svmx-feed-item-comment-date-time-container'>","           &nbsp;</div>","           <div class='svmx-feed-item-comment-wrapper'>","               <div class='svmx-feed-item-commentsuser-pic-container'>","               </div>","               <div class='svmx-feed-item-comment-content-container'>","                   <div class='svmx-feed-item-comment-header'>","                  <a class='chatter-feed-item-reply-link'  href='javascript:void(0);' >"+u().T("FSA013_TAG007","Reply")+"</a>","                   </div>","                   <div class='svmx-feed-item-comment-body'>","                     &nbsp;","                   </div>","                   <div class='svmx-feed-item-comment-footer'>","                   </div>","               </div>","           </div>","           </div>","               </div>","           </div>","       </div>","   </div>","</div>",{formattedTimeStamp:function(e){var t=e.modifiedDate||e.createdDate,n=s.convertToTimezone(t);return s.getFormattedDatetime(n)},formatMessageSegments:function(e){for(var t=" ",n=0;n<e.length;n++){var i="",a=e[n];switch(a.type){case"Text":i=a.text;break;case"Link":i='<a class="chatter-msg-segment-link" onclick="return false;" ontap="return false;" href="javascript:void(0);" data-link-url="'+a.url+'" >'+a.text+"</a>";break;case"Hashtag":i=' <a class="chatter-msg-segment-hashtag"> '+a.text+"</a> ";break;default:i=a.text}t+=i}return t=t.replace(/\n/g,"<br/>")}});r.create(h+".ChatterFeedRecordStore",{storeId:"feedItemRecordStore",data:[]}),e.itemTpl=e.itemTpl||t,e.store=e.store||"feedItemRecordStore",this.callParent(arguments)}}),Ext.define(h+".NewChatterPostDialog",{extend:"com.servicemax.client.ui.components.modern.popups.SVMXSheet",alias:"widget.troubleshoot.newchatterpost",cls:"svmx-tasks-box svmx-new-chatter-post-dialog",ui:"svmx.default",floating:!0,modal:!0,centered:!0,scrollable:!0,layout:{type:"fit"},currentFeedItemRecord:null,constructor:function(e){var e=e||{},t=this.getPostForm(e);e.items=[t],this.callParent([e]);var n=this.initNewPostFormToolBar(e);this.add(n)},initNewPostFormToolBar:function(e){return Ext.widget("svmx.headerbar",{docked:"top",cls:"sfmevent-edit-dialog-headerbar",leftItem:[{xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-cancel",text:u().T("FSA016_TAG004","Cancel"),handler:e.leftItemHandler||Ext.emptyFn}],rightItem:[{xtype:"svmx.button",ui:"button-nav-toolbar",cls:"sfmevent-edit-dialog-cancel",text:u().T("FSA013_TAG004","Done"),handler:e.rightItemHandler||Ext.emptyFn}],centerItem:[{xtype:"svmx.label",cls:"sfmevent-edit-dialog-title",text:e.centerTitle||""}]})},getPostForm:function(e){return Ext.widget("svmx.field.textarea",{xtype:"svmx.field.textarea",cls:"svmx-new-post-comment-text-area",itemId:"newCommentContent",clearIcon:!1,width:"100%",height:"100%",enableBarcode:!1,alwaysShowBarcode:!1})},getFormValues:function(){var e=this.query("#newCommentContent")[0];return{record:this.currentFeedItemRecord,content:e.getValue()}}}),Ext.define(h+".Chatter",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.troubleshoot.chatter",config:{title:"",itemTpl:""},cls:"troubleshooting-panel-full",scrollable:"vertical",initialize:function(){var e=Ext.widget("troubleshoot.chatterfeeditemdataview",{emptyText:u().T("FSA013_TAG005","No Feeds to display."),deferEmptyText:!0,listeners:{itemtap:function(e,t,n,i,a,o){var s=this.getParent().getParent().getParent(),l=Ext.get(a.target);if(l){if(l.hasCls("chatter-msg-segment-link")){var c=l.getAttribute("data-link-url"),d=r.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.OPEN_BROWSER",this,{request:{link:c}});r.getCurrentApplication().triggerEvent(d)}if(l.hasCls("chatter-feed-item-reply-link"))if(s.chatterFunctionalityDisabledInSfdc)r.Msg.toast({text:u().T("FSA013_TAG006","Chatter Functionality is disabled")});else if(!0===i.get("connectivity")){s.stopChatterRefresh();var _=Ext.widget("troubleshoot.newchatterpost",{centerTitle:u().T("FSA013_TAG007","Reply"),height:300,width:300,currentFeedItemRecord:i,rightItemHandler:function(){if(!s.hasInternetConnection)return r.Msg.toast({text:u().T("FSA013_TAG008","No Connectivity")}),!1;var e=_.getFormValues();s.saveFeedInfo(e),_.destroy(),s.startChatterRefresh(!0)},leftItemHandler:function(){_.destroy(),s.startChatterRefresh()}});_.show()}else r.Msg.toast({text:u().T("FSA013_TAG009","No Connectivity to post reply.")})}}}});this.add(e)}}),Ext.define(h+".Documents",{extend:"com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",alias:"widget.troubleshoot.documents",config:{title:"",itemTpl:""},minHeight:"100%",minWidth:"100%",cls:"troubleshooting-panel-full",scrollable:"vertical",initialize:function(){var e=Ext.widget("troubleshoot.documentsView",{itemHeight:80,bufferSize:50,deferEmptyText:!0,emptyText:u().T("FSA013_TAG010","No Docs to display.")});this.add(e)}}),Ext.define(h+".TroubleshootMain",{extend:"com.servicemax.client.ui.components.modern.navigation.SVMXTabPanel",alias:"widget.troubleshoot.troubleshootmainview",ui:"svmx-default",autoDestroy:!1,cls:"troubleshooting-panel-full troubleshoot-main-view-tabs-container",defaults:{styleHtmlContent:!0},tabBarItems:[],initialize:function(){this.callParent();var e=this;if(e.tabBarItems.length>0){var t=e.getTabBar();t.addCls("troubleshooting-tab-bar"),t.add(e.tabBarItems)}}}),Ext.define(h+".TroubleshootHomeView",{extend:d,alias:"widget.troubleshoot.home",troubleShootDeliveryEngine:null,chatterRefreshTask:null,chatterFunctionalityDisabledInSfdc:!1,recordId:null,updateOptions:function(e){this.setViewInfo(e)},refreshView:function(){},onShow:function(){_.info("TroubleshootHomeView View showing"),this.callParent()},onHide:function(){var e=this;e.stopConnectivityCheck(),e.stopChatterRefresh(),_.info("TroubleshootHomeView View hiding"),this.callParent()},startChatterRefresh:function(e){var t=this;_.info("Chatter Feed Refresh Started"),t.chatterRefreshTask=new Ext.util.TaskRunner,t.chatterRefreshTask.newTask({id:"refreshChatterFeed",run:function(){t.getFeedRecords(t.recordId,!0)},interval:6e4}).start(),e&&t.getFeedRecords(t.recordId,!0)},stopChatterRefresh:function(){_.info(" Chatter Feed Refresh Stopped"),this.chatterRefreshTask&&this.chatterRefreshTask.destroy()},getTroubleshootDocuments:function(){r.Msg.toast({text:u().T("FSA013_TAG011","Loading Troubleshoot Documents")}),this.troubleShootDeliveryEngine.getTroubleshootDocuments({productName:this.recordName,parentId:this.recordId,searchText:"Manual",callback:function(e,t){if(e&&e.length){var n=Ext.data.StoreManager.lookup("documentRecordStore"),i=Ext.isEmpty(e)?[]:e;n.loadData(i)}else r.Msg.alert({title:u().T("FSA013_TAG012","No records to display"),text:u().T("FSA013_TAG012","No records to display"),buttons:[{text:u().T("FSA016_TAG003","OK"),itemId:"OK",ui:"svmx-button-square"}]})},context:this})},ready:function(){function e(e,t){this.message=e,this.record=t,this.name="ProductIdNotFoundException"}var t,n=this,i=n.getOptions(),o=i.SVMX_record;i.SVMX_recordId;if(!o)throw _.error("Did you come from elsewhere..? No Work Order Record passed to engine "),new e("Did you come from elsewhere..? No Work Order Record passed to engine ",o);var s="",l="",c="",d=r.OrgNamespace;if(o&&o[d+"__Product__c"]&&o[d+"__Product__c"].fieldvalue){s=o[d+"__Product__c"].fieldvalue.key,l=o[d+"__Product__c"].fieldvalue.value,c=o.Name;var h=u().T("FSA013_TAG013","Troubleshooting")+" - "+l,f=c;_.info("Setting Troubleshoot View Info: windowTitle:"+h+" :backText: "+f),n.setViewInfo({windowTitle:h,backText:f,subTitle:"",hideContextMenu:!0,menuItems:[]})}n.recordId=s,n.recordName=l,n.troubleShootDeliveryEngine=n.getDeliveryEngine();var p=Ext.widget("troubleshoot.troubleshootmainview",{items:[(t={xtype:"troubleshoot.documents",cls:"troubleshooting-tab-item",scrollable:"y",title:u().T("FSA013_TAG014","Documents and Files")},(0,a.default)(t,"cls","troubleshooting-tab-item"),(0,a.default)(t,"itemId","DocumentsTab"),t),{title:'<span class="troubleshooting-top-tab-separator-title"> | <span>',cls:"troubleshooting-top-tab-separator-item",disabled:!0},{xtype:"troubleshoot.chatter",itemId:"chatterTab",cls:"troubleshooting-tab-item",layout:"fit",title:u().T("FSA013_TAG015","Chatter"),listeners:{show:function(){n.startChatterRefresh()},hide:function(){n.stopChatterRefresh()}}}],tabBarItems:[{xtype:"spacer"},{xtype:"button",text:u().T("FSA013_TAG016","New Post"),cls:"troubleshooting-new-chatter-feed-button",hidden:!0,itemId:"newChatterFeedItemButton",handler:function(){if(n.stopChatterRefresh(),n.chatterFunctionalityDisabledInSfdc)return void r.Msg.toast({text:u().T("FSA013_TAG006","Chatter Functionality is disabled")});var e=Ext.widget("troubleshoot.newchatterpost",{centerTitle:u().T("FSA013_TAG017","New Chatter Post"),height:300,width:300,rightItemHandler:function(){if(!n.hasInternetConnection)return r.Msg.toast({text:u().T("FSA013_TAG008","No Connectivity")}),!1;var t=e.getFormValues();n.saveNewPost(t),e.destroy(),n.startChatterRefresh(!0)},leftItemHandler:function(){e.destroy(),n.startChatterRefresh()}});e.show()}}],listeners:{activeitemchange:function(e,t,i,a){var r=t.getItemId&&t.getItemId();r&&"chatterTab"===r?(n.getFeedRecords(n.recordId),n.scheduleConnectivityCheck()):n.stopConnectivityCheck(),r&&"DocumentsTab"===r&&n.getTroubleshootDocuments(),n.showTroubleShootFeatures(r),n.hideTroubleShootFeatures(r)}}});this.add(p),n.chatterTab=Ext.ComponentQuery.query("#chatterTab")[0],n.newChatterFeedItemButton=Ext.ComponentQuery.query("#newChatterFeedItemButton")[0],n.getTroubleshootDocuments()},getFeedRecords:function(e,t){var n=this;!1===n.hasInternetConnection?n.hasInternetConnection:r.Msg.toast({text:t?u().T("FSA013_TAG018","Refreshing Feeds for the product"):u().T("FSA013_TAG019","Loading Feeds for the product")});var i={recordId:e||n.recordId,callback:n.loadOrRefreshFeedInfoStore,context:n};n.troubleShootDeliveryEngine.getFeedInfo(i)},loadOrRefreshFeedInfoStore:function(e){var t=this,n=Ext.data.StoreManager.lookup("feedItemRecordStore"),i=Ext.isEmpty(e.data)?[]:e.data.feedItems;if(n.loadData(i),!Ext.isEmpty(e.error)){var a=r.toObject(e.error.error||{}),o=r.toObject(a.ResponseBody||{}),s=o[0];"REQUEST_LIMIT_EXCEEDED"===s.errorCode||("FUNCTIONALITY_NOT_ENABLED"===s.errorCode?(t.chatterFunctionalityDisabledInSfdc=!0,t.hideTroubleShootFeatures()):t.showTroubleShootFeatures());var l=o?o[0].message:u().T("FSA013_TAG020","Server Error");r.Msg.toast({text:l})}},checkConnectivity:function(e){var t=this;f.checkConnectivity().then(t.enableTroubleShootFeatures.bind(t),t.disableTroubleShootFeatures.bind(t))},stopConnectivityCheck:function(){var e=this;e.chatterFeedConnectivityCheckTask&&e.chatterFeedConnectivityCheckTask.destroy(),_.info("Stop Connectivity Check ")},scheduleConnectivityCheck:function(){var e=this;e.chatterFeedConnectivityCheckTask=new Ext.util.TaskRunner,e.chatterFeedConnectivityCheckTask.newTask({id:"chatterFeedConnectivityCheck",run:function(){e.checkConnectivity()},interval:1e3}).start()},showTroubleShootFeatures:function(e){var t=this;("chatterTab"===e||t.chatterFunctionalityDisabledInSfdc)&&Ext.ComponentQuery.query("#newChatterFeedItemButton")[0].setHidden(!1)},hideTroubleShootFeatures:function(e){"chatterTab"!==e&&Ext.ComponentQuery.query("#newChatterFeedItemButton")[0].setHidden(!0)},updateFeedRecordStatus:function(e){Ext.data.StoreManager.lookup("feedItemRecordStore").each(function(t){t.set("connectivity",e)})},enableTroubleShootFeatures:function(){this.updateFeedRecordStatus(!0),this.newChatterFeedItemButton.setDisabled(!1),this.hasInternetConnection=!0},disableTroubleShootFeatures:function(){this.updateFeedRecordStatus(!1),this.newChatterFeedItemButton.setDisabled(!0),this.hasInternetConnection=!1},saveFeedInfo:function(e){var t=this;t.troubleShootDeliveryEngine.saveFeedInfo({recordId:t.recordId,feedItemId:e.record.id,type:"comment",text:e.content,callback:t.loadOrRefreshFeedInfoStore,context:t})},saveNewPost:function(e){var t=this;t.troubleShootDeliveryEngine.saveFeedInfo({recordId:t.recordId,type:"feedItem",text:e.content,callback:t.loadOrRefreshFeedInfoStore,context:t})},listeners:{hide:function(){var e=this;e.stopConnectivityCheck(),e.stopChatterRefresh()}}}),r.defineGlobal(c.name,c),e.exports=c},function(e,t,n){n(862);var i=n(869),a=n(420),r=n(870),o=n(871),s=n(872),l=n(421),c=n(873),u=n(874),d=n(875),_=n(876),h=n(880);n(0).utils.registerDefinition({type:"com.servicemax.client.sfmconsole.consoleapp",config:{app:{id:"mobileinventorydelivery","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},views:[{id:"home","class-name":"com.servicemax.client.mobileinventory.ui.largemodern.api.MobileInventoryContainer","default-view":!0},{id:"partdetailview","class-name":"com.servicemax.client.mobileinventory.ui.largemodern.partdetailview.PartDetailView"},{id:"stocktransferview","class-name":"com.servicemax.client.mobileinventory.ui.largemodern.stocktransferview.StockTransferView"},{id:"transfercompletionview","class-name":"com.servicemax.client.mobileinventory.ui.largemodern.transfercompletionview.TransferCompletionView"},{id:"locatepartmapview","class-name":"com.servicemax.client.mobileinventory.ui.largemodern.locatepartmapview.LocatePartMapView"}],icon:{"large-css-class":"icon-Nav-Parts","small-css-class":"icon-Nav-Parts"},controller:{"class-name":"com.servicemax.client.mobileinventory.engine.DeliveryEngineImpl"},discover:!0,multiple:!1,load_on_demand:!0,load_on_demand_setting_value:["INVT002_SET001"],positionWeight:2501,"button-text":["FSA018_TAG004","Parts"]}}),e.exports={impl:i,api:a,inventorygridview:r,partdetailview:o,columnfactory:s,utils:l,mystock:c,catalog:u,stocktransferview:d,locatepartmapview:_,transfercompletionview:h}},function(e,t,n){var i=n(863),a=n(864),r=n(865),o=n(866),s=n(867),l=n(868),c=n(0).utils;c.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{define:{name:"MOBILEINVENTORY.VIEW",type:"com.servicemax.client.mvc.impl.View"}}}),c.registerDefinition({type:"com.servicemax.client.sfmconsole.deliveryengine",config:{engine:{id:"mobileinventory","class-name":"com.servicemax.client.mobileinventory.engine.DeliveryEngineImpl"}}}),c.registerDefinition({type:"com.servicemax.client.runtime.namedinstance",config:{configure:{name:"CONTROLLER",data:[{event:"MOBILEINVENTORY.GET_META_DATA",command:"com.servicemax.client.mobileinventory.commands.GetMetaData"},{event:"MOBILEINVENTORY.GET_TRUNK_STOCK_SEARCH_RESULTS",command:"com.servicemax.client.mobileinventory.commands.GetTrunkStockSearchResults"},{event:"MOBILEINVENTORY.GET_PRODUCT_STOCK",command:"com.servicemax.client.mobileinventory.commands.GetProductStock"},{event:"MOBILEINVENTORY.GET_PRODUCT_IMAGE",command:"com.servicemax.client.mobileinventory.commands.GetProductImage"},{event:"MOBILEINVENTORY.GET_TECHNICIAN_RECORDS",command:"com.servicemax.client.mobileinventory.commands.GetTechnicianRecords"},{event:"MOBILEINVENTORY.GET_CATALOG_SEARCH_RESULTS",command:"com.servicemax.client.mobileinventory.commands.GetCatalogSearchResults"},{event:"MOBILEINVENTORY.GET_LOCATE_PART_SEARCH_RESULTS",command:"com.servicemax.client.mobileinventory.commands.GetLocatePartSearchResults"},{event:"MOBILEINVENTORY.STOCK_TRANSFER",command:"com.servicemax.client.mobileinventory.commands.StockTransfer"}]}}}),e.exports={impl:i,engine:a,commands:r,responders:o,metamodel:s,inventorydata:l}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(5).EventDispatcher,y={name:"com.servicemax.client.mobileinventory.impl"};y.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){y.init(),y.init(),y.init(),y.init(),y.init(),y.init()}},{key:"afterInitialize",value:function(){}}]),t}(v),y.DeliveryEngineEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("DeliveryEngineEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(14),p=i(f),m=n(4),v=i(m),g=n(0).utils,y=n(7).Cache,S=n(33).AbstractDeliveryEngine,E={name:"com.servicemax.client.mobileinventory.engine"},b=function(){return g.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},T=y;E.DeliveryEngineImpl=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this));return e.__loadMask=null,e.__parent=null,e.__translation=null,e.__view=null,e.__inventoryMetaModel=null,e.__trunkStockCacheSearchInfo=null,e.__productStockCache=null,e.__productStockFieldInfo=null,e.__appCurrentState="",e.__syncManager=null,e.__getSyncManager(),e.__bindSyncCompletedEvent(),e}return(0,v.default)(t,e),(0,d.default)(t,[{key:"initAsync",value:function(e){var t=g.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=g.create("com.servicemax.client.mobileinventory.impl.DeliveryEngineEventBus",{}),t.createNamedInstanceAsync("CONTROLLER",{handler:function(n){t.createNamedInstanceAsync("MODEL",{handler:function(i){n.setModel(i),t.createNamedInstanceAsync("MOBILEINVENTORY.VIEW",{handler:function(t){this.__view=t,e&&e.handler&&e.handler.call(e.context)},context:this,additionalParams:{eventBus:this.getEventBus()}})},context:this})},context:this,additionalParams:{eventBus:this.__eventBus}})}},{key:"getEventBus",value:function(){return this.__eventBus}},{key:"translate",value:function(e){return b().T(e)}},{key:"getAllTranslation",value:function(){return this.__translation}},{key:"reset",value:function(){}},{key:"run",value:function(e){var t=this;this.options=e||{},g.create("com.servicemax.client.sfmconsole.utils.EventCollection",this.getEventBus(),[g.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_META_DATA",this,{request:{}})]).triggerAll(function(e){for(var n=e.items(),i=0;i<n.length;i++){var a=n[i];"MOBILEINVENTORY.GET_META_DATA"==a.type()&&this.onGetMetaDataCompleted(a.response)}T.readObjectFromDBCache("INVENTORY_TRUNK_STOCK_SEARCH_INFO").then(g.proxy(this,function(e){t.__trunkStockCacheSearchInfo=e,t.options.onReady&&t.options.onReady.handler.call(t.options.onReady.context||t)}))},this)}},{key:"onGetMetaDataCompleted",value:function(e){this.__inventoryMetaModel={},e.metaData&&(0,r.default)(e.metaData).length>0&&(this.__inventoryMetaModel=g.create("com.servicemax.client.mobileinventory.metamodel.MetaModel",this,e),this.__inventoryMetaModel.initialize())}},{key:"getMetaModel",value:function(){return this.__inventoryMetaModel}},{key:"getTrunkStockCacheSearchInfo",value:function(){return this.__trunkStockCacheSearchInfo}},{key:"getProductStockCache",value:function(){return this.__productStockCache}},{key:"setProductStockCache",value:function(e){this.__productStockCache=e}},{key:"getProductStockFieldInfo",value:function(){return this.__productStockFieldInfo}},{key:"setProductStockFieldInfo",value:function(e){this.__productStockFieldInfo=e}},{key:"__resetInventoryCacheInfoOnDataSync",value:function(){this.__trunkStockCacheSearchInfo=null,this.__productStockCache=null}},{key:"__resetCacheStockFieldInfoOnConfigSync",value:function(){this.__productStockFieldInfo=null}},{key:"__getSyncManager",value:function(){var e=g.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");return this.__syncManager=e.getInstance(),this.__syncManager}},{key:"__bindSyncCompletedEvent",value:function(){this.__syncManager&&this.__syncManager.bind("SYNC_COMPLETED",this.__resetCacheOnSyncCompletedEvent,this)}},{key:"__resetCacheOnSyncCompletedEvent",value:function(e){var t=e.target.__syncType;"ONECALLSYNC"==t||"AGGRESSIVE"==t||"TARGETEDSYNC"==t?this.__resetInventoryCacheInfoOnDataSync():"CONFIG"==t&&this.__resetCacheStockFieldInfoOnConfigSync()}},{key:"__unBindSyncCompletedEvent",value:function(){this.__syncManager&&this.__syncManager.unbind("SYNC_COMPLETED",this.__resetCacheOnSyncCompletedEvent,this)}},{key:"doCleanup",value:function(){this.__unBindSyncCompletedEvent(),this.setPropertyForCleanup(["__inventoryMetaModel","__eventBus"],!0),(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(S),g.defineGlobal(E.name,E),e.exports=E},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).Command,m={name:"com.servicemax.client.mobileinventory.commands"};m.GetMetaData=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,t,{operationId:"MOBILEINVENTORY.GET_META_DATA"})}}]),t}(p),m.GetTrunkStockSearchResults=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"MOBILEINVENTORY.GET_TRUNK_STOCK_SEARCH_RESULTS"})}},{key:"result",value:function(e){this.__cbContext.onTrunkSearchResultComplete(e)}}]),t}(p),m.GetCatalogSearchResults=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__responder=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){var n=this;n.__cbContext=e.context,n.__responder=t;for(var i=e.deliveryEngine,a=i.getMetaModel().layoutInfo.partsfields,r=i.getMetaModel().partDetailInfo.fields,o=[],s=r.length,l=s-1;l>=0;l--){for(var c=r[l],u=!1,d=a.length-1;d>=0;d--){var _=a[d];if(_.fieldName===c.fieldName&&_.objectname===c.objectName){u=!0;break}}u||o.push(c)}o.length>0&&(a=a.concat(o));var h=a.map(function(e){return{key:e.fieldName,value:e.type}});e.searchFields=h,e.fields=a;var p=[];e.context.__parentContext.__isConnected&&p.push(n.__getResultsFromOnline(e).promise()),p.push(n.__getResultsFromLocalDB(e).promise()),p.push(n.__getResultsFromOnlineCache(e).promise());var m=f.when(p);m.done(function(){var e=[],t=[],i=[];3===arguments.length?(e=arguments[0],t=arguments[1],i=arguments[2]):(t=arguments[0],i=arguments[1]);var a=[];a=a.concat(t),a=a.concat(e),a=a.concat(i),e=e.map(function(e){e[f.getCustomFieldName("Available_Qty")]="--"});for(var r={},o=a.length,s=[],l=0;l<o;l++){var c=a[l];r[c.Id]||(s.push(c),r[c.Id]=c)}n.__responder&&n.__responder.result&&n.__responder.result(s)}),m.fail(function(){n.__responder&&n.__responder.result&&n.__responder.result([])})}},{key:"result",value:function(e){this.__responder&&this.__responder.result&&this.__responder.result(e)}},{key:"__getResultsFromLocalDB",value:function(e){var t=f.Deferred();return this._executeOperationAsync(e,{result:function(e){t.resolve(e)},fail:function(e){t.reject(e)}},{operationId:"MOBILEINVENTORY.GET_TRUNK_STOCK_SEARCH_RESULTS"}),t}},{key:"__getResultsFromOnline",value:function(e){var t=f.Deferred();return this._executeOperationAsync(e,{result:function(e){t.resolve(e)},fail:function(e){t.reject(e)}},{operationId:"MOBILEINVENTORY.GET_CATALOG_SEARCH_RESULTS"}),t}},{key:"__getResultsFromOnlineCache",value:function(e){var t=f.Deferred();return f.doLater(function(){t.resolve([])}),t}},{key:"__addResultsToOnlineCache",value:function(e){return f.Deferred()}}]),t}(p),m.GetProductStock=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){var n=this;n.__cbContext=e.context;var i=e.engine,a=e.productId;i.setProductStockCache(i.getProductStockCache()||{});var r=i.getProductStockCache();r[a]?t.result&&f.doLater(function(){t.result(r[a])}):i.getProductStockFieldInfo()?n.__queryStockForProduct(e).then(function(e){r[a]=e,i.setProductStockCache(r),t.result&&t.result(r[a])}):n.__loadProductStockFieldInfo().then(function(o){i.setProductStockFieldInfo(o),n.__queryStockForProduct(e).then(function(e){r[a]=e,i.setProductStockCache(r),t.result&&t.result(r[a])})})}},{key:"__loadProductStockFieldInfo",value:function(){var e=f.Deferred(),t=f.create("com.servicemax.client.offline.sal.model.mobileinventory.utils.Query",{});return t.__q='SELECT * FROM SFObjectField WHERE object_api_name = "'+f.getCustomFieldName("Product_Stock")+'"',t.execute().done(function(t){e.resolve(t)}),e}},{key:"__queryStockForProduct",value:function(e){for(var t=(e.productId,e.engine),n=f.Deferred(),i=[],a=t.getMetaModel(),r=a.downloadCriteriaInfo.length,o=r-1;o>=0;o--){var s=a.downloadCriteriaInfo[o].getConfiguredStatus();s&&i.push(s)}return e.status=i,this._executeOperationAsync(e,{result:function(e){if(e){for(var i=[],a=t.getProductStockFieldInfo(),r=e.length,o=r-1;o>=0;o--){var s=f.create("com.servicemax.client.mobileinventory.inventorydata.ProductStock",e[o],a);s.initialize(),i.push(s)}return n.resolve(i)}n.resolve([])},fault:function(){n.resolve([])}},{operationId:"MOBILEINVENTORY.GET_PRODUCT_STOCK"}),n}}]),t}(p),m.GetProductImage=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,t,{operationId:"MOBILEINVENTORY.GET_PRODUCT_IMAGE"})}}]),t}(p),m.GetTechnicianRecords=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__responder=t,this._executeOperationAsync(e,this,{operationId:"MOBILEINVENTORY.GET_TECHNICIAN_RECORDS"})}},{key:"result",value:function(e){this.__responder&&this.__responder.result&&this.__responder.fault&&(e.error?this.__responder.fault(e):this.__responder.result(e))}}]),t}(p),m.StockTransfer=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__responder=t,this._executeOperationAsync(e,this,{operationId:"MOBILEINVENTORY.STOCK_TRANSFER"})}},{key:"result",value:function(e){this.__responder&&this.__responder.result&&this.__responder.fault&&(e.error?this.__responder.fault(e):this.__responder.result(e.data))}}]),t}(p),m.GetLocatePartSearchResults=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__responder=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){var n=this;t&&(n.__responder=t),this._executeOperationAsync(e,{result:function(e){n.__responder.result(e)},fail:function(e){n.__responder.fail(e)}},{operationId:"MOBILEINVENTORY.GET_LOCATE_PART_SEARCH_RESULTS"})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t){var n={name:"com.servicemax.client.mobileinventory.responders"};SVMX.defineGlobal(n.name,n),e.exports=n},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g={name:"com.servicemax.client.mobileinventory.metamodel"};g.MetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.layoutInfo={},i.locatePartInfo={},i.partDetailInfo={fields:[]},i.downloadCriteriaInfo=[],i.attachmentFileNameField=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){this.layoutInfo=m.create("com.servicemax.client.mobileinventory.metamodel.Layout",this,this.__data),this.layoutInfo.initialize(),this.locatePartInfo=m.create("com.servicemax.client.mobileinventory.metamodel.LocatePartsMetaModel",this,this.__data.metaData.locatepartsetup),this.locatePartInfo.initialize();for(var e=this.__data.metaData.layout.partsdetailfields,t=e?e.length:0,n=0;n<t;n++)this.partDetailInfo.fields[n]=m.create("com.servicemax.client.mobileinventory.metamodel.PartDetailMetaModel",this,e[n]),this.partDetailInfo.fields[n].initialize();e=this.__data.metaData.layout.downloadcriteria,t=e?e.length:0;for(var n=0;n<t;n++)this.downloadCriteriaInfo[n]=m.create("com.servicemax.client.mobileinventory.metamodel.DownloadCriteriaMetaModel",this,e[n]),this.downloadCriteriaInfo[n].initialize();this.attachmentFileNameField=this.__data.metaData.layout.attachmentfilename}},{key:"doCleanup",value:function(){if(this.setPropertyForCleanup(["layoutInfo","locatePartInfo","downloadCriteriaInfo"],!0),this.partDetailInfo&&this.partDetailInfo.fields){for(var e=this.partDetailInfo.fields,n=0;n<e;n++)this.partDetailInfo.fields[n].doCleanup();this.partDetailInfo.fields.length=0,this.partDetailInfo.fields=null,delete this.partDetailInfo}(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),g.Layout=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.partsfields=[],i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){for(var e=this.__data.metaData.layout.partsfields,t=e?e.length:0,n=0;n<t;n++)this.partsfields[n]=m.create("com.servicemax.client.mobileinventory.metamodel.PartsFieldsMetaModel",this,e[n]),this.partsfields[n].initialize()}},{key:"doCleanup",value:function(){this.setPropertyForCleanup("partsfields",!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),g.PartsFieldsMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.fieldName=null,i.objectname=null,i.sequence=null,i.displayLabel=null,i.dataType=null,i.referenceTo=null,i.relationshipName=null,i.type=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){var e=this.__parent.__data.objectInfo.fields;this.fieldName=this.__data.fieldname,this.objectname=this.__data.objectname,this.sequence=this.__data.sequence;for(var t=0;t<e.length;t++){var n=e[t];if(n.name===this.fieldName){this.displayLabel=n.label,this.dataType=n.dataType,this.referenceTo=n.referenceTo,this.relationshipName=n.relationshipName,this.type=n.type;break}}}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),g.LocatePartsMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.isenabled=null,i.radius=null,i.distanceUnit=null,i.locationtype=null,i.inventoryprocess=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){this.isenabled="string"==typeof this.__data.isenabled?"true"===this.__data.isenabled.toLowerCase():this.__data.isenabled,this.radius=parseInt(this.__data.radius),isNaN(this.radius)&&(this.radius=0),this.locationtype=this.__data.locationtype,this.distanceUnit=this.__data.distanceinunit,this.inventoryprocess=this.__data.inventoryprocess}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),g.PartDetailMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.fieldName=null,i.objectName=null,i.sequence=null,i.displayLabel=null,i.dataType=null,i.shouldShowLabel=!1,i.type=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){var e=this.__parent.__data.objectInfo.fields;this.fieldName=this.__data.fieldname,this.objectName=this.__data.objectname,this.sequence=this.__data.sequence,this.shouldShowLabel=!1,this.__data.showlabel=String(this.__data.showlabel).toLowerCase(),"true"===this.__data.showlabel&&(this.shouldShowLabel=!0);for(var t=0;t<e.length;t++){var n=e[t];if(n.name===this.fieldName){this.displayLabel=n.label,this.dataType=n.dataType,this.type=n.type;break}}}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),g.DownloadCriteriaMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.__includeSerializedStock=!1,i.__productStockStatus=null,i.__quantityField=null,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){this.__includeSerializedStock=this.__data.includeserializedstock,this.__productStockStatus=this.__data.productstockstatus,this.__quantityField=this.__data.quantityfield}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"getConfiguredStatus",value:function(){return this.__productStockStatus}}]),t}(v),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(10),v=n(0).utils,g=n(5).SVMXObject,y=function(){return v.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},S={name:"com.servicemax.client.mobileinventory.inventorydata"};S.InventoryData=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__data=e,n.__modifiedData=[],n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){for(var e=this,t=this.__data.length,n=0;n<t;n++){var i=this.__data[n],a=i.Id,r=i[v.getCustomFieldName("Location")],o=i[v.getCustomFieldName("Available_Qty")];o&&!Ext.isEmpty(o)||(i[v.getCustomFieldName("Available_Qty")]=0);var s=!0;if(i.stockSerial=[],this.__modifiedData.length>0){var l=m(this.__modifiedData).filter(function(t){return e.__modifiedData[t].Id===a&&e.__modifiedData[t][v.getCustomFieldName("Location")]===r});l.length>0&&(s=!1)}if(s){if("true"===i[v.getCustomFieldName("Enable_Serialized_Tracking")]){for(var l=m(this.__data).filter(function(t){return e.__data[t].Id===a&&e.__data[t][v.getCustomFieldName("Location")]===r&&e.__data[t].stockSerialId&&e.__data[t].stockSerialName&&"false"===e.__data[t].isStockSerialDeleted}),c=l.length,u=[],d=0;d<c;d++)u[d]=v.create("com.servicemax.client.mobileinventory.inventorydata.StockSerial",l[d]),u[d].initialize();i.stockSerial=u,i[v.getCustomFieldName("Available_Qty")]=u.length}s&&this.__modifiedData.push(i)}}}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),S.StockSerial=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__data=e,n.stockSerialId=null,n.stockSerialName=null,n.stockSerialTagValue=null,n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){this.stockSerialId=this.__data.stockSerialId,this.stockSerialName=this.__data.stockSerialName,this.stockSerialTagValue=y().T("FSA018_TAG036","Serial")}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),S.ProductStock=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__data=e,i.__fieldMap=n,i}return(0,p.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){}},{key:"doCleanup",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"getStockStatus",value:function(){return this.__data[v.getCustomFieldName("Status")]}},{key:"getTotalStockCount",value:function(){return this.__data[v.getCustomFieldName("Quantity2")]}},{key:"getQuantityForField",value:function(e){return this.__data[e]}},{key:"getDisplayLabelForQuantityField",value:function(e){for(var t="",n=this.__fieldMap.length-1;n>=0;n--){var i=this.__fieldMap[n];if(i.api_name===e){t=i.label;break}}return t}}]),t}(g),v.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(5).ModuleActivator,p=n(420).columnfactory,m={name:"com.servicemax.client.mobileinventory.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){m.init(),m.init(),m.init(),p.init(),m.init(),m.init(),m.init()}}]),t}(f),SVMX.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(18),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=(n(19).impl,{name:"com.servicemax.client.mobileinventory.ui.largemodern.inventorygridview"}),s=(r.getLoggingService().getLogger("sfmsearch-ui"),o.name);o.View=Ext.define(s+".MobileInventoryResultGrid",{extend:"com.servicemax.client.ui.components.modern.controls.impl.CollapsibleGrid",alias:"widget.mobileinventory.mobileinventoryresultgrid",ui:"svmx-default",showAnimation:null,hideAnimation:null,cls:"sfmsearch-svmx-sfmsearchresultgrid",initialHeightSet:!1,parentView:null,__lastExpandedRowInternalId:-1,__lastExpandedRowIdx:-1,config:{deferEmptyText:!0},__calledSetEmptyFromOutside:!1,__skipSetEmptyFromOutside:!1,constructor:function(e){e=e||{},e.initialTitle=e.title||"",e.parentView&&(this.parentView=e.parentView),this.callParent(arguments)},mixins:["Ext.mixin.Responsive"],plugins:["responsive"],bufferSize:0,controller:"mobileinventory.MobileInventoryhResultController",itemConfig:{viewModel:"mobileinventory.MobileInventoryResultViewModel",body:{tpl:new Ext.XTemplate('<tpl if="stockSerial.length &gt; 0">','<div class="productSerialTopBorder"></div>','<tpl for="stockSerial">','<div class="productSerialContainer" data-id="{stockSerialId}" data-value="{stockSerialName}"><span class="productSerialTitle">{stockSerialTagValue}&nbsp;:&nbsp;</span><span class="productSerialLabel">{stockSerialName}</span></div>',"</tpl>","</tpl>"),cls:"collapsed"}},layout:"fit",autoHeight:!0,listeners:{itemtap:{fn:"onItemTap"}},initialize:function(){this.callParent(),this.addListener("resize",this.__onWidthChange,this),this.addListener("columnsort",this.__updateExpandedStateAfterSort,this)},__onWidthChange:function(e,t,n,i){if(window.cordova&&this.hasLoadedStore&&this._columns.length>4){this.__setGridMinHeight();var r=this._columns.length,o="object"===(0,a.default)(screen.orientation)&&screen.orientation.type?screen.orientation.type:screen.orientation;"unlocked"===o&&window.matchMedia("(orientation: portrait)").matches&&(o="portrait-primary"),"portrait-primary"===o||"portrait-secondary"===o?this.getColumns()[r-2].setHidden(!0):this.getColumns()[r-2].setHidden(!1),this.__calledSetEmptyFromOutside||(this.__skipSetEmptyFromOutside=!0,this.setEmptyText(this.__getEmptyText()),this.__skipSetEmptyFromOutside=!1)}},__setGridMinHeight:function(){"IPAD"===r.getClientTypeForUnifiedApp()&&this.parentView&&this.parentView.el&&this.setMinHeight(this.parentView.el.getHeight()-32)},setEmptyText:function(e){this.__skipSetEmptyFromOutside||(this.__calledSetEmptyFromOutside=!0),this.callParent(arguments)},__getEmptyText:function(){for(var e=this,t=[],n=e.getColumns(),i=n.length,a=0;a<i-1;a++)n[a].getHidden()||t.push(n[a].getText());return"Search for Part by "+t.join(", ")},doDestroy:function(){this.removeListener("resize",this.__onWidthChange,this),this.removeListener("columnsort",this.__updateExpandedStateAfterSort,this),this.store&&this.store.destroy();var e=this.getController();e&&e.destroy();var t=this.getItemConfig();t&&t.body&&t.body.tpl&&t.body.tpl.destroy(),this.config&&this.config.store&&(this.config.store.destroy(),this.config=null),this.callParent()},toggleRow:function(e){var t=this,n=t.listItems[e].getRecord().internalId;-1===t.__lastExpandedRowInternalId?(t.__expandRow(e),t.__lastExpandedRowInternalId=n,t.__lastExpandedRowIdx=e):t.__lastExpandedRowInternalId===n?(t.__collapseRow(e),t.__lastExpandedRowInternalId=-1,t.__lastExpandedRowIdx=-1):(t.__collapseRow(t.__lastExpandedRowIdx),t.__expandRow(e),t.__lastExpandedRowInternalId=n,t.__lastExpandedRowIdx=e)},__expandRow:function(e){var t=this,n=t.listItems[e];if(n){var i=Ext.fly(n.bodyElement).query(".x-rowbody.x-component");i&&i.length>0&&(i=i[0],i.classList.contains("collapsed")&&i.classList.remove("collapsed"));var a=n.cells[0],r=Ext.fly(a.element).query(".icon-chevron-right");r&&r.length>0&&(r=r[0],r.classList.contains("icon-chevron-right")&&(r.classList.remove("icon-chevron-right"),r.classList.add("icon-chevron-down")));var o=Ext.fly(a.element).query(".x-button");if(o&&o.length>0){o=o[0];var s=o.id,l=Ext.getCmp(s);l&&(l._iconCls="icon-chevron-right")}}},__collapseRow:function(e){var t=this,n=t.listItems[e];if(n){var i=Ext.fly(n.bodyElement).query(".x-rowbody.x-component");i&&i.length>0&&(i=i[0],i.classList.contains("collapsed")||i.classList.add("collapsed"));var a=n.cells[0],r=Ext.fly(a.element).query(".icon-chevron-down");r&&r.length>0&&(r=r[0],r.classList.contains("icon-chevron-down")&&(r.classList.remove("icon-chevron-down"),r.classList.add("icon-chevron-right")));var o=Ext.fly(a.element).query(".x-button");if(o&&o.length>0){o=o[0];var s=o.id,l=Ext.getCmp(s);l&&(l._iconCls="icon-chevron-right")}}},__updateExpandedStateAfterSort:function(){var e=this;if(-1!=e.__lastExpandedRowIdx){for(var t=-1,n=e.listItems.length,i=n-1;i>=0;i--){e.listItems[i].getRecord().internalId===e.__lastExpandedRowInternalId&&(t=i),e.__collapseRow(i)}-1!=t&&(e.__expandRow(t),e.__lastExpandedRowIdx=t)}},getLastExpandedRowInternalId:function(){return this.__lastExpandedRowInternalId}}),Ext.define(s+".viewmodel.MobileInventoryResultViewModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.mobileinventory.MobileInventoryResultViewModel"}),Ext.define(s+".view.MobileInventoryhResultController",{extend:"Ext.app.ViewController",alias:"controller.mobileinventory.MobileInventoryhResultController",init:function(){},onItemTap:function(e,t,n,i,a,o){if(e.parentView){var s=this,l=s.__isClickOnSerializedProduct(a.target);e.parentView.showViewInDialog({view:"partdetailview",options:{record:i.data,deliveryEngine:e.parentView._deliveryEngine,activeTab:e.parentView.activeTab,isConnected:e.parentView.__isConnected,serialDetails:l}}),r.doLater(function(){e.deselectAll()})}},__isClickOnSerializedProduct:function(e){var t=null,n=e;do{if(n.classList.contains("productSerialContainer")){t={stockSerialId:n.dataset.id,stockSerialName:n.dataset.value};break}n=n.parentElement}while(n&&!n.classList.contains("x-listitem"));return t}}),r.defineGlobal(o.name,o),e.exports=o},function(e,t,n){var i=n(0).utils,a=n(22).View,r={name:"com.servicemax.client.mobileinventory.ui.largemodern.partdetailview"},o=(i.getLoggingService().getLogger("mobileinventory-ui"),n(89).ConnectionUtil),s=n(11).Facade,l=n(10),c=r.name,u=a,d=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};r.View=Ext.define(c+".PartDetailView",{extend:u,alias:"widget.mobileinventory.partdetailview",layout:"fill",config:{halign:"center"},width:"100%",height:"100%",cls:"partDetailView-container",mixins:["Ext.mixin.Responsive"],plugins:["responsive"],__record:null,__deliveryEngine:null,__productStockDetails:null,__productSerialDetails:null,__activeTab:null,__isConnected:null,constructor:function(e){e=e||{},e.deliveryEngine&&(this.__deliveryEngine=e.deliveryEngine),this.callParent(arguments)},getDialogConfig:function(){return{hideOnMaskTap:!1}},doDestroy:function(){this.__productStockDetails&&(this.__productStockDetails.length=0),this.callParent(arguments)},ready:function(){var e=this;e.blockApplication(e.getViewLoadMask());var t=i.create("com.servicemax.client.sfmconsole.utils.EventCollection",e.__deliveryEngine.getEventBus(),[i.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_PRODUCT_STOCK",e,{request:{productId:e.__record.Id,engine:e.__deliveryEngine}})]);e.__deliveryEngine.getMetaModel().attachmentFileNameField&&t.addEvent(i.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_PRODUCT_IMAGE",e,{request:{product:e.__record,engine:e.__deliveryEngine}})),t.triggerAll(function(t){for(var n=t.items(),i=n.length,a=0;a<i;a++){var r=n[a];"MOBILEINVENTORY.GET_PRODUCT_IMAGE"==r.type()&&(e.__record.productImagePath=r.response)}for(var o=0;o<i;o++){var s=n[o];if("MOBILEINVENTORY.GET_PRODUCT_STOCK"==s.type()){e.__productStockDetails=l.isArray(s.response)?s.response.slice(0):s.response;var c=e.__getContentItems();e.add(c);var u=document.getElementsByClassName("partDetailView-part-label");if(u&&u.length>0)for(var d=u.length-1;d>=0;d--){var _=u[d],h=_.previousElementSibling;h&&h.classList.contains("partDetailView-part-label-title")&&(_.style.width="calc(100% - "+h.clientWidth+"px)")}e.unblockApplication();break}}},e)},setOptions:function(e){var t=this;e&&(t.__isConnected=e.isConnected),e.record&&(t.__record=e.record),e.serialDetails&&(t.__productSerialDetails=e.serialDetails),e.activeTab&&(t.__activeTab=e.activeTab),this.callParent(arguments)},getViewLoadMask:function(){return{xtype:"svmx.loadmask",transparent:!1,indicator:!1,message:"",cls:"loadmask-sfmdelivery-animation",html:'<style>.timeline-wrapper {width: 100%;display: table;position: absolute;}.timeline-wrapper-row {width: 100%;display: table-row;padding: 12px;position: relative;}@keyframes placeHolderShimmer {0% {background-position: -468px 0}100% {background-position: 468px 0}}.animated-background-right-panel-topics {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #cccccc 8%, #aaaaaa 18%, #cccccc 33%);background-size: 800px 104px;height: 20px;position: relative;width: 150px;margin-left: 5px;}.animated-background-right-field-label {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 10px;position: relative;width: 90px;margin-left: 5px;}.animated-background-right-field-value {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 10px;position: relative;width: 210px;margin-left: 5px;}.left-picture {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 100px;position: absolute;width: 100px;left: 5px;z-index: 1000;}.background-masker-left-panel-labels {background: #fff;height: 31px;position: relative;}.background-masker-left-panel-top-padding {background: #fff;position: relative;left: 0px;height: 16px;}.background-masker-left-panel-remaining {background: #fff;position: relative;height: 2000px;}.background-masker-right-panel-field {background: #fff;height: 9px;position: relative;}.background-masker-right-panel-field-label-value {background: #fff;height: 4px;position: relative;}.panel-header {background-color: #f4f1f0;background-image: none;color: #333;border: 0 solid #005cb9;height: 39px;}.background-masker-right-panel-annimation {height: 10px;background-color: #f4f1f0;position: relative;}.hr {border: 0;border-top: 1px solid #b0b0b0;height: 0;background: #b0b0b0;}.field-label {height: 22px;}.field-component {background: #fff;height: 50px;width: 100%;display: table;}.field-component-row {width: 100%;height: 50%;display: table-row;}.field-component-cell-left {width: 50%;display: table-cell;}.field-component-cell-right {display: table-cell;width: 50%;margin-left: 50%;}</style><div class="timeline-wrapper"><div class="timeline-wrapper-row"><div><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="left-picture"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div></div></div></div>'}},__getContentItems:function(){var e=this,t=[];return t.push({xtype:"svmx.toolbar",width:"100%",height:40,docked:"top",ui:"svmx-toolbar-grey",cls:"partDetailView-header",title:d().T("FSA018_TAG018","Part Detail"),style:"text-align:center",items:e.__getToolbarItems()}),t.push({xtype:"svmx.horizontalpanel",width:"100%",cls:"partDetailView-content",items:e.__getDetailItems()}),e.__productHasQuantityDetails()&&t.push(e.__buildProductQuantityDetails()),t},__getDetailItems:function(){var e=[],t=this,n=t.__getProductImage();return n&&e.push({xtype:"svmx.panel",items:[{xtype:"svmx.panel",items:[{xtype:"svmx.image",src:n,width:150,height:150,margin:"15 5 15 15",style:"background-size: contain;"}]}]}),e.push({xtype:"svmx.verticalpanel",flex:1,width:"100%",cls:"partDetailView-text-content",items:t.__buildProductDetails()}),e},__getProductImage:function(){return this.__record.productImagePath?this.__record.productImagePath:null},__getToolbarItems:function(){return[this.__getCancelButton(),{docked:"right",xtype:"svmx.button",html:"Cancel",style:"opacity:0",ui:"svmx-toolbar-btn"}]},__getCancelButton:function(){return{docked:"left",xtype:"svmx.button",html:d().T("FSA018_TAG032","Close"),handler:i.proxy(this,"__cancel"),ui:"svmx-toolbar-btn",cls:"partDetailView-close-btn",itemId:"toolbarCancelButton"}},__buildProductDetails:function(){var e=this,t=[],n=e.__getProductDetails();if(n){e.__canDoStockTransfer()?t.push(e.__getStockTransferButton()):e.__canLocatePart()&&t.push(e.__getLocatePartButton());for(var i=n.detailConfiguration.length,a=0;a<i;a++){var r=n.detailConfiguration[a],o={xtype:"svmx.horizontalpanel",docked:"top",items:[]};r.title&&r.title.length>0&&o.items.push({xtype:"svmx.label",text:r.title+":",cls:"partDetailView-part-label-title",docked:"left"}),(r.label&&r.label.length>0||r.label&&"number"==typeof r.label)&&function(){var e=Ext.widget("svmx.label",{html:r.label,cls:"partDetailView-part-label",docked:"left"});setTimeout(function(){l("#"+e.id).click(function(e){var t=e.target;(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)&&(t.style.maxHeight="2000px",t.style["-webkit-line-clamp"]="inherit",t.style["white-space"]="inherit")})},500),o.items.push(e)}(),0==a&&(o.cls="partDetailView-part-title"),t.push(o)}}return t},__getStockTransferButton:function(){var e=this,t=e.__record[i.getCustomFieldName("Available_Qty")],n=!1;return(t<=0||!e.__isConnected)&&(n=!0),{xtype:"svmx.panel",cls:"partDetailView-top-btn-container",docked:"top",items:[{xtype:"svmx.button",text:d().T("FSA018_TAG005","Transfer"),docked:"right",itemId:"stockTransferButtonId",cls:"partDetailView-transfer-btn",disabled:n,minHeight:36,handler:i.proxy(this,"__transferHandler")}]}},__getLocatePartButton:function(){var e=this;return{xtype:"svmx.panel",cls:"partDetailView-top-btn-container",docked:"top",items:[{xtype:"svmx.button",text:d().T("FSA018_TAG019","Locate"),docked:"right",cls:"partDetailView-locate-btn",disabled:!e.__isConnected,minHeight:36,handler:i.proxy(this,"__locatePartHandler")}]}},__buildProductQuantityDetails:function(){var e=this,t={xtype:"svmx.verticalpanel",cls:"partDetailView-options",items:[]};t.items.push({xtype:"svmx.panel",cls:"partDetailView-quantity-title",height:26,items:[{xtype:"svmx.label",text:d().T("FSA018_TAG020","Quantity Details")}]});var n=e.__getProductQuantityDetails(),i=n.length;if(n&&i>0)for(var a=0;a<i;a++){var r=n[a],o=r.total;r.quantity&&r.quantityLabel&&(o+=" ("+r.quantity+" "+r.quantityLabel+")");var s={xtype:"svmx.verticalpanel",cls:"partDetailView-quantity",items:[{xtype:"svmx.label",text:r.status},{xtype:"svmx.label",text:o}]};t.items.push(s)}else t.items=[];return t},__cancel:function(){this.done()},__transferHandler:function(){var e=this;e.done(),this.showViewInDialog({view:"stocktransferview",options:{deliveryEngine:e._deliveryEngine,record:e.__record,serialDetails:e.__productSerialDetails}})},__locatePartHandler:function(){var e=this,t=function(e){var t={text:e,type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};i.getCurrentApplication().showMessage(t)};i.getCurrentApplication().showSpinner(e);var n=[e.__getUserCurrentLocation().promise(),e.__getConnectivityStatus().promise()],a=i.when(n);a.done(function(){var t=arguments[0];e.done(),e.changeView({view:"locatepartmapview",options:{record:e.__record,deliveryEngine:e.__deliveryEngine,location:t.location}})}),a.fail(function(e){t(e)}),a.always(function(){i.getCurrentApplication().hideSpinner(e)})},__getConnectivityStatus:function(){var e=i.Deferred();return o.checkConnectivity().then(function(t){"true"===t.toLowerCase()?e.resolve():e.reject(d().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."))}),e},__getUserCurrentLocation:function(){var e=this,t=i.Deferred(),n=s.createLocationTrackingRequest();return n.bind("REQUEST_COMPLETED",function(n){if(n.data.success){var a=i.toObject(n.data.data);a.hasOwnProperty("location")&&a.location.hasOwnProperty("lat")&&(a.location.lat=parseFloat(a.location.lat)),a.hasOwnProperty("location")&&a.location.hasOwnProperty("lng")&&(a.location.lng=parseFloat(a.location.lng)),a.success=!0,t.resolve(a)}else e.logger.info("unable to find current location"),t.reject(d().T("FSA010_TAG022","<b>Allow this application to track your location.</b>"))},this),n.bind("REQUEST_ERROR",function(e){t.reject(d().T("FSA010_TAG022","<b>Allow this application to track your location.</b>"))},this),n.execute(),t},__getProductDetails:function(){for(var e=this,t=[],n=e.__deliveryEngine.getMetaModel(),i=n.partDetailInfo.fields.length,a=0;a<i;a++){var r=n.partDetailInfo.fields[a],o={title:"",label:""};r.shouldShowLabel&&a>0&&(o.title=r.displayLabel),e.__record[r.fieldName]&&(o.label=e.__record[r.fieldName],e.__record[r.fieldName]=e.__record[r.fieldName]),t.push(o)}return e.__productSerialDetails&&e.__productSerialDetails.stockSerialId&&e.__productSerialDetails.stockSerialName&&t.length>=1&&t.splice(1,0,{title:"Serial",label:e.__productSerialDetails.stockSerialName}),{detailConfiguration:t}},__canDoStockTransfer:function(){var e=this.__activeTab&&"trunkstock"===this.__activeTab&&this.__deliveryEngine.getMetaModel().locatePartInfo.inventoryprocess;return e&&"true"===this.__record[i.getCustomFieldName("Enable_Serialized_Tracking")]&&(e=void 0!==this.__productSerialDetails&&null!==this.__productSerialDetails),e},__canLocatePart:function(){return this.__activeTab&&"catalog"===this.__activeTab&&this.__deliveryEngine.getMetaModel().locatePartInfo.isenabled},__productHasQuantityDetails:function(){return!(this.__productSerialDetails&&this.__productSerialDetails.stockSerialId&&this.__productSerialDetails.stockSerialName)},__getProductQuantityDetails:function(){for(var e=[],t=this,n=t.__deliveryEngine.getMetaModel().downloadCriteriaInfo,i=n.length,a=i-1;a>=0;a--)for(var r=n[a],o=t.__productStockDetails.length,s=o-1;s>=0;s--){var l=t.__productStockDetails[s],c=l.getStockStatus();if(c.toLocaleLowerCase()===r.__productStockStatus.toLocaleLowerCase()&&c.toLocaleLowerCase()===r.__productStockStatus.toLocaleLowerCase()){var u=l.getTotalStockCount();if(u&&u>0){var d={status:c,total:u};r.__quantityField&&l.getQuantityForField(r.__quantityField)>0&&(d.quantity=l.getQuantityForField(r.__quantityField),d.quantityLabel=l.getDisplayLabelForQuantityField(r.__quantityField)),e.push(d)}}}return e.reverse()}}),i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(10),a=n(0).utils,r=n(12).DatetimeUtil,o={name:"com.servicemax.client.mobileinventory.ui.largemodern.api.columnfactory"},s=o.name;Ext.define(s+".ColumnFactory",{alias:"mobileinventory.columnfactory",constructor:function(e){this.uiConfig=e.uiConfig,this.index=e.index,this.fld=e.fld,this.__shouldCreateExpander=!!e.shouldCreateExpander&&e.shouldCreateExpander},createColumn:function(e){var t=void 0;switch(e){case"DATETIME":t=new c({fld:this.fld,uiConfig:this.uiConfig,objectName:this.fld.objectname,index:this.index,timeColumn:!0});break;case"DATE":t=new u({fld:this.fld,uiConfig:this.uiConfig,objectName:this.fld.objectname,index:this.index});break;case"TEXT":t=new d({fld:this.fld,uiConfig:this.uiConfig,index:this.index,shouldCreateExpander:this.__shouldCreateExpander});break;case"TEMPLATE":t=new l({fld:this.fld,uiConfig:this.uiConfig,index:this.index});break;case"CUSTOMTEXT":t=new _({fld:this.fld,uiConfig:this.uiConfig,index:this.index})}return t}});var l=function(e){var t={columnObj:e,cls:"info-icon-column",cell:{xtype:"widgetcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner sfmsearch-info-icon-cell",widget:{xtype:"button",cls:"sfmsearch-info-icon-button",iconCls:"icon-chevron-right",bind:{handler:"onInfoColumnClicked"}}}};return t=Ext.apply(t,e.uiConfig)},c=function(e){var t={columnObj:e,cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},timeColumn:e.timeColumn,renderer:function(e,t,n,i,a){var o="";if(e){var s=r.convertToTimezone(e);o=r.getFormattedDatetime(s)}else o="";return o}};return t=Ext.apply(t,e.uiConfig)},u=function(e){var t={columnObj:e,cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},renderer:function(e,t,n,i,a){return e?r.getFormattedDatetime(e,r.getDefaultDateFormat()):""}};return t=Ext.apply(t,e.uiConfig)},d=function(e){var t={cell:{xtype:"gridcell",cls:"sfmsearch-grid-cell",innerCls:"sfmsearch-grid-cell-inner",encodeHtml:!1},columnObj:e,renderer:function(t,n,i,r,o){var s=Ext.String.htmlEncode(n.get(e.fld.fieldName)),l=s,c=Ext.id();if(e.shouldCreateExpander&&0===o.columnObj.index&&"true"===n.data[a.getCustomFieldName("Enable_Serialized_Tracking")]&&n.data.stockSerialId){var u=r.getParent().getGrid().getLastExpandedRowInternalId()===r.getParent().getRecord().internalId;return h(l,c,r,u),Ext.String.format('<div id="{0}"> </div>',c,r)}return l}};return t=Ext.apply(t,e.uiConfig)},_=function(e){var t={cell:{xtype:"gridcell",cls:"stock-transfer-grid-cell",encodeHtml:!1},columnObj:e,renderer:function(t,n,i,r,o){var s=Ext.id(),l=Ext.String.htmlEncode(n.get(e.fld.fieldName)),c=l,u=void 0,d=n.data[a.getCustomRelationName("Service_Territory")],_=n.data[a.getCustomRelationName("Service_Group")];return d&&(u=d.Name),!u&&_&&(u=_.Name),u&&u.length>0?Ext.String.format('<div id="{0}"><div class="grid-title">{1}</div><div class="grid-label"> {2} </div></div>',s,c,u):Ext.String.format('<div id="{0}"><b style="font-size:18px">{1}</b></div>',s,c)}};return t=Ext.apply(t,e.uiConfig)},h=function(e,t,n,a){return Ext.defer(function(){Ext.widget("button",{renderTo:t,__parentCell:n,cls:"sfmsearch-info-icon-button",iconCls:a?"icon-chevron-down":"icon-chevron-right",handler:function(e,t){var n=this;t.stopPropagation();var a=n._iconCls,r=a;r="icon-chevron-right"===a?"icon-chevron-down":"icon-chevron-right",n._iconCls=r,i("#"+n.iconElement.id)[0].classList.remove(a),i("#"+n.iconElement.id)[0].classList.add(r);var o=n.__parentCell.getParent(),s=o.getGrid();s&&s.toggleRow&&s.toggleRow(o.$dataIndex)}}),document.getElementById(t).innerHTML+=e},50)};a.defineGlobal(o.name,o),e.exports=o},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g={name:"com.servicemax.client.mobileinventory.ui.largemodern.mystock"},y=function(){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};g.MyStock=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__deliveryEngine=e.deliveryEngine,n.__parentContext=e.context,n.__utilsObject=m.create("com.servicemax.client.mobileinventory.ui.largemodern.utils.Utils",{}),n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"performTrunkStockSearch",value:function(e){m.getCurrentApplication().hideSpinner(),m.getCurrentApplication().showSpinner();var t=this,n=null,i=null,a=null,r=t.__getSearchDetails(),o=t.__parentContext.down("#searchBarTrunkStock"),s=this.__parentContext.maximumLocalRecordsToQuery;o&&(a=o.getComponent("mobileInventoryoperator").getValue(),i=o.getComponent("mobileInventorykeyWord").getValue());var l=this.getTrunkStockSearchCriteriaInfo();l&&t.saveSearchCriteriaInfo(l),e&&(a=e.operator,i=e.keyWord,s=e.recordLimit,o&&(o.getComponent("mobileInventoryoperator").setValue(e.operator),o.getComponent("mobileInventorykeyWord").setValue(e.keyWord)));for(var c=this.__deliveryEngine.getMetaModel().partDetailInfo.fields,u=[],d=c.length-1;d>=0;d--){for(var _=c[d],h=!1,f=r.length-1;f>=0;f--){var p=r[f];if(p.fieldName===_.fieldName&&p.objectname===_.objectName){h=!0;break}}h||u.push(_)}u.length>0&&(r=r.concat(u)),n={context:this,KeyWord:Ext.isEmpty(i)?"":i,Operator:Ext.isEmpty(a)?"Contains":a,RecordLimit:s,fields:r,handler:this.onTrunkSearchResultComplete};var v=m.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_TRUNK_STOCK_SEARCH_RESULTS",this,{request:n});this.__deliveryEngine.getEventBus().triggerEvent(v)}},{key:"saveSearchCriteriaInfo",value:function(e){this.__utilsObject.storeStateInCache("INVENTORY_TRUNK_STOCK_SEARCH_INFO",e)}},{key:"onTrunkSearchResultComplete",value:function(e){var t=this;m.getCurrentApplication().hideSpinner();var n=t.__getSearchDetails();if(t.__createTrunkStockListView(e,n),e&&0==e.length){var i=t.__parentContext.down("#trunkstock");i&&i.setEmptyText(y().T("FSA004_TAG013","No records to display."))}}},{key:"getTrunkStockSearchCriteriaInfo",value:function(){var e=this,t=null,n=null,i=null,a=e.__parentContext.down("#searchBarTrunkStock"),r=this.__parentContext.maximumLocalRecordsToQuery;return a&&(n=a.getComponent("mobileInventoryoperator").getValue(),i=a.getComponent("mobileInventorykeyWord").getValue()),e.__parentContext.down("#trunkstock")&&(t={operator:n,keyWord:i,recordLimit:r}),t}},{key:"__getSearchDetails",value:function(){return this.__deliveryEngine.getMetaModel().layoutInfo.partsfields}},{key:"__createTrunkStockListView",value:function(e,t){var n=this,n=this,i=t,a=i.length,r=[],o=[],s=void 0;n.displayFieldWithSeq=[],n.fieldNameForOnline=[],n.displayFieldWithSeq.push("Id");for(var l=m.getCustomFieldName("Available_Qty"),c=0;c<a;c++){s=i[c];var u=s.fieldName;n.displayFieldWithSeq.push(u);var d=this.__utilsObject.getFieldType(s),_={name:s.fieldName,type:d,reference:""};o.push(_),r[c]=this.__utilsObject.createListViewColumnDefinition(s,{text:s.displayLabel,flex:1,align:"left",tooltip:s.displayLabel,hidden:c>=4,dataIndex:s.fieldName},c,!0)}a+=1,r.push(this.__utilsObject.getQuantityColumn(a)),o.push({name:l,type:"number",reference:""});var h=n.__parentContext.down("#trunkstock"),f=null;h&&(h.getStore().removeAll(),h.getStore().destroy(),h.destroy()),f||(f=Ext.create("Ext.data.Store",{fields:o,autoLoad:!1,storeId:"trunkstock",gridId:"trunkstock",stateful:!0,data:{searchResults:[]},pageSize:100,proxy:{type:"memory",enablePaging:!0,reader:{type:"json",rootProperty:"searchResults"}}})),n.__refreshTrunkStockGridData({gridId:"trunkstock",columns:r,store:f});var p=f.proxy,v=p.reader;p.data[v._rootProperty]=e,f.totalCount=Number(e.length),p.data.total=Number(e.length),f.currentPage=1,f.removeAll(),f.setData(e),f.load(),(h=n.__parentContext.down("#trunkstock"))&&(h._store=f,h.refresh(),n.__parentContext.showOrHidePaginationBottomBar())}},{key:"__refreshTrunkStockGridData",value:function(e){var t=this,n={itemId:e.gridId,padding:"32px 0px 10px 0px !important",collapsible:!1,cls:"mobileInventory-collapsible-container",ui:"svmx-default",emptyText:y().T("FSA004_TAG013","No records to display."),store:e.store,columns:e.columns,infinite:!1,parent:t.__parentContext,parentView:t.__parentContext,autoHeight:!1},i=t.__parentContext.down("#trunkstock");t.__parentContext.down("#trunkstockPagingToolBar")||(n.pagingBarItemId="trunkstockPagingToolBar",n.plugins="svmxgridpagingtoolbar",n.pagingBarDockPosition="bottom",n.addToParent=!0);if(!i){var a=Ext.widget("mobileinventory.mobileinventoryresultgrid",n);t.__parentContext.trunkStockItemsContainer.add(a)}}},{key:"doCleanup",value:function(){var e=this.__parentContext.down("#trunkstock");if(e){var n=e.getStore();if(n){Ext.data.StoreManager.unregister(n);var i=n.proxy,a=i.getData();for(var o in a)delete a[o];a=null,i.destroy(),n.destroy(),n=null}e.destroy(),e=null}return this.setPropertyForCleanup("__utilsObject",!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g=n(421).Utils,y={name:"com.servicemax.client.mobileinventory.ui.largemodern.catalog"},S=function(){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};y.Catalog=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__deliveryEngine=e.deliveryEngine,n.__parentContext=e.context,n.__searchInProgress=!1,n.__utilsObject=new g({}),n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"loadGrid",value:function(){var e=this,t=e.__getSearchDetails();e.__createCatalogListView(t)}},{key:"performCatalogSearch",value:function(e){var t=this;if(!t.__searchInProgress){var n={context:t,KeyWord:e.keyWord,Operator:e.operator,deliveryEngine:t.__deliveryEngine,RecordLimit:e.recordLimit,handler:t.onCatalogSearchResultComplete},i=m.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_CATALOG_SEARCH_RESULTS",t,{request:n,responder:{result:function(e){t.onCatalogSearchResultComplete(e)},fault:function(){console.log("Error while searching in catalog.\n",arguments)}}});t.__deliveryEngine.getEventBus().triggerEvent(i),m.getCurrentApplication().hideSpinner(),m.getCurrentApplication().showSpinner(),t.__searchInProgress=!0}}},{key:"onCatalogSearchResultComplete",value:function(e){var t=this;if(t.__updateResults(e),e&&0==e.length){var n=t.__parentContext.down("#catalog");n&&n.setEmptyText(S().T("FSA004_TAG013","No records to display."))}t.__searchInProgress=!1,m.getCurrentApplication().hideSpinner()}},{key:"__getSearchDetails",value:function(){return this.__deliveryEngine.getMetaModel().layoutInfo.partsfields}},{key:"__createCatalogListView",value:function(e){var t=this,n=e,i=n.length,a=[],r=[],o=void 0;t.displayFieldWithSeq=[],t.fieldNameForOnline=[],t.displayFieldWithSeq.push("Id");for(var s=0;s<i;s++){o=n[s];var l=o.fieldName;t.displayFieldWithSeq.push(l);var c=t.__utilsObject.getFieldType(o),u={name:o.fieldName,type:c,reference:""};r.push(u),a[s]=t.__utilsObject.createListViewColumnDefinition(o,{text:o.displayLabel,flex:1,align:"left",tooltip:o.displayLabel,hidden:s>=4,dataIndex:o.fieldName},s,!1)}i+=1;var d=m.getCustomFieldName("Available_Qty");a.push(t.__utilsObject.getInStockColumn(i)),r.push({name:d,type:"string",reference:""});var _=Ext.create("Ext.data.Store",{fields:r,storeId:"catalog",gridId:"catalog",stateful:!0,data:{searchResults:[]},pageSize:100,proxy:{type:"memory",enablePaging:!0,reader:{type:"json",rootProperty:"searchResults"}}});t.__refreshCatalogGridData({gridId:"catalog",columns:a,store:_})}},{key:"__updateResults",value:function(e){var t=this,n=t.__parentContext.down("#catalog");if(n){var i=n._store,a=i.proxy,r=a.reader;a.data[r._rootProperty]=e,i.totalCount=Number(e.length),a.data.total=Number(e.length),i.currentPage=1,i.load(),t.__parentContext.showOrHidePaginationBottomBar()}}},{key:"__refreshCatalogGridData",value:function(e){var t=this,n=e.columns.map(function(e){return e.hidden?"":e.text});n.splice(-1,1),n=n.filter(function(e){return""!==e});var i={itemId:e.gridId,padding:"32px 0px 10px 0px !important",collapsible:!1,cls:"mobileInventory-collapsible-container",ui:"svmx-default",emptyText:S().T("FSA018_TAG011","Search for a part by")+" "+n.join(", "),store:e.store,columns:e.columns,infinite:!1,parent:t.__parentContext,parentView:t.__parentContext,autoHeight:!1},a=t.__parentContext.down("#catalog");t.__parentContext.down("#catalogPagingToolBar")||(i.pagingBarItemId="catalogPagingToolBar",i.plugins="svmxgridpagingtoolbar",i.pagingBarDockPosition="bottom",i.addToParent=!0);if(a)a._store=e.store,a.refresh();else{var r=Ext.widget("mobileinventory.mobileinventoryresultgrid",i);t.__parentContext.catalogItemsContainer.add(r)}}},{key:"doCleanup",value:function(){var e=this.__parentContext.down("#catalog");if(e){var n=e.getStore();if(n){Ext.data.StoreManager.unregister(n);var i=n.proxy,a=i.getData();for(var o in a)delete a[o];a=null,i.destroy(),n.destroy(),n=null}e.destroy(),e=null}return this.setPropertyForCleanup("__utilsObject",!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){var i=n(50),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(10),o=n(0).utils,s=n(22).View,l=n(7).SystemData,c=function(){return o.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},u={name:"com.servicemax.client.mobileinventory.ui.largemodern.stocktransferview"},d=l,_=(o.getLoggingService().getLogger("mobileinventory-ui"),u.name),h=s;u.View=Ext.define(_+".StockTransferView",{extend:h,alias:"widget.mobileinventory.stocktransferview",layout:"fill",config:{halign:"center"},width:"100%",height:"100%",cls:"stock-transfer-container",mixins:["Ext.mixin.Responsive"],plugins:["responsive"],__deliveryEngine:null,__record:null,__productSerialDetails:null,__selectedRecordIndex:null,__utilsObject:null,__selectedRecord:null,constructor:function(e){e=e||{},this.__deliveryEngine=e.deliveryEngine,this.__selectedRecordIndex=-1,this.__selectedRecord=null,this.__utilsObject=o.create("com.servicemax.client.mobileinventory.ui.largemodern.utils.Utils",{}),this.callParent(arguments)},getDialogConfig:function(){return{hideOnMaskTap:!1}},doDestroy:function(){var e=this.down("#stock-transfer-technician-grid");if(e){var t=e.getStore();t&&(t.removeAll(),t.destroy(),t=null),e.destroy(),e=null}this.__utilsObject&&this.__utilsObject.doCleanup(),this.callParent()},ready:function(){this.add(this.__getUIItems())},setOptions:function(e){e=e||{},this.__record=e.record,this.__productSerialDetails=e.serialDetails,this.callParent(arguments)},getViewLoadMask:function(){return{xtype:"svmx.loadmask",transparent:!1,indicator:!1,message:"",cls:"loadmask-sfmdelivery-animation",html:'<style>.timeline-wrapper {width: 100%;display: table;position: absolute;}.timeline-wrapper-row {width: 100%;display: table-row;padding: 12px;position: relative;}@keyframes placeHolderShimmer {0% {background-position: -468px 0}100% {background-position: 468px 0}}.animated-background-right-panel-topics {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #cccccc 8%, #aaaaaa 18%, #cccccc 33%);background-size: 800px 104px;height: 20px;position: relative;width: 150px;margin-left: 5px;}.animated-background-right-field-label {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 10px;position: relative;width: 90px;margin-left: 5px;}.animated-background-right-field-value {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 10px;position: relative;width: 210px;margin-left: 5px;}.left-picture {animation-duration: .8s;animation-fill-mode: forwards;animation-iteration-count: infinite;animation-name: placeHolderShimmer;animation-timing-function: linear;background: #f6f7f8;background: linear-gradient(to right, #eeeeee 8%, #dddddd 18%, #eeeeee 33%);background-size: 800px 104px;height: 100px;position: absolute;width: 100px;left: 5px;z-index: 1000;}.background-masker-left-panel-labels {background: #fff;height: 31px;position: relative;}.background-masker-left-panel-top-padding {background: #fff;position: relative;left: 0px;height: 16px;}.background-masker-left-panel-remaining {background: #fff;position: relative;height: 2000px;}.background-masker-right-panel-field {background: #fff;height: 9px;position: relative;}.background-masker-right-panel-field-label-value {background: #fff;height: 4px;position: relative;}.panel-header {background-color: #f4f1f0;background-image: none;color: #333;border: 0 solid #005cb9;height: 39px;}.background-masker-right-panel-annimation {height: 10px;background-color: #f4f1f0;position: relative;}.hr {border: 0;border-top: 1px solid #b0b0b0;height: 0;background: #b0b0b0;}.field-label {height: 22px;}.field-component {background: #fff;height: 50px;width: 100%;display: table;}.field-component-row {width: 100%;height: 50%;display: table-row;}.field-component-cell-left {width: 50%;display: table-cell;}.field-component-cell-right {display: table-cell;width: 50%;margin-left: 50%;}</style><div class="timeline-wrapper"><div class="timeline-wrapper-row"><div><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="left-picture"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div><div class="field-component-row"><div class="field-component-cell-right"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="panel-header"><div class="background-masker-right-panel-annimation"></div><div class="animated-background-right-panel-topics"></div><div class="background-masker-right-panel-annimation"></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div><div class="background-masker-right-panel-field"></div><div class="field-component"><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-label"></div></div></div><div class="field-component-row"><div class="field-component-cell-left"><div class="animated-background-right-field-value"></div></div></div></div></div></div></div>'}},__getUIItems:function(){var e=this,t=[];return t.push({xtype:"svmx.toolbar",width:"100%",height:40,docked:"top",ui:"svmx-toolbar-grey",cls:"partDetailView-header",title:c().T("FSA018_TAG006","Transfer Part"),style:"text-align:center",items:e.__getToolbarItems()}),t.push({xtype:"svmx.horizontalpanel",width:"100%",cls:"stock-transfer-content",padding:"10px",items:[{xtype:"svmx.panel",items:e.__buildProductDisplayFields()},{xtype:"svmx.panel",cls:"stock-transfer-quantity-panel",items:e.__getQuantityPanel()}]}),t.push({xtype:"svmx.horizontalpanel",width:"100%",layout:"hbox",cls:"stock-transfer-technician-panel",items:e.__getTechnicianSearchPanel()}),t},__getToolbarItems:function(){var e=this;return[e.__getCancelButton(),e.__getTransferButton()]},__getCancelButton:function(){return{docked:"left",xtype:"svmx.button",html:c().T("FSA016_TAG004","Cancel"),handler:o.proxy(this,"__cancelButtonTapped"),ui:"svmx-toolbar-btn",cls:"partDetailView-close-btn",itemId:"transferViewToolbarCancelButton"}},__getTransferButton:function(){return{docked:"right",xtype:"svmx.button",html:c().T("FSA018_TAG005","Transfer"),handler:o.proxy(this,"__transferButtonTapped"),ui:"svmx-toolbar-btn",cls:"partDetailView-close-btn",disabled:!0,itemId:"transferViewToolbarTransferButton"}},__buildProductDisplayFields:function(){var e=this,t=[],n=e.__getProductDisplayFields();if(n)for(var i=n.length,a=0;a<i;a++){var r=n[a],o={xtype:"svmx.horizontalpanel",docked:"top",items:[]};0!==a||"Name"!==r.displayLabel?(r.displayLabel&&r.displayLabel.length>0&&o.items.push({xtype:"svmx.label",text:r.displayLabel+": ",cls:"stock-transfer-display-label",docked:"left"}),r.dipsplayValue&&r.dipsplayValue.length>0&&o.items.push({xtype:"svmx.label",text:r.dipsplayValue,cls:"stock-transfer-display-value",docked:"left"}),t.push(o)):(o.items.push({xtype:"svmx.label",text:r.dipsplayValue,cls:"stock-transfer-display-label-title",docked:"left"}),t.push(o))}return t},__getQuantityPanel:function(e){var t=this;e=e||[];var n={xtype:"svmx.horizontalpanel",docked:"top",items:[]},i=t.__isProducSerialized();return n.items.push({xtype:"svmx.label",text:c().T("FSA018_TAG003","Quantity"),cls:"stock-transfer-qunantity-label"}),n.items.push({xtype:"svmx.button",text:"-",width:30,disabled:i,cls:"stock-transfer-qunantity-button",style:"margin: 0px 10px",handler:o.proxy(this,"__quantityLeftButtonTapped")}),n.items.push({xtype:"svmx.button",itemId:"stockTransferQuantityMiddleButton",text:"1",disabled:!0,width:36,cls:"stock-transfer-qunantity-middle-button",margin:"2 10 2 0"}),n.items.push({xtype:"svmx.button",text:"+",width:30,disabled:i,cls:"stock-transfer-qunantity-button",handler:o.proxy(this,"__quantityRightButtonTapped")}),e.push(n),e},__getProductDisplayFields:function(){var e=this,t=[],n={},i=this.__deliveryEngine.getMetaModel().layoutInfo.partsfields;i&&i.length>=2&&(n=i[1]);var a=e.__record.Name,r=e.__record[n.fieldName],o=null;return e.__productSerialDetails&&e.__isProducSerialized()&&(o=e.__productSerialDetails.stockSerialName,o=o&&o.length>0?o:"--"),a=a&&a.length>0?a:"--",r=r&&r.length>0?r:"--",t.push({displayLabel:"Name",dipsplayValue:e.__record.Name}),t.push({displayLabel:n.displayLabel,dipsplayValue:r}),e.__productSerialDetails&&e.__isProducSerialized()&&t.push({displayLabel:"Serial",dipsplayValue:o}),t},__getTechnicianSearchPanel:function(){var e=this,t=[],n={xtype:"svmx.verticalpanel",layout:"vbox",width:"100%",items:[]};return n.items.push({xtype:"svmx.label",text:c().T("FSA018_TAG007","Transfer To"),cls:"stock-transfer-transfer-to-label"}),n.items.push({xtype:"svmx.horizontalpanel",width:"100%",itemId:"stock-transfer-search-container",cls:"stock-transfer-search-container",items:e.__getSeachBar()}),n.items.push({xtype:"svmx.verticalpanel",width:"100%",items:e.__getGridPanel()}),t.push(n),t},__getSeachBar:function(){var e;return[(e={xtype:"textfield",ui:"svmx-default",cls:"mobileInventory-search-field",flex:1},(0,a.default)(e,"ui","svmx-default"),(0,a.default)(e,"itemId","stockTransferTextField"),(0,a.default)(e,"placeHolder",c().T("FSA004_TAG008","Search term")),e),{xtype:"svmx.button",text:c().T("FSA004_TAG011","Search"),cls:"stock-transfer-search-button",height:28,minWidth:76,handler:o.proxy(this,"__searchButtonTapped")}]},__getGridPanel:function(){var e=this,t=Ext.create("Ext.data.Store",{data:[],fields:["Name"]});return Ext.create("com.servicemax.client.ui.components.modern.controls.impl.CollapsibleGrid",{width:"100%",itemId:"stock-transfer-technician-grid",cls:"stock-transfer-grid",hideHeaders:!0,columns:e.__getGridColumns(),collapsible:!1,ui:"svmx-default",deferEmptyText:!0,emptyText:c().T("FSA004_TAG013","No records to display."),store:t,hidden:!0,infinite:!1,parent:e,scrollable:"y",listeners:{itemtap:o.proxy(this,"__handleItemTap"),resize:o.proxy(this,"__handleResize")},autoHeight:!1})},__getGridColumns:function(){var e=this,t=[];return t.push({xtype:"checkcolumn",cell:{xtype:"checkcell",innerCls:"icon-checkbox-circle",width:45,height:25,style:"padding: 0 10px"}}),t.push(e.__getCustomTextColumn()),t},__getCustomTextColumn:function(){var e={dataType:"CUSTOMTEXT",fieldName:"Name"};return this.__utilsObject.createListViewColumnDefinition(e,{flex:1,dataIndex:"Name"})},__handleResize:function(e,t,n){this.__setGridHeight()},__setGridHeight:function(){var e=this;e.down("#stock-transfer-technician-grid").el.dom.style.height=r(".stock-transfer-container").height()-e.down("#stock-transfer-search-container").el.dom.getBoundingClientRect().bottom+60+"px"},__handleItemTap:function(e,t,n,i,a,r){a.stopEvent();a.target.className;if("single"===e.getMode().toLowerCase()){var o="icon-checkbox-circle-checked",s=e.getItemAt(t),l=e.getColumns()[0],c=s?s.getCellByColumn(l):null;this.__selectedRecord=i;var u=this.down("#transferViewToolbarTransferButton");if(u&&(u?u.setDisabled(!1):u.setDisabled(!0)),-1===this.__selectedRecordIndex&&c)c.setInnerCls(o);else if(this.__selectedRecordIndex===t&&c)c.getInnerCls()!==o?c.setInnerCls(o):(c.setInnerCls("icon-checkbox-circle"),this.__selectedRecord=null,u?u.setDisabled(!0):u.setDisabled(!1));else if(this.__selectedRecordIndex!==t&&c){var d=e.getItemAt(this.__selectedRecordIndex),_=e.getColumns()[0],h=d.getCellByColumn(_);h.setInnerCls("icon-checkbox-circle"),c.setInnerCls(o)}this.__selectedRecordIndex=t}},__isProducSerialized:function(){return"true"===this.__record[o.getCustomFieldName("Enable_Serialized_Tracking")]},__cancelButtonTapped:function(){this.done()},__quantityLeftButtonTapped:function(){var e=this,t=e.down("#stockTransferQuantityMiddleButton"),n=t?t.getText():null;n&&(n=parseInt(n),n=1!==n?n-1:n,t.setText(n.toString()))},__quantityRightButtonTapped:function(){var e=this,t=e.down("#stockTransferQuantityMiddleButton"),n=t?t.getText():null,i=parseInt(e.__record[o.getCustomFieldName("Available_Qty")]);n&&(n=parseInt(n))<i&&(n+=1,t.setText(n.toString()))},__transferButtonTapped:function(){var e=this,t={},n=this.__deliveryEngine.getMetaModel().layoutInfo.partsfields;n&&n.length>=2&&(t=n[1]),this.__checkInternetConnectivity(0).done(function(){e.showViewInDialog({view:"transfercompletionview",options:{deliveryEngine:e.__deliveryEngine,partDisplayLabel:t.displayLabel,partDisplayValue:e.__record[t.fieldName],destinationTechName:e.__selectedRecord.data.Name,partName:e.__record.Name,stocktransferview:e,requestParams:e.__getStockTransferRequestParams()}}),e.done()}).fail(function(){e.__showConnectivityErrorMessage()})},__getStockTransferRequestParams:function(){var e=this,t=d.getUserInfo(),n=t&&t.UserTrunkDetail?t.UserTrunkDetail.Id:"",i=e.__selectedRecord&&e.__selectedRecord.data?e.__selectedRecord.data[o.getCustomFieldName("Inventory_Location")]:"",a=this.__deliveryEngine.getMetaModel().locatePartInfo.inventoryprocess,r=this.__record.Id,s=this.down("#stockTransferQuantityMiddleButton");return{sourceLocation:n,destinationLocation:i,inventoryProcess:a,productName:r,quantity:s?s.getText():"0",serialNumbers:e.__getSerialNumbers()}},__getSerialNumbers:function(){var e=null;if(this.__isProducSerialized())if(this.__productSerialDetails)e=this.__productSerialDetails.stockSerialName;else if(this.__record.stockSerial&&this.__record.stockSerial.length>0){for(var t=[],n=this.__record.stockSerial.length,i=0;i<n;i++)t.push(this.__record.stockSerial[i].stockSerialName);t.length>0&&(e=t.join())}return e},__searchButtonTapped:function(){var e=this;this.__checkInternetConnectivity(0).done(function(){e.__triggerTechnicianSearch()}).fail(function(){e.__showConnectivityErrorMessage()})},__triggerTechnicianSearch:function(){var e=this;e.blockApplication(e.getViewLoadMask());var t=e.down("#stockTransferTextField"),n=t?t.getValue():"",i={context:e,OnlineRecordLimit:"400",searchText:n},a=o.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_TECHNICIAN_RECORDS",this,{request:i,responder:{result:function(t){e.onTechnicianSearchComplete(t)},fault:function(t){e.onTechnicianSearchFailed(t)}}});e.__deliveryEngine.getEventBus().triggerEvent(a)},__showConnectivityErrorMessage:function(){var e={text:c().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available."),type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};o.getCurrentApplication().showMessage(e)},onTechnicianSearchComplete:function(e){var t=this;t.unblockApplication();var n=l;n&&n.getUserInfo()&&n.getUserInfo().UserTechId&&(e=e.filter(function(e){return e.Id!==n.getUserInfo().UserTechId}));var i=null,a=t.down("#stock-transfer-technician-grid");a&&(a.setHidden(!1),i=a.getStore(),i&&(i.load(),i.setData(e),a.setStore(i)),a.refresh())},onTechnicianSearchFailed:function(e){var t={text:e.error.error,type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};o.getCurrentApplication().showMessage(t),this.unblockApplication()},__getSynManager:function(){return o.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager").getInstance()},__checkInternetConnectivity:function(e){var t=o.Deferred(),n=this.__getSynManager();return n&&n.checkConnectivity({delay:e}).done(o.proxy(this,function(){t.resolve()})).fail(o.proxy(this,function(){t.reject()})),t.promise()}}),o.defineGlobal(u.name,u),e.exports=u},function(e,t,n){var i=n(0).utils,a=n(22).View,r=n(11).Facade,o=n(877),s=n(878),l=null,c=n(879),u=null,d=n(10),_=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},h={name:"com.servicemax.client.mobileinventory.ui.largemodern.locatepartmapview"},f=(i.getLoggingService().getLogger("mobileinventory-ui"),h.name),p=a;h.View=Ext.define(f+".LocatePartMapView",{extend:p,alias:"widget.mobileinventory.locatepartmapview",layout:"fill",mixins:["Ext.mixin.Responsive"],plugins:["responsive"],constructor:function(e){e=e||{},this.__mapAPI=null,this.__mapContainer=null,this.__radiusLabel=null,this.__radiusOverlay=null,this.__markers=null,this.__record=null,this.__deliveryEngine=null,this.__userLocation={lat:0,lng:0},this.__distanceUnit=null,this.callParent(arguments)},doDestroy:function(){google.maps.event.clearInstanceListeners(this.__radiusOverlay),google.maps.event.clearInstanceListeners(this.__mapAPI),google.maps.event.clearInstanceListeners(this.__infoWindow),this.__radiusOverlay&&this.__radiusOverlay.map&&(this.__radiusOverlay.setMap(null),this.__radiusOverlay=null),this.__radiusLabel&&this.__radiusLabel.map&&(this.__radiusLabel.setMap(null),this.__radiusLabel=null),this.__mapAPI&&(this.__mapAPI=null),this.__mapContainer&&(this.__mapContainer.destroy(),this.__mapContainer=null),i.array.forEach(this.__markers,function(e){e.doCleanup(),e=null}),this.__markers.length=0,this.callParent(arguments)},ready:function(){this.setViewInfo({windowTitle:_().T("FSA018_TAG021","Locate Part"),hideContextMenu:!0}),this.__createUI()},setOptions:function(e){var t=this;e.record&&(t.__record=e.record),e.deliveryEngine&&(t.__deliveryEngine=e.deliveryEngine),e.location&&(t.__userLocation=e.location),this.callParent(arguments)},__createUI:function(){var e=this,t=e.__createTopBar(),n=e.__mapContainer=e.__createMap();e.add({xtype:"svmx.verticalpanel",cls:"locatePartViewContainer",items:[t,n]})},__onMapLoaded:function(){var e=this;if(u=c.initialize(),l=s.initialize(),e.__mapAPI){setTimeout(function(){google.maps.event.trigger(e.__mapAPI,"resize")},100);var t=[e.__getUserCurrentLocation().promise(),e.__getSearchConfig().promise()];i.getCurrentApplication().showSpinner(e);var n=i.when(t);n.done(function(){var t=arguments[0],n=arguments[1];t&&t.success&&n&&n.success&&(e.__plotSearchRadius(n.searchRadius,n.searchUnit,t.location),e.__plotCurrentLocation(t.location),e.__searchForParts().done(function(t){e.__plotResultsOnMap(t)}).fail(function(e){var t=e.message?e.message:e.error&&e.error.error?e.error.error:_().T("FSA003_TAG006","Internet connectivity lost. Please retry when connectivity is available.");i.getCurrentApplication().getApplicationMessageUIHandler().showMessage({type:"INFO",text:t,buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"OK"}]})}).always(function(){i.getCurrentApplication().hideSpinner(e)}))}),n.fail(function(e){})}},__createTopBar:function(){return{xtype:"svmx.horizontalpanel",cls:"topBar",items:[{xtype:"svmx.panel",items:[{xtype:"svmx.label",text:this.__record&&this.__record.Name?this.__record.Name:""}]}]}},__createMap:function(){var e=this,t=Ext.widget("svmx.panel",{cls:"mapContainer"});return i.doLater(function(){e.__loadMap()}),t},__loadMap:function(){var e=this;if("undefined"!=typeof google&&google.maps&&void 0!==google.maps.geometry&&google.maps.geometry)e.__createMapAPI();else{var t=i.getClient().getApplicationParameter("device-info"),n="https://maps.googleapis.com/maps/api/js?client=gme-servicemaxinc&libraries=geometry&sensor=true&channel="+t["device-platform"].toLowerCase();i.cachedScript(n).done(i.proxy(e,e.__createMapAPI)).fail(function(){i.Msg.toast({text:_().T("FSA001_TAG002","Failed to load map script, maps will not work.")})})}},__createMapAPI:function(){var e={zoom:2,minZoom:2,center:new google.maps.LatLng(77.3,0),fullscreenControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"poi",stylers:[{visibility:"off"}]}]};this.__mapAPI=new google.maps.Map(this.__mapContainer.el.dom,e),this.__onMapLoaded()},__plotSearchRadius:function(e,t,n){var i=this,a=i.__mapAPI,r=e;a.setCenter(n),t=t.toLowerCase(),"miles"===t?e=1.60934*e*1e3:"kilometer"===t&&(e*=1e3),i.__distanceUnit="kilometer"===t?"km":t;var o=new google.maps.Circle({center:n,radius:e/2});a.fitBounds(o.getBounds());var s=i.__radiusOverlay=new l({center:a.getCenter(),map:a,radius:e,stroke_weight:0,fill_opacity:.2}),c=google.maps.geometry.spherical.computeOffset(s.getCenter(),s.getRadius()+10,0);google.maps.event.addListener(i.__radiusOverlay,"click",function(){i.__infoWindow&&i.__infoWindow.close()}),i.__radiusLabel=new u({map:a,position:c,text:_().T("FSA018_TAG022","Search Radius")+": "+r+" "+t})},__plotCurrentLocation:function(e){new google.maps.Marker({position:e,map:this.__mapAPI,icon:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/Map_Current_Location.svg"})},__plotResultsOnMap:function(e){var t=this,n=[],a=t.__mapAPI;t.__markers=n=t.__createMarkersForResults(e),0==t.__markers.length?i.Msg.alert({text:"No results found within the configured search radius.",buttons:[{text:_().T("FSA016_TAG003","OK"),itemId:"ok",ui:"svmx-button-square"}]}).done(i.proxy(this,function(e){t.done()})):i.array.forEach(n,function(e){e.setMap(a)})},__getUserCurrentLocation:function(){var e=this,t=i.Deferred();if(this.__userLocation)i.doLater(function(){t.resolve({success:!0,location:e.__userLocation})});else{var n=r.createLocationTrackingRequest();n.bind("REQUEST_COMPLETED",function(n){if(n.data.success){var a=i.toObject(n.data.data);a.hasOwnProperty("location")&&a.location.hasOwnProperty("lat")&&(a.location.lat=parseFloat(a.location.lat)),a.hasOwnProperty("location")&&a.location.hasOwnProperty("lng")&&(a.location.lng=parseFloat(a.location.lng)),a.success=!0,t.resolve(a)}else e.logger.info("unable to find current location"),t.reject()},this),n.bind("REQUEST_ERROR",function(e){t.reject(e)},this),n.execute()}return t},__getSearchConfig:function(){var e=i.Deferred(),t=this;if(t.__deliveryEngine){var n=t.__deliveryEngine.getMetaModel();n&&n.locatePartInfo&&setTimeout(function(){e.resolve({success:!0,searchRadius:n.locatePartInfo.radius,searchUnit:n.locatePartInfo.distanceUnit})},100)}else setTimeout(function(){e.reject()},100);return e},__searchForParts:function(){var e=i.Deferred(),t=this,n={context:t,productId:t.__record.Id,deliveryEngine:t.__deliveryEngine,latitude:t.__userLocation.lat,longitude:t.__userLocation.lng},a=i.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.GET_LOCATE_PART_SEARCH_RESULTS",t,{request:n,responder:{result:function(t){e.resolve(t)},fail:function(t){e.reject(t)}}});return t.__deliveryEngine.getEventBus().triggerEvent(a),e},__createMarkersForResults:function(e){for(var t=this,n=[],i=e.technician,a=e.warehouse,r=t.__infoWindow=new google.maps.InfoWindow,s=i.length-1;s>=0;s--){var l=i[s];l.distanceUnit=t.__distanceUnit,l.record=t.__record;var c=new o.TechnicianMarker(l);c.setInfoWindow(r),n.push(c)}for(var u=a.length-1;u>=0;u--){var _=a[u];_.distanceUnit=t.__distanceUnit,_.record=t.__record;var h=new o.WarehouseMarker(_);h.setInfoWindow(r),n.push(h)}return google.maps.event.addListener(t.__mapAPI,"click",function(){t.__infoWindow&&t.__infoWindow.close()}),google.maps.event.addListener(t.__infoWindow,"domready",function(){var e=d(".gm-style-iw");e.css({top:"17px"}),e.children(":nth-child(1)").css({overflow:"visible"});var t=e.prev();t.children(":nth-child(2)").css({display:"none"}),t.children(":nth-child(3)").css({"z-index":"1000"}),t.children(":nth-child(4)").css({display:"none"}),e.next().css({display:"none"})}),n}}),i.defineGlobal(h.name,h),e.exports=h},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(5).SVMXObject,v=n(0).utils,g=n(12).DatetimeUtil,y=n(11).Facade,S=function(){return v.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},E=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return n.__data=e,n.__gmapMarker=null,n.__lat=0,n.__lng=0,n.__title=null,n.__type=null,n.__infoWindowContent=null,n.__record=e.record,n.__distanceUnit=e.distanceUnit,n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"doCleanup",value:function(){this.__infoWindowContent&&(this.__infoWindowContent.destroy(),this.__infoWindowContent=null),this.__gmapMarker&&(this.__gmapMarker.setMap(null),this.__gmapMarker=null),this.__infoWindow&&(this.__infoWindow.setContent(null),this.__infoWindow=null),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"getType",value:function(){return this.__type}},{key:"getCoordinates",value:function(){return{lat:this.__lat,lng:this.__lng}}},{key:"getTitle",value:function(){return this.__title}},{key:"setMap",value:function(e){this.__gmapMarker&&this.__gmapMarker.setMap(e)}},{key:"setInfoWindow",value:function(e){this.__infoWindow=e}}]),t}(m),b=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments)),i=n;i.__type="Technician",i.__lat=i.__data.technician[v.getCustomFieldName("Latitude")],i.__lng=i.__data.technician[v.getCustomFieldName("Longitude")],i.__gmapMarker=new google.maps.Marker({position:i.getCoordinates(),icon:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/technician-map-icon.svg"}),i.__infoWindowContent=i.__createPopupContent();var a=window.external.getOauthCredentials?window.external.getOauthCredentials().session_id:v.getCurrentApplication().getUserInfo().UserSessionId;return v.ajax({type:"GET",contentType:"image/png",url:i.__data.technician[v.getCustomRelationName("Salesforce_User")].SmallPhotoUrl+"?auth_token="+a,context:n,headers:{Authorization:"OAuth "+a}}),google.maps.event.addListener(i.__gmapMarker,"click",function(){i.__infoWindow&&(i.__infoWindow.setContent(i.__infoWindowContent.element.dom),i.__infoWindow.open(i.__gmapMarker.getMap(),i.__gmapMarker))}),n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"doCleanup",value:function(){google.maps.event.clearInstanceListeners(this.__gmapMarker),google.maps.event.clearInstanceListeners(this.__infoWindow),this.__infoWindowContent&&(this.__infoWindowContent.destroy(),this.__infoWindowContent=null),this.__infoWindow&&(this.__infoWindow.setContent(null),this.__infoWindow=null),this.__gmapMarker&&(this.__gmapMarker.setMap(null),this.__gmapMarker=null),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"__getTechInitials",value:function(){var e=this.__data.technician.Name?this.__data.technician.Name:" ",t=e.charAt(0),n=e.split(" ");return n.length>1&&(t+=n[1].charAt(0)),t.toUpperCase()}},{key:"__createPopupContent",value:function(){var e=this,t=Ext.widget("svmx.panel",{cls:"popupContainer"}),n=window.external.getOauthCredentials?window.external.getOauthCredentials().session_id:v.getCurrentApplication().getUserInfo().UserSessionId,i=Ext.widget("svmx.horizontalpanel",{cls:"popupTopPanel",items:[{xtype:"svmx.panel",cls:"technicianImageContainer",items:[{xtype:"svmx.label",cls:"techInitials",text:e.__getTechInitials()},{xtype:"svmx.image",src:e.__data.technician[v.getCustomRelationName("Salesforce_User")].SmallPhotoUrl+"?auth_token="+n}]},{xtype:"svmx.verticalpanel",cls:"popupDetail",items:[{xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.label",html:'<span class="name">'+e.__data.technician.Name+"</span>",docked:"left",flex:.7},{xtype:"svmx.label",html:'<span class="qty">'+(e.__data.lstProductStck[0][v.getCustomFieldName("Quantity2")]?e.__data.lstProductStck[0][v.getCustomFieldName("Quantity2")]:"--")+"</span> "+S().T("FSA018_TAG026","units"),docked:"right",textAlign:"right",flex:.3,style:"font: 20px '-apple-system', Roboto, 'Segoe UI'; margin-top:-6px;"}]},{xtype:"svmx.label",html:e.__getAddressLineValue()},{xtype:"svmx.label",html:e.__getServiceTeamValue()}]}]}),a=Ext.widget("svmx.verticalpanel",{cls:"popupBottomPanel"});return a.add({xtype:"svmx.panel",cls:"divider"}),e.__canSendMessage()&&a.add({xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.button",cls:"messageIcon",handler:v.proxy(e,"__handleSendMessage")},{xtype:"svmx.button",cls:"buttonLabel",html:S().T("FSA018_TAG023","Send Message"),handler:v.proxy(e,"__handleSendMessage")}]}),e.__canMakeCall()&&a.add({xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.button",cls:"phoneIcon",handler:v.proxy(e,"__handleCall")},{xtype:"svmx.button",cls:"buttonLabel",html:S().T("FSA018_TAG024","Call")+" "+e.__data.technician[v.getCustomFieldName("Phone")],handler:v.proxy(e,"__handleCall")}]}),t.add(i),(e.__canMakeCall()||e.__canSendMessage())&&t.add(a),t}},{key:"__canSendMessage",value:function(){return this.__data.technician[v.getCustomFieldName("Phone")]&&!0}},{key:"__canMakeCall",value:function(){return this.__data.technician[v.getCustomFieldName("Phone")]&&!0}},{key:"__handleSendMessage",value:function(){var e=this;y.createSMSRequest().execute({phone:e.__data.technician[v.getCustomFieldName("Phone")],message:e.__getSMSContent()})}},{key:"__getSMSContent",value:function(){var e=this;return"Hi "+e.__data.technician.Name+": I need "+e.__record.Name+".\nCan you spare them?"}},{key:"__handleCall",value:function(){var e=this;y.createTELRequest().execute({phone:e.__data.technician[v.getCustomFieldName("Phone")]})}},{key:"__getAddressLineValue",value:function(){var e=this,t=e.__data.technician[v.getCustomFieldName("State")]?e.__data.technician[v.getCustomFieldName("State")]:"",n=e.__data.technician[v.getCustomFieldName("City")]?e.__data.technician[v.getCustomFieldName("City")]:"",i=e.__data.distance?e.__data.distance.toFixed(0):-1,a=e.__data.technician[v.getCustomFieldName("Latlong_Captured_On")]?S().T("FSA018_TAG027","updated")+" "+g.getFormattedDatetime(g.convertToTimezone(e.__data.technician[v.getCustomFieldName("Latlong_Captured_On")],g.getTimezoneOffset(),0),"DD/MM/YYYY hh:mm a"):"";return(t.length>0&&n.length>0?'<span class="address">'+n+", "+t+"</span>":"")+' <span class="distance">('+(-1!=i?i+" "+e.__distanceUnit+(a.length>0?" - ":""):"")+a+")</span>"}},{key:"__getServiceTeamValue",value:function(){var e=this,t="";return e.__data.technician[v.getCustomRelationName("Service_Group")]&&(t+='<span class="serviceTeam">'+e.__data.technician[v.getCustomRelationName("Service_Group")].Name+"</span><br/>"),e.__data.technician[v.getCustomRelationName("Service_Territory")]&&(t+='<span class="serviceTeam">'+e.__data.technician[v.getCustomRelationName("Service_Territory")].Name+"</span>"),t}}]),t}(E),T=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));n.__type="Warehouse",n.__lat=n.__data.location[v.getCustomFieldName("Latitude")],n.__lng=n.__data.location[v.getCustomFieldName("Longitude")],n.__gmapMarker=new google.maps.Marker({position:n.getCoordinates(),icon:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/warehouse-map-icon.svg"});var i=n;return i.__infoWindowContent=i.__createPopupContent(),google.maps.event.addListener(i.__gmapMarker,"click",function(){i.__infoWindow&&(i.__infoWindow.setContent(i.__infoWindowContent.element.dom),i.__infoWindow.open(i.__gmapMarker.getMap(),i.__gmapMarker))}),n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"doCleanup",value:function(){google.maps.event.clearInstanceListeners(this.__gmapMarker),google.maps.event.clearInstanceListeners(this.__infoWindow),this.__infoWindowContent&&(this.__infoWindowContent.destroy(),this.__infoWindowContent=null),this.__infoWindow&&(this.__infoWindow.setContent(null),this.__infoWindow=null),this.__gmapMarker&&(this.__gmapMarker.setMap(null),this.__gmapMarker=null),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"__createPopupContent",value:function(){var e=this,t=Ext.widget("svmx.panel",{cls:"popupContainer",height:"100%"}),n=Ext.widget("svmx.horizontalpanel",{cls:"popupTopPanel",items:[{xtype:"svmx.image",cls:"redBorder",src:"modules/com.servicemax.client.ui.modern.themes.orange/resources/theme-orange/images/map-pins/warehouse-map-icon.svg"},{xtype:"svmx.verticalpanel",cls:"popupDetail",items:[{xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.label",html:'<span class="name">'+e.__data.location.Name+"</span>",docked:"left",flex:.7},{xtype:"svmx.label",html:'<span class="qty">'+(e.__data.lstProductStck[0][v.getCustomFieldName("Quantity2")]?e.__data.lstProductStck[0][v.getCustomFieldName("Quantity2")]:"--")+"</span> "+S().T("FSA018_TAG026","units"),docked:"right",textAlign:"right",flex:.3,style:"font: 20px '-apple-system', Roboto, 'Segoe UI'; margin-top:-6px;"}]},{xtype:"svmx.label",html:e.__getAddressLineValue()},{xtype:"svmx.panel",items:[]}]}]}),i=Ext.widget("svmx.verticalpanel",{cls:"popupBottomPanel"});return i.add({xtype:"svmx.panel",cls:"divider"}),e.__isSharedLocation()||(e.__canSendMessage()&&i.add({xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.button",cls:"messageIcon",handler:v.proxy(e,"__handleSendMessage")},{xtype:"svmx.button",cls:"buttonLabel",html:S().T("FSA018_TAG025","Request Part"),handler:v.proxy(e,"__handleSendMessage")}]}),e.__canMakeCall()&&i.add({xtype:"svmx.horizontalpanel",items:[{xtype:"svmx.button",html:S().T("FSA018_TAG024","Call"),cls:"phoneIcon",handler:v.proxy(e,"__handleCall")},{xtype:"svmx.button",cls:"buttonLabel",html:S().T("FSA018_TAG024","Call")+" "+e.__data.location[v.getCustomFieldName("Site_Phone")],handler:v.proxy(e,"__handleCall")}]})),t.add(n),(e.__canMakeCall()||e.__canSendMessage()||e.__isSharedLocation())&&t.add(i),t}},{key:"__canSendMessage",value:function(){return this.__data.location[v.getCustomFieldName("Site_Phone")]&&!0}},{key:"__canMakeCall",value:function(){return this.__data.location[v.getCustomFieldName("Site_Phone")]&&!0}},{key:"__isSharedLocation",value:function(){var e=this;e.__data.location[v.getCustomFieldName("Site_Phone")];return!1}},{key:"__handleSendMessage",value:function(){var e=this;y.createSMSRequest().execute({phone:e.__data.location[v.getCustomFieldName("Site_Phone")],message:e.__getSMSContent()})}},{key:"__getSMSContent",value:function(){var e=this;return"Hi "+e.__data.location.Name+": I need "+e.__record.Name+".\nCan you spare them?"}},{key:"__handleCall",value:function(){var e=this;y.createTELRequest().execute({phone:e.__data.location[v.getCustomFieldName("Site_Phone")]})}},{key:"__handleTransfer",value:function(){alert("Transfer")}},{key:"__getAddressLineValue",value:function(){var e=this,t=e.__data.location[v.getCustomFieldName("State")]?e.__data.location[v.getCustomFieldName("State")]:"",n=e.__data.location[v.getCustomFieldName("City")]?e.__data.location[v.getCustomFieldName("City")]:"",i=e.__data.distance?e.__data.distance.toFixed(0):-1;return(t.length>0&&n.length>0?'<span class="address">'+n+", "+t+"</span>":"")+' <span class="distance">('+(-1!=i?i+" "+e.__distanceUnit:"")+")</span>"}}]),t}(E);e.exports={TechnicianMarker:b,WarehouseMarker:T}},function(e,t){function n(){this.initialize=function(){function e(e){options={visible:!0,map:e.map,center:e.map.getCenter(),radius:2e5,draggable:!1,editable:!1,stroke_weight:1,stroke_color:"#000",fill_opacity:.3,fill_color:"#000",always_fit_to_map:!1},options=this.extend_(options,e),this.set("visible",options.visible),this.set("map",options.map),this.set("center",options.center),this.set("radius",options.radius),this.set("old_radius",options.radius),this.set("draggable",options.draggable),this.set("editable",options.editable),this.set("stroke_weight",options.stroke_weight),this.set("stroke_color",options.stroke_color),this.set("fill_opacity",options.fill_opacity),this.set("fill_color",options.fill_color),this.set("always_fit_to_map",options.always_fit_to_map),this.set("position",options.center),this.set("resize_leftright",options.resize_leftright),this.set("resize_updown",options.resize_updown);var t=new google.maps.Marker({visible:!1});t.bindTo("map",this),t.bindTo("draggable",this),t.bindTo("position",this),this.set("center_marker",t),this.drawCircle_(this.get("map"),this.get("position"),this.get("radius")/1e3),this.addSizer_()}return e.prototype=new google.maps.MVCObject,e.prototype.position_changed=function(){if(this.set("center",this.get("position")),this.get("donut")){for(var e=new this.Overlay,t=this.drawSpot_(this.getCenter(),this.getRadius()/1e3),n=0;n<t.length;n++)e.push(t[n]);this.set("paths",e),this.getVisible()&&this.get("donut").setPaths(e)}if(this.get("sizer_left")&&this.get("sizer_right")&&this.get("sizer_up")&&this.get("sizer_down")){var i=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),-90),a=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),90),r=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),360),o=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),180);this.get("sizer_left").setPosition(i),this.get("sizer_right").setPosition(a),this.get("sizer_up").setPosition(r),this.get("sizer_down").setPosition(o)}},e.prototype.radius_changed=function(){if(this.get("donut")){for(var e=new this.Overlay,t=this.drawSpot_(this.getCenter(),this.getRadius()/1e3),n=0;n<t.length;n++)e.push(t[n]);this.set("paths",e),this.getVisible()&&this.get("donut").setPaths(e)}if(this.get("sizer_left")&&this.get("sizer_right")&&this.get("sizer_up")&&this.get("sizer_down")){var i=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),-90),a=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),90),r=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),360),o=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),180);this.get("sizer_left").setPosition(i),this.get("sizer_right").setPosition(a),this.get("sizer_up").setPosition(r),this.get("sizer_down").setPosition(o)}},e.prototype.visible_changed=function(){this.setEditable(this.getVisible()),this.setDraggable(this.getVisible()),this.getVisible()?this.get("donut")&&this.get("donut").setPaths(this.get("paths")):this.get("donut")&&this.get("donut").setPaths([])},e.prototype.setMap=function(e){this.set("map",e)},e.prototype.getMap=function(){return this.get("map")},e.prototype.setVisible=function(e){this.set("visible",e)},e.prototype.getVisible=function(){return this.get("visible")},e.prototype.setCenter=function(e){this.set("position",e)},e.prototype.getCenter=function(){return this.get("position")},e.prototype.getRadius=function(){return this.get("radius")},e.prototype.setRadius=function(e){this.set("radius",e)},e.prototype.getOldRadius=function(){return this.get("old_radius")},e.prototype.setOldRadius=function(e){this.set("old_radius",e)},e.prototype.getEditable=function(){return this.get("editable")},e.prototype.setEditable=function(e){this.set("editable",e)},e.prototype.getDraggable=function(){return this.get("draggable")},e.prototype.setDraggable=function(e){this.set("draggable",e)},e.prototype.getBounds=function(){var e=this.getOldRadius(),t=this.getRadius(),n=void 0,i=void 0,a=void 0,r=void 0,o=void 0,s=void 0,l=void 0;return i=this.getCenter(),a=new google.maps.LatLngBounds,e<t&&(n=1.1*t,n>6371e3&&(n=6371e3),r=google.maps.geometry.spherical.computeOffset(i,n,-90),o=google.maps.geometry.spherical.computeOffset(i,n,90),s=google.maps.geometry.spherical.computeOffset(i,n,360),l=google.maps.geometry.spherical.computeOffset(i,n,180)),e>t&&(n=t/2.5,n<0&&(n=0),r=google.maps.geometry.spherical.computeOffset(i,n,-90),o=google.maps.geometry.spherical.computeOffset(i,n,90),s=google.maps.geometry.spherical.computeOffset(i,n,360),l=google.maps.geometry.spherical.computeOffset(i,n,180)),e==t&&(console.log("old_radius == radius"),r=google.maps.geometry.spherical.computeOffset(i,n,-90),o=google.maps.geometry.spherical.computeOffset(i,n,90),s=google.maps.geometry.spherical.computeOffset(i,n,360),l=google.maps.geometry.spherical.computeOffset(i,n,180)),a.extend(r),a.extend(o),a.extend(s),a.extend(l),a},e.prototype.addSizer_=function(){var e=new google.maps.MarkerImage(this.get("resize_leftright"),new google.maps.Size(29,29),new google.maps.Point(0,0),new google.maps.Point(15,15)),t=new google.maps.MarkerImage(this.get("resize_updown"),new google.maps.Size(29,29),new google.maps.Point(0,0),new google.maps.Point(15,15)),n=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),-90),i=new google.maps.Marker({position:n,title:"Drag me!",raiseOnDrag:!1,icon:e}),a=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),90),r=new google.maps.Marker({position:a,title:"Drag me!",raiseOnDrag:!1,icon:e}),o=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),360),s=new google.maps.Marker({position:o,title:"Drag me!",raiseOnDrag:!1,icon:t,visible:!1}),l=google.maps.geometry.spherical.computeOffset(this.getCenter(),this.getRadius(),180),c=new google.maps.Marker({position:l,title:"Drag me!",raiseOnDrag:!1,icon:t,visible:!1});i.bindTo("map",this,"map"),i.bindTo("visible",this,"editable"),i.bindTo("draggable",this,"editable"),r.bindTo("map",this,"map"),r.bindTo("visible",this,"editable"),r.bindTo("draggable",this,"editable"),s.bindTo("map",this,"map"),s.bindTo("draggable",this,"editable"),c.bindTo("map",this,"map"),c.bindTo("draggable",this,"editable"),this.set("sizer_left",i),this.set("sizer_right",r),this.set("sizer_up",s),this.set("sizer_down",c);var u=this;google.maps.event.addListener(i,"dragstart",function(){u.setOldRadius(u.getRadius())}),google.maps.event.addListener(i,"mouseover",function(){var e=u.get("sizer_left").getIcon();e.origin=new google.maps.Point(0,29),u.get("sizer_left").setIcon(e)}),google.maps.event.addListener(i,"mouseout",function(){var e=u.get("sizer_left").getIcon();e.origin=new google.maps.Point(0,0),u.get("sizer_left").setIcon(e)}),google.maps.event.addListener(r,"dragstart",function(){u.setOldRadius(u.getRadius())}),google.maps.event.addListener(r,"mouseover",function(){var e=u.get("sizer_right").getIcon();e.origin=new google.maps.Point(0,29),u.get("sizer_right").setIcon(e)}),google.maps.event.addListener(r,"mouseout",function(){var e=u.get("sizer_right").getIcon();e.origin=new google.maps.Point(0,0),u.get("sizer_right").setIcon(e)}),google.maps.event.addListener(i,"drag",function(){radius=google.maps.geometry.spherical.computeDistanceBetween(u.getCenter(),u.get("sizer_left").getPosition()),u.setRadius(radius)}),google.maps.event.addListener(r,"drag",function(){radius=google.maps.geometry.spherical.computeDistanceBetween(u.getCenter(),u.get("sizer_right").getPosition()),u.setRadius(radius)}),google.maps.event.addListener(i,"dragend",function(){radius=google.maps.geometry.spherical.computeDistanceBetween(u.getCenter(),u.get("sizer_right").getPosition()),u.setRadius(radius),u.get("always_fit_to_map")&&u.get("map").fitBounds(u.getBounds())}),google.maps.event.addListener(r,"dragend",function(){radius=google.maps.geometry.spherical.computeDistanceBetween(u.getCenter(),u.get("sizer_right").getPosition()),u.setRadius(radius),u.get("always_fit_to_map")&&u.get("map").fitBounds(u.getBounds())})},e.prototype.addVisibleController_=function(){this.set("circleControlDiv",document.createElement("div")),this.get("circleControlDiv").style.padding="9px",this.get("circleControlDiv").style.cursor="pointer",this.get("circleControlDiv").innerHTML='<div style="direction: ltr; overflow: hidden; text-align: left; position: relative; color: rgb(0, 0, 0); font-family: Arial, sans-serif; -webkit-user-select: none; font-size: 13px; background-color: rgb(255, 255, 255); padding: 4px; border-width: 1px 1px 1px 0px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-top-color: rgb(113, 123, 135); border-right-color: rgb(113, 123, 135); border-bottom-color: rgb(113, 123, 135); -webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px; box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px; font-weight: bold; background-position: initial initial; background-repeat: initial initial; " title="Turn On/Off the Circle"><span><div style="width: 16px; height: 16px; overflow: hidden; position: relative; "><img style="position: absolute; left: 0px; top: 0px; -webkit-user-select: none; border: 0px; padding: 0px; margin: 0px; width: auto; height: auto; " src="http://maps.gstatic.com/mapfiles/drawing.png" draggable="false"></div></span></div>',this.get("circleControlDiv").clicked=options.visible;var e=this;google.maps.event.addDomListener(this.get("circleControlDiv"),"click",function(){this.clicked=!this.clicked,this.clicked?(this.innerHTML='<div style="direction: ltr; overflow: hidden; text-align: left; position: relative; color: rgb(0, 0, 0); font-family: Arial, sans-serif; -webkit-user-select: none; font-size: 13px; background-color: rgb(255, 255, 255); padding: 4px; border-width: 1px 1px 1px 0px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-top-color: rgb(113, 123, 135); border-right-color: rgb(113, 123, 135); border-bottom-color: rgb(113, 123, 135); -webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px; box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px; font-weight: bold; background-position: initial initial; background-repeat: initial initial; " title="Turn On/Off the Circle"><span><div style="width: 16px; height: 16px; overflow: hidden; position: relative; "><img style="position: absolute; left: 0px; top: 0px; -webkit-user-select: none; border: 0px; padding: 0px; margin: 0px; width: auto; height: auto; " src="http://maps.gstatic.com/mapfiles/drawing.png" draggable="false"></div></span></div>',e.setVisible(!0)):(this.innerHTML='<div style="direction: ltr; overflow: hidden; text-align: left; position: relative; color: rgb(51, 51, 51); font-family: Arial, sans-serif; -webkit-user-select: none; font-size: 13px; background-color: rgb(255, 255, 255); padding: 4px; border-width: 1px 1px 1px 0px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-top-color: rgb(113, 123, 135); border-right-color: rgb(113, 123, 135); border-bottom-color: rgb(113, 123, 135); -webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px; box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px; font-weight: normal; background-position: initial initial; background-repeat: initial initial; " title="Turn On/Off the Circle"><span><div style="width: 16px; height: 16px; overflow: hidden; position: relative; "><img style="position: absolute; left: 0px; top: -160px; -webkit-user-select: none; border: 0px; padding: 0px; margin: 0px; width: auto; height: auto; " src="http://maps.gstatic.com/mapfiles/drawing.png" draggable="false"></div></span></div>',e.setVisible(!1))}),this.get("circleControlDiv").index=1,this.get("map").controls[google.maps.ControlPosition.LEFT_TOP].push(this.get("circleControlDiv"))},e.prototype.extend_=function(e,t){if(arguments.length>2)for(var n=1;n<arguments.length;n++)extend(e,arguments[n]);else for(var i in t)e[i]=t[i];return e},e.prototype.drawSpot_=function(e,t){var n=Math.PI/180,i=180/Math.PI,a=[],r=!1,o=1,s=[],l=void 0,c=void 0,u=void 0,d=void 0,_=void 0,h=void 0,f=t/6371*i,p=f/Math.cos(e.lat()*n);for(e.lng()>0&&(o=-1),1==o?(l=0,c=129):(l=129,c=0),u=l;1==o?u<c:u>c;u+=o)d=Math.PI*(u/64),_=e.lat()+f*Math.sin(d),h=e.lng()+p*Math.cos(d),(-1===o&&h<0||1===o&&h>0)&&(h=0,r=!0),s.push(new google.maps.LatLng(_,h));if(a.push(s),r){for(s=[],o=-o,1==o?(l=0,c=129):(l=129,c=0),u=l;1==o?u<c:u>c;u+=o)d=Math.PI*(u/64),_=e.lat()+f*Math.sin(d),h=e.lng()+p*Math.cos(d),(-1===o&&h<0||1===o&&h>0)&&(h=0,r=!0),s.push(new google.maps.LatLng(_,h));a.push(s)}return a},e.prototype.Overlay=function(){return[[new google.maps.LatLng(-86,-180),new google.maps.LatLng(86,-180),new google.maps.LatLng(86,0),new google.maps.LatLng(-86,0)],[new google.maps.LatLng(-86,180-1e-10),new google.maps.LatLng(86,180-1e-10),new google.maps.LatLng(86,0),new google.maps.LatLng(-86,0)]]},e.prototype.drawCircle_=function(e,t,n){for(var i=new this.Overlay,a=this.drawSpot_(t,n),r=0;r<a.length;r++)i.push(a[r]);var o=new google.maps.Polygon({strokeWeight:this.stroke_weight,strokeColor:this.stroke_color,fillColor:this.fill_color,fillOpacity:this.fill_opacity,map:e});this.set("paths",i),this.set("donut",o),this.getVisible()&&this.get("donut").setPaths(i)},e}}e.exports=new n},function(e,t){function n(){this.initialize=function(){function e(e){this.setValues(e);var t=this.span_=document.createElement("span");t.style.cssText="position: relative;left: -50%;top: -15px;white-space: nowrap;padding: 4px;background-color: #4e4e4e;color: white;border-radius: 5px;font-family: sans-serif;font-size: 10px;z-index:1000001";var n=this.div_=document.createElement("div");n.appendChild(t),n.style.cssText="position: absolute; display: none"}return e.prototype=new google.maps.OverlayView,e.prototype.onAdd=function(){this.getPanes().overlayLayer.appendChild(this.div_);var e=this;this.listeners_=[google.maps.event.addListener(this,"position_changed",function(){e.draw()}),google.maps.event.addListener(this,"text_changed",function(){e.draw()})]},e.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);for(var e=0,t=this.listeners_.length;e<t;++e)google.maps.event.removeListener(this.listeners_[e])},e.prototype.draw=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this.get("position")),n=this.div_;n.style.left=t.x+"px",n.style.top=t.y+"px",n.style.display="block",this.span_.innerHTML=this.get("text").toString()},e}}e.exports=new n},function(e,t,n){var i=(n(10),n(0).utils),a=n(22).View,r=(n(7).SystemData,function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}),o=function(e){if(e.errors&&e.errors.length>0){var t=e.errors[0].errorMsg,n="Part transfer request failed. Please try again or contact your administrator.<br/><br/>Details<textarea readonly rows='4' cols='50' style='width:100%; padding: 5px; margin-top: 10px; resize: none;'>"+t+"</textarea>";i.Msg.alert({title:"",text:"",items:[{xtype:"svmx.label",cls:"label-tools-msgbox",text:n}],buttons:[{text:r().T("FSA016_TAG003","OK"),ui:"button-tools-msgbox"}]})}else e.success&&i.Msg.toast({text:r().T("FSA018_TAG013","Transfer successfully completed. Initiate Data sync to get the updates.")})},s=function(e){var t={text:r().T("FSA018_TAG014","Can not complete the transaction as the app is in offline."),type:"INFO",buttons:[{text:"OK",itemId:"OK"}]};i.getCurrentApplication().showMessage(t)},l={name:"com.servicemax.client.mobileinventory.ui.largemodern.transfercompletionview"},c=(i.getLoggingService().getLogger("mobileinventory-ui"),l.name),u=a;l.View=Ext.define(c+".TransferCompletionView",{extend:u,alias:"widget.mobileinventory.transfercompletionview",layout:"fill",config:{halign:"center"},width:"100%",height:"100%",cls:"transfer-completion-container",mixins:["Ext.mixin.Responsive"],plugins:["responsive"],__deliveryEngine:null,__requestParams:null,__partDisplayLabel:null,__partdDisplayValue:null,__partName:null,__destinationTechName:null,constructor:function(e){e=e||{},this.__deliveryEngine=e.deliveryEngine,this.callParent(arguments)},getDialogConfig:function(){return{hideOnMaskTap:!1}},doDestroy:function(){this.callParent(arguments)},ready:function(){this.add(this.__getUIItems());var e=i.getCurrentApplication().getSyncImpl().getSyncManager();i.getCurrentApplication().getSyncImpl().isDataSyncRunning()&&e?e.addInventoryParamsToSyncManager({requestParams:this.__requestParams,deliveryEngine:this.__deliveryEngine}):this.__initiateStockTransfer()},setOptions:function(e){e=e||{},e.stocktransferview&&e.stocktransferview.done(),this.__requestParams=e.requestParams,this.__destinationTechName=e.destinationTechName,this.__partDisplayLabel=e.partDisplayLabel,this.__partdDisplayValue=e.partDisplayValue,this.__partName=e.partName,this.callParent(arguments)},__getUIItems:function(){var e=this,t=[];return t.push({xtype:"svmx.toolbar",width:"100%",height:40,docked:"top",ui:"svmx-toolbar-grey",cls:"partDetailView-header",title:r().T("FSA018_TAG008","Transfer Initiated"),style:"text-align:center",items:e.__getToolbarItems()}),t.push({xtype:"svmx.verticalpanel",cls:"transfer-completion-content",items:e.__getProductDisplayFields()}),t.push({xtype:"svmx.verticalpanel",cls:"transfer-completion-tech-panel",items:e.__getTechnitianPanel()}),t.push({xtype:"svmx.label",style:"text-align:left;",text:r().T("FSA018_TAG010","Trunk Stock will be updated during the next sync."),cls:"transfer-completion-trunk-stock-message"}),t},__getTechnitianPanel:function(){var e=this,t=[],n=r().T("FSA018_TAG009","Will be transferred to");return t.push(e.__getItemUI("",n,"","transfer-completion-tech-label")),t.push(e.__getItemUI("",e.__destinationTechName,"","transfer-completion-user")),t},__getProductDisplayFields:function(){var e=this,t=[];return t.push(e.__getItemUI("",e.__partName,"","transfer-completion-display-label-title")),t.push(e.__getItemUI(e.__partDisplayLabel,e.__partdDisplayValue,"transfer-completion-display-label","transfer-completion-display-value")),t.push(e.__getItemUI(r().T("FSA018_TAG003","Quantity"),e.__requestParams.quantity,"transfer-completion-display-label","transfer-completion-display-value")),t},__getItemUI:function(e,t,n,i){var a={xtype:"svmx.horizontalpanel",docked:"top",style:"text-align:center; margin: auto;",items:[]};return e.length>0&&a.items.push({xtype:"svmx.label",text:e+": ",cls:n}),t.length>0&&a.items.push({xtype:"svmx.label",text:t,cls:i}),a},__getToolbarItems:function(){return[{},this.__getCloseButton()]},__getCloseButton:function(){return{docked:"right",xtype:"svmx.button",html:r().T("FSA015_TAG015","Close"),handler:i.proxy(this,"__closeButtonTapped"),ui:"svmx-toolbar-btn",cls:"partDetailView-close-btn",itemId:"transferViewToolbarCancelButton"}},__closeButtonTapped:function(){this.done()},__initiateStockTransfer:function(){var e=this;e.__requestParams=e.__requestParams||{},e.__requestParams.context=e,e.__requestParams.handler=e.onStockTransferComplete;var t=i.create("com.servicemax.client.lib.api.Event","MOBILEINVENTORY.STOCK_TRANSFER",this,{request:e.__requestParams,responder:{result:function(e){o(e)},fault:function(e){s()}}});e.__deliveryEngine.getEventBus().triggerEvent(t)}}),i.defineGlobal(l.name,l),e.exports=l},function(e,t,n){n(882);var i=n(888),a=n(889),r=n(890),o=n(892),s=n(893),l=n(894),c=n(895),u=n(896),d=n(897),_=n(0).utils;_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.consoleapp","config":{"app":{"id":"productIQ","class-name":"com.servicemax.client.sfmconsole.ui.largemodern.console.ConcreteConsoleApp"},"views":[{"id":"homeview","class-name":"com.servicemax.client.productIQ.ui.largemodern.homeview.HomeView"},{"id":"piqsearchresults","class-name":"com.servicemax.client.productIQ.ui.largemodern.homeview.PIQResultsView"},{"id":"checklistedit","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.checklistview.CheckListEditView"},{"id":"linedetails","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.homeview.LineDetailsView"},{"id":"editdetails","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.editview.EditDetailsView"},{"id":"documentitems","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.AttachmentDocumentView"},{"id":"imageitems","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.AttachmentDocumentView"},{"id":"lookup","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.lookupview.LookupView"},{"id":"multilookup","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.lookupview.MultiLookupView"},{"id":"viewtext","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.homeview.TextView"},{"id":"edittext","class-name":"com.servicemax.client.sfmdelivery.ui.largemodern.editview.TextView"}],"icon":{"large-css-class":"icon-chat","small-css-class":"icon-chat"},"controller":{"class-name":"com.servicemax.client.productIQ.engine.DeliveryEngineImpl"},"discover":false,"multiple":true,"positionWeight":2000,"button-text":"ProductIQ"}}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.productIQ.ibtree","config":{"class-name":"com.servicemax.client.productIQ.ui.largemodern.ibtree.IBTree"}}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.productIQ.attachment","config":{"class-name":"com.servicemax.client.productIQ.ui.largemodern.attachment.Attachment"}}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.productIQ.overview","config":{"class-name":"com.servicemax.client.productIQ.ui.largemodern.overview.Overview"}}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.productIQ.detail","config":{"class-name":"com.servicemax.client.productIQ.ui.largemodern.detail.Detail"}}')),_.registerDefinition(JSON.parse('{"type":"com.servicemax.client.productIQ.attachmentHelper","config":{"class-name":"com.servicemax.client.productIQ.ui.largemodern.attachmentHelper.AttachmentHelper"}}')),e.exports={impl:i,homeview:a,ibtree:r,metamodel:o,attachment:s,detail:l,overview:c,attachmentHelper:u,loadselectedib:d}},function(e,t,n){var i=n(883),a=n(884),r=n(885),o=n(886),s=n(887),l=n(0).utils;l.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.productIQ.ibtree"}')),l.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.productIQ.attachment"}')),l.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.productIQ.detail"}')),l.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.productIQ.overview"}')),l.registerDeclaration(JSON.parse('{"id":"com.servicemax.client.productIQ.attachmentHelper"}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"define":{"name":"PRODUCTIQ.VIEW","type":"com.servicemax.client.mvc.impl.View"}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.sfmconsole.deliveryengine","config":{"engine":{"id":"productIQ","class-name":"com.servicemax.client.productIQ.engine.DeliveryEngineImpl"}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"PRODUCTIQ.GET_TOP_LEVEL_IBS","command":"com.servicemax.client.productIQ.commands.GetTopLevelIBs"},{"event":"PRODUCTIQ.GET_MORE_IBS","command":"com.servicemax.client.productIQ.commands.GetMoreIBs"},{"event":"PRODUCTIQ.GET_METADATA","command":"com.servicemax.client.productIQ.commands.GetMetadata"},{"event":"PRODUCTIQ.GET_ALL_PARENT_IBS","command":"com.servicemax.client.productIQ.commands.GetAllParentIBs"},{"event":"PRODUCTIQ.GET_SEARCHPROCESSIB","command":"com.servicemax.client.productIQ.commands.GetSearchProcessID"},{"event":"PRODUCTIQ.FIND_TA_TEMPLATE_FOR_SELECTD_IB","command":"com.servicemax.client.productIQ.commands.FindTechnicalAttributeTemplateForIB"},{"event":"PRODUCTIQ.SAVE_TA_TEMPLATE_INSTANCE_FOR_SELECTD_IB","command":"com.servicemax.client.productIQ.commands.SaveTechnicalAttributeTemplateInstanceForIB"},{"event":"PRODUCTIQ.UPDATE_TA_TEMPLATE_FOR_SELECTD_IB","command":"com.servicemax.client.productIQ.commands.UpdateTechnicalAttributeTemplateForIB"},{"event":"PRODUCTIQ.GET_SEARCHPROCESSIB","command":"com.servicemax.client.productIQ.commands.GetSearchProcessID"},{"event":"PRODUCTIQ.FIND_SELECTED_IB_IN_LOCAL_DB","command":"com.servicemax.client.productIQ.commands.FindIBRecordDetailsInLocalDB"},{"event":"PRODUCTIQ.DELETE_RECORDS","command":"com.servicemax.client.productIQ.commands.DeleteRecords"},{"event":"PRODUCTIQ.UPDATE_IB_HIERARCHY","command":"com.servicemax.client.productIQ.commands.UpdateIBHierarchy"},{"event":"PRODUCTIQ.FIND_TA_TEMPLATE_HISTORY_FOR_SELECTD_IB","command":"com.servicemax.client.productIQ.commands.FindTechnicalAttributeHistoryTemplateForIB"}]}}}')),l.registerDefinition(JSON.parse('{"type":"com.servicemax.client.runtime.namedinstance","config":{"configure":{"name":"CONTROLLER","data":[{"event":"PRODUCTIQ.GET_DETAILPAGEINFO","command":"com.servicemax.client.productIQ.commands.GetDetalPageInfo"}]}}}')),e.exports={impl:i,engine:a,commands:r,responders:o,operations:s}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(14),r=i(a),o=n(1),s=i(o),l=n(2),c=i(l),u=n(6),d=i(u),_=n(3),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).ModuleActivator,g=n(188).DeliveryEngineImpl,y=n(5).EventDispatcher,S={name:"com.servicemax.client.productIQ.impl"};S.Module=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){}},{key:"afterInitialize",value:function(){for(var e=!0;e;){g&&(S.init(),S.init(),S.init(),S.init(),e=!1)}}}]),t}(v),S.ProductIQEventBus=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this))}return(0,p.default)(t,e),(0,d.default)(t,[{key:"triggerEvent",value:function(e){return m.getLoggingService().getLogger("ProductIQEventBus").info("Trigger event : "+e.type),(0,r.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"triggerEvent",this).call(this,e)}}]),t}(y),m.defineGlobal(S.name,S),e.exports=S},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(3),c=i(l),u=n(6),d=i(u),_=n(4),h=i(_),f=n(14),p=i(f),m=n(0).utils,v=(n(60).Constants,n(12).DatetimeUtil,n(188).DeliveryEngineImpl),g=n(5).SVMXObject,y={name:"com.servicemax.client.productIQ.engine"},S=function(){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};y.DeliveryEngineImpl=function(e){function t(){(0,s.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.__notQualified=!1,e.__notAssigned=!1,e.__processNotFound=!1,e.__ibSearchMetamodel=null,e.searchResultsMaxCount=null,e.defaultResultsMaxCount=null,e.__engineReady=null,e.__errorMsg=null,e}return(0,h.default)(t,e),(0,d.default)(t,[{key:"__onQualificationInfoResponse",value:function(e){if(this.__notQualified=!1,this.__notAssigned=!1,this.__processNotFound=!1,e.isSFMProcess&&e.isQualified)(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"__onQualificationInfoResponse",this).call(this,e);else{this.__logger.error("Not qualified!"),this.__notQualified=!0,this.__page=null,this.processId?"process not found"===this.processId?this.__processNotFound=!0:(this.__errorMsg=e.errorMessage,m.getCurrentApplication().showMessage({type:"CUSTOM",title:" ",text:e.errorMessage,buttons:[{text:S().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:m.proxy(this,function(){})})):this.__notAssigned=!0,this.onEngineReady&&this.onEngineReady.handler.apply(this.onEngineReady.context)}}},{key:"isNotQualified",value:function(){return this.__notQualified}},{key:"isNotAssigned",value:function(){return this.__notAssigned}},{key:"processNotFound",value:function(){return this.__processNotFound}},{key:"setErrorMsg",value:function(e){this.__errorMsg=e}},{key:"getErrorMsg",value:function(){return this.__errorMsg}},{key:"reloadModel",value:function(e){this.run(e)}},{key:"run",value:function(e){this.__engineReady||(this.__engineReady=e.onReady),!e.onReady&&this.__engineReady&&(e.onReady=this.__engineReady),(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"run",this).call(this,e)}},{key:"createIBSearchDataModel",value:function(){m.create("com.servicemax.client.sfmconsole.utils.EventCollection",this.getEventBus(),[m.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_SEARCH_INFO",this,{request:{}}),m.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_USERINFO",this,{request:{}}),m.create("com.servicemax.client.lib.api.Event","SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS",this,{request:{}})]).triggerAll(function(e){var t=e.items(),n=t.length,i=void 0;for(i=0;i<n;i++){var a=t[i];"SFMSEARCHDELIVERY.GET_SEARCH_INFO"==a.type()&&this.onGetSearchInfoCompleted(a.response),a.type(),"SFMSEARCHDELIVERY.GET_SEARCH_RESULT_LIMIT_SETTINGS"==a.type()&&this.onGetpIQSearchResultLimitSettingsCompleted(a.response)}this.__ibSearchMetamodel.initialize()},this)}},{key:"onGetSearchInfoCompleted",value:function(e){this.__ibSearchMetamodel=m.create("com.servicemax.client.productIQ.engine.PIQSearchMetaModel",this,e)}},{key:"getIBSearchDataModel",value:function(){if(this.__ibSearchMetamodel)return this.__ibSearchMetamodel.searchInfo}},{key:"onGetpIQSearchResultLimitSettingsCompleted",value:function(e){var t=e.maxLimit,n=e.defaultLimit;this.searchResultsMaxCount=t,this.defaultResultsMaxCount=n}},{key:"getSearchType",value:function(){return"PRODUCTIQ"}}]),(0,d.default)(t,[{key:"doCleanup",value:function(){var e=m.getCurrentApplication();e.setApplicationStateHandler(null),e.setApplicationErrorHandler(null),e.setApplicationQuickMessageHandler(null),this.setPropertyForCleanup(["__ibSearchMetamodel","record","__eventBus","__settings","__clonedData","__page","__objectNameMap"],!0),(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(v),y.PIQSearchMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.searchInfo=[],i.defaultSearchOperator=null,i}return(0,h.default)(t,e),(0,d.default)(t,[{key:"doCleanup",value:function(){this.setPropertyForCleanup("searchInfo",!0),(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(){var e=this.__data.lstSearchInfo||[],t=void 0,n=e.length,i=void 0;for(this.defaultSearchOperator=this.__extractDefaultSearchOperator(),t=0;t<n;t++)i=m.create("com.servicemax.client.productIQ.engine.PIQSearchProcessMetaModel",this,e[t]),i.initialize(),this.searchInfo.push(i)}},{key:"__extractDefaultSearchOperator",value:function(){var e=this.__data.stringMap||[],t=void 0,n=e.length,i="Contains";for(t=0;t<n;t++)if("SEARCH_OPERATOR"==e[t].key){i=e[t].value;break}return i}},{key:"getSearchInfoFor",value:function(e){var t=this.searchInfo||[],n=void 0,i=t.length,a=null;for(n=0;n<i;n++)if(t[n].processObjectId==e){a=t[n];break}return a}}]),t}(g),y.PIQSearchProcessMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.name=null,i.description=null,i.processId=null,i.isDefault=!1,i.processObjectId=null,i.searchDetails=null,i}return(0,h.default)(t,e),(0,d.default)(t,[{key:"doCleanup",value:function(){this.setPropertyForCleanup("searchDetails",!0),(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"initialize",value:function(){this.name=this.__data.searchDef[m.OrgNamespace+"__Name__c"],this.processId=this.__data.searchDef[m.OrgNamespace+"__ProcessID__c"],this.processObjectId=this.__data.searchDef.Id,this.description=this.__data.searchDef[m.OrgNamespace+"__Description__c"],this.isDefault=this.__data.searchDef[m.OrgNamespace+"__IsDefault__c"],this.searchDetails=[];var e=this.__data.searchDetails||[],t=void 0,n=e.length,i=void 0;for(t=0;t<n;t++)i=m.create("com.servicemax.client.productIQ.engine.PIQSearchDetailMetaModel",this,e[t]),i.initialize(),this.searchDetails.push(i);this.searchDetails=this.searchDetails.sort(function(e,t){return e.objectDisplaySequence-t.objectDisplaySequence})}}]),t}(g),y.PIQSearchDetailMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.targetObjectName=null,i.targetObjectLabel=null,i.objectDisplaySequence=null,i.fields=null,i.detailObjectId=null,i}return(0,h.default)(t,e),(0,d.default)(t,[{key:"initialize",value:function(){this.targetObjectLabel=this.__data.objectLabel,this.targetObjectName=this.__data.objectDetails[m.OrgNamespace+"__Target_Object_Name__c"],this.detailObjectId=this.__data.objectDetails.Id,this.objectDisplaySequence=this.__data.objectDetails[m.OrgNamespace+"__Sequence__c"],this.targetObjectLabel=this.__data.objectLable,this.fields=[];var e=this.__data.fields||[],t=void 0,n=e.length,i=void 0;for(t=0;t<n;t++)i=m.create("com.servicemax.client.productIQ.engine.PIQSearchDetailFieldMetaModel",this,e[t]),i.initialize(this.__data.fieldsLable),this.fields.push(i);this.fields=m.sort(this.fields,"sequence")}},{key:"doCleanup",value:function(){this.setPropertyForCleanup("fields",!0),(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),y.PIQSearchDetailFieldMetaModel=function(e){function t(e,n){(0,s.default)(this,t);var i=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return i.__parent=e,i.__data=n,i.fieldName=null,i.displayType=null,i.sequence=0,i.fieldLabel=null,i}return(0,h.default)(t,e),(0,d.default)(t,[{key:"initialize",value:function(e){this.fieldName=this.__data[m.OrgNamespace+"__Field_Name__c"],this.displayType=this.__data[m.OrgNamespace+"__Display_Type__c"],this.sequence=this.__data[m.OrgNamespace+"__Sequence__c"],this.parentName=this.__data[m.OrgNamespace+"__Object_Name2__c"],this.parentReferenceName=this.__data[m.OrgNamespace+"__Lookup_Field_API_Name__c"];var t=void 0,n=e.length;for(t=0;t<n;t++)if(e[t].value1==this.getId()){this.fieldLabel=e[t].value;break}}},{key:"getId",value:function(){return this.__data.Id}},{key:"getFullFieldName",value:function(){return this.parentName&&this.parentName!=this.__parent.targetObjectName?this.parentReferenceName+"-"+this.fieldName:this.fieldName}},{key:"getObjectApiName",value:function(){return this.__parent.targetObjectName}},{key:"getReferenceFieldObjectApiName",value:function(){return this.__data[m.OrgNamespace+"__Object_Name__c"]}},{key:"doCleanup",value:function(){(0,p.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}}]),t}(g),m.defineGlobal(y.name,y),e.exports=y},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(13).CommandWithResponder,m={name:"com.servicemax.client.productIQ.commands"};m.GetMetadata=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_METADATA"})}},{key:"result",value:function(e){this.__cbContext.onGetMetadataComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FindByIB=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FIND_BY_IB"})}},{key:"result",value:function(e){this.__cbContext.onSearchByIBComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}},{key:"error",value:function(e){this.__cbContext.onSearchByIBError();var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetTopLevelIBs=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_TOP_LEVEL_IBS"})}},{key:"result",value:function(e){this.__cbContext.onGetTopLevelIBsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FetchToplevelAccounts=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FETCH_TOPLEVEL_ACCOUNTS"})}},{key:"result",value:function(e){this.__cbContext.onGetTopLevelAccountsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FindIBRecordDetailsInLocalDB=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FIND_SELECTED_IB_IN_LOCAL_DB"})}},{key:"result",value:function(e){this.__cbContext.findIBDetailsInDBCompleted(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FetchCustomFieldName=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FETCH_CUSTOM_FIELD"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.UpdateRecordNameTable=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.UPDATE_RECORD_NAME_TABLE"})}},{key:"result",value:function(e){this.__cbContext.recordNameUpdateSuccess(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetPageLayout=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_PAGELAYOUT"})}},{key:"result",value:function(e){this.__cbContext.onGetPageLayoutCompleted(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetPageData=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_PAGEDATA"})}},{key:"result",value:function(e){this.__cbContext.onGetPageDataCompleted(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetLocAccDetails=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_LOC_ACC_DETAILS"})}},{key:"result",value:function(e){this.__cbContext.onGetLocationAndAccountDetailsCompleted(e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetMoreIBs=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_MORE_IBS"})}},{key:"result",value:function(e){this.__cbContext.onGetMoreIBsCompleted(e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FindProducts=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FIND_PRODUCTS"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SearchInstallBase=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SEACH_INSTALLBASE"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FetchValue=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FETCH_VALUES"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetRecords=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_RECORDS"})}},{key:"result",value:function(e,t,n){this.__cbHandler.call(this.__cbContext,e,t,n);var i=this;f.doLater(function(){i.doCleanup()})}}]),t}(p),m.GetLocations=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_LOCATIONS"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.CreateRecords=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.CREATE_RECORDS"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.DeleteRecords=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.DELETE_RECORDS"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.UpdateIBHierarchy=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this.__params=e.params,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.UPDATE_IB_HIERARCHY"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e,this.__params);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.ApplyFieldUpdate=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e.__params=null,e.__cbHandler=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.APPLY_FIELD_UPDATE"})}},{key:"result",value:function(e){this.__cbContext.onApplyFieldUpdateComplete.call(this.__cbContext,e),this.doCleanup()}}]),t}(p),m.GetLMTopLevelIBs=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_LM_TOP_LEVEL_IBS"})}},{key:"result",value:function(e){this.__cbContext.onGetLMTopLevelIBsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetLMAccountsLocations=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_LM_ACCOUNTS_LOCATIONS"})}},{key:"result",value:function(e,t){this.__cbContext.onGetLMAccountsLocationsComplete(e,t);var n=this;f.doLater(function(){n.doCleanup()})}}]),t}(p),m.GetLMProducts=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_LM_PRODUCTS"})}},{key:"result",value:function(e){this.__cbContext.onGetLMProductsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SaveMultipleRecords=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SAVE_MULTIPLE_RECORDS"})}},{key:"result",value:function(e){this.__cbContext.onSaveComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SaveRecord=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SAVE_RECORD"})}},{key:"result",value:function(e){this.__cbContext.onSaveComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SaveRecordConfirm=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SAVE_RECORD_CONFIRM"})}},{key:"result",value:function(e){this.__cbContext.onSaveComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.CloneRecord=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.CLONE_RECORD"})}},{key:"result",value:function(e){this.__cbContext.onCloneComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.CloneMultipleRecords=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.CLONE_MULTIPLE_RECORDS"})}},{key:"result",value:function(e){this.__cbContext.onCloneComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SaveState=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SAVE_STATE"})}},{key:"result",value:function(e){}}]),t}(p),m.GetSyncConflicts=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_SYNC_CONFLICTS"})}},{key:"result",value:function(e){this.__cbContext.onGetSyncConflictsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.UpdateSyncConflicts=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.UPDATE_SYNC_CONFLICTS"})}},{key:"result",value:function(e){this.__cbContext.onUpdateSyncConflictsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetAllParentIBs=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_ALL_PARENT_IBS"})}},{key:"result",value:function(e){this.__cbContext.onAllParentIBsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SendExternalMessage=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SEND_EXTERNAL_MSG"})}},{key:"result",value:function(e){this.__cbContext.onSendExternalMessageComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.ExecuteAPI=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.EXECUTE_API"})}},{key:"result",value:function(e){this.__cbContext.onExecuteAPIComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetApplicationFocus=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_APP_FOCUS"})}},{key:"result",value:function(e){this.__cbContext.onGetAppFoucsComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetLookupConfig=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_LOOKUPCONFIG"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e.data,!0,e.parentNodeId,e.displayCols);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetAllChildIBs=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_ALL_CHILD_IBS"})}},{key:"result",value:function(e){this.__cbHandler.call(this.__cbContext,e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.IBSearchConfig=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_IBSEARCHCONFIG"})}},{key:"result",value:function(e){this.__cbContext.onGetMetadataCompleteForAdvanceSearch(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FindTechnicalAttributeTemplateForIB=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FIND_TA_TEMPLATE_FOR_SELECTD_IB"})}},{key:"result",value:function(e){this.__cbContext.__findTemplateComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.FindTechnicalAttributeHistoryTemplateForIB=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.FIND_TA_TEMPLATE_HISTORY_FOR_SELECTD_IB"})}},{key:"result",value:function(e){this.__cbContext.__findTemplateHistoryComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.SaveTechnicalAttributeTemplateInstanceForIB=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.SAVE_TA_TEMPLATE_INSTANCE_FOR_SELECTD_IB"})}},{key:"result",value:function(e){this.__cbContext.onSaveComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.UpdateTechnicalAttributeTemplateForIB=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.UPDATE_TA_TEMPLATE_FOR_SELECTD_IB"})}},{key:"result",value:function(e){this.__cbContext.onUpdateComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetDetalPageInfo=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_DETAILPAGEINFO"})}},{key:"result",value:function(e){this.__cbContext.onDataPageInfoComplete(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),m.GetSearchProcessID=function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.__cbContext=null,e}return(0,h.default)(t,e),(0,c.default)(t,[{key:"executeAsync",value:function(e,t){this.__cbContext=e.context,this.__cbHandler=e.handler,this._executeOperationAsync(e,this,{operationId:"PRODUCTIQ.GET_SEARCHPROCESSIB"})}},{key:"result",value:function(e){this.__cbContext.onSearchProcessIDCompletion(e);var t=this;f.doLater(function(){t.doCleanup()})}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.productIQ.responders"};i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){var i=n(0).utils,a={name:"com.servicemax.client.productIQ.operations"};i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(4),h=i(_),f=n(0).utils,p=n(5).ModuleActivator,m={name:"com.servicemax.client.productIQ.ui.largemodern.impl"};m.Module=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,r.default)(t)).call(this))}return(0,h.default)(t,e),(0,c.default)(t,[{key:"beforeInitialize",value:function(){}},{key:"initialize",value:function(){m.init(),m.init(),m.init(),m.init(),m.init()}},{key:"afterInitialize",value:function(){m.init(),m.init()}}]),t}(p),f.defineGlobal(m.name,m),e.exports=m},function(e,t,n){var i=n(0).utils,a=(n(19).impl,n(24).navigation,n(24).data,n(22).View),r=n(7).MetaData,o=n(5).ExtensionRunner,s=n(7).Cache,l=n(11).Facade,c=n(7).Data,u={name:"com.servicemax.client.productIQ.ui.largemodern.homeview"},d=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},_=a,h=i.getLoggingService().getLogger("ProductIQ-UI"),f=u.name,p=!1;Ext.define(f+".HomeView",{extend:_,alias:"widget.productIQ.HomeView",tabBar:null,searchButton:null,detailTitle:null,externalData:null,rootModel:null,attachmentPanel:null,detailPanel:null,overviewPanel:null,ibtreeView:null,testAT:null,isDetailEnabled:!1,isAttachmentEnabled:!1,contentRendered:!1,processID:null,__contentView:null,__sfwEngine:null,__isWizardLoaded:!1,__prevSelectedNode:null,__treeSelectedNode:null,__actionPerformed:null,__backButtonTapped:null,__actionData:null,processName:null,isSearchConfiguration:null,__ibEditProcess:null,__locEditProcess:null,__islocalRecord:!1,__syncStarted:!1,__continueOnSameNode:!1,cls:"svmx-productiqwindow",__syncManager:null,__firstload:!1,__newnodeCreated:!1,__recordOption:null,__viewHidden:!1,updateOptions:function(e){if(this.__recordOption=e,window.cordova&&Ext.isiOS){var t=l.createForceOrientationRequest(),n={type:"FORCEORIENTATION",parameters:{orientation:screen.orientation,forceOrientation:!0}};t.bind("REQUEST_COMPLETED",function(e){},this),t.bind("REQUEST_ERROR",function(e){h.error("ForceOrientation Failed")}),t.execute(n)}this.setViewInfo({windowTitle:"  ",backText:d().T("FSA002_TAG007","Back"),subTitle:"",disableNavMenu:!0,leftHeader:this.getLeftButton(),hideBackButton:!0,disableActionMenu:!0,menuItems:[{xtype:"svmx.verticalpanel",width:Math.floor(.5*Ext.Viewport.element.getWidth()),height:"100%"}]}),this.externalData=e.message;var a=this.getDeliveryEngine().getEventBus();this.bind(a,"SFMDELIVERY.DATA_SAVED",this.onDataSaved,this);var r=i.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance();this.bind(r,"ATTACHMENTS_CHANGED",this.onPiqAttachmentsChange,this);var o=i.getClient().getServiceRegistry().getService("com.servicemax.client.syncmanager");this.__syncManager=o.getInstance(),this.bindSyncEvents()},bindSyncEvents:function(){this.__syncManager&&(this.__syncManager.bind("SYNC_STARTED",this.__onSyncStarted,this),this.__syncManager.bind("SYNC_STOPPED",this.__onSyncStopped,this),this.__syncManager.bind("SYNC_COMPLETED",this.__onSyncCompleted,this),this.__syncManager.bind("SYNC_PROGRESS",this.__onSyncProgress,this))},unbindSyncEvents:function(){this.__syncManager&&(this.__syncManager.unbind("SYNC_STARTED",this.__onSyncStarted,this),this.__syncManager.unbind("SYNC_STOPPED",this.__onSyncStopped,this),this.__syncManager.unbind("SYNC_COMPLETED",this.__onSyncCompleted,this),this.__syncManager.unbind("SYNC_PROGRESS",this.__onSyncProgress,this))},__onSyncStarted:function(e){this.__syncStarted=!0,this.__mappedRecords=null},__onSyncProgress:function(e){this.__syncStarted=!0,this.deleteButton&&this.deleteButton.setHidden(!0),this.__mappedRecords||this.getMappedRecords(e)},__onSyncStopped:function(e){this.__syncStarted=!1,this.getMappedRecords(e)},__onSyncCompleted:function(e){this.__syncStarted=!1,this.__mappedRecords||this.getMappedRecords(e),this.updateSFIDToTree()},getMappedRecords:function(e){this.__mappedRecords=e.target.__syncEventCol.getState("MAP_REMOTE_IDS"),this.__mappedRecords&&this.updateSFID()},updateSFIDToTree:function(){var e=this.__mappedRecords;if(e){var t=this.ibtreeView;t&&t.updateTreeWithSFID(e)}},onDataSaved:function(e){this.updateRecord();var t=e.target;if(t){var n=t.processType;if(n&&"CHECKLIST"===n)return;this.newRecordId=t.recordId,this.newObjectName=t.objectName}var i=void 0;if(this.__prevSelectedNode&&(i=this.__prevSelectedNode.id),this.newRecordId===i)this.newRecordId=null,this.newObjectName=null,this.updateTreeView();else{var a=this.ibtreeView;a&&(a.refreshTopLevel=!0,a.__refreshContentInternal())}this.newRecordId&&(this.__newnodeCreated=!0)},onPiqAttachmentsChange:function(){this.attachmentPanel&&(this.attachmentPanel.docSection&&this.attachmentPanel.docSection.refreshData("refreshAllAttachments"),this.attachmentPanel.imageSection&&this.attachmentPanel.imageSection.refreshData("refreshAllAttachments"))},validationCheckForCreatedNode:function(){if(this.newObjectName===i.getCustomObjectName("Site"))this.__showLocationNode();else{var e=this.newRecordId,t=i.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_ALL_PARENT_IBS",this,{request:{context:this,params:{},record:{Id:e},handler:this.onAllParentIBsComplete}});this.getDeliveryEngine().getEventBus().triggerEvent(t)}},__showLocationNode:function(){var e=i.cloneObject(this.ibtreeView.__treeData.root);!1===this.__searchForLocation(e.children,e,this.newRecordId)&&(this.newRecordId=null,this.newObjectName=null),this.updateTreeView()},__searchForLocation:function(e,t,n){var i=!1;if(!e)return i;for(var a=0;a<e.length;a++){var r=e[a],o=this.ibtreeView.__tree.getStore().getNodeById(n);if(r.id===n){if(o){i=!0;break}}else if(!0===(i=this.__searchForLocation(r.children,t,n)))break}return i},onAllParentIBsComplete:function(e){if(e&&e.length>0){var t=e.pop();this.ibtreeView.__tree.getStore().getNodeById(t.ids)||(this.newRecordId=null,this.newObjectName=null)}else this.newRecordId=null,this.newObjectName=null;this.updateTreeView()},updateTreeView:function(){var e=this.newRecordId;if(this.__prevSelectedNode||e){this.updateSFID();var t={};t.action="VIEW",t.recordIds=e?[e]:[this.__prevSelectedNode.id],"IB"===this.__prevSelectedNode.nodeType?t.object=i.getCustomObjectName("Installed_Product"):"LOCATION"===this.__prevSelectedNode.nodeType&&(t.object=i.getCustomObjectName("Site")),this.ibtreeView&&this.ibtreeView.reloadTreeViewData(t),this.newRecordId&&(this.newRecordId=null,this.newObjectName=null)}},updateSFID:function(){if(this.__mappedRecords&&this.__islocalRecord){var e=this.__prevSelectedNode.id,t=this.__mappedRecords[e];t&&(this.getDeliveryEngine().recordId=t,this.__prevSelectedNode.id=t)}},onShow:function(){this.ibtreeView&&(this.ibtreeView.__searchButtonTapped=!1),h.info("ProductIQ Home View showing"),this.__viewHidden=!1},updateRecord:function(){var e=this.getDeliveryEngine(),t=this.getRecord();t&&e.notifyDataChange({recordId:t.Id})},onHide:function(){h.info("ProuductIQ Home View hiding"),this.__viewHidden=!0},unbindEvents:function(){this.__sfwEngine&&this.__sfwEngine.getEventBus().unbind("SFW_DATA_LOADED",this.sfwDataLoaded,this)},doDestroy:function(){this.unbindSyncEvents(),this.unbindEvents(),this.__sfwEngine&&(this.__sfwEngine.doCleanup(),delete this.__sfwEngine);var e=Ext.ComponentQuery.query("#PIQHomeBackButton");e&&e.length>0&&e[0].destroy(),this.getDeliveryEngine()&&(this.getDeliveryEngine().doCleanup(),this.getDeliveryEngine()),this.callParent()},sfwRunner:function(){this.__sfwEngine.run({translation:"",onReady:{context:this,handler:this.sfwReady}})},sfwReady:function(){this.loadSFWData()},loadSFWData:function(){if(!this.__isWizardLoaded){var e=this.getDeliveryEngine().recordId;this.__sfwEngine.update(e,"")}},sfwDataLoaded:function(e){this.__isWizardLoaded=!0,this.loadAllWizard(e.data)},loadAllWizard:function(e){var t=this,n=i.array.map(e.getWizards(),function(e){var n=i.array.map(e.getActions(),function(e){return"OTHERS"==e.actionType?{xtype:"svmx.button",ui:"svmx-menu-button",html:e.getName(),cls:"x-iconalign-right",iconCls:"icon-online-sfm",handler:i.proxy(t,"wizardClicked",e),disabled:!e.enabled}:{xtype:"svmx.button",ui:"svmx-menu-button",html:e.getName(),handler:i.proxy(t,"wizardClicked",e),disabled:!e.enabled}},t);return n.length&&n.unshift({xtype:"svmx.label",cls:"svmx-wizard-label",html:e.getName(),docked:"top"}),{xtype:"svmx.verticalpanel",halign:"full",items:n}},t);n&&n.length>0?(n[0].items.unshift({xtype:"svmx.label",cls:"svmx-actions-menu-label",html:d().T("FSA008_TAG006","Actions"),docked:"top"}),t.setViewInfo({disableActionMenu:!1,menuItems:n,nameMenuItems:"wizards"})):this.setViewInfo({disableActionMenu:!0})},wizardClicked:function(e){this.__actionPerformed="wizard",this.__actionData=e,this.ibtreeView&&this.ibtreeView.clearAllFiltersForIbSearch(),this.saveRecord(),Ext.Viewport.hideMenu("right")},moveToWizard:function(){var e=this.__actionData;switch(this.__checkForWOinfo(e),e.actionType){case"SFM":this.__performSFMAction(e);break;case"OUTPUT_DOCUMENT":this.__performOUTPUTDOCUMENTAction(e);break;case"CHECKLIST":this.__performChecklistAction(e);break;case"OTHERS":this.__performOthersAction(e);break;default:i.getCurrentApplication().showMessage({text:d().T("FSA008_TAG092","This type of wizard is not yet supported")})}},__checkForWOinfo:function(e){e&&this.__recordOption&&(e.ObjectInfo=this.__recordOption.message)},__performChecklistAction:function(e){this.getRecord(),e.actionType;this.__loadSFMProcess(null,"checklisthomeview",e)},__performOUTPUTDOCUMENTAction:function(e){var t=this.getDeliveryEngine().recordId,n=e.getData().actionDef[i.OrgNamespace+"__Process__r"][i.OrgNamespace+"__ProcessID__c"],a=this.getRecord();if(!t)return void i.getCurrentApplication().showMessage({text:d().T("FSA008_TAG093","You can not generate a document until this record has synced")});var o=r,s=(i.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance(),e.getData().actionDef[i.OrgNamespace+"__Select_Template_At_Runtime__c"]),l=e.getRoot().getDeliveryEngine();o.getProcess({salesforceProcessId:n,onSuccess:i.proxy(this,function(e){var n=e.data.data[0],r={SVMX_processId:n.process_unique_id,SVMX_recordId:t,SVMX_record:a,SVMX_selectTplAtRuntime:s,SVMX_processName:n.process_name,de:l};i.getCurrentApplication().launchConsoleApp("sfmopdocdelivery",r)})})},__performOthersAction:function(e){i.getCurrentApplication().showSpinner();var t=i.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().performAction(e);t=t.fail(i.proxy(this,function(e){i.getCurrentApplication().showMessage(e)})),t=t.always(i.proxy(this,function(){i.getCurrentApplication().hideSpinner()}))},__performSFMAction:function(e){var t=e.getData().actionDef[i.OrgNamespace+"__Process__r"][i.OrgNamespace+"__ProcessID__c"];i.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().__getRealProcessId(t,i.proxy(this,function(t){if(t)this.__loadSFMProcess(t.inProcessId,"edit",e);else{var n=i.getCurrentApplication().getApplicationErrorHandler(),a=d().T("FSA008_TAG094","Process not found; check your configuration");n.notifyApplicationError({message:a})}}))},__loadSFMProcess:function(e,t,n){var i=this.getDeliveryEngine().recordId,a=this.getRecord(),r="",o=null;void 0!==n&&void 0!==n.actionType&&(r=n.actionType),"CHECKLIST"===n.actionType&&(o=this._deliveryEngine),this.__viewHidden=!0,this.changeConsoleApp({app:"sfmdelivery",view:t,options:{SVMX_processId:e,SVMX_recordId:i,SVMX_record:a,SVMX_action:r,parent:o,pageFrom:"ProductIQ"}})},getLeftButton:function(){return{xtype:"svmx.button",text:d().T("FSA017_TAG023","Back"),iconCls:"icon-chevron-left svmx-back-button",itemId:"PIQHomeBackButton",handler:Ext.Function.createBuffered(i.proxy(this,"backTapped"),1e3,this)}},backTapped:function(){this.__actionPerformed="back",this.saveRecord()},goBack:function(){window.cordova&&i.removeMetaTagToAdjustViewPortForOrientation("piqviewport"),this.__updateAttachment(),this.__backButtonTapped=!0;var e=this.getSfmSearchResultsView();if(e&&"PRODUCTIQ"===e.searchType&&e.destroy(),this.unbindSyncEvents(),window.cordova){var t="PORTRAIT";window.isTablet&&(t="BOTH"),SVMXPlugin.setOrientation(t,i.proxy(this,this.done))}else this.done()},done:function(){this.callParent();var e=this;i.getCurrentApplication().showSpinner(),setTimeout(function(){e.destroyObjects(),i.getCurrentApplication().hideSpinner()},1e3)},destroyObjects:function(){this.overviewPanel&&(this.overviewPanel.destroy(),this.overviewPanel=null),this.detailPanel&&(this.detailPanel.destroy(),this.detailPanel=null),this.attachmentPanel&&(this.attachmentPanel.destroy(),this.attachmentPanel=null),this.ibtreeView&&(this.ibtreeView.destroy(),this.ibtreeView=null)},__updateAttachment:function(){var e=i.getClient().getService("com.servicemax.client.attachmentnotifications").getInstance(),t=i.create("com.servicemax.client.lib.api.Event","ATTACHMENT_ON_DEMAND.RELOAD",this,{request:{}});e.triggerEvent(t)},getSfmSearchResultsView:function(){var e=Ext.ComponentQuery.query("sfm\\.search\\.resultview");return 2==e.length?Ext.ComponentQuery.query("sfm\\.search\\.resultview")[1]:Ext.ComponentQuery.query("sfm\\.search\\.resultview")[0]},notifyDataChange:function(){var e=this.getRecord();if(e){var t=[e];i.forEachProperty(e.details,function(e,n){for(var i=0;i<n.lines.length;i++)t.push(n.lines[i])}),o.run(this,"com.servicemax.client.onDataChange",{type:"EDIT",engine:this.getDeliveryEngine(),changedData:t})}},ready:function(){window.cordova?SVMXPlugin.setOrientation("LANDSCAPE",i.proxy(this,this.onPIQInit)):this.onPIQInit()},onPIQInit:function(){window.cordova&&i.fitViewportToOrientation("piqviewport"),this.__contentView?this.updateUI():(this.getDeliveryEngine().createIBSearchDataModel(),this.__config(),this.createIssueIndicator())},getRecord:function(){var e=this.getDeliveryEngine().getMetaModel();if(e){var t=e.__dataModel;if(t){var n=t.__data;if(n){return n.__data.sfmData}}}},updateRecordName:function(){var e=this.getRecord();if(e&&this.__prevSelectedNode&&this.overviewPanel&&this.overviewPanel.doSaveRecord()){var t=e.getNameValue();this.ibtreeView.updateRecordName(this.__prevSelectedNode.id,t)}},updateUI:function(){this.getDeliveryEngine().getMetaModel();this.contentRendered?(this.updateOverview(),this.detailPanel.fetchTemplate()):this.addContentView(this.__prevSelectedNode),this.__onSelectedNode(this.__prevSelectedNode),this.disableDetailsAndAttachment(),this.__sfwEngine&&this.__sfwEngine.doCleanup(),this.__isWizardLoaded=!1,this.__sfwEngine=i.create("com.servicemax.client.sfwdelivery.engine.DeliveryEngineImpl",{}),this.__sfwEngine.getEventBus().bind("SFW_DATA_LOADED",this.sfwDataLoaded,this),this.__sfwEngine.initAsync({context:this,getRecord:this.getRecord,handler:this.sfwRunner})},updateOverview:function(){var e=this.getDeliveryEngine().getMetaModel();this.overviewPanel.updateOverview(e)},buildUI:function(){var e=this;e.setup(),this.ibtreeView=e.__createIbTreeObject();var t=[{xtype:"svmx.horizontalpanel",halign:"full",width:"100%",height:"100%",items:[{xtype:"svmx.verticalpanel",halign:"full",width:"33%",height:"100%",items:[e.ibtreeView]},{xtype:"svmx.verticalpanel",halign:"full",width:"67%",height:"100%",cls:"svmx-piq-right-panel",style:{"border-left":"1px solid gray"},itemId:"contentView"}]}];e.add(t),this.__contentView=this.query("#contentView")[0],this.ibtreeView.on("node_selected",function(e){this.avoidMultipleRunForWO(e)||(this.detailPanel&&(this.detailPanel.__previousButtonSelected=null,this.detailPanel.__taCurrentLMD=null,this.detailPanel.__taPreviousLMD=null),this.__actionPerformed="nodeSelected",this.filterLoading=!1,this.__treeSelectedNode&&this.__treeSelectedNode.recordId===e.recordId&&!this.ibtreeView.__nodeDropped||(this.__treeSelectedNode=e,this.__continueOnSameNode||this.saveRecord()),this.__continueOnSameNode=!1)},this)},avoidMultipleRunForWO:function(e){var t=!0,n=!1,a=this.externalData;this.__firstload||a.object===i.getCustomObjectName("Service_Order")&&(t=!1);this.ibtreeView;if((this.filterLoading||!t)&&a.recordIds&&a.recordIds.indexOf(e.recordId)>=0){a.recordIds[0]!==e.recordId&&(n=!0)}return n},addContentView:function(e){var t=this,n=this.getDeliveryEngine().getMetaModel();this.attachmentPanel=t.createAttachment(),this.detailPanel=t.createDetail(e),this.overviewPanel=t.createOverview(n),this.testAT={title:d().T("FSA017_TAG001","Attachment"),items:[this.attachmentPanel]},this.__tabBar=Ext.create("com.servicemax.client.ui.components.modern.navigation.SVMXTabPanel",{halign:"full",width:"100%",height:"90%",cls:"svmxPiqTabs",tabBar:{border:!0,style:"background-color:transparent;"},items:[{title:d().T("FSA017_TAG011","Overview"),itemId:"piq_Overview",items:[this.overviewPanel]},{title:d().T("FSA017_TAG018","Details"),itemId:"piq_Detail",items:[this.detailPanel]},{title:d().T("FSA017_TAG012","Attachments"),itemId:"piq_Attachment",items:[this.attachmentPanel]}]});var a={xtype:"svmx.toolbar",width:"100%",height:"10%",docked:"top",itemId:"titleBar",cls:"svmxPiqHeaderWrap",items:[{xtype:"svmx.label",text:e.text,docked:"left",itemId:"titleLabel",cls:"svmxPiqTitle"},{xtype:"svmx.button",ui:"svmx-toolbar-btn",html:d().T("FSA004_TAG011","search"),docked:"right",itemId:"searchButton",cls:"svmxPiqSearchBtn",handler:function(){t.__actionPerformed="search",t.saveRecord()}},{xtype:"svmx.button",ui:"svmx-toolbar-btn",html:d().T("FSA011_TAG010","Delete"),docked:"right",itemId:"deleteButton",cls:"svmxPiqDeleteBtn",hidden:!t.__islocalRecord,handler:function(){t.deleteCurrentNode()}}]},r={xtype:"svmx.verticalpanel",halign:"full",width:"100%",height:"100%",items:[a,this.__tabBar]};this.__contentView.add(r),this.contentRendered=!0,this.detailTitle=this.query("#titleLabel")[0],this.searchButton=this.query("#searchButton")[0],this.deleteButton=this.query("#deleteButton")[0],i.getCurrentApplication().hideSpinner(),this.disableDetailsAndAttachment()},moveToSearch:function(){if(this.processID&&this.processName){this.ibtreeView&&(this.ibtreeView.__searchButtonTapped=!0,this.ibtreeView.clearAllFiltersForIbSearch());var e=Ext.create("Ext.data.Model",{searchId:this.processID,name:this.processName,description:""});this.changeView({view:"piqsearchresults",options:{searchId:e.get("searchId"),record:e,searchType:"ProductIQ",accountID:this.externalData.accountId,treeView:this.ibtreeView,isCaching:!0,parent:this}})}else i.getCurrentApplication().showMessage({type:"WARN",title:d().T("FSA017_TAG002","Message"),text:d().T("FSA017_TAG003","Search(SFM) is not configured for this profile."),buttons:[{text:d().T("FSA016_TAG003","OK"),itemId:"OK"}]})},setup:function(){var e={deliveryEngine:this.getDeliveryEngine()};this.rootModel=i.create("com.servicemax.client.productIQ.ui.largemodern.metamodel.Root",e),this.rootModel.initialize()},overviewSaveDone:function(){this.updateRecordName();var e=this.detailPanel;e&&e.shouldUpdateTemplateData&&e.updateTemplateData();var t=this.__actionPerformed;"nodeSelected"===t?this.treeNodeSelected():"back"===t?this.goBack():"wizard"===t?this.moveToWizard():"search"===t&&this.moveToSearch(),this.overviewPanel&&this.overviewPanel.doSaveRecord()&&this.notifyDataChange()},saveRecord:function(){if(!this.popupShown){this.issueIndicator&&this.issueIndicator.hide();var e=void 0;this.__prevSelectedNode&&(e=this.ibtreeView.__tree.getStore().getNodeById(this.__prevSelectedNode.id)),this.overviewPanel&&this.overviewPanel.doSaveRecord()&&!p&&!this.ibtreeView.__nodeDropped&&e?this.overviewPanel.quickSave():(p=!1,this.overviewSaveDone()),this.__deleteAttachmentReference()}},__deleteAttachmentReference:function(){var e=s.readFromJSCache("attachedFileDetails","deletedAttachments");this.__deleteAttachments(e);var t=s.readFromJSCache("attachedFileDetails","deletedContentVersions");if(t){var n=t.cDIds,i=t.parentIdMap;n&&n.length>0&&c.deleteContentVersions(n,i)}s.clearJSCache("attachedFileDetails")},__deleteAttachments:function(e){if(e){var t=i.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DELETE_ATTACHMENTS",this,{request:{deliveryEngine:this.getDeliveryEngine(),recordId:this.getDeliveryEngine().getRecordId(),data:e},responder:i.create("com.servicemax.client.sfmdelivery.responders.CancelAttachmentsResponder",this)});this.getDeliveryEngine().getEventBus().triggerEvent(t)}},treeNodeSelected:function(){if(this.removeCls("svmx-productiqwindow-alert"),this.__treeSelectedNode){var e=this.__treeSelectedNode;if(!this.__prevSelectedNode||this.__prevSelectedNode.recordId!==e.recordId||this.ibtreeView.__nodeDropped){this.ibtreeView.__nodeDropped=!1,this.__newnodeCreated=!1,this.__tabBar&&this.__tabBar.setIndex(0),this.__prevSelectedNode=e,this.hideDeleteButton(),this.detailPanel&&this.detailPanel.setSelectedNode(e),i.getCurrentApplication().showSpinner(),this.contentRendered&&this.detailTitle.setHtml(e.text);var t=void 0;if("IB"===e.nodeType?t=this.__ibEditProcess&&"--None--"!=this.__ibEditProcess.processId?this.__ibEditProcess.sfdcId:"":"LOCATION"===e.nodeType&&(t=this.__locEditProcess?this.__locEditProcess.sfdcId:""),""!=t)i.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().__getRealProcessId(t,i.proxy(this,function(t){if(t){var n={SVMX_recordId:e.recordId,SVMX_processId:t.inProcessId};this.loadPIQProcess(n)}else{var a=i.getCurrentApplication().getApplicationErrorHandler(),r=d().T("FSA008_TAG094","Process not found; check your configuration");this.getDeliveryEngine().setErrorMsg(r),a.notifyApplicationError({message:r});var n={SVMX_recordId:e.recordId,SVMX_processId:"process not found"};this.loadPIQProcess(n)}}));else{var n={SVMX_recordId:e.recordId,SVMX_processId:""};this.loadPIQProcess(n)}}}},hideDeleteButton:function(){4!==this.__prevSelectedNode.id.indexOf("local")?this.__islocalRecord=!1:this.__islocalRecord=!0,this.deleteButton&&(this.__islocalRecord&&!this.__syncStarted?this.deleteButton.setHidden(!1):this.deleteButton.setHidden(!0))},loadPIQProcess:function(e){this.__firstload=!0,this.getDeliveryEngine().run(e)},__config:function(){var e,e=i.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_DETAILPAGEINFO",this,{request:{context:this,params:{},iBReferenceInfo:{}}}),t=this.getDeliveryEngine().getEventBus();t.triggerEvent(e),this.getSearchProcessID()},onDataPageInfoComplete:function(e){var t=JSON.parse(e[0].Value),n=t.search;if(n&&n.length>0){if(n[0].searches.length>0){var i=n[0].searches[0].searchfields;this.isSearchConfiguration=i.length>0}}else this.isSearchConfiguration=!1;t.ibEditProces&&t.ibEditProces.length>0&&(this.__ibEditProcess=t.ibEditProces[0]),t.locationEditProces&&t.locationEditProces.length>0&&(this.__locEditProcess=t.locationEditProces[0]),this.buildUI();var a=t.isTechnicalAttributesEnabled;a&&(this.isDetailEnabled="true"===a),t.attachment?this.isAttachmentEnabled="true"===t.attachment[0].isAttachmentsEnabled:this.isAttachmentEnabled=!0},__removeDetailItemFromTab:function(e){e?this.__tabBar.child("#piq_Detail").tab.show():this.__tabBar.child("#piq_Detail").tab.hide()},__removeAttachmentItemFromTab:function(e){e?this.__tabBar.child("#piq_Attachment").tab.show():this.__tabBar.child("#piq_Attachment").tab.hide()},disableDetailsAndAttachment:function(){var e=!1;(this.getDeliveryEngine().isNotQualified()||this.getDeliveryEngine().isNotAssigned())&&(e=!0),this.__tabBar.child("#piq_Detail").tab.setDisabled(e),this.__tabBar.child("#piq_Attachment").tab.setDisabled(e),this.__removeAttachmentItemFromTab(this.isAttachmentEnabled)},__createIbTreeObject:function(){var e=null,t=i.getClient().getDeclaration("com.servicemax.client.productIQ.ibtree");if(t){var n=i.getClient().getDefinitionsFor(t);if(n&&n.length>0){var a=n[0],r=a.config["class-name"];e=i.create(r,{deliveryEngine:this.getDeliveryEngine(),message:this.externalData,meta:this.rootModel,cls:"svmxSidebarTreeWrap",parent:this})}}return e},createAttachment:function(){var e=null,t=i.getClient().getDeclaration("com.servicemax.client.productIQ.attachment"),n="";if(this.externalData.recordIds&&this.externalData.recordIds.length>0&&(n=this.externalData.recordIds[0]),t){var a=i.getClient().getDefinitionsFor(t);if(a&&a.length>0){var r=a[0],o=r.config["class-name"];e=i.create(o,{deliveryEngine:this.getDeliveryEngine(),tree:this.ibtreeView,recordId:n})}}return e},createDetail:function(e){var t=null,n=i.getClient().getDeclaration("com.servicemax.client.productIQ.detail");if(n){var a=i.getClient().getDefinitionsFor(n);if(a&&a.length>0){var r=a[0],o=r.config["class-name"];t=i.create(o,{deliveryEngine:this.getDeliveryEngine(),parent:this,selectedNode:e})}}return t},createOverview:function(e){var t=null,n=i.getClient().getDeclaration("com.servicemax.client.productIQ.overview");if(n){var a=i.getClient().getDefinitionsFor(n);if(a&&a.length>0){var r=a[0],o=r.config["class-name"];t=i.create(o,{deliveryEngine:this.getDeliveryEngine(),model:e,parent:this,tree:this.ibtreeView})}}return t},restore:function(e){this.overviewPanel.restore(e)},deleteCurrentNode:function(){i.Msg.confirm({title:d().T("FSA008_TAG083","Remove"),text:d().T("FSA008_TAG027","Are you sure you want to delete this record?"),buttons:[{text:d().T("FSA012_TAG022","Yes"),itemId:"YES"},{text:d().T("FSA016_TAG002","No"),itemId:"NO"}]}).then(i.proxy(this,function(e){"YES"==e&&this.ibtreeView.deleteFromTree(this.__prevSelectedNode)}))},deleteRecord:function(e,t){this.overviewPanel.deleteRecord(e,t)},onDeleteRecordsComplete:function(e){this.overviewPanel.onDeleteRecordsComplete()},addNew:function(e,t){this.overviewPanel.addNew(e,t)},__onSelectedNode:function(e){this.isDetailEnabled?"LOCATION"==e.nodeType?this.__removeDetailItemFromTab(!1):this.__removeDetailItemFromTab(!0):this.__removeDetailItemFromTab(!1)},getSearchProcessID:function(){var e,e=i.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_SEARCHPROCESSIB",this,{request:{context:this,handler:this.onSearchProcessIDCompletion}}),t=this.getDeliveryEngine().getEventBus();t.triggerEvent(e)},onSearchProcessIDCompletion:function(e){e.length>0&&(this.processID=e[0].Id,this.processName=e[0].processName)},createIssueIndicator:function(){this.issueIndicator=i.create("com.servicemax.client.sfmdelivery.ui.largemodern.editview.IssueIndicator",{}),this.add(this.issueIndicator)},__handleValidationError:function(e,t){var n=e.data.request.result,i=n.errors.length,a=n.warnings.length;this.unblockApplication(),(i||a)&&(this.issueIndicator.setIssues(n),this.issueIndicator.hasUnconfirmedIssues()||i?(this.issueIndicator.showIssues(),this.confirmCancel()):(this.issueIndicator.hide(),this.confirmValidationWarning(e.data.request.original,t)))},confirmCancel:function(){var e=this;e.popupShown=!0,i.Msg.confirm({title:d().T("FSA017_TAG019","Discard Changes?"),text:d().T("FSA017_TAG013","Issues found. Do you wish to discard the changes or continue editing?"),buttons:[{text:d().T("FSA017_TAG020","Continue Editing"),cls:"svmx-msg-button-default",itemId:"CONTINUE"},{text:d().T("FSA017_TAG021","Discard Changes"),cls:"svmx-msg-button",itemId:"DISCARD"}]}).then(i.proxy(this,function(t){if(e.popupShown=!1,"DISCARD"==t){this.__continueOnSameNode=!1,this.issueIndicator&&this.issueIndicator.hide();var n=this.ibtreeView;n.__nodeDragged&&(n.updateHierarchy(),n.selectTreeNode(this.__prevSelectedNode.id,{})),this.overviewSaveDone(),"wizard"!==this.__actionPerformed&&"search"!==this.__actionPerformed||(this.__prevSelectedNode=null,this.treeNodeSelected())}else if(this.addCls("svmx-productiqwindow-alert"),this.__prevSelectedNode.id){this.__continueOnSameNode=!0;var i=this.ibtreeView,a=i.__filterExpressions;a&&a.length>0||i.__isWorkOrderFilterChecked?(i.__selectedNodeId=this.__prevSelectedNode.id,i.clearAllFiltersForIbSearch()):(i.__tree._selection.id===this.__prevSelectedNode.id&&(this.__continueOnSameNode=!1),i.selectTreeNode(this.__prevSelectedNode.id,{}))}}))},confirmValidationWarning:function(e,t){this.blockApplication();var n=e.request;t?n.confirmed=!0:n.fieldValidatioConfirmed=!0;var a=i.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.SAVE_TARGETRECORD",this,{request:n,responder:e.responder});this.getDeliveryEngine().getEventBus().triggerEvent(a)}}),Ext.define(f+".PIQResultsView",{extend:"com.servicemax.client.sfmsearchdelivery.ui.largemodern.resultview.ResultsView",alias:"widget.sfm.productIQ.resultview",ui:"svmx-default",__selected:null,config:{model:null},__syncManager:null,__syncImpl:null,__recordSelected:null,connectivityCheckTasks:{},statics:{downloadCount:0,maxParallelDownloadCount:3},constructor:function(e){this.callSuper(arguments),this.__recordSelected=!1},ready:function(){Ext.StoreManager.lookup("operatorStore")||Ext.create("com.servicemax.client.sfmsearchdelivery.ui.largemodern.homeview.KeyValueStore",{storeId:"operatorStore",data:[{opValue:"Contains",opLabel:d().T("FSA004_TAG024","Contains")},{opValue:"Starts With",opLabel:d().T("FSA004_TAG025","Starts With")},{opValue:"Ends With",opLabel:d().T("FSA004_TAG026","Ends With")},{opValue:"Exact Match",opLabel:d().T("FSA004_TAG012","Exactly")}]}),this.callSuper(),this.setViewInfo({disableNavMenu:!0,hideBackButton:!0});var e=this.query("#searchBar")[0];e&&(e.addCls("piqsearch-search-bar"),e.enable(),e.getComponent("includeOnline")&&e.getComponent("includeOnline").setHidden(!0),e.getComponent("includeOnlineLabel")&&e.getComponent("includeOnlineLabel").setHidden(!0))},onRecordSelected:function(e){if(!1===this.__recordSelected){this.__recordSelected=!0;var t={};if(t.action="VIEW",t.recordIds=[e.data.Id],t.object=i.getCustomObjectName("Installed_Product"),this._options.treeView&&(p=!0,this._options.treeView.reloadTreeViewData(t)),this._options){var n=this._options.parent.getSfmSearchResultsView();n&&"PRODUCTIQ"===n.searchType.toUpperCase()&&setTimeout(function(){n.destroy()},100)}this.done()}},getLeftButton:function(){return{xtype:"svmx.button",text:d().T("FSA017_TAG023","Back"),iconCls:"icon-chevron-left svmx-back-button",itemId:"PIQSearchBackButton",handler:Ext.Function.createBuffered(i.proxy(this,"backTapped"),1e3,this)}},backTapped:function(){var e=this._options;if(e){var t=e.parent.getSfmSearchResultsView();t&&"PRODUCTIQ"===t.searchType.toUpperCase()&&setTimeout(function(){t.destroy()},100),e.parent.__searchBackTapped=!0,e.parent.updateTreeView()}this.done()},onHide:function(){var e=this._options;e&&(e.parent.__searchBackTapped=!1)},destroy:function(){this.destroying=!0,this.callParent(),Ext.dom.GarbageCollector.collect(),this.destroying=!1}}),i.defineGlobal(u.name,u),e.exports=u},function(e,t,n){function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),o=a(r),s=n(2),l=a(s),c=n(6),u=a(c),d=n(3),_=a(d),h=n(4),f=a(h),p=n(16),m=a(p),v=n(10),g=n(0).utils,y=(n(22).View,n(19).impl),S=n(12).DatetimeUtil,E=n(5).SVMXObject,b={name:"com.servicemax.client.productIQ.ui.largemodern.ibtree"},T=n(891),M=function(){return g.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},I=g.getLoggingService().getLogger("ProductIQ-UI"),C=(b.name,y),A=S;Ext.define("com.servicemax.client.productIQ.ui.largemodern.ibtree.IBTree",{extend:C.name+".SVMXPanel",alias:"widget.productIQ.ibTree",width:"100%",height:"100%",__meta:null,__tree:null,__treeData:null,__treeDataById:null,__expandedById:null,__searchText:null,__optionsPanel:null,__filterExpressions:null,__transientFilters:null,__allNodeFilters:null,__appliedNodeFilters:null,__productIconIndex:null,__transientRecordIndex:null,__locationsVisible:!0,__swappedVisible:!0,__selectedNodeId:null,__accountsMenubarButton:null,__selectedAccountName:null,__currentAccountId:null,__selectedAccountId:null,__isAccountChanged:null,__isWorkOrderFilterChecked:null,__selectedWorkOrderFilterData:null,__root:null,__selectFromRegisterExternal:null,__IBReferenceINFO:null,__isDataSyncTriggerd:null,__deliveryEngine:null,resizable:!0,__externalData:null,__treeViewPanel:null,__isTreeViewDataRefreshing:null,__showAlertMessage:null,__searchButtonTapped:null,__nodeDropped:!1,__nodeDragged:!1,__firstNodeIB:null,constructor:function(e){var t=this;this.__showAlertMessage=!0,this.__searchButtonTapped=!1,this.__deliveryEngine=e.deliveryEngine,this.__meta=e.meta,this.__expandedById={},this.__externalData=e.message,this.__parent=e.parent,this.__eventType="",this.__batchSize=50,this.__touchDevice="ontouchstart"in window;var n=g.toObject(this.__externalData);n&&(n.object===g.getCustomObjectName("Service_Order")&&(this.__selectedWorkOrderFilterData=n),this.__currentAccountId=n.accountId),this.__getIBReference(),this.__transientFilters=[],this.__setupNodeFilters(),this.__isTreeViewDataRefreshing=!1;var i=this.__getFilterOptions(),a=i,r=g.create("Ext.Panel",{layout:{type:"vbox"},collapsible:!0,cls:"svmxOptionsPanel",items:a,itemId:"svmx-options-panel",style:{"border-bottom":"1px solid gray"},header:!1,collapsed:!0,width:"100%"});r.setHidden(!0),this.__meta.bind("MODEL.UPDATE",function(e){this.__refreshFilterOptions()},this);var o={},s=Ext.create("com.servicemax.client.ui.components.modern.data.SVMXTreeStore",{root:o,listeners:{nodeexpand:function(e,n){var i=t.__treeDataById[e.id];if(i){i.expanded=!0;for(var a=t.__treeDataById[i.parentId];a;)a.expanded=!0,a=t.__treeDataById[a.parentId];t.__expandedById[e.id]=!0}"IB"==e.data.nodeType?setTimeout(function(){t.__showMore({node:e})},1):setTimeout(function(){t.__expandLocationNode(e)},1)},nodecollapse:function(e,n){var i=t.__treeDataById[e.id];i&&(i.expanded=!1,t.__expandedById[e.id]=!1)}}}),l=Ext.create("com.servicemax.client.productIQ.ui.largemodern.ibtree.SVMXTreeview",{store:s,rootVisible:!0,width:"100%",itemId:"svmx-treeList",userCls:"svmx-piq-installbase-tree",listeners:{selectionchange:function(){if(t.__nodeDragged)return void(t.__selectedNodeId&&t.selectTreeNode(t.__selectedNodeId));t.__selectedNodeId=this._selection.data.recordId,t.removeSelector(),t.addSelector(this._selection),t.fireEvent("node_selected",t.__treeDataById[this._selection.data.recordId]);var e=v("li.x-treelist-item-selected").position().top,n=v(".svmxTreePanel").height();if(e+96>=n&&!0===t.__isTreeViewDataRefreshing){var i=e-n+96;setTimeout(function(){v(".svmxTreePanel>div").scrollTop(i)},1500)}t.__isTreeViewDataRefreshing=!1},refresh:function(){this.element&&this.element.setTouchAction({panY:!0})}},plugins:[{type:"DragandDrop",listeners:{beforedragstart:function(e,n,i){t.__touchDevice||(t.__nodeDragged=!0);var a=i.getTarget("[data-recordId]"),r=void 0,o=t.__parent.__syncStarted;if(a&&(r=a.getAttribute("data-recordId"),a=this.cmp.itemMap[r])){var s=a._node.id;if(s===t.__tree._selection.id&&(!o||!s.match("local")&&!t.childHasLocalRecord(a._node)))return t.__tree.dragStarted=!0,t.__touchDevice&&t.__tree.parent&&t.__tree.parent.getScrollable()&&t.__tree.parent.getScrollable().setY&&t.__tree.parent.getScrollable().setY(!1),!0}return!1},dragend:function(e,n,i){t.__nodeDragged=!1,t.__tree.dragStarted=!1,t.__touchDevice&&t.__tree.parent&&t.__tree.parent.getScrollable()&&t.__tree.parent.getScrollable().setY&&t.__tree.parent.getScrollable().setY(!0);var a=i.getTarget("[data-recordId]"),r=void 0;if(a){if(r=a.getAttribute("data-recordId"),a=this.cmp.itemMap[r],t.__tree.dragOverNode&&t.__touchDevice){t.getDragNodeRow(t.__tree.dragOverNode).removeCls("x-treelist-row-over")}a&&t.__handleDropOn(a._node)}},dragmove:function(e,n,i){var a=i.getTarget("[data-recordId]"),r=void 0;if(a){if(r=a.getAttribute("data-recordId"),a=this.cmp.itemMap[r],t.__touchDevice){if(t.__tree.prevDragNode){t.getDragNodeRow(t.__tree.prevDragNode).removeCls("x-treelist-row-over")}if(t.__tree.dragOverNode){t.getDragNodeRow(t.__tree.dragOverNode).addCls("x-treelist-row-over")}}if(a){var o=Ext.dom.Query.select(".x-drag-dragging"),s=Ext.get(o[0]);s&&(t.__canDropOn(a._node)?(s.removeCls("svmPiqTreeInvalidDrop"),s.addCls("svmPiqTreeValidDrop")):(s.removeCls("svmPiqTreeValidDrop"),s.addCls("svmPiqTreeInvalidDrop")))}}}}}]}),c=g.create("Ext.Panel",{layout:{type:"vbox"},itemId:"svmx-tree-panel-view",collapsible:!0,items:[l],width:"100%",scrollable:"true",cls:"svmxTreePanel"}),u=g.create("com.servicemax.client.ui.components.modern.controls.impl.SVMXPanel",{dock:"top",height:40,width:"100%",layout:"hbox",align:"stretchmax",cls:"svmxTopPanel",style:{"border-bottom":"1px solid gray"},items:[{xtype:"svmx.label",text:n.accountName,textAlign:"center",width:"70%",cls:"svmx-piq-tree-account-name-label",style:{"margin-top":"10px","margin-left":"10px"}},{xtype:"button",cls:"svmx-piq-filter-button",textAlign:"right",width:"30%",text:M().T("FSA008_TAG055","Filter"),style:{"margin-top":"5px","margin-left":"-15px"},handler:function(){t.toggleOptions()}}]});e=Ext.apply({layout:{type:"vbox"},scrollable:"y",dockedItems:[{dock:"top",xtype:"toolbar",style:"background-color: #fff",margin:"10 10"}],items:[u,r,c]},e||{}),this.callParent([e]),this.__optionsPanel=this.down("#svmx-options-panel"),this.__tree=this.down("#svmx-treeList"),this.__treeViewPanel=this.down("#svmx-tree-panel-view"),this.getIBTreeData(n),this.__tree.el.on("pointerdown",function(e){if(e.parentEvent){if(""===t.__eventType){var n=t.__tree.getPlugin();n&&("touchstart"===e.parentEvent.type?n.source.setActivateOnLongPress(!0):n.source.setActivateOnLongPress(!1))}t.__eventType=e.parentEvent.type}}),this.__tree.el.on("mouseup",function(e){t.__eventType=""})},getDragNodeRow:function(e){var t=e.el&&e.el.dom,n=e;return t&&t.childNodes.length&&(n=Ext.get(t.childNodes[0])),n},doDestroy:function(){if(this.__meta&&this.__meta.unbind("MODEL.UPDATE",function(e){this.__refreshFilterOptions()},this),this.__tree&&(this.__tree.el.un("pointerdown",function(e){}),this.__tree.el.un("mouseup",function(e){})),this.__meta&&(this.__meta.doCleanup(),delete this.__meta),this.__treeData&&(this.__treeData=null,delete this.__treeData),this.__filterExpressions&&(this.__filterExpressions.length=0),this.__transientFilters&&(this.__transientFilters.length=0),this.__IBsData&&(this.__IBsData=null,delete this.__IBsData),this.__ibsById&&(this.__ibsById=null,delete this.__ibsById),this.__locationsData&&(this.__locationsData=null,delete this.__locationsData),this.__locationsById&&(this.__locationsById=null,delete this.__locationsById),this.__sublocationsData&&(this.__sublocationsData=null,delete this.__sublocationsData),this.__accountsById&&(this.__accountsById=null,delete this.__accountsById),this.__locationPath&&(this.__locationPath=null,delete this.__locationPath),this.__tree&&this.__tree.getStore()){var e=this.__tree.getPlugin();e&&e.destroy(),this.__tree.getStore().removeAll(),this.__tree.getStore().setRootNode(null),this.__tree.getStore().sync(),Ext.data.StoreManager.unregister(this.__tree.getStore()),this.__tree.getStore().destroy(),this.__tree.setStore(null),this.__tree.removeRoot(),this.__tree.destroy(),this.__tree=null}Ext.dom.GarbageCollector.collect(),this.callParent()},treeLoadCompleted:function(e){(e&&!0===e.viaFilter||!0===this.__isWorkOrderFilterChecked)&&(this.__isTreeViewDataRefreshing=!0),this.__selectFromExternal=!1},childHasLocalRecord:function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.data.id.match("local"))return!0;if(n.data.allIBsLoaded)return this.childHasLocalRecord(n)}},getIBTreeData:function(e){null!=this.__currentAccountId?this.refreshContent():this.showErorrMessageForAccount()},showErorrMessageForAccount:function(){g.getCurrentApplication().showMessage({text:M().T("FSA017_TAG005","The selected record does not have an account associated with it. Please contact your administrator to resolve this issue."),buttons:[{text:M().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:g.proxy(this,function(){})})},reloadTreeViewData:function(e){if(void 0!==e.recordIds){e.recordIds[0];this.__currentAccountId?(e.accountId=this.__currentAccountId,this.__selectedNodeId=null,e.object===g.getCustomObjectName("Installed_Product")||e.object===g.getCustomObjectName("Site")?this.__isIBorLocationRecordSelected=!0:this.__isIBorLocationRecordSelected=!1,this.__selectFromRegisterExternal=!0,this.__isAccountChanged=!1,this.__externalData=e,this.refreshContent()):this.showErorrMessageForAccount()}},clearAllFiltersForIbSearch:function(){var e=this;if(e.__optionsPanel.items)for(var t=e.__optionsPanel.items.items,n=0;n<t.length;n++){var i=t[n];i.setChecked(!1)}},__getFilterOptions:function(){var e=this;this.__filterExpressions||(this.__filterExpressions=[]);var t=[];if(this.__meta.filters&&this.__meta.filters.length){for(i=0;i<this.__meta.filters.length;i++){var n=this.__meta.filters[i],a=n.name,r=g.create("com.servicemax.client.ui.components.modern.controls.form.SVMXCheckboxField",{name:a,label:a,cls:"svmx-piq-checkbox",labelAlign:"left",filterExpression:n.expression,inputValue:i,value:"",margin:"0 0 0 5",listeners:{change:function(t,n){e.__selectFilterExpressions()}}});t.push(r)}this.__meta.state&&this.__meta.state.filters&&g.doLater(function(){e.__selectFilterExpressions()})}return t},setTreeViewPanelHeight:function(){var e=v(".svmxOptionsPanel").height(),t=e+91;v(".svmxTreePanel").css({height:"calc(100vh - "+t+"px)"})},__selectFilterExpressions:function(){this.__filterExpressions=[];var e=void 0,t=this.__optionsPanel.items.getCount();for(e=0;e<t;e++){var n=this.__optionsPanel.items.getAt(e);n._checked&&n.filterExpression&&this.__filterExpressions.push(n.filterExpression)}this.refreshContent({viaFilter:!0})},__refreshFilterOptions:function(){var e=this.__getFilterOptions(),t=void 0,n=this.__optionsPanel.items.getCount();for(t=0;t<n;t++){var i=this.__optionsPanel.items.getAt(t);i.filterExpression||e.push(i)}for(this.__optionsPanel.removeAll(!1),t=0;t<e.length;t++)this.__optionsPanel.add(e[t])},getFilterExpressions:function(){return this.__filterExpressions},toggleOptions:function(){!0===this.__optionsPanel._hidden?this.__optionsPanel.setHidden(!1):this.__optionsPanel.setHidden(!0),this.setTreeViewPanelHeight()},getOptionsPanel:function(){return this.__optionsPanel},__getEventBus:function(){return this.__deliveryEngine.getEventBus()},__getIBReference:function(){var e=this;this.getIbLookupFieldInfoRelation("IB").execute().done(function(t){e.__IBReferenceINFO=e.getRelationshipNames(t)})},getIbLookupFieldInfoRelation:function(e){var t=g.create("com.servicemax.client.offline.sal.model.productiq.utils.Query",{});return t.select("reference_To, relationship_name, api_name,type").from("SFObjectField"),t.where("object_api_name='"+g.getCustomObjectName("Installed_Product")+"'"),t},getRelationshipNames:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n];t[i.api_name]=i}return t},refreshContent:function(e){if(this.__currentAccountId){var t=this;this.__isTreeViewDataRefreshing=!0;var n=!0;e&&("initialize"==e.type||(e.params&&e.params.syncType&&("initial"==e.params.syncType||"reset"==e.params.syncType||"ib"==e.params.syncType||"insert_local_records"===e.params.syncType)?this.fireEvent("reset"):n=!1),void 0!==e.viaFilter&&1==e.viaFilter&&(t.__showAlertMessage=!1,t.__parent.filterLoading=!0,setTimeout(function(){t.__refreshContentInternal(e)},50))),n&&(t.__showAlertMessage=!0,setTimeout(function(){t.__refreshContentInternal()},50))}},__refreshContentInternal:function(e){g.getCurrentApplication().hideSpinner(this.__parent),g.getCurrentApplication().showSpinner(this.__parent),this.__currentAccountId&&(e?e.accountId=this.__currentAccountId:e={accountId:this.__currentAccountId});var t=g.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_TOP_LEVEL_IBS",this,{request:{context:this,params:e,iBReferenceInfo:this.__IBReferenceINFO}});this.__getEventBus().triggerEvent(t)},onGetTopLevelIBsComplete:function(e){this.__loadTreeData(e)},installbasePredicate:function(){for(var e=[],t=arguments.length,n=void 0,i=void 0,a=void 0,r=function(e,t){return e===t?0:e<t?-1:1},o=0;o<t;o++)n=arguments[o],"string"==typeof n?(i=n,a=r):(i=n.name,a=function(e,t){var n=r,i=r;return e&&(i=function(t,i){return n(e(t),e(i))}),t?function(e,t){return-1*i(e,t)}:i}(n.primer,n.direction)),e.push({name:i,comparator:a});return function(i,a){for(var r=void 0,o=void 0,s=0;s<t;s++){o=0,n=e[s],r=n.name;var l=i[r],c=a[r];if(l&&"string"==typeof l&&(l=l.toLowerCase()),c&&"string"==typeof c&&(c=c.toLowerCase()),0!==(o=n.comparator(l,c)))break}return o}},__getDateWithHoursAndTime:function(e){return A.getFormattedDatetime(e,"YYYY-MM-DD HH:mm")},multicolumnSortForIBRecords:function(e){for(var t=0;t<e.length;t++){var n=e[t],i=n.LastModifiedDate;i&&i.length>10&&(i=this.__getDateWithHoursAndTime(i));var a=n.IBAttributeInstanceLastModDate;a&&a.length>10&&(a=this.__getDateWithHoursAndTime(a));var r=n.AttachementLastModDate;r&&r.length>10&&(r=this.__getDateWithHoursAndTime(r));var o=i;i>a&&i>r?o=i:a>i&&a>r?o=a:r>i&&r>a&&(o=r),e[t].SortDate=o}return e.sort(this.installbasePredicate({name:"SortDate",direction:!0},"Name")),e},multicolumnSortForLocationsRecords:function(e){for(var t=0;t<e.length;t++){var n=e[t],i=n.LastModifiedDate;i&&i.length>10&&(i=this.__getDateWithHoursAndTime(i));var a=n.AttachementLastModDate;a&&a.length>10&&(a=this.__getDateWithHoursAndTime(a));var r=i;r=i>a?i:a,e[t].SortDate=r}return e.sort(this.installbasePredicate({name:"SortDate",direction:!0},"Name")),e},__loadTreeData:function(e){function t(e){var t=T.stringify(e);return T.parse(t)}function n(e){console.warn("Tree structure invalid: Location "+e.id+" parent "+e.parentType+" "+e.parentId+" not found")}var i=this,a=e.params,r=void 0,o=void 0,s=void 0,l=void 0,c={root:{expanded:!0,children:[]}};this.__locationsData={},this.__IBsData={},this.__sublocationsData={};var u={},d={},_={};e=e||[],e.ibs&&(e.ibs=this.multicolumnSortForIBRecords(e.ibs)),e.locations&&(e.locations=this.multicolumnSortForLocationsRecords(e.locations)),e.templates&&this.__indexProductIconsFromTemplates(e),e.transients&&(this.__transientRecordIndex=e.transients);var h={};if(e.accounts)for(r=0;r<e.accounts.length;r++){o=e.accounts[r];var f={id:o.Id,text:o.Name||"(Acc) "+o.Id,icon:"modules/com.servicemax.client.productIQ.ui.largemodern/resources/images/custom/dummy-icon5.png",children:[],nodeType:"ACCOUNT",recordId:o.Id};h[o.Id]=f}var p={};if(e.locations)for(r=0;r<e.locations.length;r++){o=e.locations[r],o[g.getCustomFieldName("Parent")]?(s=o[g.getCustomFieldName("Parent")],l="LOCATION"):o[g.getCustomFieldName("Account")]&&(s=o[g.getCustomFieldName("Account")],l="ACCOUNT");var m={id:o.Id,text:o.Name||"(Loc) "+o.Id,iconCls:"svmx-piq-tree-node-icon svmx-piq-location-node",children:[],nodeType:"LOCATION",recordId:o.Id,parentId:s,parentType:l};u[s]=u[s]||[],u[s].push(m),p[o.Id]=m}var v={};if(e.sublocations)for(r=0;r<e.sublocations.length;r++){o=e.sublocations[r],o[g.getCustomFieldName("Parent")]?(s=o[g.getCustomFieldName("Parent")],l="SUBLOCATION"):o[g.getCustomFieldName("Location")]&&(s=o[g.getCustomFieldName("Location")],l="LOCATION");var y={id:o.Id,text:o.Name||"(Sub) "+o.Id,iconCls:"svmx-piq-tree-node-icon svmx-piq-sublocation-node",children:[],nodeType:"SUBLOCATION",recordId:o.Id,parentId:s,parentType:l};_[s]=_[s]||[],_[s].push(y),v[o.Id]=y}var S={};if(e.ibs)for(r=0;r<e.ibs.length;r++){if(o=e.ibs[r],o[g.getCustomFieldName("Parent")])s=o[g.getCustomFieldName("Parent")],l="IB";else if(o[g.getCustomFieldName("Sub_Location")])s=o[g.getCustomFieldName("Sub_Location")],l="SUBLOCATION";else if(o[g.getCustomFieldName("Site")])s=o[g.getCustomFieldName("Site")],l="LOCATION";else{if(!o[g.getCustomFieldName("Company")])continue;s=o[g.getCustomFieldName("Company")],l="ACCOUNT"}var E=[];o.hasChild&&(E=[this.__getLoadingNodeObject()]);var b={id:o.Id,text:o.Name||"(IB) "+o.Id,iconCls:i.__getIconFor(o,"IB"),children:E,nodeType:"IB",recordId:o.Id,serialNo:o[g.getCustomFieldName("Serial_Lot_Number")],isSwapped:o[g.getCustomFieldName("IsSwapped")],parentId:s,parentType:l};d[s]=d[s]||[],d[s].push(b),S[o.Id]=b}this.__locationsById=p,this.__accountsById=h,this.__ibsById=S;var M=void 0,I=void 0;for(M in p)I=p[M],"LOCATION"===I.parentType&&p[I.parentId]?p[I.parentId].childrenAdded||(p[I.parentId].childrenAdded=!0,p[I.parentId].children=[this.__getLoadingNodeObject()]):"ACCOUNT"===I.parentType&&h[I.parentId]?h[I.parentId]&&h[I.parentId].children.push(I):n(I);for(M in v)I=v[M],"LOCATION"===I.parentType&&p[I.parentId]?p[I.parentId].childrenAdded||(p[I.parentId].childrenAdded=!0,p[I.parentId].children=[this.__getLoadingNodeObject()]):"SUBLOCATION"===I.parentType&&v[I.parentId]?v[I.parentId].childrenAdded||(v[I.parentId].childrenAdded=!0,v[I.parentId].children=[this.__getLoadingNodeObject()]):n(I);for(M in S)I=S[M],"ACCOUNT"===I.parentType&&h[I.parentId]?h[I.parentId].children.push(I):"LOCATION"===I.parentType&&p[I.parentId]?p[I.parentId].childrenAdded||(p[I.parentId].childrenAdded=!0,p[I.parentId].children=[this.__getLoadingNodeObject()]):"SUBLOCATION"===I.parentType&&v[I.parentId]?v[I.parentId].childrenAdded||(v[I.parentId].childrenAdded=!0,v[I.parentId].children=[this.__getLoadingNodeObject()]):"IB"===I.parentType&&S[I.parentId]?S[I.parentId].children.push(I):n(I);if(this.__currentAccountId)for(M in h){I=h[M];var C=I.children;if(C)for(r=0;r<C.length;r++){var A=C[r];c.root.children.push(A)}}else for(M in h)I=h[M],c.root.children.push(I);try{this.__locationsData=g.cloneObject(u)}catch(e){this.__locationsData=t(u)}try{this.__sublocationsData=g.cloneObject(_)}catch(e){this.__sublocationsData=t(_)}try{this.__IBsData=g.cloneObject(d)}catch(e){this.__IBsData=t(d)}this.refreshTopLevel?(this.refreshTopLevel=!1,this.__setTreeData(c,!0),this.__parent.validationCheckForCreatedNode()):this.onDataLoadComplete(c,a)},__getLoadingNodeObject:function(){return{text:M().T("FSA017_TAG014","Please wait"),iconCls:"svmx-piq-loading-node",nodeType:"LOADING"}},__getIconFor:function(e,t){switch(t){case"IB":var n=e[g.getCustomFieldName("Top_Level")]||e.Id,i=this.__productIconIndex[n],a=e[g.getCustomFieldName("Product")];if(i&&i[a]){return"C:/ProgramData/ServiceMax/ProductIQ/Downloads/"+i[a]}return"svmx-piq-tree-node-icon svmx-piq-installbase-node";default:return{LOCATION:"modules/com.servicemax.client.productIQ.ui.largemodern/resources/images/custom/dummy-icon2.png",SUBLOCATION:"modules/com.servicemax.client.productIQ.ui.largemodern/resources/images/custom/dummy-icon4.png",ACCOUNT:"modules/com.servicemax.client.productIQ.ui.largemodern/resources/images/custom/dummy-icon5.png"}[t]}},__indexProductIconsFromTemplates:function(e){function t(e,i){if(i.children){var a=void 0,r=i.children.length;for(a=0;a<r;a++)t(e,i.children[a])}var o=i.product;o&&o.productIcon&&(n[e]=n[e]||{},n[e][o.productId]=o.productIcon)}for(var n=this.__productIconIndex={},i=0;i<e.ibs.length;i++){var a=e.ibs[i],r=a[g.getCustomFieldName("ProductIQTemplate")];r&&e.templates[r]&&t(a.Id,e.templates[r].template)}},onDataLoadComplete:function(e,t){this.__setTreeData(e,!0);var n=v(".svmxTreePanel>div");if(n&&n.scrollTop(0),this.__setTreeDataTransients(),e.root.children.length>0?this.__firstNodeIB=e.root.children[0].id:this.__firstNodeIB=null,this.__selectFromExternal=!1,this.__externalData){var i=g.toObject(this.__externalData);this.__handleExternalMessage(i,t),this.__externalData=null}else!0===this.__isWorkOrderFilterChecked&&this.__selectedWorkOrderFilterData?this.__handleExternalMessage(this.__selectedWorkOrderFilterData,t):this.__selectedNodeId&&!1===this.__searchButtonTapped&&this.selectTreeNode(this.__selectedNodeId,t)},expandParentNodes:function(e){var t=e.parentNode;t&&(t.expand(),this.expandParentNodes(t))},onTreeLoad:function(e){g.getCurrentApplication().hideSpinner(this.__parent);var t=null,n=this.__filterExpressions;if(Ext.isEmpty(n)&&!this.__isWorkOrderFilterChecked)return void((t=this.__tree.getStore().findNode("id",this.__selectedNodeId))&&this.expandParentNodes(t));this.__selectedNodeId&&((t=this.__tree.getStore().findNode("id",this.__selectedNodeId))||!0!==e.viaFilter&&!0!==this.__isWorkOrderFilterChecked||this.__firstNodeIB&&(this.__selectedNodeId=this.__firstNodeIB,this.selectTreeNode(this.__selectedNodeId,e)))},__appendChildToParent:function(e,t){e.push({id:t.id,text:t.text,children:t.children,icon:t.icon,nodeType:t.nodeType,recordId:t.recordId})},__setupNodeFilters:function(){this.__allNodeFilters={loc:{criteriaHandler:function(e){return"LOCATION"===e.nodeType||"SUBLOCATION"===e.nodeType},breakHandler:function(e){return"IB"===e.nodeType}},swap:{criteriaHandler:function(e){return"IB"===e.nodeType&&e.isSwapped}}},this.__appliedNodeFilters={}},addNodeFilter:function(e,t,n){this.__allNodeFilters[e]={criteriaHandler:t,breakHandler:n}},enableNodeFilter:function(e){this.__allNodeFilters[e]&&(this.__appliedNodeFilters[e]=this.__allNodeFilters[e])},disableNodeFilter:function(e){this.__appliedNodeFilters[e]&&delete this.__appliedNodeFilters[e]},hideNodes:function(e,t,n){this.enableNodeFilter(e),this.__applyNodeFilters(!0)},showNodes:function(e,t){this.disableNodeFilter(e),this.__applyNodeFilters(t)},__applyNodeFilters:function(e){function t(e){for(var t in r.__appliedNodeFilters){if(!r.__appliedNodeFilters[t])return!0;if(r.__appliedNodeFilters[t].criteriaHandler(e))return!0}}function n(e){for(var t in r.__appliedNodeFilters)if(r.__appliedNodeFilters[t]&&r.__appliedNodeFilters[t].breakHandler&&r.__appliedNodeFilters[t].breakHandler(e))return!0}function i(e,r){if(e)for(var o=0;o<e.length;o++){var s=e[o];if(t(s)){if(!r.reset&&(r.reset=!0,r.children=[],!s.isSwapped||"false"===s.isSwapped))for(var l=0;l<o;l++)r.children.push(e[l]);s.isSwapped&&"false"!==s.isSwapped||i(a(s),r)}else if("LOADING"!==s.nodeType){if(r.reset&&r.children.push(s),n(s))continue;i(a(s),s)}}}function a(e){var t=[];return r.__locationsData[e.id]&&(t=t.concat(r.__locationsData[e.id])),r.__sublocationsData[e.id]&&(t=t.concat(r.__sublocationsData[e.id])),r.__IBsData[e.id]&&(t=t.concat(r.__IBsData[e.id])),t}var r=this,o=this.__getTreeDataCloned(),s=o.root;void 0!==e&&!0===e&&r.__deleteUnWantedTreeDataProperties(s.children);var l=!1;if(this.__appliedNodeFilters)for(var c=(0,m.default)(this.__appliedNodeFilters),u=0;u<c.length;u++)if(this.__appliedNodeFilters[c[u]]){l=!0;break}l&&i(s.children,s,!0),1==this.__isIBorLocationRecordSelected?this.__resetTreeStoreData(this.__treeData):this.__resetTreeStoreData(o)},__deleteUnWantedTreeDataProperties:function(e){for(var t=this,n=0;n<e.length;n++){for(var i=e[n],a=["allowDrag","allowDrop","checked","cls","depth","expandable","href","hrefTarget","index","isFirst","isLast","leaf","loaded","loading","qshowDelay","qtip","qtitle","root","transient","visible"],r=0;r<a.length;r++)delete i[a[r]];if(!i.children)return;t.__deleteUnWantedTreeDataProperties(i.children)}},getTreeData:function(){return this.__treeData},getTreeDataById:function(){return this.__treeDataById},getTree:function(){return this.__tree},__getTreeDataCloned:function(){return g.cloneObject(this.__treeData)},__setTreeData:function(e,t){if(t&&this.__setTreeDataReloaded(e),this.__treeData=g.cloneObject(e),this.__resetTreeStoreData(e),this.__locationsVisible,this.__swappedVisible,this.__transientFilters)for(var n=0;n<this.__transientFilters.length;n++)if(this.__transientFilters[n].isChecked()){var i=this.__transientFilters[n].getAlias();this.__appliedNodeFilters[i]=this.__allNodeFilters[i]}void 0!==this.__isIBorLocationRecordSelected&&!0===this.__isIBorLocationRecordSelected&&this.__applyNodeFilters()},__setTreeDataReloaded:function(e){var t=this.__treeDataById;if(t){var n={};this.__forEachChild(e.root,function(e,i){e.id&&"IB"===e.nodeType&&(t[e.id]||delete this.__expandedById[e.id],n[e.id]=e)}),this.__forEachChild(this.__treeData.root,function(e,t){"IB"===e.nodeType&&e.id&&!n[e.id]&&delete this.__expandedById[e.id]})}},__forEachChild:function(e,t){if(e.children)for(var n=0;n<e.children.length;n++)t.call(this,e.children[n],e),this.__forEachChild(e.children[n],t)},__resetTreeStoreData:function(e){this.__treeDataById={},this.__forEachChild(e.root,function(e,t){e.id&&(this.__treeDataById[e.id]||(this.__treeDataById[e.id]=e,e.parentId=t.id))}),I.info("PIQTree []: __resetTreeStoreData ");var t=performance.now(),n=this.__tree.rootItem._node;null!==n&&n.hasChildNodes()&&n.removeAll(),this.__tree.getStore().removeAll(),this.__tree.getStore().setRootNode(e.root),I.info("PIQTree ["+(performance.now()-t)+"]: __resetTreeStoreData sync "),t=performance.now(),this.__tree.getStore().sync()},__setTreeDataTransients:function(){if(this.__transientRecordIndex)for(var e=0;e<this.__transientRecordIndex.length;e++){var t=this.__transientRecordIndex[e];this.setTreeNodeTransient(t,!0)}},__handleExternalMessage:function(e,t){e.object===g.getCustomObjectName("Service_Order")?(this.__selectFromExternal=!0,this.__createTransientFilter(e,t)):e.object===g.getCustomObjectName("Installed_Product")?(this.__selectFromExternal=!0,this.__uncheckFilters(),this.__selectTreeNodes(e,void 0,t)):e.object===g.getCustomObjectName("Site")&&(this.__selectFromExternal=!0,this.__uncheckFilters(),this.__showLocationNode(e))},__createTransientFilter:function(e,t){var n=this,i=g.create("com.servicemax.client.productIQ.ui.largemodern.ibtree.TransientFilter",{parent:this,data:e,meta:this.__meta}),a=!1;if(this.__transientFilters){for(var r=0;r<this.__transientFilters.length;r++)if(this.__transientFilters[r].getAlias()===i.getAlias()){a=!0,i=this.__transientFilters[r],i.setChecked();break}this.__selectTreeNodes(e,function(){if(a)!0===n.__isWorkOrderFilterChecked&&i.setup();else if(n.__transientFilters){var e=n.__transientFilters[0];if(void 0===e)n.__transientFilters.push(i),i.initialize(!1);else for(var t=0;t<n.__transientFilters.length;t++){var r=n.__transientFilters[t].__data.sourceRecordName,o=i.__data.sourceRecordName;r!==o&&(n.__transientFilters.push(i),i.initialize(!1))}}},t)}},__uncheckFilters:function(){for(var e=this.getOptionsPanel().items.items,t=0;t<e.length;t++){e[t].setValue(!1)}this.__selectFromRegisterExternal=!1},getTransientFilters:function(){var e=[];return this.__transientFilters&&(e=this.__transientFilters),e},deleteTransientFilters:function(){for(var e=this.getTransientFilters(),t=0;t<e.length;t++)e[t].hide();delete this.__transientFilters},updateRecordName:function(e,t){var n=this.__treeDataById[e];n&&this.__setTreeNodeName(n,t)},__setTreeNodeName:function(e,t){var n=this.__tree.getStore().findNode("id",e.id);n&&n.set("text",t),e.transientRefs&&e.transientRefs.length?(e.origText=t,e.text=t+"*"):(e.text=t,delete e.origText)},selectTreeNode:function(e,t,n){this.__nodeDragged&&(this.__nodeDragged=!1),"LOCATION"===this.__selectedNodeType(e)?this.__showLocationNode({recordIds:[e]}):this.__selectTreeNodes({recordIds:[e]},n,t)},__selectedNodeType:function(e){return this.__locationsById[e]?"LOCATION":this.__ibsById[e]?"IB":"NONE"},__selectTreeNodes:function(e,t,n){e=g.toObject(e),this.__showSelectedIBRecord(e,t,n)},__showLocationNode:function(e){e=g.toObject(e);var t=(g.cloneObject(this.__treeData.root),e.recordIds[0]);this.__getLocationPath(t)},__getLocationPath:function(e,t,n){this.__locationPath=[],e&&this.__locationPath.push(e),t&&this.__locationPath.push(t),this.__traverseCallback=n;for(var i=e,a=!0;a;)if(this.__locationsById[i]){var r=this.__locationsById[i];r.parentId&&!this.__locationPath.includes(r.parentId)?(this.__locationPath.unshift(r.parentId),i=r.parentId):a=!1}else a=!1;this.__locationPath.length>0?this.__fetchLocation():this.__showError()},__fetchLocation:function(){if(this.__locationPath&&this.__locationPath.length>0){var e=this.__locationPath.splice(0,1)[0];if(e)if("root"==e)this.__fetchLocation();else{var t=this.__tree.getStore().getNodeById(e);t?this.__locationPath.length>0?t.data.expanded?this.__fetchLocation():t.expand():(g.getCurrentApplication().hideSpinner(this.__parent),this.__traverseCallback?(this.__traverseCallback.call(),this.__traverseCallback=null):this.__tree.setSelection(t),delete this.__selectFromExternal):this.__showError()}else this.__showError()}else this.__showError()},__showError:function(){g.getCurrentApplication().hideSpinner(this.__parent),this.__selectFromExternal&&(g.getCurrentApplication().showMessage({text:M().T("FSA017_TAG006","Installed product or Location record(s) may not be available in the tree view because not all required data has been downloaded. Please download the associated Account or Installed Product record(s) and retry."),buttons:[{text:M().T("FSA016_TAG003","OK"),itemId:"OK"}],handler:g.proxy(this,function(){})}),delete this.__selectFromExternal)},__showSelectedIBRecord:function(e,t,n){!1===this.__showAlertMessage&&(n?n.viaFilter=!0:n={viaFilter:!0});var i=g.cloneObject(this.__treeData.root);g.create("com.servicemax.client.productIQ.ui.largemodern.loadselectedib.LoadSelectedIB",{parent:this,selectedIB:e,root:i,callback:t,params:n})},__expandLocationNode:function(e){var t=this,n=e.firstChild;if(n&&"LOADING"===n.data.nodeType){e.removeChild(e.childNodes[0]);var i=[];this.__locationsData[e.id]&&this.__locationsData[e.id].length>0&&(i=i.concat(this.__locationsData[e.id])),this.__sublocationsData[e.id]&&this.__sublocationsData[e.id].length>0&&(i=i.concat(this.__sublocationsData[e.id])),this.__IBsData[e.id]&&this.__IBsData[e.id].length>0&&(i=i.concat(this.__IBsData[e.id])),this.__appendChildInBatch(e,i,function(){t.__fetchLocation()})}else this.__fetchLocation()},__appendChildInBatch:function(e,t,n){var i=this,a=t.splice(0,this.__batchSize);if(a.length>0)for(var r=0;r<a.length;r++){var o=g.cloneObject(a[r]);e.appendChild(o),this.__treeDataById[o.id]=o,this.__forEachChild(o,function(e,t){e.id&&(this.__treeDataById[e.id]||(this.__treeDataById[e.id]=e,e.parentId=t.id))})}t.length>0?setTimeout(function(){i.__appendChildInBatch(e,t,n)},10):n.call()},__showMore:function(e){var t=this.__treeDataById[e.node.id];if(t.allIBsLoaded)return void g.getLoggingService().getLogger(M().T("FSA017_TAG015","All nodes loaded for")+" "+t.id);g.getCurrentApplication().showSpinner(this.__parent);var n=g.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_MORE_IBS",this,{request:{context:this,params:{parentNode:t,iBReferenceInfo:this.__IBReferenceINFO,thisNode:null},lastIBIndex:t.lastIBIndex,parentIBId:t.id}});return this.__getEventBus().triggerEvent(n),this.__showMoreD=g.Deferred()},onGetMoreIBsCompleted:function(e,t){var n=this,i=0,a=void 0,r=e.length;e&&(e=this.multicolumnSortForIBRecords(e));var o=this.__tree.getStore().findNode("id",t.parentNode.id),s=this.__treeDataById[o.id];for(a=0;a<s.children.length;a++){if("LOADING"==s.children[a].nodeType){s.children.splice(a,1);break}}var l=[],c=void 0;for(a=0;a<r;a++){c=e[a],i=c.RecordId;var u=[];c.hasChild&&(u=[this.__getLoadingNodeObject()]);var d=c.Name;d&&0!=d.length||(d="(IB) "+c.Id),l.push({id:c.Id,text:d,children:u,iconCls:this.__getIconFor(c,"IB"),nodeType:"IB",recordId:c.Id})}if(s.children)for(a=l.length-1;a>=0;a--)s.children.unshift(l[a]);else s.children=l;s.lastIBIndex=i,s.expanded=!0,s.allIBsLoaded=!0,0===s.children.length&&(s.expanded=!1,this.__expandedById[o.id]=!1),o.removeChild(o.childNodes[0]),this.__appendChildInBatch(o,l,function(){if(o.data.expanded&&o.collapse(),o.expand(),n.__setTreeDataTransients(),n.fireEvent("node_loaded",e),n.__selectedNodeId){var t=n.__tree.getStore().getNodeById(n.__selectedNodeId);t&&n.__tree.setSelection(t)}n.__showMoreD.resolve(),g.getCurrentApplication().hideSpinner(n.__parent)})},__getIBChildNodes:function(e,t){var n=[];if(t&&t.length)for(var i=g.getCustomFieldName("Parent"),a=0;a<t.length;a++){var r=t[a];r[i]===e&&n.push({id:r.Id,text:r.Name,children:this.__getIBChildNodes(r.Id,t),iconCls:this.__getIconFor(r,"IB"),nodeType:"IB",recordId:r.Id})}return n.length||n.push(this.__getLoadingNodeObject()),n},setTreeNodeTransient:function(e,t){function n(t){t.transientRefs=t.transientRefs||[],-1===t.transientRefs.indexOf(e)&&t.transientRefs.push(e),t.origText||(t.origText=t.text,t.text+="*",a.__tree.getStore().findNode("id",t.id).updateInfo(!0,{text:t.text}));var i=a.__treeDataById[t.parentId];i&&n(i)}function i(t){if(t.transientRefs){var n=t.transientRefs.indexOf(e);-1!==n&&t.transientRefs.splice(n,1),!t.transientRefs.length&&t.origText&&(t.text=t.origText,a.__tree.getStore().findNode("id",t.id).updateInfo(!0,{text:t.text}),delete t.origText)}var r=a.__treeDataById[t.parentId];r&&i(r)}var a=this,r=this.__treeDataById[e];if(r){if(r.transient&&r.prevParentId){var o=this.__treeDataById[r.prevParentId];o&&i(o)}t=void 0===t||t,t?n(r):i(r),r.transient=t,delete r.prevParentId}},__setTreeNodeError:function(e,t){e.origText=t,e.text=t+"*",this.__tree.getStore().findNode("id",e.id).updateInfo(!0,{text:e.text})},deleteFromTree:function(e){if(e=this.__tree.getStore().findNode("id",e.id)){g.getCurrentApplication().showSpinner(this.__parent);var t=void 0;switch(e.data.nodeType){case"ACCOUNT":t=g.getCustomObjectName("Account");break;case"LOCATION":t=g.getCustomObjectName("Site");break;case"SUBLOCATION":t=g.getCustomObjectName("Sub_Location");break;case"IB":t=g.getCustomObjectName("Installed_Product")}var n=g.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.DELETE_RECORDS",this,{request:{context:this,handler:this.onDeleteNodeComplete,objectName:t,recordId:e.data.recordId,params:{node:e,type:e.nodeType}}});this.__deliveryEngine.getEventBus().triggerEvent(n)}},onDeleteNodeComplete:function(e,t){if(g.getCurrentApplication().hideSpinner(this.__parent),!e){var n=g.getCurrentApplication().getApplicationErrorHandler(),i=M().T("FSA017_TAG010","Unable to delete synced records.");return void n.notifyApplicationError({message:i})}var a=void 0,r=void 0;"root"===t.node.data.parentId&&"IB"===t.node.data.nodeType?(r=this.__treeDataById[t.node.id],a=this.__tree.rootItem._node,this.__detachChildFromParent(a.data,r)):(r=this.__treeDataById[t.node.id],a=this.__treeDataById[r.parentId],this.__detachChildFromParent(a,r)),t.node.remove();var o=a.id;o&&"root"!==o?(this.__selectedNodeId=o,this.selectTreeNode(this.__selectedNodeId,t)):this.__firstNodeIB&&(this.__selectedNodeId=this.__firstNodeIB,this.selectTreeNode(this.__selectedNodeId,t))},__detachChildFromParent:function(e,t){if(e)for(var n=0;n<e.children.length;n++)if(e.children[n].id===t.id)return void e.children.splice(n,1)},__handleDropOn:function(e){var t=this,n=t.__tree.targetNode;if(n&&t.__canDropOn(e)){var i=n._node;if(e.id!==i.id&&e.parentNode.id!==i.id){g.getCurrentApplication().showSpinner(this.__parent),this.__nodeDragged=!0;var a=i.data,r=a.nodeType,o=a.recordId,s=e.childNodes.slice(),l=void 0,c=void 0,u=void 0;s.push(e);var d=s.length,_={},h=void 0,f=[];this.__treeDataById[i.id],this.__tree.getStore().findNode("id",i.id);for(l=0;l<d;l++){c=s[l],u=c.data.nodeType,_.Id=c.data.recordId,"LOADING"!==u&&f.push(this.__treeDataById[c.id]);var p=g.getCustomFieldName("Site"),m=g.getCustomFieldName("Parent"),v=g.getCustomFieldName("Top_Level"),y=g.getCustomFieldName("Sub_Location");if("IB"==u){h=g.getCustomObjectName("Installed_Product");var S;if("IB"==r){for(var E,b,T=i;null!=T;){var M=T.data.nodeType;"IB"==M?E=T.data.recordId:"SUBLOCATION"!=M||b?"LOCATION"!=M||S||(S=T.data.recordId):b=T.data.recordId,T=T.parentNode}_[p]=S,_[m]=o,_[v]=E,_[y]=b}else"SUBLOCATION"==r?(S=i.parentNode.data.recordId,_[p]=S,_[m]="",_[v]="",_[y]=o):"LOCATION"==r&&(_[p]=o,_[m]="",_[v]="",_[y]="")}else"LOCATION"==u?(h=g.getCustomObjectName("Site"),"LOCATION"==r&&(o=i.data.id,_[m]=o)):"SUBLOCATION"==u&&(h=g.getCustomObjectName("Sub_Location"))}for(var I=!1,C=0;C<f.length;C++){var A=this.__treeDataById[f[C].parentId];this.__detachChildFromParent(A,f[C]),this.__selectedNodeId===f[C].id&&(I=f[C].id)}var D=g.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.UPDATE_IB_HIERARCHY",this,{request:{context:this,params:{},record:_,objectName:h,handler:function(e){t.__nodeDragged=!1,t.__nodeDropped=!0,g.getCurrentApplication().hideSpinner(t.__parent),I&&t.fireEvent("node_selected",t.__treeDataById[I]);var n=t.dropSuccess;t.handleNodeDrop(n.parentNode,n.dropNode)}}});this.dropSuccess={updateDropEvt:D,parentNode:i,dropNode:e};var x=this.__parent;x.overviewPanel.doSaveRecord()&&!1!==I?x.saveRecord():this.updateHierarchy()}}},updateHierarchy:function(){var e=this.dropSuccess;if(e){var t=e.updateDropEvt;this.__deliveryEngine.getEventBus().triggerEvent(t),t=null}},handleNodeDrop:function(e,t){var n=this;t.parentNode.removeChild(t);var i=e.id,a=this.__treeDataById[i];"LOCATION"===a.nodeType?(e.appendChild(t),this.updateChildHierarchy(t),e.expand(),n.addSelector(t),n.moveToDropedNode()):(a.allIBsLoaded=!1,e.removeAll(),e.collapse(),setTimeout(function(){e.expand()},100),n.__isTreeViewDataRefreshing=!0),this.dropSuccess=null},addSelector:function(e){var t=e.internalId,n="[data-recordId='"+t+"']",i=Ext.query(n);if(i)for(var a in i){var r=i[a];if(r){this.removeFromElementCache(r);var o=r.nodeName;if(o&&"LI"===o){var s=Ext.get(r);s.addCls("x-treelist-item-selected");break}}}},removeFromElementCache:function(e){if(e.id){var t=Ext.Element.cache;t&&t.hasOwnProperty(e.id)&&delete t[e.id]}},removeSelector:function(){var e=v("li.x-treelist-item-selected");for(var t in e){var n=Ext.get(e[t]);n&&n.removeCls("x-treelist-item-selected")}},moveToDropedNode:function(){var e=v("li.x-treelist-item-selected").position().top,t=v(".svmxTreePanel").height();if(e>=t){var n=e-t+96;setTimeout(function(){v(".svmxTreePanel>div").scrollTop(n)},400)}},updateChildHierarchy:function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];e.removeChild(n),e.insertChild(t,n),this.updateChildHierarchy(n)}},updateTreeWithSFID:function(e){if(e)for(localID in e){var t=e[localID];this.__selectedNodeId===localID&&(this.__selectedNodeId=t);var n=this.__tree.getStore().getNodeById(localID);n&&(n.id=t,n.data.recordId=t,n.data.id=t,this.__tree.getStore().byIdMap[t]=n,this.__treeDataById[t]=n.data,delete this.__tree.getStore().byIdMap[localID],delete this.__treeDataById[localID])}},__canDropOn:function(e){if(!this.__tree||!this.__tree.dragOverNode||!this.__tree.dragOverNode._node)return!1;var t=this.__tree.dragOverNode._node,n=this.__parent.__syncStarted;if(t.id.match("local")&&n)return!1;if(this.isDroppingtoChild(t,e.data.recordId))return!1;var i=t.data,a=i.recordId,r=i.nodeType,o=this.__getAccountId4ChildNode(t),s=e.childNodes.slice(),l=void 0,c=void 0,u=!0;s.push(e);var d=s.length;for(l=0;l<d;l++){c=s[l];if(this.__getAccountId4ChildNode(c)!=o)return!1;var _,h=c.data,f=h.nodeType,p=this.__treeDataById[h.parentId];if(p&&(_=p.nodeType),c.parentNode.data.recordId==a||c.data.recordId==a)return!1;"LOADING"!==f&&("IB"==r?"IB"!=f&&(u=!1):"SUBLOCATION"==r?"IB"!=f&&"SUBLOCATION"!=f&&(u=!1):"LOCATION"==r?("IB"!=f&&"SUBLOCATION"!=f&&"LOCATION"!=f&&(u=!1),"LOCATION"==f&&"ACCOUNT"===_&&(u=!1)):u=!1)}return u},isDroppingtoChild:function(e,t){for(var n=!1;null!=e;){if(e.data.recordId==t){n=!0;break}e=e.parentNode}return n},__getAccountId4ChildNode:function(e){for(var t=null;null!=e;){if("ACCOUNT"==e.data.nodeType){t=e.data.recordId;break}e=e.parentNode}return t}}),b.TransientFilter=function(e){function t(e){(0,l.default)(this,t);var n=(0,_.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments));return n.__ibtree=e.parent,n.__data=e.data,n.__meta=e.meta,n.__alias=n.__data.sourceRecordName,n.__checked=!0,n.__checkbox=null,n}return(0,f.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){var e=this;this.__checkbox=g.create("com.servicemax.client.ui.components.modern.controls.form.SVMXCheckboxField",{name:e.__alias,label:e.__alias,checked:!0,margin:"0 0 0 5",isTransientFilter:!0,cls:"svmx-piq-checkbox",labelAlign:"left",listeners:{change:function(t,n){e.__checked=this._checked;var i=(e.__data.accountId,e.__data.recordIds[0]);e.__data.focused=!0,e.__ibtree.__isIBorLocationRecordSelected=!1,this._checked?(e.__ibtree.__parent.filterLoading=!0,e.__ibtree.__selectedNodeId=i,e.__ibtree.__isWorkOrderFilterChecked=!0,e.__uncheckOtherTransientFilters()):e.__ibtree.isUncheckingTransientFilters||(e.__ibtree.__isWorkOrderFilterChecked=!1),e.__ibtree.refreshContent({viaFilter:!0})}}}),this.__ibtree.getOptionsPanel().add(this.__checkbox),this.__ibtree.getOptionsPanel().setHidden(!1),this.__ibtree.setTreeViewPanelHeight(),this.__ibtree.__isWorkOrderFilterChecked=!0,this.setup(),this.moveToFilter()}},{key:"moveToFilter",value:function(){var e=this.__ibtree.getOptionsPanel(),t=e.el.dom.childNodes;if(t&&t.length>0){var n=t[0],i=this.__checkbox.el.dom.offsetTop;n.scrollTop=i}}},{key:"setup",value:function(){this.__ibtree.__selectedNodeId=this.__data.recordIds[0],this.__addTransientNodeFilter(),this.__uncheckOtherTransientFilters(),this.__ibtree.hideNodes(this.__alias),this.__ibtree.selectTreeNode(this.__data.recordIds[0]),this.__selectFromRegisterExternal=!1}},{key:"setChecked",value:function(){this.__checkbox.setValue(!0)}},{key:"isChecked",value:function(){return this.__checked}},{key:"getAlias",value:function(){return this.__alias}},{key:"hide",value:function(){this.__checkbox.setValue(!1),this.__checkbox.hide()}},{key:"__addTransientNodeFilter",value:function(e){this.__transientNodeFilter&&!e||(this.__transientNodeFilter=this.__createTransientNodeFilter()),this.__ibtree.addNodeFilter(this.__alias,this.__transientNodeFilter)}},{key:"__createTransientNodeFilter",value:function(){function e(i){if(i){var a=n[i.parentId];a&&("ACCOUNT"===a.nodeType&&-1===t.__parentAccounts.indexOf(a.id)&&(t.__parentAccounts.push(a.id),a.expanded=!0),"LOCATION"===a.nodeType&&-1===t.__parentLocations.indexOf(a.id)&&(t.__parentLocations.push(a.id),a.expanded=!0),"SUBLOCATION"===a.nodeType&&-1===t.__parentSublocations.indexOf(a.id)&&(t.__parentSublocations.push(a.id),a.expanded=!0),"IB"===a.nodeType&&-1===t.__parentIBs.indexOf(a.id)&&(t.__parentIBs.push(a.id),a.expanded=!0),e(a))}}var t=this;this.__parentAccounts=[],this.__parentIBs=[],this.__parentLocations=[],this.__parentSublocations=[];for(var n=this.__ibtree.getTreeDataById(),i=0;i<this.__data.recordIds.length;i++){var a=this.__data.recordIds[i];e(n[a])}return function(e){return"ACCOUNT"===e.nodeType&&-1===t.__parentAccounts.indexOf(e.id)||("LOCATION"===e.nodeType&&-1===t.__parentLocations.indexOf(e.id)||("SUBLOCATION"===e.nodeType&&-1===t.__parentSublocations.indexOf(e.id)||"IB"===e.nodeType&&-1===t.__parentIBs.indexOf(e.id)&&-1===t.__data.recordIds.indexOf(e.id)))}}},{key:"__uncheckOtherTransientFilters",value:function(){var e=this.__ibtree.getTransientFilters(),t=void 0;for(t=0;t<e.length;t++)this.__ibtree.disableNodeFilter(e[t].getAlias());var n=this.__ibtree.getOptionsPanel().items.items;for(this.__ibtree.isUncheckingTransientFilters=!0,t=0;t<n.length;t++){var i=n[t];i.isTransientFilter&&(i.boxLabel!==this.__alias&&i.setValue(!1))}delete this.__ibtree.isUncheckingTransientFilters}}],[{key:"testTrigger",value:function(){var e={action:"VIEW",recordIds:["a0HF000000Nwd7XMAR","a0HF000000Nv0qSMAR","a0HF000000NwcSfMAJ","a0HF000000NwkmQMAR","a0HF000000NwkmZMAR"],object:g.getCustomObjectName("Installed_Product"),sourceRecordName:"WO-100000TEST1"};window.previouslySet&&(e.sourceRecordName="WO-100000TEST2"),window.previouslySet=!0;var t=g.create("com.servicemax.client.lib.api.Event","EXTERNAL_MESSAGE",this,e);g.getClient().triggerEvent(t)}}]),t}(E),Ext.define(b.name+".RowDragger",{extend:"Ext.AbstractPlugin",alias:"plugin.DragandDrop",mixins:["Ext.mixin.Observable"],config:{recordType:""},constructor:function(e){this.mixins.observable.constructor.call(this,e)},init:function(e){var t=this;this.getRecordType();this.source=new Ext.drag.Source({element:e.element,delegate:".x-grid-row",describe:function(e){e.recordName=this.getText(e.eventTarget)},getText:function(e){if(""!==e.parentElement.innerText)return e.parentElement.innerText;this.getText(e.parentElement)},proxy:{type:"placeholder",getElement:function(e){var t=this.element;return t||(this.element=t=Ext.getBody().createChild({cls:"svmDragView svmPiqTreeInvalidDrop"})),this._cursorOffset=[12,-40],t.show().update(e.recordName),t}},autoDestroy:!1,activateOnLongPress:"ontouchstart"in window,listeners:{scope:t,beforedragstart:this.makeRelayer("beforedragstart"),dragstart:this.makeRelayer("dragstart"),dragmove:this.makeRelayer("dragmove"),dragend:this.makeRelayer("dragend")}})},disable:function(){this.source.disable()},enable:function(){this.source.enable()},destroy:function(){Ext.destroy(this.source),this.callParent()},makeRelayer:function(e){var t=this;return function(n,i,a){return t.fireEvent(e,t,i,a)}}}),Ext.define(b.name+".SVMXTreeview",{extend:"com.servicemax.client.ui.components.modern.navigation.SVMXTree",alias:"productIQ.treeview",element:{reference:"element",cls:Ext.baseCSSPrefix+"treelist "+Ext.baseCSSPrefix+"unselectable",listeners:{click:"onClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseover:"onMouseOver",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove"},children:[{reference:"toolsElement",cls:Ext.baseCSSPrefix+"treelist-toolstrip",listeners:{click:"onToolStripClick",mouseover:"onToolStripMouseOver"}}]},config:{touchStarted:!1,itemdragged:!1,targetNode:null,dragOverNode:null},onTouchStart:function(e){this.touchStarted=!0,this.itemdragged=!1,this.targetNode=null,this.dragOverNode=null,this.removeHighLighting(e)},onTouchEnd:function(e){if(this.breakTreeMove=!1,this.touchStarted&&this.itemdragged){var t=this.getTargetElement(e),n=void 0;t&&(n=t.getAttribute("data-recordId"),(t=this.itemMap[n])&&(this.targetNode=t))}this.touchStarted=!1,this.itemdragged=!1;try{var i=document.createEvent("TouchEvent",!0,!0);i.browserEvent=[],Ext.event.publisher.Gesture.instance.onTouchEnd(i)}catch(e){}},removeHighLighting:function(e){var t=this.getTargetElement(e);if(t){var n=Ext.get(t);if(n&&n.hasCls("x-treelist-item-over")&&n.removeCls("x-treelist-item-over"),n&&n.dom&&n.dom.childNodes){var i=n.dom.childNodes[0];if(i){var a=Ext.get(i);a&&a.hasCls("x-treelist-row-over")&&a.removeCls("x-treelist-row-over")}}}},onTouchMove:function(e){if(this.touchStarted?this.itemdragged=!0:this.itemdragged=!1,this.touchStarted){var t=void 0,n=this.getTargetElement(e);this.breakTreeMove=!1,this.scrollAtEnd(e),n&&(t=n.getAttribute("data-recordId"),n=this.itemMap[t],this.dragOverNode&&(this.prevDragNode=this.dragOverNode),n&&(this.dragOverNode=n))}},getTargetElement:function(e){var t=e.pageX,n=e.pageY,i=document.elementFromPoint(t,n);return this.findTarget(i,"[data-recordId]")},findTarget:function(e,t){var n=void 0;return e&&(n=Ext.fly(e).findParent(t)),n},scrollAtEnd:function(e){if(this.dragStarted){var t=v(".svmxTreePanel>.x-scroller");if(t&&(t=t[0])){var n=e.clientY,i=Ext.getBody().getViewSize().height,a=this.parent.el.dom.offsetTop,r=0;i-n<40?(this.breakTreeMove=!0,r=5):n-a<90&&(this.breakTreeMove=!0,r=-5),this.scrollMoveMent(t,r)}}},scrollMoveMent:function(e,t){var n=this;if(this.breakTreeMove){if(t>0&&e.scrollTop+e.clientHeight>=e.scrollHeight||t<0&&e.scrollTop<=0)return;e.scrollTop+=t,setTimeout(function(){n.scrollMoveMent(e,t)},200)}}}),g.defineGlobal(b.name,b),e.exports=b},function(e,t){function n(e,t,n){var i,a=[],r=[e],o=[e],s=[n?u:"[Circular]"],l=e,c=1;return function(e,f){return t&&(f=t.call(this,e,f)),""!==e&&(l!==this&&(i=c-m.call(r,this)-1,c-=i,r.splice(c,r.length),a.splice(c-1,a.length),l=this),"object"==typeof f&&f?(m.call(r,f)<0&&r.push(l=f),c=r.length,i=m.call(o,f),i<0?(i=o.push(f)-1,n?(a.push((""+e).replace(h,d)),s[i]=u+a.join(u)):s[i]=s[0]):f=s[i]):"string"==typeof f&&n&&(f=f.replace(d,_).replace(u,d))),f}}function i(e,t){for(var n=0,i=t.length;n<i;e=e[t[n++].replace(f,u)]);return e}function a(e){return function(t,n){var i="string"==typeof n;return i&&n.charAt(0)===u?new v(n.slice(1)):(""===t&&(n=s(n,n,{})),i&&(n=n.replace(p,"$1"+u).replace(_,d)),e?e.call(this,t,n):n)}}function r(e,t,n){for(var i=0,a=t.length;i<a;i++)t[i]=s(e,t[i],n);return t}function o(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(t[i]=s(e,t[i],n));return t}function s(e,t,n){return t instanceof Array?r(e,t,n):t instanceof v?t.length?n.hasOwnProperty(t)?n[t]:n[t]=i(e,t.split(u)):e:t instanceof Object?o(e,t,n):t}function l(e,t,i,a){return JSON.stringify(e,n(e,t,!a),i)}function c(e,t){return JSON.parse(e,a(t))}/*!
Copyright (C) 2013 by WebReflection

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
var u="~",d="\\x"+("0"+u.charCodeAt(0).toString(16)).slice(-2),_="\\"+d,h=new RegExp(d,"g"),f=new RegExp(_,"g"),p=new RegExp("(?:^|([^\\\\]))"+_),m=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},v=String;this.stringify=l,this.parse=c},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(16),r=i(a),o=n(14),s=i(o),l=n(1),c=i(l),u=n(2),d=i(u),_=n(6),h=i(_),f=n(3),p=i(f),m=n(4),v=i(m),g=n(0).utils,y=n(5).EventDispatcher,S={name:"com.servicemax.client.productIQ.ui.largemodern.metamodel"};S.AbstractMetamodel=function(e){function t(){return(0,d.default)(this,t),(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this))}return(0,v.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){}},{key:"refresh",value:function(){}}]),t}(y),S.Root=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return n.filters=[],n.actions=[],n.ibPriorityFields=[],n.ibHiddenFields=[],n.productSearchFields=[],n.productDisplayFields=[],n.locPriorityFields=[],n.locHiddenFields=[],n.slocPriorityFields=[],n.slocHiddenFields=[],n.accPriorityFields=[],n.accHiddenFields=[],n.ibDisplayFields=[],n.ibSearchFields=[],n.advanceSearch={},e&&(n.__deliveryEngine=e.deliveryEngine),n.mappings=null,n.profileId=null,n.profileName=null,n}return(0,v.default)(t,e),(0,h.default)(t,[{key:"initialize",value:function(){this.refresh()}},{key:"doCleanup",value:function(){this.filters&&(this.filters.length=0),this.actions&&(this.actions.length=0),this.ibPriorityFields&&(this.ibPriorityFields.length=0),this.ibHiddenFields&&(this.ibHiddenFields.length=0),this.productSearchFields&&(this.productSearchFields.length=0),this.productDisplayFields&&(this.productDisplayFields.length=0),this.locPriorityFields&&(this.locPriorityFields.length=0),this.locHiddenFields&&(this.locHiddenFields.length=0),this.accPriorityFields&&(this.accPriorityFields.length=0),this.accHiddenFields&&(this.accHiddenFields.length=0),this.ibDisplayFields&&(this.ibDisplayFields.length=0),this.ibSearchFields&&(this.ibSearchFields.length=0),(0,s.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"doCleanup",this).call(this)}},{key:"refresh",value:function(){var e=g.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_METADATA",this,{request:{context:this}});this.__getEventBus().triggerEvent(e)}},{key:"onGetMetadataComplete",value:function(e){var t=void 0,n=(0,r.default)(e),i=n.length;for(t=0;t<i;t++){var a=n[t];this[a]=e[a]}this.__notifyUpdate()}},{key:"onGetMetadataCompleteForAdvanceSearch",value:function(e){var t=[],n=void 0;if(e)for(var i=0;i<e.length;i++){var a=e[i].searches;if(a)for(var r=0;r<a.length;r++){a[r].searchfields;t=a[r].searchfields,n=a[r].advancedExpression}}this.advanceSearch=t,this.advancedExpression=n,this.__notifyUpdate()}},{key:"__notifyUpdate",value:function(e){var t=g.create("com.servicemax.client.lib.api.Event","MODEL.UPDATE",this,e);this.triggerEvent(t)}},{key:"__getEventBus",value:function(){return this.__deliveryEngine.getEventBus()}}]),t}(S.AbstractMetamodel),g.defineGlobal(S.name,S),e.exports=S},function(e,t,n){var i=n(0).utils,a=(n(22).View,n(19).impl),r={name:"com.servicemax.client.productIQ.ui.largemodern.attachment"},o=(i.getLoggingService().getLogger("ProductIQ-UI"),a);Ext.define("com.servicemax.client.productIQ.ui.largemodern.attachment.Attachment",{extend:o.name+".SVMXPanel",alias:"widget.productIQ.attachment",width:"100%",constructor:function(e){this.__view=i.getCurrentApplication().getCurrentView();var t=this.__buildAttachmentSection(e.deliveryEngine,e.recordId),n=this;e=Ext.apply({layout:{type:"vbox"},scrollable:"y",width:"100%",height:"100%",dockedItems:[{dock:"top",xtype:"toolbar",style:"background-color: #fff",margin:"10 10"}],items:t},e||{}),this.callParent([e]),this.__recordId=e.recordId,e.tree.on("node_selected",function(t){n.selectedNode=t,n.docSectionLoad(e.deliveryEngine,t)},this)},doDestroy:function(){this.tree&&this.tree.un("node_selected",function(e){me.selectedNode=e,me.docSectionLoad(config.deliveryEngine,e)},this),this.callParent()},__buildAttachmentSection:function(e,t){var n=[];return this.docSection=this.__createAttachmentSection(e,{showDocuments:!0,showImages:!1,detailId:t,allowAttachmentDelete:!0,from:"productIQ-documents"}),n.push(this.docSection),this.imageSection=this.__createAttachmentSection(e,{showDocuments:!1,showImages:!0,detailId:t,allowAttachmentDelete:!0,from:"productIQ-images"}),n.push(this.imageSection),i.array.map(n,function(e){e.ready()}),n},__createAttachmentSection:function(e,t){var n=["sfm-process-edit","sfm-delivery-section"];t&&t.showImages&&n.push("sfm-attachment-images-section"),t&&t.showDocuments&&n.push("sfm-attachment-documents-section");var a=i.create("com.servicemax.client.productIQ.ui.largemodern.detail.AttachmentHelper",{halign:"full",cls:n,deliveryEngine:e});return a.updateOptions(t),a},docSectionLoad:function(e,t){var n={showDocuments:!0,showImages:!1,detailId:t.id,allowAttachmentDelete:!0};this.docSection.updateOptions(n),this.docSection.setRecordIDToEngine(t.id),this.docSection.refreshData();var i={showDocuments:!1,showImages:!0,detailId:t.id,allowAttachmentDelete:!0};this.imageSection.updateOptions(i),this.imageSection.setRecordIDToEngine(t.id),this.imageSection.refreshData()}}),i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(31),a=function(e){return e&&e.__esModule?e:{default:e}}(i),r=n(0).utils,o=(n(22).View,n(19).impl),s=(n(19).form,n(12).DatetimeUtil),l={name:"com.servicemax.client.productIQ.ui.largemodern.detail"},c=function(){return r.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},u=(r.getLoggingService().getLogger("ProductIQ-UI"),o),d=c().T("FSA008_TAG065","--None--");Ext.define("com.servicemax.client.productIQ.ui.largemodern.detail.Detail",{extend:u.name+".SVMXPanel",alias:"widget.productIQ.detail",width:"100%",height:"100%",__parent:null,__deliveryEngine:null,__selectedNode:null,__taTemplate:null,__taHistory:null,__taCurrentLMD:null,__taPreviousLMD:null,shouldUpdateTemplateData:null,__updatedFields:null,__taHistoryIndex:null,__taHistoryCount:null,__IsHistoryVisible:!1,__previousButtonSelected:null,__capturedOnNotAvailable:!1,__lastHistoryCapturedOn:null,constructor:function(e){this.__parent=e.parent,this.__deliveryEngine=e.deliveryEngine,this.__selectedNode=e.selectedNode,this.shouldUpdateTemplateData=!1,this.__updatedFields=[],e=Ext.apply({layout:{type:"vbox"},scrollable:"y",dockedItems:[{dock:"top",xtype:"toolbar",style:"background-color: #fff",margin:"10 10"}],items:[]},e||{}),this.callParent([e]),this.fetchTemplate()},doDestroy:function(){this.__updatedFields&&(this.__updatedFields.length=0),this.callParent()},setSelectedNode:function(e){this.__selectedNode=e},fetchTemplate:function(){if(this.__IsHistoryVisible=!1,this.__selectedNode){var e=this.__selectedNode.id,t=this.mapLocalRecordID(e),n=r.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.FIND_TA_TEMPLATE_FOR_SELECTD_IB",this,{request:{context:this,selectedIBID:t}});this.__deliveryEngine.getEventBus().triggerEvent(n)}},fetchTemplateHistory:function(e,t,n){if(this.__selectedNode){var i=this.__selectedNode.id,a=this.mapLocalRecordID(i),o=r.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.FIND_TA_TEMPLATE_HISTORY_FOR_SELECTD_IB",this,{request:{context:this,selectedIBID:a,historyIndex:e,tapStatus:t,selectedTapDate:n}});this.__deliveryEngine.getEventBus().triggerEvent(o)}},__findTemplateComplete:function(e){this.__refreshPage(e)},__findTemplateHistoryComplete:function(e){if(e.IbAttributesHistory.length>0)var t=this.query("#historyContentSection")[0];t&&t.destroy(),this.__reloadHistoryWithData(e.IbAttributesHistory[0]),this.__setVisibleItem()},__setVisibleItem:function(){var e=this.query("#historyContentSection")[0],t=this.query("#currContentSection")[0];this.__IsHistoryVisible?(e.setHidden(!1),t.setHidden(!0)):(t.setHidden(!1),e.setHidden(!0))},__refreshPage:function(e){var t=this;if(t.__taHistoryIndex=0,void 0!==e.IbAttributesHistory)if(e.IbAttributesHistory.length>0){this.__taHistoryCount=e.IbAttributesHistory[0].TotalHistory;var n=r.getCustomFieldName("SM_Captured_On");this.__lastHistoryCapturedOn=e.IbAttributesHistory[0][n]}else this.__taHistoryCount=0;else this.__taHistoryCount=0;this.__updatedFields=[],this.shouldUpdateTemplateData=!1;var i=this.query("#titleSection")[0];i&&i.destroy();var a=this.query("#historyContentSection")[0];a&&a.destroy();var o=this.query("#currContentSection")[0];if(o&&o.destroy(),this.__taHistory=[],e.length>0||void 0!==e.IbAttributesHistory&&void 0!==e.IbAttributesTemplateInstance){if(void 0===e.IbAttributesHistory&&void 0===e.IbAttributesTemplateInstance)this.__taTemplate=e[0],e.templateId&&(this.__taTemplate.templateId=e.templateId);else{var l=e.IbAttributesTemplateInstance,u=e.IbAttributesHistory;if(this.__taHistory=u,l.length>0){var d=l[0];this.__taTemplate=d,this.__taTemplate.IBAttributeInstanceId=d.Id,e.templateId&&(this.__taTemplate.templateId=e.templateId)}if(u.length>0){var _=[];_=""==this.__taHistory[this.__taHistory.length-1].LastModifiedDate?u[this.__taHistory.length-1]:u[0],this.__taTemplate.IBAttributeHistroryId=_.Id,this.__taTemplate.IBAttributeHistroryCapturedOn=_[r.getCustomFieldName("SM_Captured_On")]}}if(this.checkForAttributesError()){var h={xtype:"svmx.label",itemId:"titleSection",width:"100%",height:"100%",left:"10px",top:"10px",html:c().T("FSA017_TAG026","Failed to retrieve attributes for selected IB. Please contact your administrator.")};this.add(h)}else{var f=this.__taTemplate[r.getCustomFieldName("SM_Captured_On")];f?(f=s.convertToTimezone(f),this.__capturedOnNotAvailable=!1):(this.__capturedOnNotAvailable=!0,f=s.convertToTimezone(this.__taTemplate.LastModifiedDate)),this.__taCurrentLMD=s.getFormattedDatetime(f,"LL");var p={xtype:"svmx.horizontalpanel",height:"8%",docked:"top",itemId:"titleSection",cls:"svmxPiqTitleTop",margin:"10 10 20 10",items:[{xtype:"svmx.label",text:t.__taCurrentLMD,docked:"left",itemId:"LastModifiedDate",cls:"svmxPiqModifiedDate",margin:"20 0 0 10"},{xtype:"svmx.button",text:c().T("FSA017_TAG024","Current"),ui:"svmx-default",labelCls:"svmx-button-label-largemodern",docked:"right",margin:"10 0 0 10",cls:"svmxPiqDetailNavBtn",disabled:!0,itemId:"currentButton",handler:function(){t.__previousButtonSelected=null;var e=t.query("#historyContentSection")[0],n=t.query("#currContentSection")[0];e.setHidden(!0),n.setHidden(!1),t.__IsHistoryVisible=!1,t.__taHistoryIndex=0;var i=t.query("#currentButton")[0],a=t.query("#previousButton")[0],r=t.query("#nextButton")[0];a.setDisabled(!1),r.setDisabled(!0),i.setDisabled(!0),t.query("#LastModifiedDate")[0].setHtml(t.__taCurrentLMD)}},{xtype:"svmx.label",cls:"svmxPiqDetailNavBtnSeparator",text:["|"],docked:"right",disabled:!0,margin:"10 0 10 10"},{xtype:"svmx.button",ui:"svmx-default",labelCls:"svmx-button-label-largemodern",text:c().T("FSA008_TAG030","Next"),docked:"right",margin:"10 0 0 10",cls:"svmxPiqDetailNavBtn",disabled:!0,itemId:"nextButton",handler:function(){var e=t.query("#currContentSection")[0];t.query("#previousButton")[0].setDisabled(!1);var n=t.query("#historyContentSection")[0];if(t.__taHistoryIndex>1)t.__taHistoryIndex-=1,t.__getHistoryWithIndex(t.__taHistoryIndex,"next"),n.setHidden(!1),t.__IsHistoryVisible=!0;else{t.__previousButtonSelected=null;t.query("#nextButton")[0].setDisabled(!0);t.query("#currentButton")[0].setDisabled(!0),e.setHidden(!1),n.setHidden(!0),t.__taHistoryIndex=0;t.query("#LastModifiedDate")[0].setHtml(t.__taCurrentLMD),t.__IsHistoryVisible=!1}}},{xtype:"svmx.label",cls:"svmxPiqDetailNavBtnSeparator",text:["|"],docked:"right",disabled:!0,margin:"10 0 10 10"},{xtype:"svmx.button",ui:"svmx-default",labelCls:"svmx-button-label-largemodern",text:c().T("FSA017_TAG025","Previous"),docked:"right",margin:"10 0 0 10",cls:"svmxPiqDetailNavBtn",disabled:!0,itemId:"previousButton",handler:function(){t.__IsHistoryVisible=!0;var e=t.query("#currentButton")[0];(t.query("#nextButton")[0].setDisabled(!1),e.setDisabled(!1),t.__taHistoryIndex+=1,t.__getHistoryWithIndex(t.__taHistoryIndex,"previous"),t.__taHistoryIndex>=t.__taHistoryCount-1)&&t.query("#previousButton")[0].setDisabled(!0)}}]};if(this.add(p),this.__getLayoutForAllSections(),this.__getLayoutForHistory(),this.__taHistoryCount>1){this.query("#previousButton")[0].setDisabled(!1);this.query("#nextButton")[0].setDisabled(!0)}}}else{var m={xtype:"svmx.label",itemId:"titleSection",width:"100%",height:"100%",left:"10px",top:"10px",html:c().T("FSA017_TAG009","No technical attributes associated with this installed product.")};this.add(m)}},checkForAttributesError:function(){var e=r.getCustomFieldName("SM_Template_Json");this.__taTemplate[e]||(e=r.getCustomFieldName("SM_Attr_Payload"));var t=JSON.parse(this.__taTemplate[e]),n=!0;if(t)for(var i=t.fields,a=0;a<i.length;a++)for(var o=i[a],s=o.technicalAttributes,l=0;l<s.length;l++){var c=s[l];if(c.hasOwnProperty("label")&&c.hasOwnProperty("defaultValue")&&c.label){n=!1;break}}else n=!0;return n},__reloadHistoryWithData:function(e){this.__historyData=e;var t=s.convertToTimezone(e[r.getCustomFieldName("SM_Captured_On")]),n=s.getFormattedDatetime(t,"LL");this.__taPreviousLMD=n,this.query("#LastModifiedDate")[0].setHtml(this.__taPreviousLMD);for(var i=r.getCustomFieldName("SM_Attr_Payload"),a=JSON.parse(e[i]),o=a.fields,l=[],c=0;c<o.length;c++){var u=this.createSectionItem(o[c],c,!0);l.push(u)}var d={xtype:"svmx.fieldset",cls:"sfm-delivery-fieldset svmPiqDetailForm",layout:"auto",width:"100%",items:l,itemId:"historyContentSection",overrideFieldLabelAlign:!1,labelAlign:"top",hidden:!1};this.add(d)},__getHistoryWithIndex:function(e,t){""==this.__taHistory[this.__taHistory.length-1].LastModifiedDate&&(e=0);var n=(this.__taHistory[e],s),i=this.__taCurrentLMD;this.__capturedOnNotAvailable&&(i=this.__lastHistoryCapturedOn);var a=n.getFormattedDatetime(i,"YYYY-MM-DD 00:00:00");null===this.__previousButtonSelected?(this.__previousButtonSelected=t,a=n.getFormattedDatetime(i,"YYYY-MM-DD 00:00:00")):"previous"===this.__previousButtonSelected&&"previous"===t?a=n.getFormattedDatetime(this.__taPreviousLMD,"YYYY-MM-DD 00:00:00"):"next"===this.__previousButtonSelected&&"next"===t?a=n.getFormattedDatetime(this.__taPreviousLMD,"YYYY-MM-DD 23:59:59"):"previous"==this.__previousButtonSelected&&"next"===t?a=n.getFormattedDatetime(this.__taPreviousLMD,"YYYY-MM-DD 23:59:59"):"next"==this.__previousButtonSelected&&"previous"===t&&(a=n.getFormattedDatetime(this.__taPreviousLMD,"YYYY-MM-DD 00:00:00")),this.__previousButtonSelected=t,this.fetchTemplateHistory(e,t,a)},__getLayoutForAllSections:function(){var e=r.OrgNamespace+"__SM_Template_Json__c";void 0===this.__taTemplate[e]&&(e=r.OrgNamespace+"__SM_Attr_Payload__c");for(var t=JSON.parse(this.__taTemplate[e]),n=t.fields,i=[],a=0;a<n.length;a++){var o=n[a],s=o.technicalAttributes;if(!this.checkForSectionAttributes(s)){var l=this.createSectionItem(o,a,!1);i.push(l)}}var c={xtype:"svmx.fieldset",cls:"sfm-delivery-fieldset svmPiqDetailForm",layout:"auto",width:"100%",items:i,itemId:"currContentSection",overrideFieldLabelAlign:!1,labelAlign:"top"};this.add(c)},__getLayoutForHistory:function(){if(this.__taHistory.length>1){var e=1;""==this.__taHistory[this.__taHistory.length-1].LastModifiedDate&&(e=0);var t=this.__taHistory[e],n=s.convertToTimezone(t[r.getCustomFieldName("SM_Captured_On")]),i=s.getFormattedDatetime(n,"LL");this.__taPreviousLMD=i;for(var a=r.getCustomFieldName("SM_Attr_Payload"),o=JSON.parse(t[a]),l=o.fields,c=[],u=0;u<l.length;u++){var d=l[u],_=d.technicalAttributes;if(!this.checkForSectionAttributes(_)){var h=this.createSectionItem(l[u],u,!0);c.push(h)}}var f={xtype:"svmx.fieldset",cls:"sfm-delivery-fieldset svmPiqDetailForm",layout:"auto",width:"100%",items:c,itemId:"historyContentSection",overrideFieldLabelAlign:!1,labelAlign:"top",hidden:!0};this.add(f)}},checkForSectionAttributes:function(e){for(var t=!0,n=0;n<e.length;n++){var i=e[n];if(i.hasOwnProperty("label")&&i.hasOwnProperty("defaultValue")&&i.label){t=!1;break}}return t},createSectionItem:function(e,t,n){for(var i=e.technicalAttributes,a=[],r=0;r<i.length;r++){var o=i[r];if(o.hasOwnProperty("label")&&o.hasOwnProperty("defaultValue")&&o.label){var s=this.createFieldItem(o,t,r,n);a.push(s)}}var l={xtype:"svmx.fieldset",cls:"sfm-delivery-fieldset svmPiqDetailForm",layout:"auto",width:"100%",items:a,overrideFieldLabelAlign:!1,labelAlign:"top"},u=e.title;return{xtype:"svmx.panel",width:"100%",layout:"auto",items:[{xtype:"svmx.horizontalpanel",width:"100%",layout:"auto",cls:"svmxPiqSubTitle",items:[{xtype:"svmx.label",text:c().T("FSA017_TAG007","Attributes"),margin:"0 0 5 10",width:"35%"},{xtype:"svmx.label",text:c().T("FSA017_TAG008","Setting")}]},l],title:u}},createFieldItem:function(e,t,n,i){var a=this,o=e.format,s=void 0,l=void 0,c=void 0,u=e.readOnly;!u||"yes"!=u.toLowerCase()&&"true"!=u.toLowerCase()&&"1"!=u?s=!1:s=!0,i&&(s=!0),l=e.defaultValue;var _=r.getClient().isBarCodeEnabled(),h=this.getDisplayText(e);if(o&&"number"==o.toLowerCase())c={xtype:"sfm.field.number",disabled:s,margin:"10 10 10 0",width:"70%",labelStyle:"color: #0070D2; width:250px; white-space: nowrap; font-size: 16px;",label:h,labelSeparator:"",defaultValue:l,hideTrigger:!0,keyNavEnabled:!1,mouseWheelEnabled:!1,stepValue:"any",precision:3,enableBarcode:_,barcodeHandler:a.barcodeScanned,listeners:{blur:function(e,t,n){a.checkForInvalid(e)&&a.__updatedFields.push(e),a.shouldUpdateTemplateData=!0},focus:function(e,t,n){var i=a.getTextInputField(e);if(i){Ext.get(i).removeCls("svmxDetailInvalidField")}},clearicontap:function(e){a.shouldUpdateTemplateData=!0,a.__updatedFields.push(e)},valueChanged:function(e){a.shouldUpdateTemplateData=!0,a.__updatedFields.push(e)},initialize:function(e){e.setValue(e.defaultValue)}}};else if(o&&"boolean"==o.toLowerCase())"string"===Ext.typeOf(l)&&(l="yes"===l.toLowerCase()||"true"===l.toLowerCase()||"1"===l.toLowerCase()),c={xtype:"sfm.field.checkbox",label:h,width:"70%",margin:"10 10 10 0",disabled:s,value:l,listeners:{change:function(e){a.shouldUpdateTemplateData=!0,a.__updatedFields.push(e)}}};else if(o&&"picklist"==o.toLowerCase()){var f=a.picklistDataStore(e);c={xtype:"sfm.field.picklist",label:h,width:"70%",margin:"10 10 10 0",store:f,queryMode:"local",displayField:"value",valueField:"value",disabled:s,value:""===l?d:l,listeners:{initialize:function(e){e.autoSelect&&a.__updatedFields.push(e)},change:function(e){e.disabled||(a.__updatedFields.push(e),a.shouldUpdateTemplateData=!0)}}},a.isDefaultValueInDataStore(l,f)||(c.autoSelect=!1,c.placeHolder=l)}else c={xtype:"sfm.field.text",label:h,margin:"10 10 10 0",width:"70%",labelStyle:"color: #0070D2; width:250px; white-space: nowrap; font-size: 16px;",allowBlank:!0,disabled:s,value:l,labelSeparator:"",hideTrigger:!0,enableKeyEvents:!0,readOnly:!1,enableBarcode:_,barcodeHandler:a.barcodeScanned,listeners:{blur:function(e,t,n){a.shouldUpdateTemplateData=!0,a.__updatedFields.push(e)},clearicontap:function(e){a.shouldUpdateTemplateData=!0,a.__updatedFields.push(e)},valueChanged:function(e){a.shouldUpdateTemplateData=!0,a.__updatedFields.push(e)}}};return c.rowIndex=n,c.sectionIndex=t,c},getDisplayText:function(e){var t=e.label,n=e.unit;n&&(n=Ext.String.trim(n)),n&&n.startsWith("(")&&(n=n.replace("(","")),n&&n.endsWith(")")&&(n=n.replace(/.$/,""));var i=t;return n&&""!==n&&(i+=" ("+n+")"),i},isDefaultValueInDataStore:function(e,t){for(var n=0;n<t.length;n++){if(t[n].value==e)return!0}return!1},picklistDataStore:function(e){var t=void 0;t=this.__IsHistoryVisible?this.__historyData:this.__taTemplate;var n=e.picklistId,i=[];if(n){var a=r.getCustomFieldName("SM_Template_Json");t[a]||(a=r.getCustomFieldName("SM_Attr_Payload"));var o=JSON.parse(t[a]),s=o.picklist,l=s[n];if(l){l.setDefaultValue;var c=l.values;i.push({label:d,value:d});for(var u=0;u<c.length;u++)i.push({label:c[u],value:c[u]})}}return Ext.widget("svmx.store",{fields:["label","value"],data:i})},barcodeScanned:function(e,t){e.fireEvent("valueChanged",e)},setValueForNumberField:function(e){var t=r.getCustomFieldName("SM_Template_Json");this.__taTemplate[t]||(t=r.getCustomFieldName("SM_Attr_Payload"));var n=JSON.parse(this.__taTemplate[t]),i=n.fields,a=i[e.sectionIndex],o=a.technicalAttributes[e.rowIndex];e.setValue(o.defaultValue)},setValueForNumberFieldHistory:function(e){var t=this.__taHistory[this.__taHistory.length-1],n=r.getCustomFieldName("SM_Attr_Payload"),i=JSON.parse(t[n]);if(i&&i.fields){var a=i.fields,o=a[e.sectionIndex],s=o.technicalAttributes[e.rowIndex];e.setValue(s.defaultValue)}},checkForInvalid:function(e){var t=this.getTextInputField(e),n=!0;if(t){var i=Ext.get(t);e.__isInvalid?(i.addCls("svmxDetailInvalidField"),n=!1):i.removeCls("svmxDetailInvalidField")}return n},getTextInputField:function(e){for(var t=e.__input.parentElement;t;){if(-1!==t.id.indexOf("ext-textinput"))return t;t=t.parentElement}},updateTemplateData:function(){for(var e=this.__updatedFields,t=0;t<e.length;t++){var n,i=e[t];"sfm.field.checkbox"===i.xtype?n=!!i.getChecked():"sfm.field.picklist"===i.xtype?(n=i.getValue())!==d&&null!=n||(n=""):n=i._value;var o=r.getCustomFieldName("SM_Template_Json");this.__taTemplate[o]||(o=r.getCustomFieldName("SM_Attr_Payload"));var s=JSON.parse(this.__taTemplate[o]);s.fields[i.sectionIndex].technicalAttributes[i.rowIndex].defaultValue=n;var l=(0,a.default)(s);this.__taTemplate[o]=l}this.updateSFID(),this.escapePayload();var c=this.__selectedNode.id,u=this.mapLocalRecordID(c),_=r.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.UPDATE_TA_TEMPLATE_FOR_SELECTD_IB",this,{request:{context:this,handler:this.onUpdateComplete,data:this.__taTemplate,histroryData:this.__taHistory,selectedIBNodeId:u}});this.__deliveryEngine.getEventBus().triggerEvent(_)},escapePayload:function(){var e=r.getCustomFieldName("SM_Template_Json");this.__taTemplate[e]||(e=r.getCustomFieldName("SM_Attr_Payload"));var t=this.__taTemplate[e];t.indexOf("'")>-1&&(t=t.replace(/'/g,"''")),this.__taTemplate[e]=t},updateSFID:function(){var e=this.__parent.__mappedRecords;if(e){var t=e[this.__taTemplate.IBAttributeInstanceId];t&&(this.__taTemplate.IBAttributeInstanceId=t),t=e[this.__taTemplate.IBAttributeHistroryId],t&&(this.__taTemplate.IBAttributeHistroryId=t),t=e[this.__taTemplate.Id],t&&(this.__taTemplate.Id=t)}},onUpdateComplete:function(e){e.IBAttributeHistroryId&&e.IBAttributeHistroryCapturedOn&&(this.__taTemplate.IBAttributeHistroryId=e.IBAttributeHistroryId,this.__taTemplate.IBAttributeHistroryCapturedOn=e.IBAttributeHistroryCapturedOn)},mapLocalRecordID:function(e){var t=this.__parent.__mappedRecords;if(t){var n=t[e];if(n)return n}return e}}),r.defineGlobal(l.name,l),e.exports=l},function(e,t,n){var i=n(0).utils,a=n(22).View,r=(n(19).impl,{name:"com.servicemax.client.productIQ.ui.largemodern.overview"}),o=function(){return i.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")},s=a,l=i.getLoggingService().getLogger("ProductIQ-UI");Ext.define("com.servicemax.client.productIQ.ui.largemodern.overview.Overview",{extend:s,alias:"widget.productIQ.overview",height:"100%",margin:"10",config:{dataModel:null},__parent:null,__deliveryEngine:null,__valueModified:!1,constructor:function(e){this.__parent=e.parent,this.__deliveryEngine=e.deliveryEngine;var t=e.model,n=this.createSectionContainer(t),a="vertical";"laptop"==i.getClient().getApplicationParameter("client-type").toLowerCase()&&(a="both"),e=Ext.apply({layout:{type:"vbox"},scrollable:"y",contentScrollable:a,dockedItems:[{dock:"top",xtype:"toolbar",style:"background-color: #fff",margin:"10 10"}],items:[n]},e||{}),e.tree.on("node_selected",function(e){},this),this.callParent([e]);var r=this.__deliveryEngine.getEventBus();this.bind(r,"DATA_LOADED",this.onDataUpdated,this),this.bind(r,"SFMDELIVERY.ADV_VALIDATION_ERROR",this.onAdvancedValidationError,this),this.bind(r,"SFMDELIVERY.VALIDATION_ERROR",this.onValidationError,this),this.bind(r,"SFMDELIVERY.RECORD_SAVED",this.onRecordSaved,this),this.showSpinner(t)},doDestroy:function(){this.tree&&this.tree.un("node_selected",function(e){},this),this.callParent()},updateOverview:function(e){this.__valueModified=!1;var t=this.query("#deliverySections")[0];t&&t.destroy(),this.showSpinner(e);var n=this.createSectionContainer(e);this.add(n)},showSpinner:function(e){var t=this.__deliveryEngine;t.isNotQualified()||t.isNotAssigned()||t.processNotFound()||!e||this.__parent.__viewHidden||i.getCurrentApplication().showSpinner(this.__parent)},doSaveRecord:function(){var e=this.__deliveryEngine;return!e.isNotQualified()&&!e.isNotAssigned()&&!!this.__valueModified},createSectionContainer:function(e){var t=this,n=void 0,a=this.__deliveryEngine;if(a.isNotQualified()||a.isNotAssigned()||a.processNotFound()||!e){var r=void 0;r=a.isNotAssigned()?o().T("FSA017_TAG017","SFM Edit Process is not assigned for this user profile."):a.processNotFound()?o().T("FSA008_TAG094","Process not found; check your configuration"):o().T("FSA017_TAG004","This record does not meet the qualification criteria for this SFM Transaction."),n={xtype:"svmx.label",itemId:"deliverySections",width:"100%",height:"100%",left:"10px",top:"10px",html:r}}else{var s="vertical";"laptop"==i.getClient().getApplicationParameter("client-type").toLowerCase()&&(s="both"),n={xtype:"sfm.delivery.sections",itemId:"deliverySections",view:this.__parent,readOnly:!1,cls:"sfm-delivery-sections sfm-delivery-section-edit",scrollable:!1,hideHeaderPanel:!0,hideAttachments:!0,contentScrollable:s,deliveryEngine:a,model:e,listeners:{inputblur:function(e,n){t.__valueModified=!0},valueChanged:function(){t.__valueModified=!0}}}}return n},quickSave:function(){i.getCurrentApplication().showSpinner(this.__parent),l.info("Performing QuickSave action"),this.__triggerSaveRecordEvent("quick save","com.servicemax.client.sfmdelivery.responders.QuickSaveTargetRecordResponder",{})},__triggerSaveRecordEvent:function(e,t,n){var a=this.getDeliveryEngine(),r=a.getEventBus(),o=void 0;o=i.create("com.servicemax.client.lib.api.Event",this._getSaveRecordEventName(),this,{request:{data:a.getTargetData().getData(),skipAggressiveSync:!0,skipStatusMsg:!0,sourceRecordId:a.getSourceRecordId(),metadata:a.getPageMetaData().getRawPageMetaData(),deliveryEngine:a,additionalInfo:this._getSaveRecordAdditionalInfo(e,n)},responder:i.create(t,this,"",n)}),r.triggerEvent(o)},_getSaveRecordEventName:function(){return"SFMDELIVERY.SAVE_TARGETRECORD"},_getSaveRecordAdditionalInfo:function(e,t){return{processId:this.getDeliveryEngine().processId,eventType:e,toModelOnly:t&&t.toModelOnly,returnWarningsWithErrors:!0}},onQuickSaveTargetRecordComplete:function(e){l.info("Quick Save action completed"),i.getCurrentApplication().hideSpinner(this.__parent),this.__doSaveComplete(e,!1)},__doSaveComplete:function(e,t){if(e.error)return void this.getDeliveryEngine().showMessage({type:"ERROR",text:e.error,buttons:[{text:o().T("FSA016_TAG003","OK"),itemId:"OK"}]});this.__valueModified&&(this.__parent.overviewSaveDone(),this.__parent.ibtreeView.updateHierarchy(),this.__valueModified=!1)},deleteRecord:function(e,t){i.Msg.confirm({title:o().T("FSA008_TAG083","Remove"),text:o().T("FSA008_TAG027","Are you sure you want to delete this record? (Save still needed to commit these changes)"),buttons:[{text:o().T("FSA016_TAG001","Yes"),itemId:"YES",ui:"svmx-button-square"},{text:o().T("FSA016_TAG002","No"),itemId:"NO",ui:"svmx-button-square"}]}).then(i.proxy(this,function(n){"YES"==n&&this.deleteRecordAndUpdate(e,t)}))},deleteRecordAndUpdate:function(e,t){var n=this.getDeliveryEngine().getTargetData().getData(),a=this.getDeliveryEngine().getEventBus(),r=void 0;r=i.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.DELETE_RECORDS",this,{request:{alias:e,data:n,records:[{rowIndex:t}]},responder:i.create("com.servicemax.client.sfmdelivery.responders.DeleteRecordsResponder",this)}),a.triggerEvent(r)},onDeleteRecordsComplete:function(e){this.__valueModified=!0},addNew:function(e,t){var n=t.multiAddSearchField;if(null==n)this.__addNewRecord(e,t);else{var a=t.getFieldInfo(n);this.showViewInDialog({view:"multilookup",options:{currentLookupField:a,addSingleLineHandlerCallback:i.proxy(this,this.__addNewRecord,e,t),addMultpleNewHandlerCallback:i.proxy(this,this.__addMultipleNew,e,t)}})}},__addNewRecord:function(e,t){t.addNew(e)},__addMultipleNew:function(e,t,n,i){t.addMultipleNew(e,n,i)},onRecordSaved:function(){this.__valueModified=!0},restore:function(e){if(e){var t=e.data,n=e.viewOptions;switch(e.viewId){case"lookup":t=e.data;var i,a=this.__parent.currentLookupField,r=a.getLookupModel();if(r){i=t[r.getDefaultColumnName()]}null!==i&&void 0!==i||(i=t[a.nameFieldName]);this.__deliveryEngine.getTargetData().__allBindingsHash[a.fieldName].setValue({key:t.Id,value:i}),this.executeFieldMappings(a,t);break;case"edittext":var o=n.fieldName;this.getDataModel().__allBindingsHash[o].setValue(t)}this.__valueModified=!0}},executeFieldMappings:function(e,t){for(var n=e;!n.executeFieldMappings;)n=n._parent;n.executeFieldMappings&&n.executeFieldMappings(e,t)},onDataUpdated:function(e){var t=e.data;this.setDataModel(t),i.getCurrentApplication().hideSpinner(this.__parent),t.__data.__data.valueMapping&&(this.__valueModified=!0),this.checkForValidationErrors()},checkForValidationErrors:function(){var e=this.getDeliveryEngine().saveToModel(!0);e.errors&&e.errors.length>0&&(this.__valueModified=!0)},onAdvancedValidationError:function(e){this.__handleValidationError(e,!0)},__handleValidationError:function(e,t){this.__parent.__handleValidationError(e,t)},onValidationError:function(e){this.__handleValidationError(e,!1)}}),i.defineGlobal(r.name,r),e.exports=r},function(e,t,n){var i=n(0).utils,a=(n(22).View,n(19).impl,{name:"com.servicemax.client.productIQ.ui.largemodern.attachmentHelper"});i.getLoggingService().getLogger("ProductIQ-UI");Ext.define("com.servicemax.client.productIQ.ui.largemodern.detail.AttachmentHelper",{extend:"com.servicemax.client.sfmdelivery.ui.largemodern.attachmentview.AttachmentDocumentSection",alias:"widget.productIQ.attachmentHelper",width:"100%"}),i.defineGlobal(a.name,a),e.exports=a},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var a=n(1),r=i(a),o=n(2),s=i(o),l=n(6),c=i(l),u=n(3),d=i(u),_=n(14),h=i(_),f=n(4),p=i(f),m=n(0).utils,v=n(5).SVMXObject,g={name:"com.servicemax.client.productIQ.ui.largemodern.loadselectedib"},y=function(){return m.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")};g.LoadSelectedIB=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));if(n.__deliveryEngine=e.parent.__deliveryEngine,n.__root=e.root,n.__parent=e.parent,n.__ibtree=e.parent.getTree(),n.__treeDataById=e.parent.getTreeDataById(),n.__callback=e.callback||function(){},n.__selectedFirst=null,n.__params=e.params,n.__traversalTimeout=null,e.selectedIB.focused&&(n.__focusFromSearch=e.selectedIB.focused),e.selectedIB.recordIds.length>0){var i=e.selectedIB.recordIds[0],a=n.__ibtree.getStore().getNodeById(i);if(null!=a){var o=n.__ibtree.getStore().getNodeById(a.data.parentId);if(!o){var l=n.getSFID(a.data.parentId);l&&(o=n.__ibtree.getStore().getNodeById(l))}o&&o.expand(),n.__parent.treeLoadCompleted(n.__params),n.__ibtree.setSelection(a),n.__callback(),n.__parent.onTreeLoad(n.__params)}else{var c=m.create("com.servicemax.client.lib.api.Event","PRODUCTIQ.GET_ALL_PARENT_IBS",n,{request:{context:n,params:{},record:{Id:i},handler:n.onAllParentIBsComplete}});n.__getEventBus().triggerEvent(c)}}return n.__selectedIB=null,n.__parentIBs=null,n.__accountNode=null,n.__isCallback=null,n}return(0,p.default)(t,e),(0,c.default)(t,[{key:"doCleanup",value:function(){this.__parent&&this.__parent.un("node_loaded",function(e){this.traverseNodes(data)},this,{single:!0}),this.__traversalTimeout&&clearTimeout(this.traversalTimeout),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"doCleanup",this).call(this)}},{key:"getSFID",value:function(e){var t=this.__parent.__parent.__mappedRecords;if(t)return t[e]}},{key:"__getEventBus",value:function(){return this.__deliveryEngine.getEventBus()}},{key:"onAllParentIBsComplete",value:function(e){var t=this;if(null==e||0==e.length)this.__parent.__selectFromExternal&&(this.__callback(),this.showMessageForParent());else{var n=e[e.length-1];this.__parent.__getLocationPath(n.site,n.ids,function(){t.traverseNodes(e)})}}},{key:"traverseNodes",value:function(e){if(0!=e.length){var t=e.pop(),n=this.__ibtree.getStore().getNodeById(t.ids);if(!n){var i=this.getSFID(t.ids);i&&(n=this.__ibtree.getStore().getNodeById(i))}if(!n)return this.showMessageForParent(),void this.__parent.onTreeLoad(this.__params);var a=this.__treeDataById[n.id];if(0==e.length&&!0!==this.__selectedFirst)return this.__selectedFirst=!0,this.__parent.fireEvent("node_selected",n.data),this.__parent.treeLoadCompleted(this.__params),this.__ibtree.setSelection(n),void(this.__isCallback||(this.__isCallback=!0,this.__callback()));if(0==e.length)return void(this.__isCallback||(this.__isCallback=!0,this.__callback()));null!=a&&1==a.allIBsLoaded&&this.traverseNodes(e),this.__parent.on("node_loaded",function(t){this.traverseNodes(e)},this,{single:!0});this.__traversalTimeout=setTimeout(function(){n.expand(!1)},15)}}},{key:"showMessageForParent",value:function(){var e=this.__parent.__parent;if(e&&e.__newnodeCreated)return e.newRecordId=null,e.updateTreeView(),void(e.__newnodeCreated=!1);void 0!==this.__params&&!0===this.__params.viaFilter||m.getCurrentApplication().checkForMessageId("piqInstallbaseAlertWindow")||this.__parent.__nodeDropped||(m.getCurrentApplication().hideSpinner(e),m.getCurrentApplication().showMessage({text:y().T("FSA017_TAG006","Installed product or Location record(s) may not be available in the tree view because not all required data has been downloaded. Please download the associated Account or Installed Product record(s) and retry."),buttons:[{text:y().T("FSA016_TAG003","OK"),itemId:"OK"}],itemId:"piqInstallbaseAlertWindow",handler:m.proxy(this,function(){})}),delete this.__parent.__selectFromExternal)}}]),t}(v),m.defineGlobal(g.name,g),e.exports=g},function(e,t,n){n(81);var i=n(384);e.exports={pricingdefinition:i}},function(e,t,n){n(900);n(403).impl.Application,n(0).api.AbstractApplication;n(408);var i=n(0).utils,a=n(422),r=n(105),o=n(193),s=n(191),l=n(192),c=function(e){return function(){function t(){r.getEnv(n,h)}function n(e){console.log("DB LOADED");var t=void 0;e&&(e=JSON.parse(e),t=e.version),a.appVersion=t,a.createDatabase({context:v,onSuccess:u,onError:h})}function i(){g&&(console.log("FileSystem FailSafe Needed."),o.init(c,h))}function c(){console.log("Received Event: filesystem ready"),g=!1,s.init(t,h)}function u(){console.log("Getting Authorization State"),r.getAuthorizationState(function(e){m=JSON.parse(e),l.setTimeout(m.timeout),o._setPackage(m.package),d(!1)},function(){h()})}function d(e){console.log("Getting Session ID"),a.getSessionId({context:v,networkStatus:e,oAuthState:m,onShowSplash:f,onSuccess:_,onError:h})}function _(t){var n=Ext.Viewport.getMasked();n&&(n.hide(),n.destroy()),console.log("Starting Application");t.access_token,t.instance_url;window.external.setOauthCredentials({session_id:t.access_token,instance_url:t.instance_url,client_id:t.client_id,login_url:t.login_url,user_info_url:t.user_info_url,refresh_token:t.refresh_token,analytics:t.analytics}),r.hideMenu(e)}function h(e){console.log("AUTHENTICATION ERROR: "+e),e&&alert(e)}function f(e){window.StatusBar&&window.StatusBar.isVisible&&window.StatusBar.hide(),console.log("Getting Showing Splash"),r.hideMenu(function(){var t=document.getElementById("client_display_root");m.no_splash="yes",t.innerHTML="",t.style.height="100%";t.innerHTML="<link rel='stylesheet' type='text/css' href='modules/com.servicemax.client.native.cordova/resources/css/splash.css' /><div id='svmx_splash' class='svmx_splash_new'><div class='svmx_splash_logo_cell_new'>    <div id='svmx_splash_logo' class='svmx_splash_logo_new'></div>    <div class='svmx_splash_text_new'></div></div>    <div class='svmx_splash_release_text_new'></div>    <div id='svmx_button_panel' class='svmx_button_panel'>        <div class='svmx_splash_signin_cell_new'>            <div id='svmx_splash_signin' class='svmx_splash_signin_new'></div>        </div>    </div></div>";document.getElementById("svmx_splash"),document.getElementById("svmx_splash_logo");document.getElementById("svmx_splash_signin").onclick=function(){window.StatusBar&&(window.StatusBar.isVisible||window.StatusBar.show()),r.getAuthorizationState(function(e){d(!0)},function(){},{state:"LOGIN",action:"ONCLICK"})},!a.checkConnection()&&e&&alert("No network connection. Please try again once network is restored.")})}var p={xtype:"svmx.loadmask",transparent:!0,message:"Loading...",style:{"background-color":"white"}};Ext.Viewport.setMasked(p),r.setOrientation("both"),console.log("Received Event: deviceready"),o.init(c,h),setTimeout(i,200);var m={},v=void 0,g=!0}},u=function(e){i.requireScript("cordova.js",function(t){document.addEventListener("deviceready",c(e))},function(e){console.error("Failed to load cordova.js! Cannot start the application.")},void 0,{})};e.exports={preflight:u,DBAL:s,FILEIO:o,HTTP:l,OAUTH:a,SVMXPlugin:r}},function(e,t,n){function i(e){O(e,{})}function a(e,t){var n={},i=JSON.parse(e.ParameterString),a={onSuccess:function(){n.Status=!0,n.Result="",O(e,n)},onData:function(t){for(var i="",a=0;a<t.length;a++)i+=String.fromCharCode(t[a]);n.Status=!0,n.Result=i,O(e,n)},onError:function(t){console.warn("socket.onError "+e.MethodName+":"+t),n.Status=!1,n.Result=t,O(e,n)},onClose:function(t){n.Status=t,n.Result="socket closed",O(e,n)}},r=void 0;switch(void 0!=i.data.socketKey&&i.data.socketKey in t&&(r=t[i.data.socketKey]),e.MethodName){case"OPEN":null==r?(r=new window.Socket,r.onData=function(){},r.onError=a.onError,r.onClose=a.onClose,r.open(i.data.host,i.data.port,function(){t[r.socketKey]=r,n.Status=!0,n.Result=r.socketKey,O(e,n)},function(t){console.warn("socket.open: "+t),n.Status=!1,n.Result=t,O(e,n)})):(n.Status=!0,n.Result=r.socketKey,O(e,n));break;case"WRITE":for(var o=new Uint8Array(i.data.data.length),s=0;s<o.length;s++)o[s]=i.data.data.charCodeAt(s);r.onClose=a.onClose,r.write(o,a.onSuccess,a.onError);break;case"READ":r.onData=a.onData,r.onError=a.onError,r.onClose=a.onClose;break;case"CLOSE":var l=r.socketKey;r.close(function(){delete t[l],a.onSuccess()},a.onError);break;default:console.warn("TPCREQUEST invalid MethodName: "+e.MethodName)}}function r(e){var t={};t.Status=!0,t.Result="true";var n=JSON.parse(e.ParameterString);setTimeout(function(){o()||(t.Result="false"),O(e,t)},n.delay||2e3)}function o(){var e=navigator.connection.type,t=!0;return e!==window.Connection.UNKNOWN&&e!==window.Connection.NONE||(t=!1),t}function s(e){var t={};t.Status=!1,t.Result="",B.getUserInfo({onSuccess:function(n){t.Status=!0,n.IsSuccessful?(n.Result.InstanceURL=Y.getOauthCredentials().instance_url,n.Result.EndPointURL=Y.getOauthCredentials().login_url,t.Result=(0,q.default)([n.Result])):(t.Status=!1,t.Result=n.ResultAsString),O(e,t)},onError:function(n){t.Status=!1,t.Result="{}",O(e,t)}})}function l(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.printHTMLContentRequest(function(){O(e,t)},function(){O(e,t)},n)}function c(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.newRelicCustomEvtRequest(function(){O(e,t)},function(){O(e,t)},n)}function u(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.forceOrientation(function(){O(e,t)},function(){O(e,t)},n)}function d(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.sendSMS(n.phone,n.message,function(){O(e,t)},function(){O(e,t)})}function _(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.sendEmail(n.address,n.subject,n.message,n.attachmentFiles,function(){O(e,t)},function(){O(e,t)})}function h(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.shareFiles(n.files,function(){O(e,t)},function(){O(e,t)})}function f(e){var t={};t.Status=!0,t.Result="";JSON.parse(e.ParameterString);window.cordova.plugins.barcodeScanner.scan(function(n){t.Result=(0,q.default)([n]),O(e,t)},function(n){t.Status=!1,t.Result=(0,q.default)([n]),O(e,t)})}function p(e){var t=void 0;t={Status:!0,Result:""};var n=JSON.parse(e.ParameterString);window.cordova.plugins.launchExternalApp.start({url:n.url,param:n.param},function(n){t.Result=n,console.log("executeExternalApp success with message : "+n),O(e,t)},function(n){console.log("executeExternalApp failure with message : "+n);var i={text:function(){return V.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA003_TAG005","The application does not exist. Please contact your system administrator to update the application path or install the necessary software."),type:"INFO"};V.getCurrentApplication().showMessage(i),t.Status=!1,t.Result=i,O(e,t)})}function m(e){function t(e){for(var t=0,n=e.length;t<n;t+=1)e[t].fullPath,i(e[t].localURL)}function n(t){var n={};n.Status=!1,O(e,n)}function i(e){window.resolveLocalFileSystemURL(e,a,r)}function a(e){var t=-1===e.name.indexOf(".jpg")?".mp4":".jpg",n="IMG_"+(new Date).getTime()+t,i=window.cordova.file.externalDataDirectory||window.cordova.file.dataDirectory;i=i.replace(e.filesystem.root.nativeURL,"");var a="iOS"===window.device.platform?"NoCloud/Upload/":i+"Upload/";window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(t){t.root.getDirectory(a,{create:!0,exclusive:!1},function(t){e.moveTo(t,n,o,s)},s)},s)}function r(t){var n={};n.Status=!1,O(e,n)}function o(t){var n={};n.Status=!0,n.Result=(0,q.default)(t);var i=function(){O(e,n)},a=JSON.parse(e.ParameterString),r=V.getClient().getApplicationParameter("device-info"),o=r["device-platform"]||"";a.imageCompression&&!0===a.imageCompression.enabled?window.cordova.exec(function(){i()},function(){i()},"SVMXGeneralPlugin","compressImage",[{imagePath:"ios"===o.toLowerCase()?t.fullPath:t.nativeURL,imageCompression:a.imageCompression}]):i()}function s(t){var n={};n.Status=!1,O(e,n)}var l=JSON.parse(e.ParameterString),c=l.duration;"FROMVIDEO"===l.mode?navigator.device&&navigator.device.capture&&navigator.device.capture.captureVideo(t,n,{limit:1,duration:c,quality:0}):navigator.device&&navigator.device.capture&&navigator.device.capture.captureImage(t,n,{limit:1})}function v(e,t){var n={};n.Status=!0,n.Result="";JSON.parse(e.ParameterString);window.cordova.plugins.barcodeScanner.scan(function(i){n.Result=(0,q.default)([i]),t(e,n)},function(i){n.Status=!1,n.Result=(0,q.default)([i]),t(e,n)})}function g(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);j.openPhone(n.phone),O(e,t)}function y(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString),i=n.latitude?n.latitude:"0",a=n.longitude?n.longitude:"0";j.openMap(e.ParameterString,i,a),O(e,t)}function S(e){var t={};t.Status=!0,t.Result="";var n=JSON.parse(e.ParameterString);n.link&&(-1==n.link.indexOf(":")&&(n.link="http://"+n.link),window.open(n.link,"_system")),O(e,t)}function E(e){var t={};t.Status=!0,t.Result="",j.getGeolocation(function(n){var i=n.split(" "),a={location:{}};i&&i.length>0&&(a.location.lat=i[0]),i&&i.length>1&&(a.location.lng=i[1]),i&&i.length>2&&(a.accuracy=i[2]),t.Result=(0,q.default)(a),O(e,t)},function(){t.Status=!1,t.Result="Unable to determine location.",t.Permission="Success","Failure"==arguments[0]&&(t.Permission="Application Location Service Setting is disabled by the User"),O(e,t)})}function b(e,t){"LOGININFO"==e.MethodName?s(e):"GETDOWNLOADFOLDERPATH"==e.MethodName?C(e):"SMS"==e.MethodName?d(e):"EMAIL"==e.MethodName?_(e):"SHARE"==e.MethodName?h(e):"TEL"==e.MethodName?g(e):"GEO"==e.MethodName?y(e):"SCAN"==e.MethodName?t?v(e,t):f(e):"OpenExternalApp"==e.MethodName?p(e):"CapturePhoto"==e.MethodName?m(e):"GENERATEPDF"==e.MethodName?F(e):"BROWSER"==e.MethodName?t?w(e,t):S(e):"SIGNOUT"==e.MethodName?x(e):"LOCALEFORMAT"==e.MethodName?D(e):"EXIT"==e.MethodName?navigator.app.exitApp():"DEVICEINFO"==e.MethodName?R(e):"SETSSLCERTIFICATEPINNING"==e.MethodName?T(e):console.log("Not Supported: "+e.MethodName)}function T(e){var t={};if(e&&e.ParameterString){var n=JSON.parse(e.ParameterString);U.enableSSLPinningHTTPRequests({SSLSettingValue:n.value,onSuccess:function(n){console.log("Success - SSL Pinning !!!"),t.Status=!0,O(e,t)},onError:function(n){console.log("Failure - SSL Pinning"),t.Status=!1,O(e,t)}})}}function M(e){function t(){ee||(ee=!0,alert("Your remote access has been revoked. Please navigate back to the home screen to logout and re-authenticate."),B.signOut({}))}function n(){B.getSessionIdFromRefreshToken({context:y,loginUrl:d.login_url,clientId:d.client_id,refreshToken:d.refresh_token,onError:function(n,i){if(400==i){var a={error_description:"",error:"unknown"};try{a=JSON.parse(n)}catch(e){}"invalid_grant"===a.error?t():O(e,r)}else O(e,r)},onSuccess:function(n){!n||n.error&&"invalid_grant"==n.error?t():(d.session_id=n.access_token,Y.setOauthCredentials(d),M(e))}})}function i(){e.secondAttempt=!0,U.setSalesforceRequest({uri:d.user_info_url,session_id:d.session_id,instance_url:d.instance_url,secondAttempt:!0,context:y,onSuccess:function(t,i,a){401==a||403==a&&t&&"Bad_OAuth_Token"===t?n():O(e,r)},onError:function(t,i){ee||!i||403!=i&&401!=i?O(e,r):n()}})}function a(){U.setSalesforceRequest({allowPost:_,session_id:d.session_id,instance_url:d.instance_url,uri:s,method:c,data:l,headers:u,context:e.context,actionType:e.MethodName.toLowerCase(),fileName:h,sourcePath:f,parentId:p,objectName:m,compositeUri:g,contentVersionId:v,onSuccess:function(t,n,a){r.Status=a>=200&&a<300;var o=(0,q.default)({ResponseHeaders:n,ResponseBody:t,StatusCode:a});if(r.Result=o,r.Status)O(e,r);else{var l=0==s.indexOf(d.instance_url)||0==s.indexOf("/"),c=a&&401==a,u=!e.secondAttempt;l&&c&&u?i():O(e,r)}},onError:function(t,n){r.Status=!1,r.Result=t;var a=0==s.indexOf(d.instance_url)||0==s.indexOf("/"),o=n&&401==n,l=!e.secondAttempt;a&&o&&l?i():O(e,r)}})}var r={},o=JSON.parse(e.ParameterString),s=o.Uri,l=o.RequestBody,c=o.RequestMethod,u=JSON.parse(o.HttpRequestHeaders||"[]")||[],d=Y.getOauthCredentials(),_=!1,h=null,f=null,p=null,m=null,v=null,g=null,y=this;if(!ee)if(o.allowPost&&(_=!0),"download"==e.MethodName.toLowerCase()){var S="ContentVersion"===o.SourceObject?"v38.0":"v20.0";s="/services/data/"+S+"/sobjects/"+o.SourceObject+"/"+o.RecordId+"/"+o.FieldName,l="",c="GET",h=o.IsTroubleshootDocumentDownload?o.FileName?"{TroubleshootDocumentDirectory}/"+o.FileName:null:o.FileName?"{DownloadDirectory}/"+o.FileName:null,a()}else"upload"==e.MethodName.toLowerCase()?(o.ObjectName&&"ContentVersion"===o.ObjectName&&o.ContentVersionId?(s="/services/data/v43.0/sobjects/ContentVersion/"+o.ContentVersionId,c="PATCH",g=d.instance_url+"/services/data/v38.0/composite"):(s="/services/data/v20.0/sobjects/Attachment",c="POST"),h=o.FileName,f=o.FilePath,p=o.ParentId,m=o.ObjectName,v=o.ContentVersionId,a()):a()}function I(e){var t={},n=JSON.parse(e.ParameterString),i=n.SQL,a=n.SQLArray,r=n.RollBack;k("SQL",function(n){z.query({query:i,queryArray:a,doRollBack:r,onSuccess:function(i){var a=[];if(t.Status=!0,i instanceof Array)a=i;else{var r=i.rows,o=void 0,s=r.length;for(o=0;o<s;o++)a.push(r.item(o))}t.Result=(0,q.default)(a),O(e,t),n.call()},onError:function(i){i=i||{message:"Unknown database error."},L((0,q.default)(i)),t.Status=!1,t.Result=i.message;try{O(e,t)}catch(e){L(e.message)}n.call()}})})}function C(e){e=e||{};e.context||window;H.dirInfo({operationData:{FilePath:"{DownloadDirectory}/"},onSuccess:function(t){var n={Result:"[]",Status:!1};if(t.Status){var i=JSON.parse(t.Result);n.Status=!0,n.Result=(0,q.default)([i.FilePath])}O(e,n)}})}function A(e){var t={},n=JSON.parse(e.ParameterString),i={operationData:n,onSuccess:function(t){O(e,t)},onError:function(n){L((0,q.default)(n)),t.Status=!1,t.Result=n.message;try{O(e,t)}catch(e){L(e.message)}}};switch(e.MethodName){case"READTEXTFILE":H.readTextFile(i);break;case"READBASE64FILE":H.readFile(i);break;case"WRITETEXTFILE":case"WRITE":H.writeTextFile(i);break;case"WRITELINE":H.writeLine(i);break;case"COPYFILE":H.copyFile(i);break;case"DELETEFILE":H.deleteFile(i);break;case"RENAMEFILE":H.renameFile(i);break;case"OPENFILE":H.openFile(i);break;case"FILEINFO":H.fileInfo(i);break;case"BROWSEANDCOPYFILE":H.browseAndCopyFile(i);break;case"LISTFILES":H.listFiles(i);break;default:console.log("IO ERROR MISSING MethodName: "+e.MethodName)}}function D(e){var t=function(){console.error("Unable to get current locale time format!")},n={};navigator.globalization.getDatePattern(function(i){n.time=i.pattern,navigator.globalization.getDatePattern(function(i){n.date=i.pattern,navigator.globalization.getDatePattern(function(i){n.long_time=i.pattern,navigator.globalization.getDatePattern(function(i){n.long_date=i.pattern,navigator.globalization.getDatePattern(function(i){n.full_date_time=i.pattern,navigator.globalization.getLocaleName(function(i){n.locale=i,navigator.globalization.getNumberPattern(function(i){n.number_group_separator=i.grouping,n.number_decimal_separator=i.decimal,navigator.globalization.getNumberPattern(function(t){n.currency_group_separator=t.grouping,n.currency_decimal_separator=t.decimal,O(e,{Status:!0,Result:(0,q.default)([n])})},t,{type:"currency"})},t,{type:"decimal"})},t)},t,{formatLength:"full",selector:"date and time"})},t,{formatLength:"long",selector:"date"})},t,{formatLength:"long",selector:"time"})},t,{formatLength:"short",selector:"date"})},t,{formatLength:"short",selector:"time"})}function x(e){B.signOut({})}function R(e){var t={"barcode-enabled":!0,"client-type":"mobile","device-platform":window.device.platform,details:window.device};O(e,{Status:!0,Result:(0,q.default)([t])})}function O(e,t){t.RequestId=e.RequestId,t.Type=e.Type,t.MethodName=e.MethodName,t.CurrentPage=1,t.TotalPages=1,setTimeout(function(){window[e.jsCallback](t)},0)}function L(e){}function k(e,t){if(null===e&&(e="Sync_"+Math.random().toString()),te=te||{},te[e]=te[e]||[],te[e].length>0)te[e].push(t);else{te[e]=[t];(function t(){var n=te[e][0];n?n.call(null,function(){te[e].shift(),t.call()}):delete te[e]}).call()}}function N(e,t){console.log(e.ParameterString);var n=V.toObject(e.ParameterString).SQL,i={},a=V.toObject(e.ParameterString);a.SQL;z.query({query:n,onSuccess:function(n){var a=[];if(i.Status=!0,n instanceof Array)a=n;else{var r=n.rows,o=void 0,s=r.length;for(o=0;o<s;o++)a.push(r.item(o))}i.Result=(0,q.default)(a),t(e,i)},onError:function(n){n=n||{message:"Unknown database error."},L((0,q.default)(n)),i.Status=!1,i.Result=n.message;try{t(e,i)}catch(e){L(e.message)}}})}function w(e,t){var n={};n.Status=!0,n.Result="";var i=JSON.parse(e.ParameterString);i.link&&(-1==i.link.indexOf(":")&&(i.link="http://"+i.link),window.open(i.link,"_system")),t(e,n)}function F(e){function t(t){t.createWriter(function(a){var r=H.__convertBase64toBlob("application/pdf",i.base64);i.base64=null,a.onwriteend=function(n){var i={};i.Status=!0,i.Result=(0,q.default)(t),i.Device=window.device.platform,O(e,i)},a.onerror=function(e){n()},a.write(r),r=null},function(){n()})}function n(){var t={};t.Status=!1,t.Device=window.device.platform,O(e,t)}var i=e,a=JSON.parse(e.ParameterString),r=a.htmlContent,o=a.pdfName,s={documentSize:"A4",type:"base64"};pdf.fromData(r,s).then(function(e){i.base64=e;var a=o,r=H.__convertBaseDirectory("{UploadDirectory}/");H._getFileEntry({FilePath:""+r+a,createFile:!0,context:i.context,onSuccess:t,onError:n})}).catch(function(e){n()})}var P=n(31),q=function(e){return e&&e.__esModule?e:{default:e}}(P),V=n(0).utils,B=n(422),j=n(105),H=n(193),z=n(191),U=n(192);window.external={};var Y=window.external,W={},G="",X="",Q="",J="",K="",$="",Z="",ee=!1,te={};Y.socketPool=new Object,Y.setOauthCredentials=function(e){G=e.instance_url||"",X=e.session_id||"",Q=e.client_id||"",J=e.login_url||"",K=e.user_info_url||"",$=e.refresh_token||"",Z=e.analytics||"",ee=!1},Y.getOauthCredentials=function(){return{instance_url:G,session_id:X,client_id:Q,login_url:J,user_info_url:K,refresh_token:$,analytics:Z}},Y.execute=function(e,t){var n=JSON.parse(e);if(n.TotalPages>1){var s=W[n.RequestId];if(s?s.ParameterString+=n.ParameterString:(s=JSON.parse((0,q.default)(n)),W[n.RequestId]=s),n.CurrentPage!=n.TotalPages)return;n=W[n.RequestId],W[n.RequestId]=null}switch(n.Type){case"SQL":t?N(n,t):I(n);break;case"HTTP":if(o())M(n);else{var d={};d.Status=!1;d.Result=function(){return V.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("FSA")}().T("FSA004_TAG030","Device is not connected to the internet"),O(n,d)}break;case"CHECKCONNECTIVITY":r(n);break;case"GENERATEREPORT":break;case"FILEIO":A(n);break;case"LOG":break;case"LOCATION_TRACKING":E(n);break;case"SIGNOUT":x(n);break;case"DATAACCESSAPI":i(n);break;case"TCPREQUEST":a(n,this.socketPool);break;case"MISC":console.log("EXTERNAL "+n.Type+"/"+n.MethodName+": "+(0,q.default)(n)),b(n,t);break;case"PRINTHTMLCONTENT":l(n);break;case"NEWRELICCUSTOMEVT":c(n);break;case"FORCEORIENTATION":u(n);break;default:console.log("EXTERNAL "+n.Type+"/"+n.MethodName+": REQUEST TYPE NOT SUPPORTED!")}}},function(e,t,n){(function(t){!function(){"use strict";function n(e){return Array.isArray(e)||e instanceof Array}function i(e,t,i){var a=t.constructor.name;if(a&&""!==a||Object.keys(e).some(function(n){if(e[n]===t.constructor)return a=n,!0}),a&&a.length>0)return n(i)?(i.push({$class:a}),i):(i.$class=a,i)}function a(e){return e||("undefined"!=typeof window?window:t)}function r(e){return"object"==typeof e&&e&&!(e instanceof Boolean)&&!(e instanceof Date)&&!(e instanceof Number)&&!(e instanceof RegExp)&&!(e instanceof String)}function o(e,t){var i;return t&&t.$class?"function"==typeof e[t.$class]?(i=e[t.$class],delete t.$class,i):Object:n(t)&&t[t.length-1].$class&&1===Object.keys(t[t.length-1]).length?"function"==typeof e[t[t.length-1].$class]?(i=e[t[t.length-1].$class],delete t[t.length-1].$class,i):Object:void 0}function s(e,t){var i=o(e,t);if(i){var a={constructor:{enumerable:!1,configurable:!0,writable:!0,value:i}};return Object.keys(t).forEach(function(e,i){"$class"===e?a[e]={configurable:!0,writable:!0,value:t[e]}:i===t.length-1&&n(t)||(a[e]={configurable:!0,writable:!0,enumerable:!0,value:t[e]})}),Object.create(i.prototype,a)}return t}var l={};l.decycle=function(e,t){t=a(t);var o=new Map;return function e(a,s){var l,c=n(a)?[]:{};return r(a)?(l=o.get(a))?{$ref:l}:(o.set(a,s),Object.keys(a).forEach(function(t){c[t]=e(a[t],s+"["+(n(c)?t:JSON.stringify(t))+"]")}),i(t,a,c)):a}(e,"$")},l.retrocycle=function(e,t){if("object"!=typeof e||!e)return e;t=a(t),e=s(t,e);var n=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return function i(a){Object.keys(a).forEach(function(r){a[r]=s(t,a[r]),a[r]&&"object"==typeof a[r]&&"string"==typeof a[r].$ref&&n.test(a[r].$ref)?a[r]=Function("dollar","var $ = dollar; return "+a[r].$ref)(e):a[r]&&"object"==typeof a[r]&&i(a[r])})}(e),e},e.exports=l,"undefined"!=typeof window&&(window.Cycler=l)}()}).call(t,n(132))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2J1bmRsZS5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7QUFxbVdBOzs7Ozs7Ozs7O0FBdWhCQTs7Ozs7QUFxcnVIQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTJuOEVBIiwic291cmNlUm9vdCI6IiJ9